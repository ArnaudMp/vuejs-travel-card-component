function createNotImplementedError(Re){throw new Error(`[unenv] ${Re} is not implemented yet!`)}function notImplemented(Re){return Object.assign((()=>{throw createNotImplementedError(Re)}),{__unenv__:!0})}globalThis._importMeta_={url:"file:///_entry.js",env:{}};const Re=[],Le=[],Oe="undefined"==typeof Uint8Array?Array:Uint8Array,Ue="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(let Oe=0,qe=64;Oe<qe;++Oe)Re[Oe]=Ue[Oe],Le[Ue.charCodeAt(Oe)]=Oe;function toByteArray(Re){let Ue;const qe=function(Re){const Le=Re.length;if(Le%4>0)throw new Error("Invalid string. Length must be a multiple of 4");let Oe=Re.indexOf("=");return-1===Oe&&(Oe=Le),[Oe,Oe===Le?0:4-Oe%4]}(Re),Ct=qe[0],Ot=qe[1],Jt=new Oe(function(Re,Le,Oe){return 3*(Le+Oe)/4-Oe}(0,Ct,Ot));let Hr=0;const Jr=Ot>0?Ct-4:Ct;let Ln;for(Ln=0;Ln<Jr;Ln+=4)Ue=Le[Re.charCodeAt(Ln)]<<18|Le[Re.charCodeAt(Ln+1)]<<12|Le[Re.charCodeAt(Ln+2)]<<6|Le[Re.charCodeAt(Ln+3)],Jt[Hr++]=Ue>>16&255,Jt[Hr++]=Ue>>8&255,Jt[Hr++]=255&Ue;return 2===Ot&&(Ue=Le[Re.charCodeAt(Ln)]<<2|Le[Re.charCodeAt(Ln+1)]>>4,Jt[Hr++]=255&Ue),1===Ot&&(Ue=Le[Re.charCodeAt(Ln)]<<10|Le[Re.charCodeAt(Ln+1)]<<4|Le[Re.charCodeAt(Ln+2)]>>2,Jt[Hr++]=Ue>>8&255,Jt[Hr++]=255&Ue),Jt}function encodeChunk(Le,Oe,Ue){let qe;const Ct=[];for(let Jt=Oe;Jt<Ue;Jt+=3)qe=(Le[Jt]<<16&16711680)+(Le[Jt+1]<<8&65280)+(255&Le[Jt+2]),Ct.push(Re[(Ot=qe)>>18&63]+Re[Ot>>12&63]+Re[Ot>>6&63]+Re[63&Ot]);var Ot;return Ct.join("")}function fromByteArray(Le){let Oe;const Ue=Le.length,qe=Ue%3,Ct=[],Ot=16383;for(let Re=0,Oe=Ue-qe;Re<Oe;Re+=Ot)Ct.push(encodeChunk(Le,Re,Re+Ot>Oe?Oe:Re+Ot));return 1===qe?(Oe=Le[Ue-1],Ct.push(Re[Oe>>2]+Re[Oe<<4&63]+"==")):2===qe&&(Oe=(Le[Ue-2]<<8)+Le[Ue-1],Ct.push(Re[Oe>>10]+Re[Oe>>4&63]+Re[Oe<<2&63]+"=")),Ct.join("")}function read(Re,Le,Oe,Ue,qe){let Ct,Ot;const Jt=8*qe-Ue-1,Hr=(1<<Jt)-1,Jr=Hr>>1;let Ln=-7,Nn=Oe?qe-1:0;const $n=Oe?-1:1;let Gn=Re[Le+Nn];for(Nn+=$n,Ct=Gn&(1<<-Ln)-1,Gn>>=-Ln,Ln+=Jt;Ln>0;)Ct=256*Ct+Re[Le+Nn],Nn+=$n,Ln-=8;for(Ot=Ct&(1<<-Ln)-1,Ct>>=-Ln,Ln+=Ue;Ln>0;)Ot=256*Ot+Re[Le+Nn],Nn+=$n,Ln-=8;if(0===Ct)Ct=1-Jr;else{if(Ct===Hr)return Ot?Number.NaN:(Gn?-1:1)*Number.POSITIVE_INFINITY;Ot+=Math.pow(2,Ue),Ct-=Jr}return(Gn?-1:1)*Ot*Math.pow(2,Ct-Ue)}function write(Re,Le,Oe,Ue,qe,Ct){let Ot,Jt,Hr,Jr=8*Ct-qe-1;const Ln=(1<<Jr)-1,Nn=Ln>>1,$n=23===qe?Math.pow(2,-24)-Math.pow(2,-77):0;let Gn=Ue?0:Ct-1;const qn=Ue?1:-1,Zn=Le<0||0===Le&&1/Le<0?1:0;for(Le=Math.abs(Le),Number.isNaN(Le)||Le===Number.POSITIVE_INFINITY?(Jt=Number.isNaN(Le)?1:0,Ot=Ln):(Ot=Math.floor(Math.log2(Le)),Le*(Hr=Math.pow(2,-Ot))<1&&(Ot--,Hr*=2),(Le+=Ot+Nn>=1?$n/Hr:$n*Math.pow(2,1-Nn))*Hr>=2&&(Ot++,Hr/=2),Ot+Nn>=Ln?(Jt=0,Ot=Ln):Ot+Nn>=1?(Jt=(Le*Hr-1)*Math.pow(2,qe),Ot+=Nn):(Jt=Le*Math.pow(2,Nn-1)*Math.pow(2,qe),Ot=0));qe>=8;)Re[Oe+Gn]=255&Jt,Gn+=qn,Jt/=256,qe-=8;for(Ot=Ot<<qe|Jt,Jr+=qe;Jr>0;)Re[Oe+Gn]=255&Ot,Gn+=qn,Ot/=256,Jr-=8;Re[Oe+Gn-qn]|=128*Zn}Le["-".charCodeAt(0)]=62,Le["_".charCodeAt(0)]=63;const qe="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null,Ct=2147483647;function createBuffer$1(Re){if(Re>Ct)throw new RangeError('The value "'+Re+'" is invalid for option "size"');const Le=new Uint8Array(Re);return Object.setPrototypeOf(Le,Buffer$1.prototype),Le}function Buffer$1(Re,Le,Oe){if("number"==typeof Re){if("string"==typeof Le)throw new TypeError('The "string" argument must be of type string. Received type number');return allocUnsafe(Re)}return from(Re,Le,Oe)}function from(Re,Le,Oe){if("string"==typeof Re)return function(Re,Le){"string"==typeof Le&&""!==Le||(Le="utf8");if(!Buffer$1.isEncoding(Le))throw new TypeError("Unknown encoding: "+Le);const Oe=0|byteLength(Re,Le);let Ue=createBuffer$1(Oe);const qe=Ue.write(Re,Le);qe!==Oe&&(Ue=Ue.slice(0,qe));return Ue}(Re,Le);if(ArrayBuffer.isView(Re))return function(Re){if(isInstance(Re,Uint8Array)){const Le=new Uint8Array(Re);return fromArrayBuffer(Le.buffer,Le.byteOffset,Le.byteLength)}return fromArrayLike(Re)}(Re);if(null==Re)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Re);if(isInstance(Re,ArrayBuffer)||Re&&isInstance(Re.buffer,ArrayBuffer))return fromArrayBuffer(Re,Le,Oe);if("undefined"!=typeof SharedArrayBuffer&&(isInstance(Re,SharedArrayBuffer)||Re&&isInstance(Re.buffer,SharedArrayBuffer)))return fromArrayBuffer(Re,Le,Oe);if("number"==typeof Re)throw new TypeError('The "value" argument must not be of type number. Received type number');const Ue=Re.valueOf&&Re.valueOf();if(null!=Ue&&Ue!==Re)return Buffer$1.from(Ue,Le,Oe);const qe=function(Re){if(Buffer$1.isBuffer(Re)){const Le=0|checked(Re.length),Oe=createBuffer$1(Le);return 0===Oe.length||Re.copy(Oe,0,0,Le),Oe}if(void 0!==Re.length)return"number"!=typeof Re.length||numberIsNaN(Re.length)?createBuffer$1(0):fromArrayLike(Re);if("Buffer"===Re.type&&Array.isArray(Re.data))return fromArrayLike(Re.data)}(Re);if(qe)return qe;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof Re[Symbol.toPrimitive])return Buffer$1.from(Re[Symbol.toPrimitive]("string"),Le,Oe);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Re)}function assertSize(Re){if("number"!=typeof Re)throw new TypeError('"size" argument must be of type number');if(Re<0)throw new RangeError('The value "'+Re+'" is invalid for option "size"')}function allocUnsafe(Re){return assertSize(Re),createBuffer$1(Re<0?0:0|checked(Re))}function fromArrayLike(Re){const Le=Re.length<0?0:0|checked(Re.length),Oe=createBuffer$1(Le);for(let Ue=0;Ue<Le;Ue+=1)Oe[Ue]=255&Re[Ue];return Oe}function fromArrayBuffer(Re,Le,Oe){if(Le<0||Re.byteLength<Le)throw new RangeError('"offset" is outside of buffer bounds');if(Re.byteLength<Le+(Oe||0))throw new RangeError('"length" is outside of buffer bounds');let Ue;return Ue=void 0===Le&&void 0===Oe?new Uint8Array(Re):void 0===Oe?new Uint8Array(Re,Le):new Uint8Array(Re,Le,Oe),Object.setPrototypeOf(Ue,Buffer$1.prototype),Ue}function checked(Re){if(Re>=Ct)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Ct.toString(16)+" bytes");return 0|Re}function byteLength(Re,Le){if(Buffer$1.isBuffer(Re))return Re.length;if(ArrayBuffer.isView(Re)||isInstance(Re,ArrayBuffer))return Re.byteLength;if("string"!=typeof Re)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof Re);const Oe=Re.length,Ue=arguments.length>2&&!0===arguments[2];if(!Ue&&0===Oe)return 0;let qe=!1;for(;;)switch(Le){case"ascii":case"latin1":case"binary":return Oe;case"utf8":case"utf-8":return utf8ToBytes(Re).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*Oe;case"hex":return Oe>>>1;case"base64":return base64ToBytes(Re).length;default:if(qe)return Ue?-1:utf8ToBytes(Re).length;Le=(""+Le).toLowerCase(),qe=!0}}function slowToString(Re,Le,Oe){let Ue=!1;if((void 0===Le||Le<0)&&(Le=0),Le>this.length)return"";if((void 0===Oe||Oe>this.length)&&(Oe=this.length),Oe<=0)return"";if((Oe>>>=0)<=(Le>>>=0))return"";for(Re||(Re="utf8");;)switch(Re){case"hex":return hexSlice(this,Le,Oe);case"utf8":case"utf-8":return utf8Slice(this,Le,Oe);case"ascii":return asciiSlice(this,Le,Oe);case"latin1":case"binary":return latin1Slice(this,Le,Oe);case"base64":return base64Slice(this,Le,Oe);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,Le,Oe);default:if(Ue)throw new TypeError("Unknown encoding: "+Re);Re=(Re+"").toLowerCase(),Ue=!0}}function swap(Re,Le,Oe){const Ue=Re[Le];Re[Le]=Re[Oe],Re[Oe]=Ue}function bidirectionalIndexOf(Re,Le,Oe,Ue,qe){if(0===Re.length)return-1;if("string"==typeof Oe?(Ue=Oe,Oe=0):Oe>2147483647?Oe=2147483647:Oe<-2147483648&&(Oe=-2147483648),numberIsNaN(Oe=+Oe)&&(Oe=qe?0:Re.length-1),Oe<0&&(Oe=Re.length+Oe),Oe>=Re.length){if(qe)return-1;Oe=Re.length-1}else if(Oe<0){if(!qe)return-1;Oe=0}if("string"==typeof Le&&(Le=Buffer$1.from(Le,Ue)),Buffer$1.isBuffer(Le))return 0===Le.length?-1:arrayIndexOf(Re,Le,Oe,Ue,qe);if("number"==typeof Le)return Le&=255,"function"==typeof Uint8Array.prototype.indexOf?qe?Uint8Array.prototype.indexOf.call(Re,Le,Oe):Uint8Array.prototype.lastIndexOf.call(Re,Le,Oe):arrayIndexOf(Re,[Le],Oe,Ue,qe);throw new TypeError("val must be string, number or Buffer")}function arrayIndexOf(Re,Le,Oe,Ue,qe){let Ct,Ot=1,Jt=Re.length,Hr=Le.length;if(void 0!==Ue&&("ucs2"===(Ue=String(Ue).toLowerCase())||"ucs-2"===Ue||"utf16le"===Ue||"utf-16le"===Ue)){if(Re.length<2||Le.length<2)return-1;Ot=2,Jt/=2,Hr/=2,Oe/=2}function read(Re,Le){return 1===Ot?Re[Le]:Re.readUInt16BE(Le*Ot)}if(qe){let Ue=-1;for(Ct=Oe;Ct<Jt;Ct++)if(read(Re,Ct)===read(Le,-1===Ue?0:Ct-Ue)){if(-1===Ue&&(Ue=Ct),Ct-Ue+1===Hr)return Ue*Ot}else-1!==Ue&&(Ct-=Ct-Ue),Ue=-1}else for(Oe+Hr>Jt&&(Oe=Jt-Hr),Ct=Oe;Ct>=0;Ct--){let Oe=!0;for(let Ue=0;Ue<Hr;Ue++)if(read(Re,Ct+Ue)!==read(Le,Ue)){Oe=!1;break}if(Oe)return Ct}return-1}function hexWrite(Re,Le,Oe,Ue){Oe=Number(Oe)||0;const qe=Re.length-Oe;Ue?(Ue=Number(Ue))>qe&&(Ue=qe):Ue=qe;const Ct=Le.length;let Ot;for(Ue>Ct/2&&(Ue=Ct/2),Ot=0;Ot<Ue;++Ot){const Ue=Number.parseInt(Le.slice(2*Ot,2*Ot+2),16);if(numberIsNaN(Ue))return Ot;Re[Oe+Ot]=Ue}return Ot}function utf8Write(Re,Le,Oe,Ue){return blitBuffer(utf8ToBytes(Le,Re.length-Oe),Re,Oe,Ue)}function asciiWrite(Re,Le,Oe,Ue){return blitBuffer(function(Re){const Le=[];for(let Oe=0;Oe<Re.length;++Oe)Le.push(255&Re.charCodeAt(Oe));return Le}(Le),Re,Oe,Ue)}function base64Write(Re,Le,Oe,Ue){return blitBuffer(base64ToBytes(Le),Re,Oe,Ue)}function ucs2Write(Re,Le,Oe,Ue){return blitBuffer(function(Re,Le){let Oe,Ue,qe;const Ct=[];for(let Ot=0;Ot<Re.length&&!((Le-=2)<0);++Ot)Oe=Re.charCodeAt(Ot),Ue=Oe>>8,qe=Oe%256,Ct.push(qe,Ue);return Ct}(Le,Re.length-Oe),Re,Oe,Ue)}function base64Slice(Re,Le,Oe){return 0===Le&&Oe===Re.length?fromByteArray(Re):fromByteArray(Re.slice(Le,Oe))}function utf8Slice(Re,Le,Oe){Oe=Math.min(Re.length,Oe);const Ue=[];let qe=Le;for(;qe<Oe;){const Le=Re[qe];let Ct=null,Ot=Le>239?4:Le>223?3:Le>191?2:1;if(qe+Ot<=Oe){let Oe,Ue,Jt,Hr;switch(Ot){case 1:Le<128&&(Ct=Le);break;case 2:Oe=Re[qe+1],128==(192&Oe)&&(Hr=(31&Le)<<6|63&Oe,Hr>127&&(Ct=Hr));break;case 3:Oe=Re[qe+1],Ue=Re[qe+2],128==(192&Oe)&&128==(192&Ue)&&(Hr=(15&Le)<<12|(63&Oe)<<6|63&Ue,Hr>2047&&(Hr<55296||Hr>57343)&&(Ct=Hr));break;case 4:Oe=Re[qe+1],Ue=Re[qe+2],Jt=Re[qe+3],128==(192&Oe)&&128==(192&Ue)&&128==(192&Jt)&&(Hr=(15&Le)<<18|(63&Oe)<<12|(63&Ue)<<6|63&Jt,Hr>65535&&Hr<1114112&&(Ct=Hr))}}null===Ct?(Ct=65533,Ot=1):Ct>65535&&(Ct-=65536,Ue.push(Ct>>>10&1023|55296),Ct=56320|1023&Ct),Ue.push(Ct),qe+=Ot}return function(Re){const Le=Re.length;if(Le<=Ot)return String.fromCharCode.apply(String,Re);let Oe="",Ue=0;for(;Ue<Le;)Oe+=String.fromCharCode.apply(String,Re.slice(Ue,Ue+=Ot));return Oe}(Ue)}Buffer$1.TYPED_ARRAY_SUPPORT=function(){try{const Re=new Uint8Array(1),Le={foo:function(){return 42}};return Object.setPrototypeOf(Le,Uint8Array.prototype),Object.setPrototypeOf(Re,Le),42===Re.foo()}catch{return!1}}(),Buffer$1.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This environment lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(Buffer$1.prototype,"parent",{enumerable:!0,get:function(){if(Buffer$1.isBuffer(this))return this.buffer}}),Object.defineProperty(Buffer$1.prototype,"offset",{enumerable:!0,get:function(){if(Buffer$1.isBuffer(this))return this.byteOffset}}),Buffer$1.poolSize=8192,Buffer$1.from=function(Re,Le,Oe){return from(Re,Le,Oe)},Object.setPrototypeOf(Buffer$1.prototype,Uint8Array.prototype),Object.setPrototypeOf(Buffer$1,Uint8Array),Buffer$1.alloc=function(Re,Le,Oe){return function(Re,Le,Oe){return assertSize(Re),Re<=0?createBuffer$1(Re):void 0!==Le?"string"==typeof Oe?createBuffer$1(Re).fill(Le,Oe):createBuffer$1(Re).fill(Le):createBuffer$1(Re)}(Re,Le,Oe)},Buffer$1.allocUnsafe=function(Re){return allocUnsafe(Re)},Buffer$1.allocUnsafeSlow=function(Re){return allocUnsafe(Re)},Buffer$1.isBuffer=function(Re){return null!=Re&&!0===Re._isBuffer&&Re!==Buffer$1.prototype},Buffer$1.compare=function(Re,Le){if(isInstance(Re,Uint8Array)&&(Re=Buffer$1.from(Re,Re.offset,Re.byteLength)),isInstance(Le,Uint8Array)&&(Le=Buffer$1.from(Le,Le.offset,Le.byteLength)),!Buffer$1.isBuffer(Re)||!Buffer$1.isBuffer(Le))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(Re===Le)return 0;let Oe=Re.length,Ue=Le.length;for(let qe=0,Ct=Math.min(Oe,Ue);qe<Ct;++qe)if(Re[qe]!==Le[qe]){Oe=Re[qe],Ue=Le[qe];break}return Oe<Ue?-1:Ue<Oe?1:0},Buffer$1.isEncoding=function(Re){switch(String(Re).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer$1.concat=function(Re,Le){if(!Array.isArray(Re))throw new TypeError('"list" argument must be an Array of Buffers');if(0===Re.length)return Buffer$1.alloc(0);let Oe;if(void 0===Le)for(Le=0,Oe=0;Oe<Re.length;++Oe)Le+=Re[Oe].length;const Ue=Buffer$1.allocUnsafe(Le);let qe=0;for(Oe=0;Oe<Re.length;++Oe){let Le=Re[Oe];if(isInstance(Le,Uint8Array))qe+Le.length>Ue.length?(Buffer$1.isBuffer(Le)||(Le=Buffer$1.from(Le.buffer,Le.byteOffset,Le.byteLength)),Le.copy(Ue,qe)):Uint8Array.prototype.set.call(Ue,Le,qe);else{if(!Buffer$1.isBuffer(Le))throw new TypeError('"list" argument must be an Array of Buffers');Le.copy(Ue,qe)}qe+=Le.length}return Ue},Buffer$1.byteLength=byteLength,Buffer$1.prototype._isBuffer=!0,Buffer$1.prototype.swap16=function(){const Re=this.length;if(Re%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let Le=0;Le<Re;Le+=2)swap(this,Le,Le+1);return this},Buffer$1.prototype.swap32=function(){const Re=this.length;if(Re%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let Le=0;Le<Re;Le+=4)swap(this,Le,Le+3),swap(this,Le+1,Le+2);return this},Buffer$1.prototype.swap64=function(){const Re=this.length;if(Re%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let Le=0;Le<Re;Le+=8)swap(this,Le,Le+7),swap(this,Le+1,Le+6),swap(this,Le+2,Le+5),swap(this,Le+3,Le+4);return this},Buffer$1.prototype.toString=function(){const Re=this.length;return 0===Re?"":0===arguments.length?utf8Slice(this,0,Re):Reflect.apply(slowToString,this,arguments)},Buffer$1.prototype.toLocaleString=Buffer$1.prototype.toString,Buffer$1.prototype.equals=function(Re){if(!Buffer$1.isBuffer(Re))throw new TypeError("Argument must be a Buffer");return this===Re||0===Buffer$1.compare(this,Re)},Buffer$1.prototype.inspect=function(){let Re="";return Re=this.toString("hex",0,50).replace(/(.{2})/g,"$1 ").trim(),this.length>50&&(Re+=" ... "),"<Buffer "+Re+">"},qe&&(Buffer$1.prototype[qe]=Buffer$1.prototype.inspect),Buffer$1.prototype.compare=function(Re,Le,Oe,Ue,qe){if(isInstance(Re,Uint8Array)&&(Re=Buffer$1.from(Re,Re.offset,Re.byteLength)),!Buffer$1.isBuffer(Re))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof Re);if(void 0===Le&&(Le=0),void 0===Oe&&(Oe=Re?Re.length:0),void 0===Ue&&(Ue=0),void 0===qe&&(qe=this.length),Le<0||Oe>Re.length||Ue<0||qe>this.length)throw new RangeError("out of range index");if(Ue>=qe&&Le>=Oe)return 0;if(Ue>=qe)return-1;if(Le>=Oe)return 1;if(this===Re)return 0;let Ct=(qe>>>=0)-(Ue>>>=0),Ot=(Oe>>>=0)-(Le>>>=0);const Jt=Math.min(Ct,Ot),Hr=this.slice(Ue,qe),Jr=Re.slice(Le,Oe);for(let Re=0;Re<Jt;++Re)if(Hr[Re]!==Jr[Re]){Ct=Hr[Re],Ot=Jr[Re];break}return Ct<Ot?-1:Ot<Ct?1:0},Buffer$1.prototype.includes=function(Re,Le,Oe){return-1!==this.indexOf(Re,Le,Oe)},Buffer$1.prototype.indexOf=function(Re,Le,Oe){return bidirectionalIndexOf(this,Re,Le,Oe,!0)},Buffer$1.prototype.lastIndexOf=function(Re,Le,Oe){return bidirectionalIndexOf(this,Re,Le,Oe,!1)},Buffer$1.prototype.write=function(Re,Le,Oe,Ue){if(void 0===Le)Ue="utf8",Oe=this.length,Le=0;else if(void 0===Oe&&"string"==typeof Le)Ue=Le,Oe=this.length,Le=0;else{if(!Number.isFinite(Le))throw new TypeError("Buffer.write(string, encoding, offset[, length]) is no longer supported");Le>>>=0,Number.isFinite(Oe)?(Oe>>>=0,void 0===Ue&&(Ue="utf8")):(Ue=Oe,Oe=void 0)}const qe=this.length-Le;if((void 0===Oe||Oe>qe)&&(Oe=qe),Re.length>0&&(Oe<0||Le<0)||Le>this.length)throw new RangeError("Attempt to write outside buffer bounds");Ue||(Ue="utf8");let Ct=!1;for(;;)switch(Ue){case"hex":return hexWrite(this,Re,Le,Oe);case"utf8":case"utf-8":return utf8Write(this,Re,Le,Oe);case"ascii":case"latin1":case"binary":return asciiWrite(this,Re,Le,Oe);case"base64":return base64Write(this,Re,Le,Oe);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,Re,Le,Oe);default:if(Ct)throw new TypeError("Unknown encoding: "+Ue);Ue=(""+Ue).toLowerCase(),Ct=!0}},Buffer$1.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const Ot=4096;function asciiSlice(Re,Le,Oe){let Ue="";Oe=Math.min(Re.length,Oe);for(let qe=Le;qe<Oe;++qe)Ue+=String.fromCharCode(127&Re[qe]);return Ue}function latin1Slice(Re,Le,Oe){let Ue="";Oe=Math.min(Re.length,Oe);for(let qe=Le;qe<Oe;++qe)Ue+=String.fromCharCode(Re[qe]);return Ue}function hexSlice(Re,Le,Oe){const Ue=Re.length;(!Le||Le<0)&&(Le=0),(!Oe||Oe<0||Oe>Ue)&&(Oe=Ue);let qe="";for(let Ue=Le;Ue<Oe;++Ue)qe+=Jr[Re[Ue]];return qe}function utf16leSlice(Re,Le,Oe){const Ue=Re.slice(Le,Oe);let qe="";for(let Re=0;Re<Ue.length-1;Re+=2)qe+=String.fromCharCode(Ue[Re]+256*Ue[Re+1]);return qe}function checkOffset(Re,Le,Oe){if(Re%1!=0||Re<0)throw new RangeError("offset is not uint");if(Re+Le>Oe)throw new RangeError("Trying to access beyond buffer length")}function checkInt(Re,Le,Oe,Ue,qe,Ct){if(!Buffer$1.isBuffer(Re))throw new TypeError('"buffer" argument must be a Buffer instance');if(Le>qe||Le<Ct)throw new RangeError('"value" argument is out of bounds');if(Oe+Ue>Re.length)throw new RangeError("Index out of range")}function wrtBigUInt64LE(Re,Le,Oe,Ue,qe){checkIntBI(Le,Ue,qe,Re,Oe,7);let Ct=Number(Le&BigInt(4294967295));Re[Oe++]=Ct,Ct>>=8,Re[Oe++]=Ct,Ct>>=8,Re[Oe++]=Ct,Ct>>=8,Re[Oe++]=Ct;let Ot=Number(Le>>BigInt(32)&BigInt(4294967295));return Re[Oe++]=Ot,Ot>>=8,Re[Oe++]=Ot,Ot>>=8,Re[Oe++]=Ot,Ot>>=8,Re[Oe++]=Ot,Oe}function wrtBigUInt64BE(Re,Le,Oe,Ue,qe){checkIntBI(Le,Ue,qe,Re,Oe,7);let Ct=Number(Le&BigInt(4294967295));Re[Oe+7]=Ct,Ct>>=8,Re[Oe+6]=Ct,Ct>>=8,Re[Oe+5]=Ct,Ct>>=8,Re[Oe+4]=Ct;let Ot=Number(Le>>BigInt(32)&BigInt(4294967295));return Re[Oe+3]=Ot,Ot>>=8,Re[Oe+2]=Ot,Ot>>=8,Re[Oe+1]=Ot,Ot>>=8,Re[Oe]=Ot,Oe+8}function checkIEEE754(Re,Le,Oe,Ue,qe,Ct){if(Oe+Ue>Re.length)throw new RangeError("Index out of range");if(Oe<0)throw new RangeError("Index out of range")}function writeFloat(Re,Le,Oe,Ue,qe){return Le=+Le,Oe>>>=0,qe||checkIEEE754(Re,0,Oe,4),write(Re,Le,Oe,Ue,23,4),Oe+4}function writeDouble(Re,Le,Oe,Ue,qe){return Le=+Le,Oe>>>=0,qe||checkIEEE754(Re,0,Oe,8),write(Re,Le,Oe,Ue,52,8),Oe+8}Buffer$1.prototype.slice=function(Re,Le){const Oe=this.length;(Re=Math.trunc(Re))<0?(Re+=Oe)<0&&(Re=0):Re>Oe&&(Re=Oe),(Le=void 0===Le?Oe:Math.trunc(Le))<0?(Le+=Oe)<0&&(Le=0):Le>Oe&&(Le=Oe),Le<Re&&(Le=Re);const Ue=this.subarray(Re,Le);return Object.setPrototypeOf(Ue,Buffer$1.prototype),Ue},Buffer$1.prototype.readUintLE=Buffer$1.prototype.readUIntLE=function(Re,Le,Oe){Re>>>=0,Le>>>=0,Oe||checkOffset(Re,Le,this.length);let Ue=this[Re],qe=1,Ct=0;for(;++Ct<Le&&(qe*=256);)Ue+=this[Re+Ct]*qe;return Ue},Buffer$1.prototype.readUintBE=Buffer$1.prototype.readUIntBE=function(Re,Le,Oe){Re>>>=0,Le>>>=0,Oe||checkOffset(Re,Le,this.length);let Ue=this[Re+--Le],qe=1;for(;Le>0&&(qe*=256);)Ue+=this[Re+--Le]*qe;return Ue},Buffer$1.prototype.readUint8=Buffer$1.prototype.readUInt8=function(Re,Le){return Re>>>=0,Le||checkOffset(Re,1,this.length),this[Re]},Buffer$1.prototype.readUint16LE=Buffer$1.prototype.readUInt16LE=function(Re,Le){return Re>>>=0,Le||checkOffset(Re,2,this.length),this[Re]|this[Re+1]<<8},Buffer$1.prototype.readUint16BE=Buffer$1.prototype.readUInt16BE=function(Re,Le){return Re>>>=0,Le||checkOffset(Re,2,this.length),this[Re]<<8|this[Re+1]},Buffer$1.prototype.readUint32LE=Buffer$1.prototype.readUInt32LE=function(Re,Le){return Re>>>=0,Le||checkOffset(Re,4,this.length),(this[Re]|this[Re+1]<<8|this[Re+2]<<16)+16777216*this[Re+3]},Buffer$1.prototype.readUint32BE=Buffer$1.prototype.readUInt32BE=function(Re,Le){return Re>>>=0,Le||checkOffset(Re,4,this.length),16777216*this[Re]+(this[Re+1]<<16|this[Re+2]<<8|this[Re+3])},Buffer$1.prototype.readBigUInt64LE=defineBigIntMethod((function(Re){validateNumber(Re>>>=0,"offset");const Le=this[Re],Oe=this[Re+7];void 0!==Le&&void 0!==Oe||boundsError(Re,this.length-8);const Ue=Le+256*this[++Re]+65536*this[++Re]+this[++Re]*2**24,qe=this[++Re]+256*this[++Re]+65536*this[++Re]+Oe*2**24;return BigInt(Ue)+(BigInt(qe)<<BigInt(32))})),Buffer$1.prototype.readBigUInt64BE=defineBigIntMethod((function(Re){validateNumber(Re>>>=0,"offset");const Le=this[Re],Oe=this[Re+7];void 0!==Le&&void 0!==Oe||boundsError(Re,this.length-8);const Ue=Le*2**24+65536*this[++Re]+256*this[++Re]+this[++Re],qe=this[++Re]*2**24+65536*this[++Re]+256*this[++Re]+Oe;return(BigInt(Ue)<<BigInt(32))+BigInt(qe)})),Buffer$1.prototype.readIntLE=function(Re,Le,Oe){Re>>>=0,Le>>>=0,Oe||checkOffset(Re,Le,this.length);let Ue=this[Re],qe=1,Ct=0;for(;++Ct<Le&&(qe*=256);)Ue+=this[Re+Ct]*qe;return qe*=128,Ue>=qe&&(Ue-=Math.pow(2,8*Le)),Ue},Buffer$1.prototype.readIntBE=function(Re,Le,Oe){Re>>>=0,Le>>>=0,Oe||checkOffset(Re,Le,this.length);let Ue=Le,qe=1,Ct=this[Re+--Ue];for(;Ue>0&&(qe*=256);)Ct+=this[Re+--Ue]*qe;return qe*=128,Ct>=qe&&(Ct-=Math.pow(2,8*Le)),Ct},Buffer$1.prototype.readInt8=function(Re,Le){return Re>>>=0,Le||checkOffset(Re,1,this.length),128&this[Re]?-1*(255-this[Re]+1):this[Re]},Buffer$1.prototype.readInt16LE=function(Re,Le){Re>>>=0,Le||checkOffset(Re,2,this.length);const Oe=this[Re]|this[Re+1]<<8;return 32768&Oe?4294901760|Oe:Oe},Buffer$1.prototype.readInt16BE=function(Re,Le){Re>>>=0,Le||checkOffset(Re,2,this.length);const Oe=this[Re+1]|this[Re]<<8;return 32768&Oe?4294901760|Oe:Oe},Buffer$1.prototype.readInt32LE=function(Re,Le){return Re>>>=0,Le||checkOffset(Re,4,this.length),this[Re]|this[Re+1]<<8|this[Re+2]<<16|this[Re+3]<<24},Buffer$1.prototype.readInt32BE=function(Re,Le){return Re>>>=0,Le||checkOffset(Re,4,this.length),this[Re]<<24|this[Re+1]<<16|this[Re+2]<<8|this[Re+3]},Buffer$1.prototype.readBigInt64LE=defineBigIntMethod((function(Re){validateNumber(Re>>>=0,"offset");const Le=this[Re],Oe=this[Re+7];void 0!==Le&&void 0!==Oe||boundsError(Re,this.length-8);const Ue=this[Re+4]+256*this[Re+5]+65536*this[Re+6]+(Oe<<24);return(BigInt(Ue)<<BigInt(32))+BigInt(Le+256*this[++Re]+65536*this[++Re]+this[++Re]*2**24)})),Buffer$1.prototype.readBigInt64BE=defineBigIntMethod((function(Re){validateNumber(Re>>>=0,"offset");const Le=this[Re],Oe=this[Re+7];void 0!==Le&&void 0!==Oe||boundsError(Re,this.length-8);const Ue=(Le<<24)+65536*this[++Re]+256*this[++Re]+this[++Re];return(BigInt(Ue)<<BigInt(32))+BigInt(this[++Re]*2**24+65536*this[++Re]+256*this[++Re]+Oe)})),Buffer$1.prototype.readFloatLE=function(Re,Le){return Re>>>=0,Le||checkOffset(Re,4,this.length),read(this,Re,!0,23,4)},Buffer$1.prototype.readFloatBE=function(Re,Le){return Re>>>=0,Le||checkOffset(Re,4,this.length),read(this,Re,!1,23,4)},Buffer$1.prototype.readDoubleLE=function(Re,Le){return Re>>>=0,Le||checkOffset(Re,8,this.length),read(this,Re,!0,52,8)},Buffer$1.prototype.readDoubleBE=function(Re,Le){return Re>>>=0,Le||checkOffset(Re,8,this.length),read(this,Re,!1,52,8)},Buffer$1.prototype.writeUintLE=Buffer$1.prototype.writeUIntLE=function(Re,Le,Oe,Ue){if(Re=+Re,Le>>>=0,Oe>>>=0,!Ue){checkInt(this,Re,Le,Oe,Math.pow(2,8*Oe)-1,0)}let qe=1,Ct=0;for(this[Le]=255&Re;++Ct<Oe&&(qe*=256);)this[Le+Ct]=Re/qe&255;return Le+Oe},Buffer$1.prototype.writeUintBE=Buffer$1.prototype.writeUIntBE=function(Re,Le,Oe,Ue){if(Re=+Re,Le>>>=0,Oe>>>=0,!Ue){checkInt(this,Re,Le,Oe,Math.pow(2,8*Oe)-1,0)}let qe=Oe-1,Ct=1;for(this[Le+qe]=255&Re;--qe>=0&&(Ct*=256);)this[Le+qe]=Re/Ct&255;return Le+Oe},Buffer$1.prototype.writeUint8=Buffer$1.prototype.writeUInt8=function(Re,Le,Oe){return Re=+Re,Le>>>=0,Oe||checkInt(this,Re,Le,1,255,0),this[Le]=255&Re,Le+1},Buffer$1.prototype.writeUint16LE=Buffer$1.prototype.writeUInt16LE=function(Re,Le,Oe){return Re=+Re,Le>>>=0,Oe||checkInt(this,Re,Le,2,65535,0),this[Le]=255&Re,this[Le+1]=Re>>>8,Le+2},Buffer$1.prototype.writeUint16BE=Buffer$1.prototype.writeUInt16BE=function(Re,Le,Oe){return Re=+Re,Le>>>=0,Oe||checkInt(this,Re,Le,2,65535,0),this[Le]=Re>>>8,this[Le+1]=255&Re,Le+2},Buffer$1.prototype.writeUint32LE=Buffer$1.prototype.writeUInt32LE=function(Re,Le,Oe){return Re=+Re,Le>>>=0,Oe||checkInt(this,Re,Le,4,4294967295,0),this[Le+3]=Re>>>24,this[Le+2]=Re>>>16,this[Le+1]=Re>>>8,this[Le]=255&Re,Le+4},Buffer$1.prototype.writeUint32BE=Buffer$1.prototype.writeUInt32BE=function(Re,Le,Oe){return Re=+Re,Le>>>=0,Oe||checkInt(this,Re,Le,4,4294967295,0),this[Le]=Re>>>24,this[Le+1]=Re>>>16,this[Le+2]=Re>>>8,this[Le+3]=255&Re,Le+4},Buffer$1.prototype.writeBigUInt64LE=defineBigIntMethod((function(Re,Le=0){return wrtBigUInt64LE(this,Re,Le,BigInt(0),BigInt("0xffffffffffffffff"))})),Buffer$1.prototype.writeBigUInt64BE=defineBigIntMethod((function(Re,Le=0){return wrtBigUInt64BE(this,Re,Le,BigInt(0),BigInt("0xffffffffffffffff"))})),Buffer$1.prototype.writeIntLE=function(Re,Le,Oe,Ue){if(Re=+Re,Le>>>=0,!Ue){const Ue=Math.pow(2,8*Oe-1);checkInt(this,Re,Le,Oe,Ue-1,-Ue)}let qe=0,Ct=1,Ot=0;for(this[Le]=255&Re;++qe<Oe&&(Ct*=256);)Re<0&&0===Ot&&0!==this[Le+qe-1]&&(Ot=1),this[Le+qe]=Math.trunc(Re/Ct)-Ot&255;return Le+Oe},Buffer$1.prototype.writeIntBE=function(Re,Le,Oe,Ue){if(Re=+Re,Le>>>=0,!Ue){const Ue=Math.pow(2,8*Oe-1);checkInt(this,Re,Le,Oe,Ue-1,-Ue)}let qe=Oe-1,Ct=1,Ot=0;for(this[Le+qe]=255&Re;--qe>=0&&(Ct*=256);)Re<0&&0===Ot&&0!==this[Le+qe+1]&&(Ot=1),this[Le+qe]=Math.trunc(Re/Ct)-Ot&255;return Le+Oe},Buffer$1.prototype.writeInt8=function(Re,Le,Oe){return Re=+Re,Le>>>=0,Oe||checkInt(this,Re,Le,1,127,-128),Re<0&&(Re=255+Re+1),this[Le]=255&Re,Le+1},Buffer$1.prototype.writeInt16LE=function(Re,Le,Oe){return Re=+Re,Le>>>=0,Oe||checkInt(this,Re,Le,2,32767,-32768),this[Le]=255&Re,this[Le+1]=Re>>>8,Le+2},Buffer$1.prototype.writeInt16BE=function(Re,Le,Oe){return Re=+Re,Le>>>=0,Oe||checkInt(this,Re,Le,2,32767,-32768),this[Le]=Re>>>8,this[Le+1]=255&Re,Le+2},Buffer$1.prototype.writeInt32LE=function(Re,Le,Oe){return Re=+Re,Le>>>=0,Oe||checkInt(this,Re,Le,4,2147483647,-2147483648),this[Le]=255&Re,this[Le+1]=Re>>>8,this[Le+2]=Re>>>16,this[Le+3]=Re>>>24,Le+4},Buffer$1.prototype.writeInt32BE=function(Re,Le,Oe){return Re=+Re,Le>>>=0,Oe||checkInt(this,Re,Le,4,2147483647,-2147483648),Re<0&&(Re=4294967295+Re+1),this[Le]=Re>>>24,this[Le+1]=Re>>>16,this[Le+2]=Re>>>8,this[Le+3]=255&Re,Le+4},Buffer$1.prototype.writeBigInt64LE=defineBigIntMethod((function(Re,Le=0){return wrtBigUInt64LE(this,Re,Le,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),Buffer$1.prototype.writeBigInt64BE=defineBigIntMethod((function(Re,Le=0){return wrtBigUInt64BE(this,Re,Le,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),Buffer$1.prototype.writeFloatLE=function(Re,Le,Oe){return writeFloat(this,Re,Le,!0,Oe)},Buffer$1.prototype.writeFloatBE=function(Re,Le,Oe){return writeFloat(this,Re,Le,!1,Oe)},Buffer$1.prototype.writeDoubleLE=function(Re,Le,Oe){return writeDouble(this,Re,Le,!0,Oe)},Buffer$1.prototype.writeDoubleBE=function(Re,Le,Oe){return writeDouble(this,Re,Le,!1,Oe)},Buffer$1.prototype.copy=function(Re,Le,Oe,Ue){if(!Buffer$1.isBuffer(Re))throw new TypeError("argument should be a Buffer");if(Oe||(Oe=0),Ue||0===Ue||(Ue=this.length),Le>=Re.length&&(Le=Re.length),Le||(Le=0),Ue>0&&Ue<Oe&&(Ue=Oe),Ue===Oe)return 0;if(0===Re.length||0===this.length)return 0;if(Le<0)throw new RangeError("targetStart out of bounds");if(Oe<0||Oe>=this.length)throw new RangeError("Index out of range");if(Ue<0)throw new RangeError("sourceEnd out of bounds");Ue>this.length&&(Ue=this.length),Re.length-Le<Ue-Oe&&(Ue=Re.length-Le+Oe);const qe=Ue-Oe;return this===Re&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(Le,Oe,Ue):Uint8Array.prototype.set.call(Re,this.subarray(Oe,Ue),Le),qe},Buffer$1.prototype.fill=function(Re,Le,Oe,Ue){if("string"==typeof Re){if("string"==typeof Le?(Ue=Le,Le=0,Oe=this.length):"string"==typeof Oe&&(Ue=Oe,Oe=this.length),void 0!==Ue&&"string"!=typeof Ue)throw new TypeError("encoding must be a string");if("string"==typeof Ue&&!Buffer$1.isEncoding(Ue))throw new TypeError("Unknown encoding: "+Ue);if(1===Re.length){const Le=Re.charCodeAt(0);("utf8"===Ue&&Le<128||"latin1"===Ue)&&(Re=Le)}}else"number"==typeof Re?Re&=255:"boolean"==typeof Re&&(Re=Number(Re));if(Le<0||this.length<Le||this.length<Oe)throw new RangeError("Out of range index");if(Oe<=Le)return this;let qe;if(Le>>>=0,Oe=void 0===Oe?this.length:Oe>>>0,Re||(Re=0),"number"==typeof Re)for(qe=Le;qe<Oe;++qe)this[qe]=Re;else{const Ct=Buffer$1.isBuffer(Re)?Re:Buffer$1.from(Re,Ue),Ot=Ct.length;if(0===Ot)throw new TypeError('The value "'+Re+'" is invalid for argument "value"');for(qe=0;qe<Oe-Le;++qe)this[qe+Le]=Ct[qe%Ot]}return this};const Jt={};function E(Re,Le,Oe){Jt[Re]=class extends Oe{constructor(){super(),Object.defineProperty(this,"message",{value:Reflect.apply(Le,this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${Re}]`,this.stack,delete this.name}get code(){return Re}set code(Re){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:Re,writable:!0})}toString(){return`${this.name} [${Re}]: ${this.message}`}}}function addNumericalSeparator(Re){let Le="",Oe=Re.length;const Ue="-"===Re[0]?1:0;for(;Oe>=Ue+4;Oe-=3)Le=`_${Re.slice(Oe-3,Oe)}${Le}`;return`${Re.slice(0,Oe)}${Le}`}function checkIntBI(Re,Le,Oe,Ue,qe,Ct){if(Re>Oe||Re<Le){const Oe="bigint"==typeof Le?"n":"";let Ue;throw Ue=0===Le||Le===BigInt(0)?`>= 0${Oe} and < 2${Oe} ** ${8*(Ct+1)}${Oe}`:`>= -(2${Oe} ** ${8*(Ct+1)-1}${Oe}) and < 2 ** ${8*(Ct+1)-1}${Oe}`,new Jt.ERR_OUT_OF_RANGE("value",Ue,Re)}!function(Re,Le,Oe){validateNumber(Le,"offset"),void 0!==Re[Le]&&void 0!==Re[Le+Oe]||boundsError(Le,Re.length-(Oe+1))}(Ue,qe,Ct)}function validateNumber(Re,Le){if("number"!=typeof Re)throw new Jt.ERR_INVALID_ARG_TYPE(Le,"number",Re)}function boundsError(Re,Le,Oe){if(Math.floor(Re)!==Re)throw validateNumber(Re,Oe),new Jt.ERR_OUT_OF_RANGE("offset","an integer",Re);if(Le<0)throw new Jt.ERR_BUFFER_OUT_OF_BOUNDS;throw new Jt.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${Le}`,Re)}E("ERR_BUFFER_OUT_OF_BOUNDS",(function(Re){return Re?`${Re} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),E("ERR_INVALID_ARG_TYPE",(function(Re,Le){return`The "${Re}" argument must be of type number. Received type ${typeof Le}`}),TypeError),E("ERR_OUT_OF_RANGE",(function(Re,Le,Oe){let Ue=`The value of "${Re}" is out of range.`,qe=Oe;return Number.isInteger(Oe)&&Math.abs(Oe)>2**32?qe=addNumericalSeparator(String(Oe)):"bigint"==typeof Oe&&(qe=String(Oe),(Oe>BigInt(2)**BigInt(32)||Oe<-(BigInt(2)**BigInt(32)))&&(qe=addNumericalSeparator(qe)),qe+="n"),Ue+=` It must be ${Le}. Received ${qe}`,Ue}),RangeError);const Hr=/[^\w+/-]/g;function utf8ToBytes(Re,Le){let Oe;Le=Le||Number.POSITIVE_INFINITY;const Ue=Re.length;let qe=null;const Ct=[];for(let Ot=0;Ot<Ue;++Ot){if(Oe=Re.charCodeAt(Ot),Oe>55295&&Oe<57344){if(!qe){if(Oe>56319){(Le-=3)>-1&&Ct.push(239,191,189);continue}if(Ot+1===Ue){(Le-=3)>-1&&Ct.push(239,191,189);continue}qe=Oe;continue}if(Oe<56320){(Le-=3)>-1&&Ct.push(239,191,189),qe=Oe;continue}Oe=65536+(qe-55296<<10|Oe-56320)}else qe&&(Le-=3)>-1&&Ct.push(239,191,189);if(qe=null,Oe<128){if((Le-=1)<0)break;Ct.push(Oe)}else if(Oe<2048){if((Le-=2)<0)break;Ct.push(Oe>>6|192,63&Oe|128)}else if(Oe<65536){if((Le-=3)<0)break;Ct.push(Oe>>12|224,Oe>>6&63|128,63&Oe|128)}else{if(!(Oe<1114112))throw new Error("Invalid code point");if((Le-=4)<0)break;Ct.push(Oe>>18|240,Oe>>12&63|128,Oe>>6&63|128,63&Oe|128)}}return Ct}function base64ToBytes(Re){return toByteArray(function(Re){if((Re=(Re=Re.split("=")[0]).trim().replace(Hr,"")).length<2)return"";for(;Re.length%4!=0;)Re+="=";return Re}(Re))}function blitBuffer(Re,Le,Oe,Ue){let qe;for(qe=0;qe<Ue&&!(qe+Oe>=Le.length||qe>=Re.length);++qe)Le[qe+Oe]=Re[qe];return qe}function isInstance(Re,Le){return Re instanceof Le||null!=Re&&null!=Re.constructor&&null!=Re.constructor.name&&Re.constructor.name===Le.name}function numberIsNaN(Re){return Re!=Re}const Jr=function(){const Re="0123456789abcdef",Le=Array.from({length:256});for(let Oe=0;Oe<16;++Oe){const Ue=16*Oe;for(let qe=0;qe<16;++qe)Le[Ue+qe]=Re[Oe]+Re[qe]}return Le}();function defineBigIntMethod(Re){return"undefined"==typeof BigInt?BufferBigIntNotDefined:Re}function BufferBigIntNotDefined(){throw new Error("BigInt not supported")}const Ln=globalThis.Buffer||Buffer$1;notImplemented("buffer.resolveObjectURL"),notImplemented("buffer.transcode"),notImplemented("buffer.isUtf8"),notImplemented("buffer.isAscii");const Nn=/#/g,$n=/&/g,Gn=/\//g,qn=/=/g,Zn=/\+/g,Xn=/%5e/gi,Yn=/%60/gi,_i=/%7c/gi,vi=/%20/gi;function encodeQueryValue$2(Re){return(Le="string"==typeof Re?Re:JSON.stringify(Re),encodeURI(""+Le).replace(_i,"|")).replace(Zn,"%2B").replace(vi,"+").replace(Nn,"%23").replace($n,"%26").replace(Yn,"`").replace(Xn,"^").replace(Gn,"%2F");var Le}function encodeQueryKey$2(Re){return encodeQueryValue$2(Re).replace(qn,"%3D")}function decode$4(Re=""){try{return decodeURIComponent(""+Re)}catch{return""+Re}}function decodeQueryValue$1(Re){return decode$4(Re.replace(Zn," "))}function parseQuery$2(Re=""){const Le={};"?"===Re[0]&&(Re=Re.slice(1));for(const Oe of Re.split("&")){const Re=Oe.match(/([^=]+)=?(.*)/)||[];if(Re.length<2)continue;const Ue=decode$4(Re[1].replace(Zn," "));if("__proto__"===Ue||"constructor"===Ue)continue;const qe=decodeQueryValue$1(Re[2]||"");void 0===Le[Ue]?Le[Ue]=qe:Array.isArray(Le[Ue])?Le[Ue].push(qe):Le[Ue]=[Le[Ue],qe]}return Le}function stringifyQuery$2(Re){return Object.keys(Re).filter((Le=>void 0!==Re[Le])).map((Le=>{return Oe=Le,"number"!=typeof(Ue=Re[Le])&&"boolean"!=typeof Ue||(Ue=String(Ue)),Ue?Array.isArray(Ue)?Ue.map((Re=>`${encodeQueryKey$2(Oe)}=${encodeQueryValue$2(Re)}`)).join("&"):`${encodeQueryKey$2(Oe)}=${encodeQueryValue$2(Ue)}`:encodeQueryKey$2(Oe);var Oe,Ue})).filter(Boolean).join("&")}const xi=/^[\s\w\0+.-]{2,}:([/\\]{1,2})/,bi=/^[\s\w\0+.-]{2,}:([/\\]{2})?/,Pi=/^([/\\]\s*){2,}[^/\\]/,lo=/^\.?\//;function hasProtocol$1(Re,Le={}){return"boolean"==typeof Le&&(Le={acceptRelative:Le}),Le.strict?xi.test(Re):bi.test(Re)||!!Le.acceptRelative&&Pi.test(Re)}function withoutTrailingSlash$1(Re="",Le){return(function(Re=""){return Re.endsWith("/")}(Re)?Re.slice(0,-1):Re)||"/"}function withTrailingSlash$1(Re="",Le){return Re.endsWith("/")?Re:Re+"/"}function withLeadingSlash$1(Re=""){return function(Re=""){return Re.startsWith("/")}(Re)?Re:"/"+Re}function withoutBase(Re,Le){if(isEmptyURL(Le))return Re;const Oe=withoutTrailingSlash$1(Le);if(!Re.startsWith(Oe))return Re;const Ue=Re.slice(Oe.length);return"/"===Ue[0]?Ue:"/"+Ue}function withQuery$1(Re,Le){const Oe=parseURL$2(Re),Ue={...parseQuery$2(Oe.search),...Le};return Oe.search=stringifyQuery$2(Ue),function(Re){const Le=Re.pathname||"",Oe=Re.search?(Re.search.startsWith("?")?"":"?")+Re.search:"",Ue=Re.hash||"",qe=Re.auth?Re.auth+"@":"",Ct=Re.host||"",Ot=Re.protocol||Re[uo]?(Re.protocol||"")+"//":"";return Ot+qe+Ct+Le+Oe+Ue}(Oe)}function getQuery$1(Re){return parseQuery$2(parseURL$2(Re).search)}function isEmptyURL(Re){return!Re||"/"===Re}function joinURL$1(Re,...Le){let Oe=Re||"";for(const Re of Le.filter((Re=>function(Re){return Re&&"/"!==Re}(Re))))if(Oe){const Le=Re.replace(lo,"");Oe=withTrailingSlash$1(Oe)+Le}else Oe=Re;return Oe}function joinRelativeURL(...Re){const Le=/\/(?!\/)/,Oe=Re.filter(Boolean),Ue=[];let qe=0;for(const Re of Oe)if(Re&&"/"!==Re)for(const[Oe,Ct]of Re.split(Le).entries())if(Ct&&"."!==Ct)if(".."!==Ct)1===Oe&&Ue[Ue.length-1]?.endsWith(":/")?Ue[Ue.length-1]+="/"+Ct:(Ue.push(Ct),qe++);else{if(1===Ue.length&&hasProtocol$1(Ue[0]))continue;Ue.pop(),qe--}let Ct=Ue.join("/");return qe>=0?Oe[0]?.startsWith("/")&&!Ct.startsWith("/")?Ct="/"+Ct:Oe[0]?.startsWith("./")&&!Ct.startsWith("./")&&(Ct="./"+Ct):Ct="../".repeat(-1*qe)+Ct,Oe[Oe.length-1]?.endsWith("/")&&!Ct.endsWith("/")&&(Ct+="/"),Ct}const uo=Symbol.for("ufo:protocolRelative");function parseURL$2(Re="",Le){const Oe=Re.match(/^[\s\0]*(blob:|data:|javascript:|vbscript:)(.*)/i);if(Oe){const[,Re,Le=""]=Oe;return{protocol:Re.toLowerCase(),pathname:Le,href:Re+Le,auth:"",host:"",search:"",hash:""}}if(!hasProtocol$1(Re,{acceptRelative:!0}))return parsePath$1(Re);const[,Ue="",qe,Ct=""]=Re.replace(/\\/g,"/").match(/^[\s\0]*([\w+.-]{2,}:)?\/\/([^/@]+@)?(.*)/)||[];let[,Ot="",Jt=""]=Ct.match(/([^#/?]*)(.*)?/)||[];"file:"===Ue&&(Jt=Jt.replace(/\/(?=[A-Za-z]:)/,""));const{pathname:Hr,search:Jr,hash:Ln}=parsePath$1(Jt);return{protocol:Ue.toLowerCase(),auth:qe?qe.slice(0,Math.max(0,qe.length-1)):"",host:Ot,pathname:Hr,search:Jr,hash:Ln,[uo]:!Ue}}function parsePath$1(Re=""){const[Le="",Oe="",Ue=""]=(Re.match(/([^#?]*)(\?[^#]*)?(#.*)?/)||[]).splice(1);return{pathname:Le,search:Oe,hash:Ue}}function parse$1(Re,Le){if("string"!=typeof Re)throw new TypeError("argument str must be a string");const Oe={},Ue=Le||{},qe=Ue.decode||decode$3;let Ct=0;for(;Ct<Re.length;){const Le=Re.indexOf("=",Ct);if(-1===Le)break;let Ot=Re.indexOf(";",Ct);if(-1===Ot)Ot=Re.length;else if(Ot<Le){Ct=Re.lastIndexOf(";",Le-1)+1;continue}const Jt=Re.slice(Ct,Le).trim();if(!Ue?.filter||Ue?.filter(Jt)){if(void 0===Oe[Jt]){let Ue=Re.slice(Le+1,Ot).trim();34===Ue.codePointAt(0)&&(Ue=Ue.slice(1,-1)),Oe[Jt]=tryDecode(Ue,qe)}Ct=Ot+1}else Ct=Ot+1}return Oe}function decode$3(Re){return Re.includes("%")?decodeURIComponent(Re):Re}function tryDecode(Re,Le){try{return Le(Re)}catch{return Re}}const po=/^[\u0009\u0020-\u007E\u0080-\u00FF]+$/;function serialize(Re,Le,Oe){const Ue=Oe||{},qe=Ue.encode||encodeURIComponent;if("function"!=typeof qe)throw new TypeError("option encode is invalid");if(!po.test(Re))throw new TypeError("argument name is invalid");const Ct=qe(Le);if(Ct&&!po.test(Ct))throw new TypeError("argument val is invalid");let Ot=Re+"="+Ct;if(void 0!==Ue.maxAge&&null!==Ue.maxAge){const Re=Ue.maxAge-0;if(Number.isNaN(Re)||!Number.isFinite(Re))throw new TypeError("option maxAge is invalid");Ot+="; Max-Age="+Math.floor(Re)}if(Ue.domain){if(!po.test(Ue.domain))throw new TypeError("option domain is invalid");Ot+="; Domain="+Ue.domain}if(Ue.path){if(!po.test(Ue.path))throw new TypeError("option path is invalid");Ot+="; Path="+Ue.path}if(Ue.expires){if(Jt=Ue.expires,!("[object Date]"===Object.prototype.toString.call(Jt)||Jt instanceof Date)||Number.isNaN(Ue.expires.valueOf()))throw new TypeError("option expires is invalid");Ot+="; Expires="+Ue.expires.toUTCString()}var Jt;if(Ue.httpOnly&&(Ot+="; HttpOnly"),Ue.secure&&(Ot+="; Secure"),Ue.priority){switch("string"==typeof Ue.priority?Ue.priority.toLowerCase():Ue.priority){case"low":Ot+="; Priority=Low";break;case"medium":Ot+="; Priority=Medium";break;case"high":Ot+="; Priority=High";break;default:throw new TypeError("option priority is invalid")}}if(Ue.sameSite){switch("string"==typeof Ue.sameSite?Ue.sameSite.toLowerCase():Ue.sameSite){case!0:Ot+="; SameSite=Strict";break;case"lax":Ot+="; SameSite=Lax";break;case"strict":Ot+="; SameSite=Strict";break;case"none":Ot+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}}return Ue.partitioned&&(Ot+="; Partitioned"),Ot}const fo=Object.freeze({ignoreUnknown:!1,respectType:!1,respectFunctionNames:!1,respectFunctionProperties:!1,unorderedObjects:!0,unorderedArrays:!1,unorderedSets:!1,excludeKeys:void 0,excludeValues:void 0,replacer:void 0});function objectHash(Re,Le){const Oe=createHasher(Le=Le?{...fo,...Le}:fo);return Oe.dispatch(Re),Oe.toString()}const Io=Object.freeze(["prototype","__proto__","constructor"]);function createHasher(Re){let Le="",Oe=new Map;const write=Re=>{Le+=Re};return{toString:()=>Le,getContext:()=>Oe,dispatch(Le){Re.replacer&&(Le=Re.replacer(Le));return this[null===Le?"null":typeof Le](Le)},object(Le){if(Le&&"function"==typeof Le.toJSON)return this.object(Le.toJSON());const Ue=Object.prototype.toString.call(Le);let qe="";const Ct=Ue.length;qe=Ct<10?"unknown:["+Ue+"]":Ue.slice(8,Ct-1),qe=qe.toLowerCase();let Ot=null;if(void 0!==(Ot=Oe.get(Le)))return this.dispatch("[CIRCULAR:"+Ot+"]");if(Oe.set(Le,Oe.size),void 0!==Ln&&Ln.isBuffer&&Ln.isBuffer(Le))return write("buffer:"),write(Le.toString("utf8"));if("object"!==qe&&"function"!==qe&&"asyncfunction"!==qe)this[qe]?this[qe](Le):Re.ignoreUnknown||this.unkown(Le,qe);else{let Oe=Object.keys(Le);Re.unorderedObjects&&(Oe=Oe.sort());let Ue=[];!1===Re.respectType||isNativeFunction(Le)||(Ue=Io),Re.excludeKeys&&(Oe=Oe.filter((Le=>!Re.excludeKeys(Le))),Ue=Ue.filter((Le=>!Re.excludeKeys(Le)))),write("object:"+(Oe.length+Ue.length)+":");const dispatchForKey=Oe=>{this.dispatch(Oe),write(":"),Re.excludeValues||this.dispatch(Le[Oe]),write(",")};for(const Re of Oe)dispatchForKey(Re);for(const Re of Ue)dispatchForKey(Re)}},array(Le,Ue){if(Ue=void 0===Ue?!1!==Re.unorderedArrays:Ue,write("array:"+Le.length+":"),!Ue||Le.length<=1){for(const Re of Le)this.dispatch(Re);return}const qe=new Map,Ct=Le.map((Le=>{const Oe=createHasher(Re);Oe.dispatch(Le);for(const[Re,Le]of Oe.getContext())qe.set(Re,Le);return Oe.toString()}));return Oe=qe,Ct.sort(),this.array(Ct,!1)},date:Re=>write("date:"+Re.toJSON()),symbol:Re=>write("symbol:"+Re.toString()),unkown(Re,Le){if(write(Le),Re)return write(":"),Re&&"function"==typeof Re.entries?this.array(Array.from(Re.entries()),!0):void 0},error:Re=>write("error:"+Re.toString()),boolean:Re=>write("bool:"+Re),string(Re){write("string:"+Re.length+":"),write(Re)},function(Le){write("fn:"),isNativeFunction(Le)?this.dispatch("[native]"):this.dispatch(Le.toString()),!1!==Re.respectFunctionNames&&this.dispatch("function-name:"+String(Le.name)),Re.respectFunctionProperties&&this.object(Le)},number:Re=>write("number:"+Re),xml:Re=>write("xml:"+Re.toString()),null:()=>write("Null"),undefined:()=>write("Undefined"),regexp:Re=>write("regex:"+Re.toString()),uint8array(Re){return write("uint8array:"),this.dispatch(Array.prototype.slice.call(Re))},uint8clampedarray(Re){return write("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(Re))},int8array(Re){return write("int8array:"),this.dispatch(Array.prototype.slice.call(Re))},uint16array(Re){return write("uint16array:"),this.dispatch(Array.prototype.slice.call(Re))},int16array(Re){return write("int16array:"),this.dispatch(Array.prototype.slice.call(Re))},uint32array(Re){return write("uint32array:"),this.dispatch(Array.prototype.slice.call(Re))},int32array(Re){return write("int32array:"),this.dispatch(Array.prototype.slice.call(Re))},float32array(Re){return write("float32array:"),this.dispatch(Array.prototype.slice.call(Re))},float64array(Re){return write("float64array:"),this.dispatch(Array.prototype.slice.call(Re))},arraybuffer(Re){return write("arraybuffer:"),this.dispatch(new Uint8Array(Re))},url:Re=>write("url:"+Re.toString()),map(Le){write("map:");const Oe=[...Le];return this.array(Oe,!1!==Re.unorderedSets)},set(Le){write("set:");const Oe=[...Le];return this.array(Oe,!1!==Re.unorderedSets)},file(Re){return write("file:"),this.dispatch([Re.name,Re.size,Re.type,Re.lastModfied])},blob(){if(Re.ignoreUnknown)return write("[blob]");throw new Error('Hashing Blob objects is currently not supported\nUse "options.replacer" or "options.ignoreUnknown"\n')},domwindow:()=>write("domwindow"),bigint:Re=>write("bigint:"+Re.toString()),process:()=>write("process"),timer:()=>write("timer"),pipe:()=>write("pipe"),tcp:()=>write("tcp"),udp:()=>write("udp"),tty:()=>write("tty"),statwatcher:()=>write("statwatcher"),securecontext:()=>write("securecontext"),connection:()=>write("connection"),zlib:()=>write("zlib"),context:()=>write("context"),nodescript:()=>write("nodescript"),httpparser:()=>write("httpparser"),dataview:()=>write("dataview"),signal:()=>write("signal"),fsevent:()=>write("fsevent"),tlswrap:()=>write("tlswrap")}}const is="[native code] }",as=is.length;function isNativeFunction(Re){return"function"==typeof Re&&Function.prototype.toString.call(Re).slice(-as)===is}var Is=Object.defineProperty,__publicField$1$1=(Re,Le,Oe)=>(((Re,Le,Oe)=>{Le in Re?Is(Re,Le,{enumerable:!0,configurable:!0,writable:!0,value:Oe}):Re[Le]=Oe})(Re,"symbol"!=typeof Le?Le+"":Le,Oe),Oe);class WordArray{constructor(Re,Le){__publicField$1$1(this,"words"),__publicField$1$1(this,"sigBytes"),Re=this.words=Re||[],this.sigBytes=void 0===Le?4*Re.length:Le}toString(Re){return(Re||Xs).stringify(this)}concat(Re){if(this.clamp(),this.sigBytes%4)for(let Le=0;Le<Re.sigBytes;Le++){const Oe=Re.words[Le>>>2]>>>24-Le%4*8&255;this.words[this.sigBytes+Le>>>2]|=Oe<<24-(this.sigBytes+Le)%4*8}else for(let Le=0;Le<Re.sigBytes;Le+=4)this.words[this.sigBytes+Le>>>2]=Re.words[Le>>>2];return this.sigBytes+=Re.sigBytes,this}clamp(){this.words[this.sigBytes>>>2]&=4294967295<<32-this.sigBytes%4*8,this.words.length=Math.ceil(this.sigBytes/4)}clone(){return new WordArray([...this.words])}}const Xs={stringify(Re){const Le=[];for(let Oe=0;Oe<Re.sigBytes;Oe++){const Ue=Re.words[Oe>>>2]>>>24-Oe%4*8&255;Le.push((Ue>>>4).toString(16),(15&Ue).toString(16))}return Le.join("")}},ta={stringify(Re){const Le=[];for(let Oe=0;Oe<Re.sigBytes;Oe+=3){const Ue=(Re.words[Oe>>>2]>>>24-Oe%4*8&255)<<16|(Re.words[Oe+1>>>2]>>>24-(Oe+1)%4*8&255)<<8|Re.words[Oe+2>>>2]>>>24-(Oe+2)%4*8&255;for(let qe=0;qe<4&&8*Oe+6*qe<8*Re.sigBytes;qe++)Le.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Ue>>>6*(3-qe)&63))}return Le.join("")}},ha={parse(Re){const Le=Re.length,Oe=[];for(let Ue=0;Ue<Le;Ue++)Oe[Ue>>>2]|=(255&Re.charCodeAt(Ue))<<24-Ue%4*8;return new WordArray(Oe,Le)}},el={parse:Re=>ha.parse(unescape(encodeURIComponent(Re)))};class BufferedBlockAlgorithm{constructor(){__publicField$1$1(this,"_data",new WordArray),__publicField$1$1(this,"_nDataBytes",0),__publicField$1$1(this,"_minBufferSize",0),__publicField$1$1(this,"blockSize",16)}reset(){this._data=new WordArray,this._nDataBytes=0}_append(Re){"string"==typeof Re&&(Re=el.parse(Re)),this._data.concat(Re),this._nDataBytes+=Re.sigBytes}_doProcessBlock(Re,Le){}_process(Re){let Le,Oe=this._data.sigBytes/(4*this.blockSize);Oe=Re?Math.ceil(Oe):Math.max((0|Oe)-this._minBufferSize,0);const Ue=Oe*this.blockSize,qe=Math.min(4*Ue,this._data.sigBytes);if(Ue){for(let Re=0;Re<Ue;Re+=this.blockSize)this._doProcessBlock(this._data.words,Re);Le=this._data.words.splice(0,Ue),this._data.sigBytes-=qe}return new WordArray(Le,qe)}}class Hasher extends BufferedBlockAlgorithm{update(Re){return this._append(Re),this._process(),this}finalize(Re){Re&&this._append(Re)}}var tl=Object.defineProperty,__publicField$3=(Re,Le,Oe)=>(((Re,Le,Oe)=>{Le in Re?tl(Re,Le,{enumerable:!0,configurable:!0,writable:!0,value:Oe}):Re[Le]=Oe})(Re,Le+"",Oe),Oe);const il=[1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225],sl=[1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998],fl=[];class SHA256 extends Hasher{constructor(){super(...arguments),__publicField$3(this,"_hash",new WordArray([...il]))}reset(){super.reset(),this._hash=new WordArray([...il])}_doProcessBlock(Re,Le){const Oe=this._hash.words;let Ue=Oe[0],qe=Oe[1],Ct=Oe[2],Ot=Oe[3],Jt=Oe[4],Hr=Oe[5],Jr=Oe[6],Ln=Oe[7];for(let Oe=0;Oe<64;Oe++){if(Oe<16)fl[Oe]=0|Re[Le+Oe];else{const Re=fl[Oe-15],Le=(Re<<25|Re>>>7)^(Re<<14|Re>>>18)^Re>>>3,Ue=fl[Oe-2],qe=(Ue<<15|Ue>>>17)^(Ue<<13|Ue>>>19)^Ue>>>10;fl[Oe]=Le+fl[Oe-7]+qe+fl[Oe-16]}const Nn=Ue&qe^Ue&Ct^qe&Ct,$n=(Ue<<30|Ue>>>2)^(Ue<<19|Ue>>>13)^(Ue<<10|Ue>>>22),Gn=Ln+((Jt<<26|Jt>>>6)^(Jt<<21|Jt>>>11)^(Jt<<7|Jt>>>25))+(Jt&Hr^~Jt&Jr)+sl[Oe]+fl[Oe];Ln=Jr,Jr=Hr,Hr=Jt,Jt=Ot+Gn|0,Ot=Ct,Ct=qe,qe=Ue,Ue=Gn+($n+Nn)|0}Oe[0]=Oe[0]+Ue|0,Oe[1]=Oe[1]+qe|0,Oe[2]=Oe[2]+Ct|0,Oe[3]=Oe[3]+Ot|0,Oe[4]=Oe[4]+Jt|0,Oe[5]=Oe[5]+Hr|0,Oe[6]=Oe[6]+Jr|0,Oe[7]=Oe[7]+Ln|0}finalize(Re){super.finalize(Re);const Le=8*this._nDataBytes,Oe=8*this._data.sigBytes;return this._data.words[Oe>>>5]|=128<<24-Oe%32,this._data.words[14+(Oe+64>>>9<<4)]=Math.floor(Le/4294967296),this._data.words[15+(Oe+64>>>9<<4)]=Le,this._data.sigBytes=4*this._data.words.length,this._process(),this._hash}}function hash(Re,Le={}){const Oe="string"==typeof Re?Re:objectHash(Re,Le);return(Ue=Oe,(new SHA256).finalize(Ue).toString(ta)).slice(0,10);var Ue}function isEqual$1(Re,Le,Oe={}){return Re===Le||objectHash(Re,Oe)===objectHash(Le,Oe)}const Al=0,Ml=1,Hl=2;function createRouter$2(Re={}){const Le={options:Re,rootNode:createRadixNode(),staticRoutesMap:{}},normalizeTrailingSlash=Le=>Re.strictTrailingSlash?Le:Le.replace(/\/$/,"")||"/";if(Re.routes)for(const Oe in Re.routes)insert(Le,normalizeTrailingSlash(Oe),Re.routes[Oe]);return{ctx:Le,lookup:Re=>function(Re,Le){const Oe=Re.staticRoutesMap[Le];if(Oe)return Oe.data;const Ue=Le.split("/"),qe={};let Ct=!1,Ot=null,Jt=Re.rootNode,Hr=null;for(let Re=0;Re<Ue.length;Re++){const Le=Ue[Re];null!==Jt.wildcardChildNode&&(Ot=Jt.wildcardChildNode,Hr=Ue.slice(Re).join("/"));const Oe=Jt.children.get(Le);if(void 0===Oe){if(Jt&&Jt.placeholderChildren.length>1){const Le=Ue.length-Re;Jt=Jt.placeholderChildren.find((Re=>Re.maxDepth===Le))||null}else Jt=Jt.placeholderChildren[0]||null;if(!Jt)break;Jt.paramName&&(qe[Jt.paramName]=Le),Ct=!0}else Jt=Oe}null!==Jt&&null!==Jt.data||null===Ot||(Jt=Ot,qe[Jt.paramName||"_"]=Hr,Ct=!0);if(!Jt)return null;if(Ct)return{...Jt.data,params:Ct?qe:void 0};return Jt.data}(Le,normalizeTrailingSlash(Re)),insert:(Re,Oe)=>insert(Le,normalizeTrailingSlash(Re),Oe),remove:Re=>function(Re,Le){let Oe=!1;const Ue=Le.split("/");let qe=Re.rootNode;for(const Re of Ue)if(qe=qe.children.get(Re),!qe)return Oe;if(qe.data){const Re=Ue.at(-1)||"";qe.data=null,0===Object.keys(qe.children).length&&qe.parent&&(qe.parent.children.delete(Re),qe.parent.wildcardChildNode=null,qe.parent.placeholderChildren=[]),Oe=!0}return Oe}(Le,normalizeTrailingSlash(Re))}}function insert(Re,Le,Oe){let Ue=!0;const qe=Le.split("/");let Ct=Re.rootNode,Ot=0;const Jt=[Ct];for(const Re of qe){let Le;if(Le=Ct.children.get(Re))Ct=Le;else{const Oe=getNodeType(Re);Le=createRadixNode({type:Oe,parent:Ct}),Ct.children.set(Re,Le),Oe===Hl?(Le.paramName="*"===Re?"_"+Ot++:Re.slice(1),Ct.placeholderChildren.push(Le),Ue=!1):Oe===Ml&&(Ct.wildcardChildNode=Le,Le.paramName=Re.slice(3)||"_",Ue=!1),Jt.push(Le),Ct=Le}}for(const[Re,Le]of Jt.entries())Le.maxDepth=Math.max(Jt.length-Re,Le.maxDepth||0);return Ct.data=Oe,!0===Ue&&(Re.staticRoutesMap[Le]=Ct),Ct}function createRadixNode(Re={}){return{type:Re.type||Al,maxDepth:0,parent:Re.parent||null,children:new Map,data:Re.data||null,paramName:Re.paramName||null,wildcardChildNode:null,placeholderChildren:[]}}function getNodeType(Re){return Re.startsWith("**")?Ml:":"===Re[0]||"*"===Re?Hl:Al}function toRouteMatcher(Re){return function(Re,Le){return{ctx:{table:Re},matchAll:Oe=>_matchRoutes(Oe,Re,Le)}}(_routerNodeToTable("",Re.ctx.rootNode),Re.ctx.options.strictTrailingSlash)}function _matchRoutes(Re,Le,Oe){!0!==Oe&&Re.endsWith("/")&&(Re=Re.slice(0,-1)||"/");const Ue=[];for(const[Oe,qe]of _sortRoutesMap(Le.wildcard))(Re===Oe||Re.startsWith(Oe+"/"))&&Ue.push(qe);for(const[Oe,qe]of _sortRoutesMap(Le.dynamic))if(Re.startsWith(Oe+"/")){const Le="/"+Re.slice(Oe.length).split("/").splice(2).join("/");Ue.push(..._matchRoutes(Le,qe))}const qe=Le.static.get(Re);return qe&&Ue.push(qe),Ue.filter(Boolean)}function _sortRoutesMap(Re){return[...Re.entries()].sort(((Re,Le)=>Re[0].length-Le[0].length))}function _routerNodeToTable(Re,Le){const Oe={static:new Map,wildcard:new Map,dynamic:new Map};return function _addNode(Re,Le){if(Re)if(Le.type!==Al||Re.includes("*")||Re.includes(":")){if(Le.type===Ml)Oe.wildcard.set(Re.replace("/**",""),Le.data);else if(Le.type===Hl){const Ue=_routerNodeToTable("",Le);return Le.data&&Ue.static.set("/",Le.data),void Oe.dynamic.set(Re.replace(/\/\*|\/:\w+/,""),Ue)}}else Le.data&&Oe.static.set(Re,Le.data);for(const[Oe,Ue]of Le.children.entries())_addNode(`${Re}/${Oe}`.replace("//","/"),Ue)}(Re,Le),Oe}const Wl=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,Kl=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,Jl=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function jsonParseTransform(Re,Le){if(!("__proto__"===Re||"constructor"===Re&&Le&&"object"==typeof Le&&"prototype"in Le))return Le;!function(Re){console.warn(`[destr] Dropping "${Re}" key to prevent prototype pollution.`)}(Re)}function destr(Re,Le={}){if("string"!=typeof Re)return Re;const Oe=Re.trim();if('"'===Re[0]&&Re.endsWith('"')&&!Re.includes("\\"))return Oe.slice(1,-1);if(Oe.length<=9){const Re=Oe.toLowerCase();if("true"===Re)return!0;if("false"===Re)return!1;if("undefined"===Re)return;if("null"===Re)return null;if("nan"===Re)return Number.NaN;if("infinity"===Re)return Number.POSITIVE_INFINITY;if("-infinity"===Re)return Number.NEGATIVE_INFINITY}if(!Jl.test(Re)){if(Le.strict)throw new SyntaxError("[destr] Invalid JSON");return Re}try{if(Wl.test(Re)||Kl.test(Re)){if(Le.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(Re,jsonParseTransform)}return JSON.parse(Re)}catch(Oe){if(Le.strict)throw Oe;return Re}}function isPlainObject$2(Re){if(null===Re||"object"!=typeof Re)return!1;const Le=Object.getPrototypeOf(Re);return(null===Le||Le===Object.prototype||null===Object.getPrototypeOf(Le))&&(!(Symbol.iterator in Re)&&(!(Symbol.toStringTag in Re)||"[object Module]"===Object.prototype.toString.call(Re)))}function _defu(Re,Le,Oe=".",Ue){if(!isPlainObject$2(Le))return _defu(Re,{},Oe,Ue);const qe=Object.assign({},Le);for(const Le in Re){if("__proto__"===Le||"constructor"===Le)continue;const Ct=Re[Le];null!=Ct&&(Ue&&Ue(qe,Le,Ct,Oe)||(Array.isArray(Ct)&&Array.isArray(qe[Le])?qe[Le]=[...Ct,...qe[Le]]:isPlainObject$2(Ct)&&isPlainObject$2(qe[Le])?qe[Le]=_defu(Ct,qe[Le],(Oe?`${Oe}.`:"")+Le.toString(),Ue):qe[Le]=Ct))}return qe}function createDefu(Re){return(...Le)=>Le.reduce(((Le,Oe)=>_defu(Le,Oe,"",Re)),{})}const Ql=createDefu(),oc=createDefu(((Re,Le,Oe)=>{if(void 0!==Re[Le]&&"function"==typeof Oe)return Re[Le]=Oe(Re[Le]),!0}));let lc=10,Oc=class{__unenv__=!0;_events=Object.create(null);_maxListeners;static get defaultMaxListeners(){return lc}static set defaultMaxListeners(Re){if("number"!=typeof Re||Re<0||Number.isNaN(Re))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+Re+".");lc=Re}setMaxListeners(Re){if("number"!=typeof Re||Re<0||Number.isNaN(Re))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+Re+".");return this._maxListeners=Re,this}getMaxListeners(){return _getMaxListeners(this)}emit(Re,...Le){if(!this._events[Re]||0===this._events[Re].length)return!1;if("error"===Re){let Re;if(Le.length>0&&(Re=Le[0]),Re instanceof Error)throw Re;const Oe=new Error("Unhandled error."+(Re?" ("+Re.message+")":""));throw Oe.context=Re,Oe}for(const Oe of this._events[Re])(Oe.listener||Oe).apply(this,Le);return!0}addListener(Re,Le){return _addListener(this,Re,Le,!1)}on(Re,Le){return _addListener(this,Re,Le,!1)}prependListener(Re,Le){return _addListener(this,Re,Le,!0)}once(Re,Le){return this.on(Re,_wrapOnce(this,Re,Le))}prependOnceListener(Re,Le){return this.prependListener(Re,_wrapOnce(this,Re,Le))}removeListener(Re,Le){return function(Re,Le,Oe){if(_checkListener(Oe),!Re._events[Le]||0===Re._events[Le].length)return Re;const Ue=Re._events[Le].length;if(Re._events[Le]=Re._events[Le].filter((Re=>Re!==Oe)),Ue===Re._events[Le].length)return Re;Re._events.removeListener&&Re.emit("removeListener",Le,Oe.listener||Oe);0===Re._events[Le].length&&delete Re._events[Le];return Re}(this,Re,Le)}off(Re,Le){return this.removeListener(Re,Le)}removeAllListeners(Re){return function(Re,Le){if(!Re._events[Le]||0===Re._events[Le].length)return Re;if(Re._events.removeListener)for(const Oe of Re._events[Le])Re.emit("removeListener",Le,Oe.listener||Oe);return delete Re._events[Le],Re}(this,Re)}listeners(Re){return _listeners(this,Re,!0)}rawListeners(Re){return _listeners(this,Re,!1)}listenerCount(Re){return this.rawListeners(Re).length}eventNames(){return Object.keys(this._events)}};function _addListener(Re,Le,Oe,Ue){_checkListener(Oe),void 0!==Re._events.newListener&&Re.emit("newListener",Le,Oe.listener||Oe),Re._events[Le]||(Re._events[Le]=[]),Ue?Re._events[Le].unshift(Oe):Re._events[Le].push(Oe);const qe=_getMaxListeners(Re);if(qe>0&&Re._events[Le].length>qe&&!Re._events[Le].warned){Re._events[Le].warned=!0;const Oe=new Error(`[unenv] Possible EventEmitter memory leak detected. ${Re._events[Le].length} ${Le} listeners added. Use emitter.setMaxListeners() to increase limit`);Oe.name="MaxListenersExceededWarning",Oe.emitter=Re,Oe.type=Le,Oe.count=Re._events[Le]?.length,console.warn(Oe)}return Re}function _wrapOnce(Re,Le,Oe){let Ue=!1;const wrapper=(...qe)=>{if(!Ue)return Re.removeListener(Le,wrapper),Ue=!0,0===qe.length?Oe.call(Re):Oe.apply(Re,qe)};return wrapper.listener=Oe,wrapper}function _getMaxListeners(Re){return Re._maxListeners??Oc.defaultMaxListeners}function _listeners(Re,Le,Oe){let Ue=Re._events[Le];return"function"==typeof Ue&&(Ue=[Ue]),Oe?Ue.map((Re=>Re.listener||Re)):Ue}function _checkListener(Re){if("function"!=typeof Re)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof Re)}const Nc=globalThis.EventEmitter||Oc;class _Readable extends Nc{__unenv__=!0;readableEncoding=null;readableEnded=!0;readableFlowing=!1;readableHighWaterMark=0;readableLength=0;readableObjectMode=!1;readableAborted=!1;readableDidRead=!1;closed=!1;errored=null;readable=!1;destroyed=!1;static from(Re,Le){return new _Readable(Le)}constructor(Re){super()}_read(Re){}read(Re){}setEncoding(Re){return this}pause(){return this}resume(){return this}isPaused(){return!0}unpipe(Re){return this}unshift(Re,Le){}wrap(Re){return this}push(Re,Le){return!1}_destroy(Re,Le){this.removeAllListeners()}destroy(Re){return this.destroyed=!0,this._destroy(Re),this}pipe(Re,Le){return{}}compose(Re,Le){throw new Error("[unenv] Method not implemented.")}[Symbol.asyncDispose](){return this.destroy(),Promise.resolve()}async*[Symbol.asyncIterator](){throw createNotImplementedError("Readable.asyncIterator")}iterator(Re){throw createNotImplementedError("Readable.iterator")}map(Re,Le){throw createNotImplementedError("Readable.map")}filter(Re,Le){throw createNotImplementedError("Readable.filter")}forEach(Re,Le){throw createNotImplementedError("Readable.forEach")}reduce(Re,Le,Oe){throw createNotImplementedError("Readable.reduce")}find(Re,Le){throw createNotImplementedError("Readable.find")}findIndex(Re,Le){throw createNotImplementedError("Readable.findIndex")}some(Re,Le){throw createNotImplementedError("Readable.some")}toArray(Re){throw createNotImplementedError("Readable.toArray")}every(Re,Le){throw createNotImplementedError("Readable.every")}flatMap(Re,Le){throw createNotImplementedError("Readable.flatMap")}drop(Re,Le){throw createNotImplementedError("Readable.drop")}take(Re,Le){throw createNotImplementedError("Readable.take")}asIndexedPairs(Re){throw createNotImplementedError("Readable.asIndexedPairs")}}const jc=globalThis.Readable||_Readable;const Uc=globalThis.Writable||class extends Nc{__unenv__=!0;writable=!0;writableEnded=!1;writableFinished=!1;writableHighWaterMark=0;writableLength=0;writableObjectMode=!1;writableCorked=0;closed=!1;errored=null;writableNeedDrain=!1;destroyed=!1;_data;_encoding="utf-8";constructor(Re){super()}pipe(Re,Le){return{}}_write(Re,Le,Oe){if(this.writableEnded)Oe&&Oe();else{if(void 0===this._data)this._data=Re;else{const Oe="string"==typeof this._data?Ln.from(this._data,this._encoding||Le||"utf8"):this._data,Ue="string"==typeof Re?Ln.from(Re,Le||this._encoding||"utf8"):Re;this._data=Ln.concat([Oe,Ue])}this._encoding=Le,Oe&&Oe()}}_writev(Re,Le){}_destroy(Re,Le){}_final(Re){}write(Re,Le,Oe){const Ue="string"==typeof Le?this._encoding:"utf-8",qe="function"==typeof Le?Le:"function"==typeof Oe?Oe:void 0;return this._write(Re,Ue,qe),!0}setDefaultEncoding(Re){return this}end(Re,Le,Oe){const Ue="function"==typeof Re?Re:"function"==typeof Le?Le:"function"==typeof Oe?Oe:void 0;if(this.writableEnded)return Ue&&Ue(),this;const qe=Re===Ue?void 0:Re;if(qe){const Re=Le===Ue?void 0:Le;this.write(qe,Re,Ue)}return this.writableEnded=!0,this.writableFinished=!0,this.emit("close"),this.emit("finish"),this}cork(){}uncork(){}destroy(Re){return this.destroyed=!0,delete this._data,this.removeAllListeners(),this}compose(Re,Le){throw new Error("[h3] Method not implemented.")}},Hc=class{allowHalfOpen=!0;_destroy;constructor(Re=new jc,Le=new Uc){Object.assign(this,Re),Object.assign(this,Le),this._destroy=function(...Re){return function(...Le){for(const Oe of Re)Oe(...Le)}}(Re._destroy,Le._destroy)}};function getDuplex(){return Object.assign(Hc.prototype,jc.prototype),Object.assign(Hc.prototype,Uc.prototype),Hc}const Wc=getDuplex(),Zc=globalThis.Duplex||Wc;class Socket extends Zc{__unenv__=!0;bufferSize=0;bytesRead=0;bytesWritten=0;connecting=!1;destroyed=!1;pending=!1;localAddress="";localPort=0;remoteAddress="";remoteFamily="";remotePort=0;autoSelectFamilyAttemptedAddresses=[];readyState="readOnly";constructor(Re){super()}write(Re,Le,Oe){return!1}connect(Re,Le,Oe){return this}end(Re,Le,Oe){return this}setEncoding(Re){return this}pause(){return this}resume(){return this}setTimeout(Re,Le){return this}setNoDelay(Re){return this}setKeepAlive(Re,Le){return this}address(){return{}}unref(){return this}ref(){return this}destroySoon(){this.destroy()}resetAndDestroy(){const Re=new Error("ERR_SOCKET_CLOSED");return Re.code="ERR_SOCKET_CLOSED",this.destroy(Re),this}}class IncomingMessage extends jc{__unenv__={};aborted=!1;httpVersion="1.1";httpVersionMajor=1;httpVersionMinor=1;complete=!0;connection;socket;headers={};trailers={};method="GET";url="/";statusCode=200;statusMessage="";closed=!1;errored=null;readable=!1;constructor(Re){super(),this.socket=this.connection=Re||new Socket}get rawHeaders(){return function(Re){const Le=[];for(const Oe in Re)if(Array.isArray(Re[Oe]))for(const Ue of Re[Oe])Le.push(Oe,Ue);else Le.push(Oe,Re[Oe]);return Le}(this.headers)}get rawTrailers(){return[]}setTimeout(Re,Le){return this}get headersDistinct(){return _distinct(this.headers)}get trailersDistinct(){return _distinct(this.trailers)}}function _distinct(Re){const Le={};for(const[Oe,Ue]of Object.entries(Re))Oe&&(Le[Oe]=(Array.isArray(Ue)?Ue:[Ue]).filter(Boolean));return Le}class ServerResponse extends Uc{__unenv__=!0;statusCode=200;statusMessage="";upgrading=!1;chunkedEncoding=!1;shouldKeepAlive=!1;useChunkedEncodingByDefault=!1;sendDate=!1;finished=!1;headersSent=!1;strictContentLength=!1;connection=null;socket=null;req;_headers={};constructor(Re){super(),this.req=Re}assignSocket(Re){Re._httpMessage=this,this.socket=Re,this.connection=Re,this.emit("socket",Re),this._flush()}_flush(){this.flushHeaders()}detachSocket(Re){}writeContinue(Re){}writeHead(Re,Le,Oe){Re&&(this.statusCode=Re),"string"==typeof Le&&(this.statusMessage=Le,Le=void 0);const Ue=Oe||Le;if(Ue)if(Array.isArray(Ue));else for(const Re in Ue)this.setHeader(Re,Ue[Re]);return this.headersSent=!0,this}writeProcessing(){}setTimeout(Re,Le){return this}appendHeader(Re,Le){Re=Re.toLowerCase();const Oe=this._headers[Re],Ue=[...Array.isArray(Oe)?Oe:[Oe],...Array.isArray(Le)?Le:[Le]].filter(Boolean);return this._headers[Re]=Ue.length>1?Ue:Ue[0],this}setHeader(Re,Le){return this._headers[Re.toLowerCase()]=Le,this}getHeader(Re){return this._headers[Re.toLowerCase()]}getHeaders(){return this._headers}getHeaderNames(){return Object.keys(this._headers)}hasHeader(Re){return Re.toLowerCase()in this._headers}removeHeader(Re){delete this._headers[Re.toLowerCase()]}addTrailers(Re){}flushHeaders(){}writeEarlyHints(Re,Le){"function"==typeof Le&&Le()}}function hasProp(Re,Le){try{return Le in Re}catch{return!1}}var Xc=Object.defineProperty,__publicField$2=(Re,Le,Oe)=>(((Re,Le,Oe)=>{Le in Re?Xc(Re,Le,{enumerable:!0,configurable:!0,writable:!0,value:Oe}):Re[Le]=Oe})(Re,"symbol"!=typeof Le?Le+"":Le,Oe),Oe);class H3Error extends Error{constructor(Re,Le={}){super(Re,Le),__publicField$2(this,"statusCode",500),__publicField$2(this,"fatal",!1),__publicField$2(this,"unhandled",!1),__publicField$2(this,"statusMessage"),__publicField$2(this,"data"),__publicField$2(this,"cause"),Le.cause&&!this.cause&&(this.cause=Le.cause)}toJSON(){const Re={message:this.message,statusCode:sanitizeStatusCode(this.statusCode,500)};return this.statusMessage&&(Re.statusMessage=sanitizeStatusMessage(this.statusMessage)),void 0!==this.data&&(Re.data=this.data),Re}}function createError$2(Re){if("string"==typeof Re)return new H3Error(Re);if(isError(Re))return Re;const Le=new H3Error(Re.message??Re.statusMessage??"",{cause:Re.cause||Re});if(hasProp(Re,"stack"))try{Object.defineProperty(Le,"stack",{get:()=>Re.stack})}catch{try{Le.stack=Re.stack}catch{}}if(Re.data&&(Le.data=Re.data),Re.statusCode?Le.statusCode=sanitizeStatusCode(Re.statusCode,Le.statusCode):Re.status&&(Le.statusCode=sanitizeStatusCode(Re.status,Le.statusCode)),Re.statusMessage?Le.statusMessage=Re.statusMessage:Re.statusText&&(Le.statusMessage=Re.statusText),Le.statusMessage){const Re=Le.statusMessage;sanitizeStatusMessage(Le.statusMessage)!==Re&&console.warn("[h3] Please prefer using `message` for longer error messages instead of `statusMessage`. In the future, `statusMessage` will be sanitized by default.")}return void 0!==Re.fatal&&(Le.fatal=Re.fatal),void 0!==Re.unhandled&&(Le.unhandled=Re.unhandled),Le}function isError(Re){return!0===Re?.constructor?.__h3_error__}function getRequestHeaders(Re){const Le={};for(const Oe in Re.node.req.headers){const Ue=Re.node.req.headers[Oe];Le[Oe]=Array.isArray(Ue)?Ue.filter(Boolean).join(", "):Ue}return Le}function getRequestHeader(Re,Le){return getRequestHeaders(Re)[Le.toLowerCase()]}__publicField$2(H3Error,"__h3_error__",!0);const Yc=Symbol.for("h3RawBody"),Kc=["PATCH","POST","PUT","DELETE"];function readRawBody(Re,Le="utf8"){!function(Re,Le){if(!function(Re,Le){if("string"==typeof Le){if(Re.method===Le)return!0}else if(Le.includes(Re.method))return!0;return!1}(Re,Le))throw createError$2({statusCode:405,statusMessage:"HTTP method is not allowed."})}(Re,Kc);const Oe=Re._requestBody||Re.web?.request?.body||Re.node.req[Yc]||Re.node.req.rawBody||Re.node.req.body;if(Oe){const Re=Promise.resolve(Oe).then((Re=>Ln.isBuffer(Re)?Re:"function"==typeof Re.pipeTo?new Promise(((Le,Oe)=>{const Ue=[];Re.pipeTo(new WritableStream({write(Re){Ue.push(Re)},close(){Le(Ln.concat(Ue))},abort(Re){Oe(Re)}})).catch(Oe)})):"function"==typeof Re.pipe?new Promise(((Le,Oe)=>{const Ue=[];Re.on("data",(Re=>{Ue.push(Re)})).on("end",(()=>{Le(Ln.concat(Ue))})).on("error",Oe)})):Re.constructor===Object?Ln.from(JSON.stringify(Re)):Re instanceof URLSearchParams?Ln.from(Re.toString()):Ln.from(Re)));return Le?Re.then((Re=>Re.toString(Le))):Re}if(!Number.parseInt(Re.node.req.headers["content-length"]||"")&&!String(Re.node.req.headers["transfer-encoding"]??"").split(",").map((Re=>Re.trim())).filter(Boolean).includes("chunked"))return Promise.resolve(void 0);const Ue=Re.node.req[Yc]=new Promise(((Le,Oe)=>{const Ue=[];Re.node.req.on("error",(Re=>{Oe(Re)})).on("data",(Re=>{Ue.push(Re)})).on("end",(()=>{Le(Ln.concat(Ue))}))}));return Le?Ue.then((Re=>Re.toString(Le))):Ue}function handleCacheHeaders(Re,Le){const Oe=["public",...Le.cacheControls||[]];let Ue=!1;if(void 0!==Le.maxAge&&Oe.push("max-age="+ +Le.maxAge,"s-maxage="+ +Le.maxAge),Le.modifiedTime){const Oe=new Date(Le.modifiedTime),qe=Re.node.req.headers["if-modified-since"];Re.node.res.setHeader("last-modified",Oe.toUTCString()),qe&&new Date(qe)>=Le.modifiedTime&&(Ue=!0)}if(Le.etag){Re.node.res.setHeader("etag",Le.etag);Re.node.req.headers["if-none-match"]===Le.etag&&(Ue=!0)}return Re.node.res.setHeader("cache-control",Oe.join(", ")),!!Ue&&(Re.node.res.statusCode=304,Re.handled||Re.node.res.end(),!0)}const Jc={html:"text/html",json:"application/json"},Qc=/[^\u0009\u0020-\u007E]/g;function sanitizeStatusMessage(Re=""){return Re.replace(Qc,"")}function sanitizeStatusCode(Re,Le=200){return Re?("string"==typeof Re&&(Re=Number.parseInt(Re,10)),Re<100||Re>999?Le:Re):Le}function getCookie(Re,Le){return function(Re){return parse$1(Re.node.req.headers.cookie||"")}(Re)[Le]}function setCookie(Re,Le,Oe,Ue){const qe=serialize(Le,Oe,Ue={path:"/",...Ue});let Ct=Re.node.res.getHeader("set-cookie");Array.isArray(Ct)||(Ct=[Ct]);const Ot=objectHash(Ue);Ct=Ct.filter((Re=>Re&&Ot!==objectHash(parse$1(Re)))),Re.node.res.setHeader("set-cookie",[...Ct,qe])}function splitCookiesString(Re){if(Array.isArray(Re))return Re.flatMap((Re=>splitCookiesString(Re)));if("string"!=typeof Re)return[];const Le=[];let Oe,Ue,qe,Ct,Ot,Jt=0;const skipWhitespace=()=>{for(;Jt<Re.length&&/\s/.test(Re.charAt(Jt));)Jt+=1;return Jt<Re.length};for(;Jt<Re.length;){for(Oe=Jt,Ot=!1;skipWhitespace();)if(Ue=Re.charAt(Jt),","===Ue){for(qe=Jt,Jt+=1,skipWhitespace(),Ct=Jt;Jt<Re.length&&(Ue=Re.charAt(Jt),"="!==Ue&&";"!==Ue&&","!==Ue);)Jt+=1;Jt<Re.length&&"="===Re.charAt(Jt)?(Ot=!0,Jt=Ct,Le.push(Re.slice(Oe,qe)),Oe=Jt):Jt=qe+1}else Jt+=1;(!Ot||Jt>=Re.length)&&Le.push(Re.slice(Oe))}return Le}const iu="undefined"==typeof setImmediate?Re=>Re():setImmediate;function send$1(Re,Le,Oe){return Oe&&function(Re,Le){Le&&304!==Re.node.res.statusCode&&!Re.node.res.getHeader("content-type")&&Re.node.res.setHeader("content-type",Le)}(Re,Oe),new Promise((Oe=>{iu((()=>{Re.handled||Re.node.res.end(Le),Oe()}))}))}function setResponseStatus(Re,Le,Oe){Le&&(Re.node.res.statusCode=sanitizeStatusCode(Le,Re.node.res.statusCode)),Oe&&(Re.node.res.statusMessage=sanitizeStatusMessage(Oe))}function getResponseStatus(Re){return Re.node.res.statusCode}function getResponseStatusText(Re){return Re.node.res.statusMessage}function setResponseHeaders(Re,Le){for(const[Oe,Ue]of Object.entries(Le))Re.node.res.setHeader(Oe,Ue)}const ou=setResponseHeaders;function setResponseHeader(Re,Le,Oe){Re.node.res.setHeader(Le,Oe)}function sendStream(Re,Le){if(!Le||"object"!=typeof Le)throw new Error("[h3] Invalid stream provided.");if(Re.node.res._data=Le,!Re.node.res.socket)return Re._handled=!0,Promise.resolve();if(hasProp(Le,"pipeTo")&&"function"==typeof Le.pipeTo)return Le.pipeTo(new WritableStream({write(Le){Re.node.res.write(Le)}})).then((()=>{Re.node.res.end()}));if(hasProp(Le,"pipe")&&"function"==typeof Le.pipe)return new Promise(((Oe,Ue)=>{Le.pipe(Re.node.res),Le.on&&(Le.on("end",(()=>{Re.node.res.end(),Oe()})),Le.on("error",(Re=>{Ue(Re)}))),Re.node.res.on("close",(()=>{Le.abort&&Le.abort()}))}));throw new Error("[h3] Invalid or incompatible stream provided.")}function sendWebResponse(Re,Le){for(const[Oe,Ue]of Le.headers)"set-cookie"===Oe?Re.node.res.appendHeader(Oe,splitCookiesString(Ue)):Re.node.res.setHeader(Oe,Ue);if(Le.status&&(Re.node.res.statusCode=sanitizeStatusCode(Le.status,Re.node.res.statusCode)),Le.statusText&&(Re.node.res.statusMessage=sanitizeStatusMessage(Le.statusText)),Le.redirected&&Re.node.res.setHeader("location",Le.url),Le.body)return sendStream(Re,Le.body);Re.node.res.end()}const su=new Set(["PATCH","POST","PUT","DELETE"]),au=new Set(["transfer-encoding","connection","keep-alive","upgrade","expect","host","accept"]);async function proxyRequest(Re,Le,Oe={}){let Ue,qe;su.has(Re.method)&&(Oe.streamRequest?(Ue=function(Re){if(!Kc.includes(Re.method))return;const Le=Re.web?.request?.body||Re._requestBody;return Le||(Yc in Re.node.req||"rawBody"in Re.node.req||"body"in Re.node.req||"__unenv__"in Re.node.req?new ReadableStream({async start(Le){const Oe=await readRawBody(Re,!1);Oe&&Le.enqueue(Oe),Le.close()}}):new ReadableStream({start:Le=>{Re.node.req.on("data",(Re=>{Le.enqueue(Re)})),Re.node.req.on("end",(()=>{Le.close()})),Re.node.req.on("error",(Re=>{Le.error(Re)}))}}))}(Re),qe="half"):Ue=await readRawBody(Re,!1).catch((()=>{})));const Ct=Oe.fetchOptions?.method||Re.method,Ot=function(Re,...Le){const Oe=Le.filter(Boolean);if(0===Oe.length)return Re;const Ue=new Headers(Re);for(const Re of Oe)for(const[Le,Oe]of Object.entries(Re))void 0!==Oe&&Ue.set(Le,Oe);return Ue}(getProxyRequestHeaders(Re),Oe.fetchOptions?.headers,Oe.headers);return async function(Re,Le,Oe={}){let Ue;try{Ue=await _getFetch(Oe.fetch)(Le,{headers:Oe.headers,ignoreResponseError:!0,...Oe.fetchOptions})}catch(Re){throw createError$2({status:502,statusMessage:"Bad Gateway",cause:Re})}Re.node.res.statusCode=sanitizeStatusCode(Ue.status,Re.node.res.statusCode),Re.node.res.statusMessage=sanitizeStatusMessage(Ue.statusText);const qe=[];for(const[Le,Oe]of Ue.headers.entries())"content-encoding"!==Le&&"content-length"!==Le&&("set-cookie"!==Le?Re.node.res.setHeader(Le,Oe):qe.push(...splitCookiesString(Oe)));qe.length>0&&Re.node.res.setHeader("set-cookie",qe.map((Re=>(Oe.cookieDomainRewrite&&(Re=rewriteCookieProperty(Re,Oe.cookieDomainRewrite,"domain")),Oe.cookiePathRewrite&&(Re=rewriteCookieProperty(Re,Oe.cookiePathRewrite,"path")),Re))));Oe.onResponse&&await Oe.onResponse(Re,Ue);if(void 0!==Ue._data)return Ue._data;if(Re.handled)return;if(!1===Oe.sendStream){const Le=new Uint8Array(await Ue.arrayBuffer());return Re.node.res.end(Le)}if(Ue.body)for await(const Le of Ue.body)Re.node.res.write(Le);return Re.node.res.end()}(Re,Le,{...Oe,fetchOptions:{method:Ct,body:Ue,duplex:qe,...Oe.fetchOptions,headers:Ot}})}function getProxyRequestHeaders(Re){const Le=Object.create(null),Oe=getRequestHeaders(Re);for(const Re in Oe)au.has(Re)||(Le[Re]=Oe[Re]);return Le}function fetchWithEvent(Re,Le,Oe,Ue){return _getFetch(Ue?.fetch)(Le,{...Oe,context:Oe?.context||Re.context,headers:{...getProxyRequestHeaders(Re),...Oe?.headers}})}function _getFetch(Re){if(Re)return Re;if(globalThis.fetch)return globalThis.fetch;throw new Error("fetch is not available. Try importing `node-fetch-native/polyfill` for Node.js.")}function rewriteCookieProperty(Re,Le,Oe){const Ue="string"==typeof Le?{"*":Le}:Le;return Re.replace(new RegExp(`(;\\s*${Oe}=)([^;]+)`,"gi"),((Re,Le,Oe)=>{let qe;if(Oe in Ue)qe=Ue[Oe];else{if(!("*"in Ue))return Re;qe=Ue["*"]}return qe?Le+qe:""}))}var lu=Object.defineProperty,__publicField$1=(Re,Le,Oe)=>(((Re,Le,Oe)=>{Le in Re?lu(Re,Le,{enumerable:!0,configurable:!0,writable:!0,value:Oe}):Re[Le]=Oe})(Re,"symbol"!=typeof Le?Le+"":Le,Oe),Oe);class H3Event{constructor(Re,Le){__publicField$1(this,"__is_event__",!0),__publicField$1(this,"node"),__publicField$1(this,"web"),__publicField$1(this,"context",{}),__publicField$1(this,"_method"),__publicField$1(this,"_path"),__publicField$1(this,"_headers"),__publicField$1(this,"_requestBody"),__publicField$1(this,"_handled",!1),__publicField$1(this,"_onBeforeResponseCalled"),__publicField$1(this,"_onAfterResponseCalled"),this.node={req:Re,res:Le}}get method(){return this._method||(this._method=(this.node.req.method||"GET").toUpperCase()),this._method}get path(){return this._path||this.node.req.url||"/"}get headers(){return this._headers||(this._headers=function(Re){const Le=new Headers;for(const[Oe,Ue]of Object.entries(Re))if(Array.isArray(Ue))for(const Re of Ue)Le.append(Oe,Re);else Ue&&Le.set(Oe,Ue);return Le}(this.node.req.headers)),this._headers}get handled(){return this._handled||this.node.res.writableEnded||this.node.res.headersSent}respondWith(Re){return Promise.resolve(Re).then((Re=>sendWebResponse(this,Re)))}toString(){return`[${this.method}] ${this.path}`}toJSON(){return this.toString()}get req(){return this.node.req}get res(){return this.node.res}}function isEvent(Re){return hasProp(Re,"__is_event__")}function createEvent(Re,Le){return new H3Event(Re,Le)}function defineEventHandler(Re){if("function"==typeof Re)return Re.__is_handler__=!0,Re;const Le={onRequest:_normalizeArray(Re.onRequest),onBeforeResponse:_normalizeArray(Re.onBeforeResponse)},_handler=Oe=>async function(Re,Le,Oe){if(Oe.onRequest)for(const Le of Oe.onRequest)if(await Le(Re),Re.handled)return;const Ue=await Le(Re),qe={body:Ue};if(Oe.onBeforeResponse)for(const Le of Oe.onBeforeResponse)await Le(Re,qe);return qe.body}(Oe,Re.handler,Le);return _handler.__is_handler__=!0,_handler.__resolve__=Re.handler.__resolve__,_handler.__websocket__=Re.websocket,_handler}function _normalizeArray(Re){return Re?Array.isArray(Re)?Re:[Re]:void 0}const xu=defineEventHandler;function isEventHandler(Re){return hasProp(Re,"__is_handler__")}function toEventHandler(Re,Le,Oe){return isEventHandler(Re)||console.warn("[h3] Implicit event handler conversion is deprecated. Use `eventHandler()` or `fromNodeMiddleware()` to define event handlers.",Oe&&"/"!==Oe?`\n     Route: ${Oe}`:"",`\n     Handler: ${Re}`),Re}const lazyEventHandler=function(Re){let Le,Oe;const resolveHandler=()=>Oe?Promise.resolve(Oe):(Le||(Le=Promise.resolve(Re()).then((Re=>{const Le=Re.default||Re;if("function"!=typeof Le)throw new TypeError("Invalid lazy handler result. It should be a function:",Le);return Oe={handler:toEventHandler(Re.default||Re)},Oe}))),Le),Ue=xu((Re=>Oe?Oe.handler(Re):resolveHandler().then((Le=>Le.handler(Re)))));return Ue.__resolve__=resolveHandler,Ue};function createApp$1(Re={}){const Le=[],Oe=function(Re,Le){const Oe=Le.debug?2:void 0;return xu((async Ue=>{Ue.node.req.originalUrl=Ue.node.req.originalUrl||Ue.node.req.url||"/";const qe=Ue._path||Ue.node.req.url||"/";let Ct;Le.onRequest&&await Le.onRequest(Ue);for(const Ot of Re){if(Ot.route.length>1){if(!qe.startsWith(Ot.route))continue;Ct=qe.slice(Ot.route.length)||"/"}else Ct=qe;if(Ot.match&&!Ot.match(Ct,Ue))continue;Ue._path=Ct,Ue.node.req.url=Ct;const Re=await Ot.handler(Ue),Jt=void 0===Re?void 0:await Re;if(void 0!==Jt){const Re={body:Jt};return Le.onBeforeResponse&&(Ue._onBeforeResponseCalled=!0,await Le.onBeforeResponse(Ue,Re)),await handleHandlerResponse(Ue,Re.body,Oe),void(Le.onAfterResponse&&(Ue._onAfterResponseCalled=!0,await Le.onAfterResponse(Ue,Re)))}if(Ue.handled)return void(Le.onAfterResponse&&(Ue._onAfterResponseCalled=!0,await Le.onAfterResponse(Ue,void 0)))}if(!Ue.handled)throw createError$2({statusCode:404,statusMessage:`Cannot find any path matching ${Ue.path||"/"}.`});Le.onAfterResponse&&(Ue._onAfterResponseCalled=!0,await Le.onAfterResponse(Ue,void 0))}))}(Le,Re),Ue=function(Re){return async Le=>{let Oe;for(const Ue of Re){if("/"===Ue.route&&!Ue.handler.__resolve__)continue;if(!Le.startsWith(Ue.route))continue;if(Oe=Le.slice(Ue.route.length)||"/",Ue.match&&!Ue.match(Oe,void 0))continue;let Re={route:Ue.route,handler:Ue.handler};if(Re.handler.__resolve__){const Le=await Re.handler.__resolve__(Oe);if(!Le)continue;Re={...Re,...Le,route:joinURL$1(Re.route||"/",Le.route||"/")}}return Re}}}(Le);Oe.__resolve__=Ue;const qe=function(Re){let Le;return()=>(Le||(Le=Re()),Le)}((()=>{return Le=Ue,{...Re.websocket,async resolve(Re){const Oe=Re.request?.url||Re.url||"/",{pathname:Ue}="string"==typeof Oe?parseURL$2(Oe):Oe,qe=await Le(Ue);return qe?.handler?.__websocket__||{}}};var Le})),Ct={use:(Re,Le,Oe)=>use(Ct,Re,Le,Oe),resolve:Ue,handler:Oe,stack:Le,options:Re,get websocket(){return qe()}};return Ct}function use(Re,Le,Oe,Ue){if(Array.isArray(Le))for(const qe of Le)use(Re,qe,Oe,Ue);else if(Array.isArray(Oe))for(const qe of Oe)use(Re,Le,qe,Ue);else"string"==typeof Le?Re.stack.push(normalizeLayer({...Ue,route:Le,handler:Oe})):"function"==typeof Le?Re.stack.push(normalizeLayer({...Oe,handler:Le})):Re.stack.push(normalizeLayer({...Le}));return Re}function normalizeLayer(Re){let Le=Re.handler;return Le.handler&&(Le=Le.handler),Re.lazy?Le=lazyEventHandler(Le):isEventHandler(Le)||(Le=toEventHandler(Le,0,Re.route)),{route:withoutTrailingSlash$1(Re.route),match:Re.match,handler:Le}}function handleHandlerResponse(Re,Le,Oe){if(null===Le)return function(Re,Le){if(Re.handled)return;Le||200===Re.node.res.statusCode||(Le=Re.node.res.statusCode);const Oe=sanitizeStatusCode(Le,204);204===Oe&&Re.node.res.removeHeader("content-length"),Re.node.res.writeHead(Oe),Re.node.res.end()}(Re);if(Le){if(Ue=Le,"undefined"!=typeof Response&&Ue instanceof Response)return sendWebResponse(Re,Le);if(function(Re){if(!Re||"object"!=typeof Re)return!1;if("function"==typeof Re.pipe){if("function"==typeof Re._read)return!0;if("function"==typeof Re.abort)return!0}return"function"==typeof Re.pipeTo}(Le))return sendStream(Re,Le);if(Le.buffer)return send$1(Re,Le);if(Le.arrayBuffer&&"function"==typeof Le.arrayBuffer)return Le.arrayBuffer().then((Oe=>send$1(Re,Ln.from(Oe),Le.type)));if(Le instanceof Error)throw createError$2(Le);if("function"==typeof Le.end)return!0}var Ue;const qe=typeof Le;if("string"===qe)return send$1(Re,Le,Jc.html);if("object"===qe||"boolean"===qe||"number"===qe)return send$1(Re,JSON.stringify(Le,void 0,Oe),Jc.json);if("bigint"===qe)return send$1(Re,Le.toString(),Jc.json);throw createError$2({statusCode:500,statusMessage:`[h3] Cannot send ${qe} as response.`})}const Tu=["connect","delete","get","head","options","post","put","trace","patch"];function toNodeListener(Re){return async function(Le,Oe){const Ue=createEvent(Le,Oe);try{await Re.handler(Ue)}catch(Le){const Oe=createError$2(Le);if(isError(Le)||(Oe.unhandled=!0),setResponseStatus(Ue,Oe.statusCode,Oe.statusMessage),Re.options.onError&&await Re.options.onError(Oe,Ue),Ue.handled)return;(Oe.unhandled||Oe.fatal)&&console.error("[h3]",Oe.fatal?"[fatal]":"[unhandled]",Oe),Re.options.onBeforeResponse&&!Ue._onBeforeResponseCalled&&await Re.options.onBeforeResponse(Ue,{body:Oe}),await function(Re,Le,Oe){if(Re.handled)return;const Ue=isError(Le)?Le:createError$2(Le),qe={statusCode:Ue.statusCode,statusMessage:Ue.statusMessage,stack:[],data:Ue.data};if(Oe&&(qe.stack=(Ue.stack||"").split("\n").map((Re=>Re.trim()))),Re.handled)return;setResponseStatus(Re,Number.parseInt(Ue.statusCode),Ue.statusMessage),Re.node.res.setHeader("content-type",Jc.json),Re.node.res.end(JSON.stringify(qe,void 0,2))}(Ue,Oe,!!Re.options.debug),Re.options.onAfterResponse&&!Ue._onAfterResponseCalled&&await Re.options.onAfterResponse(Ue,{body:Oe})}}}class FetchError extends Error{constructor(Re,Le){super(Re,Le),this.name="FetchError",Le?.cause&&!this.cause&&(this.cause=Le.cause)}}const Ou=new Set(Object.freeze(["PATCH","POST","PUT","DELETE"]));function isPayloadMethod(Re="GET"){return Ou.has(Re.toUpperCase())}const Nu=new Set(["image/svg","application/xml","application/xhtml","application/html"]),ju=/^application\/(?:[\w!#$%&*.^`~-]*\+)?json(;.+)?$/i;function resolveFetchOptions(Re,Le,Oe,Ue){const qe=function(Re,Le,Oe){if(!Le)return new Oe(Re);const Ue=new Oe(Le);if(Re)for(const[Le,qe]of Symbol.iterator in Re||Array.isArray(Re)?Re:new Oe(Re))Ue.set(Le,qe);return Ue}(Le?.headers??Re?.headers,Oe?.headers,Ue);let Ct;return(Oe?.query||Oe?.params||Le?.params||Le?.query)&&(Ct={...Oe?.params,...Oe?.query,...Le?.params,...Le?.query}),{...Oe,...Le,query:Ct,params:Ct,headers:qe}}async function callHooks(Re,Le){if(Le)if(Array.isArray(Le))for(const Oe of Le)await Oe(Re);else await Le(Re)}const Uu=new Set([408,409,425,429,500,502,503,504]),Hu=new Set([101,204,205,304]);function createFetch$1(Re={}){const{fetch:Le=globalThis.fetch,Headers:Oe=globalThis.Headers,AbortController:Ue=globalThis.AbortController}=Re;async function onError(Re){const Le=Re.error&&"AbortError"===Re.error.name&&!Re.options.timeout||!1;if(!1!==Re.options.retry&&!Le){let Le;Le="number"==typeof Re.options.retry?Re.options.retry:isPayloadMethod(Re.options.method)?0:1;const Oe=Re.response&&Re.response.status||500;if(Le>0&&(Array.isArray(Re.options.retryStatusCodes)?Re.options.retryStatusCodes.includes(Oe):Uu.has(Oe))){const Oe="function"==typeof Re.options.retryDelay?Re.options.retryDelay(Re):Re.options.retryDelay||0;return Oe>0&&await new Promise((Re=>setTimeout(Re,Oe))),$fetchRaw(Re.request,{...Re.options,retry:Le-1})}}const Oe=function(Re){const Le=Re.error?.message||Re.error?.toString()||"",Oe=Re.request?.method||Re.options?.method||"GET",Ue=Re.request?.url||String(Re.request)||"/",qe=`[${Oe}] ${JSON.stringify(Ue)}`,Ct=Re.response?`${Re.response.status} ${Re.response.statusText}`:"<no response>",Ot=new FetchError(`${qe}: ${Ct}${Le?` ${Le}`:""}`,Re.error?{cause:Re.error}:void 0);for(const Le of["request","options","response"])Object.defineProperty(Ot,Le,{get:()=>Re[Le]});for(const[Le,Oe]of[["data","_data"],["status","status"],["statusCode","status"],["statusText","statusText"],["statusMessage","statusText"]])Object.defineProperty(Ot,Le,{get:()=>Re.response&&Re.response[Oe]});return Ot}(Re);throw Error.captureStackTrace&&Error.captureStackTrace(Oe,$fetchRaw),Oe}const $fetchRaw=async function(qe,Ct={}){const Ot={request:qe,options:resolveFetchOptions(qe,Ct,Re.defaults,Oe),response:void 0,error:void 0};let Jt;if(Ot.options.method&&(Ot.options.method=Ot.options.method.toUpperCase()),Ot.options.onRequest&&await callHooks(Ot,Ot.options.onRequest),"string"==typeof Ot.request&&(Ot.options.baseURL&&(Ot.request=function(Re,Le){if(isEmptyURL(Le)||hasProtocol$1(Re))return Re;const Oe=withoutTrailingSlash$1(Le);return Re.startsWith(Oe)?Re:joinURL$1(Oe,Re)}(Ot.request,Ot.options.baseURL)),Ot.options.query&&(Ot.request=withQuery$1(Ot.request,Ot.options.query),delete Ot.options.query),"query"in Ot.options&&delete Ot.options.query,"params"in Ot.options&&delete Ot.options.params),Ot.options.body&&isPayloadMethod(Ot.options.method)&&(!function(Re){if(void 0===Re)return!1;const Le=typeof Re;return"string"===Le||"number"===Le||"boolean"===Le||null===Le||"object"===Le&&(!!Array.isArray(Re)||!Re.buffer&&(Re.constructor&&"Object"===Re.constructor.name||"function"==typeof Re.toJSON))}(Ot.options.body)?("pipeTo"in Ot.options.body&&"function"==typeof Ot.options.body.pipeTo||"function"==typeof Ot.options.body.pipe)&&("duplex"in Ot.options||(Ot.options.duplex="half")):(Ot.options.body="string"==typeof Ot.options.body?Ot.options.body:JSON.stringify(Ot.options.body),Ot.options.headers=new Oe(Ot.options.headers||{}),Ot.options.headers.has("content-type")||Ot.options.headers.set("content-type","application/json"),Ot.options.headers.has("accept")||Ot.options.headers.set("accept","application/json"))),!Ot.options.signal&&Ot.options.timeout){const Re=new Ue;Jt=setTimeout((()=>{const Le=new Error("[TimeoutError]: The operation was aborted due to timeout");Le.name="TimeoutError",Le.code=23,Re.abort(Le)}),Ot.options.timeout),Ot.options.signal=Re.signal}try{Ot.response=await Le(Ot.request,Ot.options)}catch(Re){return Ot.error=Re,Ot.options.onRequestError&&await callHooks(Ot,Ot.options.onRequestError),await onError(Ot)}finally{Jt&&clearTimeout(Jt)}if((Ot.response.body||Ot.response._bodyInit)&&!Hu.has(Ot.response.status)&&"HEAD"!==Ot.options.method){const Re=(Ot.options.parseResponse?"json":Ot.options.responseType)||function(Re=""){if(!Re)return"json";const Le=Re.split(";").shift()||"";return ju.test(Le)?"json":Nu.has(Le)||Le.startsWith("text/")?"text":"blob"}(Ot.response.headers.get("content-type")||"");switch(Re){case"json":{const Re=await Ot.response.text(),Le=Ot.options.parseResponse||destr;Ot.response._data=Le(Re);break}case"stream":Ot.response._data=Ot.response.body||Ot.response._bodyInit;break;default:Ot.response._data=await Ot.response[Re]()}}return Ot.options.onResponse&&await callHooks(Ot,Ot.options.onResponse),!Ot.options.ignoreResponseError&&Ot.response.status>=400&&Ot.response.status<600?(Ot.options.onResponseError&&await callHooks(Ot,Ot.options.onResponseError),await onError(Ot)):Ot.response},$fetch=async function(Re,Le){return(await $fetchRaw(Re,Le))._data};return $fetch.raw=$fetchRaw,$fetch.native=(...Re)=>Le(...Re),$fetch.create=(Le={},Oe={})=>createFetch$1({...Re,...Oe,defaults:{...Re.defaults,...Oe.defaults,...Le}}),$fetch}const Xu=function(){if("undefined"!=typeof globalThis)return globalThis;if("undefined"!=typeof self)return self;if("undefined"!=typeof global)return global;throw new Error("unable to locate global object")}(),Yu=Xu.fetch?(...Re)=>Xu.fetch(...Re):()=>Promise.reject(new Error("[ofetch] global.fetch is not supported!")),Ku=Xu.Headers,Ju=Xu.AbortController,Qu=createFetch$1({fetch:Yu,Headers:Ku,AbortController:Ju}),eh=new Set([101,204,205,304]);function flatHooks(Re,Le={},Oe){for(const Ue in Re){const qe=Re[Ue],Ct=Oe?`${Oe}:${Ue}`:Ue;"object"==typeof qe&&null!==qe?flatHooks(qe,Le,Ct):"function"==typeof qe&&(Le[Ct]=qe)}return Le}const th={run:Re=>Re()},rh=void 0!==console.createTask?console.createTask:()=>th;function serialTaskCaller(Re,Le){const Oe=Le.shift(),Ue=rh(Oe);return Re.reduce(((Re,Oe)=>Re.then((()=>Ue.run((()=>Oe(...Le)))))),Promise.resolve())}function parallelTaskCaller(Re,Le){const Oe=Le.shift(),Ue=rh(Oe);return Promise.all(Re.map((Re=>Ue.run((()=>Re(...Le))))))}function callEachWith(Re,Le){for(const Oe of[...Re])Oe(Le)}class Hookable{constructor(){this._hooks={},this._before=void 0,this._after=void 0,this._deprecatedMessages=void 0,this._deprecatedHooks={},this.hook=this.hook.bind(this),this.callHook=this.callHook.bind(this),this.callHookWith=this.callHookWith.bind(this)}hook(Re,Le,Oe={}){if(!Re||"function"!=typeof Le)return()=>{};const Ue=Re;let qe;for(;this._deprecatedHooks[Re];)qe=this._deprecatedHooks[Re],Re=qe.to;if(qe&&!Oe.allowDeprecated){let Re=qe.message;Re||(Re=`${Ue} hook has been deprecated`+(qe.to?`, please use ${qe.to}`:"")),this._deprecatedMessages||(this._deprecatedMessages=new Set),this._deprecatedMessages.has(Re)||(console.warn(Re),this._deprecatedMessages.add(Re))}if(!Le.name)try{Object.defineProperty(Le,"name",{get:()=>"_"+Re.replace(/\W+/g,"_")+"_hook_cb",configurable:!0})}catch{}return this._hooks[Re]=this._hooks[Re]||[],this._hooks[Re].push(Le),()=>{Le&&(this.removeHook(Re,Le),Le=void 0)}}hookOnce(Re,Le){let Oe,_function=(...Re)=>("function"==typeof Oe&&Oe(),Oe=void 0,_function=void 0,Le(...Re));return Oe=this.hook(Re,_function),Oe}removeHook(Re,Le){if(this._hooks[Re]){const Oe=this._hooks[Re].indexOf(Le);-1!==Oe&&this._hooks[Re].splice(Oe,1),0===this._hooks[Re].length&&delete this._hooks[Re]}}deprecateHook(Re,Le){this._deprecatedHooks[Re]="string"==typeof Le?{to:Le}:Le;const Oe=this._hooks[Re]||[];delete this._hooks[Re];for(const Le of Oe)this.hook(Re,Le)}deprecateHooks(Re){Object.assign(this._deprecatedHooks,Re);for(const Le in Re)this.deprecateHook(Le,Re[Le])}addHooks(Re){const Le=flatHooks(Re),Oe=Object.keys(Le).map((Re=>this.hook(Re,Le[Re])));return()=>{for(const Re of Oe.splice(0,Oe.length))Re()}}removeHooks(Re){const Le=flatHooks(Re);for(const Re in Le)this.removeHook(Re,Le[Re])}removeAllHooks(){for(const Re in this._hooks)delete this._hooks[Re]}callHook(Re,...Le){return Le.unshift(Re),this.callHookWith(serialTaskCaller,Re,...Le)}callHookParallel(Re,...Le){return Le.unshift(Re),this.callHookWith(parallelTaskCaller,Re,...Le)}callHookWith(Re,Le,...Oe){const Ue=this._before||this._after?{name:Le,args:Oe,context:{}}:void 0;this._before&&callEachWith(this._before,Ue);const qe=Re(Le in this._hooks?[...this._hooks[Le]]:[],Oe);return qe instanceof Promise?qe.finally((()=>{this._after&&Ue&&callEachWith(this._after,Ue)})):(this._after&&Ue&&callEachWith(this._after,Ue),qe)}beforeEach(Re){return this._before=this._before||[],this._before.push(Re),()=>{if(void 0!==this._before){const Le=this._before.indexOf(Re);-1!==Le&&this._before.splice(Le,1)}}}afterEach(Re){return this._after=this._after||[],this._after.push(Re),()=>{if(void 0!==this._after){const Le=this._after.indexOf(Re);-1!==Le&&this._after.splice(Le,1)}}}}function createHooks(){return new Hookable}function klona(Re){if("object"!=typeof Re)return Re;var Le,Oe,Ue=Object.prototype.toString.call(Re);if("[object Object]"===Ue){if(Re.constructor!==Object&&"function"==typeof Re.constructor)for(Le in Oe=new Re.constructor,Re)Re.hasOwnProperty(Le)&&Oe[Le]!==Re[Le]&&(Oe[Le]=klona(Re[Le]));else for(Le in Oe={},Re)"__proto__"===Le?Object.defineProperty(Oe,Le,{value:klona(Re[Le]),configurable:!0,enumerable:!0,writable:!0}):Oe[Le]=klona(Re[Le]);return Oe}if("[object Array]"===Ue){for(Le=Re.length,Oe=Array(Le);Le--;)Oe[Le]=klona(Re[Le]);return Oe}return"[object Set]"===Ue?(Oe=new Set,Re.forEach((function(Re){Oe.add(klona(Re))})),Oe):"[object Map]"===Ue?(Oe=new Map,Re.forEach((function(Re,Le){Oe.set(klona(Le),klona(Re))})),Oe):"[object Date]"===Ue?new Date(+Re):"[object RegExp]"===Ue?((Oe=new RegExp(Re.source,Re.flags)).lastIndex=Re.lastIndex,Oe):"[object DataView]"===Ue?new Re.constructor(klona(Re.buffer)):"[object ArrayBuffer]"===Ue?Re.slice(0):"Array]"===Ue.slice(-6)?new Re.constructor(Re):Re}const nh=/\d/,ih=["-","_","/","."];function isUppercase(Re=""){if(!nh.test(Re))return Re!==Re.toLowerCase()}function kebabCase(Re,Le){return Re?(Array.isArray(Re)?Re:function(Re){const Le=ih,Oe=[];if(!Re||"string"!=typeof Re)return Oe;let Ue,qe,Ct="";for(const Ot of Re){const Re=Le.includes(Ot);if(!0===Re){Oe.push(Ct),Ct="",Ue=void 0;continue}const Jt=isUppercase(Ot);if(!1===qe){if(!1===Ue&&!0===Jt){Oe.push(Ct),Ct=Ot,Ue=Jt;continue}if(!0===Ue&&!1===Jt&&Ct.length>1){const Re=Ct.at(-1);Oe.push(Ct.slice(0,Math.max(0,Ct.length-1))),Ct=Re+Ot,Ue=Jt;continue}}Ct+=Ot,Ue=Jt,qe=Re}return Oe.push(Ct),Oe}(Re)).map((Re=>Re.toLowerCase())).join(Le):""}function getEnv(Re,Le){const Oe=(Ue=Re,kebabCase(Ue||"","_")).toUpperCase();var Ue;return destr(process.env[Le.prefix+Oe]??process.env[Le.altPrefix+Oe])}function _isObject(Re){return"object"==typeof Re&&!Array.isArray(Re)}function applyEnv(Re,Le,Oe=""){for(const Ue in Re){const qe=Oe?`${Oe}_${Ue}`:Ue,Ct=getEnv(qe,Le);_isObject(Re[Ue])?_isObject(Ct)?(Re[Ue]={...Re[Ue],...Ct},applyEnv(Re[Ue],Le,qe)):void 0===Ct?applyEnv(Re[Ue],Le,qe):Re[Ue]=Ct??Re[Ue]:Re[Ue]=Ct??Re[Ue],Le.envExpansion&&"string"==typeof Re[Ue]&&(Re[Ue]=Re[Ue].replace(sh,((Re,Le)=>process.env[Le]||Re)))}return Re}const sh=/{{(.*?)}}/g;const ah=oc({title:"My Travel App"},{nuxt:{},_MAPBOX_CONFIG:{accessToken:"{pk.eyJ1IjoiYXJuYXVkc3dlZW4iLCJhIjoiY20yZWZlYmRsMWtvbDJqcXhnc2QxZzBrYyJ9.Fb5BoKHGFCI8TJlLOookNQ}"}}),ch={app:{baseURL:"/",buildId:"ae8d9088-6b49-4619-9c41-7a257af2a028",buildAssetsDir:"/_nuxt/",cdnURL:""},nitro:{envPrefix:"NUXT_",routeRules:{"/__nuxt_error":{cache:!1,isr:!1},"/destinations":{ssr:!1},"/destinations/*":{ssr:!1},"/api/**":{cors:!0,headers:{"access-control-allow-origin":"*","access-control-allow-methods":"*","access-control-allow-headers":"*","access-control-max-age":"0","Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"*","Access-Control-Allow-Credentials":"true","Access-Control-Allow-Headers":"*","Access-Control-Expose-Headers":"*"}},"/_nuxt/builds/meta/**":{headers:{"cache-control":"public, max-age=31536000, immutable"}},"/_nuxt/builds/**":{headers:{"cache-control":"public, max-age=1, immutable"}},"/_fonts/**":{headers:{"cache-control":"public, max-age=31536000, immutable"}},"/_nuxt/**":{headers:{"cache-control":"public, max-age=31536000, immutable"}}}},public:{device:{defaultUserAgent:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.39 Safari/537.36",enabled:!0,refreshOnResize:!1},i18n:{baseUrl:"",defaultLocale:"",defaultDirection:"ltr",strategy:"prefix_except_default",lazy:!1,rootRedirect:"",routesNameSeparator:"___",defaultLocaleRouteNameSuffix:"default",skipSettingLocaleOnNavigate:!1,differentDomains:!1,trailingSlash:!1,configLocales:[],locales:{},detectBrowserLanguage:{alwaysRedirect:!0,cookieCrossOrigin:!1,cookieDomain:"",cookieKey:"i18n_redirected",cookieSecure:!1,fallbackLocale:"fr-FR",redirectOn:"root",useCookie:!1},experimental:{localeDetector:"",switchLocalePathLinkSSR:!1,autoImportTranslationFunctions:!1}},mapbox:{accessToken:"{pk.eyJ1IjoiYXJuYXVkc3dlZW4iLCJhIjoiY20yZWZlYmRsMWtvbDJqcXhnc2QxZzBrYyJ9.Fb5BoKHGFCI8TJlLOookNQ}",persistent:!0},cookieControl:{barPosition:"bottom-full",closeModalOnClickOutside:!1,colors:{barBackground:"#000",barButtonBackground:"#fff",barButtonColor:"#000",barButtonHoverBackground:"#333",barButtonHoverColor:"#fff",barTextColor:"#fff",checkboxActiveBackground:"#000",checkboxActiveCircleBackground:"#fff",checkboxDisabledBackground:"#ddd",checkboxDisabledCircleBackground:"#fff",checkboxInactiveBackground:"#000",checkboxInactiveCircleBackground:"#fff",controlButtonBackground:"#fff",controlButtonHoverBackground:"#000",controlButtonIconColor:"#000",controlButtonIconHoverColor:"#fff",focusRingColor:"#808080",modalBackground:"#fff",modalButtonBackground:"#000",modalButtonColor:"#fff",modalButtonHoverBackground:"#333",modalButtonHoverColor:"#fff",modalOverlay:"#000",modalOverlayOpacity:.8,modalTextColor:"#000",modalUnsavedColor:"#fff"},cookies:{necessary:[],optional:[]},cookieExpiryOffsetMs:31536e6,cookieNameIsConsentGiven:"ncc_c",cookieNameCookiesEnabledIds:"ncc_e",cookieOptions:{path:"/",sameSite:"strict",secure:!0},isAcceptNecessaryButtonEnabled:!0,isControlButtonEnabled:!0,isCookieIdVisible:!1,isCssEnabled:!0,isCssPonyfillEnabled:!1,isDashInDescriptionEnabled:!0,isIframeBlocked:!1,isModalForced:!1,locales:["en"],localeTexts:{en:{accept:"Accept",acceptAll:"Accept all",bannerDescription:"We use our own cookies and third-party cookies so that we can display this website correctly and better understand how this website is used, with a view to improving the services we offer. A decision on cookie usage permissions can be changed anytime using the cookie button that will appear after a selection has been made on this banner.",bannerTitle:"Cookies",close:"Close",cookiesFunctional:"Functional cookies",cookiesNecessary:"Necessary cookies",cookiesOptional:"Optional cookies",decline:"Decline",declineAll:"Decline all",here:"here",iframeBlocked:"To see this, please enable functional cookies",manageCookies:"Learn more and customize",save:"Save",settingsUnsaved:"You have unsaved settings"}}}}},yh={prefix:"NITRO_",altPrefix:ch.nitro.envPrefix??process.env.NITRO_ENV_PREFIX??"_",envExpansion:ch.nitro.envExpansion??process.env.NITRO_ENV_EXPANSION??!1},Th=_deepFreeze(applyEnv(klona(ch),yh));function useRuntimeConfig$1(Re){if(!Re)return Th;if(Re.context.nitro.runtimeConfig)return Re.context.nitro.runtimeConfig;const Le=klona(ch);return applyEnv(Le,yh),Re.context.nitro.runtimeConfig=Le,Le}function _deepFreeze(Re){const Le=Object.getOwnPropertyNames(Re);for(const Oe of Le){const Le=Re[Oe];Le&&"object"==typeof Le&&_deepFreeze(Le)}return Object.freeze(Re)}function asyncCall(Re,...Le){try{return(Oe=Re(...Le))&&"function"==typeof Oe.then?Oe:Promise.resolve(Oe)}catch(Re){return Promise.reject(Re)}var Oe}function stringify$1(Re){if(function(Re){const Le=typeof Re;return null===Re||"object"!==Le&&"function"!==Le}(Re))return String(Re);if(function(Re){const Le=Object.getPrototypeOf(Re);return!Le||Le.isPrototypeOf(Object)}(Re)||Array.isArray(Re))return JSON.stringify(Re);if("function"==typeof Re.toJSON)return stringify$1(Re.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function checkBufferSupport(){if(void 0===Ln)throw new TypeError("[unstorage] Buffer is not supported!")}_deepFreeze(klona(ah)),new Proxy(Object.create(null),{get:(Re,Le)=>{console.warn("Please use `useRuntimeConfig()` instead of accessing config directly.");const Oe=useRuntimeConfig$1();if(Le in Oe)return Oe[Le]}});const Eh="base64:";const Ch=["hasItem","getItem","getItemRaw","setItem","setItemRaw","removeItem","getMeta","setMeta","removeMeta","getKeys","clear","mount","unmount"];function normalizeKey$3(Re){return Re?Re.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function joinKeys$1(...Re){return normalizeKey$3(Re.join(":"))}function normalizeBaseKey(Re){return(Re=normalizeKey$3(Re))?Re+":":""}const memory=()=>{const Re=new Map;return{name:"memory",getInstance:()=>Re,hasItem:Le=>Re.has(Le),getItem:Le=>Re.get(Le)??null,getItemRaw:Le=>Re.get(Le)??null,setItem(Le,Oe){Re.set(Le,Oe)},setItemRaw(Le,Oe){Re.set(Le,Oe)},removeItem(Le){Re.delete(Le)},getKeys:()=>[...Re.keys()],clear(){Re.clear()},dispose(){Re.clear()}}};function watch$2(Re,Le,Oe){return Re.watch?Re.watch(((Re,Ue)=>Le(Re,Oe+Ue))):()=>{}}async function dispose(Re){"function"==typeof Re.dispose&&await asyncCall(Re.dispose)}const Rh={},normalizeKey$2=function(Re){return Re?Re.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""},zh={getKeys:()=>Promise.resolve(Object.keys(Rh)),hasItem:Re=>(Re=normalizeKey$2(Re),Promise.resolve(Re in Rh)),getItem:Re=>(Re=normalizeKey$2(Re),Promise.resolve(Rh[Re]?Rh[Re].import():null)),getMeta:Re=>(Re=normalizeKey$2(Re),Promise.resolve(Rh[Re]?Rh[Re].meta:{}))};var Dh="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function getDefaultExportFromCjs(Re){return Re&&Re.__esModule&&Object.prototype.hasOwnProperty.call(Re,"default")?Re.default:Re}var Bh={exports:{}};var Vh,Gh={exports:{}},nd={exports:{}},id={};function requireWeb(){if(Vh)return id;Vh=1,Object.defineProperty(id,"__esModule",{value:!0}),id.subtle=id.randomUUID=id.getRandomValues=void 0,id.subtle=globalThis.crypto?.subtle;id.randomUUID=()=>globalThis.crypto?.randomUUID();return id.getRandomValues=Re=>globalThis.crypto?.getRandomValues(Re),id}var ld,ud,_d,xd,wd={},Sd={};function requireNode(){if(ud)return wd;ud=1,Object.defineProperty(wd,"__esModule",{value:!0}),wd.webcrypto=wd.verify=wd.timingSafeEqual=wd.sign=wd.setFips=wd.setEngine=wd.secureHeapUsed=wd.scryptSync=wd.scrypt=wd.randomInt=wd.randomFillSync=wd.randomFill=wd.randomBytes=wd.publicEncrypt=wd.publicDecrypt=wd.pseudoRandomBytes=wd.privateEncrypt=wd.privateDecrypt=wd.pbkdf2Sync=wd.pbkdf2=wd.hkdfSync=wd.hkdf=wd.getHashes=wd.getFips=wd.getDiffieHellman=wd.getCurves=wd.getCiphers=wd.getCipherInfo=wd.generatePrimeSync=wd.generatePrime=wd.generateKeySync=wd.generateKeyPairSync=wd.generateKeyPair=wd.generateKey=wd.fips=wd.diffieHellman=wd.createVerify=wd.createSign=wd.createSecretKey=wd.createPublicKey=wd.createPrivateKey=wd.createHmac=wd.createHash=wd.createECDH=wd.createDiffieHellmanGroup=wd.createDiffieHellman=wd.createDecipheriv=wd.createDecipher=wd.createCipheriv=wd.createCipher=wd.constants=wd.checkPrimeSync=wd.checkPrime=wd.X509Certificate=wd.Verify=wd.Sign=wd.KeyObject=wd.Hmac=wd.Hash=wd.ECDH=wd.DiffieHellmanGroup=wd.DiffieHellman=wd.Decipheriv=wd.Decipher=wd.Cipheriv=wd.Cipher=wd.Certificate=void 0;var Re=function(){if(ld)return Sd;function createNotImplementedError(Re){throw new Error(`[unenv] ${Re} is not implemented yet!`)}return ld=1,Object.defineProperty(Sd,"__esModule",{value:!0}),Sd.createNotImplementedError=createNotImplementedError,Sd.mergeFns=function(...Re){return function(...Le){for(const Oe of Re)Oe(...Le)}},Sd.notImplemented=function(Re){return Object.assign((()=>{throw createNotImplementedError(Re)}),{__unenv__:!0})},Sd.notImplementedClass=function(Re){return class{__unenv__=!0;constructor(){throw new Error(`[unenv] ${Re} is not implemented yet!`)}}},Sd.rawHeaders=function(Re){const Le=[];for(const Oe in Re)if(Array.isArray(Re[Oe]))for(const Ue of Re[Oe])Le.push(Oe,Ue);else Le.push(Oe,Re[Oe]);return Le},Sd}(),Le=requireWeb();wd.webcrypto=new Proxy(globalThis.crypto,{get:(Re,Le)=>"CryptoKey"===Le?globalThis.CryptoKey:"function"==typeof globalThis.crypto[Le]?globalThis.crypto[Le].bind(globalThis.crypto):globalThis.crypto[Le]});return wd.randomBytes=(Re,Oe)=>{const Ue=Ln.alloc(Re,0,void 0);for(let Oe=0;Oe<Re;Oe+=65536)(0,Le.getRandomValues)(Uint8Array.prototype.slice.call(Ue,Oe,Oe+65536));if("function"!=typeof Oe)return Ue;Oe(null,Ue)},wd.fips=!1,wd.constants={},wd.checkPrime=(0,Re.notImplemented)("crypto.checkPrime"),wd.checkPrimeSync=(0,Re.notImplemented)("crypto.checkPrimeSync"),wd.createCipher=(0,Re.notImplemented)("crypto.createCipher"),wd.createDecipher=(0,Re.notImplemented)("crypto.createDecipher"),wd.pseudoRandomBytes=(0,Re.notImplemented)("crypto.pseudoRandomBytes"),wd.createCipheriv=(0,Re.notImplemented)("crypto.createCipheriv"),wd.createDecipheriv=(0,Re.notImplemented)("crypto.createDecipheriv"),wd.createDiffieHellman=(0,Re.notImplemented)("crypto.createDiffieHellman"),wd.createDiffieHellmanGroup=(0,Re.notImplemented)("crypto.createDiffieHellmanGroup"),wd.createECDH=(0,Re.notImplemented)("crypto.createECDH"),wd.createHash=(0,Re.notImplemented)("crypto.createHash"),wd.createHmac=(0,Re.notImplemented)("crypto.createHmac"),wd.createPrivateKey=(0,Re.notImplemented)("crypto.createPrivateKey"),wd.createPublicKey=(0,Re.notImplemented)("crypto.createPublicKey"),wd.createSecretKey=(0,Re.notImplemented)("crypto.createSecretKey"),wd.createSign=(0,Re.notImplemented)("crypto.createSign"),wd.createVerify=(0,Re.notImplemented)("crypto.createVerify"),wd.diffieHellman=(0,Re.notImplemented)("crypto.diffieHellman"),wd.generatePrime=(0,Re.notImplemented)("crypto.generatePrime"),wd.generatePrimeSync=(0,Re.notImplemented)("crypto.generatePrimeSync"),wd.getCiphers=(0,Re.notImplemented)("crypto.getCiphers"),wd.getCipherInfo=(0,Re.notImplemented)("crypto.getCipherInfo"),wd.getCurves=(0,Re.notImplemented)("crypto.getCurves"),wd.getDiffieHellman=(0,Re.notImplemented)("crypto.getDiffieHellman"),wd.getHashes=(0,Re.notImplemented)("crypto.getHashes"),wd.hkdf=(0,Re.notImplemented)("crypto.hkdf"),wd.hkdfSync=(0,Re.notImplemented)("crypto.hkdfSync"),wd.pbkdf2=(0,Re.notImplemented)("crypto.pbkdf2"),wd.pbkdf2Sync=(0,Re.notImplemented)("crypto.pbkdf2Sync"),wd.generateKeyPair=(0,Re.notImplemented)("crypto.generateKeyPair"),wd.generateKeyPairSync=(0,Re.notImplemented)("crypto.generateKeyPairSync"),wd.generateKey=(0,Re.notImplemented)("crypto.generateKey"),wd.generateKeySync=(0,Re.notImplemented)("crypto.generateKeySync"),wd.privateDecrypt=(0,Re.notImplemented)("crypto.privateDecrypt"),wd.privateEncrypt=(0,Re.notImplemented)("crypto.privateEncrypt"),wd.publicDecrypt=(0,Re.notImplemented)("crypto.publicDecrypt"),wd.publicEncrypt=(0,Re.notImplemented)("crypto.publicEncrypt"),wd.randomFill=(0,Re.notImplemented)("crypto.randomFill"),wd.randomFillSync=(0,Re.notImplemented)("crypto.randomFillSync"),wd.randomInt=(0,Re.notImplemented)("crypto.randomInt"),wd.scrypt=(0,Re.notImplemented)("crypto.scrypt"),wd.scryptSync=(0,Re.notImplemented)("crypto.scryptSync"),wd.sign=(0,Re.notImplemented)("crypto.sign"),wd.setEngine=(0,Re.notImplemented)("crypto.setEngine"),wd.timingSafeEqual=(0,Re.notImplemented)("crypto.timingSafeEqual"),wd.getFips=(0,Re.notImplemented)("crypto.getFips"),wd.setFips=(0,Re.notImplemented)("crypto.setFips"),wd.verify=(0,Re.notImplemented)("crypto.verify"),wd.secureHeapUsed=(0,Re.notImplemented)("crypto.secureHeapUsed"),wd.Certificate=(0,Re.notImplementedClass)("crypto.Certificate"),wd.Cipher=(0,Re.notImplementedClass)("crypto.Cipher"),wd.Cipheriv=(0,Re.notImplementedClass)("crypto.Cipheriv"),wd.Decipher=(0,Re.notImplementedClass)("crypto.Decipher"),wd.Decipheriv=(0,Re.notImplementedClass)("crypto.Decipheriv"),wd.DiffieHellman=(0,Re.notImplementedClass)("crypto.DiffieHellman"),wd.DiffieHellmanGroup=(0,Re.notImplementedClass)("crypto.DiffieHellmanGroup"),wd.ECDH=(0,Re.notImplementedClass)("crypto.ECDH"),wd.Hash=(0,Re.notImplementedClass)("crypto.Hash"),wd.Hmac=(0,Re.notImplementedClass)("crypto.Hmac"),wd.KeyObject=(0,Re.notImplementedClass)("crypto.KeyObject"),wd.Sign=(0,Re.notImplementedClass)("crypto.Sign"),wd.Verify=(0,Re.notImplementedClass)("crypto.Verify"),wd.X509Certificate=(0,Re.notImplementedClass)("crypto.X509Certificate"),wd}function requireCrypto(){return _d||(_d=1,function(Re,Le){Object.defineProperty(Le,"__esModule",{value:!0});var Oe={},Ue=_interopRequireWildcard(requireWeb());Object.keys(Ue).forEach((function(Re){"default"!==Re&&"__esModule"!==Re&&(Object.prototype.hasOwnProperty.call(Oe,Re)||Re in Le&&Le[Re]===Ue[Re]||Object.defineProperty(Le,Re,{enumerable:!0,get:function(){return Ue[Re]}}))}));var qe=_interopRequireWildcard(requireNode());function _getRequireWildcardCache(Re){if("function"!=typeof WeakMap)return null;var Le=new WeakMap,Oe=new WeakMap;return(_getRequireWildcardCache=function(Re){return Re?Oe:Le})(Re)}function _interopRequireWildcard(Re,Le){if(Re&&Re.__esModule)return Re;if(null===Re||"object"!=typeof Re&&"function"!=typeof Re)return{default:Re};var Oe=_getRequireWildcardCache(Le);if(Oe&&Oe.has(Re))return Oe.get(Re);var Ue={__proto__:null},qe=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Ct in Re)if("default"!==Ct&&{}.hasOwnProperty.call(Re,Ct)){var Ot=qe?Object.getOwnPropertyDescriptor(Re,Ct):null;Ot&&(Ot.get||Ot.set)?Object.defineProperty(Ue,Ct,Ot):Ue[Ct]=Re[Ct]}return Ue.default=Re,Oe&&Oe.set(Re,Ue),Ue}Object.keys(qe).forEach((function(Re){"default"!==Re&&"__esModule"!==Re&&(Object.prototype.hasOwnProperty.call(Oe,Re)||Re in Le&&Le[Re]===qe[Re]||Object.defineProperty(Le,Re,{enumerable:!0,get:function(){return qe[Re]}}))})),Re.exports={...Ue,...qe}}(nd,nd.exports)),nd.exports}function requireCore(){return xd||(xd=1,Gh.exports=(Re=Re||function(Re,Le){var Oe;if("undefined"!=typeof self&&self.crypto&&(Oe=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(Oe=globalThis.crypto),!Oe&&void 0!==Dh&&Dh.crypto&&(Oe=Dh.crypto),!Oe)try{Oe=requireCrypto()}catch(Re){}var cryptoSecureRandomInt=function(){if(Oe){if("function"==typeof Oe.getRandomValues)try{return Oe.getRandomValues(new Uint32Array(1))[0]}catch(Re){}if("function"==typeof Oe.randomBytes)try{return Oe.randomBytes(4).readInt32LE()}catch(Re){}}throw new Error("Native crypto module could not be used to get secure random number.")},Ue=Object.create||function(){function F(){}return function(Re){var Le;return F.prototype=Re,Le=new F,F.prototype=null,Le}}(),qe={},Ct=qe.lib={},Ot=Ct.Base={extend:function(Re){var Le=Ue(this);return Re&&Le.mixIn(Re),Le.hasOwnProperty("init")&&this.init!==Le.init||(Le.init=function(){Le.$super.init.apply(this,arguments)}),Le.init.prototype=Le,Le.$super=this,Le},create:function(){var Re=this.extend();return Re.init.apply(Re,arguments),Re},init:function(){},mixIn:function(Re){for(var Le in Re)Re.hasOwnProperty(Le)&&(this[Le]=Re[Le]);Re.hasOwnProperty("toString")&&(this.toString=Re.toString)},clone:function(){return this.init.prototype.extend(this)}},Jt=Ct.WordArray=Ot.extend({init:function(Re,Oe){Re=this.words=Re||[],this.sigBytes=Oe!=Le?Oe:4*Re.length},toString:function(Re){return(Re||Jr).stringify(this)},concat:function(Re){var Le=this.words,Oe=Re.words,Ue=this.sigBytes,qe=Re.sigBytes;if(this.clamp(),Ue%4)for(var Ct=0;Ct<qe;Ct++){var Ot=Oe[Ct>>>2]>>>24-Ct%4*8&255;Le[Ue+Ct>>>2]|=Ot<<24-(Ue+Ct)%4*8}else for(var Jt=0;Jt<qe;Jt+=4)Le[Ue+Jt>>>2]=Oe[Jt>>>2];return this.sigBytes+=qe,this},clamp:function(){var Le=this.words,Oe=this.sigBytes;Le[Oe>>>2]&=4294967295<<32-Oe%4*8,Le.length=Re.ceil(Oe/4)},clone:function(){var Re=Ot.clone.call(this);return Re.words=this.words.slice(0),Re},random:function(Re){for(var Le=[],Oe=0;Oe<Re;Oe+=4)Le.push(cryptoSecureRandomInt());return new Jt.init(Le,Re)}}),Hr=qe.enc={},Jr=Hr.Hex={stringify:function(Re){for(var Le=Re.words,Oe=Re.sigBytes,Ue=[],qe=0;qe<Oe;qe++){var Ct=Le[qe>>>2]>>>24-qe%4*8&255;Ue.push((Ct>>>4).toString(16)),Ue.push((15&Ct).toString(16))}return Ue.join("")},parse:function(Re){for(var Le=Re.length,Oe=[],Ue=0;Ue<Le;Ue+=2)Oe[Ue>>>3]|=parseInt(Re.substr(Ue,2),16)<<24-Ue%8*4;return new Jt.init(Oe,Le/2)}},Ln=Hr.Latin1={stringify:function(Re){for(var Le=Re.words,Oe=Re.sigBytes,Ue=[],qe=0;qe<Oe;qe++){var Ct=Le[qe>>>2]>>>24-qe%4*8&255;Ue.push(String.fromCharCode(Ct))}return Ue.join("")},parse:function(Re){for(var Le=Re.length,Oe=[],Ue=0;Ue<Le;Ue++)Oe[Ue>>>2]|=(255&Re.charCodeAt(Ue))<<24-Ue%4*8;return new Jt.init(Oe,Le)}},Nn=Hr.Utf8={stringify:function(Re){try{return decodeURIComponent(escape(Ln.stringify(Re)))}catch(Re){throw new Error("Malformed UTF-8 data")}},parse:function(Re){return Ln.parse(unescape(encodeURIComponent(Re)))}},$n=Ct.BufferedBlockAlgorithm=Ot.extend({reset:function(){this._data=new Jt.init,this._nDataBytes=0},_append:function(Re){"string"==typeof Re&&(Re=Nn.parse(Re)),this._data.concat(Re),this._nDataBytes+=Re.sigBytes},_process:function(Le){var Oe,Ue=this._data,qe=Ue.words,Ct=Ue.sigBytes,Ot=this.blockSize,Hr=Ct/(4*Ot),Jr=(Hr=Le?Re.ceil(Hr):Re.max((0|Hr)-this._minBufferSize,0))*Ot,Ln=Re.min(4*Jr,Ct);if(Jr){for(var Nn=0;Nn<Jr;Nn+=Ot)this._doProcessBlock(qe,Nn);Oe=qe.splice(0,Jr),Ue.sigBytes-=Ln}return new Jt.init(Oe,Ln)},clone:function(){var Re=Ot.clone.call(this);return Re._data=this._data.clone(),Re},_minBufferSize:0});Ct.Hasher=$n.extend({cfg:Ot.extend(),init:function(Re){this.cfg=this.cfg.extend(Re),this.reset()},reset:function(){$n.reset.call(this),this._doReset()},update:function(Re){return this._append(Re),this._process(),this},finalize:function(Re){return Re&&this._append(Re),this._doFinalize()},blockSize:16,_createHelper:function(Re){return function(Le,Oe){return new Re.init(Oe).finalize(Le)}},_createHmacHelper:function(Re){return function(Le,Oe){return new Gn.HMAC.init(Re,Oe).finalize(Le)}}});var Gn=qe.algo={};return qe}(Math),Re)),Gh.exports;var Re}const Cd=getDefaultExportFromCjs(Bh.exports=requireCore().enc.Hex);var Ad,Md={exports:{}};Md.exports=(Ad=requireCore(),function(){var Re=Ad,Le=Re.lib,Oe=Le.WordArray,Ue=Le.Hasher,qe=Re.algo,Ct=[],Ot=qe.SHA1=Ue.extend({_doReset:function(){this._hash=new Oe.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(Re,Le){for(var Oe=this._hash.words,Ue=Oe[0],qe=Oe[1],Ot=Oe[2],Jt=Oe[3],Hr=Oe[4],Jr=0;Jr<80;Jr++){if(Jr<16)Ct[Jr]=0|Re[Le+Jr];else{var Ln=Ct[Jr-3]^Ct[Jr-8]^Ct[Jr-14]^Ct[Jr-16];Ct[Jr]=Ln<<1|Ln>>>31}var Nn=(Ue<<5|Ue>>>27)+Hr+Ct[Jr];Nn+=Jr<20?1518500249+(qe&Ot|~qe&Jt):Jr<40?1859775393+(qe^Ot^Jt):Jr<60?(qe&Ot|qe&Jt|Ot&Jt)-1894007588:(qe^Ot^Jt)-899497514,Hr=Jt,Jt=Ot,Ot=qe<<30|qe>>>2,qe=Ue,Ue=Nn}Oe[0]=Oe[0]+Ue|0,Oe[1]=Oe[1]+qe|0,Oe[2]=Oe[2]+Ot|0,Oe[3]=Oe[3]+Jt|0,Oe[4]=Oe[4]+Hr|0},_doFinalize:function(){var Re=this._data,Le=Re.words,Oe=8*this._nDataBytes,Ue=8*Re.sigBytes;return Le[Ue>>>5]|=128<<24-Ue%32,Le[14+(Ue+64>>>9<<4)]=Math.floor(Oe/4294967296),Le[15+(Ue+64>>>9<<4)]=Oe,Re.sigBytes=4*Le.length,this._process(),this._hash},clone:function(){var Re=Ue.clone.call(this);return Re._hash=this._hash.clone(),Re}});Re.SHA1=Ue._createHelper(Ot),Re.HmacSHA1=Ue._createHmacHelper(Ot)}(),Ad.SHA1);const Od=getDefaultExportFromCjs(Md.exports);var zd=Object.defineProperty;((Re,Le)=>{for(var Oe in Le)zd(Re,Oe,{get:Le[Oe],enumerable:!0})})({},{UpstashError:()=>Bd,UrlError:()=>Ud});var Bd=class extends Error{constructor(Re){super(Re),this.name="UpstashError"}},Ud=class extends Error{constructor(Re){super(`Upstash Redis client was passed an invalid URL. You should pass a URL starting with https. Received: "${Re}". `),this.name="UrlError"}},Hd=class{baseUrl;headers;options;readYourWrites;upstashSyncToken="";hasCredentials;retry;constructor(Re){this.options={backend:Re.options?.backend,agent:Re.agent,responseEncoding:Re.responseEncoding??"base64",cache:Re.cache,signal:Re.signal,keepAlive:Re.keepAlive??!0},this.upstashSyncToken="",this.readYourWrites=Re.readYourWrites??!0,this.baseUrl=(Re.baseUrl||"").replace(/\/$/,"");if(this.baseUrl&&!/^https?:\/\/[^\s#$./?].\S*$/.test(this.baseUrl))throw new Ud(this.baseUrl);this.headers={"Content-Type":"application/json",...Re.headers},this.hasCredentials=Boolean(this.baseUrl&&this.headers.authorization.split(" ")[1]),"base64"===this.options.responseEncoding&&(this.headers["Upstash-Encoding"]="base64"),this.retry="boolean"!=typeof Re.retry||Re.retry?{attempts:Re.retry?.retries??5,backoff:Re.retry?.backoff??(Re=>50*Math.exp(Re))}:{attempts:1,backoff:()=>0}}mergeTelemetry(Re){this.headers=merge(this.headers,"Upstash-Telemetry-Runtime",Re.runtime),this.headers=merge(this.headers,"Upstash-Telemetry-Platform",Re.platform),this.headers=merge(this.headers,"Upstash-Telemetry-Sdk",Re.sdk)}async request(Re){const Le={cache:this.options.cache,method:"POST",headers:this.headers,body:JSON.stringify(Re.body),keepalive:this.options.keepAlive,agent:this.options.agent,signal:this.options.signal,backend:this.options.backend};if(this.hasCredentials||console.warn("[Upstash Redis] Redis client was initialized without url or token. Failed to execute command."),this.readYourWrites){const Re=this.upstashSyncToken;this.headers["upstash-sync-token"]=Re}let Oe=null,Ue=null;for(let qe=0;qe<=this.retry.attempts;qe++)try{Oe=await fetch([this.baseUrl,...Re.path??[]].join("/"),Le);break}catch(Re){if(this.options.signal?.aborted){const Re=new Blob([JSON.stringify({result:this.options.signal.reason??"Aborted"})]),Le={status:200,statusText:this.options.signal.reason??"Aborted"};Oe=new Response(Re,Le);break}Ue=Re,await new Promise((Re=>setTimeout(Re,this.retry.backoff(qe))))}if(!Oe)throw Ue??new Error("Exhausted all retries");const qe=await Oe.json();if(!Oe.ok)throw new Bd(`${qe.error}, command was: ${JSON.stringify(Re.body)}`);if(this.readYourWrites){const Re=Oe.headers;this.upstashSyncToken=Re.get("upstash-sync-token")??""}if(this.readYourWrites){const Re=Oe.headers;this.upstashSyncToken=Re.get("upstash-sync-token")??""}if("base64"===this.options.responseEncoding){if(Array.isArray(qe))return qe.map((({result:Re,error:Le})=>({result:decode$2(Re),error:Le})));return{result:decode$2(qe.result),error:qe.error}}return qe}};function base64decode(Re){let Le="";try{const Oe=atob(Re),Ue=Oe.length,qe=new Uint8Array(Ue);for(let Re=0;Re<Ue;Re++)qe[Re]=Oe.charCodeAt(Re);Le=(new TextDecoder).decode(qe)}catch{Le=Re}return Le}function decode$2(Re){let Le;switch(typeof Re){case"undefined":return Re;case"number":Le=Re;break;case"object":Le=Array.isArray(Re)?Re.map((Re=>"string"==typeof Re?base64decode(Re):Array.isArray(Re)?Re.map((Re=>decode$2(Re))):Re)):null;break;case"string":Le="OK"===Re?"OK":base64decode(Re)}return Le}function merge(Re,Le,Oe){return Oe?(Re[Le]=Re[Le]?[Re[Le],Oe].join(","):Oe,Re):Re}function parseRecursive(Re){const Le=Array.isArray(Re)?Re.map((Re=>{try{return parseRecursive(Re)}catch{return Re}})):JSON.parse(Re);return"number"==typeof Le&&Le.toString()!==Re?Re:Le}function parseResponse(Re){try{return parseRecursive(Re)}catch{return Re}}function deserializeScanResponse(Re){return[Re[0],...parseResponse(Re.slice(1))]}var defaultSerializer=Re=>{switch(typeof Re){case"string":case"number":case"boolean":return Re;default:return JSON.stringify(Re)}},Wd=class{command;serialize;deserialize;constructor(Re,Le){if(this.serialize=defaultSerializer,this.deserialize=void 0===Le?.automaticDeserialization||Le.automaticDeserialization?Le?.deserialize??parseResponse:Re=>Re,this.command=Re.map((Re=>this.serialize(Re))),Le?.latencyLogging){const Re=this.exec.bind(this);this.exec=async Le=>{const Oe=performance.now(),Ue=await Re(Le),qe=(performance.now()-Oe).toFixed(2);return console.log(`Latency for [38;2;19;185;39m${this.command[0].toString().toUpperCase()}[0m: [38;2;0;255;255m${qe} ms[0m`),Ue}}}async exec(Re){const{result:Le,error:Oe}=await Re.request({body:this.command,upstashSyncToken:Re.upstashSyncToken});if(Oe)throw new Bd(Oe);if(void 0===Le)throw new TypeError("Request did not return a result");return this.deserialize(Le)}};var Kd=class extends Wd{constructor(Re,Le){const Oe=["hrandfield",Re[0]];"number"==typeof Re[1]&&Oe.push(Re[1]),Re[2]&&Oe.push("WITHVALUES"),super(Oe,{deserialize:Re[2]?Re=>function(Re){if(0===Re.length)return null;const Le={};for(;Re.length>=2;){const Oe=Re.shift(),Ue=Re.shift();try{Le[Oe]=JSON.parse(Ue)}catch{Le[Oe]=Ue}}return Le}(Re):Le?.deserialize,...Le})}},sp=class extends Wd{constructor(Re,Le){super(["append",...Re],Le)}},ap=class extends Wd{constructor([Re,Le,Oe],Ue){const qe=["bitcount",Re];"number"==typeof Le&&qe.push(Le),"number"==typeof Oe&&qe.push(Oe),super(qe,Ue)}},cp=class{constructor(Re,Le,Oe,Ue=Re=>Re.exec(this.client)){this.client=Le,this.opts=Oe,this.execOperation=Ue,this.command=["bitfield",...Re]}command;chain(...Re){return this.command.push(...Re),this}get(...Re){return this.chain("get",...Re)}set(...Re){return this.chain("set",...Re)}incrby(...Re){return this.chain("incrby",...Re)}overflow(Re){return this.chain("overflow",Re)}exec(){const Re=new Wd(this.command,this.opts);return this.execOperation(Re)}},hp=class extends Wd{constructor(Re,Le){super(["bitop",...Re],Le)}},dp=class extends Wd{constructor(Re,Le){super(["bitpos",...Re],Le)}},pp=class extends Wd{constructor([Re,Le,Oe],Ue){super(["COPY",Re,Le,...Oe?.replace?["REPLACE"]:[]],{...Ue,deserialize:Re=>Re>0?"COPIED":"NOT_COPIED"})}},fp=class extends Wd{constructor(Re){super(["dbsize"],Re)}},mp=class extends Wd{constructor(Re,Le){super(["decr",...Re],Le)}},yp=class extends Wd{constructor(Re,Le){super(["decrby",...Re],Le)}},vp=class extends Wd{constructor(Re,Le){super(["del",...Re],Le)}},xp=class extends Wd{constructor(Re,Le){super(["echo",...Re],Le)}},bp=class extends Wd{constructor([Re,Le,Oe],Ue){super(["eval",Re,Le.length,...Le,...Oe??[]],Ue)}},Tp=class extends Wd{constructor([Re,Le,Oe],Ue){super(["evalsha",Re,Le.length,...Le,...Oe??[]],Ue)}},Ap=class extends Wd{constructor(Re,Le){super(["exists",...Re],Le)}},Mp=class extends Wd{constructor(Re,Le){super(["expire",...Re.filter(Boolean)],Le)}},Rp=class extends Wd{constructor(Re,Le){super(["expireat",...Re],Le)}},Lp=class extends Wd{constructor(Re,Le){const Oe=["flushall"];Re&&Re.length>0&&Re[0].async&&Oe.push("async"),super(Oe,Le)}},Op=class extends Wd{constructor([Re],Le){const Oe=["flushdb"];Re?.async&&Oe.push("async"),super(Oe,Le)}},Dp=class extends Wd{constructor([Re,Le,...Oe],Ue){const qe=["geoadd",Re];"nx"in Le&&Le.nx?qe.push("nx"):"xx"in Le&&Le.xx&&qe.push("xx"),"ch"in Le&&Le.ch&&qe.push("ch"),"latitude"in Le&&Le.latitude&&qe.push(Le.longitude,Le.latitude,Le.member),qe.push(...Oe.flatMap((({latitude:Re,longitude:Le,member:Oe})=>[Le,Re,Oe]))),super(qe,Ue)}},Fp=class extends Wd{constructor([Re,Le,Oe,Ue="M"],qe){super(["GEODIST",Re,Le,Oe,Ue],qe)}},Np=class extends Wd{constructor(Re,Le){const[Oe]=Re;super(["GEOHASH",Oe,...Array.isArray(Re[1])?Re[1]:Re.slice(1)],Le)}},jp=class extends Wd{constructor(Re,Le){const[Oe]=Re;super(["GEOPOS",Oe,...Array.isArray(Re[1])?Re[1]:Re.slice(1)],{deserialize:Re=>function(Re){const Le=[];for(const Oe of Re)Oe?.[0]&&Oe?.[1]&&Le.push({lng:Number.parseFloat(Oe[0]),lat:Number.parseFloat(Oe[1])});return Le}(Re),...Le})}};var Up=class extends Wd{constructor([Re,Le,Oe,Ue,qe],Ct){const Ot=["GEOSEARCH",Re];"FROMMEMBER"!==Le.type&&"frommember"!==Le.type||Ot.push(Le.type,Le.member),"FROMLONLAT"!==Le.type&&"fromlonlat"!==Le.type||Ot.push(Le.type,Le.coordinate.lon,Le.coordinate.lat),"BYRADIUS"!==Oe.type&&"byradius"!==Oe.type||Ot.push(Oe.type,Oe.radius,Oe.radiusType),"BYBOX"!==Oe.type&&"bybox"!==Oe.type||Ot.push(Oe.type,Oe.rect.width,Oe.rect.height,Oe.rectType),Ot.push(Ue),qe?.count&&Ot.push("COUNT",qe.count.limit,...qe.count.any?["ANY"]:[]);super([...Ot,...qe?.withCoord?["WITHCOORD"]:[],...qe?.withDist?["WITHDIST"]:[],...qe?.withHash?["WITHHASH"]:[]],{deserialize:Re=>qe?.withCoord||qe?.withDist||qe?.withHash?Re.map((Re=>{let Le=1;const Oe={};try{Oe.member=JSON.parse(Re[0])}catch{Oe.member=Re[0]}return qe.withDist&&(Oe.dist=Number.parseFloat(Re[Le++])),qe.withHash&&(Oe.hash=Re[Le++].toString()),qe.withCoord&&(Oe.coord={long:Number.parseFloat(Re[Le][0]),lat:Number.parseFloat(Re[Le][1])}),Oe})):Re.map((Re=>{try{return{member:JSON.parse(Re)}}catch{return{member:Re}}})),...Ct})}},Vp=class extends Wd{constructor([Re,Le,Oe,Ue,qe,Ct],Ot){const Jt=["GEOSEARCHSTORE",Re,Le];"FROMMEMBER"!==Oe.type&&"frommember"!==Oe.type||Jt.push(Oe.type,Oe.member),"FROMLONLAT"!==Oe.type&&"fromlonlat"!==Oe.type||Jt.push(Oe.type,Oe.coordinate.lon,Oe.coordinate.lat),"BYRADIUS"!==Ue.type&&"byradius"!==Ue.type||Jt.push(Ue.type,Ue.radius,Ue.radiusType),"BYBOX"!==Ue.type&&"bybox"!==Ue.type||Jt.push(Ue.type,Ue.rect.width,Ue.rect.height,Ue.rectType),Jt.push(qe),Ct?.count&&Jt.push("COUNT",Ct.count.limit,...Ct.count.any?["ANY"]:[]),super([...Jt,...Ct?.storeDist?["STOREDIST"]:[]],Ot)}},$p=class extends Wd{constructor(Re,Le){super(["get",...Re],Le)}},Gp=class extends Wd{constructor(Re,Le){super(["getbit",...Re],Le)}},qp=class extends Wd{constructor(Re,Le){super(["getdel",...Re],Le)}},Wp=class extends Wd{constructor(Re,Le){super(["getrange",...Re],Le)}},Kp=class extends Wd{constructor(Re,Le){super(["getset",...Re],Le)}},ef=class extends Wd{constructor(Re,Le){super(["hdel",...Re],Le)}},tf=class extends Wd{constructor(Re,Le){super(["hexists",...Re],Le)}},rf=class extends Wd{constructor(Re,Le){super(["hget",...Re],Le)}};var nf=class extends Wd{constructor(Re,Le){super(["hgetall",...Re],{deserialize:Re=>function(Re){if(0===Re.length)return null;const Le={};for(;Re.length>=2;){const Oe=Re.shift(),Ue=Re.shift();try{const Re=!Number.isNaN(Number(Ue))&&!Number.isSafeInteger(Number(Ue));Le[Oe]=Re?Ue:JSON.parse(Ue)}catch{Le[Oe]=Ue}}return Le}(Re),...Le})}},of=class extends Wd{constructor(Re,Le){super(["hincrby",...Re],Le)}},lf=class extends Wd{constructor(Re,Le){super(["hincrbyfloat",...Re],Le)}},pf=class extends Wd{constructor([Re],Le){super(["hkeys",Re],Le)}},ff=class extends Wd{constructor(Re,Le){super(["hlen",...Re],Le)}};var gf=class extends Wd{constructor([Re,...Le],Oe){super(["hmget",Re,...Le],{deserialize:Re=>function(Re,Le){if(Le.every((Re=>null===Re)))return null;const Oe={};for(const[Ue,qe]of Re.entries())try{Oe[qe]=JSON.parse(Le[Ue])}catch{Oe[qe]=Le[Ue]}return Oe}(Le,Re),...Oe})}},xf=class extends Wd{constructor([Re,Le],Oe){super(["hmset",Re,...Object.entries(Le).flatMap((([Re,Le])=>[Re,Le]))],Oe)}},Ff=class extends Wd{constructor([Re,Le,Oe],Ue){const qe=["hscan",Re,Le];Oe?.match&&qe.push("match",Oe.match),"number"==typeof Oe?.count&&qe.push("count",Oe.count),super(qe,{deserialize:deserializeScanResponse,...Ue})}},jf=class extends Wd{constructor([Re,Le],Oe){super(["hset",Re,...Object.entries(Le).flatMap((([Re,Le])=>[Re,Le]))],Oe)}},$f=class extends Wd{constructor(Re,Le){super(["hsetnx",...Re],Le)}},Gf=class extends Wd{constructor(Re,Le){super(["hstrlen",...Re],Le)}},Yf=class extends Wd{constructor(Re,Le){super(["hvals",...Re],Le)}},em=class extends Wd{constructor(Re,Le){super(["incr",...Re],Le)}},rm=class extends Wd{constructor(Re,Le){super(["incrby",...Re],Le)}},nm=class extends Wd{constructor(Re,Le){super(["incrbyfloat",...Re],Le)}},im=class extends Wd{constructor(Re,Le){super(["JSON.ARRAPPEND",...Re],Le)}},sm=class extends Wd{constructor(Re,Le){super(["JSON.ARRINDEX",...Re],Le)}},dm=class extends Wd{constructor(Re,Le){super(["JSON.ARRINSERT",...Re],Le)}},gm=class extends Wd{constructor(Re,Le){super(["JSON.ARRLEN",Re[0],Re[1]??"$"],Le)}},ym=class extends Wd{constructor(Re,Le){super(["JSON.ARRPOP",...Re],Le)}},vm=class extends Wd{constructor(Re,Le){const Oe=Re[1]??"$",Ue=Re[2]??0,qe=Re[3]??0;super(["JSON.ARRTRIM",Re[0],Oe,Ue,qe],Le)}},xm=class extends Wd{constructor(Re,Le){super(["JSON.CLEAR",...Re],Le)}},bm=class extends Wd{constructor(Re,Le){super(["JSON.DEL",...Re],Le)}},Cm=class extends Wd{constructor(Re,Le){super(["JSON.FORGET",...Re],Le)}},Pm=class extends Wd{constructor(Re,Le){const Oe=["JSON.GET"];"string"==typeof Re[1]?Oe.push(...Re):(Oe.push(Re[0]),Re[1]&&(Re[1].indent&&Oe.push("INDENT",Re[1].indent),Re[1].newline&&Oe.push("NEWLINE",Re[1].newline),Re[1].space&&Oe.push("SPACE",Re[1].space)),Oe.push(...Re.slice(2))),super(Oe,Le)}},Rm=class extends Wd{constructor(Re,Le){super(["JSON.MGET",...Re[0],Re[1]],Le)}},Lm=class extends Wd{constructor(Re,Le){const Oe=["JSON.MSET"];for(const Le of Re)Oe.push(Le.key,Le.path,Le.value);super(Oe,Le)}},Om=class extends Wd{constructor(Re,Le){super(["JSON.NUMINCRBY",...Re],Le)}},Dm=class extends Wd{constructor(Re,Le){super(["JSON.NUMMULTBY",...Re],Le)}},Fm=class extends Wd{constructor(Re,Le){super(["JSON.OBJKEYS",...Re],Le)}},jm=class extends Wd{constructor(Re,Le){super(["JSON.OBJLEN",...Re],Le)}},Um=class extends Wd{constructor(Re,Le){super(["JSON.RESP",...Re],Le)}},Hm=class extends Wd{constructor(Re,Le){const Oe=["JSON.SET",Re[0],Re[1],Re[2]];Re[3]&&(Re[3].nx?Oe.push("NX"):Re[3].xx&&Oe.push("XX")),super(Oe,Le)}},Wm=class extends Wd{constructor(Re,Le){super(["JSON.STRAPPEND",...Re],Le)}},Zm=class extends Wd{constructor(Re,Le){super(["JSON.STRLEN",...Re],Le)}},Ym=class extends Wd{constructor(Re,Le){super(["JSON.TOGGLE",...Re],Le)}},eg=class extends Wd{constructor(Re,Le){super(["JSON.TYPE",...Re],Le)}},tg=class extends Wd{constructor(Re,Le){super(["keys",...Re],Le)}},rg=class extends Wd{constructor(Re,Le){super(["lindex",...Re],Le)}},ng=class extends Wd{constructor(Re,Le){super(["linsert",...Re],Le)}},og=class extends Wd{constructor(Re,Le){super(["llen",...Re],Le)}},sg=class extends Wd{constructor(Re,Le){super(["lmove",...Re],Le)}},ag=class extends Wd{constructor(Re,Le){const[Oe,Ue,qe,Ct]=Re;super(["LMPOP",Oe,...Ue,qe,...Ct?["COUNT",Ct]:[]],Le)}},lg=class extends Wd{constructor(Re,Le){super(["lpop",...Re],Le)}},dg=class extends Wd{constructor(Re,Le){const Oe=["lpos",Re[0],Re[1]];"number"==typeof Re[2]?.rank&&Oe.push("rank",Re[2].rank),"number"==typeof Re[2]?.count&&Oe.push("count",Re[2].count),"number"==typeof Re[2]?.maxLen&&Oe.push("maxLen",Re[2].maxLen),super(Oe,Le)}},pg=class extends Wd{constructor(Re,Le){super(["lpush",...Re],Le)}},mg=class extends Wd{constructor(Re,Le){super(["lpushx",...Re],Le)}},yg=class extends Wd{constructor(Re,Le){super(["lrange",...Re],Le)}},vg=class extends Wd{constructor(Re,Le){super(["lrem",...Re],Le)}},xg=class extends Wd{constructor(Re,Le){super(["lset",...Re],Le)}},bg=class extends Wd{constructor(Re,Le){super(["ltrim",...Re],Le)}},wg=class extends Wd{constructor(Re,Le){super(["mget",...Array.isArray(Re[0])?Re[0]:Re],Le)}},Tg=class extends Wd{constructor([Re],Le){super(["mset",...Object.entries(Re).flatMap((([Re,Le])=>[Re,Le]))],Le)}},Sg=class extends Wd{constructor([Re],Le){super(["msetnx",...Object.entries(Re).flat()],Le)}},Eg=class extends Wd{constructor(Re,Le){super(["persist",...Re],Le)}},Cg=class extends Wd{constructor(Re,Le){super(["pexpire",...Re],Le)}},Ig=class extends Wd{constructor(Re,Le){super(["pexpireat",...Re],Le)}},Rg=class extends Wd{constructor(Re,Le){super(["pfadd",...Re],Le)}},Og=class extends Wd{constructor(Re,Le){super(["pfcount",...Re],Le)}},zg=class extends Wd{constructor(Re,Le){super(["pfmerge",...Re],Le)}},Bg=class extends Wd{constructor(Re,Le){const Oe=["ping"];void 0!==Re?.[0]&&Oe.push(Re[0]),super(Oe,Le)}},Fg=class extends Wd{constructor(Re,Le){super(["psetex",...Re],Le)}},Ng=class extends Wd{constructor(Re,Le){super(["pttl",...Re],Le)}},Ug=class extends Wd{constructor(Re,Le){super(["publish",...Re],Le)}},Vg=class extends Wd{constructor(Re){super(["randomkey"],Re)}},$g=class extends Wd{constructor(Re,Le){super(["rename",...Re],Le)}},Xg=class extends Wd{constructor(Re,Le){super(["renamenx",...Re],Le)}},Yg=class extends Wd{constructor(Re,Le){super(["rpop",...Re],Le)}},e_=class extends Wd{constructor(Re,Le){super(["rpush",...Re],Le)}},t_=class extends Wd{constructor(Re,Le){super(["rpushx",...Re],Le)}},r_=class extends Wd{constructor(Re,Le){super(["sadd",...Re],Le)}},n_=class extends Wd{constructor([Re,Le],Oe){const Ue=["scan",Re];Le?.match&&Ue.push("match",Le.match),"number"==typeof Le?.count&&Ue.push("count",Le.count),Le?.type&&Le.type.length>0&&Ue.push("type",Le.type),super(Ue,{deserialize:deserializeScanResponse,...Oe})}},i_=class extends Wd{constructor(Re,Le){super(["scard",...Re],Le)}},o_=class extends Wd{constructor(Re,Le){super(["script","exists",...Re],{deserialize:Re=>Re,...Le})}},s_=class extends Wd{constructor([Re],Le){const Oe=["script","flush"];Re?.sync?Oe.push("sync"):Re?.async&&Oe.push("async"),super(Oe,Le)}},a_=class extends Wd{constructor(Re,Le){super(["script","load",...Re],Le)}},l_=class extends Wd{constructor(Re,Le){super(["sdiff",...Re],Le)}},c_=class extends Wd{constructor(Re,Le){super(["sdiffstore",...Re],Le)}},u_=class extends Wd{constructor([Re,Le,Oe],Ue){const qe=["set",Re,Le];Oe&&("nx"in Oe&&Oe.nx?qe.push("nx"):"xx"in Oe&&Oe.xx&&qe.push("xx"),"get"in Oe&&Oe.get&&qe.push("get"),"ex"in Oe&&"number"==typeof Oe.ex?qe.push("ex",Oe.ex):"px"in Oe&&"number"==typeof Oe.px?qe.push("px",Oe.px):"exat"in Oe&&"number"==typeof Oe.exat?qe.push("exat",Oe.exat):"pxat"in Oe&&"number"==typeof Oe.pxat?qe.push("pxat",Oe.pxat):"keepTtl"in Oe&&Oe.keepTtl&&qe.push("keepTtl")),super(qe,Ue)}},h_=class extends Wd{constructor(Re,Le){super(["setbit",...Re],Le)}},d_=class extends Wd{constructor(Re,Le){super(["setex",...Re],Le)}},p_=class extends Wd{constructor(Re,Le){super(["setnx",...Re],Le)}},f_=class extends Wd{constructor(Re,Le){super(["setrange",...Re],Le)}},m_=class extends Wd{constructor(Re,Le){super(["sinter",...Re],Le)}},g_=class extends Wd{constructor(Re,Le){super(["sinterstore",...Re],Le)}},__=class extends Wd{constructor(Re,Le){super(["sismember",...Re],Le)}},y_=class extends Wd{constructor(Re,Le){super(["smembers",...Re],Le)}},v_=class extends Wd{constructor(Re,Le){super(["smismember",Re[0],...Re[1]],Le)}},x_=class extends Wd{constructor(Re,Le){super(["smove",...Re],Le)}},b_=class extends Wd{constructor([Re,Le],Oe){const Ue=["spop",Re];"number"==typeof Le&&Ue.push(Le),super(Ue,Oe)}},w_=class extends Wd{constructor([Re,Le],Oe){const Ue=["srandmember",Re];"number"==typeof Le&&Ue.push(Le),super(Ue,Oe)}},T_=class extends Wd{constructor(Re,Le){super(["srem",...Re],Le)}},S_=class extends Wd{constructor([Re,Le,Oe],Ue){const qe=["sscan",Re,Le];Oe?.match&&qe.push("match",Oe.match),"number"==typeof Oe?.count&&qe.push("count",Oe.count),super(qe,{deserialize:deserializeScanResponse,...Ue})}},E_=class extends Wd{constructor(Re,Le){super(["strlen",...Re],Le)}},C_=class extends Wd{constructor(Re,Le){super(["sunion",...Re],Le)}},A_=class extends Wd{constructor(Re,Le){super(["sunionstore",...Re],Le)}},I_=class extends Wd{constructor(Re){super(["time"],Re)}},k_=class extends Wd{constructor(Re,Le){super(["touch",...Re],Le)}},M_=class extends Wd{constructor(Re,Le){super(["ttl",...Re],Le)}},P_=class extends Wd{constructor(Re,Le){super(["type",...Re],Le)}},R_=class extends Wd{constructor(Re,Le){super(["unlink",...Re],Le)}},L_=class extends Wd{constructor([Re,Le,Oe],Ue){super(["XACK",Re,Le,...Array.isArray(Oe)?[...Oe]:[Oe]],Ue)}},O_=class extends Wd{constructor([Re,Le,Oe,Ue],qe){const Ct=["XADD",Re];Ue&&(Ue.nomkStream&&Ct.push("NOMKSTREAM"),Ue.trim&&(Ct.push(Ue.trim.type,Ue.trim.comparison,Ue.trim.threshold),void 0!==Ue.trim.limit&&Ct.push("LIMIT",Ue.trim.limit))),Ct.push(Le);for(const[Re,Le]of Object.entries(Oe))Ct.push(Re,Le);super(Ct,qe)}},z_=class extends Wd{constructor([Re,Le,Oe,Ue,qe,Ct],Ot){const Jt=[];Ct?.count&&Jt.push("COUNT",Ct.count),Ct?.justId&&Jt.push("JUSTID"),super(["XAUTOCLAIM",Re,Le,Oe,Ue,qe,...Jt],Ot)}},D_=class extends Wd{constructor([Re,Le,Oe,Ue,qe,Ct],Ot){const Jt=Array.isArray(qe)?[...qe]:[qe],Hr=[];Ct?.idleMS&&Hr.push("IDLE",Ct.idleMS),Ct?.idleMS&&Hr.push("TIME",Ct.timeMS),Ct?.retryCount&&Hr.push("RETRYCOUNT",Ct.retryCount),Ct?.force&&Hr.push("FORCE"),Ct?.justId&&Hr.push("JUSTID"),Ct?.lastId&&Hr.push("LASTID",Ct.lastId),super(["XCLAIM",Re,Le,Oe,Ue,...Jt,...Hr],Ot)}},B_=class extends Wd{constructor([Re,Le],Oe){super(["XDEL",Re,...Array.isArray(Le)?[...Le]:[Le]],Oe)}},F_=class extends Wd{constructor([Re,Le],Oe){const Ue=["XGROUP"];switch(Le.type){case"CREATE":Ue.push("CREATE",Re,Le.group,Le.id),Le.options&&(Le.options.MKSTREAM&&Ue.push("MKSTREAM"),void 0!==Le.options.ENTRIESREAD&&Ue.push("ENTRIESREAD",Le.options.ENTRIESREAD.toString()));break;case"CREATECONSUMER":Ue.push("CREATECONSUMER",Re,Le.group,Le.consumer);break;case"DELCONSUMER":Ue.push("DELCONSUMER",Re,Le.group,Le.consumer);break;case"DESTROY":Ue.push("DESTROY",Re,Le.group);break;case"SETID":Ue.push("SETID",Re,Le.group,Le.id),void 0!==Le.options?.ENTRIESREAD&&Ue.push("ENTRIESREAD",Le.options.ENTRIESREAD.toString());break;default:throw new Error("Invalid XGROUP")}super(Ue,Oe)}},N_=class extends Wd{constructor([Re,Le],Oe){const Ue=[];"CONSUMERS"===Le.type?Ue.push("CONSUMERS",Re,Le.group):Ue.push("GROUPS",Re),super(["XINFO",...Ue],Oe)}},j_=class extends Wd{constructor(Re,Le){super(["XLEN",...Re],Le)}},U_=class extends Wd{constructor([Re,Le,Oe,Ue,qe,Ct],Ot){const Jt=void 0===Ct?.consumer?[]:Array.isArray(Ct.consumer)?[...Ct.consumer]:[Ct.consumer];super(["XPENDING",Re,Le,...Ct?.idleTime?["IDLE",Ct.idleTime]:[],Oe,Ue,qe,...Jt],Ot)}};var V_=class extends Wd{constructor([Re,Le,Oe,Ue],qe){const Ct=["XRANGE",Re,Le,Oe];"number"==typeof Ue&&Ct.push("COUNT",Ue),super(Ct,{deserialize:Re=>function(Re){const Le={};for(const Oe of Re)for(;Oe.length>=2;){const Re=Oe.shift(),Ue=Oe.shift();Re in Le||(Le[Re]={});for(;Ue.length>=2;){const Oe=Ue.shift(),qe=Ue.shift();try{Le[Re][Oe]=JSON.parse(qe)}catch{Le[Re][Oe]=qe}}}return Le}(Re),...qe})}},$_=class extends Wd{constructor([Re,Le,Oe],Ue){if(Array.isArray(Re)&&Array.isArray(Le)&&Re.length!==Le.length)throw new Error("ERR Unbalanced XREAD list of streams: for each stream key an ID or '$' must be specified");const qe=[];"number"==typeof Oe?.count&&qe.push("COUNT",Oe.count),"number"==typeof Oe?.blockMS&&qe.push("BLOCK",Oe.blockMS),qe.push("STREAMS",...Array.isArray(Re)?[...Re]:[Re],...Array.isArray(Le)?[...Le]:[Le]),super(["XREAD",...qe],Ue)}},G_=class extends Wd{constructor([Re,Le,Oe,Ue,qe],Ct){if(Array.isArray(Oe)&&Array.isArray(Ue)&&Oe.length!==Ue.length)throw new Error("ERR Unbalanced XREADGROUP list of streams: for each stream key an ID or '$' must be specified");const Ot=[];"number"==typeof qe?.count&&Ot.push("COUNT",qe.count),"number"==typeof qe?.blockMS&&Ot.push("BLOCK",qe.blockMS),"boolean"==typeof qe?.NOACK&&qe.NOACK&&Ot.push("NOACK"),Ot.push("STREAMS",...Array.isArray(Oe)?[...Oe]:[Oe],...Array.isArray(Ue)?[...Ue]:[Ue]),super(["XREADGROUP","GROUP",Re,Le,...Ot],Ct)}},q_=class extends Wd{constructor([Re,Le,Oe,Ue],qe){const Ct=["XREVRANGE",Re,Le,Oe];"number"==typeof Ue&&Ct.push("COUNT",Ue),super(Ct,{deserialize:Re=>function(Re){const Le={};for(const Oe of Re)for(;Oe.length>=2;){const Re=Oe.shift(),Ue=Oe.shift();Re in Le||(Le[Re]={});for(;Ue.length>=2;){const Oe=Ue.shift(),qe=Ue.shift();try{Le[Re][Oe]=JSON.parse(qe)}catch{Le[Re][Oe]=qe}}}return Le}(Re),...qe})}};var H_=class extends Wd{constructor([Re,Le],Oe){const{limit:Ue,strategy:qe,threshold:Ct,exactness:Ot="~"}=Le;super(["XTRIM",Re,qe,Ot,Ct,...Ue?["LIMIT",Ue]:[]],Oe)}},W_=class extends Wd{constructor([Re,Le,...Oe],Ue){const qe=["zadd",Re];"nx"in Le&&Le.nx?qe.push("nx"):"xx"in Le&&Le.xx&&qe.push("xx"),"ch"in Le&&Le.ch&&qe.push("ch"),"incr"in Le&&Le.incr&&qe.push("incr"),"lt"in Le&&Le.lt?qe.push("lt"):"gt"in Le&&Le.gt&&qe.push("gt"),"score"in Le&&"member"in Le&&qe.push(Le.score,Le.member),qe.push(...Oe.flatMap((({score:Re,member:Le})=>[Re,Le]))),super(qe,Ue)}},Z_=class extends Wd{constructor(Re,Le){super(["zcard",...Re],Le)}},X_=class extends Wd{constructor(Re,Le){super(["zcount",...Re],Le)}},Y_=class extends Wd{constructor(Re,Le){super(["zincrby",...Re],Le)}},K_=class extends Wd{constructor([Re,Le,Oe,Ue],qe){const Ct=["zinterstore",Re,Le];Array.isArray(Oe)?Ct.push(...Oe):Ct.push(Oe),Ue&&("weights"in Ue&&Ue.weights?Ct.push("weights",...Ue.weights):"weight"in Ue&&"number"==typeof Ue.weight&&Ct.push("weights",Ue.weight),"aggregate"in Ue&&Ct.push("aggregate",Ue.aggregate)),super(Ct,qe)}},J_=class extends Wd{constructor(Re,Le){super(["zlexcount",...Re],Le)}},Q_=class extends Wd{constructor([Re,Le],Oe){const Ue=["zpopmax",Re];"number"==typeof Le&&Ue.push(Le),super(Ue,Oe)}},iy=class extends Wd{constructor([Re,Le],Oe){const Ue=["zpopmin",Re];"number"==typeof Le&&Ue.push(Le),super(Ue,Oe)}},sy=class extends Wd{constructor([Re,Le,Oe,Ue],qe){const Ct=["zrange",Re,Le,Oe];Ue?.byScore&&Ct.push("byscore"),Ue?.byLex&&Ct.push("bylex"),Ue?.rev&&Ct.push("rev"),void 0!==Ue?.count&&void 0!==Ue.offset&&Ct.push("limit",Ue.offset,Ue.count),Ue?.withScores&&Ct.push("withscores"),super(Ct,qe)}},ly=class extends Wd{constructor(Re,Le){super(["zrank",...Re],Le)}},my=class extends Wd{constructor(Re,Le){super(["zrem",...Re],Le)}},zy=class extends Wd{constructor(Re,Le){super(["zremrangebylex",...Re],Le)}},$y=class extends Wd{constructor(Re,Le){super(["zremrangebyrank",...Re],Le)}},Gy=class extends Wd{constructor(Re,Le){super(["zremrangebyscore",...Re],Le)}},Wy=class extends Wd{constructor(Re,Le){super(["zrevrank",...Re],Le)}},Zy=class extends Wd{constructor([Re,Le,Oe],Ue){const qe=["zscan",Re,Le];Oe?.match&&qe.push("match",Oe.match),"number"==typeof Oe?.count&&qe.push("count",Oe.count),super(qe,{deserialize:deserializeScanResponse,...Ue})}},Xy=class extends Wd{constructor(Re,Le){super(["zscore",...Re],Le)}},Yy=class extends Wd{constructor([Re,Le,Oe],Ue){const qe=["zunion",Re];Array.isArray(Le)?qe.push(...Le):qe.push(Le),Oe&&("weights"in Oe&&Oe.weights?qe.push("weights",...Oe.weights):"weight"in Oe&&"number"==typeof Oe.weight&&qe.push("weights",Oe.weight),"aggregate"in Oe&&qe.push("aggregate",Oe.aggregate),Oe.withScores&&qe.push("withscores")),super(qe,Ue)}},Ky=class extends Wd{constructor([Re,Le,Oe,Ue],qe){const Ct=["zunionstore",Re,Le];Array.isArray(Oe)?Ct.push(...Oe):Ct.push(Oe),Ue&&("weights"in Ue&&Ue.weights?Ct.push("weights",...Ue.weights):"weight"in Ue&&"number"==typeof Ue.weight&&Ct.push("weights",Ue.weight),"aggregate"in Ue&&Ct.push("aggregate",Ue.aggregate)),super(Ct,qe)}},Jy=class extends Wd{constructor(Re,Le){super(["zdiffstore",...Re],Le)}},Qy=class extends Wd{constructor(Re,Le){const[Oe,Ue]=Re;super(["zmscore",Oe,...Ue],Le)}},ev=class{client;commands;commandOptions;multiExec;constructor(Re){if(this.client=Re.client,this.commands=[],this.commandOptions=Re.commandOptions,this.multiExec=Re.multiExec??!1,this.commandOptions?.latencyLogging){const Re=this.exec.bind(this);this.exec=async Le=>{const Oe=performance.now(),Ue=await(Le?Re(Le):Re()),qe=(performance.now()-Oe).toFixed(2);return console.log(`Latency for [38;2;19;185;39m${this.multiExec?["MULTI-EXEC"]:["PIPELINE"].toString().toUpperCase()}[0m: [38;2;0;255;255m${qe} ms[0m`),Ue}}}exec=async Re=>{if(0===this.commands.length)throw new Error("Pipeline is empty");const Le=this.multiExec?["multi-exec"]:["pipeline"],Oe=await this.client.request({path:Le,body:Object.values(this.commands).map((Re=>Re.command))});return Re?.keepErrors?Oe.map((({error:Re,result:Le},Oe)=>({error:Re,result:this.commands[Oe].deserialize(Le)}))):Oe.map((({error:Re,result:Le},Oe)=>{if(Re)throw new Bd(`Command ${Oe+1} [ ${this.commands[Oe].command[0]} ] failed: ${Re}`);return this.commands[Oe].deserialize(Le)}))};length(){return this.commands.length}chain(Re){return this.commands.push(Re),this}append=(...Re)=>this.chain(new sp(Re,this.commandOptions));bitcount=(...Re)=>this.chain(new ap(Re,this.commandOptions));bitfield=(...Re)=>new cp(Re,this.client,this.commandOptions,this.chain.bind(this));bitop=(Re,Le,Oe,...Ue)=>this.chain(new hp([Re,Le,Oe,...Ue],this.commandOptions));bitpos=(...Re)=>this.chain(new dp(Re,this.commandOptions));copy=(...Re)=>this.chain(new pp(Re,this.commandOptions));zdiffstore=(...Re)=>this.chain(new Jy(Re,this.commandOptions));dbsize=()=>this.chain(new fp(this.commandOptions));decr=(...Re)=>this.chain(new mp(Re,this.commandOptions));decrby=(...Re)=>this.chain(new yp(Re,this.commandOptions));del=(...Re)=>this.chain(new vp(Re,this.commandOptions));echo=(...Re)=>this.chain(new xp(Re,this.commandOptions));eval=(...Re)=>this.chain(new bp(Re,this.commandOptions));evalsha=(...Re)=>this.chain(new Tp(Re,this.commandOptions));exists=(...Re)=>this.chain(new Ap(Re,this.commandOptions));expire=(...Re)=>this.chain(new Mp(Re,this.commandOptions));expireat=(...Re)=>this.chain(new Rp(Re,this.commandOptions));flushall=Re=>this.chain(new Lp(Re,this.commandOptions));flushdb=(...Re)=>this.chain(new Op(Re,this.commandOptions));geoadd=(...Re)=>this.chain(new Dp(Re,this.commandOptions));geodist=(...Re)=>this.chain(new Fp(Re,this.commandOptions));geopos=(...Re)=>this.chain(new jp(Re,this.commandOptions));geohash=(...Re)=>this.chain(new Np(Re,this.commandOptions));geosearch=(...Re)=>this.chain(new Up(Re,this.commandOptions));geosearchstore=(...Re)=>this.chain(new Vp(Re,this.commandOptions));get=(...Re)=>this.chain(new $p(Re,this.commandOptions));getbit=(...Re)=>this.chain(new Gp(Re,this.commandOptions));getdel=(...Re)=>this.chain(new qp(Re,this.commandOptions));getrange=(...Re)=>this.chain(new Wp(Re,this.commandOptions));getset=(Re,Le)=>this.chain(new Kp([Re,Le],this.commandOptions));hdel=(...Re)=>this.chain(new ef(Re,this.commandOptions));hexists=(...Re)=>this.chain(new tf(Re,this.commandOptions));hget=(...Re)=>this.chain(new rf(Re,this.commandOptions));hgetall=(...Re)=>this.chain(new nf(Re,this.commandOptions));hincrby=(...Re)=>this.chain(new of(Re,this.commandOptions));hincrbyfloat=(...Re)=>this.chain(new lf(Re,this.commandOptions));hkeys=(...Re)=>this.chain(new pf(Re,this.commandOptions));hlen=(...Re)=>this.chain(new ff(Re,this.commandOptions));hmget=(...Re)=>this.chain(new gf(Re,this.commandOptions));hmset=(Re,Le)=>this.chain(new xf([Re,Le],this.commandOptions));hrandfield=(Re,Le,Oe)=>this.chain(new Kd([Re,Le,Oe],this.commandOptions));hscan=(...Re)=>this.chain(new Ff(Re,this.commandOptions));hset=(Re,Le)=>this.chain(new jf([Re,Le],this.commandOptions));hsetnx=(Re,Le,Oe)=>this.chain(new $f([Re,Le,Oe],this.commandOptions));hstrlen=(...Re)=>this.chain(new Gf(Re,this.commandOptions));hvals=(...Re)=>this.chain(new Yf(Re,this.commandOptions));incr=(...Re)=>this.chain(new em(Re,this.commandOptions));incrby=(...Re)=>this.chain(new rm(Re,this.commandOptions));incrbyfloat=(...Re)=>this.chain(new nm(Re,this.commandOptions));keys=(...Re)=>this.chain(new tg(Re,this.commandOptions));lindex=(...Re)=>this.chain(new rg(Re,this.commandOptions));linsert=(Re,Le,Oe,Ue)=>this.chain(new ng([Re,Le,Oe,Ue],this.commandOptions));llen=(...Re)=>this.chain(new og(Re,this.commandOptions));lmove=(...Re)=>this.chain(new sg(Re,this.commandOptions));lpop=(...Re)=>this.chain(new lg(Re,this.commandOptions));lmpop=(...Re)=>this.chain(new ag(Re,this.commandOptions));lpos=(...Re)=>this.chain(new dg(Re,this.commandOptions));lpush=(Re,...Le)=>this.chain(new pg([Re,...Le],this.commandOptions));lpushx=(Re,...Le)=>this.chain(new mg([Re,...Le],this.commandOptions));lrange=(...Re)=>this.chain(new yg(Re,this.commandOptions));lrem=(Re,Le,Oe)=>this.chain(new vg([Re,Le,Oe],this.commandOptions));lset=(Re,Le,Oe)=>this.chain(new xg([Re,Le,Oe],this.commandOptions));ltrim=(...Re)=>this.chain(new bg(Re,this.commandOptions));mget=(...Re)=>this.chain(new wg(Re,this.commandOptions));mset=Re=>this.chain(new Tg([Re],this.commandOptions));msetnx=Re=>this.chain(new Sg([Re],this.commandOptions));persist=(...Re)=>this.chain(new Eg(Re,this.commandOptions));pexpire=(...Re)=>this.chain(new Cg(Re,this.commandOptions));pexpireat=(...Re)=>this.chain(new Ig(Re,this.commandOptions));pfadd=(...Re)=>this.chain(new Rg(Re,this.commandOptions));pfcount=(...Re)=>this.chain(new Og(Re,this.commandOptions));pfmerge=(...Re)=>this.chain(new zg(Re,this.commandOptions));ping=Re=>this.chain(new Bg(Re,this.commandOptions));psetex=(Re,Le,Oe)=>this.chain(new Fg([Re,Le,Oe],this.commandOptions));pttl=(...Re)=>this.chain(new Ng(Re,this.commandOptions));publish=(...Re)=>this.chain(new Ug(Re,this.commandOptions));randomkey=()=>this.chain(new Vg(this.commandOptions));rename=(...Re)=>this.chain(new $g(Re,this.commandOptions));renamenx=(...Re)=>this.chain(new Xg(Re,this.commandOptions));rpop=(...Re)=>this.chain(new Yg(Re,this.commandOptions));rpush=(Re,...Le)=>this.chain(new e_([Re,...Le],this.commandOptions));rpushx=(Re,...Le)=>this.chain(new t_([Re,...Le],this.commandOptions));sadd=(Re,Le,...Oe)=>this.chain(new r_([Re,Le,...Oe],this.commandOptions));scan=(...Re)=>this.chain(new n_(Re,this.commandOptions));scard=(...Re)=>this.chain(new i_(Re,this.commandOptions));scriptExists=(...Re)=>this.chain(new o_(Re,this.commandOptions));scriptFlush=(...Re)=>this.chain(new s_(Re,this.commandOptions));scriptLoad=(...Re)=>this.chain(new a_(Re,this.commandOptions));sdiff=(...Re)=>this.chain(new l_(Re,this.commandOptions));sdiffstore=(...Re)=>this.chain(new c_(Re,this.commandOptions));set=(Re,Le,Oe)=>this.chain(new u_([Re,Le,Oe],this.commandOptions));setbit=(...Re)=>this.chain(new h_(Re,this.commandOptions));setex=(Re,Le,Oe)=>this.chain(new d_([Re,Le,Oe],this.commandOptions));setnx=(Re,Le)=>this.chain(new p_([Re,Le],this.commandOptions));setrange=(...Re)=>this.chain(new f_(Re,this.commandOptions));sinter=(...Re)=>this.chain(new m_(Re,this.commandOptions));sinterstore=(...Re)=>this.chain(new g_(Re,this.commandOptions));sismember=(Re,Le)=>this.chain(new __([Re,Le],this.commandOptions));smembers=(...Re)=>this.chain(new y_(Re,this.commandOptions));smismember=(Re,Le)=>this.chain(new v_([Re,Le],this.commandOptions));smove=(Re,Le,Oe)=>this.chain(new x_([Re,Le,Oe],this.commandOptions));spop=(...Re)=>this.chain(new b_(Re,this.commandOptions));srandmember=(...Re)=>this.chain(new w_(Re,this.commandOptions));srem=(Re,...Le)=>this.chain(new T_([Re,...Le],this.commandOptions));sscan=(...Re)=>this.chain(new S_(Re,this.commandOptions));strlen=(...Re)=>this.chain(new E_(Re,this.commandOptions));sunion=(...Re)=>this.chain(new C_(Re,this.commandOptions));sunionstore=(...Re)=>this.chain(new A_(Re,this.commandOptions));time=()=>this.chain(new I_(this.commandOptions));touch=(...Re)=>this.chain(new k_(Re,this.commandOptions));ttl=(...Re)=>this.chain(new M_(Re,this.commandOptions));type=(...Re)=>this.chain(new P_(Re,this.commandOptions));unlink=(...Re)=>this.chain(new R_(Re,this.commandOptions));zadd=(...Re)=>(Re[1],this.chain(new W_([Re[0],Re[1],...Re.slice(2)],this.commandOptions)));xadd=(...Re)=>this.chain(new O_(Re,this.commandOptions));xack=(...Re)=>this.chain(new L_(Re,this.commandOptions));xdel=(...Re)=>this.chain(new B_(Re,this.commandOptions));xgroup=(...Re)=>this.chain(new F_(Re,this.commandOptions));xread=(...Re)=>this.chain(new $_(Re,this.commandOptions));xreadgroup=(...Re)=>this.chain(new G_(Re,this.commandOptions));xinfo=(...Re)=>this.chain(new N_(Re,this.commandOptions));xlen=(...Re)=>this.chain(new j_(Re,this.commandOptions));xpending=(...Re)=>this.chain(new U_(Re,this.commandOptions));xclaim=(...Re)=>this.chain(new D_(Re,this.commandOptions));xautoclaim=(...Re)=>this.chain(new z_(Re,this.commandOptions));xtrim=(...Re)=>this.chain(new H_(Re,this.commandOptions));xrange=(...Re)=>this.chain(new V_(Re,this.commandOptions));xrevrange=(...Re)=>this.chain(new q_(Re,this.commandOptions));zcard=(...Re)=>this.chain(new Z_(Re,this.commandOptions));zcount=(...Re)=>this.chain(new X_(Re,this.commandOptions));zincrby=(Re,Le,Oe)=>this.chain(new Y_([Re,Le,Oe],this.commandOptions));zinterstore=(...Re)=>this.chain(new K_(Re,this.commandOptions));zlexcount=(...Re)=>this.chain(new J_(Re,this.commandOptions));zmscore=(...Re)=>this.chain(new Qy(Re,this.commandOptions));zpopmax=(...Re)=>this.chain(new Q_(Re,this.commandOptions));zpopmin=(...Re)=>this.chain(new iy(Re,this.commandOptions));zrange=(...Re)=>this.chain(new sy(Re,this.commandOptions));zrank=(Re,Le)=>this.chain(new ly([Re,Le],this.commandOptions));zrem=(Re,...Le)=>this.chain(new my([Re,...Le],this.commandOptions));zremrangebylex=(...Re)=>this.chain(new zy(Re,this.commandOptions));zremrangebyrank=(...Re)=>this.chain(new $y(Re,this.commandOptions));zremrangebyscore=(...Re)=>this.chain(new Gy(Re,this.commandOptions));zrevrank=(Re,Le)=>this.chain(new Wy([Re,Le],this.commandOptions));zscan=(...Re)=>this.chain(new Zy(Re,this.commandOptions));zscore=(Re,Le)=>this.chain(new Xy([Re,Le],this.commandOptions));zunionstore=(...Re)=>this.chain(new Ky(Re,this.commandOptions));zunion=(...Re)=>this.chain(new Yy(Re,this.commandOptions));get json(){return{arrappend:(...Re)=>this.chain(new im(Re,this.commandOptions)),arrindex:(...Re)=>this.chain(new sm(Re,this.commandOptions)),arrinsert:(...Re)=>this.chain(new dm(Re,this.commandOptions)),arrlen:(...Re)=>this.chain(new gm(Re,this.commandOptions)),arrpop:(...Re)=>this.chain(new ym(Re,this.commandOptions)),arrtrim:(...Re)=>this.chain(new vm(Re,this.commandOptions)),clear:(...Re)=>this.chain(new xm(Re,this.commandOptions)),del:(...Re)=>this.chain(new bm(Re,this.commandOptions)),forget:(...Re)=>this.chain(new Cm(Re,this.commandOptions)),get:(...Re)=>this.chain(new Pm(Re,this.commandOptions)),mget:(...Re)=>this.chain(new Rm(Re,this.commandOptions)),mset:(...Re)=>this.chain(new Lm(Re,this.commandOptions)),numincrby:(...Re)=>this.chain(new Om(Re,this.commandOptions)),nummultby:(...Re)=>this.chain(new Dm(Re,this.commandOptions)),objkeys:(...Re)=>this.chain(new Fm(Re,this.commandOptions)),objlen:(...Re)=>this.chain(new jm(Re,this.commandOptions)),resp:(...Re)=>this.chain(new Um(Re,this.commandOptions)),set:(...Re)=>this.chain(new Hm(Re,this.commandOptions)),strappend:(...Re)=>this.chain(new Wm(Re,this.commandOptions)),strlen:(...Re)=>this.chain(new Zm(Re,this.commandOptions)),toggle:(...Re)=>this.chain(new Ym(Re,this.commandOptions)),type:(...Re)=>this.chain(new eg(Re,this.commandOptions))}}};function createAutoPipelineProxy(Re,Le){const Oe=Re;return Oe.autoPipelineExecutor||(Oe.autoPipelineExecutor=new tv(Oe)),new Proxy(Oe,{get:(Re,Oe)=>{if("pipelineCounter"===Oe)return Re.autoPipelineExecutor.pipelineCounter;if("json"===Oe)return createAutoPipelineProxy(Re,!0);if(Oe in Re&&!(Oe in Re.autoPipelineExecutor.pipeline))return Re[Oe];return(Le?"function"==typeof Re.autoPipelineExecutor.pipeline.json[Oe]:"function"==typeof Re.autoPipelineExecutor.pipeline[Oe])?(...Ue)=>Re.autoPipelineExecutor.withAutoPipeline((Re=>{Le?Re.json[Oe](...Ue):Re[Oe](...Ue)})):Re.autoPipelineExecutor.pipeline[Oe]}})}var tv=class{pipelinePromises=new WeakMap;activePipeline=null;indexInCurrentPipeline=0;redis;pipeline;pipelineCounter=0;constructor(Re){this.redis=Re,this.pipeline=Re.pipeline()}async withAutoPipeline(Re){const Le=this.activePipeline??this.redis.pipeline();this.activePipeline||(this.activePipeline=Le,this.indexInCurrentPipeline=0);const Oe=this.indexInCurrentPipeline++;Re(Le);const Ue=this.deferExecution().then((()=>{if(!this.pipelinePromises.has(Le)){const Re=Le.exec({keepErrors:!0});this.pipelineCounter+=1,this.pipelinePromises.set(Le,Re),this.activePipeline=null}return this.pipelinePromises.get(Le)})),qe=(await Ue)[Oe];if(qe.error)throw new Bd(`Command failed: ${qe.error}`);return qe.result}async deferExecution(){await Promise.resolve(),await Promise.resolve()}},rv=class{script;sha1;redis;constructor(Re,Le){this.redis=Re,this.sha1=this.digest(Le),this.script=Le}async eval(Re,Le){return await this.redis.eval(this.script,Re,Le)}async evalsha(Re,Le){return await this.redis.evalsha(this.sha1,Re,Le)}async exec(Re,Le){const Oe=await this.redis.evalsha(this.sha1,Re,Le).catch((async Oe=>{if(Oe instanceof Error&&Oe.message.toLowerCase().includes("noscript"))return await this.redis.eval(this.script,Re,Le);throw Oe}));return Oe}digest(Re){return Cd.stringify(Od(Re))}},nv=class{client;opts;enableTelemetry;enableAutoPipelining;constructor(Re,Le){this.client=Re,this.opts=Le,this.enableTelemetry=Le?.enableTelemetry??!0,!1===Le?.readYourWrites&&(this.client.readYourWrites=!1),this.enableAutoPipelining=Le?.enableAutoPipelining??!0}get readYourWritesSyncToken(){return this.client.upstashSyncToken}set readYourWritesSyncToken(Re){this.client.upstashSyncToken=Re}get json(){return{arrappend:(...Re)=>new im(Re,this.opts).exec(this.client),arrindex:(...Re)=>new sm(Re,this.opts).exec(this.client),arrinsert:(...Re)=>new dm(Re,this.opts).exec(this.client),arrlen:(...Re)=>new gm(Re,this.opts).exec(this.client),arrpop:(...Re)=>new ym(Re,this.opts).exec(this.client),arrtrim:(...Re)=>new vm(Re,this.opts).exec(this.client),clear:(...Re)=>new xm(Re,this.opts).exec(this.client),del:(...Re)=>new bm(Re,this.opts).exec(this.client),forget:(...Re)=>new Cm(Re,this.opts).exec(this.client),get:(...Re)=>new Pm(Re,this.opts).exec(this.client),mget:(...Re)=>new Rm(Re,this.opts).exec(this.client),mset:(...Re)=>new Lm(Re,this.opts).exec(this.client),numincrby:(...Re)=>new Om(Re,this.opts).exec(this.client),nummultby:(...Re)=>new Dm(Re,this.opts).exec(this.client),objkeys:(...Re)=>new Fm(Re,this.opts).exec(this.client),objlen:(...Re)=>new jm(Re,this.opts).exec(this.client),resp:(...Re)=>new Um(Re,this.opts).exec(this.client),set:(...Re)=>new Hm(Re,this.opts).exec(this.client),strappend:(...Re)=>new Wm(Re,this.opts).exec(this.client),strlen:(...Re)=>new Zm(Re,this.opts).exec(this.client),toggle:(...Re)=>new Ym(Re,this.opts).exec(this.client),type:(...Re)=>new eg(Re,this.opts).exec(this.client)}}use=Re=>{const Le=this.client.request.bind(this.client);this.client.request=Oe=>Re(Oe,Le)};addTelemetry=Re=>{if(this.enableTelemetry)try{this.client.mergeTelemetry(Re)}catch{}};createScript(Re){return new rv(this,Re)}pipeline=()=>new ev({client:this.client,commandOptions:this.opts,multiExec:!1});autoPipeline=()=>createAutoPipelineProxy(this);multi=()=>new ev({client:this.client,commandOptions:this.opts,multiExec:!0});bitfield=(...Re)=>new cp(Re,this.client,this.opts);append=(...Re)=>new sp(Re,this.opts).exec(this.client);bitcount=(...Re)=>new ap(Re,this.opts).exec(this.client);bitop=(Re,Le,Oe,...Ue)=>new hp([Re,Le,Oe,...Ue],this.opts).exec(this.client);bitpos=(...Re)=>new dp(Re,this.opts).exec(this.client);copy=(...Re)=>new pp(Re,this.opts).exec(this.client);dbsize=()=>new fp(this.opts).exec(this.client);decr=(...Re)=>new mp(Re,this.opts).exec(this.client);decrby=(...Re)=>new yp(Re,this.opts).exec(this.client);del=(...Re)=>new vp(Re,this.opts).exec(this.client);echo=(...Re)=>new xp(Re,this.opts).exec(this.client);eval=(...Re)=>new bp(Re,this.opts).exec(this.client);evalsha=(...Re)=>new Tp(Re,this.opts).exec(this.client);exists=(...Re)=>new Ap(Re,this.opts).exec(this.client);expire=(...Re)=>new Mp(Re,this.opts).exec(this.client);expireat=(...Re)=>new Rp(Re,this.opts).exec(this.client);flushall=Re=>new Lp(Re,this.opts).exec(this.client);flushdb=(...Re)=>new Op(Re,this.opts).exec(this.client);geoadd=(...Re)=>new Dp(Re,this.opts).exec(this.client);geopos=(...Re)=>new jp(Re,this.opts).exec(this.client);geodist=(...Re)=>new Fp(Re,this.opts).exec(this.client);geohash=(...Re)=>new Np(Re,this.opts).exec(this.client);geosearch=(...Re)=>new Up(Re,this.opts).exec(this.client);geosearchstore=(...Re)=>new Vp(Re,this.opts).exec(this.client);get=(...Re)=>new $p(Re,this.opts).exec(this.client);getbit=(...Re)=>new Gp(Re,this.opts).exec(this.client);getdel=(...Re)=>new qp(Re,this.opts).exec(this.client);getrange=(...Re)=>new Wp(Re,this.opts).exec(this.client);getset=(Re,Le)=>new Kp([Re,Le],this.opts).exec(this.client);hdel=(...Re)=>new ef(Re,this.opts).exec(this.client);hexists=(...Re)=>new tf(Re,this.opts).exec(this.client);hget=(...Re)=>new rf(Re,this.opts).exec(this.client);hgetall=(...Re)=>new nf(Re,this.opts).exec(this.client);hincrby=(...Re)=>new of(Re,this.opts).exec(this.client);hincrbyfloat=(...Re)=>new lf(Re,this.opts).exec(this.client);hkeys=(...Re)=>new pf(Re,this.opts).exec(this.client);hlen=(...Re)=>new ff(Re,this.opts).exec(this.client);hmget=(...Re)=>new gf(Re,this.opts).exec(this.client);hmset=(Re,Le)=>new xf([Re,Le],this.opts).exec(this.client);hrandfield=(Re,Le,Oe)=>new Kd([Re,Le,Oe],this.opts).exec(this.client);hscan=(...Re)=>new Ff(Re,this.opts).exec(this.client);hset=(Re,Le)=>new jf([Re,Le],this.opts).exec(this.client);hsetnx=(Re,Le,Oe)=>new $f([Re,Le,Oe],this.opts).exec(this.client);hstrlen=(...Re)=>new Gf(Re,this.opts).exec(this.client);hvals=(...Re)=>new Yf(Re,this.opts).exec(this.client);incr=(...Re)=>new em(Re,this.opts).exec(this.client);incrby=(...Re)=>new rm(Re,this.opts).exec(this.client);incrbyfloat=(...Re)=>new nm(Re,this.opts).exec(this.client);keys=(...Re)=>new tg(Re,this.opts).exec(this.client);lindex=(...Re)=>new rg(Re,this.opts).exec(this.client);linsert=(Re,Le,Oe,Ue)=>new ng([Re,Le,Oe,Ue],this.opts).exec(this.client);llen=(...Re)=>new og(Re,this.opts).exec(this.client);lmove=(...Re)=>new sg(Re,this.opts).exec(this.client);lpop=(...Re)=>new lg(Re,this.opts).exec(this.client);lmpop=(...Re)=>new ag(Re,this.opts).exec(this.client);lpos=(...Re)=>new dg(Re,this.opts).exec(this.client);lpush=(Re,...Le)=>new pg([Re,...Le],this.opts).exec(this.client);lpushx=(Re,...Le)=>new mg([Re,...Le],this.opts).exec(this.client);lrange=(...Re)=>new yg(Re,this.opts).exec(this.client);lrem=(Re,Le,Oe)=>new vg([Re,Le,Oe],this.opts).exec(this.client);lset=(Re,Le,Oe)=>new xg([Re,Le,Oe],this.opts).exec(this.client);ltrim=(...Re)=>new bg(Re,this.opts).exec(this.client);mget=(...Re)=>new wg(Re,this.opts).exec(this.client);mset=Re=>new Tg([Re],this.opts).exec(this.client);msetnx=Re=>new Sg([Re],this.opts).exec(this.client);persist=(...Re)=>new Eg(Re,this.opts).exec(this.client);pexpire=(...Re)=>new Cg(Re,this.opts).exec(this.client);pexpireat=(...Re)=>new Ig(Re,this.opts).exec(this.client);pfadd=(...Re)=>new Rg(Re,this.opts).exec(this.client);pfcount=(...Re)=>new Og(Re,this.opts).exec(this.client);pfmerge=(...Re)=>new zg(Re,this.opts).exec(this.client);ping=Re=>new Bg(Re,this.opts).exec(this.client);psetex=(Re,Le,Oe)=>new Fg([Re,Le,Oe],this.opts).exec(this.client);pttl=(...Re)=>new Ng(Re,this.opts).exec(this.client);publish=(...Re)=>new Ug(Re,this.opts).exec(this.client);randomkey=()=>(new Vg).exec(this.client);rename=(...Re)=>new $g(Re,this.opts).exec(this.client);renamenx=(...Re)=>new Xg(Re,this.opts).exec(this.client);rpop=(...Re)=>new Yg(Re,this.opts).exec(this.client);rpush=(Re,...Le)=>new e_([Re,...Le],this.opts).exec(this.client);rpushx=(Re,...Le)=>new t_([Re,...Le],this.opts).exec(this.client);sadd=(Re,Le,...Oe)=>new r_([Re,Le,...Oe],this.opts).exec(this.client);scan=(...Re)=>new n_(Re,this.opts).exec(this.client);scard=(...Re)=>new i_(Re,this.opts).exec(this.client);scriptExists=(...Re)=>new o_(Re,this.opts).exec(this.client);scriptFlush=(...Re)=>new s_(Re,this.opts).exec(this.client);scriptLoad=(...Re)=>new a_(Re,this.opts).exec(this.client);sdiff=(...Re)=>new l_(Re,this.opts).exec(this.client);sdiffstore=(...Re)=>new c_(Re,this.opts).exec(this.client);set=(Re,Le,Oe)=>new u_([Re,Le,Oe],this.opts).exec(this.client);setbit=(...Re)=>new h_(Re,this.opts).exec(this.client);setex=(Re,Le,Oe)=>new d_([Re,Le,Oe],this.opts).exec(this.client);setnx=(Re,Le)=>new p_([Re,Le],this.opts).exec(this.client);setrange=(...Re)=>new f_(Re,this.opts).exec(this.client);sinter=(...Re)=>new m_(Re,this.opts).exec(this.client);sinterstore=(...Re)=>new g_(Re,this.opts).exec(this.client);sismember=(Re,Le)=>new __([Re,Le],this.opts).exec(this.client);smismember=(Re,Le)=>new v_([Re,Le],this.opts).exec(this.client);smembers=(...Re)=>new y_(Re,this.opts).exec(this.client);smove=(Re,Le,Oe)=>new x_([Re,Le,Oe],this.opts).exec(this.client);spop=(...Re)=>new b_(Re,this.opts).exec(this.client);srandmember=(...Re)=>new w_(Re,this.opts).exec(this.client);srem=(Re,...Le)=>new T_([Re,...Le],this.opts).exec(this.client);sscan=(...Re)=>new S_(Re,this.opts).exec(this.client);strlen=(...Re)=>new E_(Re,this.opts).exec(this.client);sunion=(...Re)=>new C_(Re,this.opts).exec(this.client);sunionstore=(...Re)=>new A_(Re,this.opts).exec(this.client);time=()=>(new I_).exec(this.client);touch=(...Re)=>new k_(Re,this.opts).exec(this.client);ttl=(...Re)=>new M_(Re,this.opts).exec(this.client);type=(...Re)=>new P_(Re,this.opts).exec(this.client);unlink=(...Re)=>new R_(Re,this.opts).exec(this.client);xadd=(...Re)=>new O_(Re,this.opts).exec(this.client);xack=(...Re)=>new L_(Re,this.opts).exec(this.client);xdel=(...Re)=>new B_(Re,this.opts).exec(this.client);xgroup=(...Re)=>new F_(Re,this.opts).exec(this.client);xread=(...Re)=>new $_(Re,this.opts).exec(this.client);xreadgroup=(...Re)=>new G_(Re,this.opts).exec(this.client);xinfo=(...Re)=>new N_(Re,this.opts).exec(this.client);xlen=(...Re)=>new j_(Re,this.opts).exec(this.client);xpending=(...Re)=>new U_(Re,this.opts).exec(this.client);xclaim=(...Re)=>new D_(Re,this.opts).exec(this.client);xautoclaim=(...Re)=>new z_(Re,this.opts).exec(this.client);xtrim=(...Re)=>new H_(Re,this.opts).exec(this.client);xrange=(...Re)=>new V_(Re,this.opts).exec(this.client);xrevrange=(...Re)=>new q_(Re,this.opts).exec(this.client);zadd=(...Re)=>(Re[1],new W_([Re[0],Re[1],...Re.slice(2)],this.opts).exec(this.client));zcard=(...Re)=>new Z_(Re,this.opts).exec(this.client);zcount=(...Re)=>new X_(Re,this.opts).exec(this.client);zdiffstore=(...Re)=>new Jy(Re,this.opts).exec(this.client);zincrby=(Re,Le,Oe)=>new Y_([Re,Le,Oe],this.opts).exec(this.client);zinterstore=(...Re)=>new K_(Re,this.opts).exec(this.client);zlexcount=(...Re)=>new J_(Re,this.opts).exec(this.client);zmscore=(...Re)=>new Qy(Re,this.opts).exec(this.client);zpopmax=(...Re)=>new Q_(Re,this.opts).exec(this.client);zpopmin=(...Re)=>new iy(Re,this.opts).exec(this.client);zrange=(...Re)=>new sy(Re,this.opts).exec(this.client);zrank=(Re,Le)=>new ly([Re,Le],this.opts).exec(this.client);zrem=(Re,...Le)=>new my([Re,...Le],this.opts).exec(this.client);zremrangebylex=(...Re)=>new zy(Re,this.opts).exec(this.client);zremrangebyrank=(...Re)=>new $y(Re,this.opts).exec(this.client);zremrangebyscore=(...Re)=>new Gy(Re,this.opts).exec(this.client);zrevrank=(Re,Le)=>new Wy([Re,Le],this.opts).exec(this.client);zscan=(...Re)=>new Zy(Re,this.opts).exec(this.client);zscore=(Re,Le)=>new Xy([Re,Le],this.opts).exec(this.client);zunion=(...Re)=>new Yy(Re,this.opts).exec(this.client);zunionstore=(...Re)=>new Ky(Re,this.opts).exec(this.client)};"undefined"==typeof atob&&(global.atob=Re=>Ln.from(Re,"base64").toString("utf8"));var iv=class _Redis extends nv{constructor(Re){if("request"in Re)return void super(Re);Re.url?(Re.url.startsWith(" ")||Re.url.endsWith(" ")||/\r|\n/.test(Re.url))&&console.warn("[Upstash Redis] The redis url contains whitespace or newline, which can cause errors!"):console.warn("[Upstash Redis] The 'url' property is missing or undefined in your Redis config."),Re.token?(Re.token.startsWith(" ")||Re.token.endsWith(" ")||/\r|\n/.test(Re.token))&&console.warn("[Upstash Redis] The redis token contains whitespace or newline, which can cause errors!"):console.warn("[Upstash Redis] The 'token' property is missing or undefined in your Redis config.");return super(new Hd({baseUrl:Re.url,retry:Re.retry,headers:{authorization:`Bearer ${Re.token}`},agent:Re.agent,responseEncoding:Re.responseEncoding,cache:Re.cache??"no-store",signal:Re.signal,keepAlive:Re.keepAlive,readYourWrites:Re.readYourWrites}),{automaticDeserialization:Re.automaticDeserialization,enableTelemetry:!process.env.UPSTASH_DISABLE_TELEMETRY,latencyLogging:Re.latencyLogging,enableAutoPipelining:Re.enableAutoPipelining}),this.addTelemetry({runtime:"string"==typeof EdgeRuntime?"edge-light":`node@${process.version}`,platform:process.env.VERCEL?"vercel":process.env.AWS_REGION?"aws":"unknown",sdk:"@upstash/redis@v1.34.3"}),this.enableAutoPipelining?this.autoPipeline():void 0}static fromEnv(Re){if(void 0===process.env)throw new TypeError('[Upstash Redis] Unable to get environment variables, `process.env` is undefined. If you are deploying to cloudflare, please import from "@upstash/redis/cloudflare" instead');const Le=process.env.UPSTASH_REDIS_REST_URL||process.env.KV_REST_API_URL;Le||console.warn("[Upstash Redis] Unable to find environment variable: `UPSTASH_REDIS_REST_URL`");const Oe=process.env.UPSTASH_REDIS_REST_TOKEN||process.env.KV_REST_API_TOKEN;return Oe||console.warn("[Upstash Redis] Unable to find environment variable: `UPSTASH_REDIS_REST_TOKEN`"),new _Redis({...Re,url:Le,token:Oe})}},ov=null;process.env.UPSTASH_DISABLE_TELEMETRY="1";var sv=class extends iv{async*scanIterator(Re){let Le,Oe="0";do{[Oe,Le]=await this.scan(Oe,Re);for(const Re of Le)yield Re}while("0"!==Oe)}async*hscanIterator(Re,Le){let Oe,Ue="0";do{[Ue,Oe]=await this.hscan(Re,Ue,Le);for(const Re of Oe)yield Re}while("0"!==Ue)}async*sscanIterator(Re,Le){let Oe,Ue="0";do{[Ue,Oe]=await this.sscan(Re,Ue,Le);for(const Re of Oe)yield Re}while("0"!==Ue)}async*zscanIterator(Re,Le){let Oe,Ue="0";do{[Ue,Oe]=await this.zscan(Re,Ue,Le);for(const Re of Oe)yield Re}while("0"!==Ue)}};function createClient(Re){return new sv({cache:"default",enableAutoPipelining:!0,...Re})}function normalizeKey$1(Re){return Re?Re.replace(/[/\\]/g,":").replace(/^:|:$/g,""):""}function createError$1(Re,Le,Oe){return new Error(`[unstorage] [${Re}] ${Le}`,Oe)}new Proxy({},{get(Re,Le,Oe){if("then"===Le||"parse"===Le)return Reflect.get(Re,Le,Oe);if(!ov){if(!process.env.KV_REST_API_URL||!process.env.KV_REST_API_TOKEN)throw new Error("@vercel/kv: Missing required environment variables KV_REST_API_URL and KV_REST_API_TOKEN");console.warn('[33m"The default export has been moved to a named export and it will be removed in version 1, change to import { kv }[0m"'),ov=createClient({url:process.env.KV_REST_API_URL,token:process.env.KV_REST_API_TOKEN})}return Reflect.get(ov,Le)}}),new Proxy({},{get(Re,Le){if(!ov){if(!process.env.KV_REST_API_URL||!process.env.KV_REST_API_TOKEN)throw new Error("@vercel/kv: Missing required environment variables KV_REST_API_URL and KV_REST_API_TOKEN");ov=createClient({url:process.env.KV_REST_API_URL,token:process.env.KV_REST_API_TOKEN})}return Reflect.get(ov,Le)}});const unstorage_47drivers_47vercel_45kv=Re=>{const Le=normalizeKey$1(Re?.base),r=(...Re)=>function(...Re){return Re.map((Re=>normalizeKey$1(Re))).filter(Boolean).join(":")}(Le,...Re);let Oe;const getClient=()=>{if(!Oe){const Le="undefined"!=typeof process&&!1!==Re.env?`${Re.env||"KV"}_`:"";if(!Re.url){const Oe=Le+"REST_API_URL";if(!Le||!process.env[Oe])throw createError$1("vercel-kv",`missing required \`url\` option or '${Oe}' env.`);Re.url=process.env[Oe]}if(!Re.token){const Oe=Le+"REST_API_TOKEN";if(!Le||!process.env[Oe])throw createError$1("vercel-kv",`missing required \`token\` option or '${Oe}' env.`);Re.token=process.env[Oe]}Oe=createClient(Re)}return Oe};return{name:"vercel-kv",getInstance:getClient,hasItem:Re=>getClient().exists(r(Re)).then(Boolean),getItem:Re=>getClient().get(r(Re)),setItem(Le,Oe,Ue){const qe=Ue?.ttl??Re.ttl;return getClient().set(r(Le),Oe,qe?{ex:qe}:void 0).then((()=>{}))},removeItem:Re=>getClient().del(r(Re)).then((()=>{})),getKeys:Re=>getClient().keys(r(Re,"*")),async clear(Re){const Le=await getClient().keys(r(Re,"*"));if(0!==Le.length)return getClient().del(...Le).then((()=>{}))}}},av=function(Re={}){const Le={mounts:{"":Re.driver||memory()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},getMount=Re=>{for(const Oe of Le.mountpoints)if(Re.startsWith(Oe))return{base:Oe,relativeKey:Re.slice(Oe.length),driver:Le.mounts[Oe]};return{base:"",relativeKey:Re,driver:Le.mounts[""]}},getMounts=(Re,Oe)=>Le.mountpoints.filter((Le=>Le.startsWith(Re)||Oe&&Re.startsWith(Le))).map((Oe=>({relativeBase:Re.length>Oe.length?Re.slice(Oe.length):void 0,mountpoint:Oe,driver:Le.mounts[Oe]}))),onChange=(Re,Oe)=>{if(Le.watching){Oe=normalizeKey$3(Oe);for(const Ue of Le.watchListeners)Ue(Re,Oe)}},stopWatch=async()=>{if(Le.watching){for(const Re in Le.unwatch)await Le.unwatch[Re]();Le.unwatch={},Le.watching=!1}},runBatch=(Re,Le,Oe)=>{const Ue=new Map,getBatch=Re=>{let Le=Ue.get(Re.base);return Le||(Le={driver:Re.driver,base:Re.base,items:[]},Ue.set(Re.base,Le)),Le};for(const Oe of Re){const Re="string"==typeof Oe,Ue=normalizeKey$3(Re?Oe:Oe.key),qe=Re?void 0:Oe.value,Ct=Re||!Oe.options?Le:{...Le,...Oe.options},Ot=getMount(Ue);getBatch(Ot).items.push({key:Ue,value:qe,relativeKey:Ot.relativeKey,options:Ct})}return Promise.all([...Ue.values()].map((Re=>Oe(Re)))).then((Re=>Re.flat()))},Oe={hasItem(Re,Le={}){Re=normalizeKey$3(Re);const{relativeKey:Oe,driver:Ue}=getMount(Re);return asyncCall(Ue.hasItem,Oe,Le)},getItem(Re,Le={}){Re=normalizeKey$3(Re);const{relativeKey:Oe,driver:Ue}=getMount(Re);return asyncCall(Ue.getItem,Oe,Le).then((Re=>destr(Re)))},getItems:(Re,Le)=>runBatch(Re,Le,(Re=>Re.driver.getItems?asyncCall(Re.driver.getItems,Re.items.map((Re=>({key:Re.relativeKey,options:Re.options}))),Le).then((Le=>Le.map((Le=>({key:joinKeys$1(Re.base,Le.key),value:destr(Le.value)}))))):Promise.all(Re.items.map((Le=>asyncCall(Re.driver.getItem,Le.relativeKey,Le.options).then((Re=>({key:Le.key,value:destr(Re)})))))))),getItemRaw(Re,Le={}){Re=normalizeKey$3(Re);const{relativeKey:Oe,driver:Ue}=getMount(Re);return Ue.getItemRaw?asyncCall(Ue.getItemRaw,Oe,Le):asyncCall(Ue.getItem,Oe,Le).then((Re=>function(Re){return"string"!=typeof Re?Re:Re.startsWith(Eh)?(checkBufferSupport(),Ln.from(Re.slice(7),"base64")):Re}(Re)))},async setItem(Re,Le,Ue={}){if(void 0===Le)return Oe.removeItem(Re);Re=normalizeKey$3(Re);const{relativeKey:qe,driver:Ct}=getMount(Re);Ct.setItem&&(await asyncCall(Ct.setItem,qe,stringify$1(Le),Ue),Ct.watch||onChange("update",Re))},async setItems(Re,Le){await runBatch(Re,Le,(async Re=>{if(Re.driver.setItems)return asyncCall(Re.driver.setItems,Re.items.map((Re=>({key:Re.relativeKey,value:stringify$1(Re.value),options:Re.options}))),Le);Re.driver.setItem&&await Promise.all(Re.items.map((Le=>asyncCall(Re.driver.setItem,Le.relativeKey,stringify$1(Le.value),Le.options))))}))},async setItemRaw(Re,Le,Ue={}){if(void 0===Le)return Oe.removeItem(Re,Ue);Re=normalizeKey$3(Re);const{relativeKey:qe,driver:Ct}=getMount(Re);if(Ct.setItemRaw)await asyncCall(Ct.setItemRaw,qe,Le,Ue);else{if(!Ct.setItem)return;await asyncCall(Ct.setItem,qe,function(Re){if("string"==typeof Re)return Re;checkBufferSupport();const Le=Ln.from(Re).toString("base64");return Eh+Le}(Le),Ue)}Ct.watch||onChange("update",Re)},async removeItem(Re,Le={}){"boolean"==typeof Le&&(Le={removeMeta:Le}),Re=normalizeKey$3(Re);const{relativeKey:Oe,driver:Ue}=getMount(Re);Ue.removeItem&&(await asyncCall(Ue.removeItem,Oe,Le),(Le.removeMeta||Le.removeMata)&&await asyncCall(Ue.removeItem,Oe+"$",Le),Ue.watch||onChange("remove",Re))},async getMeta(Re,Le={}){"boolean"==typeof Le&&(Le={nativeOnly:Le}),Re=normalizeKey$3(Re);const{relativeKey:Oe,driver:Ue}=getMount(Re),qe=Object.create(null);if(Ue.getMeta&&Object.assign(qe,await asyncCall(Ue.getMeta,Oe,Le)),!Le.nativeOnly){const Re=await asyncCall(Ue.getItem,Oe+"$",Le).then((Re=>destr(Re)));Re&&"object"==typeof Re&&("string"==typeof Re.atime&&(Re.atime=new Date(Re.atime)),"string"==typeof Re.mtime&&(Re.mtime=new Date(Re.mtime)),Object.assign(qe,Re))}return qe},setMeta(Re,Le,Oe={}){return this.setItem(Re+"$",Le,Oe)},removeMeta(Re,Le={}){return this.removeItem(Re+"$",Le)},async getKeys(Re,Le={}){Re=normalizeBaseKey(Re);const Oe=getMounts(Re,!0);let Ue=[];const qe=[];for(const Re of Oe){const Oe=await asyncCall(Re.driver.getKeys,Re.relativeBase,Le);for(const Le of Oe){const Oe=Re.mountpoint+normalizeKey$3(Le);Ue.some((Re=>Oe.startsWith(Re)))||qe.push(Oe)}Ue=[Re.mountpoint,...Ue.filter((Le=>!Le.startsWith(Re.mountpoint)))]}return Re?qe.filter((Le=>Le.startsWith(Re)&&"$"!==Le[Le.length-1])):qe.filter((Re=>"$"!==Re[Re.length-1]))},async clear(Re,Le={}){Re=normalizeBaseKey(Re),await Promise.all(getMounts(Re,!1).map((async Re=>{if(Re.driver.clear)return asyncCall(Re.driver.clear,Re.relativeBase,Le);if(Re.driver.removeItem){const Oe=await Re.driver.getKeys(Re.relativeBase||"",Le);return Promise.all(Oe.map((Oe=>Re.driver.removeItem(Oe,Le))))}})))},async dispose(){await Promise.all(Object.values(Le.mounts).map((Re=>dispose(Re))))},watch:async Re=>(await(async()=>{if(!Le.watching){Le.watching=!0;for(const Re in Le.mounts)Le.unwatch[Re]=await watch$2(Le.mounts[Re],onChange,Re)}})(),Le.watchListeners.push(Re),async()=>{Le.watchListeners=Le.watchListeners.filter((Le=>Le!==Re)),0===Le.watchListeners.length&&await stopWatch()}),async unwatch(){Le.watchListeners=[],await stopWatch()},mount(Re,Ue){if((Re=normalizeBaseKey(Re))&&Le.mounts[Re])throw new Error(`already mounted at ${Re}`);return Re&&(Le.mountpoints.push(Re),Le.mountpoints.sort(((Re,Le)=>Le.length-Re.length))),Le.mounts[Re]=Ue,Le.watching&&Promise.resolve(watch$2(Ue,onChange,Re)).then((Oe=>{Le.unwatch[Re]=Oe})).catch(console.error),Oe},async unmount(Re,Oe=!0){(Re=normalizeBaseKey(Re))&&Le.mounts[Re]&&(Le.watching&&Re in Le.unwatch&&(Le.unwatch[Re](),delete Le.unwatch[Re]),Oe&&await dispose(Le.mounts[Re]),Le.mountpoints=Le.mountpoints.filter((Le=>Le!==Re)),delete Le.mounts[Re])},getMount(Re=""){Re=normalizeKey$3(Re)+":";const Le=getMount(Re);return{driver:Le.driver,base:Le.base}},getMounts(Re="",Le={}){Re=normalizeKey$3(Re);return getMounts(Re,Le.parents).map((Re=>({driver:Re.driver,base:Re.mountpoint})))},keys:(Re,Le={})=>Oe.getKeys(Re,Le),get:(Re,Le={})=>Oe.getItem(Re,Le),set:(Re,Le,Ue={})=>Oe.setItem(Re,Le,Ue),has:(Re,Le={})=>Oe.hasItem(Re,Le),del:(Re,Le={})=>Oe.removeItem(Re,Le),remove:(Re,Le={})=>Oe.removeItem(Re,Le)};return Oe}({});function useStorage(Re=""){return Re?function(Re,Le){if(!(Le=normalizeBaseKey(Le)))return Re;const Oe={...Re};for(const Ue of Ch)Oe[Ue]=(Oe="",...qe)=>Re[Ue](Le+Oe,...qe);return Oe.getKeys=(Oe="",...Ue)=>Re.getKeys(Le+Oe,...Ue).then((Re=>Re.map((Re=>Re.slice(Le.length))))),Oe}(av,Re):av}av.mount("/assets",zh),av.mount("data",unstorage_47drivers_47vercel_45kv({driver:"vercelKV"}));const lv={name:"_",base:"/cache",swr:!0,maxAge:1};const cachedFunction=function(Re,Le={}){Le={...lv,...Le};const Oe={},Ue=Le.group||"nitro/functions",qe=Le.name||Re.name||"_",Ct=Le.integrity||hash([Re,Le]),Ot=Le.validate||(Re=>void 0!==Re.value);return async(...Jt)=>{if(await(Le.shouldBypassCache?.(...Jt)))return Re(...Jt);const Hr=await(Le.getKey||getKey)(...Jt),Jr=await(Le.shouldInvalidateCache?.(...Jt)),Ln=await async function(Re,Jt,Hr,Jr){const Ln=[Le.base,Ue,qe,Re+".json"].filter(Boolean).join(":").replace(/:\/$/,":index");let Nn=await useStorage().getItem(Ln)||{};if("object"!=typeof Nn){Nn={};const Re=new Error("Malformed data read from cache.");console.error("[nitro] [cache]",Re),useNitroApp().captureError(Re,{event:Jr,tags:["cache"]})}const $n=1e3*(Le.maxAge??Le.maxAge??0);$n&&(Nn.expires=Date.now()+$n);const Gn=Hr||Nn.integrity!==Ct||$n&&Date.now()-(Nn.mtime||0)>$n||!1===Ot(Nn),qn=Gn?(async()=>{const Ue=Oe[Re];Ue||(void 0!==Nn.value&&(Le.staleMaxAge||0)>=0&&!1===Le.swr&&(Nn.value=void 0,Nn.integrity=void 0,Nn.mtime=void 0,Nn.expires=void 0),Oe[Re]=Promise.resolve(Jt()));try{Nn.value=await Oe[Re]}catch(Le){throw Ue||delete Oe[Re],Le}if(!Ue&&(Nn.mtime=Date.now(),Nn.integrity=Ct,delete Oe[Re],!1!==Ot(Nn))){const Re=useStorage().setItem(Ln,Nn).catch((Re=>{console.error("[nitro] [cache] Cache write error.",Re),useNitroApp().captureError(Re,{event:Jr,tags:["cache"]})}));Jr&&Jr.waitUntil&&Jr.waitUntil(Re)}})():Promise.resolve();return void 0===Nn.value?await qn:Gn&&Jr&&Jr.waitUntil&&Jr.waitUntil(qn),Le.swr&&!1!==Ot(Nn)?(qn.catch((Re=>{console.error("[nitro] [cache] SWR handler error.",Re),useNitroApp().captureError(Re,{event:Jr,tags:["cache"]})})),Nn):qn.then((()=>Nn))}(Hr,(()=>Re(...Jt)),Jr,Jt[0]&&isEvent(Jt[0])?Jt[0]:void 0);let Nn=Ln.value;return Le.transform&&(Nn=await Le.transform(Ln,...Jt)||Nn),Nn}};function getKey(...Re){return Re.length>0?hash(Re,{}):""}function escapeKey(Re){return String(Re).replace(/\W/g,"")}function cloneWithProxy(Re,Le){return new Proxy(Re,{get:(Re,Oe,Ue)=>Oe in Le?Le[Oe]:Reflect.get(Re,Oe,Ue),set:(Re,Oe,Ue,qe)=>Oe in Le?(Le[Oe]=Ue,!0):Reflect.set(Re,Oe,Ue,qe)})}const cachedEventHandler=function(Re,Le=lv){const Oe=(Le.varies||[]).filter(Boolean).map((Re=>Re.toLowerCase())).sort(),Ue={...Le,getKey:async Re=>{const Ue=await(Le.getKey?.(Re));if(Ue)return escapeKey(Ue);const qe=Re.node.req.originalUrl||Re.node.req.url||Re.path;return[`${escapeKey(decodeURI(parseURL$2(qe).pathname)).slice(0,16)||"index"}.${hash(qe)}`,...Oe.map((Le=>[Le,Re.node.req.headers[Le]])).map((([Re,Le])=>`${escapeKey(Re)}.${hash(Le)}`))].join(":")},validate:Re=>!!Re.value&&(!(Re.value.code>=400)&&(void 0!==Re.value.body&&("undefined"!==Re.value.headers.etag&&"undefined"!==Re.value.headers["last-modified"]))),group:Le.group||"nitro/handlers",integrity:Le.integrity||hash([Re,Le])},qe=cachedFunction((async qe=>{const Ct={};for(const Re of Oe)Ct[Re]=qe.node.req.headers[Re];const Ot=cloneWithProxy(qe.node.req,{headers:Ct}),Jt={};let Hr;const Jr=createEvent(Ot,cloneWithProxy(qe.node.res,{statusCode:200,writableEnded:!1,writableFinished:!1,headersSent:!1,closed:!1,getHeader:Re=>Jt[Re],setHeader(Re,Le){return Jt[Re]=Le,this},getHeaderNames:()=>Object.keys(Jt),hasHeader:Re=>Re in Jt,removeHeader(Re){delete Jt[Re]},getHeaders:()=>Jt,end(Re,Le,Oe){return"string"==typeof Re&&(Hr=Re),"function"==typeof Le&&Le(),"function"==typeof Oe&&Oe(),this},write(Re,Le,Oe){return"string"==typeof Re&&(Hr=Re),"function"==typeof Le&&Le(),"function"==typeof Oe&&Oe(),this},writeHead(Re,Le){if(this.statusCode=Re,Le)for(const Re in Le)this.setHeader(Re,Le[Re]);return this}}));Jr.fetch=(Re,Le)=>fetchWithEvent(Jr,Re,Le,{fetch:useNitroApp().localFetch}),Jr.$fetch=(Re,Le)=>fetchWithEvent(Jr,Re,Le,{fetch:globalThis.$fetch}),Jr.context=qe.context,Jr.context.cache={options:Ue};const Ln=await Re(Jr)||Hr,Nn=Jr.node.res.getHeaders();Nn.etag=String(Nn.Etag||Nn.etag||`W/"${hash(Ln)}"`),Nn["last-modified"]=String(Nn["Last-Modified"]||Nn["last-modified"]||(new Date).toUTCString());const $n=[];Le.swr?(Le.maxAge&&$n.push(`s-maxage=${Le.maxAge}`),Le.staleMaxAge?$n.push(`stale-while-revalidate=${Le.staleMaxAge}`):$n.push("stale-while-revalidate")):Le.maxAge&&$n.push(`max-age=${Le.maxAge}`),$n.length>0&&(Nn["cache-control"]=$n.join(", "));return{code:Jr.node.res.statusCode,headers:Nn,body:Ln}}),Ue);return defineEventHandler((async Oe=>{if(Le.headersOnly){if(handleCacheHeaders(Oe,{maxAge:Le.maxAge}))return;return Re(Oe)}const Ue=await qe(Oe);if(Oe.node.res.headersSent||Oe.node.res.writableEnded)return Ue.body;if(!handleCacheHeaders(Oe,{modifiedTime:new Date(Ue.headers["last-modified"]),etag:Ue.headers.etag,maxAge:Le.maxAge})){Oe.node.res.statusCode=Ue.code;for(const Re in Ue.headers){const Le=Ue.headers[Re];"set-cookie"===Re?Oe.node.res.appendHeader(Re,splitCookiesString(Le)):Oe.node.res.setHeader(Re,Le)}return Ue.body}}))};function hasReqHeader(Re,Le,Oe){const Ue=getRequestHeader(Re,Le);return Ue&&"string"==typeof Ue&&Ue.toLowerCase().includes(Oe)}function joinHeaders(Re){return Array.isArray(Re)?Re.join(", "):String(Re)}function normalizeCookieHeader(Re=""){return splitCookiesString(joinHeaders(Re))}function normalizeCookieHeaders(Re){const Le=new Headers;for(const[Oe,Ue]of Re)if("set-cookie"===Oe)for(const Re of normalizeCookieHeader(Ue))Le.append("set-cookie",Re);else Le.set(Oe,joinHeaders(Ue));return Le}const cv=toRouteMatcher(createRouter$2({routes:useRuntimeConfig$1().nitro.routeRules}));function createRouteRulesHandler(Re){return xu((Le=>{const Oe=getRouteRules$1(Le);if(Oe.headers&&ou(Le,Oe.headers),Oe.redirect){let Re=Oe.redirect.to;if(Re.endsWith("/**")){let Ue=Le.path;const qe=Oe.redirect._redirectStripBase;qe&&(Ue=withoutBase(Ue,qe)),Re=joinURL$1(Re.slice(0,-3),Ue)}else if(Le.path.includes("?")){Re=withQuery$1(Re,getQuery$1(Le.path))}return function(Re,Le,Oe=302){return Re.node.res.statusCode=sanitizeStatusCode(Oe,Re.node.res.statusCode),Re.node.res.setHeader("location",Le),send$1(Re,`<!DOCTYPE html><html><head><meta http-equiv="refresh" content="0; url=${Le.replace(/"/g,"%22")}"></head></html>`,Jc.html)}(Le,Re,Oe.redirect.statusCode)}if(Oe.proxy){let Ue=Oe.proxy.to;if(Ue.endsWith("/**")){let Re=Le.path;const qe=Oe.proxy._proxyStripBase;qe&&(Re=withoutBase(Re,qe)),Ue=joinURL$1(Ue.slice(0,-3),Re)}else if(Le.path.includes("?")){Ue=withQuery$1(Ue,getQuery$1(Le.path))}return proxyRequest(Le,Ue,{fetch:Re.localFetch,...Oe.proxy})}}))}function getRouteRules$1(Re){return Re.context._nitro=Re.context._nitro||{},Re.context._nitro.routeRules||(Re.context._nitro.routeRules=getRouteRulesForPath(withoutBase(Re.path.split("?")[0],useRuntimeConfig$1().app.baseURL))),Re.context._nitro.routeRules}function getRouteRulesForPath(Re){return Ql({},...cv.matchAll(Re).reverse())}const uv="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof global?global:{},hv="__unctx__",dv=uv[hv]||(uv[hv]=function(Re={}){const Le={};return{get:(Oe,Ue={})=>(Le[Oe]||(Le[Oe]=function(Re={}){let Le,Oe=!1;const checkConflict=Re=>{if(Le&&Le!==Re)throw new Error("Context conflict")};let Ue;if(Re.asyncContext){const Le=Re.AsyncLocalStorage||globalThis.AsyncLocalStorage;Le?Ue=new Le:console.warn("[unctx] `AsyncLocalStorage` is not provided.")}const _getCurrentInstance=()=>{if(Ue&&void 0===Le){const Re=Ue.getStore();if(void 0!==Re)return Re}return Le};return{use:()=>{const Re=_getCurrentInstance();if(void 0===Re)throw new Error("Context is not available");return Re},tryUse:()=>_getCurrentInstance(),set:(Re,Ue)=>{Ue||checkConflict(Re),Le=Re,Oe=!0},unset:()=>{Le=void 0,Oe=!1},call:(Re,qe)=>{checkConflict(Re),Le=Re;try{return Ue?Ue.run(Re,qe):qe()}finally{Oe||(Le=void 0)}},async callAsync(Re,qe){Le=Re;const onRestore=()=>{Le=Re},onLeave=()=>Le===Re?onRestore:void 0;fv.add(onLeave);try{const Ct=Ue?Ue.run(Re,qe):qe();return Oe||(Le=void 0),await Ct}finally{fv.delete(onLeave)}}}}({...Re,...Ue})),Le[Oe],Le[Oe])}}()),pv="__unctx_async_handlers__",fv=uv[pv]||(uv[pv]=new Set),mv=[function(Re){Re.hooks.hook("render:html",(Re=>{Re.head.push('<script>"use strict";(()=>{const t=window,e=document.documentElement,c=["dark","light"],n=getStorageValue("localStorage","nuxt-color-mode")||"system";let i=n==="system"?u():n;const r=e.getAttribute("data-color-mode-forced");r&&(i=r),l(i),t["__NUXT_COLOR_MODE__"]={preference:n,value:i,getColorScheme:u,addColorScheme:l,removeColorScheme:d};function l(o){const s=""+o+"",a="";e.classList?e.classList.add(s):e.className+=" "+s,a&&e.setAttribute("data-"+a,o)}function d(o){const s=""+o+"",a="";e.classList?e.classList.remove(s):e.className=e.className.replace(new RegExp(s,"g"),""),a&&e.removeAttribute("data-"+a)}function f(o){return t.matchMedia("(prefers-color-scheme"+o+")")}function u(){if(t.matchMedia&&f("").media!=="not all"){for(const o of c)if(f(":"+o).matches)return o}return"light"}})();function getStorageValue(t,e){switch(t){case"localStorage":return window.localStorage.getItem(e);case"sessionStorage":return window.sessionStorage.getItem(e);case"cookie":return getCookie(e);default:return null}}function getCookie(t){const c=("; "+window.document.cookie).split("; "+t+"=");if(c.length===2)return c.pop()?.split(";").shift()}<\/script>')}))}];const errorHandler=async function(Re,Le){const{stack:Oe,statusCode:Ue,statusMessage:qe,message:Ct}=function(Re){const Le="function"==typeof process.cwd?process.cwd():"/",Oe=(Re.stack||"").split("\n").splice(1).filter((Re=>Re.includes("at "))).map((Re=>({text:Re.replace(Le+"/","./").replace("webpack:/","").replace("file://","").trim(),internal:Re.includes("node_modules")&&!Re.includes(".cache")||Re.includes("internal")||Re.includes("new Promise")}))),Ue=Re.statusCode||500;return{stack:Oe,statusCode:Ue,statusMessage:Re.statusMessage??(404===Ue?"Not Found":""),message:Re.message||Re.toString()}}(Re),Ot={url:Le.path,statusCode:Ue,statusMessage:qe,message:Ct,stack:"",data:Re.data};if(Re.unhandled||Re.fatal){const Le=["[nuxt]","[request error]",Re.unhandled&&"[unhandled]",Re.fatal&&"[fatal]",200!==Number(Ot.statusCode)&&`[${Ot.statusCode}]`].filter(Boolean).join(" ");console.error(Le,(Re.message||Re.toString()||"internal server error")+"\n"+Oe.map((Re=>"  "+Re.text)).join("  \n"))}if(Le.handled)return;if(setResponseStatus(Le,200!==Ot.statusCode&&Ot.statusCode||500,Ot.statusMessage),function(Re){return!hasReqHeader(Re,"accept","text/html")&&(hasReqHeader(Re,"accept","application/json")||hasReqHeader(Re,"user-agent","curl/")||hasReqHeader(Re,"user-agent","httpie/")||hasReqHeader(Re,"sec-fetch-mode","cors")||Re.path.startsWith("/api/")||Re.path.endsWith(".json"))}(Le))return setResponseHeader(Le,"Content-Type","application/json"),send$1(Le,JSON.stringify(Ot));const Jt=getRequestHeaders(Le),Hr=Le.path.startsWith("/__nuxt_error")||!!Jt["x-nuxt-error"]?null:await useNitroApp().localFetch(withQuery$1(joinURL$1(useRuntimeConfig$1(Le).app.baseURL,"/__nuxt_error"),Ot),{headers:{...Jt,"x-nuxt-error":"true"},redirect:"manual"}).catch((()=>null));if(!Hr){const{template:Re}=await Promise.resolve().then((function(){return vv}));if(Le.handled)return;return setResponseHeader(Le,"Content-Type","text/html;charset=UTF-8"),send$1(Le,Re(Ot))}const Jr=await Hr.text();if(!Le.handled){for(const[Re,Oe]of Hr.headers.entries())setResponseHeader(Le,Re,Oe);return setResponseStatus(Le,Hr.status&&200!==Hr.status?Hr.status:void 0,Hr.statusText),send$1(Le,Jr)}},_lazy_4GmcnZ=()=>Promise.resolve().then((function(){return MT})),gv=[{route:"/__nuxt_error",handler:_lazy_4GmcnZ,lazy:!0,middleware:!1,method:void 0},{route:"/**",handler:_lazy_4GmcnZ,lazy:!0,middleware:!1,method:void 0}];const _v=function(){const Re=useRuntimeConfig$1(),Le=createHooks(),captureError=(Re,Oe={})=>{const Ue=Le.callHookParallel("error",Re,Oe).catch((Re=>{console.error("Error while capturing another error",Re)}));if(Oe.event&&isEvent(Oe.event)){const Le=Oe.event.context.nitro?.errors;Le&&Le.push({error:Re,context:Oe}),Oe.event.waitUntil&&Oe.event.waitUntil(Ue)}},Oe=createApp$1({debug:destr(!1),onError:(Re,Le)=>(captureError(Re,{event:Le,tags:["request"]}),errorHandler(Re,Le)),onRequest:async Re=>{await _v.hooks.callHook("request",Re).catch((Le=>{captureError(Le,{event:Re,tags:["request"]})}))},onBeforeResponse:async(Re,Le)=>{await _v.hooks.callHook("beforeResponse",Re,Le).catch((Le=>{captureError(Le,{event:Re,tags:["request","response"]})}))},onAfterResponse:async(Re,Le)=>{await _v.hooks.callHook("afterResponse",Re,Le).catch((Le=>{captureError(Le,{event:Re,tags:["request","response"]})}))}}),Ue=function(Re={}){const Le=createRouter$2({}),Oe={};let Ue;const qe={},addRoute=(Re,Ue,Ct)=>{let Ot=Oe[Re];if(Ot||(Oe[Re]=Ot={path:Re,handlers:{}},Le.insert(Re,Ot)),Array.isArray(Ct))for(const Le of Ct)addRoute(Re,Ue,Le);else Ot.handlers[Ct]=toEventHandler(Ue,0,Re);return qe};qe.use=qe.add=(Re,Le,Oe)=>addRoute(Re,Le,Oe||"all");for(const Re of Tu)qe[Re]=(Le,Oe)=>qe.add(Le,Oe,Re);const matchHandler=(Re="/",Oe="get")=>{const qe=Re.indexOf("?");-1!==qe&&(Re=Re.slice(0,Math.max(0,qe)));const Ct=Le.lookup(Re);if(!Ct||!Ct.handlers)return{error:createError$2({statusCode:404,name:"Not Found",statusMessage:`Cannot find any route matching ${Re||"/"}.`})};let Ot=Ct.handlers[Oe]||Ct.handlers.all;if(!Ot){Ue||(Ue=toRouteMatcher(Le));const qe=Ue.matchAll(Re).reverse();for(const Re of qe){if(Re.handlers[Oe]){Ot=Re.handlers[Oe],Ct.handlers[Oe]=Ct.handlers[Oe]||Ot;break}if(Re.handlers.all){Ot=Re.handlers.all,Ct.handlers.all=Ct.handlers.all||Ot;break}}}return Ot?{matched:Ct,handler:Ot}:{error:createError$2({statusCode:405,name:"Method Not Allowed",statusMessage:`Method ${Oe} is not allowed on this route.`})}},Ct=Re.preemptive||Re.preemtive;return qe.handler=xu((Re=>{const Le=matchHandler(Re.path,Re.method.toLowerCase());if("error"in Le){if(Ct)throw Le.error;return}Re.context.matchedRoute=Le.matched;const Oe=Le.matched.params||{};return Re.context.params=Oe,Promise.resolve(Le.handler(Re)).then((Re=>void 0===Re&&Ct?null:Re))})),qe.handler.__resolve__=async Re=>{Re=withLeadingSlash$1(Re);const Le=matchHandler(Re);if("error"in Le)return;let Oe={route:Le.matched.path,handler:Le.handler};if(Le.handler.__resolve__){const Ue=await Le.handler.__resolve__(Re);if(!Ue)return;Oe={...Oe,...Ue}}return Oe},qe}({preemptive:!0}),qe=(Ct=toNodeListener(Oe),function(Re){const Le=new IncomingMessage,Oe=new ServerResponse(Le);if(Le.url=Re.url||"/",Le.method=Re.method||"GET",Le.headers={},Re.headers){const Oe="function"==typeof Re.headers.entries?Re.headers.entries():Object.entries(Re.headers);for(const[Re,Ue]of Oe)Ue&&(Le.headers[Re.toLowerCase()]=Ue)}return Le.headers.host=Le.headers.host||Re.host||"localhost",Le.connection.encrypted=Le.connection.encrypted||"https"===Re.protocol,Le.body=Re.body||null,Le.__unenv__=Re.context,Ct(Le,Oe).then((()=>{let Re=Oe._data;(eh.has(Oe.statusCode)||"HEAD"===Le.method.toUpperCase())&&(Re=null,delete Oe._headers["content-length"]);const Ue={body:Re,headers:Oe._headers,status:Oe.statusCode,statusText:Oe.statusMessage};return Le.destroy(),Oe.destroy(),Ue}))});var Ct;const Ot=function(Re,Le=global.fetch){return async function(Oe,Ue){const qe=Oe.toString();if(!qe.startsWith("/"))return Le(qe,Ue);try{const Le=await Re({url:qe,...Ue});return new Response(Le.body,{status:Le.status,statusText:Le.statusText,headers:Object.fromEntries(Object.entries(Le.headers).map((([Re,Le])=>[Re,Array.isArray(Le)?Le.join(","):String(Le)||""])))})}catch(Re){return new Response(Re.toString(),{status:Number.parseInt(Re.statusCode||Re.code)||500,statusText:Re.statusText})}}}(qe,globalThis.fetch),localFetch=(Re,Le)=>Ot(Re,Le).then((Re=>function(Re){return Re.headers.has("set-cookie")?new Response(Re.body,{status:Re.status,statusText:Re.statusText,headers:normalizeCookieHeaders(Re.headers)}):Re}(Re))),Jt=createFetch$1({fetch:localFetch,Headers:Ku,defaults:{baseURL:Re.app.baseURL}});globalThis.$fetch=Jt,Oe.use(createRouteRulesHandler({localFetch:localFetch})),Oe.use(xu((Re=>{Re.context.nitro=Re.context.nitro||{errors:[]};const Le=Re.node.req?.__unenv__;Le&&Object.assign(Re.context,Le),Re.fetch=(Le,Oe)=>fetchWithEvent(Re,Le,Oe,{fetch:localFetch}),Re.$fetch=(Le,Oe)=>fetchWithEvent(Re,Le,Oe,{fetch:Jt}),Re.waitUntil=Oe=>{Re.context.nitro._waitUntilPromises||(Re.context.nitro._waitUntilPromises=[]),Re.context.nitro._waitUntilPromises.push(Oe),Le?.waitUntil&&Le.waitUntil(Oe)},Re.captureError=(Le,Oe)=>{captureError(Le,{event:Re,...Oe})}})));for(const Le of gv){let qe=Le.lazy?lazyEventHandler(Le.handler):Le.handler;if(Le.middleware||!Le.route){const Ue=(Re.app.baseURL+(Le.route||"/")).replace(/\/+/g,"/");Oe.use(Ue,qe)}else{const Re=getRouteRulesForPath(Le.route.replace(/:\w+|\*\*/g,"_"));Re.cache&&(qe=cachedEventHandler(qe,{group:"nitro/routes",...Re.cache})),Ue.use(Le.route,qe,Le.method)}}Oe.use(Re.app.baseURL,Ue.handler);const Hr={hooks:Le,h3App:Oe,router:Ue,localCall:qe,localFetch:localFetch,captureError:captureError};for(const Re of mv)try{Re(Hr)}catch(Re){throw captureError(Re,{tags:["plugin"]}),Re}return Hr}(),useNitroApp=()=>_v;async function handleEvent(Re,Le){const Oe=new URL(Re.url);let Ue;return Re.body&&(Ue=await Re.arrayBuffer()),_v.localFetch(Oe.pathname+Oe.search,{host:Oe.hostname,protocol:Oe.protocol,headers:Re.headers,method:Re.method,body:Ue,context:{vercel:{event:Le}}})}const yv={appName:"Nuxt",version:"",statusCode:500,statusMessage:"Server error",description:"This page is temporarily unavailable."},vv=Object.freeze(Object.defineProperty({__proto__:null,template:Re=>'<!DOCTYPE html><html lang="en"><head><title>'+(Re={...yv,...Re}).statusCode+" - "+Re.statusMessage+" | "+Re.appName+'</title><meta charset="utf-8"><meta content="width=device-width,initial-scale=1.0,minimum-scale=1.0" name="viewport"><style>.spotlight{background:linear-gradient(45deg,#00dc82,#36e4da 50%,#0047e1);filter:blur(20vh)}*,:after,:before{border-color:var(--un-default-border-color,#e5e7eb);border-style:solid;border-width:0;box-sizing:border-box}:after,:before{--un-content:""}html{line-height:1.5;-webkit-text-size-adjust:100%;font-family:ui-sans-serif,system-ui,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;font-feature-settings:normal;font-variation-settings:normal;-moz-tab-size:4;tab-size:4;-webkit-tap-highlight-color:transparent}body{line-height:inherit;margin:0}h1{font-size:inherit;font-weight:inherit}h1,p{margin:0}*,:after,:before{--un-rotate:0;--un-rotate-x:0;--un-rotate-y:0;--un-rotate-z:0;--un-scale-x:1;--un-scale-y:1;--un-scale-z:1;--un-skew-x:0;--un-skew-y:0;--un-translate-x:0;--un-translate-y:0;--un-translate-z:0;--un-pan-x: ;--un-pan-y: ;--un-pinch-zoom: ;--un-scroll-snap-strictness:proximity;--un-ordinal: ;--un-slashed-zero: ;--un-numeric-figure: ;--un-numeric-spacing: ;--un-numeric-fraction: ;--un-border-spacing-x:0;--un-border-spacing-y:0;--un-ring-offset-shadow:0 0 transparent;--un-ring-shadow:0 0 transparent;--un-shadow-inset: ;--un-shadow:0 0 transparent;--un-ring-inset: ;--un-ring-offset-width:0px;--un-ring-offset-color:#fff;--un-ring-width:0px;--un-ring-color:rgba(147,197,253,.5);--un-blur: ;--un-brightness: ;--un-contrast: ;--un-drop-shadow: ;--un-grayscale: ;--un-hue-rotate: ;--un-invert: ;--un-saturate: ;--un-sepia: ;--un-backdrop-blur: ;--un-backdrop-brightness: ;--un-backdrop-contrast: ;--un-backdrop-grayscale: ;--un-backdrop-hue-rotate: ;--un-backdrop-invert: ;--un-backdrop-opacity: ;--un-backdrop-saturate: ;--un-backdrop-sepia: }.fixed{position:fixed}.-bottom-1\\/2{bottom:-50%}.left-0{left:0}.right-0{right:0}.grid{display:grid}.mb-16{margin-bottom:4rem}.mb-8{margin-bottom:2rem}.h-1\\/2{height:50%}.max-w-520px{max-width:520px}.min-h-screen{min-height:100vh}.place-content-center{place-content:center}.overflow-hidden{overflow:hidden}.bg-white{--un-bg-opacity:1;background-color:rgb(255 255 255/var(--un-bg-opacity))}.px-8{padding-left:2rem;padding-right:2rem}.text-center{text-align:center}.text-8xl{font-size:6rem;line-height:1}.text-xl{font-size:1.25rem;line-height:1.75rem}.text-black{--un-text-opacity:1;color:rgb(0 0 0/var(--un-text-opacity))}.font-light{font-weight:300}.font-medium{font-weight:500}.leading-tight{line-height:1.25}.font-sans{font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji}.antialiased{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}@media (prefers-color-scheme:dark){.dark\\:bg-black{--un-bg-opacity:1;background-color:rgb(0 0 0/var(--un-bg-opacity))}.dark\\:text-white{--un-text-opacity:1;color:rgb(255 255 255/var(--un-text-opacity))}}@media (min-width:640px){.sm\\:px-0{padding-left:0;padding-right:0}.sm\\:text-4xl{font-size:2.25rem;line-height:2.5rem}}</style><script>!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll(\'link[rel="modulepreload"]\'))r(e);new MutationObserver((e=>{for(const o of e)if("childList"===o.type)for(const e of o.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&r(e)})).observe(document,{childList:!0,subtree:!0})}function r(e){if(e.ep)return;e.ep=!0;const r=function(e){const r={};return e.integrity&&(r.integrity=e.integrity),e.referrerPolicy&&(r.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?r.credentials="include":"anonymous"===e.crossOrigin?r.credentials="omit":r.credentials="same-origin",r}(e);fetch(e.href,r)}}();<\/script></head><body class="antialiased bg-white dark:bg-black dark:text-white font-sans grid min-h-screen overflow-hidden place-content-center text-black"><div class="-bottom-1/2 fixed h-1/2 left-0 right-0 spotlight"></div><div class="max-w-520px text-center"><h1 class="font-medium mb-8 sm:text-10xl text-8xl">'+Re.statusCode+'</h1><p class="font-light leading-tight mb-16 px-8 sm:px-0 sm:text-4xl text-xl">'+Re.description+"</p></div></body></html>"},Symbol.toStringTag,{value:"Module"}));function getModuleDependencies(Re,Le){if(Le._dependencies[Re])return Le._dependencies[Re];const Oe=Le._dependencies[Re]={scripts:{},styles:{},preload:{},prefetch:{}},Ue=Le.manifest[Re];if(!Ue)return Oe;Ue.file&&(Oe.preload[Re]=Ue,(Ue.isEntry||Ue.sideEffects)&&(Oe.scripts[Re]=Ue));for(const Re of Ue.css||[])Oe.styles[Re]=Oe.preload[Re]=Oe.prefetch[Re]=Le.manifest[Re];for(const Re of Ue.assets||[])Oe.preload[Re]=Oe.prefetch[Re]=Le.manifest[Re];for(const Re of Ue.imports||[]){const Ue=getModuleDependencies(Re,Le);Object.assign(Oe.styles,Ue.styles),Object.assign(Oe.preload,Ue.preload),Object.assign(Oe.prefetch,Ue.prefetch)}const qe={};for(const Re in Oe.preload){const Le=Oe.preload[Re];Le.preload&&(qe[Re]=Le)}return Oe.preload=qe,Oe}function getRequestDependencies(Re,Le){if(Re._requestDependencies)return Re._requestDependencies;const Oe=function(Re,Le){const Oe=Array.from(Re).sort().join(",");if(Le._dependencySets[Oe])return Le._dependencySets[Oe];const Ue={scripts:{},styles:{},preload:{},prefetch:{}};for(const Oe of Re){const Re=getModuleDependencies(Oe,Le);Object.assign(Ue.scripts,Re.scripts),Object.assign(Ue.styles,Re.styles),Object.assign(Ue.preload,Re.preload),Object.assign(Ue.prefetch,Re.prefetch);for(const Re of Le.manifest[Oe]?.dynamicImports||[]){const Oe=getModuleDependencies(Re,Le);Object.assign(Ue.prefetch,Oe.scripts),Object.assign(Ue.prefetch,Oe.styles),Object.assign(Ue.prefetch,Oe.preload)}}const qe={};for(const Re in Ue.prefetch){const Le=Ue.prefetch[Re];Le.prefetch&&(qe[Re]=Le)}Ue.prefetch=qe;for(const Re in Ue.preload)delete Ue.prefetch[Re];for(const Re in Ue.styles)delete Ue.preload[Re],delete Ue.prefetch[Re];return Le._dependencySets[Oe]=Ue,Ue}(new Set(Array.from([...Le._entrypoints,...Re.modules||Re._registeredComponents||[]])),Le);return Re._requestDependencies=Oe,Oe}function renderStyles(Re,Le){const{styles:Oe}=getRequestDependencies(Re,Le);return Object.values(Oe).map((Re=>renderLinkToString({rel:"stylesheet",href:Le.buildAssetsURL(Re.file),crossorigin:""}))).join("")}function getResources(Re,Le){return[...getPreloadLinks(Re,Le),...getPrefetchLinks(Re,Le)]}function renderResourceHints(Re,Le){return getResources(Re,Le).map(renderLinkToString).join("")}function renderResourceHeaders(Re,Le){return{link:getResources(Re,Le).map(renderLinkToHeader).join(", ")}}function getPreloadLinks(Re,Le){const{preload:Oe}=getRequestDependencies(Re,Le);return Object.values(Oe).map((Re=>({rel:Re.module?"modulepreload":"preload",as:Re.resourceType,type:Re.mimeType??null,crossorigin:"style"===Re.resourceType||"font"===Re.resourceType||"script"===Re.resourceType||Re.module?"":null,href:Le.buildAssetsURL(Re.file)})))}function getPrefetchLinks(Re,Le){const{prefetch:Oe}=getRequestDependencies(Re,Le);return Object.values(Oe).map((Re=>({rel:"prefetch",as:Re.resourceType,type:Re.mimeType??null,crossorigin:"style"===Re.resourceType||"font"===Re.resourceType||"script"===Re.resourceType||Re.module?"":null,href:Le.buildAssetsURL(Re.file)})))}function renderScripts(Re,Le){const{scripts:Oe}=getRequestDependencies(Re,Le);return Object.values(Oe).map((Re=>{return Oe={type:Re.module?"module":null,src:Le.buildAssetsURL(Re.file),defer:Re.module?null:"",crossorigin:""},`<script${Object.entries(Oe).map((([Re,Le])=>null===Le?"":Le?` ${Re}="${Le}"`:" "+Re)).join("")}><\/script>`;var Oe})).join("")}function createRenderer$1(Re,Le){const Oe=function({manifest:Re,buildAssetsURL:Le}){const Oe={buildAssetsURL:Le||withLeadingSlash$1,manifest:void 0,updateManifest:updateManifest,_dependencies:void 0,_dependencySets:void 0,_entrypoints:void 0};function updateManifest(Re){const Le=Object.entries(Re);Oe.manifest=Re,Oe._dependencies={},Oe._dependencySets={},Oe._entrypoints=Le.filter((Re=>Re[1].isEntry)).map((([Re])=>Re))}return updateManifest(Re),Oe}(Le);return{rendererContext:Oe,async renderToString(Ue){Ue._registeredComponents=Ue._registeredComponents||new Set;const qe=await Promise.resolve(Re).then((Re=>"default"in Re?Re.default:Re)),Ct=await qe(Ue),wrap=Re=>()=>Re(Ue,Oe);return{html:await Le.renderToString(Ct,Ue),renderResourceHeaders:wrap(renderResourceHeaders),renderResourceHints:wrap(renderResourceHints),renderStyles:wrap(renderStyles),renderScripts:wrap(renderScripts)}}}}function renderLinkToString(Re){return`<link${Object.entries(Re).map((([Re,Le])=>null===Le?"":Le?` ${Re}="${Le}"`:" "+Re)).join("")}>`}function renderLinkToHeader(Re){return`<${Re.href}>${Object.entries(Re).map((([Re,Le])=>"href"===Re||null===Le?"":Le?`; ${Re}="${Le}"`:`; ${Re}`)).join("")}`}const xv={"<":"\\u003C","\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\u2028":"\\u2028","\u2029":"\\u2029"};class DevalueError extends Error{constructor(Re,Le){super(Re),this.name="DevalueError",this.path=Le.join("")}}function is_primitive(Re){return Object(Re)!==Re}const bv=Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function is_plain_object(Re){const Le=Object.getPrototypeOf(Re);return Le===Object.prototype||null===Le||Object.getOwnPropertyNames(Le).sort().join("\0")===bv}function get_type(Re){return Object.prototype.toString.call(Re).slice(8,-1)}function get_escaped_char(Re){switch(Re){case'"':return'\\"';case"<":return"\\u003C";case"\\":return"\\\\";case"\n":return"\\n";case"\r":return"\\r";case"\t":return"\\t";case"\b":return"\\b";case"\f":return"\\f";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:return Re<" "?`\\u${Re.charCodeAt(0).toString(16).padStart(4,"0")}`:""}}function stringify_string(Re){let Le="",Oe=0;const Ue=Re.length;for(let qe=0;qe<Ue;qe+=1){const Ue=get_escaped_char(Re[qe]);Ue&&(Le+=Re.slice(Oe,qe)+Ue,Oe=qe+1)}return`"${0===Oe?Re:Le+Re.slice(Oe)}"`}function enumerable_symbols(Re){return Object.getOwnPropertySymbols(Re).filter((Le=>Object.getOwnPropertyDescriptor(Re,Le).enumerable))}const wv=/^[a-zA-Z_$][a-zA-Z_$0-9]*$/;function stringify_key(Re){return wv.test(Re)?"."+Re:"["+JSON.stringify(Re)+"]"}const Tv="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_$",Sv=/[<\b\f\n\r\t\0\u2028\u2029]/g,Ev=/^(?:do|if|in|for|int|let|new|try|var|byte|case|char|else|enum|goto|long|this|void|with|await|break|catch|class|const|final|float|short|super|throw|while|yield|delete|double|export|import|native|return|switch|throws|typeof|boolean|default|extends|finally|package|private|abstract|continue|debugger|function|volatile|interface|protected|transient|implements|instanceof|synchronized)$/;function uneval(Re,Le){const Oe=new Map,Ue=[],qe=new Map;!function walk(Re){if("function"==typeof Re)throw new DevalueError("Cannot stringify a function",Ue);if(!is_primitive(Re)){if(Oe.has(Re))return void Oe.set(Re,Oe.get(Re)+1);Oe.set(Re,1);switch(get_type(Re)){case"Number":case"BigInt":case"String":case"Boolean":case"Date":case"RegExp":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"BigInt64Array":case"BigUint64Array":case"ArrayBuffer":return;case"Array":Re.forEach(((Re,Le)=>{Ue.push(`[${Le}]`),walk(Re),Ue.pop()}));break;case"Set":Array.from(Re).forEach(walk);break;case"Map":for(const[Le,Oe]of Re)Ue.push(`.get(${is_primitive(Le)?stringify_primitive$1(Le):"..."})`),walk(Oe),Ue.pop();break;default:if(!is_plain_object(Re))throw new DevalueError("Cannot stringify arbitrary non-POJOs",Ue);if(enumerable_symbols(Re).length>0)throw new DevalueError("Cannot stringify POJOs with symbolic keys",Ue);for(const Le in Re)Ue.push(stringify_key(Le)),walk(Re[Le]),Ue.pop()}}}(Re);const Ct=new Map;function stringify(Re){if(Ct.has(Re))return Ct.get(Re);if(is_primitive(Re))return stringify_primitive$1(Re);if(qe.has(Re))return qe.get(Re);const Le=get_type(Re);switch(Le){case"Number":case"String":case"Boolean":return`Object(${stringify(Re.valueOf())})`;case"RegExp":return`new RegExp(${stringify_string(Re.source)}, "${Re.flags}")`;case"Date":return`new Date(${Re.getTime()})`;case"Array":const Oe=Re.map(((Le,Oe)=>Oe in Re?stringify(Le):"")),Ue=0===Re.length||Re.length-1 in Re?"":",";return`[${Oe.join(",")}${Ue}]`;case"Set":case"Map":return`new ${Le}([${Array.from(Re).map(stringify).join(",")}])`;case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"BigInt64Array":case"BigUint64Array":return`new ${Le}([${Re.toString()}])`;case"ArrayBuffer":return`new Uint8Array([${new Uint8Array(Re).toString()}]).buffer`;default:const qe=`{${Object.keys(Re).map((Le=>`${function(Re){return/^[_$a-zA-Z][_$a-zA-Z0-9]*$/.test(Re)?Re:escape_unsafe_chars(JSON.stringify(Re))}(Le)}:${stringify(Re[Le])}`)).join(",")}}`;return null===Object.getPrototypeOf(Re)?Object.keys(Re).length>0?`Object.assign(Object.create(null),${qe})`:"Object.create(null)":qe}}Array.from(Oe).filter((Re=>Re[1]>1)).sort(((Re,Le)=>Le[1]-Re[1])).forEach(((Re,Le)=>{Ct.set(Re[0],function(Re){let Le="";do{Le=Tv[Re%54]+Le,Re=~~(Re/54)-1}while(Re>=0);return Ev.test(Le)?`${Le}0`:Le}(Le))}));const Ot=stringify(Re);if(Ct.size){const Re=[],Le=[],Oe=[];return Ct.forEach(((Ue,Ct)=>{if(Re.push(Ue),qe.has(Ct))return void Oe.push(qe.get(Ct));if(is_primitive(Ct))return void Oe.push(stringify_primitive$1(Ct));switch(get_type(Ct)){case"Number":case"String":case"Boolean":Oe.push(`Object(${stringify(Ct.valueOf())})`);break;case"RegExp":Oe.push(Ct.toString());break;case"Date":Oe.push(`new Date(${Ct.getTime()})`);break;case"Array":Oe.push(`Array(${Ct.length})`),Ct.forEach(((Re,Oe)=>{Le.push(`${Ue}[${Oe}]=${stringify(Re)}`)}));break;case"Set":Oe.push("new Set"),Le.push(`${Ue}.${Array.from(Ct).map((Re=>`add(${stringify(Re)})`)).join(".")}`);break;case"Map":Oe.push("new Map"),Le.push(`${Ue}.${Array.from(Ct).map((([Re,Le])=>`set(${stringify(Re)}, ${stringify(Le)})`)).join(".")}`);break;default:Oe.push(null===Object.getPrototypeOf(Ct)?"Object.create(null)":"{}"),Object.keys(Ct).forEach((Re=>{Le.push(`${Ue}${function(Re){return/^[_$a-zA-Z][_$a-zA-Z0-9]*$/.test(Re)?`.${Re}`:`[${escape_unsafe_chars(JSON.stringify(Re))}]`}(Re)}=${stringify(Ct[Re])}`)}))}})),Le.push(`return ${Ot}`),`(function(${Re.join(",")}){${Le.join(";")}}(${Oe.join(",")}))`}return Ot}function escape_unsafe_char(Re){return xv[Re]||Re}function escape_unsafe_chars(Re){return Re.replace(Sv,escape_unsafe_char)}function stringify_primitive$1(Re){if("string"==typeof Re)return stringify_string(Re);if(void 0===Re)return"void 0";if(0===Re&&1/Re<0)return"-0";const Le=String(Re);return"number"==typeof Re?Le.replace(/^(-)?0\./,"$1."):"bigint"==typeof Re?Re+"n":Le}function encode64(Re){const Le=new DataView(Re);let Oe="";for(let Ue=0;Ue<Re.byteLength;Ue++)Oe+=String.fromCharCode(Le.getUint8(Ue));return function(Re){let Le="";for(let Oe=0;Oe<Re.length;Oe+=3){const Ue=[void 0,void 0,void 0,void 0];Ue[0]=Re.charCodeAt(Oe)>>2,Ue[1]=(3&Re.charCodeAt(Oe))<<4,Re.length>Oe+1&&(Ue[1]|=Re.charCodeAt(Oe+1)>>4,Ue[2]=(15&Re.charCodeAt(Oe+1))<<2),Re.length>Oe+2&&(Ue[2]|=Re.charCodeAt(Oe+2)>>6,Ue[3]=63&Re.charCodeAt(Oe+2));for(let Re=0;Re<Ue.length;Re++)void 0===Ue[Re]?Le+="=":Le+=Cv[Ue[Re]]}return Le}(Oe)}const Cv="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function stringify(Re,Le){const Oe=[],Ue=new Map,qe=[];if(Le)for(const Re of Object.getOwnPropertyNames(Le))qe.push({key:Re,fn:Le[Re]});const Ct=[];let Ot=0;const Jt=function flatten(Re){if("function"==typeof Re)throw new DevalueError("Cannot stringify a function",Ct);if(Ue.has(Re))return Ue.get(Re);if(void 0===Re)return-1;if(Number.isNaN(Re))return-3;if(Re===1/0)return-4;if(Re===-1/0)return-5;if(0===Re&&1/Re<0)return-6;const Le=Ot++;Ue.set(Re,Le);for(const{key:Ue,fn:Ct}of qe){const qe=Ct(Re);if(qe)return Oe[Le]=`["${Ue}",${flatten(qe)}]`,Le}let Jt="";if(is_primitive(Re))Jt=stringify_primitive(Re);else{const Le=get_type(Re);switch(Le){case"Number":case"String":case"Boolean":Jt=`["Object",${stringify_primitive(Re)}]`;break;case"BigInt":Jt=`["BigInt",${Re}]`;break;case"Date":Jt=`["Date","${!isNaN(Re.getDate())?Re.toISOString():""}"]`;break;case"RegExp":const{source:Oe,flags:Ue}=Re;Jt=Ue?`["RegExp",${stringify_string(Oe)},"${Ue}"]`:`["RegExp",${stringify_string(Oe)}]`;break;case"Array":Jt="[";for(let Le=0;Le<Re.length;Le+=1)Le>0&&(Jt+=","),Le in Re?(Ct.push(`[${Le}]`),Jt+=flatten(Re[Le]),Ct.pop()):Jt+=-2;Jt+="]";break;case"Set":Jt='["Set"';for(const Le of Re)Jt+=`,${flatten(Le)}`;Jt+="]";break;case"Map":Jt='["Map"';for(const[Le,Oe]of Re)Ct.push(`.get(${is_primitive(Le)?stringify_primitive(Le):"..."})`),Jt+=`,${flatten(Le)},${flatten(Oe)}`,Ct.pop();Jt+="]";break;case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"BigInt64Array":case"BigUint64Array":Jt='["'+Le+'","'+encode64(Re.buffer)+'"]';break;case"ArrayBuffer":Jt=`["ArrayBuffer","${encode64(Re)}"]`;break;default:if(!is_plain_object(Re))throw new DevalueError("Cannot stringify arbitrary non-POJOs",Ct);if(enumerable_symbols(Re).length>0)throw new DevalueError("Cannot stringify POJOs with symbolic keys",Ct);if(null===Object.getPrototypeOf(Re)){Jt='["null"';for(const Le in Re)Ct.push(stringify_key(Le)),Jt+=`,${stringify_string(Le)},${flatten(Re[Le])}`,Ct.pop();Jt+="]"}else{Jt="{";let Le=!1;for(const Oe in Re)Le&&(Jt+=","),Le=!0,Ct.push(stringify_key(Oe)),Jt+=`${stringify_string(Oe)}:${flatten(Re[Oe])}`,Ct.pop();Jt+="}"}}}return Oe[Le]=Jt,Le}(Re);return Jt<0?`${Jt}`:`[${Oe.join(",")}]`}function stringify_primitive(Re){const Le=typeof Re;return"string"===Le?stringify_string(Re):Re instanceof String?stringify_string(Re.toString()):void 0===Re?(-1).toString():0===Re&&1/Re<0?(-6).toString():"bigint"===Le?`["BigInt","${Re}"]`:String(Re)}function makeMap(Re){const Le=Object.create(null);for(const Oe of Re.split(","))Le[Oe]=1;return Re=>Re in Le}const Av={},Iv=[],NOOP=()=>{},NO=()=>!1,isOn=Re=>111===Re.charCodeAt(0)&&110===Re.charCodeAt(1)&&(Re.charCodeAt(2)>122||Re.charCodeAt(2)<97),isModelListener=Re=>Re.startsWith("onUpdate:"),kv=Object.assign,remove=(Re,Le)=>{const Oe=Re.indexOf(Le);Oe>-1&&Re.splice(Oe,1)},Mv=Object.prototype.hasOwnProperty,hasOwn$1=(Re,Le)=>Mv.call(Re,Le),Pv=Array.isArray,isMap=Re=>"[object Map]"===toTypeString$1(Re),isSet=Re=>"[object Set]"===toTypeString$1(Re),isFunction$1=Re=>"function"==typeof Re,isString$1=Re=>"string"==typeof Re,isSymbol$1=Re=>"symbol"==typeof Re,isObject$4=Re=>null!==Re&&"object"==typeof Re,isPromise$1=Re=>(isObject$4(Re)||isFunction$1(Re))&&isFunction$1(Re.then)&&isFunction$1(Re.catch),Rv=Object.prototype.toString,toTypeString$1=Re=>Rv.call(Re),isPlainObject$1=Re=>"[object Object]"===toTypeString$1(Re),isIntegerKey=Re=>isString$1(Re)&&"NaN"!==Re&&"-"!==Re[0]&&""+parseInt(Re,10)===Re,Lv=makeMap(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),cacheStringFunction=Re=>{const Le=Object.create(null);return Oe=>Le[Oe]||(Le[Oe]=Re(Oe))},Ov=/-(\w)/g,zv=cacheStringFunction((Re=>Re.replace(Ov,((Re,Le)=>Le?Le.toUpperCase():"")))),Dv=/\B([A-Z])/g,Bv=cacheStringFunction((Re=>Re.replace(Dv,"-$1").toLowerCase())),Fv=cacheStringFunction((Re=>Re.charAt(0).toUpperCase()+Re.slice(1))),Nv=cacheStringFunction((Re=>Re?`on${Fv(Re)}`:"")),hasChanged=(Re,Le)=>!Object.is(Re,Le),invokeArrayFns=(Re,...Le)=>{for(let Oe=0;Oe<Re.length;Oe++)Re[Oe](...Le)},def=(Re,Le,Oe,Ue=!1)=>{Object.defineProperty(Re,Le,{configurable:!0,enumerable:!1,writable:Ue,value:Oe})},looseToNumber=Re=>{const Le=parseFloat(Re);return isNaN(Le)?Re:Le},toNumber=Re=>{const Le=isString$1(Re)?Number(Re):NaN;return isNaN(Le)?Re:Le};let jv;const getGlobalThis=()=>jv||(jv="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof global?global:{});function normalizeStyle(Re){if(Pv(Re)){const Le={};for(let Oe=0;Oe<Re.length;Oe++){const Ue=Re[Oe],qe=isString$1(Ue)?parseStringStyle(Ue):normalizeStyle(Ue);if(qe)for(const Re in qe)Le[Re]=qe[Re]}return Le}if(isString$1(Re)||isObject$4(Re))return Re}const Uv=/;(?![^(]*\))/g,Vv=/:([^]+)/,$v=/\/\*[^]*?\*\//g;function parseStringStyle(Re){const Le={};return Re.replace($v,"").split(Uv).forEach((Re=>{if(Re){const Oe=Re.split(Vv);Oe.length>1&&(Le[Oe[0].trim()]=Oe[1].trim())}})),Le}function normalizeClass(Re){let Le="";if(isString$1(Re))Le=Re;else if(Pv(Re))for(let Oe=0;Oe<Re.length;Oe++){const Ue=normalizeClass(Re[Oe]);Ue&&(Le+=Ue+" ")}else if(isObject$4(Re))for(const Oe in Re)Re[Oe]&&(Le+=Oe+" ");return Le.trim()}const Gv=makeMap("svg,animate,animateMotion,animateTransform,circle,clipPath,color-profile,defs,desc,discard,ellipse,feBlend,feColorMatrix,feComponentTransfer,feComposite,feConvolveMatrix,feDiffuseLighting,feDisplacementMap,feDistantLight,feDropShadow,feFlood,feFuncA,feFuncB,feFuncG,feFuncR,feGaussianBlur,feImage,feMerge,feMergeNode,feMorphology,feOffset,fePointLight,feSpecularLighting,feSpotLight,feTile,feTurbulence,filter,foreignObject,g,hatch,hatchpath,image,line,linearGradient,marker,mask,mesh,meshgradient,meshpatch,meshrow,metadata,mpath,path,pattern,polygon,polyline,radialGradient,rect,set,solidcolor,stop,switch,symbol,text,textPath,title,tspan,unknown,use,view"),qv=makeMap("area,base,br,col,embed,hr,img,input,link,meta,param,source,track,wbr"),Hv="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Wv=makeMap(Hv),Zv=makeMap(Hv+",async,autofocus,autoplay,controls,default,defer,disabled,hidden,inert,loop,open,required,reversed,scoped,seamless,checked,muted,multiple,selected");function includeBooleanAttr(Re){return!!Re||""===Re}const Xv=/[>/="'\u0009\u000a\u000c\u0020]/,Yv={};const Kv={acceptCharset:"accept-charset",className:"class",htmlFor:"for",httpEquiv:"http-equiv"};function isRenderableAttrValue(Re){if(null==Re)return!1;const Le=typeof Re;return"string"===Le||"number"===Le||"boolean"===Le}const Jv=/["'&<>]/;function escapeHtml$2(Re){const Le=""+Re,Oe=Jv.exec(Le);if(!Oe)return Le;let Ue,qe,Ct="",Ot=0;for(qe=Oe.index;qe<Le.length;qe++){switch(Le.charCodeAt(qe)){case 34:Ue="&quot;";break;case 38:Ue="&amp;";break;case 39:Ue="&#39;";break;case 60:Ue="&lt;";break;case 62:Ue="&gt;";break;default:continue}Ot!==qe&&(Ct+=Le.slice(Ot,qe)),Ot=qe+1,Ct+=Ue}return Ot!==qe?Ct+Le.slice(Ot,qe):Ct}const Qv=/^-?>|<!--|-->|--!>|<!-$/g;const isRef$1=Re=>!(!Re||!0!==Re.__v_isRef),toDisplayString$1=Re=>isString$1(Re)?Re:null==Re?"":Pv(Re)||isObject$4(Re)&&(Re.toString===Rv||!isFunction$1(Re.toString))?isRef$1(Re)?toDisplayString$1(Re.value):JSON.stringify(Re,replacer,2):String(Re),replacer=(Re,Le)=>isRef$1(Le)?replacer(Re,Le.value):isMap(Le)?{[`Map(${Le.size})`]:[...Le.entries()].reduce(((Re,[Le,Oe],Ue)=>(Re[stringifySymbol(Le,Ue)+" =>"]=Oe,Re)),{})}:isSet(Le)?{[`Set(${Le.size})`]:[...Le.values()].map((Re=>stringifySymbol(Re)))}:isSymbol$1(Le)?stringifySymbol(Le):!isObject$4(Le)||Pv(Le)||isPlainObject$1(Le)?Le:String(Le),stringifySymbol=(Re,Le="")=>{var Oe;return isSymbol$1(Re)?`Symbol(${null!=(Oe=Re.description)?Oe:Le})`:Re};let cx,mx;class EffectScope{constructor(Re=!1){this.detached=Re,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=cx,!Re&&cx&&(this.index=(cx.scopes||(cx.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){let Re,Le;if(this._isPaused=!0,this.scopes)for(Re=0,Le=this.scopes.length;Re<Le;Re++)this.scopes[Re].pause();for(Re=0,Le=this.effects.length;Re<Le;Re++)this.effects[Re].pause()}}resume(){if(this._active&&this._isPaused){let Re,Le;if(this._isPaused=!1,this.scopes)for(Re=0,Le=this.scopes.length;Re<Le;Re++)this.scopes[Re].resume();for(Re=0,Le=this.effects.length;Re<Le;Re++)this.effects[Re].resume()}}run(Re){if(this._active){const Le=cx;try{return cx=this,Re()}finally{cx=Le}}}on(){cx=this}off(){cx=this.parent}stop(Re){if(this._active){let Le,Oe;for(Le=0,Oe=this.effects.length;Le<Oe;Le++)this.effects[Le].stop();for(Le=0,Oe=this.cleanups.length;Le<Oe;Le++)this.cleanups[Le]();if(this.scopes)for(Le=0,Oe=this.scopes.length;Le<Oe;Le++)this.scopes[Le].stop(!0);if(!this.detached&&this.parent&&!Re){const Re=this.parent.scopes.pop();Re&&Re!==this&&(this.parent.scopes[this.index]=Re,Re.index=this.index)}this.parent=void 0,this._active=!1}}}function effectScope(Re){return new EffectScope(Re)}function getCurrentScope(){return cx}const _x=new WeakSet;class ReactiveEffect{constructor(Re){this.fn=Re,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,cx&&cx.active&&cx.effects.push(this)}pause(){this.flags|=64}resume(){64&this.flags&&(this.flags&=-65,_x.has(this)&&(_x.delete(this),this.trigger()))}notify(){2&this.flags&&!(32&this.flags)||8&this.flags||batch(this)}run(){if(!(1&this.flags))return this.fn();this.flags|=2,cleanupEffect(this),prepareDeps(this);const Re=mx,Le=Cx;mx=this,Cx=!0;try{return this.fn()}finally{cleanupDeps(this),mx=Re,Cx=Le,this.flags&=-3}}stop(){if(1&this.flags){for(let Re=this.deps;Re;Re=Re.nextDep)removeSub(Re);this.deps=this.depsTail=void 0,cleanupEffect(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){64&this.flags?_x.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){isDirty(this)&&this.run()}get dirty(){return isDirty(this)}}let Tx,Sx,Ex=0;function batch(Re,Le=!1){if(Re.flags|=8,Le)return Re.next=Sx,void(Sx=Re);Re.next=Tx,Tx=Re}function startBatch(){Ex++}function endBatch(){if(--Ex>0)return;if(Sx){let Re=Sx;for(Sx=void 0;Re;){const Le=Re.next;Re.next=void 0,Re.flags&=-9,Re=Le}}let Re;for(;Tx;){let Le=Tx;for(Tx=void 0;Le;){const Oe=Le.next;if(Le.next=void 0,Le.flags&=-9,1&Le.flags)try{Le.trigger()}catch(Le){Re||(Re=Le)}Le=Oe}}if(Re)throw Re}function prepareDeps(Re){for(let Le=Re.deps;Le;Le=Le.nextDep)Le.version=-1,Le.prevActiveLink=Le.dep.activeLink,Le.dep.activeLink=Le}function cleanupDeps(Re){let Le,Oe=Re.depsTail,Ue=Oe;for(;Ue;){const Re=Ue.prevDep;-1===Ue.version?(Ue===Oe&&(Oe=Re),removeSub(Ue),removeDep(Ue)):Le=Ue,Ue.dep.activeLink=Ue.prevActiveLink,Ue.prevActiveLink=void 0,Ue=Re}Re.deps=Le,Re.depsTail=Oe}function isDirty(Re){for(let Le=Re.deps;Le;Le=Le.nextDep)if(Le.dep.version!==Le.version||Le.dep.computed&&(refreshComputed(Le.dep.computed)||Le.dep.version!==Le.version))return!0;return!!Re._dirty}function refreshComputed(Re){if(4&Re.flags&&!(16&Re.flags))return;if(Re.flags&=-17,Re.globalVersion===Ix)return;Re.globalVersion=Ix;const Le=Re.dep;if(Re.flags|=2,Le.version>0&&!Re.isSSR&&Re.deps&&!isDirty(Re))return void(Re.flags&=-3);const Oe=mx,Ue=Cx;mx=Re,Cx=!0;try{prepareDeps(Re);const Oe=Re.fn(Re._value);(0===Le.version||hasChanged(Oe,Re._value))&&(Re._value=Oe,Le.version++)}catch(Re){throw Le.version++,Re}finally{mx=Oe,Cx=Ue,cleanupDeps(Re),Re.flags&=-3}}function removeSub(Re,Le=!1){const{dep:Oe,prevSub:Ue,nextSub:qe}=Re;if(Ue&&(Ue.nextSub=qe,Re.prevSub=void 0),qe&&(qe.prevSub=Ue,Re.nextSub=void 0),Oe.subs===Re&&(Oe.subs=Ue,!Ue&&Oe.computed)){Oe.computed.flags&=-5;for(let Re=Oe.computed.deps;Re;Re=Re.nextDep)removeSub(Re,!0)}Le||--Oe.sc||!Oe.map||Oe.map.delete(Oe.key)}function removeDep(Re){const{prevDep:Le,nextDep:Oe}=Re;Le&&(Le.nextDep=Oe,Re.prevDep=void 0),Oe&&(Oe.prevDep=Le,Re.nextDep=void 0)}let Cx=!0;const Ax=[];function pauseTracking(){Ax.push(Cx),Cx=!1}function resetTracking(){const Re=Ax.pop();Cx=void 0===Re||Re}function cleanupEffect(Re){const{cleanup:Le}=Re;if(Re.cleanup=void 0,Le){const Re=mx;mx=void 0;try{Le()}finally{mx=Re}}}let Ix=0;class Link{constructor(Re,Le){this.sub=Re,this.dep=Le,this.version=Le.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Dep{constructor(Re){this.computed=Re,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(Re){if(!mx||!Cx||mx===this.computed)return;let Le=this.activeLink;if(void 0===Le||Le.sub!==mx)Le=this.activeLink=new Link(mx,this),mx.deps?(Le.prevDep=mx.depsTail,mx.depsTail.nextDep=Le,mx.depsTail=Le):mx.deps=mx.depsTail=Le,addSub(Le);else if(-1===Le.version&&(Le.version=this.version,Le.nextDep)){const Re=Le.nextDep;Re.prevDep=Le.prevDep,Le.prevDep&&(Le.prevDep.nextDep=Re),Le.prevDep=mx.depsTail,Le.nextDep=void 0,mx.depsTail.nextDep=Le,mx.depsTail=Le,mx.deps===Le&&(mx.deps=Re)}return Le}trigger(Re){this.version++,Ix++,this.notify(Re)}notify(Re){startBatch();try{0;for(let Re=this.subs;Re;Re=Re.prevSub)Re.sub.notify()&&Re.sub.dep.notify()}finally{endBatch()}}}function addSub(Re){if(Re.dep.sc++,4&Re.sub.flags){const Le=Re.dep.computed;if(Le&&!Re.dep.subs){Le.flags|=20;for(let Re=Le.deps;Re;Re=Re.nextDep)addSub(Re)}const Oe=Re.dep.subs;Oe!==Re&&(Re.prevSub=Oe,Oe&&(Oe.nextSub=Re)),Re.dep.subs=Re}}const kx=new WeakMap,Mx=Symbol(""),Px=Symbol(""),Rx=Symbol("");function track(Re,Le,Oe){if(Cx&&mx){let Le=kx.get(Re);Le||kx.set(Re,Le=new Map);let Ue=Le.get(Oe);Ue||(Le.set(Oe,Ue=new Dep),Ue.map=Le,Ue.key=Oe),Ue.track()}}function trigger(Re,Le,Oe,Ue,qe,Ct){const Ot=kx.get(Re);if(!Ot)return void Ix++;const run=Re=>{Re&&Re.trigger()};if(startBatch(),"clear"===Le)Ot.forEach(run);else{const qe=Pv(Re),Ct=qe&&isIntegerKey(Oe);if(qe&&"length"===Oe){const Re=Number(Ue);Ot.forEach(((Le,Oe)=>{("length"===Oe||Oe===Rx||!isSymbol$1(Oe)&&Oe>=Re)&&run(Le)}))}else switch((void 0!==Oe||Ot.has(void 0))&&run(Ot.get(Oe)),Ct&&run(Ot.get(Rx)),Le){case"add":qe?Ct&&run(Ot.get("length")):(run(Ot.get(Mx)),isMap(Re)&&run(Ot.get(Px)));break;case"delete":qe||(run(Ot.get(Mx)),isMap(Re)&&run(Ot.get(Px)));break;case"set":isMap(Re)&&run(Ot.get(Mx))}}endBatch()}function reactiveReadArray(Re){const Le=toRaw(Re);return Le===Re?Le:(track(Le,0,Rx),isShallow(Re)?Le:Le.map(toReactive))}function shallowReadArray(Re){return track(Re=toRaw(Re),0,Rx),Re}const Lx={__proto__:null,[Symbol.iterator](){return iterator(this,Symbol.iterator,toReactive)},concat(...Re){return reactiveReadArray(this).concat(...Re.map((Re=>Pv(Re)?reactiveReadArray(Re):Re)))},entries(){return iterator(this,"entries",(Re=>(Re[1]=toReactive(Re[1]),Re)))},every(Re,Le){return apply$1(this,"every",Re,Le,void 0,arguments)},filter(Re,Le){return apply$1(this,"filter",Re,Le,(Re=>Re.map(toReactive)),arguments)},find(Re,Le){return apply$1(this,"find",Re,Le,toReactive,arguments)},findIndex(Re,Le){return apply$1(this,"findIndex",Re,Le,void 0,arguments)},findLast(Re,Le){return apply$1(this,"findLast",Re,Le,toReactive,arguments)},findLastIndex(Re,Le){return apply$1(this,"findLastIndex",Re,Le,void 0,arguments)},forEach(Re,Le){return apply$1(this,"forEach",Re,Le,void 0,arguments)},includes(...Re){return searchProxy(this,"includes",Re)},indexOf(...Re){return searchProxy(this,"indexOf",Re)},join(Re){return reactiveReadArray(this).join(Re)},lastIndexOf(...Re){return searchProxy(this,"lastIndexOf",Re)},map(Re,Le){return apply$1(this,"map",Re,Le,void 0,arguments)},pop(){return noTracking(this,"pop")},push(...Re){return noTracking(this,"push",Re)},reduce(Re,...Le){return reduce(this,"reduce",Re,Le)},reduceRight(Re,...Le){return reduce(this,"reduceRight",Re,Le)},shift(){return noTracking(this,"shift")},some(Re,Le){return apply$1(this,"some",Re,Le,void 0,arguments)},splice(...Re){return noTracking(this,"splice",Re)},toReversed(){return reactiveReadArray(this).toReversed()},toSorted(Re){return reactiveReadArray(this).toSorted(Re)},toSpliced(...Re){return reactiveReadArray(this).toSpliced(...Re)},unshift(...Re){return noTracking(this,"unshift",Re)},values(){return iterator(this,"values",toReactive)}};function iterator(Re,Le,Oe){const Ue=shallowReadArray(Re),qe=Ue[Le]();return Ue===Re||isShallow(Re)||(qe._next=qe.next,qe.next=()=>{const Re=qe._next();return Re.value&&(Re.value=Oe(Re.value)),Re}),qe}const Ox=Array.prototype;function apply$1(Re,Le,Oe,Ue,qe,Ct){const Ot=shallowReadArray(Re),Jt=Ot!==Re&&!isShallow(Re),Hr=Ot[Le];if(Hr!==Ox[Le]){const Le=Hr.apply(Re,Ct);return Jt?toReactive(Le):Le}let Jr=Oe;Ot!==Re&&(Jt?Jr=function(Le,Ue){return Oe.call(this,toReactive(Le),Ue,Re)}:Oe.length>2&&(Jr=function(Le,Ue){return Oe.call(this,Le,Ue,Re)}));const Ln=Hr.call(Ot,Jr,Ue);return Jt&&qe?qe(Ln):Ln}function reduce(Re,Le,Oe,Ue){const qe=shallowReadArray(Re);let Ct=Oe;return qe!==Re&&(isShallow(Re)?Oe.length>3&&(Ct=function(Le,Ue,qe){return Oe.call(this,Le,Ue,qe,Re)}):Ct=function(Le,Ue,qe){return Oe.call(this,Le,toReactive(Ue),qe,Re)}),qe[Le](Ct,...Ue)}function searchProxy(Re,Le,Oe){const Ue=toRaw(Re);track(Ue,0,Rx);const qe=Ue[Le](...Oe);return-1!==qe&&!1!==qe||!isProxy(Oe[0])?qe:(Oe[0]=toRaw(Oe[0]),Ue[Le](...Oe))}function noTracking(Re,Le,Oe=[]){pauseTracking(),startBatch();const Ue=toRaw(Re)[Le].apply(Re,Oe);return endBatch(),resetTracking(),Ue}const zx=makeMap("__proto__,__v_isRef,__isVue"),Dx=new Set(Object.getOwnPropertyNames(Symbol).filter((Re=>"arguments"!==Re&&"caller"!==Re)).map((Re=>Symbol[Re])).filter(isSymbol$1));function hasOwnProperty$1(Re){isSymbol$1(Re)||(Re=String(Re));const Le=toRaw(this);return track(Le,0,Re),Le.hasOwnProperty(Re)}class BaseReactiveHandler{constructor(Re=!1,Le=!1){this._isReadonly=Re,this._isShallow=Le}get(Re,Le,Oe){const Ue=this._isReadonly,qe=this._isShallow;if("__v_isReactive"===Le)return!Ue;if("__v_isReadonly"===Le)return Ue;if("__v_isShallow"===Le)return qe;if("__v_raw"===Le)return Oe===(Ue?qe?Hx:qx:qe?Gx:$x).get(Re)||Object.getPrototypeOf(Re)===Object.getPrototypeOf(Oe)?Re:void 0;const Ct=Pv(Re);if(!Ue){let Re;if(Ct&&(Re=Lx[Le]))return Re;if("hasOwnProperty"===Le)return hasOwnProperty$1}const Ot=Reflect.get(Re,Le,isRef(Re)?Re:Oe);return(isSymbol$1(Le)?Dx.has(Le):zx(Le))?Ot:(Ue||track(Re,0,Le),qe?Ot:isRef(Ot)?Ct&&isIntegerKey(Le)?Ot:Ot.value:isObject$4(Ot)?Ue?readonly(Ot):reactive(Ot):Ot)}}class MutableReactiveHandler extends BaseReactiveHandler{constructor(Re=!1){super(!1,Re)}set(Re,Le,Oe,Ue){let qe=Re[Le];if(!this._isShallow){const Le=isReadonly(qe);if(isShallow(Oe)||isReadonly(Oe)||(qe=toRaw(qe),Oe=toRaw(Oe)),!Pv(Re)&&isRef(qe)&&!isRef(Oe))return!Le&&(qe.value=Oe,!0)}const Ct=Pv(Re)&&isIntegerKey(Le)?Number(Le)<Re.length:hasOwn$1(Re,Le),Ot=Reflect.set(Re,Le,Oe,isRef(Re)?Re:Ue);return Re===toRaw(Ue)&&(Ct?hasChanged(Oe,qe)&&trigger(Re,"set",Le,Oe):trigger(Re,"add",Le,Oe)),Ot}deleteProperty(Re,Le){const Oe=hasOwn$1(Re,Le);Re[Le];const Ue=Reflect.deleteProperty(Re,Le);return Ue&&Oe&&trigger(Re,"delete",Le,void 0),Ue}has(Re,Le){const Oe=Reflect.has(Re,Le);return isSymbol$1(Le)&&Dx.has(Le)||track(Re,0,Le),Oe}ownKeys(Re){return track(Re,0,Pv(Re)?"length":Mx),Reflect.ownKeys(Re)}}class ReadonlyReactiveHandler extends BaseReactiveHandler{constructor(Re=!1){super(!0,Re)}set(Re,Le){return!0}deleteProperty(Re,Le){return!0}}const Bx=new MutableReactiveHandler,Fx=new ReadonlyReactiveHandler,Nx=new MutableReactiveHandler(!0),toShallow=Re=>Re,getProto=Re=>Reflect.getPrototypeOf(Re);function createReadonlyMethod(Re){return function(...Le){return"delete"!==Re&&("clear"===Re?void 0:this)}}function createInstrumentations(Re,Le){const Oe={get(Oe){const Ue=this.__v_raw,qe=toRaw(Ue),Ct=toRaw(Oe);Re||(hasChanged(Oe,Ct)&&track(qe,0,Oe),track(qe,0,Ct));const{has:Ot}=getProto(qe),Jt=Le?toShallow:Re?toReadonly:toReactive;return Ot.call(qe,Oe)?Jt(Ue.get(Oe)):Ot.call(qe,Ct)?Jt(Ue.get(Ct)):void(Ue!==qe&&Ue.get(Oe))},get size(){const Le=this.__v_raw;return!Re&&track(toRaw(Le),0,Mx),Reflect.get(Le,"size",Le)},has(Le){const Oe=this.__v_raw,Ue=toRaw(Oe),qe=toRaw(Le);return Re||(hasChanged(Le,qe)&&track(Ue,0,Le),track(Ue,0,qe)),Le===qe?Oe.has(Le):Oe.has(Le)||Oe.has(qe)},forEach(Oe,Ue){const qe=this,Ct=qe.__v_raw,Ot=toRaw(Ct),Jt=Le?toShallow:Re?toReadonly:toReactive;return!Re&&track(Ot,0,Mx),Ct.forEach(((Re,Le)=>Oe.call(Ue,Jt(Re),Jt(Le),qe)))}};kv(Oe,Re?{add:createReadonlyMethod("add"),set:createReadonlyMethod("set"),delete:createReadonlyMethod("delete"),clear:createReadonlyMethod("clear")}:{add(Re){Le||isShallow(Re)||isReadonly(Re)||(Re=toRaw(Re));const Oe=toRaw(this);return getProto(Oe).has.call(Oe,Re)||(Oe.add(Re),trigger(Oe,"add",Re,Re)),this},set(Re,Oe){Le||isShallow(Oe)||isReadonly(Oe)||(Oe=toRaw(Oe));const Ue=toRaw(this),{has:qe,get:Ct}=getProto(Ue);let Ot=qe.call(Ue,Re);Ot||(Re=toRaw(Re),Ot=qe.call(Ue,Re));const Jt=Ct.call(Ue,Re);return Ue.set(Re,Oe),Ot?hasChanged(Oe,Jt)&&trigger(Ue,"set",Re,Oe):trigger(Ue,"add",Re,Oe),this},delete(Re){const Le=toRaw(this),{has:Oe,get:Ue}=getProto(Le);let qe=Oe.call(Le,Re);qe||(Re=toRaw(Re),qe=Oe.call(Le,Re)),Ue&&Ue.call(Le,Re);const Ct=Le.delete(Re);return qe&&trigger(Le,"delete",Re,void 0),Ct},clear(){const Re=toRaw(this),Le=0!==Re.size,Oe=Re.clear();return Le&&trigger(Re,"clear",void 0,void 0),Oe}});return["keys","values","entries",Symbol.iterator].forEach((Ue=>{Oe[Ue]=function(Re,Le,Oe){return function(...Ue){const qe=this.__v_raw,Ct=toRaw(qe),Ot=isMap(Ct),Jt="entries"===Re||Re===Symbol.iterator&&Ot,Hr="keys"===Re&&Ot,Jr=qe[Re](...Ue),Ln=Oe?toShallow:Le?toReadonly:toReactive;return!Le&&track(Ct,0,Hr?Px:Mx),{next(){const{value:Re,done:Le}=Jr.next();return Le?{value:Re,done:Le}:{value:Jt?[Ln(Re[0]),Ln(Re[1])]:Ln(Re),done:Le}},[Symbol.iterator](){return this}}}}(Ue,Re,Le)})),Oe}function createInstrumentationGetter(Re,Le){const Oe=createInstrumentations(Re,Le);return(Le,Ue,qe)=>"__v_isReactive"===Ue?!Re:"__v_isReadonly"===Ue?Re:"__v_raw"===Ue?Le:Reflect.get(hasOwn$1(Oe,Ue)&&Ue in Le?Oe:Le,Ue,qe)}const jx={get:createInstrumentationGetter(!1,!1)},Ux={get:createInstrumentationGetter(!1,!0)},Vx={get:createInstrumentationGetter(!0,!1)},$x=new WeakMap,Gx=new WeakMap,qx=new WeakMap,Hx=new WeakMap;function getTargetType(Re){return Re.__v_skip||!Object.isExtensible(Re)?0:function(Re){switch(Re){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}((Re=>toTypeString$1(Re).slice(8,-1))(Re))}function reactive(Re){return isReadonly(Re)?Re:createReactiveObject(Re,!1,Bx,jx,$x)}function shallowReactive(Re){return createReactiveObject(Re,!1,Nx,Ux,Gx)}function readonly(Re){return createReactiveObject(Re,!0,Fx,Vx,qx)}function createReactiveObject(Re,Le,Oe,Ue,qe){if(!isObject$4(Re))return Re;if(Re.__v_raw&&(!Le||!Re.__v_isReactive))return Re;const Ct=qe.get(Re);if(Ct)return Ct;const Ot=getTargetType(Re);if(0===Ot)return Re;const Jt=new Proxy(Re,2===Ot?Ue:Oe);return qe.set(Re,Jt),Jt}function isReactive(Re){return isReadonly(Re)?isReactive(Re.__v_raw):!(!Re||!Re.__v_isReactive)}function isReadonly(Re){return!(!Re||!Re.__v_isReadonly)}function isShallow(Re){return!(!Re||!Re.__v_isShallow)}function isProxy(Re){return!!Re&&!!Re.__v_raw}function toRaw(Re){const Le=Re&&Re.__v_raw;return Le?toRaw(Le):Re}function markRaw(Re){return!hasOwn$1(Re,"__v_skip")&&Object.isExtensible(Re)&&def(Re,"__v_skip",!0),Re}const toReactive=Re=>isObject$4(Re)?reactive(Re):Re,toReadonly=Re=>isObject$4(Re)?readonly(Re):Re;function isRef(Re){return!!Re&&!0===Re.__v_isRef}function ref(Re){return createRef(Re,!1)}function shallowRef(Re){return createRef(Re,!0)}function createRef(Re,Le){return isRef(Re)?Re:new RefImpl(Re,Le)}class RefImpl{constructor(Re,Le){this.dep=new Dep,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=Le?Re:toRaw(Re),this._value=Le?Re:toReactive(Re),this.__v_isShallow=Le}get value(){return this.dep.track(),this._value}set value(Re){const Le=this._rawValue,Oe=this.__v_isShallow||isShallow(Re)||isReadonly(Re);Re=Oe?Re:toRaw(Re),hasChanged(Re,Le)&&(this._rawValue=Re,this._value=Oe?Re:toReactive(Re),this.dep.trigger())}}function unref(Re){return isRef(Re)?Re.value:Re}function toValue(Re){return isFunction$1(Re)?Re():unref(Re)}const Wx={get:(Re,Le,Oe)=>"__v_raw"===Le?Re:unref(Reflect.get(Re,Le,Oe)),set:(Re,Le,Oe,Ue)=>{const qe=Re[Le];return isRef(qe)&&!isRef(Oe)?(qe.value=Oe,!0):Reflect.set(Re,Le,Oe,Ue)}};function proxyRefs(Re){return isReactive(Re)?Re:new Proxy(Re,Wx)}class ObjectRefImpl{constructor(Re,Le,Oe){this._object=Re,this._key=Le,this._defaultValue=Oe,this.__v_isRef=!0,this._value=void 0}get value(){const Re=this._object[this._key];return this._value=void 0===Re?this._defaultValue:Re}set value(Re){this._object[this._key]=Re}get dep(){return function(Re,Le){const Oe=kx.get(Re);return Oe&&Oe.get(Le)}(toRaw(this._object),this._key)}}class GetterRefImpl{constructor(Re){this._getter=Re,this.__v_isRef=!0,this.__v_isReadonly=!0,this._value=void 0}get value(){return this._value=this._getter()}}function toRef(Re,Le,Oe){return isRef(Re)?Re:isFunction$1(Re)?new GetterRefImpl(Re):isObject$4(Re)&&arguments.length>1?function(Re,Le,Oe){const Ue=Re[Le];return isRef(Ue)?Ue:new ObjectRefImpl(Re,Le,Oe)}(Re,Le,Oe):ref(Re)}class ComputedRefImpl{constructor(Re,Le,Oe){this.fn=Re,this.setter=Le,this._value=void 0,this.dep=new Dep(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Ix-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!Le,this.isSSR=Oe}notify(){if(this.flags|=16,!(8&this.flags)&&mx!==this)return batch(this,!0),!0}get value(){const Re=this.dep.track();return refreshComputed(this),Re&&(Re.version=this.dep.version),this._value}set value(Re){this.setter&&this.setter(Re)}}const Zx={},Xx=new WeakMap;let Yx;function watch$1(Re,Le,Oe=Av){const{immediate:Ue,deep:qe,once:Ct,scheduler:Ot,augmentJob:Jt,call:Hr}=Oe,reactiveGetter=Re=>qe?Re:isShallow(Re)||!1===qe||0===qe?traverse(Re,1):traverse(Re);let Jr,Ln,Nn,$n,Gn=!1,qn=!1;if(isRef(Re)?(Ln=()=>Re.value,Gn=isShallow(Re)):isReactive(Re)?(Ln=()=>reactiveGetter(Re),Gn=!0):Pv(Re)?(qn=!0,Gn=Re.some((Re=>isReactive(Re)||isShallow(Re))),Ln=()=>Re.map((Re=>isRef(Re)?Re.value:isReactive(Re)?reactiveGetter(Re):isFunction$1(Re)?Hr?Hr(Re,2):Re():void 0))):Ln=isFunction$1(Re)?Le?Hr?()=>Hr(Re,2):Re:()=>{if(Nn){pauseTracking();try{Nn()}finally{resetTracking()}}const Le=Yx;Yx=Jr;try{return Hr?Hr(Re,3,[$n]):Re($n)}finally{Yx=Le}}:NOOP,Le&&qe){const Re=Ln,Le=!0===qe?1/0:qe;Ln=()=>traverse(Re(),Le)}const Zn=getCurrentScope(),watchHandle=()=>{Jr.stop(),Zn&&remove(Zn.effects,Jr)};if(Ct&&Le){const Re=Le;Le=(...Le)=>{Re(...Le),watchHandle()}}let Xn=qn?new Array(Re.length).fill(Zx):Zx;const job=Re=>{if(1&Jr.flags&&(Jr.dirty||Re))if(Le){const Re=Jr.run();if(qe||Gn||(qn?Re.some(((Re,Le)=>hasChanged(Re,Xn[Le]))):hasChanged(Re,Xn))){Nn&&Nn();const Oe=Yx;Yx=Jr;try{const Oe=[Re,Xn===Zx?void 0:qn&&Xn[0]===Zx?[]:Xn,$n];Hr?Hr(Le,3,Oe):Le(...Oe),Xn=Re}finally{Yx=Oe}}}else Jr.run()};return Jt&&Jt(job),Jr=new ReactiveEffect(Ln),Jr.scheduler=Ot?()=>Ot(job,!1):job,$n=Re=>function(Re,Le=!1,Oe=Yx){if(Oe){let Le=Xx.get(Oe);Le||Xx.set(Oe,Le=[]),Le.push(Re)}}(Re,!1,Jr),Nn=Jr.onStop=()=>{const Re=Xx.get(Jr);if(Re){if(Hr)Hr(Re,4);else for(const Le of Re)Le();Xx.delete(Jr)}},Le?Ue?job(!0):Xn=Jr.run():Ot?Ot(job.bind(null,!0),!0):Jr.run(),watchHandle.pause=Jr.pause.bind(Jr),watchHandle.resume=Jr.resume.bind(Jr),watchHandle.stop=watchHandle,watchHandle}function traverse(Re,Le=1/0,Oe){if(Le<=0||!isObject$4(Re)||Re.__v_skip)return Re;if((Oe=Oe||new Set).has(Re))return Re;if(Oe.add(Re),Le--,isRef(Re))traverse(Re.value,Le,Oe);else if(Pv(Re))for(let Ue=0;Ue<Re.length;Ue++)traverse(Re[Ue],Le,Oe);else if(isSet(Re)||isMap(Re))Re.forEach((Re=>{traverse(Re,Le,Oe)}));else if(isPlainObject$1(Re)){for(const Ue in Re)traverse(Re[Ue],Le,Oe);for(const Ue of Object.getOwnPropertySymbols(Re))Object.prototype.propertyIsEnumerable.call(Re,Ue)&&traverse(Re[Ue],Le,Oe)}return Re}const Kx=[];function callWithErrorHandling(Re,Le,Oe,Ue){try{return Ue?Re(...Ue):Re()}catch(Re){handleError(Re,Le,Oe)}}function callWithAsyncErrorHandling(Re,Le,Oe,Ue){if(isFunction$1(Re)){const qe=callWithErrorHandling(Re,Le,Oe,Ue);return qe&&isPromise$1(qe)&&qe.catch((Re=>{handleError(Re,Le,Oe)})),qe}if(Pv(Re)){const qe=[];for(let Ct=0;Ct<Re.length;Ct++)qe.push(callWithAsyncErrorHandling(Re[Ct],Le,Oe,Ue));return qe}}function handleError(Re,Le,Oe,Ue=!0){Le&&Le.vnode;const{errorHandler:qe,throwUnhandledErrorInProduction:Ct}=Le&&Le.appContext.config||Av;if(Le){let Ue=Le.parent;const Ct=Le.proxy,Ot=`https://vuejs.org/error-reference/#runtime-${Oe}`;for(;Ue;){const Le=Ue.ec;if(Le)for(let Oe=0;Oe<Le.length;Oe++)if(!1===Le[Oe](Re,Ct,Ot))return;Ue=Ue.parent}if(qe)return pauseTracking(),callWithErrorHandling(qe,null,10,[Re,Ct,Ot]),void resetTracking()}!function(Re,Le,Oe,Ue=!0,qe=!1){if(qe)throw Re;console.error(Re)}(Re,0,0,Ue,Ct)}const Jx=[];let Qx=-1;const eb=[];let tb=null,rb=0;const nb=Promise.resolve();let ib=null;function nextTick$1(Re){const Le=ib||nb;return Re?Le.then(this?Re.bind(this):Re):Le}function queueJob(Re){if(!(1&Re.flags)){const Le=getId(Re),Oe=Jx[Jx.length-1];!Oe||!(2&Re.flags)&&Le>=getId(Oe)?Jx.push(Re):Jx.splice(function(Re){let Le=Qx+1,Oe=Jx.length;for(;Le<Oe;){const Ue=Le+Oe>>>1,qe=Jx[Ue],Ct=getId(qe);Ct<Re||Ct===Re&&2&qe.flags?Le=Ue+1:Oe=Ue}return Le}(Le),0,Re),Re.flags|=1,queueFlush()}}function queueFlush(){ib||(ib=nb.then(flushJobs))}function queuePostFlushCb(Re){Pv(Re)?eb.push(...Re):tb&&-1===Re.id?tb.splice(rb+1,0,Re):1&Re.flags||(eb.push(Re),Re.flags|=1),queueFlush()}function flushPreFlushCbs(Re,Le,Oe=Qx+1){for(;Oe<Jx.length;Oe++){const Le=Jx[Oe];if(Le&&2&Le.flags){if(Re&&Le.id!==Re.uid)continue;Jx.splice(Oe,1),Oe--,4&Le.flags&&(Le.flags&=-2),Le(),4&Le.flags||(Le.flags&=-2)}}}function flushPostFlushCbs(Re){if(eb.length){const Re=[...new Set(eb)].sort(((Re,Le)=>getId(Re)-getId(Le)));if(eb.length=0,tb)return void tb.push(...Re);for(tb=Re,rb=0;rb<tb.length;rb++){const Re=tb[rb];4&Re.flags&&(Re.flags&=-2),8&Re.flags||Re(),Re.flags&=-2}tb=null,rb=0}}const getId=Re=>null==Re.id?2&Re.flags?-1:1/0:Re.id;function flushJobs(Re){try{for(Qx=0;Qx<Jx.length;Qx++){const Re=Jx[Qx];!Re||8&Re.flags||(4&Re.flags&&(Re.flags&=-2),callWithErrorHandling(Re,Re.i,Re.i?15:14),4&Re.flags||(Re.flags&=-2))}}finally{for(;Qx<Jx.length;Qx++){const Re=Jx[Qx];Re&&(Re.flags&=-2)}Qx=-1,Jx.length=0,flushPostFlushCbs(),ib=null,(Jx.length||eb.length)&&flushJobs()}}let ob=null,sb=null;function setCurrentRenderingInstance$1(Re){const Le=ob;return ob=Re,sb=Re&&Re.type.__scopeId||null,Le}function withCtx(Re,Le=ob,Oe){if(!Le)return Re;if(Re._n)return Re;const renderFnWithContext=(...Oe)=>{renderFnWithContext._d&&setBlockTracking(-1);const Ue=setCurrentRenderingInstance$1(Le);let qe;try{qe=Re(...Oe)}finally{setCurrentRenderingInstance$1(Ue),renderFnWithContext._d&&setBlockTracking(1)}return qe};return renderFnWithContext._n=!0,renderFnWithContext._c=!0,renderFnWithContext._d=!0,renderFnWithContext}function invokeDirectiveHook(Re,Le,Oe,Ue){const qe=Re.dirs,Ct=Le&&Le.dirs;for(let Ot=0;Ot<qe.length;Ot++){const Jt=qe[Ot];Ct&&(Jt.oldValue=Ct[Ot].value);let Hr=Jt.dir[Ue];Hr&&(pauseTracking(),callWithAsyncErrorHandling(Hr,Oe,8,[Re.el,Jt,Re,Le]),resetTracking())}}const ab=Symbol("_vte"),isTeleport=Re=>Re.__isTeleport,lb=Symbol("_leaveCb"),cb=Symbol("_enterCb");const ub=[Function,Array],hb={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:ub,onEnter:ub,onAfterEnter:ub,onEnterCancelled:ub,onBeforeLeave:ub,onLeave:ub,onAfterLeave:ub,onLeaveCancelled:ub,onBeforeAppear:ub,onAppear:ub,onAfterAppear:ub,onAppearCancelled:ub},recursiveGetSubtree=Re=>{const Le=Re.subTree;return Le.component?recursiveGetSubtree(Le.component):Le};function findNonCommentChild(Re){let Le=Re[0];if(Re.length>1)for(const Oe of Re)if(Oe.type!==Fb){Le=Oe;break}return Le}const db={name:"BaseTransition",props:hb,setup(Re,{slots:Le}){const Oe=getCurrentInstance(),Ue=function(){const Re={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return fb((()=>{Re.isMounted=!0})),_b((()=>{Re.isUnmounting=!0})),Re}();return()=>{const qe=Le.default&&getTransitionRawChildren(Le.default(),!0);if(!qe||!qe.length)return;const Ct=findNonCommentChild(qe),Ot=toRaw(Re),{mode:Jt}=Ot;if(Ue.isLeaving)return emptyPlaceholder(Ct);const Hr=getInnerChild$1(Ct);if(!Hr)return emptyPlaceholder(Ct);let Jr=resolveTransitionHooks(Hr,Ot,Ue,Oe,(Re=>Jr=Re));Hr.type!==Fb&&setTransitionHooks(Hr,Jr);const Ln=Oe.subTree,Nn=Ln&&getInnerChild$1(Ln);if(Nn&&Nn.type!==Fb&&!isSameVNodeType(Hr,Nn)&&recursiveGetSubtree(Oe).type!==Fb){const Re=resolveTransitionHooks(Nn,Ot,Ue,Oe);if(setTransitionHooks(Nn,Re),"out-in"===Jt&&Hr.type!==Fb)return Ue.isLeaving=!0,Re.afterLeave=()=>{Ue.isLeaving=!1,8&Oe.job.flags||Oe.update(),delete Re.afterLeave},emptyPlaceholder(Ct);"in-out"===Jt&&Hr.type!==Fb&&(Re.delayLeave=(Re,Le,Oe)=>{getLeavingNodesForType(Ue,Nn)[String(Nn.key)]=Nn,Re[lb]=()=>{Le(),Re[lb]=void 0,delete Jr.delayedLeave},Jr.delayedLeave=Oe})}return Ct}}};function getLeavingNodesForType(Re,Le){const{leavingVNodes:Oe}=Re;let Ue=Oe.get(Le.type);return Ue||(Ue=Object.create(null),Oe.set(Le.type,Ue)),Ue}function resolveTransitionHooks(Re,Le,Oe,Ue,qe){const{appear:Ct,mode:Ot,persisted:Jt=!1,onBeforeEnter:Hr,onEnter:Jr,onAfterEnter:Ln,onEnterCancelled:Nn,onBeforeLeave:$n,onLeave:Gn,onAfterLeave:qn,onLeaveCancelled:Zn,onBeforeAppear:Xn,onAppear:Yn,onAfterAppear:_i,onAppearCancelled:vi}=Le,xi=String(Re.key),bi=getLeavingNodesForType(Oe,Re),callHook=(Re,Le)=>{Re&&callWithAsyncErrorHandling(Re,Ue,9,Le)},callAsyncHook=(Re,Le)=>{const Oe=Le[1];callHook(Re,Le),Pv(Re)?Re.every((Re=>Re.length<=1))&&Oe():Re.length<=1&&Oe()},Pi={mode:Ot,persisted:Jt,beforeEnter(Le){let Ue=Hr;if(!Oe.isMounted){if(!Ct)return;Ue=Xn||Hr}Le[lb]&&Le[lb](!0);const qe=bi[xi];qe&&isSameVNodeType(Re,qe)&&qe.el[lb]&&qe.el[lb](),callHook(Ue,[Le])},enter(Re){let Le=Jr,Ue=Ln,qe=Nn;if(!Oe.isMounted){if(!Ct)return;Le=Yn||Jr,Ue=_i||Ln,qe=vi||Nn}let Ot=!1;const Jt=Re[cb]=Le=>{Ot||(Ot=!0,callHook(Le?qe:Ue,[Re]),Pi.delayedLeave&&Pi.delayedLeave(),Re[cb]=void 0)};Le?callAsyncHook(Le,[Re,Jt]):Jt()},leave(Le,Ue){const qe=String(Re.key);if(Le[cb]&&Le[cb](!0),Oe.isUnmounting)return Ue();callHook($n,[Le]);let Ct=!1;const Ot=Le[lb]=Oe=>{Ct||(Ct=!0,Ue(),callHook(Oe?Zn:qn,[Le]),Le[lb]=void 0,bi[qe]===Re&&delete bi[qe])};bi[qe]=Re,Gn?callAsyncHook(Gn,[Le,Ot]):Ot()},clone(Re){const Ct=resolveTransitionHooks(Re,Le,Oe,Ue,qe);return qe&&qe(Ct),Ct}};return Pi}function emptyPlaceholder(Re){if(isKeepAlive(Re))return(Re=cloneVNode(Re)).children=null,Re}function getInnerChild$1(Re){if(!isKeepAlive(Re))return isTeleport(Re.type)&&Re.children?findNonCommentChild(Re.children):Re;const{shapeFlag:Le,children:Oe}=Re;if(Oe){if(16&Le)return Oe[0];if(32&Le&&isFunction$1(Oe.default))return Oe.default()}}function setTransitionHooks(Re,Le){6&Re.shapeFlag&&Re.component?(Re.transition=Le,setTransitionHooks(Re.component.subTree,Le)):128&Re.shapeFlag?(Re.ssContent.transition=Le.clone(Re.ssContent),Re.ssFallback.transition=Le.clone(Re.ssFallback)):Re.transition=Le}function getTransitionRawChildren(Re,Le=!1,Oe){let Ue=[],qe=0;for(let Ct=0;Ct<Re.length;Ct++){let Ot=Re[Ct];const Jt=null==Oe?Ot.key:String(Oe)+String(null!=Ot.key?Ot.key:Ct);Ot.type===Db?(128&Ot.patchFlag&&qe++,Ue=Ue.concat(getTransitionRawChildren(Ot.children,Le,Jt))):(Le||Ot.type!==Fb)&&Ue.push(null!=Jt?cloneVNode(Ot,{key:Jt}):Ot)}if(qe>1)for(let Re=0;Re<Ue.length;Re++)Ue[Re].patchFlag=-2;return Ue}function defineComponent(Re,Le){return isFunction$1(Re)?(()=>kv({name:Re.name},Le,{setup:Re}))():Re}function markAsyncBoundary(Re){Re.ids=[Re.ids[0]+Re.ids[2]+++"-",0,0]}function setRef(Re,Le,Oe,Ue,qe=!1){if(Pv(Re))return void Re.forEach(((Re,Ct)=>setRef(Re,Le&&(Pv(Le)?Le[Ct]:Le),Oe,Ue,qe)));if(isAsyncWrapper(Ue)&&!qe)return;const Ct=4&Ue.shapeFlag?getComponentPublicInstance(Ue.component):Ue.el,Ot=qe?null:Ct,{i:Jt,r:Hr}=Re,Jr=Le&&Le.r,Ln=Jt.refs===Av?Jt.refs={}:Jt.refs,Nn=Jt.setupState,$n=toRaw(Nn),Gn=Nn===Av?()=>!1:Re=>hasOwn$1($n,Re);if(null!=Jr&&Jr!==Hr&&(isString$1(Jr)?(Ln[Jr]=null,Gn(Jr)&&(Nn[Jr]=null)):isRef(Jr)&&(Jr.value=null)),isFunction$1(Hr))callWithErrorHandling(Hr,Jt,12,[Ot,Ln]);else{const Le=isString$1(Hr),Ue=isRef(Hr);if(Le||Ue){const doSet=()=>{if(Re.f){const Oe=Le?Gn(Hr)?Nn[Hr]:Ln[Hr]:Hr.value;qe?Pv(Oe)&&remove(Oe,Ct):Pv(Oe)?Oe.includes(Ct)||Oe.push(Ct):Le?(Ln[Hr]=[Ct],Gn(Hr)&&(Nn[Hr]=Ln[Hr])):(Hr.value=[Ct],Re.k&&(Ln[Re.k]=Hr.value))}else Le?(Ln[Hr]=Ot,Gn(Hr)&&(Nn[Hr]=Ot)):Ue&&(Hr.value=Ot,Re.k&&(Ln[Re.k]=Ot))};Ot?(doSet.id=-1,queuePostRenderEffect(doSet,Oe)):doSet()}}}const isComment$1=Re=>8===Re.nodeType;getGlobalThis().requestIdleCallback,getGlobalThis().cancelIdleCallback;const isAsyncWrapper=Re=>!!Re.type.__asyncLoader;function defineAsyncComponent(Re){isFunction$1(Re)&&(Re={loader:Re});const{loader:Le,loadingComponent:Oe,errorComponent:Ue,delay:qe=200,hydrate:Ct,timeout:Ot,suspensible:Jt=!0,onError:Hr}=Re;let Jr,Ln=null,Nn=0;const load=()=>{let Re;return Ln||(Re=Ln=Le().catch((Re=>{if(Re=Re instanceof Error?Re:new Error(String(Re)),Hr)return new Promise(((Le,Oe)=>{Hr(Re,(()=>Le((Nn++,Ln=null,load()))),(()=>Oe(Re)),Nn+1)}));throw Re})).then((Le=>Re!==Ln&&Ln?Ln:(Le&&(Le.__esModule||"Module"===Le[Symbol.toStringTag])&&(Le=Le.default),Jr=Le,Le))))};return defineComponent({name:"AsyncComponentWrapper",__asyncLoader:load,__asyncHydrate(Re,Le,Oe){const Ue=Ct?()=>{const Ue=Ct(Oe,(Le=>function(Re,Le){if(isComment$1(Re)&&"["===Re.data){let Oe=1,Ue=Re.nextSibling;for(;Ue;){if(1===Ue.nodeType){if(!1===Le(Ue))break}else if(isComment$1(Ue))if("]"===Ue.data){if(0==--Oe)break}else"["===Ue.data&&Oe++;Ue=Ue.nextSibling}}else Le(Re)}(Re,Le)));Ue&&(Le.bum||(Le.bum=[])).push(Ue)}:Oe;Jr?Ue():load().then((()=>!Le.isUnmounted&&Ue()))},get __asyncResolved(){return Jr},setup(){const Re=qb;if(markAsyncBoundary(Re),Jr)return()=>createInnerComp(Jr,Re);const onError=Le=>{Ln=null,handleError(Le,Re,13,!Ue)};if(Jt&&Re.suspense||Xb)return load().then((Le=>()=>createInnerComp(Le,Re))).catch((Re=>(onError(Re),()=>Ue?createVNode(Ue,{error:Re}):null)));const Le=ref(!1),Ct=ref(),Hr=ref(!!qe);return qe&&setTimeout((()=>{Hr.value=!1}),qe),null!=Ot&&setTimeout((()=>{if(!Le.value&&!Ct.value){const Re=new Error(`Async component timed out after ${Ot}ms.`);onError(Re),Ct.value=Re}}),Ot),load().then((()=>{Le.value=!0,Re.parent&&isKeepAlive(Re.parent.vnode)&&Re.parent.update()})).catch((Re=>{onError(Re),Ct.value=Re})),()=>Le.value&&Jr?createInnerComp(Jr,Re):Ct.value&&Ue?createVNode(Ue,{error:Ct.value}):Oe&&!Hr.value?createVNode(Oe):void 0}})}function createInnerComp(Re,Le){const{ref:Oe,props:Ue,children:qe,ce:Ct}=Le.vnode,Ot=createVNode(Re,Ue,qe);return Ot.ref=Oe,Ot.ce=Ct,delete Le.vnode.ce,Ot}const isKeepAlive=Re=>Re.type.__isKeepAlive;function onActivated(Re,Le){registerKeepAliveHook(Re,"a",Le)}function onDeactivated(Re,Le){registerKeepAliveHook(Re,"da",Le)}function registerKeepAliveHook(Re,Le,Oe=qb){const Ue=Re.__wdc||(Re.__wdc=()=>{let Le=Oe;for(;Le;){if(Le.isDeactivated)return;Le=Le.parent}return Re()});if(injectHook(Le,Ue,Oe),Oe){let Re=Oe.parent;for(;Re&&Re.parent;)isKeepAlive(Re.parent.vnode)&&injectToKeepAliveRoot(Ue,Le,Oe,Re),Re=Re.parent}}function injectToKeepAliveRoot(Re,Le,Oe,Ue){const qe=injectHook(Le,Re,Ue,!0);yb((()=>{remove(Ue[Le],qe)}),Oe)}function injectHook(Re,Le,Oe=qb,Ue=!1){if(Oe){const qe=Oe[Re]||(Oe[Re]=[]),Ct=Le.__weh||(Le.__weh=(...Ue)=>{pauseTracking();const qe=setCurrentInstance(Oe),Ct=callWithAsyncErrorHandling(Le,Oe,Re,Ue);return qe(),resetTracking(),Ct});return Ue?qe.unshift(Ct):qe.push(Ct),Ct}}const createHook=Re=>(Le,Oe=qb)=>{Xb&&"sp"!==Re||injectHook(Re,((...Re)=>Le(...Re)),Oe)},pb=createHook("bm"),fb=createHook("m"),mb=createHook("bu"),gb=createHook("u"),_b=createHook("bum"),yb=createHook("um"),vb=createHook("sp"),xb=createHook("rtg"),bb=createHook("rtc");function onErrorCaptured(Re,Le=qb){injectHook("ec",Re,Le)}const wb="components";function resolveComponent(Re,Le){return resolveAsset(wb,Re,!0,Le)||Re}const Tb=Symbol.for("v-ndc");function resolveDynamicComponent(Re){return isString$1(Re)?resolveAsset(wb,Re,!1)||Re:Re||Tb}function resolveAsset(Re,Le,Oe=!0,Ue=!1){const qe=ob||qb;if(qe){const Oe=qe.type;{const Re=getComponentName(Oe,!1);if(Re&&(Re===Le||Re===zv(Le)||Re===Fv(zv(Le))))return Oe}const Ct=resolve$1(qe[Re]||Oe[Re],Le)||resolve$1(qe.appContext[Re],Le);return!Ct&&Ue?Oe:Ct}}function resolve$1(Re,Le){return Re&&(Re[Le]||Re[zv(Le)]||Re[Fv(zv(Le))])}function renderList(Re,Le,Oe,Ue){let qe;const Ct=Oe,Ot=Pv(Re);if(Ot||isString$1(Re)){let Oe=!1;Ot&&isReactive(Re)&&(Oe=!isShallow(Re),Re=shallowReadArray(Re)),qe=new Array(Re.length);for(let Ue=0,Ot=Re.length;Ue<Ot;Ue++)qe[Ue]=Le(Oe?toReactive(Re[Ue]):Re[Ue],Ue,void 0,Ct)}else if("number"==typeof Re){qe=new Array(Re);for(let Oe=0;Oe<Re;Oe++)qe[Oe]=Le(Oe+1,Oe,void 0,Ct)}else if(isObject$4(Re))if(Re[Symbol.iterator])qe=Array.from(Re,((Re,Oe)=>Le(Re,Oe,void 0,Ct)));else{const Oe=Object.keys(Re);qe=new Array(Oe.length);for(let Ue=0,Ot=Oe.length;Ue<Ot;Ue++){const Ot=Oe[Ue];qe[Ue]=Le(Re[Ot],Ot,Ue,Ct)}}else qe=[];return qe}const getPublicInstance=Re=>Re?isStatefulComponent(Re)?getComponentPublicInstance(Re):getPublicInstance(Re.parent):null,Sb=kv(Object.create(null),{$:Re=>Re,$el:Re=>Re.vnode.el,$data:Re=>Re.data,$props:Re=>Re.props,$attrs:Re=>Re.attrs,$slots:Re=>Re.slots,$refs:Re=>Re.refs,$parent:Re=>getPublicInstance(Re.parent),$root:Re=>getPublicInstance(Re.root),$host:Re=>Re.ce,$emit:Re=>Re.emit,$options:Re=>resolveMergedOptions(Re),$forceUpdate:Re=>Re.f||(Re.f=()=>{queueJob(Re.update)}),$nextTick:Re=>Re.n||(Re.n=nextTick$1.bind(Re.proxy)),$watch:Re=>instanceWatch.bind(Re)}),hasSetupBinding=(Re,Le)=>Re!==Av&&!Re.__isScriptSetup&&hasOwn$1(Re,Le),Eb={get({_:Re},Le){if("__v_skip"===Le)return!0;const{ctx:Oe,setupState:Ue,data:qe,props:Ct,accessCache:Ot,type:Jt,appContext:Hr}=Re;let Jr;if("$"!==Le[0]){const Jt=Ot[Le];if(void 0!==Jt)switch(Jt){case 1:return Ue[Le];case 2:return qe[Le];case 4:return Oe[Le];case 3:return Ct[Le]}else{if(hasSetupBinding(Ue,Le))return Ot[Le]=1,Ue[Le];if(qe!==Av&&hasOwn$1(qe,Le))return Ot[Le]=2,qe[Le];if((Jr=Re.propsOptions[0])&&hasOwn$1(Jr,Le))return Ot[Le]=3,Ct[Le];if(Oe!==Av&&hasOwn$1(Oe,Le))return Ot[Le]=4,Oe[Le];Cb&&(Ot[Le]=0)}}const Ln=Sb[Le];let Nn,$n;return Ln?("$attrs"===Le&&track(Re.attrs,0,""),Ln(Re)):(Nn=Jt.__cssModules)&&(Nn=Nn[Le])?Nn:Oe!==Av&&hasOwn$1(Oe,Le)?(Ot[Le]=4,Oe[Le]):($n=Hr.config.globalProperties,hasOwn$1($n,Le)?$n[Le]:void 0)},set({_:Re},Le,Oe){const{data:Ue,setupState:qe,ctx:Ct}=Re;return hasSetupBinding(qe,Le)?(qe[Le]=Oe,!0):Ue!==Av&&hasOwn$1(Ue,Le)?(Ue[Le]=Oe,!0):!hasOwn$1(Re.props,Le)&&(("$"!==Le[0]||!(Le.slice(1)in Re))&&(Ct[Le]=Oe,!0))},has({_:{data:Re,setupState:Le,accessCache:Oe,ctx:Ue,appContext:qe,propsOptions:Ct}},Ot){let Jt;return!!Oe[Ot]||Re!==Av&&hasOwn$1(Re,Ot)||hasSetupBinding(Le,Ot)||(Jt=Ct[0])&&hasOwn$1(Jt,Ot)||hasOwn$1(Ue,Ot)||hasOwn$1(Sb,Ot)||hasOwn$1(qe.config.globalProperties,Ot)},defineProperty(Re,Le,Oe){return null!=Oe.get?Re._.accessCache[Le]=0:hasOwn$1(Oe,"value")&&this.set(Re,Le,Oe.value,null),Reflect.defineProperty(Re,Le,Oe)}};function normalizePropsOrEmits(Re){return Pv(Re)?Re.reduce(((Re,Le)=>(Re[Le]=null,Re)),{}):Re}function withAsyncContext(Re){const Le=getCurrentInstance();let Oe=Re();return unsetCurrentInstance(),isPromise$1(Oe)&&(Oe=Oe.catch((Re=>{throw setCurrentInstance(Le),Re}))),[Oe,()=>setCurrentInstance(Le)]}let Cb=!0;function applyOptions(Re){const Le=resolveMergedOptions(Re),Oe=Re.proxy,Ue=Re.ctx;Cb=!1,Le.beforeCreate&&callHook$1(Le.beforeCreate,Re,"bc");const{data:qe,computed:Ct,methods:Ot,watch:Jt,provide:Hr,inject:Jr,created:Ln,beforeMount:Nn,mounted:$n,beforeUpdate:Gn,updated:qn,activated:Zn,deactivated:Xn,beforeDestroy:Yn,beforeUnmount:_i,destroyed:vi,unmounted:xi,render:bi,renderTracked:Pi,renderTriggered:lo,errorCaptured:uo,serverPrefetch:po,expose:fo,inheritAttrs:Io,components:is,directives:as,filters:Is}=Le;if(Jr&&function(Re,Le){Pv(Re)&&(Re=normalizeInject(Re));for(const Oe in Re){const Ue=Re[Oe];let qe;qe=isObject$4(Ue)?"default"in Ue?inject(Ue.from||Oe,Ue.default,!0):inject(Ue.from||Oe):inject(Ue),isRef(qe)?Object.defineProperty(Le,Oe,{enumerable:!0,configurable:!0,get:()=>qe.value,set:Re=>qe.value=Re}):Le[Oe]=qe}}(Jr,Ue,null),Ot)for(const Re in Ot){const Le=Ot[Re];isFunction$1(Le)&&(Ue[Re]=Le.bind(Oe))}if(qe){const Le=qe.call(Oe,Oe);isObject$4(Le)&&(Re.data=reactive(Le))}if(Cb=!0,Ct)for(const Re in Ct){const Le=Ct[Re],qe=isFunction$1(Le)?Le.bind(Oe,Oe):isFunction$1(Le.get)?Le.get.bind(Oe,Oe):NOOP,Ot=!isFunction$1(Le)&&isFunction$1(Le.set)?Le.set.bind(Oe):NOOP,Jt=computed({get:qe,set:Ot});Object.defineProperty(Ue,Re,{enumerable:!0,configurable:!0,get:()=>Jt.value,set:Re=>Jt.value=Re})}if(Jt)for(const Re in Jt)createWatcher(Jt[Re],Ue,Oe,Re);if(Hr){const Re=isFunction$1(Hr)?Hr.call(Oe):Hr;Reflect.ownKeys(Re).forEach((Le=>{provide(Le,Re[Le])}))}function registerLifecycleHook(Re,Le){Pv(Le)?Le.forEach((Le=>Re(Le.bind(Oe)))):Le&&Re(Le.bind(Oe))}if(Ln&&callHook$1(Ln,Re,"c"),registerLifecycleHook(pb,Nn),registerLifecycleHook(fb,$n),registerLifecycleHook(mb,Gn),registerLifecycleHook(gb,qn),registerLifecycleHook(onActivated,Zn),registerLifecycleHook(onDeactivated,Xn),registerLifecycleHook(onErrorCaptured,uo),registerLifecycleHook(bb,Pi),registerLifecycleHook(xb,lo),registerLifecycleHook(_b,_i),registerLifecycleHook(yb,xi),registerLifecycleHook(vb,po),Pv(fo))if(fo.length){const Le=Re.exposed||(Re.exposed={});fo.forEach((Re=>{Object.defineProperty(Le,Re,{get:()=>Oe[Re],set:Le=>Oe[Re]=Le})}))}else Re.exposed||(Re.exposed={});bi&&Re.render===NOOP&&(Re.render=bi),null!=Io&&(Re.inheritAttrs=Io),is&&(Re.components=is),as&&(Re.directives=as),po&&markAsyncBoundary(Re)}function callHook$1(Re,Le,Oe){callWithAsyncErrorHandling(Pv(Re)?Re.map((Re=>Re.bind(Le.proxy))):Re.bind(Le.proxy),Le,Oe)}function createWatcher(Re,Le,Oe,Ue){let qe=Ue.includes(".")?createPathGetter(Oe,Ue):()=>Oe[Ue];if(isString$1(Re)){const Oe=Le[Re];isFunction$1(Oe)&&watch(qe,Oe)}else if(isFunction$1(Re))watch(qe,Re.bind(Oe));else if(isObject$4(Re))if(Pv(Re))Re.forEach((Re=>createWatcher(Re,Le,Oe,Ue)));else{const Ue=isFunction$1(Re.handler)?Re.handler.bind(Oe):Le[Re.handler];isFunction$1(Ue)&&watch(qe,Ue,Re)}}function resolveMergedOptions(Re){const Le=Re.type,{mixins:Oe,extends:Ue}=Le,{mixins:qe,optionsCache:Ct,config:{optionMergeStrategies:Ot}}=Re.appContext,Jt=Ct.get(Le);let Hr;return Jt?Hr=Jt:qe.length||Oe||Ue?(Hr={},qe.length&&qe.forEach((Re=>mergeOptions$1(Hr,Re,Ot,!0))),mergeOptions$1(Hr,Le,Ot)):Hr=Le,isObject$4(Le)&&Ct.set(Le,Hr),Hr}function mergeOptions$1(Re,Le,Oe,Ue=!1){const{mixins:qe,extends:Ct}=Le;Ct&&mergeOptions$1(Re,Ct,Oe,!0),qe&&qe.forEach((Le=>mergeOptions$1(Re,Le,Oe,!0)));for(const qe in Le)if(Ue&&"expose"===qe);else{const Ue=Ab[qe]||Oe&&Oe[qe];Re[qe]=Ue?Ue(Re[qe],Le[qe]):Le[qe]}return Re}const Ab={data:mergeDataFn,props:mergeEmitsOrPropsOptions,emits:mergeEmitsOrPropsOptions,methods:mergeObjectOptions,computed:mergeObjectOptions,beforeCreate:mergeAsArray,created:mergeAsArray,beforeMount:mergeAsArray,mounted:mergeAsArray,beforeUpdate:mergeAsArray,updated:mergeAsArray,beforeDestroy:mergeAsArray,beforeUnmount:mergeAsArray,destroyed:mergeAsArray,unmounted:mergeAsArray,activated:mergeAsArray,deactivated:mergeAsArray,errorCaptured:mergeAsArray,serverPrefetch:mergeAsArray,components:mergeObjectOptions,directives:mergeObjectOptions,watch:function(Re,Le){if(!Re)return Le;if(!Le)return Re;const Oe=kv(Object.create(null),Re);for(const Ue in Le)Oe[Ue]=mergeAsArray(Re[Ue],Le[Ue]);return Oe},provide:mergeDataFn,inject:function(Re,Le){return mergeObjectOptions(normalizeInject(Re),normalizeInject(Le))}};function mergeDataFn(Re,Le){return Le?Re?function(){return kv(isFunction$1(Re)?Re.call(this,this):Re,isFunction$1(Le)?Le.call(this,this):Le)}:Le:Re}function normalizeInject(Re){if(Pv(Re)){const Le={};for(let Oe=0;Oe<Re.length;Oe++)Le[Re[Oe]]=Re[Oe];return Le}return Re}function mergeAsArray(Re,Le){return Re?[...new Set([].concat(Re,Le))]:Le}function mergeObjectOptions(Re,Le){return Re?kv(Object.create(null),Re,Le):Le}function mergeEmitsOrPropsOptions(Re,Le){return Re?Pv(Re)&&Pv(Le)?[...new Set([...Re,...Le])]:kv(Object.create(null),normalizePropsOrEmits(Re),normalizePropsOrEmits(null!=Le?Le:{})):Le}function createAppContext(){return{app:null,config:{isNativeTag:NO,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Ib=0;function createAppAPI(Re,Le){return function(Oe,Ue=null){isFunction$1(Oe)||(Oe=kv({},Oe)),null==Ue||isObject$4(Ue)||(Ue=null);const qe=createAppContext(),Ct=new WeakSet,Ot=[];let Jt=!1;const Hr=qe.app={_uid:Ib++,_component:Oe,_props:Ue,_container:null,_context:qe,_instance:null,version:Kb,get config(){return qe.config},set config(Re){},use:(Re,...Le)=>(Ct.has(Re)||(Re&&isFunction$1(Re.install)?(Ct.add(Re),Re.install(Hr,...Le)):isFunction$1(Re)&&(Ct.add(Re),Re(Hr,...Le))),Hr),mixin:Re=>(qe.mixins.includes(Re)||qe.mixins.push(Re),Hr),component:(Re,Le)=>Le?(qe.components[Re]=Le,Hr):qe.components[Re],directive:(Re,Le)=>Le?(qe.directives[Re]=Le,Hr):qe.directives[Re],mount(Ct,Ot,Jr){if(!Jt){const Ln=Hr._ceVNode||createVNode(Oe,Ue);return Ln.appContext=qe,!0===Jr?Jr="svg":!1===Jr&&(Jr=void 0),Ot&&Le?Le(Ln,Ct):Re(Ln,Ct,Jr),Jt=!0,Hr._container=Ct,Ct.__vue_app__=Hr,getComponentPublicInstance(Ln.component)}},onUnmount(Re){Ot.push(Re)},unmount(){Jt&&(callWithAsyncErrorHandling(Ot,Hr._instance,16),Re(null,Hr._container),delete Hr._container.__vue_app__)},provide:(Re,Le)=>(qe.provides[Re]=Le,Hr),runWithContext(Re){const Le=kb;kb=Hr;try{return Re()}finally{kb=Le}}};return Hr}}let kb=null;function provide(Re,Le){if(qb){let Oe=qb.provides;const Ue=qb.parent&&qb.parent.provides;Ue===Oe&&(Oe=qb.provides=Object.create(Ue)),Oe[Re]=Le}else;}function inject(Re,Le,Oe=!1){const Ue=qb||ob;if(Ue||kb){const qe=kb?kb._context.provides:Ue?null==Ue.parent?Ue.vnode.appContext&&Ue.vnode.appContext.provides:Ue.parent.provides:void 0;if(qe&&Re in qe)return qe[Re];if(arguments.length>1)return Oe&&isFunction$1(Le)?Le.call(Ue&&Ue.proxy):Le}}function hasInjectionContext(){return!!(qb||ob||kb)}const Mb={},createInternalObject=()=>Object.create(Mb),isInternalObject=Re=>Object.getPrototypeOf(Re)===Mb;function setFullProps(Re,Le,Oe,Ue){const[qe,Ct]=Re.propsOptions;let Ot,Jt=!1;if(Le)for(let Hr in Le){if(Lv(Hr))continue;const Jr=Le[Hr];let Ln;qe&&hasOwn$1(qe,Ln=zv(Hr))?Ct&&Ct.includes(Ln)?(Ot||(Ot={}))[Ln]=Jr:Oe[Ln]=Jr:isEmitListener(Re.emitsOptions,Hr)||Hr in Ue&&Jr===Ue[Hr]||(Ue[Hr]=Jr,Jt=!0)}if(Ct){const Le=toRaw(Oe),Ue=Ot||Av;for(let Ot=0;Ot<Ct.length;Ot++){const Jt=Ct[Ot];Oe[Jt]=resolvePropValue(qe,Le,Jt,Ue[Jt],Re,!hasOwn$1(Ue,Jt))}}return Jt}function resolvePropValue(Re,Le,Oe,Ue,qe,Ct){const Ot=Re[Oe];if(null!=Ot){const Re=hasOwn$1(Ot,"default");if(Re&&void 0===Ue){const Re=Ot.default;if(Ot.type!==Function&&!Ot.skipFactory&&isFunction$1(Re)){const{propsDefaults:Ct}=qe;if(Oe in Ct)Ue=Ct[Oe];else{const Ot=setCurrentInstance(qe);Ue=Ct[Oe]=Re.call(null,Le),Ot()}}else Ue=Re;qe.ce&&qe.ce._setProp(Oe,Ue)}Ot[0]&&(Ct&&!Re?Ue=!1:!Ot[1]||""!==Ue&&Ue!==Bv(Oe)||(Ue=!0))}return Ue}const Pb=new WeakMap;function normalizePropsOptions(Re,Le,Oe=!1){const Ue=Oe?Pb:Le.propsCache,qe=Ue.get(Re);if(qe)return qe;const Ct=Re.props,Ot={},Jt=[];let Hr=!1;if(!isFunction$1(Re)){const extendProps=Re=>{Hr=!0;const[Oe,Ue]=normalizePropsOptions(Re,Le,!0);kv(Ot,Oe),Ue&&Jt.push(...Ue)};!Oe&&Le.mixins.length&&Le.mixins.forEach(extendProps),Re.extends&&extendProps(Re.extends),Re.mixins&&Re.mixins.forEach(extendProps)}if(!Ct&&!Hr)return isObject$4(Re)&&Ue.set(Re,Iv),Iv;if(Pv(Ct))for(let Re=0;Re<Ct.length;Re++){const Le=zv(Ct[Re]);validatePropName(Le)&&(Ot[Le]=Av)}else if(Ct)for(const Re in Ct){const Le=zv(Re);if(validatePropName(Le)){const Oe=Ct[Re],Ue=Ot[Le]=Pv(Oe)||isFunction$1(Oe)?{type:Oe}:kv({},Oe),qe=Ue.type;let Hr=!1,Jr=!0;if(Pv(qe))for(let Re=0;Re<qe.length;++Re){const Le=qe[Re],Oe=isFunction$1(Le)&&Le.name;if("Boolean"===Oe){Hr=!0;break}"String"===Oe&&(Jr=!1)}else Hr=isFunction$1(qe)&&"Boolean"===qe.name;Ue[0]=Hr,Ue[1]=Jr,(Hr||hasOwn$1(Ue,"default"))&&Jt.push(Le)}}const Jr=[Ot,Jt];return isObject$4(Re)&&Ue.set(Re,Jr),Jr}function validatePropName(Re){return"$"!==Re[0]&&!Lv(Re)}const isInternalKey=Re=>"_"===Re[0]||"$stable"===Re,normalizeSlotValue=Re=>Pv(Re)?Re.map(normalizeVNode$1):[normalizeVNode$1(Re)],normalizeSlot$1=(Re,Le,Oe)=>{if(Le._n)return Le;const Ue=withCtx(((...Re)=>normalizeSlotValue(Le(...Re))),Oe);return Ue._c=!1,Ue},normalizeObjectSlots=(Re,Le,Oe)=>{const Ue=Re._ctx;for(const Oe in Re){if(isInternalKey(Oe))continue;const qe=Re[Oe];if(isFunction$1(qe))Le[Oe]=normalizeSlot$1(0,qe,Ue);else if(null!=qe){const Re=normalizeSlotValue(qe);Le[Oe]=()=>Re}}},normalizeVNodeSlots=(Re,Le)=>{const Oe=normalizeSlotValue(Le);Re.slots.default=()=>Oe},assignSlots=(Re,Le,Oe)=>{for(const Ue in Le)(Oe||"_"!==Ue)&&(Re[Ue]=Le[Ue])},queuePostRenderEffect=function(Re,Le){Le&&Le.pendingBranch?Pv(Re)?Le.effects.push(...Re):Le.effects.push(Re):queuePostFlushCb(Re)};function createRenderer(Re){return function(Re){getGlobalThis().__VUE__=!0;const{insert:Le,remove:Oe,patchProp:Ue,createElement:qe,createText:Ct,createComment:Ot,setText:Jt,setElementText:Hr,parentNode:Jr,nextSibling:Ln,setScopeId:Nn=NOOP,insertStaticContent:$n}=Re,patch=(Re,Le,Oe,Ue=null,qe=null,Ct=null,Ot=void 0,Jt=null,Hr=!!Le.dynamicChildren)=>{if(Re===Le)return;Re&&!isSameVNodeType(Re,Le)&&(Ue=getNextHostNode(Re),unmount(Re,qe,Ct,!0),Re=null),-2===Le.patchFlag&&(Hr=!1,Le.dynamicChildren=null);const{type:Jr,ref:Ln,shapeFlag:Nn}=Le;switch(Jr){case Bb:processText(Re,Le,Oe,Ue);break;case Fb:processCommentNode(Re,Le,Oe,Ue);break;case Nb:null==Re&&mountStaticNode(Le,Oe,Ue,Ot);break;case Db:processFragment(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr);break;default:1&Nn?processElement(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr):6&Nn?processComponent(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr):(64&Nn||128&Nn)&&Jr.process(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,qn)}null!=Ln&&qe&&setRef(Ln,Re&&Re.ref,Ct,Le||Re,!Le)},processText=(Re,Oe,Ue,qe)=>{if(null==Re)Le(Oe.el=Ct(Oe.children),Ue,qe);else{const Le=Oe.el=Re.el;Oe.children!==Re.children&&Jt(Le,Oe.children)}},processCommentNode=(Re,Oe,Ue,qe)=>{null==Re?Le(Oe.el=Ot(Oe.children||""),Ue,qe):Oe.el=Re.el},mountStaticNode=(Re,Le,Oe,Ue)=>{[Re.el,Re.anchor]=$n(Re.children,Le,Oe,Ue,Re.el,Re.anchor)},moveStaticNode=({el:Re,anchor:Oe},Ue,qe)=>{let Ct;for(;Re&&Re!==Oe;)Ct=Ln(Re),Le(Re,Ue,qe),Re=Ct;Le(Oe,Ue,qe)},removeStaticNode=({el:Re,anchor:Le})=>{let Ue;for(;Re&&Re!==Le;)Ue=Ln(Re),Oe(Re),Re=Ue;Oe(Le)},processElement=(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr)=>{"svg"===Le.type?Ot="svg":"math"===Le.type&&(Ot="mathml"),null==Re?mountElement(Le,Oe,Ue,qe,Ct,Ot,Jt,Hr):patchElement(Re,Le,qe,Ct,Ot,Jt,Hr)},mountElement=(Re,Oe,Ct,Ot,Jt,Jr,Ln,Nn)=>{let $n,Gn;const{props:qn,shapeFlag:Zn,transition:Xn,dirs:Yn}=Re;if($n=Re.el=qe(Re.type,Jr,qn&&qn.is,qn),8&Zn?Hr($n,Re.children):16&Zn&&mountChildren(Re.children,$n,null,Ot,Jt,resolveChildrenNamespace(Re,Jr),Ln,Nn),Yn&&invokeDirectiveHook(Re,null,Ot,"created"),setScopeId($n,Re,Re.scopeId,Ln,Ot),qn){for(const Re in qn)"value"===Re||Lv(Re)||Ue($n,Re,null,qn[Re],Jr,Ot);"value"in qn&&Ue($n,"value",null,qn.value,Jr),(Gn=qn.onVnodeBeforeMount)&&invokeVNodeHook(Gn,Ot,Re)}Yn&&invokeDirectiveHook(Re,null,Ot,"beforeMount");const _i=function(Re,Le){return(!Re||Re&&!Re.pendingBranch)&&Le&&!Le.persisted}(Jt,Xn);_i&&Xn.beforeEnter($n),Le($n,Oe,Ct),((Gn=qn&&qn.onVnodeMounted)||_i||Yn)&&queuePostRenderEffect((()=>{Gn&&invokeVNodeHook(Gn,Ot,Re),_i&&Xn.enter($n),Yn&&invokeDirectiveHook(Re,null,Ot,"mounted")}),Jt)},setScopeId=(Re,Le,Oe,Ue,qe)=>{if(Oe&&Nn(Re,Oe),Ue)for(let Le=0;Le<Ue.length;Le++)Nn(Re,Ue[Le]);if(qe){let Oe=qe.subTree;if(Le===Oe||isSuspense(Oe.type)&&(Oe.ssContent===Le||Oe.ssFallback===Le)){const Le=qe.vnode;setScopeId(Re,Le,Le.scopeId,Le.slotScopeIds,qe.parent)}}},mountChildren=(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr=0)=>{for(let Jr=Hr;Jr<Re.length;Jr++){const Hr=Re[Jr]=Jt?cloneIfMounted(Re[Jr]):normalizeVNode$1(Re[Jr]);patch(null,Hr,Le,Oe,Ue,qe,Ct,Ot,Jt)}},patchElement=(Re,Le,Oe,qe,Ct,Ot,Jt)=>{const Jr=Le.el=Re.el;let{patchFlag:Ln,dynamicChildren:Nn,dirs:$n}=Le;Ln|=16&Re.patchFlag;const Gn=Re.props||Av,qn=Le.props||Av;let Zn;if(Oe&&toggleRecurse(Oe,!1),(Zn=qn.onVnodeBeforeUpdate)&&invokeVNodeHook(Zn,Oe,Le,Re),$n&&invokeDirectiveHook(Le,Re,Oe,"beforeUpdate"),Oe&&toggleRecurse(Oe,!0),(Gn.innerHTML&&null==qn.innerHTML||Gn.textContent&&null==qn.textContent)&&Hr(Jr,""),Nn?patchBlockChildren(Re.dynamicChildren,Nn,Jr,Oe,qe,resolveChildrenNamespace(Le,Ct),Ot):Jt||patchChildren(Re,Le,Jr,null,Oe,qe,resolveChildrenNamespace(Le,Ct),Ot,!1),Ln>0){if(16&Ln)patchProps(Jr,Gn,qn,Oe,Ct);else if(2&Ln&&Gn.class!==qn.class&&Ue(Jr,"class",null,qn.class,Ct),4&Ln&&Ue(Jr,"style",Gn.style,qn.style,Ct),8&Ln){const Re=Le.dynamicProps;for(let Le=0;Le<Re.length;Le++){const qe=Re[Le],Ot=Gn[qe],Jt=qn[qe];Jt===Ot&&"value"!==qe||Ue(Jr,qe,Ot,Jt,Ct,Oe)}}1&Ln&&Re.children!==Le.children&&Hr(Jr,Le.children)}else Jt||null!=Nn||patchProps(Jr,Gn,qn,Oe,Ct);((Zn=qn.onVnodeUpdated)||$n)&&queuePostRenderEffect((()=>{Zn&&invokeVNodeHook(Zn,Oe,Le,Re),$n&&invokeDirectiveHook(Le,Re,Oe,"updated")}),qe)},patchBlockChildren=(Re,Le,Oe,Ue,qe,Ct,Ot)=>{for(let Jt=0;Jt<Le.length;Jt++){const Hr=Re[Jt],Ln=Le[Jt],Nn=Hr.el&&(Hr.type===Db||!isSameVNodeType(Hr,Ln)||70&Hr.shapeFlag)?Jr(Hr.el):Oe;patch(Hr,Ln,Nn,null,Ue,qe,Ct,Ot,!0)}},patchProps=(Re,Le,Oe,qe,Ct)=>{if(Le!==Oe){if(Le!==Av)for(const Ot in Le)Lv(Ot)||Ot in Oe||Ue(Re,Ot,Le[Ot],null,Ct,qe);for(const Ot in Oe){if(Lv(Ot))continue;const Jt=Oe[Ot],Hr=Le[Ot];Jt!==Hr&&"value"!==Ot&&Ue(Re,Ot,Hr,Jt,Ct,qe)}"value"in Oe&&Ue(Re,"value",Le.value,Oe.value,Ct)}},processFragment=(Re,Oe,Ue,qe,Ot,Jt,Hr,Jr,Ln)=>{const Nn=Oe.el=Re?Re.el:Ct(""),$n=Oe.anchor=Re?Re.anchor:Ct("");let{patchFlag:Gn,dynamicChildren:qn,slotScopeIds:Zn}=Oe;Zn&&(Jr=Jr?Jr.concat(Zn):Zn),null==Re?(Le(Nn,Ue,qe),Le($n,Ue,qe),mountChildren(Oe.children||[],Ue,$n,Ot,Jt,Hr,Jr,Ln)):Gn>0&&64&Gn&&qn&&Re.dynamicChildren?(patchBlockChildren(Re.dynamicChildren,qn,Ue,Ot,Jt,Hr,Jr),(null!=Oe.key||Ot&&Oe===Ot.subTree)&&traverseStaticChildren(Re,Oe,!0)):patchChildren(Re,Oe,Ue,$n,Ot,Jt,Hr,Jr,Ln)},processComponent=(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr)=>{Le.slotScopeIds=Jt,null==Re?512&Le.shapeFlag?qe.ctx.activate(Le,Oe,Ue,Ot,Hr):mountComponent(Le,Oe,Ue,qe,Ct,Ot,Hr):updateComponent(Re,Le,Hr)},mountComponent=(Re,Le,Oe,Ue,qe,Ct,Ot)=>{const Jt=Re.component=createComponentInstance$1(Re,Ue,qe);if(isKeepAlive(Re)&&(Jt.ctx.renderer=qn),setupComponent$1(Jt,!1,Ot),Jt.asyncDep){if(qe&&qe.registerDep(Jt,setupRenderEffect,Ot),!Re.el){const Re=Jt.subTree=createVNode(Fb);processCommentNode(null,Re,Le,Oe)}}else setupRenderEffect(Jt,Re,Le,Oe,qe,Ct,Ot)},updateComponent=(Re,Le,Oe)=>{const Ue=Le.component=Re.component;if(function(Re,Le,Oe){const{props:Ue,children:qe,component:Ct}=Re,{props:Ot,children:Jt,patchFlag:Hr}=Le,Jr=Ct.emitsOptions;if(Le.dirs||Le.transition)return!0;if(!(Oe&&Hr>=0))return!(!qe&&!Jt||Jt&&Jt.$stable)||Ue!==Ot&&(Ue?!Ot||hasPropsChanged(Ue,Ot,Jr):!!Ot);if(1024&Hr)return!0;if(16&Hr)return Ue?hasPropsChanged(Ue,Ot,Jr):!!Ot;if(8&Hr){const Re=Le.dynamicProps;for(let Le=0;Le<Re.length;Le++){const Oe=Re[Le];if(Ot[Oe]!==Ue[Oe]&&!isEmitListener(Jr,Oe))return!0}}return!1}(Re,Le,Oe)){if(Ue.asyncDep&&!Ue.asyncResolved)return void updateComponentPreRender(Ue,Le,Oe);Ue.next=Le,Ue.update()}else Le.el=Re.el,Ue.vnode=Le},setupRenderEffect=(Re,Le,Oe,Ue,qe,Ct,Ot)=>{const componentUpdateFn=()=>{if(Re.isMounted){let{next:Le,bu:Oe,u:Ue,parent:Jt,vnode:Hr}=Re;{const Oe=locateNonHydratedAsyncRoot(Re);if(Oe)return Le&&(Le.el=Hr.el,updateComponentPreRender(Re,Le,Ot)),void Oe.asyncDep.then((()=>{Re.isUnmounted||componentUpdateFn()}))}let Ln,Nn=Le;toggleRecurse(Re,!1),Le?(Le.el=Hr.el,updateComponentPreRender(Re,Le,Ot)):Le=Hr,Oe&&invokeArrayFns(Oe),(Ln=Le.props&&Le.props.onVnodeBeforeUpdate)&&invokeVNodeHook(Ln,Jt,Le,Hr),toggleRecurse(Re,!0);const $n=renderComponentRoot$1(Re),Gn=Re.subTree;Re.subTree=$n,patch(Gn,$n,Jr(Gn.el),getNextHostNode(Gn),Re,qe,Ct),Le.el=$n.el,null===Nn&&updateHOCHostEl(Re,$n.el),Ue&&queuePostRenderEffect(Ue,qe),(Ln=Le.props&&Le.props.onVnodeUpdated)&&queuePostRenderEffect((()=>invokeVNodeHook(Ln,Jt,Le,Hr)),qe)}else{let Ot;const{el:Jt,props:Hr}=Le,{bm:Jr,m:Ln,parent:Nn,root:$n,type:Gn}=Re,qn=isAsyncWrapper(Le);if(toggleRecurse(Re,!1),Jr&&invokeArrayFns(Jr),!qn&&(Ot=Hr&&Hr.onVnodeBeforeMount)&&invokeVNodeHook(Ot,Nn,Le),toggleRecurse(Re,!0),Jt&&Xn){const hydrateSubTree=()=>{Re.subTree=renderComponentRoot$1(Re),Xn(Jt,Re.subTree,Re,qe,null)};qn&&Gn.__asyncHydrate?Gn.__asyncHydrate(Jt,Re,hydrateSubTree):hydrateSubTree()}else{$n.ce&&$n.ce._injectChildStyle(Gn);const Ot=Re.subTree=renderComponentRoot$1(Re);patch(null,Ot,Oe,Ue,Re,qe,Ct),Le.el=Ot.el}if(Ln&&queuePostRenderEffect(Ln,qe),!qn&&(Ot=Hr&&Hr.onVnodeMounted)){const Re=Le;queuePostRenderEffect((()=>invokeVNodeHook(Ot,Nn,Re)),qe)}(256&Le.shapeFlag||Nn&&isAsyncWrapper(Nn.vnode)&&256&Nn.vnode.shapeFlag)&&Re.a&&queuePostRenderEffect(Re.a,qe),Re.isMounted=!0,Le=Oe=Ue=null}};Re.scope.on();const Jt=Re.effect=new ReactiveEffect(componentUpdateFn);Re.scope.off();const Hr=Re.update=Jt.run.bind(Jt),Ln=Re.job=Jt.runIfDirty.bind(Jt);Ln.i=Re,Ln.id=Re.uid,Jt.scheduler=()=>queueJob(Ln),toggleRecurse(Re,!0),Hr()},updateComponentPreRender=(Re,Le,Oe)=>{Le.component=Re;const Ue=Re.vnode.props;Re.vnode=Le,Re.next=null,function(Re,Le,Oe,Ue){const{props:qe,attrs:Ct,vnode:{patchFlag:Ot}}=Re,Jt=toRaw(qe),[Hr]=Re.propsOptions;let Jr=!1;if(!(Ue||Ot>0)||16&Ot){let Ue;setFullProps(Re,Le,qe,Ct)&&(Jr=!0);for(const Ct in Jt)Le&&(hasOwn$1(Le,Ct)||(Ue=Bv(Ct))!==Ct&&hasOwn$1(Le,Ue))||(Hr?!Oe||void 0===Oe[Ct]&&void 0===Oe[Ue]||(qe[Ct]=resolvePropValue(Hr,Jt,Ct,void 0,Re,!0)):delete qe[Ct]);if(Ct!==Jt)for(const Re in Ct)Le&&hasOwn$1(Le,Re)||(delete Ct[Re],Jr=!0)}else if(8&Ot){const Oe=Re.vnode.dynamicProps;for(let Ue=0;Ue<Oe.length;Ue++){let Ot=Oe[Ue];if(isEmitListener(Re.emitsOptions,Ot))continue;const Ln=Le[Ot];if(Hr)if(hasOwn$1(Ct,Ot))Ln!==Ct[Ot]&&(Ct[Ot]=Ln,Jr=!0);else{const Le=zv(Ot);qe[Le]=resolvePropValue(Hr,Jt,Le,Ln,Re,!1)}else Ln!==Ct[Ot]&&(Ct[Ot]=Ln,Jr=!0)}}Jr&&trigger(Re.attrs,"set","")}(Re,Le.props,Ue,Oe),((Re,Le,Oe)=>{const{vnode:Ue,slots:qe}=Re;let Ct=!0,Ot=Av;if(32&Ue.shapeFlag){const Re=Le._;Re?Oe&&1===Re?Ct=!1:assignSlots(qe,Le,Oe):(Ct=!Le.$stable,normalizeObjectSlots(Le,qe)),Ot=Le}else Le&&(normalizeVNodeSlots(Re,Le),Ot={default:1});if(Ct)for(const Re in qe)isInternalKey(Re)||null!=Ot[Re]||delete qe[Re]})(Re,Le.children,Oe),pauseTracking(),flushPreFlushCbs(Re),resetTracking()},patchChildren=(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Jr=!1)=>{const Ln=Re&&Re.children,Nn=Re?Re.shapeFlag:0,$n=Le.children,{patchFlag:Gn,shapeFlag:qn}=Le;if(Gn>0){if(128&Gn)return void patchKeyedChildren(Ln,$n,Oe,Ue,qe,Ct,Ot,Jt,Jr);if(256&Gn)return void patchUnkeyedChildren(Ln,$n,Oe,Ue,qe,Ct,Ot,Jt,Jr)}8&qn?(16&Nn&&unmountChildren(Ln,qe,Ct),$n!==Ln&&Hr(Oe,$n)):16&Nn?16&qn?patchKeyedChildren(Ln,$n,Oe,Ue,qe,Ct,Ot,Jt,Jr):unmountChildren(Ln,qe,Ct,!0):(8&Nn&&Hr(Oe,""),16&qn&&mountChildren($n,Oe,Ue,qe,Ct,Ot,Jt,Jr))},patchUnkeyedChildren=(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr)=>{Le=Le||Iv;const Jr=(Re=Re||Iv).length,Ln=Le.length,Nn=Math.min(Jr,Ln);let $n;for($n=0;$n<Nn;$n++){const Ue=Le[$n]=Hr?cloneIfMounted(Le[$n]):normalizeVNode$1(Le[$n]);patch(Re[$n],Ue,Oe,null,qe,Ct,Ot,Jt,Hr)}Jr>Ln?unmountChildren(Re,qe,Ct,!0,!1,Nn):mountChildren(Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Nn)},patchKeyedChildren=(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr)=>{let Jr=0;const Ln=Le.length;let Nn=Re.length-1,$n=Ln-1;for(;Jr<=Nn&&Jr<=$n;){const Ue=Re[Jr],Ln=Le[Jr]=Hr?cloneIfMounted(Le[Jr]):normalizeVNode$1(Le[Jr]);if(!isSameVNodeType(Ue,Ln))break;patch(Ue,Ln,Oe,null,qe,Ct,Ot,Jt,Hr),Jr++}for(;Jr<=Nn&&Jr<=$n;){const Ue=Re[Nn],Jr=Le[$n]=Hr?cloneIfMounted(Le[$n]):normalizeVNode$1(Le[$n]);if(!isSameVNodeType(Ue,Jr))break;patch(Ue,Jr,Oe,null,qe,Ct,Ot,Jt,Hr),Nn--,$n--}if(Jr>Nn){if(Jr<=$n){const Re=$n+1,Nn=Re<Ln?Le[Re].el:Ue;for(;Jr<=$n;)patch(null,Le[Jr]=Hr?cloneIfMounted(Le[Jr]):normalizeVNode$1(Le[Jr]),Oe,Nn,qe,Ct,Ot,Jt,Hr),Jr++}}else if(Jr>$n)for(;Jr<=Nn;)unmount(Re[Jr],qe,Ct,!0),Jr++;else{const Gn=Jr,qn=Jr,Zn=new Map;for(Jr=qn;Jr<=$n;Jr++){const Re=Le[Jr]=Hr?cloneIfMounted(Le[Jr]):normalizeVNode$1(Le[Jr]);null!=Re.key&&Zn.set(Re.key,Jr)}let Xn,Yn=0;const _i=$n-qn+1;let vi=!1,xi=0;const bi=new Array(_i);for(Jr=0;Jr<_i;Jr++)bi[Jr]=0;for(Jr=Gn;Jr<=Nn;Jr++){const Ue=Re[Jr];if(Yn>=_i){unmount(Ue,qe,Ct,!0);continue}let Ln;if(null!=Ue.key)Ln=Zn.get(Ue.key);else for(Xn=qn;Xn<=$n;Xn++)if(0===bi[Xn-qn]&&isSameVNodeType(Ue,Le[Xn])){Ln=Xn;break}void 0===Ln?unmount(Ue,qe,Ct,!0):(bi[Ln-qn]=Jr+1,Ln>=xi?xi=Ln:vi=!0,patch(Ue,Le[Ln],Oe,null,qe,Ct,Ot,Jt,Hr),Yn++)}const Pi=vi?function(Re){const Le=Re.slice(),Oe=[0];let Ue,qe,Ct,Ot,Jt;const Hr=Re.length;for(Ue=0;Ue<Hr;Ue++){const Hr=Re[Ue];if(0!==Hr){if(qe=Oe[Oe.length-1],Re[qe]<Hr){Le[Ue]=qe,Oe.push(Ue);continue}for(Ct=0,Ot=Oe.length-1;Ct<Ot;)Jt=Ct+Ot>>1,Re[Oe[Jt]]<Hr?Ct=Jt+1:Ot=Jt;Hr<Re[Oe[Ct]]&&(Ct>0&&(Le[Ue]=Oe[Ct-1]),Oe[Ct]=Ue)}}Ct=Oe.length,Ot=Oe[Ct-1];for(;Ct-- >0;)Oe[Ct]=Ot,Ot=Le[Ot];return Oe}(bi):Iv;for(Xn=Pi.length-1,Jr=_i-1;Jr>=0;Jr--){const Re=qn+Jr,Nn=Le[Re],$n=Re+1<Ln?Le[Re+1].el:Ue;0===bi[Jr]?patch(null,Nn,Oe,$n,qe,Ct,Ot,Jt,Hr):vi&&(Xn<0||Jr!==Pi[Xn]?move(Nn,Oe,$n,2):Xn--)}}},move=(Re,Oe,Ue,qe,Ct=null)=>{const{el:Ot,type:Jt,transition:Hr,children:Jr,shapeFlag:Ln}=Re;if(6&Ln)return void move(Re.component.subTree,Oe,Ue,qe);if(128&Ln)return void Re.suspense.move(Oe,Ue,qe);if(64&Ln)return void Jt.move(Re,Oe,Ue,qn);if(Jt===Db){Le(Ot,Oe,Ue);for(let Re=0;Re<Jr.length;Re++)move(Jr[Re],Oe,Ue,qe);return void Le(Re.anchor,Oe,Ue)}if(Jt===Nb)return void moveStaticNode(Re,Oe,Ue);if(2!==qe&&1&Ln&&Hr)if(0===qe)Hr.beforeEnter(Ot),Le(Ot,Oe,Ue),queuePostRenderEffect((()=>Hr.enter(Ot)),Ct);else{const{leave:Re,delayLeave:qe,afterLeave:Ct}=Hr,remove2=()=>Le(Ot,Oe,Ue),performLeave=()=>{Re(Ot,(()=>{remove2(),Ct&&Ct()}))};qe?qe(Ot,remove2,performLeave):performLeave()}else Le(Ot,Oe,Ue)},unmount=(Re,Le,Oe,Ue=!1,qe=!1)=>{const{type:Ct,props:Ot,ref:Jt,children:Hr,dynamicChildren:Jr,shapeFlag:Ln,patchFlag:Nn,dirs:$n,cacheIndex:Gn}=Re;if(-2===Nn&&(qe=!1),null!=Jt&&setRef(Jt,null,Oe,Re,!0),null!=Gn&&(Le.renderCache[Gn]=void 0),256&Ln)return void Le.ctx.deactivate(Re);const Zn=1&Ln&&$n,Xn=!isAsyncWrapper(Re);let Yn;if(Xn&&(Yn=Ot&&Ot.onVnodeBeforeUnmount)&&invokeVNodeHook(Yn,Le,Re),6&Ln)unmountComponent(Re.component,Oe,Ue);else{if(128&Ln)return void Re.suspense.unmount(Oe,Ue);Zn&&invokeDirectiveHook(Re,null,Le,"beforeUnmount"),64&Ln?Re.type.remove(Re,Le,Oe,qn,Ue):Jr&&!Jr.hasOnce&&(Ct!==Db||Nn>0&&64&Nn)?unmountChildren(Jr,Le,Oe,!1,!0):(Ct===Db&&384&Nn||!qe&&16&Ln)&&unmountChildren(Hr,Le,Oe),Ue&&remove(Re)}(Xn&&(Yn=Ot&&Ot.onVnodeUnmounted)||Zn)&&queuePostRenderEffect((()=>{Yn&&invokeVNodeHook(Yn,Le,Re),Zn&&invokeDirectiveHook(Re,null,Le,"unmounted")}),Oe)},remove=Re=>{const{type:Le,el:Ue,anchor:qe,transition:Ct}=Re;if(Le===Db)return void removeFragment(Ue,qe);if(Le===Nb)return void removeStaticNode(Re);const performRemove=()=>{Oe(Ue),Ct&&!Ct.persisted&&Ct.afterLeave&&Ct.afterLeave()};if(1&Re.shapeFlag&&Ct&&!Ct.persisted){const{leave:Le,delayLeave:Oe}=Ct,performLeave=()=>Le(Ue,performRemove);Oe?Oe(Re.el,performRemove,performLeave):performLeave()}else performRemove()},removeFragment=(Re,Le)=>{let Ue;for(;Re!==Le;)Ue=Ln(Re),Oe(Re),Re=Ue;Oe(Le)},unmountComponent=(Re,Le,Oe)=>{const{bum:Ue,scope:qe,job:Ct,subTree:Ot,um:Jt,m:Hr,a:Jr}=Re;invalidateMount(Hr),invalidateMount(Jr),Ue&&invokeArrayFns(Ue),qe.stop(),Ct&&(Ct.flags|=8,unmount(Ot,Re,Le,Oe)),Jt&&queuePostRenderEffect(Jt,Le),queuePostRenderEffect((()=>{Re.isUnmounted=!0}),Le),Le&&Le.pendingBranch&&!Le.isUnmounted&&Re.asyncDep&&!Re.asyncResolved&&Re.suspenseId===Le.pendingId&&(Le.deps--,0===Le.deps&&Le.resolve())},unmountChildren=(Re,Le,Oe,Ue=!1,qe=!1,Ct=0)=>{for(let Ot=Ct;Ot<Re.length;Ot++)unmount(Re[Ot],Le,Oe,Ue,qe)},getNextHostNode=Re=>{if(6&Re.shapeFlag)return getNextHostNode(Re.component.subTree);if(128&Re.shapeFlag)return Re.suspense.next();const Le=Ln(Re.anchor||Re.el),Oe=Le&&Le[ab];return Oe?Ln(Oe):Le};let Gn=!1;const render=(Re,Le,Oe)=>{null==Re?Le._vnode&&unmount(Le._vnode,null,null,!0):patch(Le._vnode||null,Re,Le,null,null,null,Oe),Le._vnode=Re,Gn||(Gn=!0,flushPreFlushCbs(),flushPostFlushCbs(),Gn=!1)},qn={p:patch,um:unmount,m:move,r:remove,mt:mountComponent,mc:mountChildren,pc:patchChildren,pbc:patchBlockChildren,n:getNextHostNode,o:Re};let Zn,Xn;return{render:render,hydrate:Zn,createApp:createAppAPI(render,Zn)}}(Re)}function resolveChildrenNamespace({type:Re,props:Le},Oe){return"svg"===Oe&&"foreignObject"===Re||"mathml"===Oe&&"annotation-xml"===Re&&Le&&Le.encoding&&Le.encoding.includes("html")?void 0:Oe}function toggleRecurse({effect:Re,job:Le},Oe){Oe?(Re.flags|=32,Le.flags|=4):(Re.flags&=-33,Le.flags&=-5)}function traverseStaticChildren(Re,Le,Oe=!1){const Ue=Re.children,qe=Le.children;if(Pv(Ue)&&Pv(qe))for(let Re=0;Re<Ue.length;Re++){const Le=Ue[Re];let Ct=qe[Re];1&Ct.shapeFlag&&!Ct.dynamicChildren&&((Ct.patchFlag<=0||32===Ct.patchFlag)&&(Ct=qe[Re]=cloneIfMounted(qe[Re]),Ct.el=Le.el),Oe||-2===Ct.patchFlag||traverseStaticChildren(Le,Ct)),Ct.type===Bb&&(Ct.el=Le.el)}}function locateNonHydratedAsyncRoot(Re){const Le=Re.subTree.component;if(Le)return Le.asyncDep&&!Le.asyncResolved?Le:locateNonHydratedAsyncRoot(Le)}function invalidateMount(Re){if(Re)for(let Le=0;Le<Re.length;Le++)Re[Le].flags|=8}const Rb=Symbol.for("v-scx"),useSSRContext=()=>inject(Rb);function watch(Re,Le,Oe){return doWatch(Re,Le,Oe)}function doWatch(Re,Le,Oe=Av){const{immediate:Ue,deep:qe,flush:Ct,once:Ot}=Oe,Jt=kv({},Oe),Hr=Le&&Ue||!Le&&"post"!==Ct;let Jr;if(Xb)if("sync"===Ct){const Re=useSSRContext();Jr=Re.__watcherHandles||(Re.__watcherHandles=[])}else if(!Hr){const watchStopHandle=()=>{};return watchStopHandle.stop=NOOP,watchStopHandle.resume=NOOP,watchStopHandle.pause=NOOP,watchStopHandle}const Ln=qb;Jt.call=(Re,Le,Oe)=>callWithAsyncErrorHandling(Re,Ln,Le,Oe);let Nn=!1;"post"===Ct?Jt.scheduler=Re=>{queuePostRenderEffect(Re,Ln&&Ln.suspense)}:"sync"!==Ct&&(Nn=!0,Jt.scheduler=(Re,Le)=>{Le?Re():queueJob(Re)}),Jt.augmentJob=Re=>{Le&&(Re.flags|=4),Nn&&(Re.flags|=2,Ln&&(Re.id=Ln.uid,Re.i=Ln))};const $n=watch$1(Re,Le,Jt);return Xb&&(Jr?Jr.push($n):Hr&&$n()),$n}function instanceWatch(Re,Le,Oe){const Ue=this.proxy,qe=isString$1(Re)?Re.includes(".")?createPathGetter(Ue,Re):()=>Ue[Re]:Re.bind(Ue,Ue);let Ct;isFunction$1(Le)?Ct=Le:(Ct=Le.handler,Oe=Le);const Ot=setCurrentInstance(this),Jt=doWatch(qe,Ct.bind(Ue),Oe);return Ot(),Jt}function createPathGetter(Re,Le){const Oe=Le.split(".");return()=>{let Le=Re;for(let Re=0;Re<Oe.length&&Le;Re++)Le=Le[Oe[Re]];return Le}}const getModelModifiers=(Re,Le)=>"modelValue"===Le||"model-value"===Le?Re.modelModifiers:Re[`${Le}Modifiers`]||Re[`${zv(Le)}Modifiers`]||Re[`${Bv(Le)}Modifiers`];function emit(Re,Le,...Oe){if(Re.isUnmounted)return;const Ue=Re.vnode.props||Av;let qe=Oe;const Ct=Le.startsWith("update:"),Ot=Ct&&getModelModifiers(Ue,Le.slice(7));let Jt;Ot&&(Ot.trim&&(qe=Oe.map((Re=>isString$1(Re)?Re.trim():Re))),Ot.number&&(qe=Oe.map(looseToNumber)));let Hr=Ue[Jt=Nv(Le)]||Ue[Jt=Nv(zv(Le))];!Hr&&Ct&&(Hr=Ue[Jt=Nv(Bv(Le))]),Hr&&callWithAsyncErrorHandling(Hr,Re,6,qe);const Jr=Ue[Jt+"Once"];if(Jr){if(Re.emitted){if(Re.emitted[Jt])return}else Re.emitted={};Re.emitted[Jt]=!0,callWithAsyncErrorHandling(Jr,Re,6,qe)}}function normalizeEmitsOptions(Re,Le,Oe=!1){const Ue=Le.emitsCache,qe=Ue.get(Re);if(void 0!==qe)return qe;const Ct=Re.emits;let Ot={},Jt=!1;if(!isFunction$1(Re)){const extendEmits=Re=>{const Oe=normalizeEmitsOptions(Re,Le,!0);Oe&&(Jt=!0,kv(Ot,Oe))};!Oe&&Le.mixins.length&&Le.mixins.forEach(extendEmits),Re.extends&&extendEmits(Re.extends),Re.mixins&&Re.mixins.forEach(extendEmits)}return Ct||Jt?(Pv(Ct)?Ct.forEach((Re=>Ot[Re]=null)):kv(Ot,Ct),isObject$4(Re)&&Ue.set(Re,Ot),Ot):(isObject$4(Re)&&Ue.set(Re,null),null)}function isEmitListener(Re,Le){return!(!Re||!isOn(Le))&&(Le=Le.slice(2).replace(/Once$/,""),hasOwn$1(Re,Le[0].toLowerCase()+Le.slice(1))||hasOwn$1(Re,Bv(Le))||hasOwn$1(Re,Le))}function renderComponentRoot$1(Re){const{type:Le,vnode:Oe,proxy:Ue,withProxy:qe,propsOptions:[Ct],slots:Ot,attrs:Jt,emit:Hr,render:Jr,renderCache:Ln,props:Nn,data:$n,setupState:Gn,ctx:qn,inheritAttrs:Zn}=Re,Xn=setCurrentRenderingInstance$1(Re);let Yn,_i;try{if(4&Oe.shapeFlag){const Re=qe||Ue,Le=Re;Yn=normalizeVNode$1(Jr.call(Le,Re,Ln,Nn,Gn,$n,qn)),_i=Jt}else{const Re=Le;0,Yn=normalizeVNode$1(Re.length>1?Re(Nn,{attrs:Jt,slots:Ot,emit:Hr}):Re(Nn,null)),_i=Le.props?Jt:getFunctionalFallthrough(Jt)}}catch(Le){jb.length=0,handleError(Le,Re,1),Yn=createVNode(Fb)}let vi=Yn;if(_i&&!1!==Zn){const Re=Object.keys(_i),{shapeFlag:Le}=vi;Re.length&&7&Le&&(Ct&&Re.some(isModelListener)&&(_i=filterModelListeners(_i,Ct)),vi=cloneVNode(vi,_i,!1,!0))}return Oe.dirs&&(vi=cloneVNode(vi,null,!1,!0),vi.dirs=vi.dirs?vi.dirs.concat(Oe.dirs):Oe.dirs),Oe.transition&&setTransitionHooks(vi,Oe.transition),Yn=vi,setCurrentRenderingInstance$1(Xn),Yn}const getFunctionalFallthrough=Re=>{let Le;for(const Oe in Re)("class"===Oe||"style"===Oe||isOn(Oe))&&((Le||(Le={}))[Oe]=Re[Oe]);return Le},filterModelListeners=(Re,Le)=>{const Oe={};for(const Ue in Re)isModelListener(Ue)&&Ue.slice(9)in Le||(Oe[Ue]=Re[Ue]);return Oe};function hasPropsChanged(Re,Le,Oe){const Ue=Object.keys(Le);if(Ue.length!==Object.keys(Re).length)return!0;for(let qe=0;qe<Ue.length;qe++){const Ct=Ue[qe];if(Le[Ct]!==Re[Ct]&&!isEmitListener(Oe,Ct))return!0}return!1}function updateHOCHostEl({vnode:Re,parent:Le},Oe){for(;Le;){const Ue=Le.subTree;if(Ue.suspense&&Ue.suspense.activeBranch===Re&&(Ue.el=Re.el),Ue!==Re)break;(Re=Le.vnode).el=Oe,Le=Le.parent}}const isSuspense=Re=>Re.__isSuspense;let Lb=0;const Ob={name:"Suspense",__isSuspense:!0,process(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr){if(null==Re)!function(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr){const{p:Jr,o:{createElement:Ln}}=Hr,Nn=Ln("div"),$n=Re.suspense=createSuspenseBoundary(Re,qe,Ue,Le,Nn,Oe,Ct,Ot,Jt,Hr);Jr(null,$n.pendingBranch=Re.ssContent,Nn,null,Ue,$n,Ct,Ot),$n.deps>0?(triggerEvent(Re,"onPending"),triggerEvent(Re,"onFallback"),Jr(null,Re.ssFallback,Le,Oe,Ue,null,Ct,Ot),setActiveBranch($n,Re.ssFallback)):$n.resolve(!1,!0)}(Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr);else{if(Ct&&Ct.deps>0&&!Re.suspense.isInFallback)return Le.suspense=Re.suspense,Le.suspense.vnode=Le,void(Le.el=Re.el);!function(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,{p:Hr,um:Jr,o:{createElement:Ln}}){const Nn=Le.suspense=Re.suspense;Nn.vnode=Le,Le.el=Re.el;const $n=Le.ssContent,Gn=Le.ssFallback,{activeBranch:qn,pendingBranch:Zn,isInFallback:Xn,isHydrating:Yn}=Nn;if(Zn)Nn.pendingBranch=$n,isSameVNodeType($n,Zn)?(Hr(Zn,$n,Nn.hiddenContainer,null,qe,Nn,Ct,Ot,Jt),Nn.deps<=0?Nn.resolve():Xn&&(Yn||(Hr(qn,Gn,Oe,Ue,qe,null,Ct,Ot,Jt),setActiveBranch(Nn,Gn)))):(Nn.pendingId=Lb++,Yn?(Nn.isHydrating=!1,Nn.activeBranch=Zn):Jr(Zn,qe,Nn),Nn.deps=0,Nn.effects.length=0,Nn.hiddenContainer=Ln("div"),Xn?(Hr(null,$n,Nn.hiddenContainer,null,qe,Nn,Ct,Ot,Jt),Nn.deps<=0?Nn.resolve():(Hr(qn,Gn,Oe,Ue,qe,null,Ct,Ot,Jt),setActiveBranch(Nn,Gn))):qn&&isSameVNodeType($n,qn)?(Hr(qn,$n,Oe,Ue,qe,Nn,Ct,Ot,Jt),Nn.resolve(!0)):(Hr(null,$n,Nn.hiddenContainer,null,qe,Nn,Ct,Ot,Jt),Nn.deps<=0&&Nn.resolve()));else if(qn&&isSameVNodeType($n,qn))Hr(qn,$n,Oe,Ue,qe,Nn,Ct,Ot,Jt),setActiveBranch(Nn,$n);else if(triggerEvent(Le,"onPending"),Nn.pendingBranch=$n,512&$n.shapeFlag?Nn.pendingId=$n.component.suspenseId:Nn.pendingId=Lb++,Hr(null,$n,Nn.hiddenContainer,null,qe,Nn,Ct,Ot,Jt),Nn.deps<=0)Nn.resolve();else{const{timeout:Re,pendingId:Le}=Nn;Re>0?setTimeout((()=>{Nn.pendingId===Le&&Nn.fallback(Gn)}),Re):0===Re&&Nn.fallback(Gn)}}(Re,Le,Oe,Ue,qe,Ot,Jt,Hr,Jr)}},hydrate:function(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr){const Jr=Le.suspense=createSuspenseBoundary(Le,Ue,Oe,Re.parentNode,document.createElement("div"),null,qe,Ct,Ot,Jt,!0),Ln=Hr(Re,Jr.pendingBranch=Le.ssContent,Oe,Jr,Ct,Ot);0===Jr.deps&&Jr.resolve(!1,!0);return Ln},normalize:function(Re){const{shapeFlag:Le,children:Oe}=Re,Ue=32&Le;Re.ssContent=normalizeSuspenseSlot(Ue?Oe.default:Oe),Re.ssFallback=Ue?normalizeSuspenseSlot(Oe.fallback):createVNode(Fb)}},zb=Ob;function triggerEvent(Re,Le){const Oe=Re.props&&Re.props[Le];isFunction$1(Oe)&&Oe()}function createSuspenseBoundary(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr,Ln=!1){const{p:Nn,m:$n,um:Gn,n:qn,o:{parentNode:Zn,remove:Xn}}=Jr;let Yn;const _i=function(Re){const Le=Re.props&&Re.props.suspensible;return null!=Le&&!1!==Le}(Re);_i&&Le&&Le.pendingBranch&&(Yn=Le.pendingId,Le.deps++);const vi=Re.props?toNumber(Re.props.timeout):void 0,xi=Ct,bi={vnode:Re,parent:Le,parentComponent:Oe,namespace:Ot,container:Ue,hiddenContainer:qe,deps:0,pendingId:Lb++,timeout:"number"==typeof vi?vi:-1,activeBranch:null,pendingBranch:null,isInFallback:!Ln,isHydrating:Ln,isUnmounted:!1,effects:[],resolve(Re=!1,Oe=!1){const{vnode:Ue,activeBranch:qe,pendingBranch:Ot,pendingId:Jt,effects:Hr,parentComponent:Jr,container:Ln}=bi;let Nn=!1;bi.isHydrating?bi.isHydrating=!1:Re||(Nn=qe&&Ot.transition&&"out-in"===Ot.transition.mode,Nn&&(qe.transition.afterLeave=()=>{Jt===bi.pendingId&&($n(Ot,Ln,Ct===xi?qn(qe):Ct,0),queuePostFlushCb(Hr))}),qe&&(Zn(qe.el)===Ln&&(Ct=qn(qe)),Gn(qe,Jr,bi,!0)),Nn||$n(Ot,Ln,Ct,0)),setActiveBranch(bi,Ot),bi.pendingBranch=null,bi.isInFallback=!1;let Xn=bi.parent,vi=!1;for(;Xn;){if(Xn.pendingBranch){Xn.effects.push(...Hr),vi=!0;break}Xn=Xn.parent}vi||Nn||queuePostFlushCb(Hr),bi.effects=[],_i&&Le&&Le.pendingBranch&&Yn===Le.pendingId&&(Le.deps--,0!==Le.deps||Oe||Le.resolve()),triggerEvent(Ue,"onResolve")},fallback(Re){if(!bi.pendingBranch)return;const{vnode:Le,activeBranch:Oe,parentComponent:Ue,container:qe,namespace:Ct}=bi;triggerEvent(Le,"onFallback");const Ot=qn(Oe),mountFallback=()=>{bi.isInFallback&&(Nn(null,Re,qe,Ot,Ue,null,Ct,Jt,Hr),setActiveBranch(bi,Re))},Jr=Re.transition&&"out-in"===Re.transition.mode;Jr&&(Oe.transition.afterLeave=mountFallback),bi.isInFallback=!0,Gn(Oe,Ue,null,!0),Jr||mountFallback()},move(Re,Le,Oe){bi.activeBranch&&$n(bi.activeBranch,Re,Le,Oe),bi.container=Re},next:()=>bi.activeBranch&&qn(bi.activeBranch),registerDep(Re,Le,Oe){const Ue=!!bi.pendingBranch;Ue&&bi.deps++;const qe=Re.vnode.el;Re.asyncDep.catch((Le=>{handleError(Le,Re,0)})).then((Ct=>{if(Re.isUnmounted||bi.isUnmounted||bi.pendingId!==Re.suspenseId)return;Re.asyncResolved=!0;const{vnode:Jt}=Re;handleSetupResult(Re,Ct,!1),qe&&(Jt.el=qe);const Hr=!qe&&Re.subTree.el;Le(Re,Jt,Zn(qe||Re.subTree.el),qe?null:qn(Re.subTree),bi,Ot,Oe),Hr&&Xn(Hr),updateHOCHostEl(Re,Jt.el),Ue&&0==--bi.deps&&bi.resolve()}))},unmount(Re,Le){bi.isUnmounted=!0,bi.activeBranch&&Gn(bi.activeBranch,Oe,Re,Le),bi.pendingBranch&&Gn(bi.pendingBranch,Oe,Re,Le)}};return bi}function normalizeSuspenseSlot(Re){let Le;if(isFunction$1(Re)){const Oe=Vb&&Re._c;Oe&&(Re._d=!1,openBlock()),Re=Re(),Oe&&(Re._d=!0,Le=Ub,closeBlock())}if(Pv(Re)){const Le=function(Re){let Le;for(let Oe=0;Oe<Re.length;Oe++){const Ue=Re[Oe];if(!isVNode$2(Ue))return;if(Ue.type!==Fb||"v-if"===Ue.children){if(Le)return;Le=Ue}}return Le}(Re);Re=Le}return Re=normalizeVNode$1(Re),Le&&!Re.dynamicChildren&&(Re.dynamicChildren=Le.filter((Le=>Le!==Re))),Re}function setActiveBranch(Re,Le){Re.activeBranch=Le;const{vnode:Oe,parentComponent:Ue}=Re;let qe=Le.el;for(;!qe&&Le.component;)qe=(Le=Le.component.subTree).el;Oe.el=qe,Ue&&Ue.subTree===Oe&&(Ue.vnode.el=qe,updateHOCHostEl(Ue,qe))}const Db=Symbol.for("v-fgt"),Bb=Symbol.for("v-txt"),Fb=Symbol.for("v-cmt"),Nb=Symbol.for("v-stc"),jb=[];let Ub=null;function openBlock(Re=!1){jb.push(Ub=Re?null:[])}function closeBlock(){jb.pop(),Ub=jb[jb.length-1]||null}let Vb=1;function setBlockTracking(Re){Vb+=Re,Re<0&&Ub&&(Ub.hasOnce=!0)}function createBlock(Re,Le,Oe,Ue,qe){return(Ct=createVNode(Re,Le,Oe,Ue,qe,!0)).dynamicChildren=Vb>0?Ub||Iv:null,closeBlock(),Vb>0&&Ub&&Ub.push(Ct),Ct;var Ct}function isVNode$2(Re){return!!Re&&!0===Re.__v_isVNode}function isSameVNodeType(Re,Le){return Re.type===Le.type&&Re.key===Le.key}const normalizeKey=({key:Re})=>null!=Re?Re:null,normalizeRef=({ref:Re,ref_key:Le,ref_for:Oe})=>("number"==typeof Re&&(Re=""+Re),null!=Re?isString$1(Re)||isRef(Re)||isFunction$1(Re)?{i:ob,r:Re,k:Le,f:!!Oe}:Re:null);const createVNode=function(Re,Le=null,Oe=null,Ue=0,qe=null,Ct=!1){Re&&Re!==Tb||(Re=Fb);if(isVNode$2(Re)){const Ue=cloneVNode(Re,Le,!0);return Oe&&normalizeChildren(Ue,Oe),Vb>0&&!Ct&&Ub&&(6&Ue.shapeFlag?Ub[Ub.indexOf(Re)]=Ue:Ub.push(Ue)),Ue.patchFlag=-2,Ue}Ot=Re,isFunction$1(Ot)&&"__vccOpts"in Ot&&(Re=Re.__vccOpts);var Ot;if(Le){Le=function(Re){return Re?isProxy(Re)||isInternalObject(Re)?kv({},Re):Re:null}(Le);let{class:Re,style:Oe}=Le;Re&&!isString$1(Re)&&(Le.class=normalizeClass(Re)),isObject$4(Oe)&&(isProxy(Oe)&&!Pv(Oe)&&(Oe=kv({},Oe)),Le.style=normalizeStyle(Oe))}const Jt=isString$1(Re)?1:isSuspense(Re)?128:isTeleport(Re)?64:isObject$4(Re)?4:isFunction$1(Re)?2:0;return function(Re,Le=null,Oe=null,Ue=0,qe=null,Ct=(Re===Db?0:1),Ot=!1,Jt=!1){const Hr={__v_isVNode:!0,__v_skip:!0,type:Re,props:Le,key:Le&&normalizeKey(Le),ref:Le&&normalizeRef(Le),scopeId:sb,slotScopeIds:null,children:Oe,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:Ct,patchFlag:Ue,dynamicProps:qe,dynamicChildren:null,appContext:null,ctx:ob};return Jt?(normalizeChildren(Hr,Oe),128&Ct&&Re.normalize(Hr)):Oe&&(Hr.shapeFlag|=isString$1(Oe)?8:16),Vb>0&&!Ot&&Ub&&(Hr.patchFlag>0||6&Ct)&&32!==Hr.patchFlag&&Ub.push(Hr),Hr}(Re,Le,Oe,Ue,qe,Jt,Ct,!0)};function cloneVNode(Re,Le,Oe=!1,Ue=!1){const{props:qe,ref:Ct,patchFlag:Ot,children:Jt,transition:Hr}=Re,Jr=Le?mergeProps(qe||{},Le):qe,Ln={__v_isVNode:!0,__v_skip:!0,type:Re.type,props:Jr,key:Jr&&normalizeKey(Jr),ref:Le&&Le.ref?Oe&&Ct?Pv(Ct)?Ct.concat(normalizeRef(Le)):[Ct,normalizeRef(Le)]:normalizeRef(Le):Ct,scopeId:Re.scopeId,slotScopeIds:Re.slotScopeIds,children:Jt,target:Re.target,targetStart:Re.targetStart,targetAnchor:Re.targetAnchor,staticCount:Re.staticCount,shapeFlag:Re.shapeFlag,patchFlag:Le&&Re.type!==Db?-1===Ot?16:16|Ot:Ot,dynamicProps:Re.dynamicProps,dynamicChildren:Re.dynamicChildren,appContext:Re.appContext,dirs:Re.dirs,transition:Hr,component:Re.component,suspense:Re.suspense,ssContent:Re.ssContent&&cloneVNode(Re.ssContent),ssFallback:Re.ssFallback&&cloneVNode(Re.ssFallback),el:Re.el,anchor:Re.anchor,ctx:Re.ctx,ce:Re.ce};return Hr&&Ue&&setTransitionHooks(Ln,Hr.clone(Ln)),Ln}function createTextVNode(Re=" ",Le=0){return createVNode(Bb,null,Re,Le)}function normalizeVNode$1(Re){return null==Re||"boolean"==typeof Re?createVNode(Fb):Pv(Re)?createVNode(Db,null,Re.slice()):isVNode$2(Re)?cloneIfMounted(Re):createVNode(Bb,null,String(Re))}function cloneIfMounted(Re){return null===Re.el&&-1!==Re.patchFlag||Re.memo?Re:cloneVNode(Re)}function normalizeChildren(Re,Le){let Oe=0;const{shapeFlag:Ue}=Re;if(null==Le)Le=null;else if(Pv(Le))Oe=16;else if("object"==typeof Le){if(65&Ue){const Oe=Le.default;return void(Oe&&(Oe._c&&(Oe._d=!1),normalizeChildren(Re,Oe()),Oe._c&&(Oe._d=!0)))}{Oe=32;const Ue=Le._;Ue||isInternalObject(Le)?3===Ue&&ob&&(1===ob.slots._?Le._=1:(Le._=2,Re.patchFlag|=1024)):Le._ctx=ob}}else isFunction$1(Le)?(Le={default:Le,_ctx:ob},Oe=32):(Le=String(Le),64&Ue?(Oe=16,Le=[createTextVNode(Le)]):Oe=8);Re.children=Le,Re.shapeFlag|=Oe}function mergeProps(...Re){const Le={};for(let Oe=0;Oe<Re.length;Oe++){const Ue=Re[Oe];for(const Re in Ue)if("class"===Re)Le.class!==Ue.class&&(Le.class=normalizeClass([Le.class,Ue.class]));else if("style"===Re)Le.style=normalizeStyle([Le.style,Ue.style]);else if(isOn(Re)){const Oe=Le[Re],qe=Ue[Re];!qe||Oe===qe||Pv(Oe)&&Oe.includes(qe)||(Le[Re]=Oe?[].concat(Oe,qe):qe)}else""!==Re&&(Le[Re]=Ue[Re])}return Le}function invokeVNodeHook(Re,Le,Oe,Ue=null){callWithAsyncErrorHandling(Re,Le,7,[Oe,Ue])}const $b=createAppContext();let Gb=0;function createComponentInstance$1(Re,Le,Oe){const Ue=Re.type,qe=(Le?Le.appContext:Re.appContext)||$b,Ct={uid:Gb++,vnode:Re,type:Ue,parent:Le,appContext:qe,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new EffectScope(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:Le?Le.provides:Object.create(qe.provides),ids:Le?Le.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:normalizePropsOptions(Ue,qe),emitsOptions:normalizeEmitsOptions(Ue,qe),emit:null,emitted:null,propsDefaults:Av,inheritAttrs:Ue.inheritAttrs,ctx:Av,data:Av,props:Av,attrs:Av,slots:Av,refs:Av,setupState:Av,setupContext:null,suspense:Oe,suspenseId:Oe?Oe.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return Ct.ctx={_:Ct},Ct.root=Le?Le.root:Ct,Ct.emit=emit.bind(null,Ct),Re.ce&&Re.ce(Ct),Ct}let qb=null;const getCurrentInstance=()=>qb||ob;let Hb,Wb;{const Re=getGlobalThis(),registerGlobalSetter=(Le,Oe)=>{let Ue;return(Ue=Re[Le])||(Ue=Re[Le]=[]),Ue.push(Oe),Re=>{Ue.length>1?Ue.forEach((Le=>Le(Re))):Ue[0](Re)}};Hb=registerGlobalSetter("__VUE_INSTANCE_SETTERS__",(Re=>qb=Re)),Wb=registerGlobalSetter("__VUE_SSR_SETTERS__",(Re=>Xb=Re))}const setCurrentInstance=Re=>{const Le=qb;return Hb(Re),Re.scope.on(),()=>{Re.scope.off(),Hb(Le)}},unsetCurrentInstance=()=>{qb&&qb.scope.off(),Hb(null)};function isStatefulComponent(Re){return 4&Re.vnode.shapeFlag}let Zb,Xb=!1;function setupComponent$1(Re,Le=!1,Oe=!1){Le&&Wb(Le);const{props:Ue,children:qe}=Re.vnode,Ct=isStatefulComponent(Re);!function(Re,Le,Oe,Ue=!1){const qe={},Ct=createInternalObject();Re.propsDefaults=Object.create(null),setFullProps(Re,Le,qe,Ct);for(const Le in Re.propsOptions[0])Le in qe||(qe[Le]=void 0);Oe?Re.props=Ue?qe:shallowReactive(qe):Re.type.props?Re.props=qe:Re.props=Ct,Re.attrs=Ct}(Re,Ue,Ct,Le),((Re,Le,Oe)=>{const Ue=Re.slots=createInternalObject();if(32&Re.vnode.shapeFlag){const Re=Le._;Re?(assignSlots(Ue,Le,Oe),Oe&&def(Ue,"_",Re,!0)):normalizeObjectSlots(Le,Ue)}else Le&&normalizeVNodeSlots(Re,Le)})(Re,qe,Oe);const Ot=Ct?function(Re,Le){const Oe=Re.type;Re.accessCache=Object.create(null),Re.proxy=new Proxy(Re.ctx,Eb);const{setup:Ue}=Oe;if(Ue){pauseTracking();const Oe=Re.setupContext=Ue.length>1?function(Re){const expose=Le=>{Re.exposed=Le||{}};return{attrs:new Proxy(Re.attrs,Yb),slots:Re.slots,emit:Re.emit,expose:expose}}(Re):null,qe=setCurrentInstance(Re),Ct=callWithErrorHandling(Ue,Re,0,[Re.props,Oe]),Ot=isPromise$1(Ct);if(resetTracking(),qe(),!Ot&&!Re.sp||isAsyncWrapper(Re)||markAsyncBoundary(Re),Ot){if(Ct.then(unsetCurrentInstance,unsetCurrentInstance),Le)return Ct.then((Oe=>{handleSetupResult(Re,Oe,Le)})).catch((Le=>{handleError(Le,Re,0)}));Re.asyncDep=Ct}else handleSetupResult(Re,Ct,Le)}else finishComponentSetup(Re,Le)}(Re,Le):void 0;return Le&&Wb(!1),Ot}function handleSetupResult(Re,Le,Oe){isFunction$1(Le)?Re.type.__ssrInlineRender?Re.ssrRender=Le:Re.render=Le:isObject$4(Le)&&(Re.setupState=proxyRefs(Le)),finishComponentSetup(Re,Oe)}function finishComponentSetup(Re,Le,Oe){const Ue=Re.type;if(!Re.render){if(!Le&&Zb&&!Ue.render){const Le=Ue.template||resolveMergedOptions(Re).template;if(Le){const{isCustomElement:Oe,compilerOptions:qe}=Re.appContext.config,{delimiters:Ct,compilerOptions:Ot}=Ue,Jt=kv(kv({isCustomElement:Oe,delimiters:Ct},qe),Ot);Ue.render=Zb(Le,Jt)}}Re.render=Ue.render||NOOP}{const Le=setCurrentInstance(Re);pauseTracking();try{applyOptions(Re)}finally{resetTracking(),Le()}}}const Yb={get:(Re,Le)=>(track(Re,0,""),Re[Le])};function getComponentPublicInstance(Re){return Re.exposed?Re.exposeProxy||(Re.exposeProxy=new Proxy(proxyRefs(markRaw(Re.exposed)),{get:(Le,Oe)=>Oe in Le?Le[Oe]:Oe in Sb?Sb[Oe](Re):void 0,has:(Re,Le)=>Le in Re||Le in Sb})):Re.proxy}function getComponentName(Re,Le=!0){return isFunction$1(Re)?Re.displayName||Re.name:Re.name||Le&&Re.__name}const computed=(Re,Le)=>{const Oe=function(Re,Le,Oe=!1){let Ue,qe;return isFunction$1(Re)?Ue=Re:(Ue=Re.get,qe=Re.set),new ComputedRefImpl(Ue,qe,Oe)}(Re,0,Xb);return Oe};function h(Re,Le,Oe){const Ue=arguments.length;return 2===Ue?isObject$4(Le)&&!Pv(Le)?isVNode$2(Le)?createVNode(Re,null,[Le]):createVNode(Re,Le):createVNode(Re,null,Le):(Ue>3?Oe=Array.prototype.slice.call(arguments,2):3===Ue&&isVNode$2(Oe)&&(Oe=[Oe]),createVNode(Re,Le,Oe))}const Kb="3.5.12",Jb={createComponentInstance:createComponentInstance$1,setupComponent:setupComponent$1,renderComponentRoot:renderComponentRoot$1,setCurrentRenderingInstance:setCurrentRenderingInstance$1,isVNode:isVNode$2,normalizeVNode:normalizeVNode$1,getComponentPublicInstance:getComponentPublicInstance,ensureValidVNode:function ensureValidVNode$1(Re){return Re.some((Re=>!isVNode$2(Re)||Re.type!==Fb&&!(Re.type===Db&&!ensureValidVNode$1(Re.children))))?Re:null},pushWarningContext:function(Re){Kx.push(Re)},popWarningContext:function(){Kx.pop()}},Qb=Jb,ew="undefined"!=typeof document?document:null,tw=ew&&ew.createElement("template"),rw={insert:(Re,Le,Oe)=>{Le.insertBefore(Re,Oe||null)},remove:Re=>{const Le=Re.parentNode;Le&&Le.removeChild(Re)},createElement:(Re,Le,Oe,Ue)=>{const qe="svg"===Le?ew.createElementNS("http://www.w3.org/2000/svg",Re):"mathml"===Le?ew.createElementNS("http://www.w3.org/1998/Math/MathML",Re):Oe?ew.createElement(Re,{is:Oe}):ew.createElement(Re);return"select"===Re&&Ue&&null!=Ue.multiple&&qe.setAttribute("multiple",Ue.multiple),qe},createText:Re=>ew.createTextNode(Re),createComment:Re=>ew.createComment(Re),setText:(Re,Le)=>{Re.nodeValue=Le},setElementText:(Re,Le)=>{Re.textContent=Le},parentNode:Re=>Re.parentNode,nextSibling:Re=>Re.nextSibling,querySelector:Re=>ew.querySelector(Re),setScopeId(Re,Le){Re.setAttribute(Le,"")},insertStaticContent(Re,Le,Oe,Ue,qe,Ct){const Ot=Oe?Oe.previousSibling:Le.lastChild;if(qe&&(qe===Ct||qe.nextSibling))for(;Le.insertBefore(qe.cloneNode(!0),Oe),qe!==Ct&&(qe=qe.nextSibling););else{tw.innerHTML="svg"===Ue?`<svg>${Re}</svg>`:"mathml"===Ue?`<math>${Re}</math>`:Re;const qe=tw.content;if("svg"===Ue||"mathml"===Ue){const Re=qe.firstChild;for(;Re.firstChild;)qe.appendChild(Re.firstChild);qe.removeChild(Re)}Le.insertBefore(qe,Oe)}return[Ot?Ot.nextSibling:Le.firstChild,Oe?Oe.previousSibling:Le.lastChild]}},nw="transition",iw="animation",ow=Symbol("_vtc"),sw={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},aw=kv({},hb,sw),lw=(Re=>(Re.displayName="Transition",Re.props=aw,Re))(((Re,{slots:Le})=>h(db,function(Re){const Le={};for(const Oe in Re)Oe in sw||(Le[Oe]=Re[Oe]);if(!1===Re.css)return Le;const{name:Oe="v",type:Ue,duration:qe,enterFromClass:Ct=`${Oe}-enter-from`,enterActiveClass:Ot=`${Oe}-enter-active`,enterToClass:Jt=`${Oe}-enter-to`,appearFromClass:Hr=Ct,appearActiveClass:Jr=Ot,appearToClass:Ln=Jt,leaveFromClass:Nn=`${Oe}-leave-from`,leaveActiveClass:$n=`${Oe}-leave-active`,leaveToClass:Gn=`${Oe}-leave-to`}=Re,qn=function(Re){if(null==Re)return null;if(isObject$4(Re))return[NumberOf(Re.enter),NumberOf(Re.leave)];{const Le=NumberOf(Re);return[Le,Le]}}(qe),Zn=qn&&qn[0],Xn=qn&&qn[1],{onBeforeEnter:Yn,onEnter:_i,onEnterCancelled:vi,onLeave:xi,onLeaveCancelled:bi,onBeforeAppear:Pi=Yn,onAppear:lo=_i,onAppearCancelled:uo=vi}=Le,finishEnter=(Re,Le,Oe)=>{removeTransitionClass(Re,Le?Ln:Jt),removeTransitionClass(Re,Le?Jr:Ot),Oe&&Oe()},finishLeave=(Re,Le)=>{Re._isLeaving=!1,removeTransitionClass(Re,Nn),removeTransitionClass(Re,Gn),removeTransitionClass(Re,$n),Le&&Le()},makeEnterHook=Re=>(Le,Oe)=>{const qe=Re?lo:_i,resolve=()=>finishEnter(Le,Re,Oe);callHook(qe,[Le,resolve]),nextFrame((()=>{removeTransitionClass(Le,Re?Hr:Ct),addTransitionClass(Le,Re?Ln:Jt),hasExplicitCallback(qe)||whenTransitionEnds(Le,Ue,Zn,resolve)}))};return kv(Le,{onBeforeEnter(Re){callHook(Yn,[Re]),addTransitionClass(Re,Ct),addTransitionClass(Re,Ot)},onBeforeAppear(Re){callHook(Pi,[Re]),addTransitionClass(Re,Hr),addTransitionClass(Re,Jr)},onEnter:makeEnterHook(!1),onAppear:makeEnterHook(!0),onLeave(Re,Le){Re._isLeaving=!0;const resolve=()=>finishLeave(Re,Le);addTransitionClass(Re,Nn),addTransitionClass(Re,$n),document.body.offsetHeight,nextFrame((()=>{Re._isLeaving&&(removeTransitionClass(Re,Nn),addTransitionClass(Re,Gn),hasExplicitCallback(xi)||whenTransitionEnds(Re,Ue,Xn,resolve))})),callHook(xi,[Re,resolve])},onEnterCancelled(Re){finishEnter(Re,!1),callHook(vi,[Re])},onAppearCancelled(Re){finishEnter(Re,!0),callHook(uo,[Re])},onLeaveCancelled(Re){finishLeave(Re),callHook(bi,[Re])}})}(Re),Le))),callHook=(Re,Le=[])=>{Pv(Re)?Re.forEach((Re=>Re(...Le))):Re&&Re(...Le)},hasExplicitCallback=Re=>!!Re&&(Pv(Re)?Re.some((Re=>Re.length>1)):Re.length>1);function NumberOf(Re){return toNumber(Re)}function addTransitionClass(Re,Le){Le.split(/\s+/).forEach((Le=>Le&&Re.classList.add(Le))),(Re[ow]||(Re[ow]=new Set)).add(Le)}function removeTransitionClass(Re,Le){Le.split(/\s+/).forEach((Le=>Le&&Re.classList.remove(Le)));const Oe=Re[ow];Oe&&(Oe.delete(Le),Oe.size||(Re[ow]=void 0))}function nextFrame(Re){requestAnimationFrame((()=>{requestAnimationFrame(Re)}))}let cw=0;function whenTransitionEnds(Re,Le,Oe,Ue){const qe=Re._endId=++cw,resolveIfNotStale=()=>{qe===Re._endId&&Ue()};if(null!=Oe)return setTimeout(resolveIfNotStale,Oe);const{type:Ct,timeout:Ot,propCount:Jt}=function(Re,Le){const Oe=window.getComputedStyle(Re),getStyleProperties=Re=>(Oe[Re]||"").split(", "),Ue=getStyleProperties(`${nw}Delay`),qe=getStyleProperties(`${nw}Duration`),Ct=getTimeout(Ue,qe),Ot=getStyleProperties(`${iw}Delay`),Jt=getStyleProperties(`${iw}Duration`),Hr=getTimeout(Ot,Jt);let Jr=null,Ln=0,Nn=0;Le===nw?Ct>0&&(Jr=nw,Ln=Ct,Nn=qe.length):Le===iw?Hr>0&&(Jr=iw,Ln=Hr,Nn=Jt.length):(Ln=Math.max(Ct,Hr),Jr=Ln>0?Ct>Hr?nw:iw:null,Nn=Jr?Jr===nw?qe.length:Jt.length:0);const $n=Jr===nw&&/\b(transform|all)(,|$)/.test(getStyleProperties(`${nw}Property`).toString());return{type:Jr,timeout:Ln,propCount:Nn,hasTransform:$n}}(Re,Le);if(!Ct)return Ue();const Hr=Ct+"end";let Jr=0;const end=()=>{Re.removeEventListener(Hr,onEnd),resolveIfNotStale()},onEnd=Le=>{Le.target===Re&&++Jr>=Jt&&end()};setTimeout((()=>{Jr<Jt&&end()}),Ot+1),Re.addEventListener(Hr,onEnd)}function getTimeout(Re,Le){for(;Re.length<Le.length;)Re=Re.concat(Re);return Math.max(...Le.map(((Le,Oe)=>toMs(Le)+toMs(Re[Oe]))))}function toMs(Re){return"auto"===Re?0:1e3*Number(Re.slice(0,-1).replace(",","."))}const uw=Symbol("_vod"),hw=Symbol("_vsh"),dw=Symbol(""),pw=/(^|;)\s*display\s*:/;const fw=/\s*!important$/;function setStyle(Re,Le,Oe){if(Pv(Oe))Oe.forEach((Oe=>setStyle(Re,Le,Oe)));else if(null==Oe&&(Oe=""),Le.startsWith("--"))Re.setProperty(Le,Oe);else{const Ue=function(Re,Le){const Oe=gw[Le];if(Oe)return Oe;let Ue=zv(Le);if("filter"!==Ue&&Ue in Re)return gw[Le]=Ue;Ue=Fv(Ue);for(let Oe=0;Oe<mw.length;Oe++){const qe=mw[Oe]+Ue;if(qe in Re)return gw[Le]=qe}return Le}(Re,Le);fw.test(Oe)?Re.setProperty(Bv(Ue),Oe.replace(fw,""),"important"):Re[Ue]=Oe}}const mw=["Webkit","Moz","ms"],gw={};const _w="http://www.w3.org/1999/xlink";function patchAttr(Re,Le,Oe,Ue,qe,Ct=Wv(Le)){Ue&&Le.startsWith("xlink:")?null==Oe?Re.removeAttributeNS(_w,Le.slice(6,Le.length)):Re.setAttributeNS(_w,Le,Oe):null==Oe||Ct&&!includeBooleanAttr(Oe)?Re.removeAttribute(Le):Re.setAttribute(Le,Ct?"":isSymbol$1(Oe)?String(Oe):Oe)}function patchDOMProp(Re,Le,Oe,Ue,qe){if("innerHTML"===Le||"textContent"===Le)return void(null!=Oe&&(Re[Le]=Oe));const Ct=Re.tagName;if("value"===Le&&"PROGRESS"!==Ct&&!Ct.includes("-")){const Ue="OPTION"===Ct?Re.getAttribute("value")||"":Re.value,qe=null==Oe?"checkbox"===Re.type?"on":"":String(Oe);return Ue===qe&&"_value"in Re||(Re.value=qe),null==Oe&&Re.removeAttribute(Le),void(Re._value=Oe)}let Ot=!1;if(""===Oe||null==Oe){const Ue=typeof Re[Le];"boolean"===Ue?Oe=includeBooleanAttr(Oe):null==Oe&&"string"===Ue?(Oe="",Ot=!0):"number"===Ue&&(Oe=0,Ot=!0)}try{Re[Le]=Oe}catch(Re){}Ot&&Re.removeAttribute(qe||Le)}const yw=Symbol("_vei");function patchEvent(Re,Le,Oe,Ue,qe=null){const Ct=Re[yw]||(Re[yw]={}),Ot=Ct[Le];if(Ue&&Ot)Ot.value=Ue;else{const[Oe,Jt]=function(Re){let Le;if(vw.test(Re)){let Oe;for(Le={};Oe=Re.match(vw);)Re=Re.slice(0,Re.length-Oe[0].length),Le[Oe[0].toLowerCase()]=!0}const Oe=":"===Re[2]?Re.slice(3):Bv(Re.slice(2));return[Oe,Le]}(Le);if(Ue){const Ot=Ct[Le]=function(Re,Le){const invoker=Re=>{if(Re._vts){if(Re._vts<=invoker.attached)return}else Re._vts=Date.now();callWithAsyncErrorHandling(function(Re,Le){if(Pv(Le)){const Oe=Re.stopImmediatePropagation;return Re.stopImmediatePropagation=()=>{Oe.call(Re),Re._stopped=!0},Le.map((Re=>Le=>!Le._stopped&&Re&&Re(Le)))}return Le}(Re,invoker.value),Le,5,[Re])};return invoker.value=Re,invoker.attached=getNow(),invoker}(Ue,qe);!function(Re,Le,Oe,Ue){Re.addEventListener(Le,Oe,Ue)}(Re,Oe,Ot,Jt)}else Ot&&(!function(Re,Le,Oe,Ue){Re.removeEventListener(Le,Oe,Ue)}(Re,Oe,Ot,Jt),Ct[Le]=void 0)}}const vw=/(?:Once|Passive|Capture)$/;let xw=0;const bw=Promise.resolve(),getNow=()=>xw||(bw.then((()=>xw=0)),xw=Date.now());const isNativeOn=Re=>111===Re.charCodeAt(0)&&110===Re.charCodeAt(1)&&Re.charCodeAt(2)>96&&Re.charCodeAt(2)<123;const ww=kv({patchProp:(Re,Le,Oe,Ue,qe,Ct)=>{const Ot="svg"===qe;"class"===Le?function(Re,Le,Oe){const Ue=Re[ow];Ue&&(Le=(Le?[Le,...Ue]:[...Ue]).join(" ")),null==Le?Re.removeAttribute("class"):Oe?Re.setAttribute("class",Le):Re.className=Le}(Re,Ue,Ot):"style"===Le?function(Re,Le,Oe){const Ue=Re.style,qe=isString$1(Oe);let Ct=!1;if(Oe&&!qe){if(Le)if(isString$1(Le))for(const Re of Le.split(";")){const Le=Re.slice(0,Re.indexOf(":")).trim();null==Oe[Le]&&setStyle(Ue,Le,"")}else for(const Re in Le)null==Oe[Re]&&setStyle(Ue,Re,"");for(const Re in Oe)"display"===Re&&(Ct=!0),setStyle(Ue,Re,Oe[Re])}else if(qe){if(Le!==Oe){const Re=Ue[dw];Re&&(Oe+=";"+Re),Ue.cssText=Oe,Ct=pw.test(Oe)}}else Le&&Re.removeAttribute("style");uw in Re&&(Re[uw]=Ct?Ue.display:"",Re[hw]&&(Ue.display="none"))}(Re,Oe,Ue):isOn(Le)?isModelListener(Le)||patchEvent(Re,Le,0,Ue,Ct):("."===Le[0]?(Le=Le.slice(1),1):"^"===Le[0]?(Le=Le.slice(1),0):function(Re,Le,Oe,Ue){if(Ue)return"innerHTML"===Le||"textContent"===Le||!!(Le in Re&&isNativeOn(Le)&&isFunction$1(Oe));if("spellcheck"===Le||"draggable"===Le||"translate"===Le)return!1;if("form"===Le)return!1;if("list"===Le&&"INPUT"===Re.tagName)return!1;if("type"===Le&&"TEXTAREA"===Re.tagName)return!1;if("width"===Le||"height"===Le){const Le=Re.tagName;if("IMG"===Le||"VIDEO"===Le||"CANVAS"===Le||"SOURCE"===Le)return!1}if(isNativeOn(Le)&&isString$1(Oe))return!1;return Le in Re}(Re,Le,Ue,Ot))?(patchDOMProp(Re,Le,Ue),Re.tagName.includes("-")||"value"!==Le&&"checked"!==Le&&"selected"!==Le||patchAttr(Re,Le,Ue,Ot,0,"value"!==Le)):!Re._isVueCE||!/[A-Z]/.test(Le)&&isString$1(Ue)?("true-value"===Le?Re._trueValue=Ue:"false-value"===Le&&(Re._falseValue=Ue),patchAttr(Re,Le,Ue,Ot)):patchDOMProp(Re,zv(Le),Ue,0,Le)}},rw);let Tw;const createApp=(...Re)=>{const Le=(Tw||(Tw=createRenderer(ww))).createApp(...Re),{mount:Oe}=Le;return Le.mount=Re=>{const Ue=function(Re){if(isString$1(Re)){return document.querySelector(Re)}return Re}(Re);if(!Ue)return;const qe=Le._component;isFunction$1(qe)||qe.render||qe.template||(qe.template=Ue.innerHTML),1===Ue.nodeType&&(Ue.textContent="");const Ct=Oe(Ue,!1,function(Re){if(Re instanceof SVGElement)return"svg";if("function"==typeof MathMLElement&&Re instanceof MathMLElement)return"mathml"}(Ue));return Ue instanceof Element&&(Ue.removeAttribute("v-cloak"),Ue.setAttribute("data-v-app","")),Ct},Le};const Sw=makeMap(",key,ref,innerHTML,textContent,ref_key,ref_for");function ssrRenderAttrs(Re,Le){let Oe="";for(const Ue in Re){if(Sw(Ue)||isOn(Ue)||"textarea"===Le&&"value"===Ue)continue;const qe=Re[Ue];Oe+="class"===Ue?` class="${ssrRenderClass(qe)}"`:"style"===Ue?` style="${ssrRenderStyle(qe)}"`:"className"===Ue?` class="${String(qe)}"`:ssrRenderDynamicAttr(Ue,qe,Le)}return Oe}function ssrRenderDynamicAttr(Re,Le,Oe){if(!isRenderableAttrValue(Le))return"";const Ue=Oe&&(Oe.indexOf("-")>0||Gv(Oe))?Re:Kv[Re]||Re.toLowerCase();return Zv(Ue)?includeBooleanAttr(Le)?` ${Ue}`:"":function(Re){if(Yv.hasOwnProperty(Re))return Yv[Re];const Le=Xv.test(Re);return Le&&console.error(`unsafe attribute name: ${Re}`),Yv[Re]=!Le}(Ue)?""===Le?` ${Ue}`:` ${Ue}="${escapeHtml$2(Le)}"`:(console.warn(`[@vue/server-renderer] Skipped rendering unsafe attribute name: ${Ue}`),"")}function ssrRenderAttr(Re,Le){return isRenderableAttrValue(Le)?` ${Re}="${escapeHtml$2(Le)}"`:""}function ssrRenderClass(Re){return escapeHtml$2(normalizeClass(Re))}function ssrRenderStyle(Re){if(!Re)return"";if(isString$1(Re))return escapeHtml$2(Re);return escapeHtml$2(function(Re){let Le="";if(!Re||isString$1(Re))return Le;for(const Oe in Re){const Ue=Re[Oe];(isString$1(Ue)||"number"==typeof Ue)&&(Le+=`${Oe.startsWith("--")?Oe:Bv(Oe)}:${Ue};`)}return Le}(normalizeStyle(Re)))}function ssrRenderComponent(Re,Le=null,Oe=null,Ue=null,qe){return renderComponentVNode(createVNode(Re,Le,Oe),Ue,qe)}const{ensureValidVNode:Ew}=Qb;function ssrRenderSlot(Re,Le,Oe,Ue,qe,Ct,Ot){qe("\x3c!--[--\x3e"),function(Re,Le,Oe,Ue,qe,Ct,Ot){const Jt=Re[Le];if(Jt){const Re=[],Le=Jt(Oe,(Le=>{Re.push(Le)}),Ct,"");if(Pv(Le)){const Re=Ew(Le);Re?renderVNodeChildren(qe,Re,Ct,Ot):Ue&&Ue()}else{let Le=!0;for(let Oe=0;Oe<Re.length;Oe++)if(!isComment(Re[Oe])){Le=!1;break}if(Le)Ue&&Ue();else{let Le=0,Oe=Re.length;for(let Ue=Le;Ue<Oe;Ue++)qe(Re[Ue])}}}else Ue&&Ue()}(Re,Le,Oe,Ue,qe,Ct,Ot),qe("\x3c!--]--\x3e")}const Cw=/^<!--[\s\S]*-->$/,Aw=/<!--[^]*?-->/gm;function isComment(Re){return!("string"!=typeof Re||!Cw.test(Re))&&(Re.length<=8||!Re.replace(Aw,"").trim())}function ssrInterpolate(Re){return escapeHtml$2(toDisplayString$1(Re))}{const Re=getGlobalThis(),registerGlobalSetter=(Le,Oe)=>{let Ue;return(Ue=Re[Le])||(Ue=Re[Le]=[]),Ue.push(Oe),Re=>{Ue.length>1?Ue.forEach((Le=>Le(Re))):Ue[0](Re)}};registerGlobalSetter("__VUE_INSTANCE_SETTERS__",(Re=>Re)),registerGlobalSetter("__VUE_SSR_SETTERS__",(Re=>Re))}function ssrRenderList(Re,Le){if(Pv(Re)||isString$1(Re))for(let Oe=0,Ue=Re.length;Oe<Ue;Oe++)Le(Re[Oe],Oe);else if("number"==typeof Re)for(let Oe=0;Oe<Re;Oe++)Le(Oe+1,Oe);else if(isObject$4(Re))if(Re[Symbol.iterator]){const Oe=Array.from(Re);for(let Re=0,Ue=Oe.length;Re<Ue;Re++)Le(Oe[Re],Re)}else{const Oe=Object.keys(Re);for(let Ue=0,qe=Oe.length;Ue<qe;Ue++){const qe=Oe[Ue];Le(Re[qe],qe,Ue)}}}const{createComponentInstance:Iw,setCurrentRenderingInstance:kw,setupComponent:Mw,renderComponentRoot:Pw,normalizeVNode:Rw,pushWarningContext:Lw,popWarningContext:Ow}=Qb;function createBuffer(){let Re=!1;const Le=[];return{getBuffer:()=>Le,push(Oe){const Ue=isString$1(Oe);Re&&Ue?Le[Le.length-1]+=Oe:(Le.push(Oe),Re=Ue,(isPromise$1(Oe)||Pv(Oe)&&Oe.hasAsync)&&(Le.hasAsync=!0))}}}function renderComponentVNode(Re,Le=null,Oe){const Ue=Re.component=Iw(Re,Le,null),qe=Mw(Ue,!0),Ct=isPromise$1(qe);let Ot=Ue.sp;if(Ct||Ot){return Promise.resolve(qe).then((()=>{if(Ct&&(Ot=Ue.sp),Ot)return Promise.all(Ot.map((Re=>Re.call(Ue.proxy))))})).catch(NOOP).then((()=>renderComponentSubTree(Ue,Oe)))}return renderComponentSubTree(Ue,Oe)}function renderComponentSubTree(Re,Le){const Oe=Re.type,{getBuffer:Ue,push:qe}=createBuffer();if(isFunction$1(Oe)){let Ue=Pw(Re);if(!Oe.props)for(const Le in Re.attrs)Le.startsWith("data-v-")&&((Ue.props||(Ue.props={}))[Le]="");renderVNode(qe,Re.subTree=Ue,Re,Le)}else{Re.render&&Re.render!==NOOP||Re.ssrRender||Oe.ssrRender||!isString$1(Oe.template)||(Oe.ssrRender=function(){throw new Error("On-the-fly template compilation is not supported in the ESM build of @vue/server-renderer. All templates must be pre-compiled into render functions.")}(Oe.template));const Ue=Re.ssrRender||Oe.ssrRender;if(Ue){let Oe=!1!==Re.inheritAttrs?Re.attrs:void 0,Ct=!1,Ot=Re;for(;;){const Re=Ot.vnode.scopeId;Re&&(Ct||(Oe={...Oe},Ct=!0),Oe[Re]="");const Le=Ot.parent;if(!Le||!Le.subTree||Le.subTree!==Ot.vnode)break;Ot=Le}if(Le){Ct||(Oe={...Oe});const Re=Le.trim().split(" ");for(let Le=0;Le<Re.length;Le++)Oe[Re[Le]]=""}const Jt=kw(Re);try{Ue(Re.proxy,qe,Re,Oe,Re.props,Re.setupState,Re.data,Re.ctx)}finally{kw(Jt)}}else Re.render&&Re.render!==NOOP?renderVNode(qe,Re.subTree=Pw(Re),Re,Le):(Oe.name||Oe.__file,qe("\x3c!----\x3e"))}return Ue()}function renderVNode(Re,Le,Oe,Ue){const{type:qe,shapeFlag:Ct,children:Ot,dirs:Jt,props:Hr}=Le;switch(Jt&&(Le.props=function(Re,Le,Oe){const Ue=[];for(let Le=0;Le<Oe.length;Le++){const qe=Oe[Le],{dir:{getSSRProps:Ct}}=qe;if(Ct){const Le=Ct(qe,Re);Le&&Ue.push(Le)}}return mergeProps(Le||{},...Ue)}(Le,Hr,Jt)),qe){case Bb:Re(escapeHtml$2(Ot));break;case Fb:Re(Ot?`\x3c!--${Jr=Ot,Jr.replace(Qv,"")}--\x3e`:"\x3c!----\x3e");break;case Nb:Re(Ot);break;case Db:Le.slotScopeIds&&(Ue=(Ue?Ue+" ":"")+Le.slotScopeIds.join(" ")),Re("\x3c!--[--\x3e"),renderVNodeChildren(Re,Ot,Oe,Ue),Re("\x3c!--]--\x3e");break;default:1&Ct?function(Re,Le,Oe,Ue){const qe=Le.type;let{props:Ct,children:Ot,shapeFlag:Jt,scopeId:Hr}=Le,Jr=`<${qe}`;Ct&&(Jr+=ssrRenderAttrs(Ct,qe));Hr&&(Jr+=` ${Hr}`);let Ln=Oe,Nn=Le;for(;Ln&&Nn===Ln.subTree;)Nn=Ln.vnode,Nn.scopeId&&(Jr+=` ${Nn.scopeId}`),Ln=Ln.parent;Ue&&(Jr+=` ${Ue}`);if(Re(Jr+">"),!qv(qe)){let Le=!1;Ct&&(Ct.innerHTML?(Le=!0,Re(Ct.innerHTML)):Ct.textContent?(Le=!0,Re(escapeHtml$2(Ct.textContent))):"textarea"===qe&&Ct.value&&(Le=!0,Re(escapeHtml$2(Ct.value)))),Le||(8&Jt?Re(escapeHtml$2(Ot)):16&Jt&&renderVNodeChildren(Re,Ot,Oe,Ue)),Re(`</${qe}>`)}}(Re,Le,Oe,Ue):6&Ct?Re(renderComponentVNode(Le,Oe,Ue)):64&Ct?function(Re,Le,Oe,Ue){const qe=Le.props&&Le.props.to,Ct=Le.props&&Le.props.disabled;if(!qe)return[];if(!isString$1(qe))return[];!function(Re,Le,Oe,Ue,qe){Re("\x3c!--teleport start--\x3e");const Ct=qe.appContext.provides[Rb],Ot=Ct.__teleportBuffers||(Ct.__teleportBuffers={}),Jt=Ot[Oe]||(Ot[Oe]=[]),Hr=Jt.length;let Jr;if(Ue)Le(Re),Jr="\x3c!--teleport start anchor--\x3e\x3c!--teleport anchor--\x3e";else{const{getBuffer:Re,push:Oe}=createBuffer();Oe("\x3c!--teleport start anchor--\x3e"),Le(Oe),Oe("\x3c!--teleport anchor--\x3e"),Jr=Re()}Jt.splice(Hr,0,Jr),Re("\x3c!--teleport end--\x3e")}(Re,(Re=>{renderVNodeChildren(Re,Le.children,Oe,Ue)}),qe,Ct||""===Ct,Oe)}(Re,Le,Oe,Ue):128&Ct&&renderVNode(Re,Le.ssContent,Oe,Ue)}var Jr}function renderVNodeChildren(Re,Le,Oe,Ue){for(let qe=0;qe<Le.length;qe++)renderVNode(Re,Rw(Le[qe]),Oe,Ue)}const{isVNode:zw}=Qb;function nestedUnrollBuffer(Re,Le,Oe){if(!Re.hasAsync)return Le+unrollBufferSync$1(Re);let Ue=Le;for(let Le=Oe;Le<Re.length;Le+=1){const Oe=Re[Le];if(isString$1(Oe)){Ue+=Oe;continue}if(isPromise$1(Oe))return Oe.then((Oe=>(Re[Le]=Oe,nestedUnrollBuffer(Re,Ue,Le))));const qe=nestedUnrollBuffer(Oe,Ue,0);if(isPromise$1(qe))return qe.then((Oe=>(Re[Le]=Oe,nestedUnrollBuffer(Re,"",Le))));Ue=qe}return Ue}function unrollBuffer$1(Re){return nestedUnrollBuffer(Re,"",0)}function unrollBufferSync$1(Re){let Le="";for(let Oe=0;Oe<Re.length;Oe++){let Ue=Re[Oe];isString$1(Ue)?Le+=Ue:Le+=unrollBufferSync$1(Ue)}return Le}async function renderToString(Re,Le={}){if(zw(Re))return renderToString(createApp({render:()=>Re}),Le);const Oe=createVNode(Re._component,Re._props);Oe.appContext=Re._context,Re.provide(Rb,Le);const Ue=await renderComponentVNode(Oe),qe=await unrollBuffer$1(Ue);if(await async function(Re){if(Re.__teleportBuffers){Re.teleports=Re.teleports||{};for(const Le in Re.__teleportBuffers)Re.teleports[Le]=await unrollBuffer$1(await Promise.all([Re.__teleportBuffers[Le]]))}}(Le),Le.__watcherHandles)for(const Re of Le.__watcherHandles)Re();return qe}const Dw=new Set(["meta","link","base"]),Bw=new Set(["title","titleTemplate","script","style","noscript"]),Fw=new Set(["base","meta","link","style","script","noscript"]),Nw=new Set(["title","titleTemplate","templateParams","base","htmlAttrs","bodyAttrs","meta","link","style","script","noscript"]),jw=new Set(["base","title","titleTemplate","bodyAttrs","htmlAttrs","templateParams"]),Uw=new Set(["tagPosition","tagPriority","tagDuplicateStrategy","children","innerHTML","textContent","processTemplateParams"]);function hashCode(Re){let Le=9;for(let Oe=0;Oe<Re.length;)Le=Math.imul(Le^Re.charCodeAt(Oe++),9**9);return(65536+(Le^Le>>>9)).toString(16).substring(1,8).toLowerCase()}function hashTag(Re){if(Re._h)return Re._h;if(Re._d)return hashCode(Re._d);let Le=`${Re.tag}:${Re.textContent||Re.innerHTML||""}:`;for(const Oe in Re.props)Le+=`${Oe}:${String(Re.props[Oe])},`;return hashCode(Le)}function unpackToArray(Re,Le){const Oe=[],Ue=Le.resolveKeyData||(Re=>Re.key),qe=Le.resolveValueData||(Re=>Re.value);for(const[Ct,Ot]of Object.entries(Re))Oe.push(...(Array.isArray(Ot)?Ot:[Ot]).map((Re=>{const Oe={key:Ct,value:Re},Ot=qe(Oe);return"object"==typeof Ot?unpackToArray(Ot,Le):Array.isArray(Ot)?Ot:{["function"==typeof Le.key?Le.key(Oe):Le.key]:Ue(Oe),["function"==typeof Le.value?Le.value(Oe):Le.value]:Ot}})).flat());return Oe}function unpackToString(Re,Le){return Object.entries(Re).map((([Re,Oe])=>{if("object"==typeof Oe&&(Oe=unpackToString(Oe,Le)),Le.resolve){const Ue=Le.resolve({key:Re,value:Oe});if(void 0!==Ue)return Ue}return"number"==typeof Oe&&(Oe=Oe.toString()),"string"==typeof Oe&&Le.wrapValue&&(Oe=Oe.replace(new RegExp(Le.wrapValue,"g"),`\\${Le.wrapValue}`),Oe=`${Le.wrapValue}${Oe}${Le.wrapValue}`),`${Re}${Le.keyValueSeparator||""}${Oe}`})).join(Le.entrySeparator||"")}const p=Re=>({keyValue:Re,metaKey:"property"}),k=Re=>({keyValue:Re}),Vw={appleItunesApp:{unpack:{entrySeparator:", ",resolve:({key:Re,value:Le})=>`${fixKeyCase(Re)}=${Le}`}},articleExpirationTime:p("article:expiration_time"),articleModifiedTime:p("article:modified_time"),articlePublishedTime:p("article:published_time"),bookReleaseDate:p("book:release_date"),charset:{metaKey:"charset"},contentSecurityPolicy:{unpack:{entrySeparator:"; ",resolve:({key:Re,value:Le})=>`${fixKeyCase(Re)} ${Le}`},metaKey:"http-equiv"},contentType:{metaKey:"http-equiv"},defaultStyle:{metaKey:"http-equiv"},fbAppId:p("fb:app_id"),msapplicationConfig:k("msapplication-Config"),msapplicationTileColor:k("msapplication-TileColor"),msapplicationTileImage:k("msapplication-TileImage"),ogAudioSecureUrl:p("og:audio:secure_url"),ogAudioUrl:p("og:audio"),ogImageSecureUrl:p("og:image:secure_url"),ogImageUrl:p("og:image"),ogSiteName:p("og:site_name"),ogVideoSecureUrl:p("og:video:secure_url"),ogVideoUrl:p("og:video"),profileFirstName:p("profile:first_name"),profileLastName:p("profile:last_name"),profileUsername:p("profile:username"),refresh:{metaKey:"http-equiv",unpack:{entrySeparator:";",resolve({key:Re,value:Le}){if("seconds"===Re)return`${Le}`}}},robots:{unpack:{entrySeparator:", ",resolve:({key:Re,value:Le})=>"boolean"==typeof Le?`${fixKeyCase(Re)}`:`${fixKeyCase(Re)}:${Le}`}},xUaCompatible:{metaKey:"http-equiv"}},$w=new Set(["og","book","article","profile"]);function resolveMetaKeyType(Re){const Le=fixKeyCase(Re),Oe=Le.indexOf(":");return $w.has(Le.substring(0,Oe))?"property":Vw[Re]?.metaKey||"name"}function fixKeyCase(Re){const Le=Re.replace(/([A-Z])/g,"-$1").toLowerCase(),Oe=Le.indexOf("-"),Ue=Le.substring(0,Oe);return"twitter"===Ue||$w.has(Ue)?Re.replace(/([A-Z])/g,":$1").toLowerCase():Le}function changeKeyCasingDeep(Re){if(Array.isArray(Re))return Re.map((Re=>changeKeyCasingDeep(Re)));if("object"!=typeof Re||Array.isArray(Re))return Re;const Le={};for(const Oe in Re)Object.prototype.hasOwnProperty.call(Re,Oe)&&(Le[fixKeyCase(Oe)]=changeKeyCasingDeep(Re[Oe]));return Le}function resolvePackedMetaObjectValue(Re,Le){const Oe=Vw[Le];return"refresh"===Le?`${Re.seconds};url=${Re.url}`:unpackToString(changeKeyCasingDeep(Re),{keyValueSeparator:"=",entrySeparator:", ",resolve:({value:Re,key:Le})=>null===Re?"":"boolean"==typeof Re?`${Le}`:void 0,...Oe?.unpack})}const Gw=new Set(["og:image","og:video","og:audio","twitter:image"]);function sanitize(Re){const Le={};for(const Oe in Re){if(!Object.prototype.hasOwnProperty.call(Re,Oe))continue;const Ue=Re[Oe];"false"!==String(Ue)&&Oe&&(Le[Oe]=Ue)}return Le}function handleObjectEntry(Re,Le){const Oe=sanitize(Le),Ue=fixKeyCase(Re),qe=resolveMetaKeyType(Ue);if(Gw.has(Ue)){const Le={};for(const Ue in Oe)Object.prototype.hasOwnProperty.call(Oe,Ue)&&(Le[`${Re}${"url"===Ue?"":`${Ue[0].toUpperCase()}${Ue.slice(1)}`}`]=Oe[Ue]);return unpackMeta(Le).sort(((Re,Le)=>(Re[qe]?.length||0)-(Le[qe]?.length||0)))}return[{[qe]:Ue,...Oe}]}function unpackMeta(Re){const Le=[],Oe={};for(const Ue in Re){if(!Object.prototype.hasOwnProperty.call(Re,Ue))continue;const qe=Re[Ue];if(Array.isArray(qe))for(const Re of qe)Le.push(..."string"==typeof Re?unpackMeta({[Ue]:Re}):handleObjectEntry(Ue,Re));else if("object"==typeof qe&&qe){if(Gw.has(fixKeyCase(Ue))){Le.push(...handleObjectEntry(Ue,qe));continue}Oe[Ue]=sanitize(qe)}else Oe[Ue]=qe}const Ue=unpackToArray(Oe,{key:({key:Re})=>resolveMetaKeyType(Re),value:({key:Re})=>"charset"===Re?"charset":"content",resolveKeyData:({key:Re})=>function(Re){return Vw[Re]?.keyValue||fixKeyCase(Re)}(Re),resolveValueData:({value:Re,key:Le})=>null===Re?"_null":"object"==typeof Re?resolvePackedMetaObjectValue(Re,Le):"number"==typeof Re?Re.toString():Re});return[...Le,...Ue].map((Re=>("_null"===Re.content&&(Re.content=null),Re)))}function normaliseTag(Re,Le,Oe,Ue){const qe=Ue||function(Re,Le=!1){const Oe=nestedNormaliseProps(Re,Le,Object.keys(Re),0);if(Oe instanceof Promise)return Oe.then((()=>Re));return Re}("object"!=typeof Le||"function"==typeof Le||Le instanceof Promise?{["script"===Re||"noscript"===Re||"style"===Re?"innerHTML":"textContent"]:Le}:{...Le},"templateParams"===Re||"titleTemplate"===Re);if(qe instanceof Promise)return qe.then((Ue=>normaliseTag(Re,Le,Oe,Ue)));const Ct={tag:Re,props:qe};for(const Re of Uw){const Le=void 0!==Ct.props[Re]?Ct.props[Re]:Oe[Re];void 0!==Le&&(("innerHTML"!==Re&&"textContent"!==Re&&"children"!==Re||Bw.has(Ct.tag))&&(Ct["children"===Re?"innerHTML":Re]=Le),delete Ct.props[Re])}return Ct.props.body&&(Ct.tagPosition="bodyClose",delete Ct.props.body),"script"===Ct.tag&&"object"==typeof Ct.innerHTML&&(Ct.innerHTML=JSON.stringify(Ct.innerHTML),Ct.props.type=Ct.props.type||"application/json"),Array.isArray(Ct.props.content)?Ct.props.content.map((Re=>({...Ct,props:{...Ct.props,content:Re}}))):Ct}function normaliseStyleClassProps(Re,Le){const Oe="class"===Re?" ":";";return Le&&"object"==typeof Le&&!Array.isArray(Le)&&(Le=Object.entries(Le).filter((([,Re])=>Re)).map((([Le,Oe])=>"style"===Re?`${Le}:${Oe}`:Le))),String(Array.isArray(Le)?Le.join(Oe):Le)?.split(Oe).filter((Re=>Boolean(Re.trim()))).join(Oe)}function nestedNormaliseProps(Re,Le,Oe,Ue){for(let qe=Ue;qe<Oe.length;qe+=1){const Ue=Oe[qe];if("class"!==Ue&&"style"!==Ue){if(Re[Ue]instanceof Promise)return Re[Ue].then((Ct=>(Re[Ue]=Ct,nestedNormaliseProps(Re,Le,Oe,qe))));if(!Le&&!Uw.has(Ue)){const Le=String(Re[Ue]),Oe=Ue.startsWith("data-");"true"===Le||""===Le?Re[Ue]=!Oe||"true":Re[Ue]||(Oe&&"false"===Le?Re[Ue]="false":delete Re[Ue])}}else Re[Ue]=normaliseStyleClassProps(Ue,Re[Ue])}}function nestedNormaliseEntryTags(Re,Le,Oe){for(let Ue=Oe;Ue<Le.length;Ue+=1){const Oe=Le[Ue];if(Oe instanceof Promise)return Oe.then((Oe=>(Le[Ue]=Oe,nestedNormaliseEntryTags(Re,Le,Ue))));Array.isArray(Oe)?Re.push(...Oe):Re.push(Oe)}}function normaliseEntryTags(Re){const Le=[],Oe=Re.resolvedInput;for(const Ue in Oe){if(!Object.prototype.hasOwnProperty.call(Oe,Ue))continue;const qe=Oe[Ue];if(void 0!==qe&&Nw.has(Ue))if(Array.isArray(qe))for(const Oe of qe)Le.push(normaliseTag(Ue,Oe,Re));else Le.push(normaliseTag(Ue,qe,Re))}if(0===Le.length)return[];const Ue=[];return qe=nestedNormaliseEntryTags(Ue,Le,0),Ct=()=>Ue.map(((Le,Oe)=>(Le._e=Re._i,Re.mode&&(Le._m=Re.mode),Le._p=(Re._i<<10)+Oe,Le))),qe instanceof Promise?qe.then(Ct):Ct(qe);var qe,Ct}const qw=new Set(["onload","onerror","onabort","onprogress","onloadstart"]),Hw={base:-10,title:10},Ww={critical:-80,high:-10,low:20};function tagWeight(Re){const Le=Re.tagPriority;if("number"==typeof Le)return Le;let Oe=100;return"meta"===Re.tag?"content-security-policy"===Re.props["http-equiv"]?Oe=-30:Re.props.charset?Oe=-20:"viewport"===Re.props.name&&(Oe=-15):"link"===Re.tag&&"preconnect"===Re.props.rel?Oe=20:Re.tag in Hw&&(Oe=Hw[Re.tag]),Le&&Le in Ww?Oe+Ww[Le]:Oe}const Zw=[{prefix:"before:",offset:-1},{prefix:"after:",offset:1}],Xw=["name","property","http-equiv"];const Yw="%separator";const Kw=new RegExp(`${Yw}(?:\\s*${Yw})*`,"g");function processTemplateParams(Re,Le,Oe){if("string"!=typeof Re||!Re.includes("%"))return Re;let Ue=Re;try{Ue=decodeURI(Re)}catch{}const qe=Ue.match(/%\w+(?:\.\w+)?/g);if(!qe)return Re;const Ct=Re.includes(Yw);return Re=Re.replace(/%\w+(?:\.\w+)?/g,(Re=>{if(Re===Yw||!qe.includes(Re))return Re;const Oe=function(Re,Le){let Oe;if("s"===Le||"pageTitle"===Le)Oe=Re.pageTitle;else if(Le.includes(".")){const Ue=Le.indexOf(".");Oe=Re[Le.substring(0,Ue)]?.[Le.substring(Ue+1)]}else Oe=Re[Le];return void 0!==Oe?(Oe||"").replace(/"/g,'\\"'):void 0}(Le,Re.slice(1));return void 0!==Oe?Oe:Re})).trim(),Ct&&(Re.endsWith(Yw)&&(Re=Re.slice(0,-10)),Re.startsWith(Yw)&&(Re=Re.slice(10)),Re=Re.replace(Kw,Oe).trim()),Re}function resolveTitleTemplate(Re,Le){return null==Re?Le||null:"function"==typeof Re?Re(Le):Re}function encodeAttribute(Re){return String(Re).replace(/"/g,"&quot;")}function propsToString(Re){let Le="";for(const Oe in Re){if(!Object.prototype.hasOwnProperty.call(Re,Oe))continue;const Ue=Re[Oe];!1!==Ue&&null!==Ue&&(Le+=!0===Ue?` ${Oe}`:` ${Oe}="${encodeAttribute(Ue)}"`)}return Le}function tagToString(Re){const Le=propsToString(Re.props),Oe=`<${Re.tag}${Le}>`;if(!Bw.has(Re.tag))return Dw.has(Re.tag)?Oe:`${Oe}</${Re.tag}>`;let Ue=String(Re.innerHTML||"");return Re.textContent&&(Ue=String(Re.textContent).replace(/[&<>"'/]/g,(Re=>{switch(Re){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"'":return"&#x27;";case"/":return"&#x2F;";default:return Re}}))),Dw.has(Re.tag)?Oe:`${Oe}${Ue}</${Re.tag}>`}async function renderSSRHead(Re,Le){const Oe={shouldRender:!0};if(await Re.hooks.callHook("ssr:beforeRender",Oe),!Oe.shouldRender)return{headTags:"",bodyTags:"",bodyTagsOpen:"",htmlAttrs:"",bodyAttrs:""};const Ue={tags:await Re.resolveTags()};await Re.hooks.callHook("ssr:render",Ue);const qe=function(Re){const Le={htmlAttrs:{},bodyAttrs:{},tags:{head:"",bodyClose:"",bodyOpen:""}};for(const Oe of Re){if(0===Object.keys(Oe.props).length&&!Oe.innerHTML&&!Oe.textContent)continue;if("htmlAttrs"===Oe.tag||"bodyAttrs"===Oe.tag){Object.assign(Le[Oe.tag],Oe.props);continue}const Re=tagToString(Oe),Ue=Oe.tagPosition||"head";Le.tags[Ue]+=Le.tags[Ue]?`\n${Re}`:Re}return{headTags:Le.tags.head,bodyTags:Le.tags.bodyClose,bodyTagsOpen:Le.tags.bodyOpen,htmlAttrs:propsToString(Le.htmlAttrs),bodyAttrs:propsToString(Le.bodyAttrs)}}(Ue.tags),Ct={tags:Ue.tags,html:qe};return await Re.hooks.callHook("ssr:rendered",Ct),Ct.html}const Jw=new Set(["templateParams","htmlAttrs","bodyAttrs"]),Qw={hooks:{"tag:normalise":({tag:Re})=>{Re.props.hid&&(Re.key=Re.props.hid,delete Re.props.hid),Re.props.vmid&&(Re.key=Re.props.vmid,delete Re.props.vmid),Re.props.key&&(Re.key=Re.props.key,delete Re.props.key);const Le=function(Re){const{props:Le,tag:Oe}=Re;if(jw.has(Oe))return Oe;if("link"===Oe&&"canonical"===Le.rel)return"canonical";if(Le.charset)return"charset";if(Le.id)return`${Oe}:id:${Le.id}`;for(const Re of Xw)if(void 0!==Le[Re])return`${Oe}:${Re}:${Le[Re]}`;return!1}(Re);!Le||Le.startsWith("meta:og:")||Le.startsWith("meta:twitter:")||delete Re.key;const Oe=Le||!!Re.key&&`${Re.tag}:${Re.key}`;Oe&&(Re._d=Oe)},"tags:resolve":Re=>{const Le=Object.create(null);for(const Oe of Re.tags){const Re=(Oe.key?`${Oe.tag}:${Oe.key}`:Oe._d)||hashTag(Oe),Ue=Le[Re];if(Ue){let qe=Oe?.tagDuplicateStrategy;if(!qe&&Jw.has(Oe.tag)&&(qe="merge"),"merge"===qe){const qe=Ue.props;qe.style&&Oe.props.style&&(";"!==qe.style[qe.style.length-1]&&(qe.style+=";"),Oe.props.style=`${qe.style} ${Oe.props.style}`),qe.class&&Oe.props.class?Oe.props.class=`${qe.class} ${Oe.props.class}`:qe.class&&(Oe.props.class=qe.class),Le[Re].props={...qe,...Oe.props};continue}if(Oe._e===Ue._e){Ue._duped=Ue._duped||[],Oe._d=`${Ue._d}:${Ue._duped.length+1}`,Ue._duped.push(Oe);continue}if(tagWeight(Oe)>tagWeight(Ue))continue}Oe.innerHTML||Oe.textContent||0!==Object.keys(Oe.props).length||!Fw.has(Oe.tag)?Le[Re]=Oe:delete Le[Re]}const Oe=[];for(const Re in Le){const Ue=Le[Re],qe=Ue._duped;Oe.push(Ue),qe&&(delete Ue._duped,Oe.push(...qe))}Re.tags=Oe,Re.tags=Re.tags.filter((Re=>!("meta"===Re.tag&&(Re.props.name||Re.props.property)&&!Re.props.content)))}}},eT=new Set(["script","link","bodyAttrs"]),EventHandlersPlugin=Re=>({hooks:{"tags:resolve":Le=>{for(const Oe of Le.tags){if(!eT.has(Oe.tag))continue;const Le=Oe.props;for(const Ue in Le){if("o"!==Ue[0]||"n"!==Ue[1])continue;if(!Object.prototype.hasOwnProperty.call(Le,Ue))continue;const qe=Le[Ue];"function"==typeof qe&&(Re.ssr&&qw.has(Ue)?Le[Ue]=`this.dataset.${Ue}fired = true`:delete Le[Ue],Oe._eventHandlers=Oe._eventHandlers||{},Oe._eventHandlers[Ue]=qe)}Re.ssr&&Oe._eventHandlers&&(Oe.props.src||Oe.props.href)&&(Oe.key=Oe.key||hashCode(Oe.props.src||Oe.props.href))}},"dom:renderTag":({$el:Re,tag:Le})=>{const Oe=Re?.dataset;if(Oe)for(const Ue in Oe){if(!Ue.endsWith("fired"))continue;const Oe=Ue.slice(0,-5);qw.has(Oe)&&Le._eventHandlers?.[Oe]?.call(Re,new Event(Oe.substring(2)))}}}}),tT=new Set(["link","style","script","noscript"]),rT={hooks:{"tag:normalise":({tag:Re})=>{Re.key&&tT.has(Re.tag)&&(Re.props["data-hid"]=Re._h=hashCode(Re.key))}}},nT={mode:"server",hooks:{"tags:beforeResolve":Re=>{const Le={};let Oe=!1;for(const Ue of Re.tags)"server"!==Ue._m||"titleTemplate"!==Ue.tag&&"templateParams"!==Ue.tag&&"title"!==Ue.tag||(Le[Ue.tag]="title"===Ue.tag||"titleTemplate"===Ue.tag?Ue.textContent:Ue.props,Oe=!0);Oe&&Re.tags.push({tag:"script",innerHTML:JSON.stringify(Le),props:{id:"unhead:payload",type:"application/json"}})}}},iT={hooks:{"tags:resolve":Re=>{for(const Le of Re.tags)if("string"==typeof Le.tagPriority)for(const{prefix:Oe,offset:Ue}of Zw){if(!Le.tagPriority.startsWith(Oe))continue;const qe=Le.tagPriority.substring(Oe.length),Ct=Re.tags.find((Re=>Re._d===qe))?._p;if(void 0!==Ct){Le._p=Ct+Ue;break}}Re.tags.sort(((Re,Le)=>{const Oe=tagWeight(Re),Ue=tagWeight(Le);return Oe<Ue?-1:Oe>Ue?1:Re._p-Le._p}))}}},oT={meta:"content",link:"href",htmlAttrs:"lang"},sT=["innerHTML","textContent"],TemplateParamsPlugin=Re=>({hooks:{"tags:resolve":Le=>{const{tags:Oe}=Le;let Ue;for(let Re=0;Re<Oe.length;Re+=1){"templateParams"===Oe[Re].tag&&(Ue=Le.tags.splice(Re,1)[0].props,Re-=1)}const qe=Ue||{},Ct=qe.separator||"|";delete qe.separator,qe.pageTitle=processTemplateParams(qe.pageTitle||Oe.find((Re=>"title"===Re.tag))?.textContent||"",qe,Ct);for(const Re of Oe){if(!1===Re.processTemplateParams)continue;const Le=oT[Re.tag];if(Le&&"string"==typeof Re.props[Le])Re.props[Le]=processTemplateParams(Re.props[Le],qe,Ct);else if(Re.processTemplateParams||"titleTemplate"===Re.tag||"title"===Re.tag)for(const Le of sT)"string"==typeof Re[Le]&&(Re[Le]=processTemplateParams(Re[Le],qe,Ct))}Re._templateParams=qe,Re._separator=Ct},"tags:afterResolve":({tags:Le})=>{let Oe;for(let Re=0;Re<Le.length;Re+=1){const Ue=Le[Re];"title"===Ue.tag&&!1!==Ue.processTemplateParams&&(Oe=Ue)}Oe?.textContent&&(Oe.textContent=processTemplateParams(Oe.textContent,Re._templateParams,Re._separator))}}}),aT={hooks:{"tags:resolve":Re=>{const{tags:Le}=Re;let Oe,Ue;for(let Re=0;Re<Le.length;Re+=1){const qe=Le[Re];"title"===qe.tag?Oe=qe:"titleTemplate"===qe.tag&&(Ue=qe)}if(Ue&&Oe){const Le=resolveTitleTemplate(Ue.textContent,Oe.textContent);null!==Le?Oe.textContent=Le||Oe.textContent:Re.tags.splice(Re.tags.indexOf(Oe),1)}else if(Ue){const Re=resolveTitleTemplate(Ue.textContent);null!==Re&&(Ue.textContent=Re,Ue.tag="title",Ue=void 0)}Ue&&Re.tags.splice(Re.tags.indexOf(Ue),1)}}},lT={hooks:{"tags:afterResolve":Re=>{for(const Le of Re.tags)"string"==typeof Le.innerHTML&&(!Le.innerHTML||"application/ld+json"!==Le.props.type&&"application/json"!==Le.props.type?Le.innerHTML=Le.innerHTML.replace(new RegExp(`</${Le.tag}`,"g"),`<\\/${Le.tag}`):Le.innerHTML=Le.innerHTML.replace(/</g,"\\u003C"))}}};let cT;function createServerHead$1(Re={}){return cT=function(Re={}){const Le=createHooks();Le.addHooks(Re.hooks||{}),Re.document=Re.document||void 0;const Oe=!Re.document,updated=()=>{Ot.dirty=!0,Le.callHook("entries:updated",Ot)};let Ue=0,qe=[];const Ct=[],Ot={plugins:Ct,dirty:!1,resolvedOptions:Re,hooks:Le,headEntries:()=>qe,use(Re){const Ue="function"==typeof Re?Re(Ot):Re;Ue.key&&Ct.some((Re=>Re.key===Ue.key))||(Ct.push(Ue),filterMode(Ue.mode,Oe)&&Le.addHooks(Ue.hooks||{}))},push(Re,Le){delete Le?.head;const Ct={_i:Ue++,input:Re,...Le};return filterMode(Ct.mode,Oe)&&(qe.push(Ct),updated()),{dispose(){qe=qe.filter((Re=>Re._i!==Ct._i)),updated()},patch(Re){for(const Le of qe)Le._i===Ct._i&&(Le.input=Ct.input=Re);updated()}}},async resolveTags(){const Re={tags:[],entries:[...qe]};await Le.callHook("entries:resolve",Re);for(const Oe of Re.entries){const Ue=Oe.resolvedInput||Oe.input;if(Oe.resolvedInput=await(Oe.transform?Oe.transform(Ue):Ue),Oe.resolvedInput)for(const Ue of await normaliseEntryTags(Oe)){const qe={tag:Ue,entry:Oe,resolvedOptions:Ot.resolvedOptions};await Le.callHook("tag:normalise",qe),Re.tags.push(qe.tag)}}return await Le.callHook("tags:beforeResolve",Re),await Le.callHook("tags:resolve",Re),await Le.callHook("tags:afterResolve",Re),Re.tags},ssr:Oe};return[Qw,nT,EventHandlersPlugin,rT,iT,TemplateParamsPlugin,aT,lT,...Re?.plugins||[]].forEach((Re=>Ot.use(Re))),Ot.hooks.callHook("init",Ot),Ot}(Re)}function filterMode(Re,Le){return!Re||"server"===Re&&Le||"client"===Re&&!Le}const uT=/@import/;const hT="3"===Kb[0];function resolveUnrefHeadInput(Re){if(Re instanceof Promise||Re instanceof Date||Re instanceof RegExp)return Re;const Le="function"==typeof(Oe=Re)?Oe():unref(Oe);var Oe;if(!Re||!Le)return Le;if(Array.isArray(Le))return Le.map((Re=>resolveUnrefHeadInput(Re)));if("object"==typeof Le){const Re={};for(const Oe in Le)Object.prototype.hasOwnProperty.call(Le,Oe)&&("titleTemplate"===Oe||"o"===Oe[0]&&"n"===Oe[1]?Re[Oe]=unref(Le[Oe]):Re[Oe]=resolveUnrefHeadInput(Le[Oe]));return Re}return Le}const dT={hooks:{"entries:resolve":Re=>{for(const Le of Re.entries)Le.resolvedInput=resolveUnrefHeadInput(Le.input)}}},pT="usehead";function createServerHead(Re={}){const Le=createServerHead$1(Re);return Le.use(dT),Le.install=function(Re){return{install(Le){hT&&(Le.config.globalProperties.$unhead=Re,Le.config.globalProperties.$head=Re,Le.provide(pT,Re))}}.install}(Le),Le}const fT="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},mT="__unhead_injection_handler__";function injectHead(){if(mT in fT)return fT[mT]();const Re=inject(pT);return Re||cT}function useHead(Re,Le={}){const Oe=Le.head||injectHead();if(Oe)return Oe.ssr?Oe.push(Re,Le):function(Re,Le,Oe={}){const Ue=ref(!1),qe=ref({});!function(Re,Le){doWatch(Re,null,Le)}((()=>{qe.value=Ue.value?{}:resolveUnrefHeadInput(Le)}));const Ct=Re.push(qe.value,Oe);watch(qe,(Re=>{Ct.patch(Re)}));getCurrentInstance()&&(_b((()=>{Ct.dispose()})),onDeactivated((()=>{Ue.value=!0})),onActivated((()=>{Ue.value=!1})));return Ct}(Oe,Re,Le)}function useSeoMeta(Re,Le){const{title:Oe,titleTemplate:Ue,...qe}=Re;return useHead({title:Oe,titleTemplate:Ue,_flatMeta:qe},{...Le,transform(Re){const Le=unpackMeta({...Re._flatMeta});return delete Re._flatMeta,{...Re,meta:Le}}})}const gT=[(_T={track:!0},{hooks:{"tags:beforeResolve":({tags:Re})=>{for(const Le of Re){if(Le.tagPosition&&"head"!==Le.tagPosition)continue;if(Le.tagPriority=Le.tagPriority||tagWeight(Le),100!==Le.tagPriority)continue;const isTruthy=Re=>""===Re||!0===Re,Re="script"===Le.tag,Oe="link"===Le.tag;Re&&isTruthy(Le.props.async)?Le.tagPriority=30:"style"===Le.tag&&Le.innerHTML&&uT.test(Le.innerHTML)?Le.tagPriority=40:!Re||!Le.props.src||isTruthy(Le.props.defer)||isTruthy(Le.props.async)||"module"===Le.props.type||Le.props.type?.endsWith("json")?Oe&&"stylesheet"===Le.props.rel||"style"===Le.tag?Le.tagPriority=60:!Oe||"preload"!==Le.props.rel&&"modulepreload"!==Le.props.rel?Re&&isTruthy(Le.props.defer)&&Le.props.src&&!isTruthy(Le.props.async)?Le.tagPriority=80:!Oe||"prefetch"!==Le.props.rel&&"dns-prefetch"!==Le.props.rel&&"prerender"!==Le.props.rel||(Le.tagPriority=90):Le.tagPriority=70:Le.tagPriority=50}_T?.track&&Re.push({tag:"htmlAttrs",props:{"data-capo":""}})}}})];var _T;const yT={meta:[{name:"viewport",content:"width=device-width, initial-scale=1"},{charset:"utf-8"}],link:[],style:[],script:[],noscript:[],charset:"utf-8",viewport:"width=device-width, initial-scale=1"},vT={id:"teleports"};function buildAssetsURL(...Re){return joinRelativeURL(publicAssetsURL(),useRuntimeConfig$1().app.buildAssetsDir,...Re)}function publicAssetsURL(...Re){const Le=useRuntimeConfig$1().app,Oe=Le.cdnURL||Le.baseURL;return Re.length?joinRelativeURL(Oe,...Re):Oe}globalThis.__buildAssetsURL=buildAssetsURL,globalThis.__publicAssetsURL=publicAssetsURL;const getClientManifest=()=>Promise.resolve().then((function(){return PT})).then((Re=>Re.default||Re)).then((Re=>"function"==typeof Re?Re():Re)),xT=lazyCachedFunction((()=>Promise.resolve().then((function(){return lA})).then((Re=>Re.default||Re)))),bT=lazyCachedFunction((async()=>{const Re=await getClientManifest();if(!Re)throw new Error("client.manifest is not available");const Le=await Promise.resolve().then((function(){return sA})).then((Re=>Re.default||Re));if(!Le)throw new Error("Server bundle is not available");return createRenderer$1(Le,{manifest:Re,renderToString:async function(Re,Le){const Oe=await renderToString(Re,Le);return CT+Oe+AT},buildAssetsURL:buildAssetsURL})})),wT=lazyCachedFunction((async()=>{const Re=await getClientManifest(),Le=await Promise.resolve().then((function(){return cA})).then((Re=>Re.template)).catch((()=>"")).then((Re=>CT+Re+AT)),Oe=createRenderer$1((()=>()=>{}),{manifest:Re,renderToString:()=>Le,buildAssetsURL:buildAssetsURL}),Ue=await Oe.renderToString({});return{rendererContext:Oe.rendererContext,renderToString:Re=>{const Le=useRuntimeConfig$1(Re.event);return Re.modules=Re.modules||new Set,Re.payload.serverRendered=!1,Re.config={public:Le.public,app:Le.app},Promise.resolve(Ue)}}})),TT=!!vT.id,ST=TT?`<div${propsToString(vT)}>`:"",ET=TT?"</div>":"",CT=`<div${propsToString({id:"__nuxt"})}>`,AT="</div>",IT=/\/_payload.json(\?.*)?$/,kT=function(Re){const Le=useRuntimeConfig$1();return xu((async Oe=>{if(Oe.path===`${Le.app.baseURL}favicon.ico`)return setResponseHeader(Oe,"Content-Type","image/x-icon"),send$1(Oe,"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7");const Ue=await Re(Oe);if(!Ue){const Re=getResponseStatus(Oe);return setResponseStatus(Oe,200===Re?500:Re),send$1(Oe,"No response returned from render handler: "+Oe.path)}const qe=useNitroApp();return await qe.hooks.callHook("render:response",Ue,{event:Oe}),Ue.headers&&setResponseHeaders(Oe,Ue.headers),(Ue.statusCode||Ue.statusMessage)&&setResponseStatus(Oe,Ue.statusCode,Ue.statusMessage),Ue.body}))}((async Re=>{const Le=useNitroApp(),Oe=Re.path.startsWith("/__nuxt_error")?function(Re){return getQuery$1(Re.path||"")}(Re):null;if(Oe&&Oe.statusCode&&(Oe.statusCode=Number.parseInt(Oe.statusCode)),Oe&&!("__unenv__"in Re.node.req))throw createError$2({statusCode:404,statusMessage:"Page Not Found: /__nuxt_error"});const Ue=false,qe=void 0;let Ct=Oe?.url||Re.path;const Ot=IT.test(Ct)&&!0;Ot&&(Ct=Ct.substring(0,Ct.lastIndexOf("/"))||"/",Re._path=Ct,Re.node.req.url=Ct);const Jt=getRouteRules$1(Re),Hr=createServerHead({plugins:gT}),Jr={mode:"server"};Hr.push(yT,Jr);const Ln={url:Ct,event:Re,runtimeConfig:useRuntimeConfig$1(Re),noSSR:Re.context.nuxt?.noSSR||!1===Jt.ssr&&!0||!1,head:Hr,error:!!Oe,nuxt:void 0,payload:Oe?{error:Oe}:{},_payloadReducers:Object.create(null),modules:new Set,islandContext:qe},Nn=Ln.noSSR?await wT():await bT();for(const Re of await getClientManifest().then((Re=>Object.values(Re).filter((Re=>Re._globalCSS)).map((Re=>Re.src)))))Ln.modules.add(Re);const $n=await Nn.renderToString(Ln).catch((async Re=>{if(Ln._renderResponse&&"skipping render"===Re.message)return{};const Le=!Oe&&Ln.payload?.error||Re;throw await(Ln.nuxt?.hooks.callHook("app:error",Le)),Le}));if(await(Ln.nuxt?.hooks.callHook("app:rendered",{ssrContext:Ln,renderResult:$n})),Ln._renderResponse)return Ln._renderResponse;if(Ln.payload?.error&&!Oe)throw Ln.payload.error;if(Ot){const Re=function(Re){return{body:stringify(splitPayload(Re).payload,Re._payloadReducers),statusCode:getResponseStatus(Re.event),statusMessage:getResponseStatusText(Re.event),headers:{"content-type":"application/json;charset=utf-8","x-powered-by":"Nuxt"}}}(Ln);return Re}const Gn=await async function(Re){const Le=await xT(),Oe=new Set;for(const Ue of Re)if(Ue in Le)for(const Re of await Le[Ue]())Oe.add(Re);return Array.from(Oe).map((Re=>({innerHTML:Re})))}(Ln.modules??[]),qn=Jt.experimentalNoScripts,{styles:Zn,scripts:Xn}=getRequestDependencies(Ln,Nn.rendererContext);Gn.length&&Hr.push({style:Gn});{const Re=[];for(const Le in Zn){const Oe=Zn[Le];Re.push({rel:"stylesheet",href:Nn.rendererContext.buildAssetsURL(Oe.file)})}Re.length&&Hr.push({link:Re},Jr)}qn||(Hr.push({link:getPreloadLinks(Ln,Nn.rendererContext)},Jr),Hr.push({link:getPrefetchLinks(Ln,Nn.rendererContext)},Jr),Hr.push({script:renderPayloadJsonScript({ssrContext:Ln,data:Ln.payload})},{...Jr,tagPosition:"bodyClose",tagPriority:"high"})),Jt.experimentalNoScripts||Hr.push({script:Object.values(Xn).map((Re=>({type:Re.module?"module":null,src:Nn.rendererContext.buildAssetsURL(Re.file),defer:!Re.module||null,tagPosition:"head",crossorigin:""})))},Jr);const{headTags:Yn,bodyTags:_i,bodyTagsOpen:vi,htmlAttrs:xi,bodyAttrs:bi}=await renderSSRHead(Hr),Pi={island:Ue,htmlAttrs:xi?[xi]:[],head:normalizeChunks([Yn]),bodyAttrs:bi?[bi]:[],bodyPrepend:normalizeChunks([vi,Ln.teleports?.body]),body:[$n.html,ST+(TT?joinTags([Ln.teleports?.[`#${vT.id}`]]):"")+ET],bodyAppend:[_i]};await Le.hooks.callHook("render:html",Pi,{event:Re});var lo;return{body:(lo=Pi,`<!DOCTYPE html><html${joinAttrs(lo.htmlAttrs)}><head>${joinTags(lo.head)}</head><body${joinAttrs(lo.bodyAttrs)}>${joinTags(lo.bodyPrepend)}${joinTags(lo.body)}${joinTags(lo.bodyAppend)}</body></html>`),statusCode:getResponseStatus(Re),statusMessage:getResponseStatusText(Re),headers:{"content-type":"text/html;charset=utf-8","x-powered-by":"Nuxt"}}}));function lazyCachedFunction(Re){let Le=null;return()=>(null===Le&&(Le=Re().catch((Re=>{throw Le=null,Re}))),Le)}function normalizeChunks(Re){return Re.filter(Boolean).map((Re=>Re.trim()))}function joinTags(Re){return Re.join("")}function joinAttrs(Re){return 0===Re.length?"":" "+Re.join(" ")}function renderPayloadJsonScript(Re){const Le={type:"application/json",innerHTML:Re.data?stringify(Re.data,Re.ssrContext._payloadReducers):"","data-nuxt-data":"nuxt-app","data-ssr":!Re.ssrContext.noSSR,id:"__NUXT_DATA__"};Re.src&&(Le["data-src"]=Re.src);return[Le,{innerHTML:`window.__NUXT__={};window.__NUXT__.config=${uneval(Re.ssrContext.config)}`}]}function splitPayload(Re){const{data:Le,prerenderedAt:Oe,...Ue}=Re.payload;return{initial:{...Ue,prerenderedAt:Oe},payload:{data:Le,prerenderedAt:Oe}}}const MT=Object.freeze(Object.defineProperty({__proto__:null,default:kT},Symbol.toStringTag,{value:"Module"})),PT=Object.freeze(Object.defineProperty({__proto__:null,default:{"_!~{00c}~.js":{resourceType:"style",prefetch:!0,preload:!0,file:"autoplay.BkhtZMPQ.css",src:"_!~{00c}~.js"},"_!~{00e}~.js":{resourceType:"style",prefetch:!0,preload:!0,file:"TravelCard.zJ4_UGgg.css",src:"_!~{00e}~.js"},"_B9nusEq2.js":{resourceType:"script",module:!0,prefetch:!0,preload:!0,file:"B9nusEq2.js",name:"nuxt-link",imports:["node_modules/nuxt/dist/app/entry.js"]},"_BfI7LEso.js":{resourceType:"script",module:!0,prefetch:!0,preload:!0,file:"BfI7LEso.js",name:"fetch",imports:["node_modules/nuxt/dist/app/entry.js"]},"_CHobc5Ck.js":{resourceType:"script",module:!0,prefetch:!0,preload:!0,file:"CHobc5Ck.js",name:"autoplay",imports:["node_modules/nuxt/dist/app/entry.js"],css:["autoplay.BkhtZMPQ.css"]},"autoplay.BkhtZMPQ.css":{file:"autoplay.BkhtZMPQ.css",resourceType:"style",prefetch:!0,preload:!0},"_DCgJ6GlI.js":{resourceType:"script",module:!0,prefetch:!0,preload:!0,file:"DCgJ6GlI.js",name:"index"},"_DYsX9Wrr.js":{resourceType:"script",module:!0,prefetch:!0,preload:!0,file:"DYsX9Wrr.js",name:"TravelCard",imports:["_B9nusEq2.js","_BfI7LEso.js","_DlAUqK2U.js","node_modules/nuxt/dist/app/entry.js"],css:["TravelCard.zJ4_UGgg.css"]},"TravelCard.zJ4_UGgg.css":{file:"TravelCard.zJ4_UGgg.css",resourceType:"style",prefetch:!0,preload:!0},"_DlAUqK2U.js":{resourceType:"script",module:!0,prefetch:!0,preload:!0,file:"DlAUqK2U.js",name:"_plugin-vue_export-helper"},"assets/img/1.jpg":{resourceType:"image",prefetch:!0,mimeType:"image/jpeg",file:"1.B97qKlVb.jpg",src:"assets/img/1.jpg"},"assets/img/2.jpg":{resourceType:"image",prefetch:!0,mimeType:"image/jpeg",file:"2.yaISrnfe.jpg",src:"assets/img/2.jpg"},"assets/img/3.jpg":{resourceType:"image",prefetch:!0,mimeType:"image/jpeg",file:"3.DFAJ96x1.jpg",src:"assets/img/3.jpg"},"assets/img/background.jpg":{resourceType:"image",prefetch:!0,mimeType:"image/jpeg",file:"background.By7YOMJB.jpg",src:"assets/img/background.jpg"},"i18n.config.ts?hash=bffaebcb&config=1":{resourceType:"script",module:!0,prefetch:!0,preload:!0,file:"htiXdPoh.js",name:"i18n.config",src:"i18n.config.ts?hash=bffaebcb&config=1",isDynamicEntry:!0},"layouts/default.vue":{resourceType:"script",module:!0,prefetch:!0,preload:!0,file:"B7f-cOco.js",name:"default",src:"layouts/default.vue",isDynamicEntry:!0,imports:["node_modules/nuxt/dist/app/entry.js","_B9nusEq2.js","_DlAUqK2U.js"],css:["default.CB7DEV1N.css"]},"default.CB7DEV1N.css":{file:"default.CB7DEV1N.css",resourceType:"style",prefetch:!0,preload:!0},"layouts/fullscreen.vue":{resourceType:"script",module:!0,prefetch:!0,preload:!0,file:"DbhfVOZE.js",name:"fullscreen",src:"layouts/fullscreen.vue",isDynamicEntry:!0,imports:["node_modules/nuxt/dist/app/entry.js"]},"node_modules/.cache/nuxt-google-fonts/fonts/Inter-400-1.woff2":{resourceType:"font",mimeType:"font/woff2",file:"Inter-400-1.Dc4VJyIJ.woff2",src:"node_modules/.cache/nuxt-google-fonts/fonts/Inter-400-1.woff2"},"node_modules/.cache/nuxt-google-fonts/fonts/Inter-400-2.woff2":{resourceType:"font",mimeType:"font/woff2",file:"Inter-400-2.BLGc9T1a.woff2",src:"node_modules/.cache/nuxt-google-fonts/fonts/Inter-400-2.woff2"},"node_modules/.cache/nuxt-google-fonts/fonts/Inter-400-3.woff2":{resourceType:"font",mimeType:"font/woff2",file:"Inter-400-3.Bput3-QP.woff2",src:"node_modules/.cache/nuxt-google-fonts/fonts/Inter-400-3.woff2"},"node_modules/.cache/nuxt-google-fonts/fonts/Inter-400-4.woff2":{resourceType:"font",mimeType:"font/woff2",file:"Inter-400-4.DxZsaF_h.woff2",src:"node_modules/.cache/nuxt-google-fonts/fonts/Inter-400-4.woff2"},"node_modules/.cache/nuxt-google-fonts/fonts/Inter-400-5.woff2":{resourceType:"font",mimeType:"font/woff2",file:"Inter-400-5.DMkecbls.woff2",src:"node_modules/.cache/nuxt-google-fonts/fonts/Inter-400-5.woff2"},"node_modules/.cache/nuxt-google-fonts/fonts/Inter-400-6.woff2":{resourceType:"font",mimeType:"font/woff2",file:"Inter-400-6.hnt3BR84.woff2",src:"node_modules/.cache/nuxt-google-fonts/fonts/Inter-400-6.woff2"},"node_modules/.cache/nuxt-google-fonts/fonts/Inter-400-7.woff2":{resourceType:"font",mimeType:"font/woff2",file:"Inter-400-7.BOOGhInR.woff2",src:"node_modules/.cache/nuxt-google-fonts/fonts/Inter-400-7.woff2"},"node_modules/nuxt-icon/dist/runtime/Icon.vue":{resourceType:"script",module:!0,prefetch:!0,preload:!0,file:"ymSMJ4lG.js",name:"Icon",src:"node_modules/nuxt-icon/dist/runtime/Icon.vue",isDynamicEntry:!0,imports:["node_modules/nuxt/dist/app/entry.js","_DCgJ6GlI.js","_DlAUqK2U.js"],css:[]},"Icon.8lQfE3Ql.css":{file:"Icon.8lQfE3Ql.css",resourceType:"style",prefetch:!0,preload:!0},"node_modules/nuxt-icon/dist/runtime/IconCSS.vue":{resourceType:"script",module:!0,prefetch:!0,preload:!0,file:"CCfhvWCp.js",name:"IconCSS",src:"node_modules/nuxt-icon/dist/runtime/IconCSS.vue",isDynamicEntry:!0,imports:["node_modules/nuxt/dist/app/entry.js","_DCgJ6GlI.js","_DlAUqK2U.js"],css:[]},"IconCSS.Z2BAHt_z.css":{file:"IconCSS.Z2BAHt_z.css",resourceType:"style",prefetch:!0,preload:!0},"node_modules/nuxt/dist/app/entry.js":{resourceType:"script",module:!0,prefetch:!0,preload:!0,file:"DALj7v9M.js",name:"entry",src:"node_modules/nuxt/dist/app/entry.js",isEntry:!0,dynamicImports:["layouts/default.vue","layouts/fullscreen.vue","i18n.config.ts?hash=bffaebcb&config=1"],css:["entry.GI64rjja.css"],assets:[],_globalCSS:!0},"entry.GI64rjja.css":{file:"entry.GI64rjja.css",resourceType:"style",prefetch:!0,preload:!0},"pages/about.vue":{resourceType:"script",module:!0,prefetch:!0,preload:!0,file:"Bk38zxj8.js",name:"about",src:"pages/about.vue",isDynamicEntry:!0,imports:["node_modules/nuxt/dist/app/entry.js"]},"pages/destinations/[id].vue":{resourceType:"script",module:!0,prefetch:!0,preload:!0,file:"CCJjKseu.js",name:"_id_",src:"pages/destinations/[id].vue",isDynamicEntry:!0,imports:["node_modules/nuxt/dist/app/entry.js","_DlAUqK2U.js","_CHobc5Ck.js","_BfI7LEso.js"],css:["_id_.BcqLlx2B.css"],assets:["1.B97qKlVb.jpg","2.yaISrnfe.jpg","3.DFAJ96x1.jpg"]},"_id_.BcqLlx2B.css":{file:"_id_.BcqLlx2B.css",resourceType:"style",prefetch:!0,preload:!0},"1.B97qKlVb.jpg":{file:"1.B97qKlVb.jpg",resourceType:"image",prefetch:!0,mimeType:"image/jpeg"},"2.yaISrnfe.jpg":{file:"2.yaISrnfe.jpg",resourceType:"image",prefetch:!0,mimeType:"image/jpeg"},"3.DFAJ96x1.jpg":{file:"3.DFAJ96x1.jpg",resourceType:"image",prefetch:!0,mimeType:"image/jpeg"},"pages/destinations/index.vue":{resourceType:"script",module:!0,prefetch:!0,preload:!0,file:"s6Wy28Tz.js",name:"index",src:"pages/destinations/index.vue",isDynamicEntry:!0,imports:["_DYsX9Wrr.js","node_modules/nuxt/dist/app/entry.js","_BfI7LEso.js","_B9nusEq2.js","_DlAUqK2U.js"]},"pages/index.vue":{resourceType:"script",module:!0,prefetch:!0,preload:!0,file:"C-Lrespx.js",name:"index",src:"pages/index.vue",isDynamicEntry:!0,imports:["_CHobc5Ck.js","_DYsX9Wrr.js","_BfI7LEso.js","node_modules/nuxt/dist/app/entry.js","_B9nusEq2.js","_DlAUqK2U.js"],css:["index.Bw5XmvsK.css"]},"index.Bw5XmvsK.css":{file:"index.Bw5XmvsK.css",resourceType:"style",prefetch:!0,preload:!0}}},Symbol.toStringTag,{value:"Module"})),RT="undefined"!=typeof document;function isRouteComponent(Re){return"object"==typeof Re||"displayName"in Re||"props"in Re||"__vccOpts"in Re}const LT=Object.assign;function applyToParams(Re,Le){const Oe={};for(const Ue in Le){const qe=Le[Ue];Oe[Ue]=OT(qe)?qe.map(Re):Re(qe)}return Oe}const noop=()=>{},OT=Array.isArray,zT=/#/g,DT=/&/g,BT=/\//g,FT=/=/g,NT=/\?/g,jT=/\+/g,UT=/%5B/g,VT=/%5D/g,$T=/%5E/g,GT=/%60/g,qT=/%7B/g,HT=/%7C/g,WT=/%7D/g,ZT=/%20/g;function commonEncode(Re){return encodeURI(""+Re).replace(HT,"|").replace(UT,"[").replace(VT,"]")}function encodeQueryValue$1(Re){return commonEncode(Re).replace(jT,"%2B").replace(ZT,"+").replace(zT,"%23").replace(DT,"%26").replace(GT,"`").replace(qT,"{").replace(WT,"}").replace($T,"^")}function encodeParam$1(Re){return null==Re?"":function(Re){return commonEncode(Re).replace(zT,"%23").replace(NT,"%3F")}(Re).replace(BT,"%2F")}function decode$1(Re){try{return decodeURIComponent(""+Re)}catch(Re){}return""+Re}const XT=/\/$/;function parseURL$1(Re,Le,Oe="/"){let Ue,qe={},Ct="",Ot="";const Jt=Le.indexOf("#");let Hr=Le.indexOf("?");return Jt<Hr&&Jt>=0&&(Hr=-1),Hr>-1&&(Ue=Le.slice(0,Hr),Ct=Le.slice(Hr+1,Jt>-1?Jt:Le.length),qe=Re(Ct)),Jt>-1&&(Ue=Ue||Le.slice(0,Jt),Ot=Le.slice(Jt,Le.length)),Ue=function(Re,Le){if(Re.startsWith("/"))return Re;if(!Re)return Le;const Oe=Le.split("/"),Ue=Re.split("/"),qe=Ue[Ue.length-1];".."!==qe&&"."!==qe||Ue.push("");let Ct,Ot,Jt=Oe.length-1;for(Ct=0;Ct<Ue.length;Ct++)if(Ot=Ue[Ct],"."!==Ot){if(".."!==Ot)break;Jt>1&&Jt--}return Oe.slice(0,Jt).join("/")+"/"+Ue.slice(Ct).join("/")}(null!=Ue?Ue:Le,Oe),{fullPath:Ue+(Ct&&"?")+Ct+Ot,path:Ue,query:qe,hash:decode$1(Ot)}}function isSameRouteRecord(Re,Le){return(Re.aliasOf||Re)===(Le.aliasOf||Le)}function isSameRouteLocationParams(Re,Le){if(Object.keys(Re).length!==Object.keys(Le).length)return!1;for(const Oe in Re)if(!isSameRouteLocationParamsValue(Re[Oe],Le[Oe]))return!1;return!0}function isSameRouteLocationParamsValue(Re,Le){return OT(Re)?isEquivalentArray(Re,Le):OT(Le)?isEquivalentArray(Le,Re):Re===Le}function isEquivalentArray(Re,Le){return OT(Le)?Re.length===Le.length&&Re.every(((Re,Oe)=>Re===Le[Oe])):1===Re.length&&Re[0]===Le}const YT={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var KT,JT;!function(Re){Re.pop="pop",Re.push="push"}(KT||(KT={})),function(Re){Re.back="back",Re.forward="forward",Re.unknown=""}(JT||(JT={}));function normalizeBase(Re){if(!Re)if(RT){const Le=document.querySelector("base");Re=(Re=Le&&Le.getAttribute("href")||"/").replace(/^\w+:\/\/[^\/]+/,"")}else Re="/";return"/"!==Re[0]&&"#"!==Re[0]&&(Re="/"+Re),Re.replace(XT,"")}const QT=/^[^#]+#/;function createHref(Re,Le){return Re.replace(QT,"#")+Le}function scrollToPosition(Re){let Le;if("el"in Re){const Oe=Re.el,Ue="string"==typeof Oe&&Oe.startsWith("#"),qe="string"==typeof Oe?Ue?document.getElementById(Oe.slice(1)):document.querySelector(Oe):Oe;if(!qe)return;Le=function(Re,Le){const Oe=document.documentElement.getBoundingClientRect(),Ue=Re.getBoundingClientRect();return{behavior:Le.behavior,left:Ue.left-Oe.left-(Le.left||0),top:Ue.top-Oe.top-(Le.top||0)}}(qe,Re)}else Le=Re;"scrollBehavior"in document.documentElement.style?window.scrollTo(Le):window.scrollTo(null!=Le.left?Le.left:window.scrollX,null!=Le.top?Le.top:window.scrollY)}function getScrollKey(Re,Le){return(history.state?history.state.position-Le:-1)+Re}const eS=new Map;function createMemoryHistory(Re=""){let Le=[],Oe=[""],Ue=0;function setLocation(Re){Ue++,Ue!==Oe.length&&Oe.splice(Ue),Oe.push(Re)}const qe={location:"",state:{},base:Re=normalizeBase(Re),createHref:createHref.bind(null,Re),replace(Re){Oe.splice(Ue--,1),setLocation(Re)},push(Re,Le){setLocation(Re)},listen:Re=>(Le.push(Re),()=>{const Oe=Le.indexOf(Re);Oe>-1&&Le.splice(Oe,1)}),destroy(){Le=[],Oe=[""],Ue=0},go(Re,qe=!0){const Ct=this.location,Ot=Re<0?JT.back:JT.forward;Ue=Math.max(0,Math.min(Ue+Re,Oe.length-1)),qe&&function(Re,Oe,{direction:Ue,delta:qe}){const Ct={direction:Ue,delta:qe,type:KT.pop};for(const Ue of Le)Ue(Re,Oe,Ct)}(this.location,Ct,{direction:Ot,delta:Re})}};return Object.defineProperty(qe,"location",{enumerable:!0,get:()=>Oe[Ue]}),qe}function isRouteName(Re){return"string"==typeof Re||"symbol"==typeof Re}const tS=Symbol("");var rS;function createRouterError(Re,Le){return LT(new Error,{type:Re,[tS]:!0},Le)}function isNavigationFailure(Re,Le){return Re instanceof Error&&tS in Re&&(null==Le||!!(Re.type&Le))}!function(Re){Re[Re.aborted=4]="aborted",Re[Re.cancelled=8]="cancelled",Re[Re.duplicated=16]="duplicated"}(rS||(rS={}));const nS="[^/]+?",iS={sensitive:!1,strict:!1,start:!0,end:!0},oS=/[.+*?^${}()[\]/\\]/g;function compareScoreArray(Re,Le){let Oe=0;for(;Oe<Re.length&&Oe<Le.length;){const Ue=Le[Oe]-Re[Oe];if(Ue)return Ue;Oe++}return Re.length<Le.length?1===Re.length&&80===Re[0]?-1:1:Re.length>Le.length?1===Le.length&&80===Le[0]?1:-1:0}function comparePathParserScore(Re,Le){let Oe=0;const Ue=Re.score,qe=Le.score;for(;Oe<Ue.length&&Oe<qe.length;){const Re=compareScoreArray(Ue[Oe],qe[Oe]);if(Re)return Re;Oe++}if(1===Math.abs(qe.length-Ue.length)){if(isLastScoreNegative(Ue))return 1;if(isLastScoreNegative(qe))return-1}return qe.length-Ue.length}function isLastScoreNegative(Re){const Le=Re[Re.length-1];return Re.length>0&&Le[Le.length-1]<0}const sS={type:0,value:""},aS=/[a-zA-Z0-9_]/;function createRouteRecordMatcher(Re,Le,Oe){const Ue=function(Re,Le){const Oe=LT({},iS,Le),Ue=[];let qe=Oe.start?"^":"";const Ct=[];for(const Le of Re){const Re=Le.length?[]:[90];Oe.strict&&!Le.length&&(qe+="/");for(let Ue=0;Ue<Le.length;Ue++){const Ot=Le[Ue];let Jt=40+(Oe.sensitive?.25:0);if(0===Ot.type)Ue||(qe+="/"),qe+=Ot.value.replace(oS,"\\$&"),Jt+=40;else if(1===Ot.type){const{value:Re,repeatable:Oe,optional:Hr,regexp:Jr}=Ot;Ct.push({name:Re,repeatable:Oe,optional:Hr});const Ln=Jr||nS;if(Ln!==nS){Jt+=10;try{new RegExp(`(${Ln})`)}catch(Le){throw new Error(`Invalid custom RegExp for param "${Re}" (${Ln}): `+Le.message)}}let Nn=Oe?`((?:${Ln})(?:/(?:${Ln}))*)`:`(${Ln})`;Ue||(Nn=Hr&&Le.length<2?`(?:/${Nn})`:"/"+Nn),Hr&&(Nn+="?"),qe+=Nn,Jt+=20,Hr&&(Jt+=-8),Oe&&(Jt+=-20),".*"===Ln&&(Jt+=-50)}Re.push(Jt)}Ue.push(Re)}if(Oe.strict&&Oe.end){const Re=Ue.length-1;Ue[Re][Ue[Re].length-1]+=.7000000000000001}Oe.strict||(qe+="/?"),Oe.end?qe+="$":Oe.strict&&(qe+="(?:/|$)");const Ot=new RegExp(qe,Oe.sensitive?"":"i");return{re:Ot,score:Ue,keys:Ct,parse:function(Re){const Le=Re.match(Ot),Oe={};if(!Le)return null;for(let Re=1;Re<Le.length;Re++){const Ue=Le[Re]||"",qe=Ct[Re-1];Oe[qe.name]=Ue&&qe.repeatable?Ue.split("/"):Ue}return Oe},stringify:function(Le){let Oe="",Ue=!1;for(const qe of Re){Ue&&Oe.endsWith("/")||(Oe+="/"),Ue=!1;for(const Re of qe)if(0===Re.type)Oe+=Re.value;else if(1===Re.type){const{value:Ct,repeatable:Ot,optional:Jt}=Re,Hr=Ct in Le?Le[Ct]:"";if(OT(Hr)&&!Ot)throw new Error(`Provided param "${Ct}" is an array but it is not repeatable (* or + modifiers)`);const Jr=OT(Hr)?Hr.join("/"):Hr;if(!Jr){if(!Jt)throw new Error(`Missing required param "${Ct}"`);qe.length<2&&(Oe.endsWith("/")?Oe=Oe.slice(0,-1):Ue=!0)}Oe+=Jr}}return Oe||"/"}}}(function(Re){if(!Re)return[[]];if("/"===Re)return[[sS]];if(!Re.startsWith("/"))throw new Error(`Invalid path "${Re}"`);function crash(Re){throw new Error(`ERR (${Le})/"${Jt}": ${Re}`)}let Le=0,Oe=Le;const Ue=[];let qe;function finalizeSegment(){qe&&Ue.push(qe),qe=[]}let Ct,Ot=0,Jt="",Hr="";function consumeBuffer(){Jt&&(0===Le?qe.push({type:0,value:Jt}):1===Le||2===Le||3===Le?(qe.length>1&&("*"===Ct||"+"===Ct)&&crash(`A repeatable param (${Jt}) must be alone in its segment. eg: '/:ids+.`),qe.push({type:1,value:Jt,regexp:Hr,repeatable:"*"===Ct||"+"===Ct,optional:"*"===Ct||"?"===Ct})):crash("Invalid state to consume buffer"),Jt="")}function addCharToBuffer(){Jt+=Ct}for(;Ot<Re.length;)if(Ct=Re[Ot++],"\\"!==Ct||2===Le)switch(Le){case 0:"/"===Ct?(Jt&&consumeBuffer(),finalizeSegment()):":"===Ct?(consumeBuffer(),Le=1):addCharToBuffer();break;case 4:addCharToBuffer(),Le=Oe;break;case 1:"("===Ct?Le=2:aS.test(Ct)?addCharToBuffer():(consumeBuffer(),Le=0,"*"!==Ct&&"?"!==Ct&&"+"!==Ct&&Ot--);break;case 2:")"===Ct?"\\"==Hr[Hr.length-1]?Hr=Hr.slice(0,-1)+Ct:Le=3:Hr+=Ct;break;case 3:consumeBuffer(),Le=0,"*"!==Ct&&"?"!==Ct&&"+"!==Ct&&Ot--,Hr="";break;default:crash("Unknown state")}else Oe=Le,Le=4;return 2===Le&&crash(`Unfinished custom RegExp for param "${Jt}"`),consumeBuffer(),finalizeSegment(),Ue}(Re.path),Oe),qe=LT(Ue,{record:Re,parent:Le,children:[],alias:[]});return Le&&!qe.record.aliasOf==!Le.record.aliasOf&&Le.children.push(qe),qe}function createRouterMatcher(Re,Le){const Oe=[],Ue=new Map;function addRoute(Re,Oe,Ue){const qe=!Ue,Ct=normalizeRouteRecord(Re);Ct.aliasOf=Ue&&Ue.record;const Ot=mergeOptions(Le,Re),Jt=[Ct];if("alias"in Re){const Le="string"==typeof Re.alias?[Re.alias]:Re.alias;for(const Re of Le)Jt.push(normalizeRouteRecord(LT({},Ct,{components:Ue?Ue.record.components:Ct.components,path:Re,aliasOf:Ue?Ue.record:Ct})))}let Hr,Jr;for(const Le of Jt){const{path:Jt}=Le;if(Oe&&"/"!==Jt[0]){const Re=Oe.record.path,Ue="/"===Re[Re.length-1]?"":"/";Le.path=Oe.record.path+(Jt&&Ue+Jt)}if(Hr=createRouteRecordMatcher(Le,Oe,Ot),Ue?Ue.alias.push(Hr):(Jr=Jr||Hr,Jr!==Hr&&Jr.alias.push(Hr),qe&&Re.name&&!isAliasRecord(Hr)&&removeRoute(Re.name)),isMatchable(Hr)&&insertMatcher(Hr),Ct.children){const Re=Ct.children;for(let Le=0;Le<Re.length;Le++)addRoute(Re[Le],Hr,Ue&&Ue.children[Le])}Ue=Ue||Hr}return Jr?()=>{removeRoute(Jr)}:noop}function removeRoute(Re){if(isRouteName(Re)){const Le=Ue.get(Re);Le&&(Ue.delete(Re),Oe.splice(Oe.indexOf(Le),1),Le.children.forEach(removeRoute),Le.alias.forEach(removeRoute))}else{const Le=Oe.indexOf(Re);Le>-1&&(Oe.splice(Le,1),Re.record.name&&Ue.delete(Re.record.name),Re.children.forEach(removeRoute),Re.alias.forEach(removeRoute))}}function insertMatcher(Re){const Le=function(Re,Le){let Oe=0,Ue=Le.length;for(;Oe!==Ue;){const qe=Oe+Ue>>1;comparePathParserScore(Re,Le[qe])<0?Ue=qe:Oe=qe+1}const qe=function(Re){let Le=Re;for(;Le=Le.parent;)if(isMatchable(Le)&&0===comparePathParserScore(Re,Le))return Le;return}(Re);qe&&(Ue=Le.lastIndexOf(qe,Ue-1));return Ue}(Re,Oe);Oe.splice(Le,0,Re),Re.record.name&&!isAliasRecord(Re)&&Ue.set(Re.record.name,Re)}return Le=mergeOptions({strict:!1,end:!0,sensitive:!1},Le),Re.forEach((Re=>addRoute(Re))),{addRoute:addRoute,resolve:function(Re,Le){let qe,Ct,Ot,Jt={};if("name"in Re&&Re.name){if(qe=Ue.get(Re.name),!qe)throw createRouterError(1,{location:Re});Ot=qe.record.name,Jt=LT(paramsFromLocation(Le.params,qe.keys.filter((Re=>!Re.optional)).concat(qe.parent?qe.parent.keys.filter((Re=>Re.optional)):[]).map((Re=>Re.name))),Re.params&&paramsFromLocation(Re.params,qe.keys.map((Re=>Re.name)))),Ct=qe.stringify(Jt)}else if(null!=Re.path)Ct=Re.path,qe=Oe.find((Re=>Re.re.test(Ct))),qe&&(Jt=qe.parse(Ct),Ot=qe.record.name);else{if(qe=Le.name?Ue.get(Le.name):Oe.find((Re=>Re.re.test(Le.path))),!qe)throw createRouterError(1,{location:Re,currentLocation:Le});Ot=qe.record.name,Jt=LT({},Le.params,Re.params),Ct=qe.stringify(Jt)}const Hr=[];let Jr=qe;for(;Jr;)Hr.unshift(Jr.record),Jr=Jr.parent;return{name:Ot,path:Ct,params:Jt,matched:Hr,meta:mergeMetaFields(Hr)}},removeRoute:removeRoute,clearRoutes:function(){Oe.length=0,Ue.clear()},getRoutes:function(){return Oe},getRecordMatcher:function(Re){return Ue.get(Re)}}}function paramsFromLocation(Re,Le){const Oe={};for(const Ue of Le)Ue in Re&&(Oe[Ue]=Re[Ue]);return Oe}function normalizeRouteRecord(Re){const Le={path:Re.path,redirect:Re.redirect,name:Re.name,meta:Re.meta||{},aliasOf:Re.aliasOf,beforeEnter:Re.beforeEnter,props:normalizeRecordProps(Re),children:Re.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in Re?Re.components||null:Re.component&&{default:Re.component}};return Object.defineProperty(Le,"mods",{value:{}}),Le}function normalizeRecordProps(Re){const Le={},Oe=Re.props||!1;if("component"in Re)Le.default=Oe;else for(const Ue in Re.components)Le[Ue]="object"==typeof Oe?Oe[Ue]:Oe;return Le}function isAliasRecord(Re){for(;Re;){if(Re.record.aliasOf)return!0;Re=Re.parent}return!1}function mergeMetaFields(Re){return Re.reduce(((Re,Le)=>LT(Re,Le.meta)),{})}function mergeOptions(Re,Le){const Oe={};for(const Ue in Re)Oe[Ue]=Ue in Le?Le[Ue]:Re[Ue];return Oe}function isMatchable({record:Re}){return!!(Re.name||Re.components&&Object.keys(Re.components).length||Re.redirect)}function parseQuery$1(Re){const Le={};if(""===Re||"?"===Re)return Le;const Oe=("?"===Re[0]?Re.slice(1):Re).split("&");for(let Re=0;Re<Oe.length;++Re){const Ue=Oe[Re].replace(jT," "),qe=Ue.indexOf("="),Ct=decode$1(qe<0?Ue:Ue.slice(0,qe)),Ot=qe<0?null:decode$1(Ue.slice(qe+1));if(Ct in Le){let Re=Le[Ct];OT(Re)||(Re=Le[Ct]=[Re]),Re.push(Ot)}else Le[Ct]=Ot}return Le}function stringifyQuery$1(Re){let Le="";for(let Oe in Re){const Ue=Re[Oe];if(Oe=encodeQueryValue$1(Oe).replace(FT,"%3D"),null==Ue){void 0!==Ue&&(Le+=(Le.length?"&":"")+Oe);continue}(OT(Ue)?Ue.map((Re=>Re&&encodeQueryValue$1(Re))):[Ue&&encodeQueryValue$1(Ue)]).forEach((Re=>{void 0!==Re&&(Le+=(Le.length?"&":"")+Oe,null!=Re&&(Le+="="+Re))}))}return Le}function normalizeQuery(Re){const Le={};for(const Oe in Re){const Ue=Re[Oe];void 0!==Ue&&(Le[Oe]=OT(Ue)?Ue.map((Re=>null==Re?null:""+Re)):null==Ue?Ue:""+Ue)}return Le}const lS=Symbol(""),cS=Symbol(""),uS=Symbol(""),hS=Symbol(""),dS=Symbol("");function useCallbacks(){let Re=[];return{add:function(Le){return Re.push(Le),()=>{const Oe=Re.indexOf(Le);Oe>-1&&Re.splice(Oe,1)}},list:()=>Re.slice(),reset:function(){Re=[]}}}function guardToPromiseFn(Re,Le,Oe,Ue,qe,Ct=Re=>Re()){const Ot=Ue&&(Ue.enterCallbacks[qe]=Ue.enterCallbacks[qe]||[]);return()=>new Promise(((Jt,Hr)=>{const next=Re=>{var Ct;!1===Re?Hr(createRouterError(4,{from:Oe,to:Le})):Re instanceof Error?Hr(Re):"string"==typeof(Ct=Re)||Ct&&"object"==typeof Ct?Hr(createRouterError(2,{from:Le,to:Re})):(Ot&&Ue.enterCallbacks[qe]===Ot&&"function"==typeof Re&&Ot.push(Re),Jt())},Jr=Ct((()=>Re.call(Ue&&Ue.instances[qe],Le,Oe,next)));let Ln=Promise.resolve(Jr);Re.length<3&&(Ln=Ln.then(next)),Ln.catch((Re=>Hr(Re)))}))}function extractComponentsGuards(Re,Le,Oe,Ue,qe=Re=>Re()){const Ct=[];for(const Ot of Re)for(const Re in Ot.components){let Jt=Ot.components[Re];if("beforeRouteEnter"===Le||Ot.instances[Re])if(isRouteComponent(Jt)){const Hr=(Jt.__vccOpts||Jt)[Le];Hr&&Ct.push(guardToPromiseFn(Hr,Oe,Ue,Ot,Re,qe))}else{let Hr=Jt();Ct.push((()=>Hr.then((Ct=>{if(!Ct)throw new Error(`Couldn't resolve component "${Re}" at "${Ot.path}"`);const Jt=(Hr=Ct).__esModule||"Module"===Hr[Symbol.toStringTag]||Hr.default&&isRouteComponent(Hr.default)?Ct.default:Ct;var Hr;Ot.mods[Re]=Ct,Ot.components[Re]=Jt;const Jr=(Jt.__vccOpts||Jt)[Le];return Jr&&guardToPromiseFn(Jr,Oe,Ue,Ot,Re,qe)()}))))}}return Ct}function useLink(Re){const Le=inject(uS),Oe=inject(hS),Ue=computed((()=>{const Oe=unref(Re.to);return Le.resolve(Oe)})),qe=computed((()=>{const{matched:Re}=Ue.value,{length:Le}=Re,qe=Re[Le-1],Ct=Oe.matched;if(!qe||!Ct.length)return-1;const Ot=Ct.findIndex(isSameRouteRecord.bind(null,qe));if(Ot>-1)return Ot;const Jt=getOriginalPath(Re[Le-2]);return Le>1&&getOriginalPath(qe)===Jt&&Ct[Ct.length-1].path!==Jt?Ct.findIndex(isSameRouteRecord.bind(null,Re[Le-2])):Ot})),Ct=computed((()=>qe.value>-1&&function(Re,Le){for(const Oe in Le){const Ue=Le[Oe],qe=Re[Oe];if("string"==typeof Ue){if(Ue!==qe)return!1}else if(!OT(qe)||qe.length!==Ue.length||Ue.some(((Re,Le)=>Re!==qe[Le])))return!1}return!0}(Oe.params,Ue.value.params))),Ot=computed((()=>qe.value>-1&&qe.value===Oe.matched.length-1&&isSameRouteLocationParams(Oe.params,Ue.value.params)));return{route:Ue,href:computed((()=>Ue.value.href)),isActive:Ct,isExactActive:Ot,navigate:function(Oe={}){return function(Re){if(Re.metaKey||Re.altKey||Re.ctrlKey||Re.shiftKey)return;if(Re.defaultPrevented)return;if(void 0!==Re.button&&0!==Re.button)return;if(Re.currentTarget&&Re.currentTarget.getAttribute){const Le=Re.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(Le))return}Re.preventDefault&&Re.preventDefault();return!0}(Oe)?Le[unref(Re.replace)?"replace":"push"](unref(Re.to)).catch(noop):Promise.resolve()}}}const pS=defineComponent({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:useLink,setup(Re,{slots:Le}){const Oe=reactive(useLink(Re)),{options:Ue}=inject(uS),qe=computed((()=>({[getLinkClass(Re.activeClass,Ue.linkActiveClass,"router-link-active")]:Oe.isActive,[getLinkClass(Re.exactActiveClass,Ue.linkExactActiveClass,"router-link-exact-active")]:Oe.isExactActive})));return()=>{const Ue=Le.default&&Le.default(Oe);return Re.custom?Ue:h("a",{"aria-current":Oe.isExactActive?Re.ariaCurrentValue:null,href:Oe.href,onClick:Oe.navigate,class:qe.value},Ue)}}}),fS=pS;function getOriginalPath(Re){return Re?Re.aliasOf?Re.aliasOf.path:Re.path:""}const getLinkClass=(Re,Le,Oe)=>null!=Re?Re:null!=Le?Le:Oe,mS=defineComponent({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(Re,{attrs:Le,slots:Oe}){const Ue=inject(dS),qe=computed((()=>Re.route||Ue.value)),Ct=inject(cS,0),Ot=computed((()=>{let Re=unref(Ct);const{matched:Le}=qe.value;let Oe;for(;(Oe=Le[Re])&&!Oe.components;)Re++;return Re})),Jt=computed((()=>qe.value.matched[Ot.value]));provide(cS,computed((()=>Ot.value+1))),provide(lS,Jt),provide(dS,qe);const Hr=ref();return watch((()=>[Hr.value,Jt.value,Re.name]),(([Re,Le,Oe],[Ue,qe,Ct])=>{Le&&(Le.instances[Oe]=Re,qe&&qe!==Le&&Re&&Re===Ue&&(Le.leaveGuards.size||(Le.leaveGuards=qe.leaveGuards),Le.updateGuards.size||(Le.updateGuards=qe.updateGuards))),!Re||!Le||qe&&isSameRouteRecord(Le,qe)&&Ue||(Le.enterCallbacks[Oe]||[]).forEach((Le=>Le(Re)))}),{flush:"post"}),()=>{const Ue=qe.value,Ct=Re.name,Ot=Jt.value,Jr=Ot&&Ot.components[Ct];if(!Jr)return normalizeSlot(Oe.default,{Component:Jr,route:Ue});const Ln=Ot.props[Ct],Nn=Ln?!0===Ln?Ue.params:"function"==typeof Ln?Ln(Ue):Ln:null,$n=h(Jr,LT({},Nn,Le,{onVnodeUnmounted:Re=>{Re.component.isUnmounted&&(Ot.instances[Ct]=null)},ref:Hr}));return normalizeSlot(Oe.default,{Component:$n,route:Ue})||$n}}});function normalizeSlot(Re,Le){if(!Re)return null;const Oe=Re(Le);return 1===Oe.length?Oe[0]:Oe}const gS=mS;function createRouter(Re){const Le=createRouterMatcher(Re.routes,Re),Oe=Re.parseQuery||parseQuery$1,Ue=Re.stringifyQuery||stringifyQuery$1,qe=Re.history,Ct=useCallbacks(),Ot=useCallbacks(),Jt=useCallbacks(),Hr=shallowRef(YT);let Jr=YT;RT&&Re.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const Ln=applyToParams.bind(null,(Re=>""+Re)),Nn=applyToParams.bind(null,encodeParam$1),$n=applyToParams.bind(null,decode$1);function resolve(Re,Ct){if(Ct=LT({},Ct||Hr.value),"string"==typeof Re){const Ue=parseURL$1(Oe,Re,Ct.path),Ot=Le.resolve({path:Ue.path},Ct),Jt=qe.createHref(Ue.fullPath);return LT(Ue,Ot,{params:$n(Ot.params),hash:decode$1(Ue.hash),redirectedFrom:void 0,href:Jt})}let Ot;if(null!=Re.path)Ot=LT({},Re,{path:parseURL$1(Oe,Re.path,Ct.path).path});else{const Le=LT({},Re.params);for(const Re in Le)null==Le[Re]&&delete Le[Re];Ot=LT({},Re,{params:Nn(Le)}),Ct.params=Nn(Ct.params)}const Jt=Le.resolve(Ot,Ct),Jr=Re.hash||"";Jt.params=Ln($n(Jt.params));const Gn=function(Re,Le){const Oe=Le.query?Re(Le.query):"";return Le.path+(Oe&&"?")+Oe+(Le.hash||"")}(Ue,LT({},Re,{hash:(qn=Jr,commonEncode(qn).replace(qT,"{").replace(WT,"}").replace($T,"^")),path:Jt.path}));var qn;const Zn=qe.createHref(Gn);return LT({fullPath:Gn,hash:Jr,query:Ue===stringifyQuery$1?normalizeQuery(Re.query):Re.query||{}},Jt,{redirectedFrom:void 0,href:Zn})}function locationAsObject(Re){return"string"==typeof Re?parseURL$1(Oe,Re,Hr.value.path):LT({},Re)}function checkCanceledNavigation(Re,Le){if(Jr!==Re)return createRouterError(8,{from:Le,to:Re})}function push(Re){return pushWithRedirect(Re)}function handleRedirectRecord(Re){const Le=Re.matched[Re.matched.length-1];if(Le&&Le.redirect){const{redirect:Oe}=Le;let Ue="function"==typeof Oe?Oe(Re):Oe;return"string"==typeof Ue&&(Ue=Ue.includes("?")||Ue.includes("#")?Ue=locationAsObject(Ue):{path:Ue},Ue.params={}),LT({query:Re.query,hash:Re.hash,params:null!=Ue.path?{}:Re.params},Ue)}}function pushWithRedirect(Re,Le){const Oe=Jr=resolve(Re),qe=Hr.value,Ct=Re.state,Ot=Re.force,Jt=!0===Re.replace,Ln=handleRedirectRecord(Oe);if(Ln)return pushWithRedirect(LT(locationAsObject(Ln),{state:"object"==typeof Ln?LT({},Ct,Ln.state):Ct,force:Ot,replace:Jt}),Le||Oe);const Nn=Oe;let $n;return Nn.redirectedFrom=Le,!Ot&&function(Re,Le,Oe){const Ue=Le.matched.length-1,qe=Oe.matched.length-1;return Ue>-1&&Ue===qe&&isSameRouteRecord(Le.matched[Ue],Oe.matched[qe])&&isSameRouteLocationParams(Le.params,Oe.params)&&Re(Le.query)===Re(Oe.query)&&Le.hash===Oe.hash}(Ue,qe,Oe)&&($n=createRouterError(16,{to:Nn,from:qe}),handleScroll(qe,qe,!0,!1)),($n?Promise.resolve($n):navigate(Nn,qe)).catch((Re=>isNavigationFailure(Re)?isNavigationFailure(Re,2)?Re:markAsReady(Re):triggerError(Re,Nn,qe))).then((Re=>{if(Re){if(isNavigationFailure(Re,2))return pushWithRedirect(LT({replace:Jt},locationAsObject(Re.to),{state:"object"==typeof Re.to?LT({},Ct,Re.to.state):Ct,force:Ot}),Le||Nn)}else Re=finalizeNavigation(Nn,qe,!0,Jt,Ct);return triggerAfterEach(Nn,qe,Re),Re}))}function checkCanceledNavigationAndReject(Re,Le){const Oe=checkCanceledNavigation(Re,Le);return Oe?Promise.reject(Oe):Promise.resolve()}function runWithContext(Re){const Le=_i.values().next().value;return Le&&"function"==typeof Le.runWithContext?Le.runWithContext(Re):Re()}function navigate(Re,Le){let Oe;const[Ue,qe,Jt]=function(Re,Le){const Oe=[],Ue=[],qe=[],Ct=Math.max(Le.matched.length,Re.matched.length);for(let Ot=0;Ot<Ct;Ot++){const Ct=Le.matched[Ot];Ct&&(Re.matched.find((Re=>isSameRouteRecord(Re,Ct)))?Ue.push(Ct):Oe.push(Ct));const Jt=Re.matched[Ot];Jt&&(Le.matched.find((Re=>isSameRouteRecord(Re,Jt)))||qe.push(Jt))}return[Oe,Ue,qe]}(Re,Le);Oe=extractComponentsGuards(Ue.reverse(),"beforeRouteLeave",Re,Le);for(const qe of Ue)qe.leaveGuards.forEach((Ue=>{Oe.push(guardToPromiseFn(Ue,Re,Le))}));const Hr=checkCanceledNavigationAndReject.bind(null,Re,Le);return Oe.push(Hr),runGuardQueue(Oe).then((()=>{Oe=[];for(const Ue of Ct.list())Oe.push(guardToPromiseFn(Ue,Re,Le));return Oe.push(Hr),runGuardQueue(Oe)})).then((()=>{Oe=extractComponentsGuards(qe,"beforeRouteUpdate",Re,Le);for(const Ue of qe)Ue.updateGuards.forEach((Ue=>{Oe.push(guardToPromiseFn(Ue,Re,Le))}));return Oe.push(Hr),runGuardQueue(Oe)})).then((()=>{Oe=[];for(const Ue of Jt)if(Ue.beforeEnter)if(OT(Ue.beforeEnter))for(const qe of Ue.beforeEnter)Oe.push(guardToPromiseFn(qe,Re,Le));else Oe.push(guardToPromiseFn(Ue.beforeEnter,Re,Le));return Oe.push(Hr),runGuardQueue(Oe)})).then((()=>(Re.matched.forEach((Re=>Re.enterCallbacks={})),Oe=extractComponentsGuards(Jt,"beforeRouteEnter",Re,Le,runWithContext),Oe.push(Hr),runGuardQueue(Oe)))).then((()=>{Oe=[];for(const Ue of Ot.list())Oe.push(guardToPromiseFn(Ue,Re,Le));return Oe.push(Hr),runGuardQueue(Oe)})).catch((Re=>isNavigationFailure(Re,8)?Re:Promise.reject(Re)))}function triggerAfterEach(Re,Le,Oe){Jt.list().forEach((Ue=>runWithContext((()=>Ue(Re,Le,Oe)))))}function finalizeNavigation(Re,Le,Oe,Ue,Ct){const Ot=checkCanceledNavigation(Re,Le);if(Ot)return Ot;const Jt=Le===YT,Jr=RT?history.state:{};Oe&&(Ue||Jt?qe.replace(Re.fullPath,LT({scroll:Jt&&Jr&&Jr.scroll},Ct)):qe.push(Re.fullPath,Ct)),Hr.value=Re,handleScroll(Re,Le,Oe,Jt),markAsReady()}let Gn;function setupListeners(){Gn||(Gn=qe.listen(((Re,Le,Oe)=>{if(!vi.listening)return;const Ue=resolve(Re),Ct=handleRedirectRecord(Ue);if(Ct)return void pushWithRedirect(LT(Ct,{replace:!0}),Ue).catch(noop);Jr=Ue;const Ot=Hr.value;var Jt,Ln;RT&&(Jt=getScrollKey(Ot.fullPath,Oe.delta),Ln={left:window.scrollX,top:window.scrollY},eS.set(Jt,Ln)),navigate(Ue,Ot).catch((Re=>isNavigationFailure(Re,12)?Re:isNavigationFailure(Re,2)?(pushWithRedirect(Re.to,Ue).then((Re=>{isNavigationFailure(Re,20)&&!Oe.delta&&Oe.type===KT.pop&&qe.go(-1,!1)})).catch(noop),Promise.reject()):(Oe.delta&&qe.go(-Oe.delta,!1),triggerError(Re,Ue,Ot)))).then((Re=>{(Re=Re||finalizeNavigation(Ue,Ot,!1))&&(Oe.delta&&!isNavigationFailure(Re,8)?qe.go(-Oe.delta,!1):Oe.type===KT.pop&&isNavigationFailure(Re,20)&&qe.go(-1,!1)),triggerAfterEach(Ue,Ot,Re)})).catch(noop)})))}let qn,Zn=useCallbacks(),Xn=useCallbacks();function triggerError(Re,Le,Oe){markAsReady(Re);const Ue=Xn.list();return Ue.length?Ue.forEach((Ue=>Ue(Re,Le,Oe))):console.error(Re),Promise.reject(Re)}function markAsReady(Re){return qn||(qn=!Re,setupListeners(),Zn.list().forEach((([Le,Oe])=>Re?Oe(Re):Le())),Zn.reset()),Re}function handleScroll(Le,Oe,Ue,qe){const{scrollBehavior:Ct}=Re;if(!RT||!Ct)return Promise.resolve();const Ot=!Ue&&function(Re){const Le=eS.get(Re);return eS.delete(Re),Le}(getScrollKey(Le.fullPath,0))||(qe||!Ue)&&history.state&&history.state.scroll||null;return nextTick$1().then((()=>Ct(Le,Oe,Ot))).then((Re=>Re&&scrollToPosition(Re))).catch((Re=>triggerError(Re,Le,Oe)))}const go=Re=>qe.go(Re);let Yn;const _i=new Set,vi={currentRoute:Hr,listening:!0,addRoute:function(Re,Oe){let Ue,qe;return isRouteName(Re)?(Ue=Le.getRecordMatcher(Re),qe=Oe):qe=Re,Le.addRoute(qe,Ue)},removeRoute:function(Re){const Oe=Le.getRecordMatcher(Re);Oe&&Le.removeRoute(Oe)},clearRoutes:Le.clearRoutes,hasRoute:function(Re){return!!Le.getRecordMatcher(Re)},getRoutes:function(){return Le.getRoutes().map((Re=>Re.record))},resolve:resolve,options:Re,push:push,replace:function(Re){return push(LT(locationAsObject(Re),{replace:!0}))},go:go,back:()=>go(-1),forward:()=>go(1),beforeEach:Ct.add,beforeResolve:Ot.add,afterEach:Jt.add,onError:Xn.add,isReady:function(){return qn&&Hr.value!==YT?Promise.resolve():new Promise(((Re,Le)=>{Zn.add([Re,Le])}))},install(Re){Re.component("RouterLink",fS),Re.component("RouterView",gS),Re.config.globalProperties.$router=this,Object.defineProperty(Re.config.globalProperties,"$route",{enumerable:!0,get:()=>unref(Hr)}),RT&&!Yn&&Hr.value===YT&&(Yn=!0,push(qe.location).catch((Re=>{})));const Le={};for(const Re in YT)Object.defineProperty(Le,Re,{get:()=>Hr.value[Re],enumerable:!0});Re.provide(uS,this),Re.provide(hS,shallowReactive(Le)),Re.provide(dS,Hr);const Oe=Re.unmount;_i.add(Re),Re.unmount=function(){_i.delete(Re),_i.size<1&&(Jr=YT,Gn&&Gn(),Gn=null,Hr.value=YT,Yn=!1,qn=!1),Oe()}}};function runGuardQueue(Re){return Re.reduce(((Re,Le)=>Re.then((()=>runWithContext(Le)))),Promise.resolve())}return vi}globalThis.$fetch||(globalThis.$fetch=Qu.create({baseURL:useRuntimeConfig$1().app.baseURL}));const _S={name:"page",mode:"out-in"},yS={componentName:"NuxtLink",prefetch:!0,prefetchOn:{visibility:!0}},vS={value:null,errorValue:null,deep:!0},xS={},bS="nuxt-app";function getNuxtAppCtx(Re=bS){return((Re,Le={})=>dv.get(Re,Le))(Re,{asyncContext:!1})}const wS="__nuxt_plugin";function registerPluginHooks(Re,Le){Le.hooks&&Re.hooks.addHooks(Le.hooks)}function defineNuxtPlugin(Re){if("function"==typeof Re)return Re;const Le=Re._name||Re.name;return delete Re.name,Object.assign(Re.setup||(()=>{}),Re,{[wS]:!0,_name:Le})}function callWithNuxt(Re,Le,Oe){const fn=()=>Le(),Ue=getNuxtAppCtx(Re._id);return Re.vueApp.runWithContext((()=>Ue.callAsync(Re,fn)))}function useNuxtApp(Re){const Le=function(Re){var Le;let Oe;return hasInjectionContext()&&(Oe=null==(Le=getCurrentInstance())?void 0:Le.appContext.app.$nuxt),Oe=Oe||getNuxtAppCtx(Re).tryUse(),Oe||null}(Re);if(!Le)throw new Error("[nuxt] instance unavailable");return Le}function useRuntimeConfig(Re){return useNuxtApp().$config}function defineGetter$1(Re,Le,Oe){Object.defineProperty(Re,Le,{get:()=>Oe})}const TS=/#/g,SS=/&/g,ES=/\//g,CS=/=/g,AS=/\?/g,IS=/\+/g,kS=/%5e/gi,MS=/%60/gi,PS=/%7c/gi,RS=/%20/gi,LS=/%252f/gi;function encode(Re){return encodeURI(""+Re).replace(PS,"|")}function encodeQueryValue(Re){return encode("string"==typeof Re?Re:JSON.stringify(Re)).replace(IS,"%2B").replace(RS,"+").replace(TS,"%23").replace(SS,"%26").replace(MS,"`").replace(kS,"^").replace(ES,"%2F")}function encodeQueryKey(Re){return encodeQueryValue(Re).replace(CS,"%3D")}function encodePath(Re){return encode(Re).replace(TS,"%23").replace(AS,"%3F").replace(LS,"%2F").replace(SS,"%26").replace(IS,"%2B")}function encodeParam(Re){return encodePath(Re).replace(ES,"%2F")}function decode(Re=""){try{return decodeURIComponent(""+Re)}catch{return""+Re}}function decodeQueryValue(Re){return decode(Re.replace(IS," "))}function parseQuery(Re=""){const Le={};"?"===Re[0]&&(Re=Re.slice(1));for(const Oe of Re.split("&")){const Re=Oe.match(/([^=]+)=?(.*)/)||[];if(Re.length<2)continue;const Ue=decode(Re[1].replace(IS," "));if("__proto__"===Ue||"constructor"===Ue)continue;const qe=decodeQueryValue(Re[2]||"");void 0===Le[Ue]?Le[Ue]=qe:Array.isArray(Le[Ue])?Le[Ue].push(qe):Le[Ue]=[Le[Ue],qe]}return Le}function stringifyQuery(Re){return Object.keys(Re).filter((Le=>void 0!==Re[Le])).map((Le=>{return Oe=Le,"number"!=typeof(Ue=Re[Le])&&"boolean"!=typeof Ue||(Ue=String(Ue)),Ue?Array.isArray(Ue)?Ue.map((Re=>`${encodeQueryKey(Oe)}=${encodeQueryValue(Re)}`)).join("&"):`${encodeQueryKey(Oe)}=${encodeQueryValue(Ue)}`:encodeQueryKey(Oe);var Oe,Ue})).filter(Boolean).join("&")}const OS=/^[\s\w\0+.-]{2,}:([/\\]{1,2})/,zS=/^[\s\w\0+.-]{2,}:([/\\]{2})?/,DS=/^([/\\]\s*){2,}[^/\\]/,BS=/^[\s\0]*(blob|data|javascript|vbscript):$/i,FS=/\/$|\/\?|\/#/,NS=/^\.?\//;function hasProtocol(Re,Le={}){return"boolean"==typeof Le&&(Le={acceptRelative:Le}),Le.strict?OS.test(Re):zS.test(Re)||!!Le.acceptRelative&&DS.test(Re)}function hasTrailingSlash(Re="",Le){return Le?FS.test(Re):Re.endsWith("/")}function withoutTrailingSlash(Re="",Le){if(!Le)return(hasTrailingSlash(Re)?Re.slice(0,-1):Re)||"/";if(!hasTrailingSlash(Re,!0))return Re||"/";let Oe=Re,Ue="";const qe=Re.indexOf("#");qe>=0&&(Oe=Re.slice(0,qe),Ue=Re.slice(qe));const[Ct,...Ot]=Oe.split("?");return((Ct.endsWith("/")?Ct.slice(0,-1):Ct)||"/")+(Ot.length>0?`?${Ot.join("?")}`:"")+Ue}function withTrailingSlash(Re="",Le){if(!Le)return Re.endsWith("/")?Re:Re+"/";if(hasTrailingSlash(Re,!0))return Re||"/";let Oe=Re,Ue="";const qe=Re.indexOf("#");if(qe>=0&&(Oe=Re.slice(0,qe),Ue=Re.slice(qe),!Oe))return Ue;const[Ct,...Ot]=Oe.split("?");return Ct+"/"+(Ot.length>0?`?${Ot.join("?")}`:"")+Ue}function withLeadingSlash(Re=""){return function(Re=""){return Re.startsWith("/")}(Re)?Re:"/"+Re}function withQuery(Re,Le){const Oe=parseURL(Re),Ue={...parseQuery(Oe.search),...Le};return Oe.search=stringifyQuery(Ue),function(Re){const Le=Re.pathname||"",Oe=Re.search?(Re.search.startsWith("?")?"":"?")+Re.search:"",Ue=Re.hash||"",qe=Re.auth?Re.auth+"@":"",Ct=Re.host||"",Ot=Re.protocol||Re[jS]?(Re.protocol||"")+"//":"";return Ot+qe+Ct+Le+Oe+Ue}(Oe)}function joinURL(Re,...Le){let Oe=Re||"";for(const Re of Le.filter((Re=>function(Re){return Re&&"/"!==Re}(Re))))if(Oe){const Le=Re.replace(NS,"");Oe=withTrailingSlash(Oe)+Le}else Oe=Re;return Oe}function isEqual(Re,Le,Oe={}){return Oe.trailingSlash||(Re=withTrailingSlash(Re),Le=withTrailingSlash(Le)),Oe.leadingSlash||(Re=withLeadingSlash(Re),Le=withLeadingSlash(Le)),Oe.encoding||(Re=decode(Re),Le=decode(Le)),Re===Le}const jS=Symbol.for("ufo:protocolRelative");function parseURL(Re="",Le){const Oe=Re.match(/^[\s\0]*(blob:|data:|javascript:|vbscript:)(.*)/i);if(Oe){const[,Re,Le=""]=Oe;return{protocol:Re.toLowerCase(),pathname:Le,href:Re+Le,auth:"",host:"",search:"",hash:""}}if(!hasProtocol(Re,{acceptRelative:!0}))return parsePath(Re);const[,Ue="",qe,Ct=""]=Re.replace(/\\/g,"/").match(/^[\s\0]*([\w+.-]{2,}:)?\/\/([^/@]+@)?(.*)/)||[];let[,Ot="",Jt=""]=Ct.match(/([^#/?]*)(.*)?/)||[];"file:"===Ue&&(Jt=Jt.replace(/\/(?=[A-Za-z]:)/,""));const{pathname:Hr,search:Jr,hash:Ln}=parsePath(Jt);return{protocol:Ue.toLowerCase(),auth:qe?qe.slice(0,Math.max(0,qe.length-1)):"",host:Ot,pathname:Hr,search:Jr,hash:Ln,[jS]:!Ue}}function parsePath(Re=""){const[Le="",Oe="",Ue=""]=(Re.match(/([^#?]*)(\?[^#]*)?(#.*)?/)||[]).splice(1);return{pathname:Le,search:Oe,hash:Ue}}const US=Symbol("layout-meta"),VS=Symbol("route"),useRouter=()=>{var Re;return null==(Re=useNuxtApp())?void 0:Re.$router},useRoute=()=>hasInjectionContext()?inject(VS,useNuxtApp()._route):useNuxtApp()._route;function defineNuxtRouteMiddleware(Re){return Re}const navigateTo=(Re,Le)=>{Re||(Re="/");const Oe="string"==typeof Re?Re:"path"in Re?resolveRouteObject(Re):useRouter().resolve(Re).href,Ue=hasProtocol(Oe,{acceptRelative:!0}),qe=(null==Le?void 0:Le.external)||Ue;if(qe){if(!(null==Le?void 0:Le.external))throw new Error("Navigating to an external URL is not allowed by default. Use `navigateTo(url, { external: true })`.");const{protocol:Re}=new URL(Oe,"http://localhost");if(Re&&function(Re){return!!Re&&BS.test(Re)}(Re))throw new Error(`Cannot navigate to a URL with '${Re}' protocol.`)}const Ct=(()=>{try{if(useNuxtApp()._processingMiddleware)return!0}catch{return!1}return!1})(),Ot=useRouter(),Jt=useNuxtApp();if(Jt.ssrContext){const Hr="string"==typeof Re||qe?Oe:Ot.resolve(Re).fullPath||"/",Jr=qe?Oe:joinURL(useRuntimeConfig().app.baseURL,Hr),redirect=async function(Re){await Jt.callHook("app:redirected");const Oe=Jr.replace(/"/g,"%22"),qe=function(Re,Le=!1){const Oe=new URL(Re,"http://localhost");if(!Le)return Oe.pathname+Oe.search+Oe.hash;if(Re.startsWith("//"))return Oe.toString().replace(Oe.protocol,"");return Oe.toString()}(Jr,Ue);return Jt.ssrContext._renderResponse={statusCode:sanitizeStatusCode((null==Le?void 0:Le.redirectCode)||302,302),body:`<!DOCTYPE html><html><head><meta http-equiv="refresh" content="0; url=${Oe}"></head></html>`,headers:{location:qe}},Re};return!qe&&Ct?(Ot.afterEach((Re=>Re.fullPath===Hr?redirect(!1):void 0)),Re):redirect(!Ct&&void 0)}return qe?(Jt._scope.stop(),(null==Le?void 0:Le.replace)?(void 0).replace(Oe):(void 0).href=Oe,Ct?!!Jt.isHydrating&&new Promise((()=>{})):Promise.resolve()):(null==Le?void 0:Le.replace)?Ot.replace(Re):Ot.push(Re)};function resolveRouteObject(Re){return withQuery(Re.path||"",Re.query||{})+(Re.hash||"")}const $S="__nuxt_error",useError=()=>toRef(useNuxtApp().payload,"error"),showError=Re=>{const Le=createError(Re);try{useNuxtApp();const Re=useError();0,Re.value=Re.value||Le}catch{throw Le}return Le},createError=Re=>{const Le=createError$2(Re);return Object.defineProperty(Le,$S,{value:!0,configurable:!1,writable:!1}),Le},GS=defineNuxtPlugin({name:"nuxt:head",enforce:"pre",setup(Re){const Le=Re.ssrContext.head;var Oe;Oe=()=>useNuxtApp().vueApp._context.provides.usehead,fT[mT]=Oe,Re.vueApp.use(Le)}});const qS="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof global?global:{},HS="__unctx__";qS[HS]||(qS[HS]=function(Re={}){const Le={};return{get:(Oe,Ue={})=>(Le[Oe]||(Le[Oe]=function(Re={}){let Le,Oe=!1;const checkConflict=Re=>{if(Le&&Le!==Re)throw new Error("Context conflict")};let Ue;if(Re.asyncContext){const Le=Re.AsyncLocalStorage||globalThis.AsyncLocalStorage;Le?Ue=new Le:console.warn("[unctx] `AsyncLocalStorage` is not provided.")}const _getCurrentInstance=()=>{if(Ue&&void 0===Le){const Re=Ue.getStore();if(void 0!==Re)return Re}return Le};return{use:()=>{const Re=_getCurrentInstance();if(void 0===Re)throw new Error("Context is not available");return Re},tryUse:()=>_getCurrentInstance(),set:(Re,Ue)=>{Ue||checkConflict(Re),Le=Re,Oe=!0},unset:()=>{Le=void 0,Oe=!1},call:(Re,qe)=>{checkConflict(Re),Le=Re;try{return Ue?Ue.run(Re,qe):qe()}finally{Oe||(Le=void 0)}},async callAsync(Re,qe){Le=Re;const onRestore=()=>{Le=Re},onLeave=()=>Le===Re?onRestore:void 0;ZS.add(onLeave);try{const Ct=Ue?Ue.run(Re,qe):qe();return Oe||(Le=void 0),await Ct}finally{ZS.delete(onLeave)}}}}({...Re,...Ue})),Le[Oe],Le[Oe])}}());const WS="__unctx_async_handlers__",ZS=qS[WS]||(qS[WS]=new Set);function executeAsync(Re){const Le=[];for(const Re of ZS){const Oe=Re();Oe&&Le.push(Oe)}const restore=()=>{for(const Re of Le)Re()};let Oe=Re();return Oe&&"object"==typeof Oe&&"catch"in Oe&&(Oe=Oe.catch((Re=>{throw restore(),Re}))),[Oe,restore]}function toArray(Re){return Array.isArray(Re)?Re:[Re]}const XS=[{name:"about",path:"/about",component:()=>Promise.resolve().then((function(){return dA}))},{name:"destinations-id",path:"/destinations/:id()",component:()=>Promise.resolve().then((function(){return KA}))},{name:"destinations",path:"/destinations",meta:{layout:"default"}||{},component:()=>Promise.resolve().then((function(){return oI}))},{name:"index",path:"/",component:()=>Promise.resolve().then((function(){return hI}))}],_wrapIf=(Re,Le,Oe)=>(Le=!0===Le?{}:Le,{default:()=>{var Ue;return Le?h(Re,Le,Oe):null==(Ue=Oe.default)?void 0:Ue.call(Oe)}});function generateRouteKey(Re){const Le=(null==Re?void 0:Re.meta.key)??Re.path.replace(/(:\w+)\([^)]+\)/g,"$1").replace(/(:\w+)[?+*]/g,"$1").replace(/:\w+/g,(Le=>{var Oe;return(null==(Oe=Re.params[Le.slice(1)])?void 0:Oe.toString())||""}));return"function"==typeof Le?Le(Re):Le}const YS={scrollBehavior(Re,Le,Oe){var Ue;const qe=useNuxtApp(),Ct=(null==(Ue=useRouter().options)?void 0:Ue.scrollBehaviorType)??"auto";let Ot=Oe||void 0;const Jt="function"==typeof Re.meta.scrollToTop?Re.meta.scrollToTop(Re,Le):Re.meta.scrollToTop;if(!Ot&&Le&&Re&&!1!==Jt&&function(Re,Le){if(Re===Le||Le===YT)return!1;if(generateRouteKey(Re)!==generateRouteKey(Le))return!0;const Oe=Re.matched.every(((Re,Oe)=>{var Ue,qe;return Re.components&&Re.components.default===(null==(qe=null==(Ue=Le.matched[Oe])?void 0:Ue.components)?void 0:qe.default)}));return!Oe}(Re,Le)&&(Ot={left:0,top:0}),Re.path===Le.path)return Le.hash&&!Re.hash?{left:0,top:0}:!!Re.hash&&{el:Re.hash,top:_getHashElementScrollMarginTop(Re.hash),behavior:Ct};const hasTransition=Re=>!!(Re.meta.pageTransition??_S),Hr=hasTransition(Le)&&hasTransition(Re)?"page:transition:finish":"page:finish";return new Promise((Le=>{qe.hooks.hookOnce(Hr,(async()=>{await new Promise((Re=>setTimeout(Re,0))),Re.hash&&(Ot={el:Re.hash,top:_getHashElementScrollMarginTop(Re.hash),behavior:Ct}),Le(Ot)}))}))}};function _getHashElementScrollMarginTop(Re){try{const Le=(void 0).querySelector(Re);if(Le)return(Number.parseFloat(getComputedStyle(Le).scrollMarginTop)||0)+(Number.parseFloat(getComputedStyle((void 0).documentElement).scrollPaddingTop)||0)}catch{}return 0}const KS={hashMode:!1,scrollBehaviorType:"auto",...YS},JS=defineNuxtRouteMiddleware((async Re=>{var Le;let Oe,Ue;if(!(null==(Le=Re.meta)?void 0:Le.validate))return;const qe=useNuxtApp(),Ct=useRouter(),Ot=([Oe,Ue]=executeAsync((()=>Promise.resolve(Re.meta.validate(Re)))),Oe=await Oe,Ue(),Oe);if(!0===Ot)return;const Jt=createError({statusCode:Ot&&Ot.statusCode||404,statusMessage:Ot&&Ot.statusMessage||`Page Not Found: ${Re.fullPath}`,data:{path:Re.fullPath}}),Hr=Ct.beforeResolve((Le=>{if(Hr(),Le===Re){const Re=Ct.afterEach((async()=>{Re(),await qe.runWithContext((()=>showError(Jt)))}));return!1}}))})),QS=[JS,defineNuxtRouteMiddleware((async Re=>{}))],eE={},tE=defineNuxtPlugin({name:"nuxt:router",enforce:"pre",async setup(Re){var Le,Oe,Ue;let qe,Ct,Ot=useRuntimeConfig().app.baseURL;KS.hashMode&&!Ot.includes("#")&&(Ot+="#");const Jt=(null==(Le=KS.history)?void 0:Le.call(KS,Ot))??createMemoryHistory(Ot),Hr=KS.routes?([qe,Ct]=executeAsync((()=>KS.routes(XS))),qe=await qe,Ct(),qe??XS):XS;let Jr;const Ln=createRouter({...KS,scrollBehavior:(Re,Le,Oe)=>{if(Le!==YT){if(KS.scrollBehavior){if(Ln.options.scrollBehavior=KS.scrollBehavior,"scrollRestoration"in(void 0).history){const Re=Ln.beforeEach((()=>{Re(),(void 0).history.scrollRestoration="manual"}))}return KS.scrollBehavior(Re,YT,Jr||Oe)}}else Jr=Oe},history:Jt,routes:Hr});Re.vueApp.use(Ln);const Nn=shallowRef(Ln.currentRoute.value);Ln.afterEach(((Re,Le)=>{Nn.value=Le})),Object.defineProperty(Re.vueApp.config.globalProperties,"previousRoute",{get:()=>Nn.value});const $n=Re.ssrContext.url,Gn=shallowRef(Ln.currentRoute.value),syncCurrentRoute=()=>{Gn.value=Ln.currentRoute.value};Re.hook("page:finish",syncCurrentRoute),Ln.afterEach(((Re,Le)=>{var Oe,Ue,qe,Ct;(null==(Ue=null==(Oe=Re.matched[0])?void 0:Oe.components)?void 0:Ue.default)===(null==(Ct=null==(qe=Le.matched[0])?void 0:qe.components)?void 0:Ct.default)&&syncCurrentRoute()}));const qn={};for(const Re in Gn.value)Object.defineProperty(qn,Re,{get:()=>Gn.value[Re],enumerable:!0});Re._route=shallowReactive(qn),Re._middleware=Re._middleware||{global:[],named:{}},useError(),(null==(Oe=Re.ssrContext)?void 0:Oe.islandContext)||Ln.afterEach((async(Le,Oe,Ue)=>{delete Re._processingMiddleware,Ue&&await Re.callHook("page:loading:end"),4!==(null==Ue?void 0:Ue.type)&&(0===Le.matched.length?await Re.runWithContext((()=>showError(createError$2({statusCode:404,fatal:!1,statusMessage:`Page not found: ${Le.fullPath}`,data:{path:Le.fullPath}})))):Le.redirectedFrom&&Le.fullPath!==$n&&await Re.runWithContext((()=>navigateTo(Le.fullPath||"/"))))}));try{[qe,Ct]=executeAsync((()=>Ln.push($n))),await qe,Ct(),[qe,Ct]=executeAsync((()=>Ln.isReady())),await qe,Ct()}catch(Le){[qe,Ct]=executeAsync((()=>Re.runWithContext((()=>showError(Le))))),await qe,Ct()}const Zn=Ln.currentRoute.value;if(syncCurrentRoute(),null==(Ue=Re.ssrContext)?void 0:Ue.islandContext)return{provide:{router:Ln}};const Xn=Re.payload.state._layout;return Ln.beforeEach((async(Le,Oe)=>{var Ue,qe;if(await Re.callHook("page:loading:start"),Le.meta=reactive(Le.meta),Re.isHydrating&&Xn&&!isReadonly(Le.meta.layout)&&(Le.meta.layout=Xn),Re._processingMiddleware=!0,!(null==(Ue=Re.ssrContext)?void 0:Ue.islandContext)){const Ue=new Set([...QS,...Re._middleware.global]);for(const Re of Le.matched){const Le=Re.meta.middleware;if(Le)for(const Re of toArray(Le))Ue.add(Re)}{const Oe=await Re.runWithContext((()=>async function(Re){{const Le=toRouteMatcher(createRouter$2({routes:useRuntimeConfig().nitro.routeRules}));return Ql({},...Le.matchAll(Re).reverse())}}(Le.path)));if(Oe.appMiddleware)for(const Re in Oe.appMiddleware)Oe.appMiddleware[Re]?Ue.add(Re):Ue.delete(Re)}for(const Ct of Ue){const Ue="string"==typeof Ct?Re._middleware.named[Ct]||await(null==(qe=eE[Ct])?void 0:qe.call(eE).then((Re=>Re.default||Re))):Ct;if(!Ue)throw new Error(`Unknown route middleware: '${Ct}'.`);const Ot=await Re.runWithContext((()=>Ue(Le,Oe)));if(!1===Ot||Ot instanceof Error){const Le=Ot||createError$2({statusCode:404,statusMessage:`Page Not Found: ${$n}`});return await Re.runWithContext((()=>showError(Le))),!1}if(!0!==Ot&&(Ot||!1===Ot))return Ot}}})),Ln.onError((async()=>{delete Re._processingMiddleware,await Re.callHook("page:loading:end")})),Re.hooks.hookOnce("app:created",(async()=>{try{"name"in Zn&&(Zn.name=void 0),await Ln.replace({...Zn,force:!0}),Ln.options.scrollBehavior=KS.scrollBehavior}catch(Le){await Re.runWithContext((()=>showError(Le)))}})),{provide:{router:Ln}}}});function definePayloadReducer(Re,Le){useNuxtApp().ssrContext._payloadReducers[Re]=Le}const rE=[["NuxtError",Re=>(Re=>!!Re&&"object"==typeof Re&&$S in Re)(Re)&&Re.toJSON()],["EmptyShallowRef",Re=>isRef(Re)&&isShallow(Re)&&!Re.value&&("bigint"==typeof Re.value?"0n":JSON.stringify(Re.value)||"_")],["EmptyRef",Re=>isRef(Re)&&!Re.value&&("bigint"==typeof Re.value?"0n":JSON.stringify(Re.value)||"_")],["ShallowRef",Re=>isRef(Re)&&isShallow(Re)&&Re.value],["ShallowReactive",Re=>isReactive(Re)&&isShallow(Re)&&toRaw(Re)],["Ref",Re=>isRef(Re)&&Re.value],["Reactive",Re=>isReactive(Re)&&toRaw(Re)]],nE=defineNuxtPlugin({name:"nuxt:revive-payload:server",setup(){for(const[Re,Le]of rE)definePayloadReducer(Re,Le)}}),iE=Symbol();var oE,sE;(sE=oE||(oE={})).direct="direct",sE.patchObject="patch object",sE.patchFunction="patch function";function useState(...Re){const Le="string"==typeof Re[Re.length-1]?Re.pop():void 0;"string"!=typeof Re[0]&&Re.unshift(Le);const[Oe,Ue]=Re;if(!Oe||"string"!=typeof Oe)throw new TypeError("[nuxt] [useState] key must be a string: "+Oe);if(void 0!==Ue&&"function"!=typeof Ue)throw new Error("[nuxt] [useState] init must be a function: "+Ue);const qe="$s"+Oe,Ct=useNuxtApp(),Ot=toRef(Ct.payload.state,qe);if(void 0===Ot.value&&Ue){const Re=Ue();if(isRef(Re))return Ct.payload.state[qe]=Re,Re;Ot.value=Re}return Ot}function useRequestEvent(Re=useNuxtApp()){var Le;return null==(Le=Re.ssrContext)?void 0:Le.event}function useRequestHeaders(Re){const Le=useRequestEvent(),Oe=Le?getRequestHeaders(Le):{};if(!Re||!Le)return Oe;const Ue=Object.create(null);for(const Le of Re){const Re=Le.toLowerCase(),qe=Oe[Re];qe&&(Ue[Re]=qe)}return Ue}function useRequestFetch(){var Re;return(null==(Re=useRequestEvent())?void 0:Re.$fetch)||globalThis.$fetch}const aE={path:"/",watch:!0,decode:Re=>destr(decodeURIComponent(Re)),encode:Re=>encodeURIComponent("string"==typeof Re?Re:JSON.stringify(Re))};function useCookie(Re,Le){var Oe;const Ue={...aE,...Le};Ue.filter??(Ue.filter=Le=>Le===Re);const qe=function(Re={}){return parse$1(getRequestHeader(useRequestEvent(),"cookie")||"",Re)}(Ue)||{};let Ct;void 0!==Ue.maxAge?Ct=1e3*Ue.maxAge:Ue.expires&&(Ct=Ue.expires.getTime()-Date.now());const Ot=ref(klona(void 0!==Ct&&Ct<=0?void 0:qe[Re]??(null==(Oe=Ue.default)?void 0:Oe.call(Ue))));{const Le=useNuxtApp(),writeFinalCookieValue=()=>{Ue.readonly||isEqual$1(Ot.value,qe[Re])||(Le._cookies||(Le._cookies={}),Re in Le._cookies&&isEqual$1(Ot.value,Le._cookies[Re])||(Le._cookies[Re]=Ot.value,function(Re,Le,Oe,Ue={}){if(Re){if(null!=Oe)return setCookie(Re,Le,Oe,Ue);if(void 0!==getCookie(Re,Le))(function(Re,Le,Oe){setCookie(Re,Le,"",{...Oe,maxAge:0})})(Re,Le,Ue)}}(useRequestEvent(Le),Re,Ot.value,Ue)))},Oe=Le.hooks.hookOnce("app:rendered",writeFinalCookieValue);Le.hooks.hookOnce("app:error",(()=>(Oe(),writeFinalCookieValue())))}return Ot}const lE=oc({title:"My Travel App"},{nuxt:{},_MAPBOX_CONFIG:{accessToken:"{pk.eyJ1IjoiYXJuYXVkc3dlZW4iLCJhIjoiY20yZWZlYmRsMWtvbDJqcXhnc2QxZzBrYyJ9.Fb5BoKHGFCI8TJlLOookNQ}"}});function useAppConfig(){const Re=useNuxtApp();return Re._appConfig||(Re._appConfig=klona(lE)),Re._appConfig}const cE=defineNuxtPlugin({name:"pinia",setup(Re){const Le=function(){const Re=effectScope(!0),Le=Re.run((()=>ref({})));let Oe=[],Ue=[];const qe=markRaw({install(Re){qe._a=Re,Re.provide(iE,qe),Re.config.globalProperties.$pinia=qe,Ue.forEach((Re=>Oe.push(Re))),Ue=[]},use(Re){return this._a?Oe.push(Re):Ue.push(Re),this},_p:Oe,_a:null,_e:Re,_s:new Map,state:Le});return qe}();return Re.vueApp.use(Le),Re.payload.pinia=Le.state.value,{provide:{pinia:Le}}}}),uE=[["Icon",defineAsyncComponent((()=>Promise.resolve().then((function(){return mk})).then((Re=>Re.default||Re.default||Re))))],["IconCSS",defineAsyncComponent((()=>Promise.resolve().then((function(){return vk})).then((Re=>Re.default||Re.default||Re))))]],hE=defineNuxtPlugin({name:"nuxt:global-components",setup(Re){for(const[Le,Oe]of uE)Re.vueApp.component(Le,Oe),Re.vueApp.component("Lazy"+Le,Oe)}}),getCookieIds=Re=>Re.map((Re=>Re.id)),dE=defineNuxtPlugin((Re=>{var Le;const Oe=useRuntimeConfig().public.cookieControl,Ue=useCookie(Oe.cookieNameIsConsentGiven,Oe.cookieOptions),qe=null==(Le=useCookie(Oe.cookieNameCookiesEnabledIds,Oe.cookieOptions).value)?void 0:Le.split("~"),Ct=ref(void 0===Ue.value?void 0:Ue.value===(Re=>getCookieIds([...Re.cookies.necessary,...Re.cookies.optional]).join(""))(Oe));return{provide:{cookies:{cookiesEnabled:ref(void 0===qe?void 0:[...Oe.cookies.necessary.filter((Re=>qe.includes(Re.id))),...Oe.cookies.optional.filter((Re=>qe.includes(Re.id)))]),cookiesEnabledIds:ref(qe),isConsentGiven:Ct,isModalActive:ref(),locale:ref(),moduleOptions:Oe}}}})),makeSymbol=(Re,Le=!1)=>Le?Symbol.for(Re):Symbol(Re),friendlyJSONstringify=Re=>JSON.stringify(Re).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029").replace(/\u0027/g,"\\u0027"),isNumber=Re=>"number"==typeof Re&&isFinite(Re),isRegExp=Re=>"[object RegExp]"===toTypeString(Re),isEmptyObject=Re=>isPlainObject(Re)&&0===Object.keys(Re).length,pE=Object.assign;function escapeHtml(Re){return Re.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}const fE=Object.prototype.hasOwnProperty;function hasOwn(Re,Le){return fE.call(Re,Le)}const mE=Array.isArray,isFunction=Re=>"function"==typeof Re,isString=Re=>"string"==typeof Re,isBoolean=Re=>"boolean"==typeof Re,isObject$3=Re=>null!==Re&&"object"==typeof Re,gE=Object.prototype.toString,toTypeString=Re=>gE.call(Re),isPlainObject=Re=>{if(!isObject$3(Re))return!1;const Le=Object.getPrototypeOf(Re);return null===Le||Le.constructor===Object};function join(Re,Le=""){return Re.reduce(((Re,Oe,Ue)=>0===Ue?Re+Oe:Re+Le+Oe),"")}function incrementer(Re){let Le=Re;return()=>++Le}function warn(Re,Le){"undefined"!=typeof console&&(console.warn("[intlify] "+Re),Le&&console.warn(Le.stack))}const isNotObjectOrIsArray=Re=>!isObject$3(Re)||mE(Re);function deepCopy(Re,Le){if(isNotObjectOrIsArray(Re)||isNotObjectOrIsArray(Le))throw new Error("Invalid value");const Oe=[{src:Re,des:Le}];for(;Oe.length;){const{src:Re,des:Le}=Oe.pop();Object.keys(Re).forEach((Ue=>{isObject$3(Re[Ue])&&!isObject$3(Le[Ue])&&(Le[Ue]=Array.isArray(Re[Ue])?[]:{}),isNotObjectOrIsArray(Le[Ue])||isNotObjectOrIsArray(Re[Ue])?Le[Ue]=Re[Ue]:Oe.push({src:Re[Ue],des:Le[Ue]})}))}}function createLocation(Re,Le,Oe){return{start:Re,end:Le}}const _E=1,yE=2;const vE=1,xE=2,bE=3,wE=4,TE=5,SE=6,EE=7,CE=8,AE=9,IE=10,kE=11,ME=12,PE=13,RE=14,LE=17;function createCompileError(Re,Le,Oe={}){const{domain:Ue,messages:qe,args:Ct}=Oe,Ot=new SyntaxError(String(Re));return Ot.code=Re,Le&&(Ot.location=Le),Ot.domain=Ue,Ot}function defaultOnError(Re){throw Re}const OE=" ",zE="\n",DE=String.fromCharCode(8232),BE=String.fromCharCode(8233);function createScanner(Re){const Le=Re;let Oe=0,Ue=1,qe=1,Ct=0;const isCRLF=Re=>"\r"===Le[Re]&&Le[Re+1]===zE,isPS=Re=>Le[Re]===BE,isLS=Re=>Le[Re]===DE,isLineEnd=Re=>isCRLF(Re)||(Re=>Le[Re]===zE)(Re)||isPS(Re)||isLS(Re),charAt=Re=>isCRLF(Re)||isPS(Re)||isLS(Re)?zE:Le[Re];function next(){return Ct=0,isLineEnd(Oe)&&(Ue++,qe=0),isCRLF(Oe)&&Oe++,Oe++,qe++,Le[Oe]}return{index:()=>Oe,line:()=>Ue,column:()=>qe,peekOffset:()=>Ct,charAt:charAt,currentChar:()=>charAt(Oe),currentPeek:()=>charAt(Oe+Ct),next:next,peek:function(){return isCRLF(Oe+Ct)&&Ct++,Ct++,Le[Oe+Ct]},reset:function(){Oe=0,Ue=1,qe=1,Ct=0},resetPeek:function(Re=0){Ct=Re},skipToPeek:function(){const Re=Oe+Ct;for(;Re!==Oe;)next();Ct=0}}}const FE=void 0;function createTokenizer(Re,Le={}){const Oe=!1!==Le.location,Ue=createScanner(Re),currentOffset=()=>Ue.index(),currentPosition=()=>{return Re=Ue.line(),Le=Ue.column(),Oe=Ue.index(),{line:Re,column:Le,offset:Oe};var Re,Le,Oe},qe=currentPosition(),Ct=currentOffset(),Ot={currentType:14,offset:Ct,startLoc:qe,endLoc:qe,lastType:14,lastOffset:Ct,lastStartLoc:qe,lastEndLoc:qe,braceNest:0,inLinked:!1,text:""},context=()=>Ot,{onError:Jt}=Le;function emitError(Re,Le,Ue,...qe){const Ct=context();if(Le.column+=Ue,Le.offset+=Ue,Jt){const Ue=createCompileError(Re,Oe?createLocation(Ct.startLoc,Le):null,{domain:"tokenizer",args:qe});Jt(Ue)}}function getToken(Re,Le,Ue){Re.endLoc=currentPosition(),Re.currentType=Le;const qe={type:Le};return Oe&&(qe.loc=createLocation(Re.startLoc,Re.endLoc)),null!=Ue&&(qe.value=Ue),qe}const getEndToken=Re=>getToken(Re,14);function eat(Re,Le){return Re.currentChar()===Le?(Re.next(),Le):(emitError(vE,currentPosition(),0,Le),"")}function peekSpaces(Re){let Le="";for(;Re.currentPeek()===OE||Re.currentPeek()===zE;)Le+=Re.currentPeek(),Re.peek();return Le}function skipSpaces(Re){const Le=peekSpaces(Re);return Re.skipToPeek(),Le}function isIdentifierStart(Re){if(Re===FE)return!1;const Le=Re.charCodeAt(0);return Le>=97&&Le<=122||Le>=65&&Le<=90||95===Le}function isListIdentifierStart(Re,Le){const{currentType:Oe}=Le;if(2!==Oe)return!1;peekSpaces(Re);const Ue=function(Re){if(Re===FE)return!1;const Le=Re.charCodeAt(0);return Le>=48&&Le<=57}("-"===Re.currentPeek()?Re.peek():Re.currentPeek());return Re.resetPeek(),Ue}function isPluralStart(Re){peekSpaces(Re);const Le="|"===Re.currentPeek();return Re.resetPeek(),Le}function isTextStart(Re,Le=!0){const fn=(Le=!1,Oe="",Ue=!1)=>{const qe=Re.currentPeek();return"{"===qe?"%"!==Oe&&Le:"@"!==qe&&qe?"%"===qe?(Re.peek(),fn(Le,"%",!0)):"|"===qe?!("%"!==Oe&&!Ue)||!(Oe===OE||Oe===zE):qe===OE?(Re.peek(),fn(!0,OE,Ue)):qe!==zE||(Re.peek(),fn(!0,zE,Ue)):"%"===Oe||Le},Oe=fn();return Le&&Re.resetPeek(),Oe}function takeChar(Re,Le){const Oe=Re.currentChar();return Oe===FE?FE:Le(Oe)?(Re.next(),Oe):null}function isIdentifier(Re){const Le=Re.charCodeAt(0);return Le>=97&&Le<=122||Le>=65&&Le<=90||Le>=48&&Le<=57||95===Le||36===Le}function takeIdentifierChar(Re){return takeChar(Re,isIdentifier)}function isNamedIdentifier(Re){const Le=Re.charCodeAt(0);return Le>=97&&Le<=122||Le>=65&&Le<=90||Le>=48&&Le<=57||95===Le||36===Le||45===Le}function takeNamedIdentifierChar(Re){return takeChar(Re,isNamedIdentifier)}function isDigit(Re){const Le=Re.charCodeAt(0);return Le>=48&&Le<=57}function takeDigit(Re){return takeChar(Re,isDigit)}function isHexDigit(Re){const Le=Re.charCodeAt(0);return Le>=48&&Le<=57||Le>=65&&Le<=70||Le>=97&&Le<=102}function takeHexDigit(Re){return takeChar(Re,isHexDigit)}function getDigits(Re){let Le="",Oe="";for(;Le=takeDigit(Re);)Oe+=Le;return Oe}function readText(Re){let Le="";for(;;){const Oe=Re.currentChar();if("{"===Oe||"}"===Oe||"@"===Oe||"|"===Oe||!Oe)break;if("%"===Oe){if(!isTextStart(Re))break;Le+=Oe,Re.next()}else if(Oe===OE||Oe===zE)if(isTextStart(Re))Le+=Oe,Re.next();else{if(isPluralStart(Re))break;Le+=Oe,Re.next()}else Le+=Oe,Re.next()}return Le}function isLiteral2(Re){return"'"!==Re&&Re!==zE}function readEscapeSequence(Re){const Le=Re.currentChar();switch(Le){case"\\":case"'":return Re.next(),`\\${Le}`;case"u":return readUnicodeEscapeSequence(Re,Le,4);case"U":return readUnicodeEscapeSequence(Re,Le,6);default:return emitError(wE,currentPosition(),0,Le),""}}function readUnicodeEscapeSequence(Re,Le,Oe){eat(Re,Le);let Ue="";for(let qe=0;qe<Oe;qe++){const Oe=takeHexDigit(Re);if(!Oe){emitError(TE,currentPosition(),0,`\\${Le}${Ue}${Re.currentChar()}`);break}Ue+=Oe}return`\\${Le}${Ue}`}function isInvalidIdentifier(Re){return"{"!==Re&&"}"!==Re&&Re!==OE&&Re!==zE}function readPlural(Re){skipSpaces(Re);const Le=eat(Re,"|");return skipSpaces(Re),Le}function readTokenInPlaceholder(Re,Le){let Oe=null;switch(Re.currentChar()){case"{":return Le.braceNest>=1&&emitError(AE,currentPosition(),0),Re.next(),Oe=getToken(Le,2,"{"),skipSpaces(Re),Le.braceNest++,Oe;case"}":return Le.braceNest>0&&2===Le.currentType&&emitError(CE,currentPosition(),0),Re.next(),Oe=getToken(Le,3,"}"),Le.braceNest--,Le.braceNest>0&&skipSpaces(Re),Le.inLinked&&0===Le.braceNest&&(Le.inLinked=!1),Oe;case"@":return Le.braceNest>0&&emitError(EE,currentPosition(),0),Oe=readTokenInLinked(Re,Le)||getEndToken(Le),Le.braceNest=0,Oe;default:{let Ue=!0,qe=!0,Ct=!0;if(isPluralStart(Re))return Le.braceNest>0&&emitError(EE,currentPosition(),0),Oe=getToken(Le,1,readPlural(Re)),Le.braceNest=0,Le.inLinked=!1,Oe;if(Le.braceNest>0&&(5===Le.currentType||6===Le.currentType||7===Le.currentType))return emitError(EE,currentPosition(),0),Le.braceNest=0,readToken(Re,Le);if(Ue=function(Re,Le){const{currentType:Oe}=Le;if(2!==Oe)return!1;peekSpaces(Re);const Ue=isIdentifierStart(Re.currentPeek());return Re.resetPeek(),Ue}(Re,Le))return Oe=getToken(Le,5,function(Re){skipSpaces(Re);let Le="",Oe="";for(;Le=takeNamedIdentifierChar(Re);)Oe+=Le;return Re.currentChar()===FE&&emitError(EE,currentPosition(),0),Oe}(Re)),skipSpaces(Re),Oe;if(qe=isListIdentifierStart(Re,Le))return Oe=getToken(Le,6,function(Re){skipSpaces(Re);let Le="";return"-"===Re.currentChar()?(Re.next(),Le+=`-${getDigits(Re)}`):Le+=getDigits(Re),Re.currentChar()===FE&&emitError(EE,currentPosition(),0),Le}(Re)),skipSpaces(Re),Oe;if(Ct=function(Re,Le){const{currentType:Oe}=Le;if(2!==Oe)return!1;peekSpaces(Re);const Ue="'"===Re.currentPeek();return Re.resetPeek(),Ue}(Re,Le))return Oe=getToken(Le,7,function(Re){skipSpaces(Re),eat(Re,"'");let Le="",Oe="";for(;Le=takeChar(Re,isLiteral2);)Oe+="\\"===Le?readEscapeSequence(Re):Le;const Ue=Re.currentChar();return Ue===zE||Ue===FE?(emitError(bE,currentPosition(),0),Ue===zE&&(Re.next(),eat(Re,"'")),Oe):(eat(Re,"'"),Oe)}(Re)),skipSpaces(Re),Oe;if(!Ue&&!qe&&!Ct)return Oe=getToken(Le,13,function(Re){skipSpaces(Re);let Le="",Oe="";for(;Le=takeChar(Re,isInvalidIdentifier);)Oe+=Le;return Oe}(Re)),emitError(xE,currentPosition(),0,Oe.value),skipSpaces(Re),Oe;break}}return Oe}function readTokenInLinked(Re,Le){const{currentType:Oe}=Le;let Ue=null;const qe=Re.currentChar();switch(8!==Oe&&9!==Oe&&12!==Oe&&10!==Oe||qe!==zE&&qe!==OE||emitError(IE,currentPosition(),0),qe){case"@":return Re.next(),Ue=getToken(Le,8,"@"),Le.inLinked=!0,Ue;case".":return skipSpaces(Re),Re.next(),getToken(Le,9,".");case":":return skipSpaces(Re),Re.next(),getToken(Le,10,":");default:return isPluralStart(Re)?(Ue=getToken(Le,1,readPlural(Re)),Le.braceNest=0,Le.inLinked=!1,Ue):function(Re,Le){const{currentType:Oe}=Le;if(8!==Oe)return!1;peekSpaces(Re);const Ue="."===Re.currentPeek();return Re.resetPeek(),Ue}(Re,Le)||function(Re,Le){const{currentType:Oe}=Le;if(8!==Oe&&12!==Oe)return!1;peekSpaces(Re);const Ue=":"===Re.currentPeek();return Re.resetPeek(),Ue}(Re,Le)?(skipSpaces(Re),readTokenInLinked(Re,Le)):function(Re,Le){const{currentType:Oe}=Le;if(9!==Oe)return!1;peekSpaces(Re);const Ue=isIdentifierStart(Re.currentPeek());return Re.resetPeek(),Ue}(Re,Le)?(skipSpaces(Re),getToken(Le,12,function(Re){let Le="",Oe="";for(;Le=takeIdentifierChar(Re);)Oe+=Le;return Oe}(Re))):function(Re,Le){const{currentType:Oe}=Le;if(10!==Oe)return!1;const fn=()=>{const Le=Re.currentPeek();return"{"===Le?isIdentifierStart(Re.peek()):!("@"===Le||"%"===Le||"|"===Le||":"===Le||"."===Le||Le===OE||!Le)&&(Le===zE?(Re.peek(),fn()):isTextStart(Re,!1))},Ue=fn();return Re.resetPeek(),Ue}(Re,Le)?(skipSpaces(Re),"{"===qe?readTokenInPlaceholder(Re,Le)||Ue:getToken(Le,11,function(Re){const fn=Le=>{const Oe=Re.currentChar();return"{"!==Oe&&"%"!==Oe&&"@"!==Oe&&"|"!==Oe&&"("!==Oe&&")"!==Oe&&Oe?Oe===OE?Le:(Le+=Oe,Re.next(),fn(Le)):Le};return fn("")}(Re))):(8===Oe&&emitError(IE,currentPosition(),0),Le.braceNest=0,Le.inLinked=!1,readToken(Re,Le))}}function readToken(Re,Le){let Oe={type:14};if(Le.braceNest>0)return readTokenInPlaceholder(Re,Le)||getEndToken(Le);if(Le.inLinked)return readTokenInLinked(Re,Le)||getEndToken(Le);switch(Re.currentChar()){case"{":return readTokenInPlaceholder(Re,Le)||getEndToken(Le);case"}":return emitError(SE,currentPosition(),0),Re.next(),getToken(Le,3,"}");case"@":return readTokenInLinked(Re,Le)||getEndToken(Le);default:{if(isPluralStart(Re))return Oe=getToken(Le,1,readPlural(Re)),Le.braceNest=0,Le.inLinked=!1,Oe;const{isModulo:Ue,hasSpace:qe}=function(Re){const Le=peekSpaces(Re),Oe="%"===Re.currentPeek()&&"{"===Re.peek();return Re.resetPeek(),{isModulo:Oe,hasSpace:Le.length>0}}(Re);if(Ue)return qe?getToken(Le,0,readText(Re)):getToken(Le,4,function(Re){skipSpaces(Re);const Le=Re.currentChar();return"%"!==Le&&emitError(vE,currentPosition(),0,Le),Re.next(),"%"}(Re));if(isTextStart(Re))return getToken(Le,0,readText(Re));break}}return Oe}return{nextToken:function(){const{currentType:Re,offset:Le,startLoc:Oe,endLoc:qe}=Ot;return Ot.lastType=Re,Ot.lastOffset=Le,Ot.lastStartLoc=Oe,Ot.lastEndLoc=qe,Ot.offset=currentOffset(),Ot.startLoc=currentPosition(),Ue.currentChar()===FE?getToken(Ot,14):readToken(Ue,Ot)},currentOffset:currentOffset,currentPosition:currentPosition,context:context}}const NE=/(?:\\\\|\\'|\\u([0-9a-fA-F]{4})|\\U([0-9a-fA-F]{6}))/g;function fromEscapeSequence(Re,Le,Oe){switch(Re){case"\\\\":return"\\";case"\\'":return"'";default:{const Re=parseInt(Le||Oe,16);return Re<=55295||Re>=57344?String.fromCodePoint(Re):"�"}}}function createParser(Re={}){const Le=!1!==Re.location,{onError:Oe,onWarn:Ue}=Re;function emitError(Re,Ue,qe,Ct,...Ot){const Jt=Re.currentPosition();if(Jt.offset+=Ct,Jt.column+=Ct,Oe){const Re=createCompileError(Ue,Le?createLocation(qe,Jt):null,{domain:"parser",args:Ot});Oe(Re)}}function emitWarn(Re,Oe,qe,Ct,...Ot){const Jt=Re.currentPosition();if(Jt.offset+=Ct,Jt.column+=Ct,Ue){const Re=Le?createLocation(qe,Jt):null;Ue(function(Re,Le){const Oe={message:String(Re),code:Re};return Le&&(Oe.location=Le),Oe}(Oe,Re))}}function startNode(Re,Oe,Ue){const qe={type:Re};return Le&&(qe.start=Oe,qe.end=Oe,qe.loc={start:Ue,end:Ue}),qe}function endNode(Re,Oe,Ue,qe){Le&&(Re.end=Oe,Re.loc&&(Re.loc.end=Ue))}function parseText(Re,Le){const Oe=Re.context(),Ue=startNode(3,Oe.offset,Oe.startLoc);return Ue.value=Le,endNode(Ue,Re.currentOffset(),Re.currentPosition()),Ue}function parseList(Re,Le){const Oe=Re.context(),{lastOffset:Ue,lastStartLoc:qe}=Oe,Ct=startNode(5,Ue,qe);return Ct.index=parseInt(Le,10),Re.nextToken(),endNode(Ct,Re.currentOffset(),Re.currentPosition()),Ct}function parseNamed(Re,Le,Oe){const Ue=Re.context(),{lastOffset:qe,lastStartLoc:Ct}=Ue,Ot=startNode(4,qe,Ct);return Ot.key=Le,!0===Oe&&(Ot.modulo=!0),Re.nextToken(),endNode(Ot,Re.currentOffset(),Re.currentPosition()),Ot}function parseLiteral(Re,Le){const Oe=Re.context(),{lastOffset:Ue,lastStartLoc:qe}=Oe,Ct=startNode(9,Ue,qe);return Ct.value=Le.replace(NE,fromEscapeSequence),Re.nextToken(),endNode(Ct,Re.currentOffset(),Re.currentPosition()),Ct}function parseLinked(Re){const Le=Re.context(),Oe=startNode(6,Le.offset,Le.startLoc);let Ue=Re.nextToken();if(9===Ue.type){const Le=function(Re){const Le=Re.nextToken(),Oe=Re.context(),{lastOffset:Ue,lastStartLoc:qe}=Oe,Ct=startNode(8,Ue,qe);return 12!==Le.type?(emitError(Re,ME,Oe.lastStartLoc,0),Ct.value="",endNode(Ct,Ue,qe),{nextConsumeToken:Le,node:Ct}):(null==Le.value&&emitError(Re,RE,Oe.lastStartLoc,0,getTokenCaption(Le)),Ct.value=Le.value||"",endNode(Ct,Re.currentOffset(),Re.currentPosition()),{node:Ct})}(Re);Oe.modifier=Le.node,Ue=Le.nextConsumeToken||Re.nextToken()}switch(10!==Ue.type&&emitError(Re,RE,Le.lastStartLoc,0,getTokenCaption(Ue)),Ue=Re.nextToken(),2===Ue.type&&(Ue=Re.nextToken()),Ue.type){case 11:null==Ue.value&&emitError(Re,RE,Le.lastStartLoc,0,getTokenCaption(Ue)),Oe.key=function(Re,Le){const Oe=Re.context(),Ue=startNode(7,Oe.offset,Oe.startLoc);return Ue.value=Le,endNode(Ue,Re.currentOffset(),Re.currentPosition()),Ue}(Re,Ue.value||"");break;case 5:null==Ue.value&&emitError(Re,RE,Le.lastStartLoc,0,getTokenCaption(Ue)),Oe.key=parseNamed(Re,Ue.value||"");break;case 6:null==Ue.value&&emitError(Re,RE,Le.lastStartLoc,0,getTokenCaption(Ue)),Oe.key=parseList(Re,Ue.value||"");break;case 7:null==Ue.value&&emitError(Re,RE,Le.lastStartLoc,0,getTokenCaption(Ue)),Oe.key=parseLiteral(Re,Ue.value||"");break;default:{emitError(Re,PE,Le.lastStartLoc,0);const qe=Re.context(),Ct=startNode(7,qe.offset,qe.startLoc);return Ct.value="",endNode(Ct,qe.offset,qe.startLoc),Oe.key=Ct,endNode(Oe,qe.offset,qe.startLoc),{nextConsumeToken:Ue,node:Oe}}}return endNode(Oe,Re.currentOffset(),Re.currentPosition()),{node:Oe}}function parseMessage(Re){const Le=Re.context(),Oe=startNode(2,1===Le.currentType?Re.currentOffset():Le.offset,1===Le.currentType?Le.endLoc:Le.startLoc);Oe.items=[];let Ue=null,qe=null;do{const Ct=Ue||Re.nextToken();switch(Ue=null,Ct.type){case 0:null==Ct.value&&emitError(Re,RE,Le.lastStartLoc,0,getTokenCaption(Ct)),Oe.items.push(parseText(Re,Ct.value||""));break;case 6:null==Ct.value&&emitError(Re,RE,Le.lastStartLoc,0,getTokenCaption(Ct)),Oe.items.push(parseList(Re,Ct.value||""));break;case 4:qe=!0;break;case 5:null==Ct.value&&emitError(Re,RE,Le.lastStartLoc,0,getTokenCaption(Ct)),Oe.items.push(parseNamed(Re,Ct.value||"",!!qe)),qe&&(emitWarn(Re,_E,Le.lastStartLoc,0,getTokenCaption(Ct)),qe=null);break;case 7:null==Ct.value&&emitError(Re,RE,Le.lastStartLoc,0,getTokenCaption(Ct)),Oe.items.push(parseLiteral(Re,Ct.value||""));break;case 8:{const Le=parseLinked(Re);Oe.items.push(Le.node),Ue=Le.nextConsumeToken||null;break}}}while(14!==Le.currentType&&1!==Le.currentType);return endNode(Oe,1===Le.currentType?Le.lastOffset:Re.currentOffset(),1===Le.currentType?Le.lastEndLoc:Re.currentPosition()),Oe}function parseResource(Re){const Le=Re.context(),{offset:Oe,startLoc:Ue}=Le,qe=parseMessage(Re);return 14===Le.currentType?qe:function(Re,Le,Oe,Ue){const qe=Re.context();let Ct=0===Ue.items.length;const Ot=startNode(1,Le,Oe);Ot.cases=[],Ot.cases.push(Ue);do{const Le=parseMessage(Re);Ct||(Ct=0===Le.items.length),Ot.cases.push(Le)}while(14!==qe.currentType);return Ct&&emitError(Re,kE,Oe,0),endNode(Ot,Re.currentOffset(),Re.currentPosition()),Ot}(Re,Oe,Ue,qe)}return{parse:function(Oe){const Ue=createTokenizer(Oe,pE({},Re)),qe=Ue.context(),Ct=startNode(0,qe.offset,qe.startLoc);return Le&&Ct.loc&&(Ct.loc.source=Oe),Ct.body=parseResource(Ue),Re.onCacheKey&&(Ct.cacheKey=Re.onCacheKey(Oe)),14!==qe.currentType&&emitError(Ue,RE,qe.lastStartLoc,0,Oe[qe.offset]||""),endNode(Ct,Ue.currentOffset(),Ue.currentPosition()),Ct}}}function getTokenCaption(Re){if(14===Re.type)return"EOF";const Le=(Re.value||"").replace(/\r?\n/gu,"\\n");return Le.length>10?Le.slice(0,9)+"…":Le}function traverseNodes(Re,Le){for(let Oe=0;Oe<Re.length;Oe++)traverseNode(Re[Oe],Le)}function traverseNode(Re,Le){switch(Re.type){case 1:traverseNodes(Re.cases,Le),Le.helper("plural");break;case 2:traverseNodes(Re.items,Le);break;case 6:traverseNode(Re.key,Le),Le.helper("linked"),Le.helper("type");break;case 5:Le.helper("interpolate"),Le.helper("list");break;case 4:Le.helper("interpolate"),Le.helper("named")}}function transform(Re,Le={}){const Oe=function(Re){const Le={ast:Re,helpers:new Set};return{context:()=>Le,helper:Re=>(Le.helpers.add(Re),Re)}}(Re);Oe.helper("normalize"),Re.body&&traverseNode(Re.body,Oe);const Ue=Oe.context();Re.helpers=Array.from(Ue.helpers)}function optimizeMessageNode(Re){if(1===Re.items.length){const Le=Re.items[0];3!==Le.type&&9!==Le.type||(Re.static=Le.value,delete Le.value)}else{const Le=[];for(let Oe=0;Oe<Re.items.length;Oe++){const Ue=Re.items[Oe];if(3!==Ue.type&&9!==Ue.type)break;if(null==Ue.value)break;Le.push(Ue.value)}if(Le.length===Re.items.length){Re.static=join(Le);for(let Le=0;Le<Re.items.length;Le++){const Oe=Re.items[Le];3!==Oe.type&&9!==Oe.type||delete Oe.value}}}}function minify(Re){switch(Re.t=Re.type,Re.type){case 0:{const Le=Re;minify(Le.body),Le.b=Le.body,delete Le.body;break}case 1:{const Le=Re,Oe=Le.cases;for(let Re=0;Re<Oe.length;Re++)minify(Oe[Re]);Le.c=Oe,delete Le.cases;break}case 2:{const Le=Re,Oe=Le.items;for(let Re=0;Re<Oe.length;Re++)minify(Oe[Re]);Le.i=Oe,delete Le.items,Le.static&&(Le.s=Le.static,delete Le.static);break}case 3:case 9:case 8:case 7:{const Le=Re;Le.value&&(Le.v=Le.value,delete Le.value);break}case 6:{const Le=Re;minify(Le.key),Le.k=Le.key,delete Le.key,Le.modifier&&(minify(Le.modifier),Le.m=Le.modifier,delete Le.modifier);break}case 5:{const Le=Re;Le.i=Le.index,delete Le.index;break}case 4:{const Le=Re;Le.k=Le.key,delete Le.key;break}}delete Re.type}function generateNode(Re,Le){const{helper:Oe}=Re;switch(Le.type){case 0:!function(Re,Le){Le.body?generateNode(Re,Le.body):Re.push("null")}(Re,Le);break;case 1:!function(Re,Le){const{helper:Oe,needIndent:Ue}=Re;if(Le.cases.length>1){Re.push(`${Oe("plural")}([`),Re.indent(Ue());const qe=Le.cases.length;for(let Oe=0;Oe<qe&&(generateNode(Re,Le.cases[Oe]),Oe!==qe-1);Oe++)Re.push(", ");Re.deindent(Ue()),Re.push("])")}}(Re,Le);break;case 2:!function(Re,Le){const{helper:Oe,needIndent:Ue}=Re;Re.push(`${Oe("normalize")}([`),Re.indent(Ue());const qe=Le.items.length;for(let Oe=0;Oe<qe&&(generateNode(Re,Le.items[Oe]),Oe!==qe-1);Oe++)Re.push(", ");Re.deindent(Ue()),Re.push("])")}(Re,Le);break;case 6:!function(Re,Le){const{helper:Oe}=Re;Re.push(`${Oe("linked")}(`),generateNode(Re,Le.key),Le.modifier?(Re.push(", "),generateNode(Re,Le.modifier),Re.push(", _type")):Re.push(", undefined, _type"),Re.push(")")}(Re,Le);break;case 8:case 7:case 9:case 3:Re.push(JSON.stringify(Le.value),Le);break;case 5:Re.push(`${Oe("interpolate")}(${Oe("list")}(${Le.index}))`,Le);break;case 4:Re.push(`${Oe("interpolate")}(${Oe("named")}(${JSON.stringify(Le.key)}))`,Le)}}function baseCompile$1(Re,Le={}){const Oe=pE({},Le),Ue=!!Oe.jit,qe=!!Oe.minify,Ct=null==Oe.optimize||Oe.optimize,Ot=createParser(Oe).parse(Re);return Ue?(Ct&&function(Re){const Le=Re.body;2===Le.type?optimizeMessageNode(Le):Le.cases.forEach((Re=>optimizeMessageNode(Re)))}(Ot),qe&&minify(Ot),{ast:Ot,code:""}):(transform(Ot,Oe),((Re,Le={})=>{const Oe=isString(Le.mode)?Le.mode:"normal",Ue=isString(Le.filename)?Le.filename:"message.intl",qe=!!Le.sourceMap,Ct=null!=Le.breakLineCode?Le.breakLineCode:"arrow"===Oe?";":"\n",Ot=Le.needIndent?Le.needIndent:"arrow"!==Oe,Jt=Re.helpers||[],Hr=function(Re,Le){const{sourceMap:Oe,filename:Ue,breakLineCode:qe,needIndent:Ct}=Le,Ot=!1!==Le.location,Jt={filename:Ue,code:"",column:1,line:1,offset:0,map:void 0,breakLineCode:qe,needIndent:Ct,indentLevel:0};function push(Re,Le){Jt.code+=Re}function _newline(Re,Le=!0){const Oe=Le?qe:"";push(Ct?Oe+"  ".repeat(Re):Oe)}return Ot&&Re.loc&&(Jt.source=Re.loc.source),{context:()=>Jt,push:push,indent:function(Re=!0){const Le=++Jt.indentLevel;Re&&_newline(Le)},deindent:function(Re=!0){const Le=--Jt.indentLevel;Re&&_newline(Le)},newline:function(){_newline(Jt.indentLevel)},helper:Re=>`_${Re}`,needIndent:()=>Jt.needIndent}}(Re,{mode:Oe,filename:Ue,sourceMap:qe,breakLineCode:Ct,needIndent:Ot});Hr.push("normal"===Oe?"function __msg__ (ctx) {":"(ctx) => {"),Hr.indent(Ot),Jt.length>0&&(Hr.push(`const { ${join(Jt.map((Re=>`${Re}: _${Re}`)),", ")} } = ctx`),Hr.newline()),Hr.push("return "),generateNode(Hr,Re),Hr.deindent(Ot),Hr.push("}"),delete Re.helpers;const{code:Jr,map:Ln}=Hr.context();return{ast:Re,code:Jr,map:Ln?Ln.toJSON():void 0}})(Ot,Oe))}const jE=[];jE[0]={w:[0],i:[3,0],"[":[4],o:[7]},jE[1]={w:[1],".":[2],"[":[4],o:[7]},jE[2]={w:[2],i:[3,0],0:[3,0]},jE[3]={i:[3,0],0:[3,0],w:[1,1],".":[2,1],"[":[4,1],o:[7,1]},jE[4]={"'":[5,0],'"':[6,0],"[":[4,2],"]":[1,3],o:8,l:[4,0]},jE[5]={"'":[4,0],o:8,l:[5,0]},jE[6]={'"':[4,0],o:8,l:[6,0]};const UE=/^\s?(?:true|false|-?[\d.]+|'[^']*'|"[^"]*")\s?$/;function getPathCharType(Re){if(null==Re)return"o";switch(Re.charCodeAt(0)){case 91:case 93:case 46:case 34:case 39:return Re;case 95:case 36:case 45:return"i";case 9:case 10:case 13:case 160:case 65279:case 8232:case 8233:return"w"}return"i"}function formatSubPath(Re){const Le=Re.trim();return("0"!==Re.charAt(0)||!isNaN(parseInt(Re)))&&(Oe=Le,UE.test(Oe)?function(Re){const Le=Re.charCodeAt(0);return Le!==Re.charCodeAt(Re.length-1)||34!==Le&&39!==Le?Re:Re.slice(1,-1)}(Le):"*"+Le);var Oe}const VE=new Map;function resolveWithKeyValue(Re,Le){return isObject$3(Re)?Re[Le]:null}const DEFAULT_MODIFIER=Re=>Re,DEFAULT_MESSAGE=Re=>"",DEFAULT_NORMALIZE=Re=>0===Re.length?"":join(Re),DEFAULT_INTERPOLATE=Re=>null==Re?"":mE(Re)||isPlainObject(Re)&&Re.toString===gE?JSON.stringify(Re,null,2):String(Re);function pluralDefault(Re,Le){return Re=Math.abs(Re),2===Le?Re?Re>1?1:0:1:Re?Math.min(Re,2):0}function createMessageContext(Re={}){const Le=Re.locale,Oe=function(Re){const Le=isNumber(Re.pluralIndex)?Re.pluralIndex:-1;return Re.named&&(isNumber(Re.named.count)||isNumber(Re.named.n))?isNumber(Re.named.count)?Re.named.count:isNumber(Re.named.n)?Re.named.n:Le:Le}(Re),Ue=isObject$3(Re.pluralRules)&&isString(Le)&&isFunction(Re.pluralRules[Le])?Re.pluralRules[Le]:pluralDefault,qe=isObject$3(Re.pluralRules)&&isString(Le)&&isFunction(Re.pluralRules[Le])?pluralDefault:void 0,Ct=Re.list||[],Ot=Re.named||{};isNumber(Re.pluralIndex)&&function(Re,Le){Le.count||(Le.count=Re),Le.n||(Le.n=Re)}(Oe,Ot);function message(Le){const Oe=isFunction(Re.messages)?Re.messages(Le):!!isObject$3(Re.messages)&&Re.messages[Le];return Oe||(Re.parent?Re.parent.message(Le):DEFAULT_MESSAGE)}const Jt=isPlainObject(Re.processor)&&isFunction(Re.processor.normalize)?Re.processor.normalize:DEFAULT_NORMALIZE,Hr=isPlainObject(Re.processor)&&isFunction(Re.processor.interpolate)?Re.processor.interpolate:DEFAULT_INTERPOLATE,Jr={list:Re=>Ct[Re],named:Re=>Ot[Re],plural:Re=>Re[Ue(Oe,Re.length,qe)],linked:(Le,...Oe)=>{const[Ue,qe]=Oe;let Ct="text",Ot="";1===Oe.length?isObject$3(Ue)?(Ot=Ue.modifier||Ot,Ct=Ue.type||Ct):isString(Ue)&&(Ot=Ue||Ot):2===Oe.length&&(isString(Ue)&&(Ot=Ue||Ot),isString(qe)&&(Ct=qe||Ct));const Jt=message(Le)(Jr),Hr="vnode"===Ct&&mE(Jt)&&Ot?Jt[0]:Jt;return Ot?(Ln=Ot,Re.modifiers?Re.modifiers[Ln]:DEFAULT_MODIFIER)(Hr,Ct):Hr;var Ln},message:message,type:isPlainObject(Re.processor)&&isString(Re.processor.type)?Re.processor.type:"text",interpolate:Hr,normalize:Jt,values:pE({},Ct,Ot)};return Jr}const $E=yE,GE=incrementer($E),qE={NOT_FOUND_KEY:$E,FALLBACK_TO_TRANSLATE:GE(),CANNOT_FORMAT_NUMBER:GE(),FALLBACK_TO_NUMBER_FORMAT:GE(),CANNOT_FORMAT_DATE:GE(),FALLBACK_TO_DATE_FORMAT:GE(),EXPERIMENTAL_CUSTOM_MESSAGE_COMPILER:GE(),__EXTEND_POINT__:GE()},HE=LE,WE=incrementer(HE),ZE={INVALID_ARGUMENT:HE,INVALID_DATE_ARGUMENT:WE(),INVALID_ISO_DATE_ARGUMENT:WE(),NOT_SUPPORT_NON_STRING_MESSAGE:WE(),NOT_SUPPORT_LOCALE_PROMISE_VALUE:WE(),NOT_SUPPORT_LOCALE_ASYNC_FUNCTION:WE(),NOT_SUPPORT_LOCALE_TYPE:WE(),__EXTEND_POINT__:WE()};function createCoreError(Re){return createCompileError(Re,null,void 0)}function getLocale$1(Re,Le){return null!=Le.locale?resolveLocale(Le.locale):resolveLocale(Re.locale)}let XE;function resolveLocale(Re){if(isString(Re))return Re;if(isFunction(Re)){if(Re.resolvedOnce&&null!=XE)return XE;if("Function"===Re.constructor.name){const Oe=Re();if(isObject$3(Le=Oe)&&isFunction(Le.then)&&isFunction(Le.catch))throw createCoreError(ZE.NOT_SUPPORT_LOCALE_PROMISE_VALUE);return XE=Oe}throw createCoreError(ZE.NOT_SUPPORT_LOCALE_ASYNC_FUNCTION)}throw createCoreError(ZE.NOT_SUPPORT_LOCALE_TYPE);var Le}function fallbackWithSimple(Re,Le,Oe){return[...new Set([Oe,...mE(Le)?Le:isObject$3(Le)?Object.keys(Le):isString(Le)?[Le]:[Oe]])]}function fallbackWithLocaleChain(Re,Le,Oe){const Ue=isString(Oe)?Oe:YE,qe=Re;qe.__localeChainCache||(qe.__localeChainCache=new Map);let Ct=qe.__localeChainCache.get(Ue);if(!Ct){Ct=[];let Re=[Oe];for(;mE(Re);)Re=appendBlockToChain(Ct,Re,Le);const Ot=mE(Le)||!isPlainObject(Le)?Le:Le.default?Le.default:null;Re=isString(Ot)?[Ot]:Ot,mE(Re)&&appendBlockToChain(Ct,Re,!1),qe.__localeChainCache.set(Ue,Ct)}return Ct}function appendBlockToChain(Re,Le,Oe){let Ue=!0;for(let qe=0;qe<Le.length&&isBoolean(Ue);qe++){const Ct=Le[qe];isString(Ct)&&(Ue=appendLocaleToChain(Re,Le[qe],Oe))}return Ue}function appendLocaleToChain(Re,Le,Oe){let Ue;const qe=Le.split("-");do{Ue=appendItemToChain(Re,qe.join("-"),Oe),qe.splice(-1,1)}while(qe.length&&!0===Ue);return Ue}function appendItemToChain(Re,Le,Oe){let Ue=!1;if(!Re.includes(Le)&&(Ue=!0,Le)){Ue="!"!==Le[Le.length-1];const qe=Le.replace(/!/g,"");Re.push(qe),(mE(Oe)||isPlainObject(Oe))&&Oe[qe]&&(Ue=Oe[qe])}return Ue}const YE="en-US",capitalize=Re=>`${Re.charAt(0).toLocaleUpperCase()}${Re.substr(1)}`;let KE,JE,QE;let eC=null;const setFallbackContext=Re=>{eC=Re};let tC=0;function createCoreContext(Re={}){const Le=isFunction(Re.onWarn)?Re.onWarn:warn,Oe=isString(Re.version)?Re.version:"9.14.1",Ue=isString(Re.locale)||isFunction(Re.locale)?Re.locale:YE,qe=isFunction(Ue)?YE:Ue,Ct=mE(Re.fallbackLocale)||isPlainObject(Re.fallbackLocale)||isString(Re.fallbackLocale)||!1===Re.fallbackLocale?Re.fallbackLocale:qe,Ot=isPlainObject(Re.messages)?Re.messages:{[qe]:{}},Jt=isPlainObject(Re.datetimeFormats)?Re.datetimeFormats:{[qe]:{}},Hr=isPlainObject(Re.numberFormats)?Re.numberFormats:{[qe]:{}},Jr=pE({},Re.modifiers||{},{upper:(Re,Le)=>"text"===Le&&isString(Re)?Re.toUpperCase():"vnode"===Le&&isObject$3(Re)&&"__v_isVNode"in Re?Re.children.toUpperCase():Re,lower:(Re,Le)=>"text"===Le&&isString(Re)?Re.toLowerCase():"vnode"===Le&&isObject$3(Re)&&"__v_isVNode"in Re?Re.children.toLowerCase():Re,capitalize:(Re,Le)=>"text"===Le&&isString(Re)?capitalize(Re):"vnode"===Le&&isObject$3(Re)&&"__v_isVNode"in Re?capitalize(Re.children):Re}),Ln=Re.pluralRules||{},Nn=isFunction(Re.missing)?Re.missing:null,$n=!isBoolean(Re.missingWarn)&&!isRegExp(Re.missingWarn)||Re.missingWarn,Gn=!isBoolean(Re.fallbackWarn)&&!isRegExp(Re.fallbackWarn)||Re.fallbackWarn,qn=!!Re.fallbackFormat,Zn=!!Re.unresolving,Xn=isFunction(Re.postTranslation)?Re.postTranslation:null,Yn=isPlainObject(Re.processor)?Re.processor:null,_i=!isBoolean(Re.warnHtmlMessage)||Re.warnHtmlMessage,vi=!!Re.escapeParameter,xi=isFunction(Re.messageCompiler)?Re.messageCompiler:KE,bi=isFunction(Re.messageResolver)?Re.messageResolver:JE||resolveWithKeyValue,Pi=isFunction(Re.localeFallbacker)?Re.localeFallbacker:QE||fallbackWithSimple,lo=isObject$3(Re.fallbackContext)?Re.fallbackContext:void 0,uo=Re,po=isObject$3(uo.__datetimeFormatters)?uo.__datetimeFormatters:new Map,fo=isObject$3(uo.__numberFormatters)?uo.__numberFormatters:new Map,Io=isObject$3(uo.__meta)?uo.__meta:{};tC++;const is={version:Oe,cid:tC,locale:Ue,fallbackLocale:Ct,messages:Ot,modifiers:Jr,pluralRules:Ln,missing:Nn,missingWarn:$n,fallbackWarn:Gn,fallbackFormat:qn,unresolving:Zn,postTranslation:Xn,processor:Yn,warnHtmlMessage:_i,escapeParameter:vi,messageCompiler:xi,messageResolver:bi,localeFallbacker:Pi,fallbackContext:lo,onWarn:Le,__meta:Io};return is.datetimeFormats=Jt,is.numberFormats=Hr,is.__datetimeFormatters=po,is.__numberFormatters=fo,is}function handleMissing(Re,Le,Oe,Ue,qe){const{missing:Ct,onWarn:Ot}=Re;if(null!==Ct){const Ue=Ct(Re,Oe,Le,qe);return isString(Ue)?Ue:Le}return Le}function updateFallbackLocale(Re,Le,Oe){Re.__localeChainCache=new Map,Re.localeFallbacker(Re,Oe,Le)}function isImplicitFallback(Re,Le){const Oe=Le.indexOf(Re);if(-1===Oe)return!1;for(let Ct=Oe+1;Ct<Le.length;Ct++)if(Ue=Re,qe=Le[Ct],Ue!==qe&&Ue.split("-")[0]===qe.split("-")[0])return!0;var Ue,qe;return!1}function format(Re){return Le=>function(Re,Le){const Oe=Le.b||Le.body;if(1===(Oe.t||Oe.type)){const Le=Oe,Ue=Le.c||Le.cases;return Re.plural(Ue.reduce(((Le,Oe)=>[...Le,formatMessageParts(Re,Oe)]),[]))}return formatMessageParts(Re,Oe)}(Le,Re)}function formatMessageParts(Re,Le){const Oe=Le.s||Le.static;if(Oe)return"text"===Re.type?Oe:Re.normalize([Oe]);{const Oe=(Le.i||Le.items).reduce(((Le,Oe)=>[...Le,formatMessagePart(Re,Oe)]),[]);return Re.normalize(Oe)}}function formatMessagePart(Re,Le){const Oe=Le.t||Le.type;switch(Oe){case 3:{const Re=Le;return Re.v||Re.value}case 9:{const Re=Le;return Re.v||Re.value}case 4:{const Oe=Le;return Re.interpolate(Re.named(Oe.k||Oe.key))}case 5:{const Oe=Le;return Re.interpolate(Re.list(null!=Oe.i?Oe.i:Oe.index))}case 6:{const Oe=Le,Ue=Oe.m||Oe.modifier;return Re.linked(formatMessagePart(Re,Oe.k||Oe.key),Ue?formatMessagePart(Re,Ue):void 0,Re.type)}case 7:{const Re=Le;return Re.v||Re.value}case 8:{const Re=Le;return Re.v||Re.value}default:throw new Error(`unhandled node type on format message part: ${Oe}`)}}const defaultOnCacheKey=Re=>Re;let rC=Object.create(null);const isMessageAST=Re=>isObject$3(Re)&&(0===Re.t||0===Re.type)&&("b"in Re||"body"in Re);const NOOP_MESSAGE_FUNCTION=()=>"",isMessageFunction=Re=>isFunction(Re);function translate$1(Re,...Le){const{fallbackFormat:Oe,postTranslation:Ue,unresolving:qe,messageCompiler:Ct,fallbackLocale:Ot,messages:Jt}=Re,[Hr,Jr]=parseTranslateArgs(...Le),Ln=isBoolean(Jr.missingWarn)?Jr.missingWarn:Re.missingWarn,Nn=isBoolean(Jr.fallbackWarn)?Jr.fallbackWarn:Re.fallbackWarn,$n=isBoolean(Jr.escapeParameter)?Jr.escapeParameter:Re.escapeParameter,Gn=!!Jr.resolvedMessage,qn=isString(Jr.default)||isBoolean(Jr.default)?isBoolean(Jr.default)?Ct?Hr:()=>Hr:Jr.default:Oe?Ct?Hr:()=>Hr:"",Zn=Oe||""!==qn,Xn=getLocale$1(Re,Jr);$n&&function(Re){mE(Re.list)?Re.list=Re.list.map((Re=>isString(Re)?escapeHtml(Re):Re)):isObject$3(Re.named)&&Object.keys(Re.named).forEach((Le=>{isString(Re.named[Le])&&(Re.named[Le]=escapeHtml(Re.named[Le]))}))}(Jr);let[Yn,_i,vi]=Gn?[Hr,Xn,Jt[Xn]||{}]:resolveMessageFormat(Re,Hr,Xn,Ot,Nn,Ln),xi=Yn,bi=Hr;if(Gn||isString(xi)||isMessageAST(xi)||isMessageFunction(xi)||Zn&&(xi=qn,bi=xi),!(Gn||(isString(xi)||isMessageAST(xi)||isMessageFunction(xi))&&isString(_i)))return qe?-1:Hr;let Pi=!1;const lo=isMessageFunction(xi)?xi:compileMessageFormat(Re,Hr,_i,xi,bi,(()=>{Pi=!0}));if(Pi)return xi;const uo=function(Re,Le,Oe,Ue){const{modifiers:qe,pluralRules:Ct,messageResolver:Ot,fallbackLocale:Jt,fallbackWarn:Hr,missingWarn:Jr,fallbackContext:Ln}=Re,resolveMessage=Ue=>{let qe=Ot(Oe,Ue);if(null==qe&&Ln){const[,,Re]=resolveMessageFormat(Ln,Ue,Le,Jt,Hr,Jr);qe=Ot(Re,Ue)}if(isString(qe)||isMessageAST(qe)){let Oe=!1;const Ct=compileMessageFormat(Re,Ue,Le,qe,Ue,(()=>{Oe=!0}));return Oe?NOOP_MESSAGE_FUNCTION:Ct}return isMessageFunction(qe)?qe:NOOP_MESSAGE_FUNCTION},Nn={locale:Le,modifiers:qe,pluralRules:Ct,messages:resolveMessage};Re.processor&&(Nn.processor=Re.processor);Ue.list&&(Nn.list=Ue.list);Ue.named&&(Nn.named=Ue.named);isNumber(Ue.plural)&&(Nn.pluralIndex=Ue.plural);return Nn}(Re,_i,vi,Jr),po=function(Re,Le,Oe){const Ue=Le(Oe);return Ue}(0,lo,createMessageContext(uo));return Ue?Ue(po,Hr):po}function resolveMessageFormat(Re,Le,Oe,Ue,qe,Ct){const{messages:Ot,onWarn:Jt,messageResolver:Hr,localeFallbacker:Jr}=Re,Ln=Jr(Re,Ue,Oe);let Nn,$n={},Gn=null;for(let Oe=0;Oe<Ln.length&&(Nn=Ln[Oe],$n=Ot[Nn]||{},null===(Gn=Hr($n,Le))&&(Gn=$n[Le]),!(isString(Gn)||isMessageAST(Gn)||isMessageFunction(Gn)));Oe++)if(!isImplicitFallback(Nn,Ln)){const Oe=handleMissing(Re,Le,Nn,0,"translate");Oe!==Le&&(Gn=Oe)}return[Gn,Nn,$n]}function compileMessageFormat(Re,Le,Oe,Ue,qe,Ct){const{messageCompiler:Ot,warnHtmlMessage:Jt}=Re;if(isMessageFunction(Ue)){const Re=Ue;return Re.locale=Re.locale||Oe,Re.key=Re.key||Le,Re}if(null==Ot){const msg2=()=>Ue;return msg2.locale=Oe,msg2.key=Le,msg2}const Hr=Ot(Ue,function(Re,Le,Oe,Ue,qe,Ct){return{locale:Le,key:Oe,warnHtmlMessage:qe,onError:Re=>{throw Ct&&Ct(Re),Re},onCacheKey:Re=>((Re,Le,Oe)=>friendlyJSONstringify({l:Re,k:Le,s:Oe}))(Le,Oe,Re)}}(0,Oe,qe,0,Jt,Ct));return Hr.locale=Oe,Hr.key=Le,Hr.source=Ue,Hr}function parseTranslateArgs(...Re){const[Le,Oe,Ue]=Re,qe={};if(!(isString(Le)||isNumber(Le)||isMessageFunction(Le)||isMessageAST(Le)))throw createCoreError(ZE.INVALID_ARGUMENT);const Ct=isNumber(Le)?String(Le):(isMessageFunction(Le),Le);return isNumber(Oe)?qe.plural=Oe:isString(Oe)?qe.default=Oe:isPlainObject(Oe)&&!isEmptyObject(Oe)?qe.named=Oe:mE(Oe)&&(qe.list=Oe),isNumber(Ue)?qe.plural=Ue:isString(Ue)?qe.default=Ue:isPlainObject(Ue)&&pE(qe,Ue),[Ct,qe]}function datetime(Re,...Le){const{datetimeFormats:Oe,unresolving:Ue,fallbackLocale:qe,onWarn:Ct,localeFallbacker:Ot}=Re,{__datetimeFormatters:Jt}=Re,[Hr,Jr,Ln,Nn]=parseDateTimeArgs(...Le);isBoolean(Ln.missingWarn)?Ln.missingWarn:Re.missingWarn;isBoolean(Ln.fallbackWarn)?Ln.fallbackWarn:Re.fallbackWarn;const $n=!!Ln.part,Gn=getLocale$1(Re,Ln),qn=Ot(Re,qe,Gn);if(!isString(Hr)||""===Hr)return new Intl.DateTimeFormat(Gn,Nn).format(Jr);let Zn,Xn={},Yn=null;for(let Le=0;Le<qn.length&&(Zn=qn[Le],Xn=Oe[Zn]||{},Yn=Xn[Hr],!isPlainObject(Yn));Le++)handleMissing(Re,Hr,Zn,0,"datetime format");if(!isPlainObject(Yn)||!isString(Zn))return Ue?-1:Hr;let _i=`${Zn}__${Hr}`;isEmptyObject(Nn)||(_i=`${_i}__${JSON.stringify(Nn)}`);let vi=Jt.get(_i);return vi||(vi=new Intl.DateTimeFormat(Zn,pE({},Yn,Nn)),Jt.set(_i,vi)),$n?vi.formatToParts(Jr):vi.format(Jr)}const nC=["localeMatcher","weekday","era","year","month","day","hour","minute","second","timeZoneName","formatMatcher","hour12","timeZone","dateStyle","timeStyle","calendar","dayPeriod","numberingSystem","hourCycle","fractionalSecondDigits"];function parseDateTimeArgs(...Re){const[Le,Oe,Ue,qe]=Re,Ct={};let Ot,Jt={};if(isString(Le)){const Re=Le.match(/(\d{4}-\d{2}-\d{2})(T|\s)?(.*)/);if(!Re)throw createCoreError(ZE.INVALID_ISO_DATE_ARGUMENT);const Oe=Re[3]?Re[3].trim().startsWith("T")?`${Re[1].trim()}${Re[3].trim()}`:`${Re[1].trim()}T${Re[3].trim()}`:Re[1].trim();Ot=new Date(Oe);try{Ot.toISOString()}catch(Re){throw createCoreError(ZE.INVALID_ISO_DATE_ARGUMENT)}}else if("[object Date]"===toTypeString(Le)){if(isNaN(Le.getTime()))throw createCoreError(ZE.INVALID_DATE_ARGUMENT);Ot=Le}else{if(!isNumber(Le))throw createCoreError(ZE.INVALID_ARGUMENT);Ot=Le}return isString(Oe)?Ct.key=Oe:isPlainObject(Oe)&&Object.keys(Oe).forEach((Re=>{nC.includes(Re)?Jt[Re]=Oe[Re]:Ct[Re]=Oe[Re]})),isString(Ue)?Ct.locale=Ue:isPlainObject(Ue)&&(Jt=Ue),isPlainObject(qe)&&(Jt=qe),[Ct.key||"",Ot,Ct,Jt]}function clearDateTimeFormat(Re,Le,Oe){const Ue=Re;for(const Re in Oe){const Oe=`${Le}__${Re}`;Ue.__datetimeFormatters.has(Oe)&&Ue.__datetimeFormatters.delete(Oe)}}function number(Re,...Le){const{numberFormats:Oe,unresolving:Ue,fallbackLocale:qe,onWarn:Ct,localeFallbacker:Ot}=Re,{__numberFormatters:Jt}=Re,[Hr,Jr,Ln,Nn]=parseNumberArgs(...Le);isBoolean(Ln.missingWarn)?Ln.missingWarn:Re.missingWarn;isBoolean(Ln.fallbackWarn)?Ln.fallbackWarn:Re.fallbackWarn;const $n=!!Ln.part,Gn=getLocale$1(Re,Ln),qn=Ot(Re,qe,Gn);if(!isString(Hr)||""===Hr)return new Intl.NumberFormat(Gn,Nn).format(Jr);let Zn,Xn={},Yn=null;for(let Le=0;Le<qn.length&&(Zn=qn[Le],Xn=Oe[Zn]||{},Yn=Xn[Hr],!isPlainObject(Yn));Le++)handleMissing(Re,Hr,Zn,0,"number format");if(!isPlainObject(Yn)||!isString(Zn))return Ue?-1:Hr;let _i=`${Zn}__${Hr}`;isEmptyObject(Nn)||(_i=`${_i}__${JSON.stringify(Nn)}`);let vi=Jt.get(_i);return vi||(vi=new Intl.NumberFormat(Zn,pE({},Yn,Nn)),Jt.set(_i,vi)),$n?vi.formatToParts(Jr):vi.format(Jr)}const iC=["localeMatcher","style","currency","currencyDisplay","currencySign","useGrouping","minimumIntegerDigits","minimumFractionDigits","maximumFractionDigits","minimumSignificantDigits","maximumSignificantDigits","compactDisplay","notation","signDisplay","unit","unitDisplay","roundingMode","roundingPriority","roundingIncrement","trailingZeroDisplay"];function parseNumberArgs(...Re){const[Le,Oe,Ue,qe]=Re,Ct={};let Ot={};if(!isNumber(Le))throw createCoreError(ZE.INVALID_ARGUMENT);const Jt=Le;return isString(Oe)?Ct.key=Oe:isPlainObject(Oe)&&Object.keys(Oe).forEach((Re=>{iC.includes(Re)?Ot[Re]=Oe[Re]:Ct[Re]=Oe[Re]})),isString(Ue)?Ct.locale=Ue:isPlainObject(Ue)&&(Ot=Ue),isPlainObject(qe)&&(Ot=qe),[Ct.key||"",Jt,Ct,Ot]}function clearNumberFormat(Re,Le,Oe){const Ue=Re;for(const Re in Oe){const Oe=`${Le}__${Re}`;Ue.__numberFormatters.has(Oe)&&Ue.__numberFormatters.delete(Oe)}}const oC=qE.__EXTEND_POINT__,sC=incrementer(oC);sC(),sC(),sC(),sC(),sC(),sC(),sC(),sC(),sC();const aC=ZE.__EXTEND_POINT__,lC=incrementer(aC),cC={UNEXPECTED_RETURN_TYPE:aC,INVALID_ARGUMENT:lC(),MUST_BE_CALL_SETUP_TOP:lC(),NOT_INSTALLED:lC(),NOT_AVAILABLE_IN_LEGACY_MODE:lC(),REQUIRED_VALUE:lC(),INVALID_VALUE:lC(),CANNOT_SETUP_VUE_DEVTOOLS_PLUGIN:lC(),NOT_INSTALLED_WITH_PROVIDE:lC(),UNEXPECTED_ERROR:lC(),NOT_COMPATIBLE_LEGACY_VUE_I18N:lC(),BRIDGE_SUPPORT_VUE_2_ONLY:lC(),MUST_DEFINE_I18N_OPTION_IN_ALLOW_COMPOSITION:lC(),NOT_AVAILABLE_COMPOSITION_IN_LEGACY:lC(),__EXTEND_POINT__:lC()};function createI18nError(Re,...Le){return createCompileError(Re,null,void 0)}const uC=makeSymbol("__translateVNode"),hC=makeSymbol("__datetimeParts"),dC=makeSymbol("__numberParts"),pC=makeSymbol("__setPluralRules"),fC=makeSymbol("__injectWithOption"),mC=makeSymbol("__dispose");function handleFlatJson(Re){if(!isObject$3(Re))return Re;for(const Le in Re)if(hasOwn(Re,Le))if(Le.includes(".")){const Oe=Le.split("."),Ue=Oe.length-1;let qe=Re,Ct=!1;for(let Re=0;Re<Ue;Re++){if(Oe[Re]in qe||(qe[Oe[Re]]={}),!isObject$3(qe[Oe[Re]])){Ct=!0;break}qe=qe[Oe[Re]]}Ct||(qe[Oe[Ue]]=Re[Le],delete Re[Le]),isObject$3(qe[Oe[Ue]])&&handleFlatJson(qe[Oe[Ue]])}else isObject$3(Re[Le])&&handleFlatJson(Re[Le]);return Re}function getLocaleMessages(Re,Le){const{messages:Oe,__i18n:Ue,messageResolver:qe,flatJson:Ct}=Le,Ot=isPlainObject(Oe)?Oe:mE(Ue)?{}:{[Re]:{}};if(mE(Ue)&&Ue.forEach((Re=>{if("locale"in Re&&"resource"in Re){const{locale:Le,resource:Oe}=Re;Le?(Ot[Le]=Ot[Le]||{},deepCopy(Oe,Ot[Le])):deepCopy(Oe,Ot)}else isString(Re)&&deepCopy(JSON.parse(Re),Ot)})),null==qe&&Ct)for(const Re in Ot)hasOwn(Ot,Re)&&handleFlatJson(Ot[Re]);return Ot}function getComponentOptions(Re){return Re.type}function createTextNode(Re){return createVNode(Bb,null,Re,0)}const NOOP_RETURN_ARRAY=()=>[],NOOP_RETURN_FALSE=()=>!1;let gC=0;function defineCoreMissingHandler(Re){return(Le,Oe,Ue,qe)=>Re(Oe,Ue,getCurrentInstance()||void 0,qe)}function createComposer(Re={},Le){const{__root:Oe,__injectWithOption:Ue}=Re,qe=void 0===Oe,Ct=Re.flatJson,Ot=shallowRef,Jt=!!Re.translateExistCompatible;let Hr=!isBoolean(Re.inheritLocale)||Re.inheritLocale;const Jr=Ot(Oe&&Hr?Oe.locale.value:isString(Re.locale)?Re.locale:YE),Ln=Ot(Oe&&Hr?Oe.fallbackLocale.value:isString(Re.fallbackLocale)||mE(Re.fallbackLocale)||isPlainObject(Re.fallbackLocale)||!1===Re.fallbackLocale?Re.fallbackLocale:Jr.value),Nn=Ot(getLocaleMessages(Jr.value,Re)),$n=Ot(isPlainObject(Re.datetimeFormats)?Re.datetimeFormats:{[Jr.value]:{}}),Gn=Ot(isPlainObject(Re.numberFormats)?Re.numberFormats:{[Jr.value]:{}});let qn=Oe?Oe.missingWarn:!isBoolean(Re.missingWarn)&&!isRegExp(Re.missingWarn)||Re.missingWarn,Zn=Oe?Oe.fallbackWarn:!isBoolean(Re.fallbackWarn)&&!isRegExp(Re.fallbackWarn)||Re.fallbackWarn,Xn=Oe?Oe.fallbackRoot:!isBoolean(Re.fallbackRoot)||Re.fallbackRoot,Yn=!!Re.fallbackFormat,_i=isFunction(Re.missing)?Re.missing:null,vi=isFunction(Re.missing)?defineCoreMissingHandler(Re.missing):null,xi=isFunction(Re.postTranslation)?Re.postTranslation:null,bi=Oe?Oe.warnHtmlMessage:!isBoolean(Re.warnHtmlMessage)||Re.warnHtmlMessage,Pi=!!Re.escapeParameter;const lo=Oe?Oe.modifiers:isPlainObject(Re.modifiers)?Re.modifiers:{};let uo,po=Re.pluralRules||Oe&&Oe.pluralRules;uo=(()=>{qe&&setFallbackContext(null);const Le={version:"9.14.1",locale:Jr.value,fallbackLocale:Ln.value,messages:Nn.value,modifiers:lo,pluralRules:po,missing:null===vi?void 0:vi,missingWarn:qn,fallbackWarn:Zn,fallbackFormat:Yn,unresolving:!0,postTranslation:null===xi?void 0:xi,warnHtmlMessage:bi,escapeParameter:Pi,messageResolver:Re.messageResolver,messageCompiler:Re.messageCompiler,__meta:{framework:"vue"}};Le.datetimeFormats=$n.value,Le.numberFormats=Gn.value,Le.__datetimeFormatters=isPlainObject(uo)?uo.__datetimeFormatters:void 0,Le.__numberFormatters=isPlainObject(uo)?uo.__numberFormatters:void 0;const Oe=createCoreContext(Le);return qe&&setFallbackContext(Oe),Oe})(),updateFallbackLocale(uo,Jr.value,Ln.value);const fo=computed({get:()=>Jr.value,set:Re=>{Jr.value=Re,uo.locale=Jr.value}}),Io=computed({get:()=>Ln.value,set:Re=>{Ln.value=Re,uo.fallbackLocale=Ln.value,updateFallbackLocale(uo,Jr.value,Re)}}),is=computed((()=>Nn.value)),as=computed((()=>$n.value)),Is=computed((()=>Gn.value));const wrapWithDeps=(Re,Le,Ue,Ct,Ot,Jt)=>{let Hr;Jr.value,Ln.value,Nn.value,$n.value,Gn.value;try{0,qe||(uo.fallbackContext=Oe?eC:void 0),Hr=Re(uo)}finally{qe||(uo.fallbackContext=void 0)}if("translate exists"!==Ue&&isNumber(Hr)&&-1===Hr||"translate exists"===Ue&&!Hr){const[Re,Ue]=Le();return Oe&&Xn?Ct(Oe):Ot(Re)}if(Jt(Hr))return Hr;throw createI18nError(cC.UNEXPECTED_RETURN_TYPE)};function t(...Re){return wrapWithDeps((Le=>Reflect.apply(translate$1,null,[Le,...Re])),(()=>parseTranslateArgs(...Re)),"translate",(Le=>Reflect.apply(Le.t,Le,[...Re])),(Re=>Re),(Re=>isString(Re)))}const Xs={normalize:function(Re){return Re.map((Re=>isString(Re)||isNumber(Re)||isBoolean(Re)?createTextNode(String(Re)):Re))},interpolate:Re=>Re,type:"vnode"};function getLocaleMessage(Re){return Nn.value[Re]||{}}gC++;const ta={id:gC,locale:fo,fallbackLocale:Io,get inheritLocale(){return Hr},set inheritLocale(Re){Hr=Re,Re&&Oe&&(Jr.value=Oe.locale.value,Ln.value=Oe.fallbackLocale.value,updateFallbackLocale(uo,Jr.value,Ln.value))},get availableLocales(){return Object.keys(Nn.value).sort()},messages:is,get modifiers(){return lo},get pluralRules(){return po||{}},get isGlobal(){return qe},get missingWarn(){return qn},set missingWarn(Re){qn=Re,uo.missingWarn=qn},get fallbackWarn(){return Zn},set fallbackWarn(Re){Zn=Re,uo.fallbackWarn=Zn},get fallbackRoot(){return Xn},set fallbackRoot(Re){Xn=Re},get fallbackFormat(){return Yn},set fallbackFormat(Re){Yn=Re,uo.fallbackFormat=Yn},get warnHtmlMessage(){return bi},set warnHtmlMessage(Re){bi=Re,uo.warnHtmlMessage=Re},get escapeParameter(){return Pi},set escapeParameter(Re){Pi=Re,uo.escapeParameter=Re},t:t,getLocaleMessage:getLocaleMessage,setLocaleMessage:function(Re,Le){if(Ct){const Oe={[Re]:Le};for(const Re in Oe)hasOwn(Oe,Re)&&handleFlatJson(Oe[Re]);Le=Oe[Re]}Nn.value[Re]=Le,uo.messages=Nn.value},mergeLocaleMessage:function(Re,Le){Nn.value[Re]=Nn.value[Re]||{};const Oe={[Re]:Le};if(Ct)for(const Re in Oe)hasOwn(Oe,Re)&&handleFlatJson(Oe[Re]);deepCopy(Le=Oe[Re],Nn.value[Re]),uo.messages=Nn.value},getPostTranslationHandler:function(){return isFunction(xi)?xi:null},setPostTranslationHandler:function(Re){xi=Re,uo.postTranslation=Re},getMissingHandler:function(){return _i},setMissingHandler:function(Re){null!==Re&&(vi=defineCoreMissingHandler(Re)),_i=Re,uo.missing=vi},[pC]:function(Re){po=Re,uo.pluralRules=po}};return ta.datetimeFormats=as,ta.numberFormats=Is,ta.rt=function(...Re){const[Le,Oe,Ue]=Re;if(Ue&&!isObject$3(Ue))throw createI18nError(cC.INVALID_ARGUMENT);return t(Le,Oe,pE({resolvedMessage:!0},Ue||{}))},ta.te=function(Re,Le){return wrapWithDeps((()=>{if(!Re)return!1;const Oe=getLocaleMessage(isString(Le)?Le:Jr.value),Ue=uo.messageResolver(Oe,Re);return Jt?null!=Ue:isMessageAST(Ue)||isMessageFunction(Ue)||isString(Ue)}),(()=>[Re]),"translate exists",(Oe=>Reflect.apply(Oe.te,Oe,[Re,Le])),NOOP_RETURN_FALSE,(Re=>isBoolean(Re)))},ta.tm=function(Re){const Le=function(Re){let Le=null;const Oe=fallbackWithLocaleChain(uo,Ln.value,Jr.value);for(let Ue=0;Ue<Oe.length;Ue++){const qe=Nn.value[Oe[Ue]]||{},Ct=uo.messageResolver(qe,Re);if(null!=Ct){Le=Ct;break}}return Le}(Re);return null!=Le?Le:Oe&&Oe.tm(Re)||{}},ta.d=function(...Re){return wrapWithDeps((Le=>Reflect.apply(datetime,null,[Le,...Re])),(()=>parseDateTimeArgs(...Re)),"datetime format",(Le=>Reflect.apply(Le.d,Le,[...Re])),(()=>""),(Re=>isString(Re)))},ta.n=function(...Re){return wrapWithDeps((Le=>Reflect.apply(number,null,[Le,...Re])),(()=>parseNumberArgs(...Re)),"number format",(Le=>Reflect.apply(Le.n,Le,[...Re])),(()=>""),(Re=>isString(Re)))},ta.getDateTimeFormat=function(Re){return $n.value[Re]||{}},ta.setDateTimeFormat=function(Re,Le){$n.value[Re]=Le,uo.datetimeFormats=$n.value,clearDateTimeFormat(uo,Re,Le)},ta.mergeDateTimeFormat=function(Re,Le){$n.value[Re]=pE($n.value[Re]||{},Le),uo.datetimeFormats=$n.value,clearDateTimeFormat(uo,Re,Le)},ta.getNumberFormat=function(Re){return Gn.value[Re]||{}},ta.setNumberFormat=function(Re,Le){Gn.value[Re]=Le,uo.numberFormats=Gn.value,clearNumberFormat(uo,Re,Le)},ta.mergeNumberFormat=function(Re,Le){Gn.value[Re]=pE(Gn.value[Re]||{},Le),uo.numberFormats=Gn.value,clearNumberFormat(uo,Re,Le)},ta[fC]=Ue,ta[uC]=function(...Re){return wrapWithDeps((Le=>{let Oe;const Ue=Le;try{Ue.processor=Xs,Oe=Reflect.apply(translate$1,null,[Ue,...Re])}finally{Ue.processor=null}return Oe}),(()=>parseTranslateArgs(...Re)),"translate",(Le=>Le[uC](...Re)),(Re=>[createTextNode(Re)]),(Re=>mE(Re)))},ta[hC]=function(...Re){return wrapWithDeps((Le=>Reflect.apply(datetime,null,[Le,...Re])),(()=>parseDateTimeArgs(...Re)),"datetime format",(Le=>Le[hC](...Re)),NOOP_RETURN_ARRAY,(Re=>isString(Re)||mE(Re)))},ta[dC]=function(...Re){return wrapWithDeps((Le=>Reflect.apply(number,null,[Le,...Re])),(()=>parseNumberArgs(...Re)),"number format",(Le=>Le[dC](...Re)),NOOP_RETURN_ARRAY,(Re=>isString(Re)||mE(Re)))},ta}const _C={tag:{type:[String,Object]},locale:{type:String},scope:{type:String,validator:Re=>"parent"===Re||"global"===Re,default:"parent"},i18n:{type:Object}};function getFragmentableTag(Re){return Db}const yC=defineComponent({name:"i18n-t",props:pE({keypath:{type:String,required:!0},plural:{type:[Number,String],validator:Re=>isNumber(Re)||!isNaN(Re)}},_C),setup(Re,Le){const{slots:Oe,attrs:Ue}=Le,qe=Re.i18n||useI18n({useScope:Re.scope,__useComponent:!0});return()=>{const Ct=Object.keys(Oe).filter((Re=>"_"!==Re)),Ot={};Re.locale&&(Ot.locale=Re.locale),void 0!==Re.plural&&(Ot.plural=isString(Re.plural)?+Re.plural:Re.plural);const Jt=function({slots:Re},Le){if(1===Le.length&&"default"===Le[0])return(Re.default?Re.default():[]).reduce(((Re,Le)=>[...Re,...Le.type===Db?Le.children:[Le]]),[]);return Le.reduce(((Le,Oe)=>{const Ue=Re[Oe];return Ue&&(Le[Oe]=Ue()),Le}),{})}(Le,Ct),Hr=qe[uC](Re.keypath,Jt,Ot),Jr=pE({},Ue);return h(isString(Re.tag)||isObject$3(Re.tag)?Re.tag:getFragmentableTag(),Jr,Hr)}}}),vC=yC;function renderFormatter(Re,Le,Oe,Ue){const{slots:qe,attrs:Ct}=Le;return()=>{const Le={part:!0};let Ot={};Re.locale&&(Le.locale=Re.locale),isString(Re.format)?Le.key=Re.format:isObject$3(Re.format)&&(isString(Re.format.key)&&(Le.key=Re.format.key),Ot=Object.keys(Re.format).reduce(((Le,Ue)=>Oe.includes(Ue)?pE({},Le,{[Ue]:Re.format[Ue]}):Le),{}));const Jt=Ue(Re.value,Le,Ot);let Hr=[Le.key];mE(Jt)?Hr=Jt.map(((Re,Le)=>{const Oe=qe[Re.type],Ue=Oe?Oe({[Re.type]:Re.value,index:Le,parts:Jt}):[Re.value];var Ct;return mE(Ct=Ue)&&!isString(Ct[0])&&(Ue[0].key=`${Re.type}-${Le}`),Ue})):isString(Jt)&&(Hr=[Jt]);const Jr=pE({},Ct);return h(isString(Re.tag)||isObject$3(Re.tag)?Re.tag:getFragmentableTag(),Jr,Hr)}}const xC=defineComponent({name:"i18n-n",props:pE({value:{type:Number,required:!0},format:{type:[String,Object]}},_C),setup(Re,Le){const Oe=Re.i18n||useI18n({useScope:Re.scope,__useComponent:!0});return renderFormatter(Re,Le,iC,((...Re)=>Oe[dC](...Re)))}}),bC=defineComponent({name:"i18n-d",props:pE({value:{type:[Number,Date],required:!0},format:{type:[String,Object]}},_C),setup(Re,Le){const Oe=Re.i18n||useI18n({useScope:Re.scope,__useComponent:!0});return renderFormatter(Re,Le,nC,((...Re)=>Oe[hC](...Re)))}});function parseValue(Re){if(isString(Re))return{path:Re};if(isPlainObject(Re)){if(!("path"in Re))throw createI18nError(cC.REQUIRED_VALUE);return Re}throw createI18nError(cC.INVALID_VALUE)}function makeParams(Re){const{path:Le,locale:Oe,args:Ue,choice:qe,plural:Ct}=Re,Ot={},Jt=Ue||{};return isString(Oe)&&(Ot.locale=Oe),isNumber(qe)&&(Ot.plural=qe),isNumber(Ct)&&(Ot.plural=Ct),[Le,Jt,Ot]}function apply(Re,Le,...Oe){const Ue=isPlainObject(Oe[0])?Oe[0]:{},qe=!!Ue.useI18nComponentName;(!isBoolean(Ue.globalInstall)||Ue.globalInstall)&&([qe?"i18n":vC.name,"I18nT"].forEach((Le=>Re.component(Le,vC))),[xC.name,"I18nN"].forEach((Le=>Re.component(Le,xC))),[bC.name,"I18nD"].forEach((Le=>Re.component(Le,bC)))),Re.directive("t",function(Re){const _process=Le=>{const{instance:Oe,modifiers:Ue,value:qe}=Le;if(!Oe||!Oe.$)throw createI18nError(cC.UNEXPECTED_ERROR);const Ct=function(Re,Le){const Oe=Re;if("composition"===Re.mode)return Oe.__getInstance(Le)||Re.global;{const Ue=Oe.__getInstance(Le);return null!=Ue?Ue.__composer:Re.global.__composer}}(Re,Oe.$),Ot=parseValue(qe);return[Reflect.apply(Ct.t,Ct,[...makeParams(Ot)]),Ct]};return{created:(Re,Le)=>{const[Oe,Ue]=_process(Le);Re.__composer=Ue,Re.textContent=Oe},unmounted:Re=>{Re.__composer&&(Re.__composer=void 0,delete Re.__composer)},beforeUpdate:(Re,{value:Le})=>{if(Re.__composer){const Oe=Re.__composer,Ue=parseValue(Le);Re.textContent=Reflect.apply(Oe.t,Oe,[...makeParams(Ue)])}},getSSRProps:Re=>{const[Le]=_process(Re);return{textContent:Le}}}}(Le))}const wC=makeSymbol("global-vue-i18n");function createI18n(Re={},Le){const Oe=!isBoolean(Re.globalInjection)||Re.globalInjection,Ue=new Map,[qe,Ct]=function(Re){const Le=effectScope();{const Oe=Le.run((()=>createComposer(Re)));if(null==Oe)throw createI18nError(cC.UNEXPECTED_ERROR);return[Le,Oe]}}(Re),Ot=makeSymbol("");{const Re={get mode(){return"composition"},get allowComposition(){return true},async install(Le,...Ue){if(Le.__VUE_I18N_SYMBOL__=Ot,Le.provide(Le.__VUE_I18N_SYMBOL__,Re),isPlainObject(Ue[0])){const Le=Ue[0];Re.__composerExtend=Le.__composerExtend,Re.__vueI18nExtend=Le.__vueI18nExtend}let qe=null;Oe&&(qe=function(Re,Le){const Oe=Object.create(null);TC.forEach((Re=>{const Ue=Object.getOwnPropertyDescriptor(Le,Re);if(!Ue)throw createI18nError(cC.UNEXPECTED_ERROR);const qe=isRef(Ue.value)?{get:()=>Ue.value.value,set(Re){Ue.value.value=Re}}:{get:()=>Ue.get&&Ue.get()};Object.defineProperty(Oe,Re,qe)})),Re.config.globalProperties.$i18n=Oe,SC.forEach((Oe=>{const Ue=Object.getOwnPropertyDescriptor(Le,Oe);if(!Ue||!Ue.value)throw createI18nError(cC.UNEXPECTED_ERROR);Object.defineProperty(Re.config.globalProperties,`$${Oe}`,Ue)}));const dispose=()=>{delete Re.config.globalProperties.$i18n,SC.forEach((Le=>{delete Re.config.globalProperties[`$${Le}`]}))};return dispose}(Le,Re.global)),apply(Le,Re,...Ue);const Ct=Le.unmount;Le.unmount=()=>{qe&&qe(),Re.dispose(),Ct()}},get global(){return Ct},dispose(){qe.stop()},__instances:Ue,__getInstance:function(Re){return Ue.get(Re)||null},__setInstance:function(Re,Le){Ue.set(Re,Le)},__deleteInstance:function(Re){Ue.delete(Re)}};return Re}}function useI18n(Re={}){const Le=getCurrentInstance();if(null==Le)throw createI18nError(cC.MUST_BE_CALL_SETUP_TOP);if(!Le.isCE&&null!=Le.appContext.app&&!Le.appContext.app.__VUE_I18N_SYMBOL__)throw createI18nError(cC.NOT_INSTALLED);const Oe=function(Re){{const Le=inject(Re.isCE?wC:Re.appContext.app.__VUE_I18N_SYMBOL__);if(!Le)throw createI18nError(Re.isCE?cC.NOT_INSTALLED_WITH_PROVIDE:cC.UNEXPECTED_ERROR);return Le}}(Le),Ue=function(Re){return"composition"===Re.mode?Re.global:Re.global.__composer}(Oe),qe=getComponentOptions(Le),Ct=function(Re,Le){return isEmptyObject(Re)?"__i18n"in Le?"local":"global":Re.useScope?Re.useScope:"local"}(Re,qe);if("global"===Ct)return function(Re,Le,Oe){let Ue=isObject$3(Le.messages)?Le.messages:{};"__i18nGlobal"in Oe&&(Ue=getLocaleMessages(Re.locale.value,{messages:Ue,__i18n:Oe.__i18nGlobal}));const qe=Object.keys(Ue);if(qe.length&&qe.forEach((Le=>{Re.mergeLocaleMessage(Le,Ue[Le])})),isObject$3(Le.datetimeFormats)){const Oe=Object.keys(Le.datetimeFormats);Oe.length&&Oe.forEach((Oe=>{Re.mergeDateTimeFormat(Oe,Le.datetimeFormats[Oe])}))}if(isObject$3(Le.numberFormats)){const Oe=Object.keys(Le.numberFormats);Oe.length&&Oe.forEach((Oe=>{Re.mergeNumberFormat(Oe,Le.numberFormats[Oe])}))}}(Ue,Re,qe),Ue;if("parent"===Ct){let qe=function(Re,Le,Oe=!1){let Ue=null;const qe=Le.root;let Ct=function(Re,Le=!1){if(null==Re)return null;return Le&&Re.vnode.ctx||Re.parent}(Le,Oe);for(;null!=Ct;){const Le=Re;if("composition"===Re.mode&&(Ue=Le.__getInstance(Ct)),null!=Ue)break;if(qe===Ct)break;Ct=Ct.parent}return Ue}(Oe,Le,Re.__useComponent);return null==qe&&(qe=Ue),qe}const Ot=Oe;let Jt=Ot.__getInstance(Le);if(null==Jt){const Oe=pE({},Re);"__i18n"in qe&&(Oe.__i18n=qe.__i18n),Ue&&(Oe.__root=Ue),Jt=createComposer(Oe),Ot.__composerExtend&&(Jt[mC]=Ot.__composerExtend(Jt)),Ot.__setInstance(Le,Jt)}return Jt}const TC=["locale","fallbackLocale","availableLocales"],SC=["t","rt","d","n","tm","te"];var EC,CC;EC=function(Re,Le){if(isString(Re)){!isBoolean(Le.warnHtmlMessage)||Le.warnHtmlMessage;const Oe=(Le.onCacheKey||defaultOnCacheKey)(Re),Ue=rC[Oe];if(Ue)return Ue;const{ast:qe,detectError:Ct}=function(Re,Le={}){let Oe=!1;const Ue=Le.onError||defaultOnError;return Le.onError=Re=>{Oe=!0,Ue(Re)},{...baseCompile$1(Re,Le),detectError:Oe}}(Re,{...Le,location:!1,jit:!0}),Ot=format(qe);return Ct?Ot:rC[Oe]=Ot}{const Le=Re.cacheKey;return Le?rC[Le]||(rC[Le]=format(Re)):format(Re)}},KE=EC,CC=function(Re,Le){if(!isObject$3(Re))return null;let Oe=VE.get(Le);if(Oe||(Oe=function(Re){const Le=[];let Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr=-1,Ln=0,Nn=0;const $n=[];function maybeUnescapeQuote(){const Le=Re[Jr+1];if(5===Ln&&"'"===Le||6===Ln&&'"'===Le)return Jr++,qe="\\"+Le,$n[0](),!0}for($n[0]=()=>{void 0===Ue?Ue=qe:Ue+=qe},$n[1]=()=>{void 0!==Ue&&(Le.push(Ue),Ue=void 0)},$n[2]=()=>{$n[0](),Nn++},$n[3]=()=>{if(Nn>0)Nn--,Ln=4,$n[0]();else{if(Nn=0,void 0===Ue)return!1;if(Ue=formatSubPath(Ue),!1===Ue)return!1;$n[1]()}};null!==Ln;)if(Jr++,Oe=Re[Jr],"\\"!==Oe||!maybeUnescapeQuote()){if(Ct=getPathCharType(Oe),Hr=jE[Ln],Ot=Hr[Ct]||Hr.l||8,8===Ot)return;if(Ln=Ot[0],void 0!==Ot[1]&&(Jt=$n[Ot[1]],Jt&&(qe=Oe,!1===Jt())))return;if(7===Ln)return Le}}(Le),Oe&&VE.set(Le,Oe)),!Oe)return null;const Ue=Oe.length;let qe=Re,Ct=0;for(;Ct<Ue;){const Re=qe[Oe[Ct]];if(void 0===Re)return null;if(isFunction(qe))return null;qe=Re,Ct++}return qe},JE=CC,QE=fallbackWithLocaleChain;const AC=[],IC={},kC=[()=>Promise.resolve().then((function(){return wk}))],MC=[],PC="@nuxtjs/i18n",RC="nuxt-i18n-slp",LC=new Map;function makeFallbackLocaleCodes(Re,Le){let Oe=[];if(mE(Re))Oe=Re;else if(isObject$3(Re)){const Ue=[...Le,"default"];for(const Le of Ue)Re[Le]&&(Oe=[...Oe,...Re[Le].filter(Boolean)])}else isString(Re)&&Le.every((Le=>Le!==Re))&&Oe.push(Re);return Oe}async function loadMessage(Re,{key:Le,load:Oe}){let Ue=null;try{const qe=await Oe().then((Re=>Re.default||Re));isFunction(qe)?Ue=await qe(Re):(Ue=qe,null!=Ue&&LC&&LC.set(Le,Ue))}catch(Re){console.error("Failed locale loading: "+Re.message)}return Ue}async function loadLocale(Re,Le,Oe){const Ue=Le[Re];if(null==Ue)return void console.warn("Could not find messages for locale code: "+Re);const qe={};for(const Le of Ue){let Oe=null;Oe=LC&&LC.has(Le.key)&&Le.cache?LC.get(Le.key):await loadMessage(Re,Le),null!=Oe&&deepCopy(Oe,qe)}Oe(Re,qe)}async function loadAndSetLocaleMessages(Re,Le,Oe){await loadLocale(Re,Le,((Re,Le)=>{const Ue=Oe[Re]||{};deepCopy(Le,Ue),Oe[Re]=Ue}))}function isVueI18n(Re){return null!=Re&&"__composer"in Re}function getI18nTarget(Re){return function(Re){return null!=Re&&"global"in Re&&"mode"in Re}(Re)?Re.global:Re}function getComposer(Re){const Le=getI18nTarget(Re);return function(Re){return null!=Re&&!("__composer"in Re)&&"locale"in Re&&isRef(Re.locale)}(Le)?Le:isVueI18n(Le)?Le.__composer:Le}function getLocale(Re){return unref(getI18nTarget(Re).locale)}function setLocale(Re,Le){const Oe=getI18nTarget(Re);isRef(Oe.locale)?Oe.locale.value=Le:Oe.locale=Le}function getRouteName(Re){return isString(Re)?Re:"symbol"==typeof Re?Re.toString():"(null)"}function getLocaleRouteName(Re,Le,{defaultLocale:Oe,strategy:Ue,routesNameSeparator:qe,defaultLocaleRouteNameSuffix:Ct}){let Ot=getRouteName(Re)+("no_prefix"===Ue?"":qe+Le);return Le===Oe&&"prefix_and_default"===Ue&&(Ot+=qe+Ct),Ot}const DefaultBrowserLocaleMatcher=function(Re,Le){const Oe=[];for(const[Ue,qe]of Le.entries()){const Ct=Re.find((Re=>Re.iso.toLowerCase()===qe.toLowerCase()));if(Ct){Oe.push({code:Ct.code,score:1-Ue/Le.length});break}}for(const[Ue,qe]of Le.entries()){const Ct=qe.split("-")[0].toLowerCase(),Ot=Re.find((Re=>Re.iso.split("-")[0].toLowerCase()===Ct));if(Ot){Oe.push({code:Ot.code,score:.999-Ue/Le.length});break}}return Oe};const DefaultBrowerLocaleComparer=function(Re,Le){return Re.score===Le.score?Le.code.length-Re.code.length:Le.score-Re.score};function getLocalesRegex(Re){return new RegExp(`^/(${Re.join("|")})(?:/|$)`,"i")}const OC=new Set(["prefix_and_default","prefix_except_default"]);const DefaultPrefixable=function(Re){const{currentLocale:Le,defaultLocale:Oe,strategy:Ue}=Re;return!(Le===Oe&&OC.has(Ue)||"no_prefix"===Ue)};function getRouteBaseName(Re,Le){const{routesNameSeparator:Oe}=Re.runtimeConfig.public.i18n,Ue=unref(Le);if(null==Ue||!Ue.name)return;return getRouteName(Ue.name).split(Oe)[0]}function localePath(Re,Le,Oe){var Ue;if("string"==typeof Le&&hasProtocol(Le,{acceptRelative:!0}))return Le;const qe=resolveRoute(Re,Le,Oe);return null==qe?"":(null==(Ue=qe.redirectedFrom)?void 0:Ue.fullPath)||qe.fullPath}function localeRoute(Re,Le,Oe){return resolveRoute(Re,Le,Oe)??void 0}function localeLocation(Re,Le,Oe){return resolveRoute(Re,Le,Oe)??void 0}function resolveRoute(Re,Le,Oe){const{router:Ue,i18n:qe}=Re,Ct=Oe||getLocale(qe),{routesNameSeparator:Ot,defaultLocale:Jt,defaultLocaleRouteNameSuffix:Hr,strategy:Jr,trailingSlash:Ln}=Re.runtimeConfig.public.i18n,Nn=function(Re=useRuntimeConfig()){return Le=>DefaultPrefixable(Le)&&!Re.public.i18n.differentDomains}(Re.runtimeConfig);let $n;if(isString(Le))if("/"===Le[0]){const{pathname:Re,search:Oe,hash:Ue}=parsePath(Le);$n={path:Re,query:parseQuery(Oe),hash:Ue}}else $n={name:Le};else $n=Le;let Gn=pE({},$n);if("path"in(qn=Gn)&&qn.path&&!("name"in qn)){const Le=function({router:Re},Le,Oe,Ue){var qe,Ct;if("prefix"!==Oe)return Re.resolve(Le);const[Ot,Jt]=function(Re,Le){return[Re.slice(0,Le),Re.slice(Le)]}(Le.path,1),Hr=`${Ot}${Ue}${""===Jt?Jt:`/${Jt}`}`,Jr=null==(Ct=null==(qe=Re.options)?void 0:qe.routes)?void 0:Ct.find((Re=>Re.path===Hr));if(null==Jr)return Le;const Ln=pE({},Le,Jr);return Ln.path=Hr,Re.resolve(Ln)}(Re,Gn,Jr,Ct),Oe=getRouteBaseName(Re,Le);isString(Oe)?(Gn={name:getLocaleRouteName(Oe,Ct,{defaultLocale:Jt,strategy:Jr,routesNameSeparator:Ot,defaultLocaleRouteNameSuffix:Hr}),params:Le.params,query:Le.query,hash:Le.hash},Gn.state=Le.state):(Nn({currentLocale:Ct,defaultLocale:Jt,strategy:Jr})&&(Gn.path=`/${Ct}${Gn.path}`),Gn.path=Ln?withTrailingSlash(Gn.path,!0):withoutTrailingSlash(Gn.path,!0))}else Gn.name||"path"in Gn||(Gn.name=getRouteBaseName(Re,Ue.currentRoute.value)),Gn.name=getLocaleRouteName(Gn.name,Ct,{defaultLocale:Jt,strategy:Jr,routesNameSeparator:Ot,defaultLocaleRouteNameSuffix:Hr});var qn;try{const Re=Ue.resolve(Gn);return Re.name?Re:Ue.resolve(Le)}catch(Re){if("object"==typeof Re&&"type"in Re&&1===Re.type)return null}}function switchLocalePath(Re,Le,Oe){const Ue=Oe??Re.router.currentRoute.value,qe=getRouteBaseName(Re,Ue);if(!qe)return"";const Ct=function(Re=useRuntimeConfig()){return(Le,Oe)=>{if(Re.public.i18n.differentDomains){const Re=getDomainFromLocale(Oe);return Re?joinURL(Re,Le):Le}return Le}}(Re.runtimeConfig),Ot=function(Re){const{fullPath:Le,query:Oe,hash:Ue,name:qe,path:Ct,params:Ot,meta:Jt,redirectedFrom:Hr,matched:Jr}=Re;return{fullPath:Le,params:Ot,query:Oe,hash:Ue,name:qe,path:Ct,meta:Jt,matched:Jr,redirectedFrom:Hr}}(Ue),Jt=function(Re,Le){var Oe;return Re.runtimeConfig.public.i18n.experimental.switchLocalePathLinkSSR?unref(Re.metaState.value):(null==(Oe=unref(Le.meta||{}))?void 0:Oe.nuxtI18n)||{}}(Re,Ue)[Le];return Ct(localePath(Re,{...Ot,name:qe,params:{...Ot.params,...Jt}},Le),Le)}function localeHead(Re,{addDirAttribute:Le=!1,addSeoAttributes:Oe=!0,identifierAttribute:Ue="hid"}){const{defaultDirection:qe}=useRuntimeConfig().public.i18n,Ct=getComposer(Re.i18n),Ot={htmlAttrs:{},link:[],meta:[]};if(null==unref(Ct.locales)||null==unref(Ct.baseUrl))return Ot;const Jt=getLocale(Re.i18n),Hr=function(Re){return unref(getI18nTarget(Re).locales)}(Re.i18n),Jr=function(Re){Re=Re||[];const Le=[];for(const Oe of Re)isString(Oe)?Le.push({code:Oe}):Le.push(Oe);return Le}(Hr).find((Re=>Re.code===Jt))||{code:Jt},Ln=Jr.iso,Nn=Jr.dir||qe;return Le&&(Ot.htmlAttrs.dir=Nn),Oe&&Jt&&unref(Ct.locales)&&(Ln&&(Ot.htmlAttrs.lang=Ln),Ot.link.push(...function(Re,Le,Oe){const Ue=getBaseUrl(),{defaultLocale:qe,strategy:Ct}=useRuntimeConfig().public.i18n,Ot=[];if("no_prefix"===Ct)return Ot;const Jt=new Map;for(const Re of Le){const Le=Re.iso;if(!Le){console.warn("Locale ISO code is required to generate alternate link");continue}const[Oe,Ue]=Le.split("-");Oe&&Ue&&(Re.isCatchallLocale||!Jt.has(Oe))&&Jt.set(Oe,Re),Jt.set(Le,Re)}for(const[Le,qe]of Jt.entries()){const Ct=switchLocalePath(Re,qe.code);Ct&&Ot.push({[Oe]:`i18n-alt-${Le}`,rel:"alternate",href:toAbsoluteUrl(Ct,Ue),hreflang:Le})}if(qe){const Le=switchLocalePath(Re,qe);Le&&Ot.push({[Oe]:"i18n-xd",rel:"alternate",href:toAbsoluteUrl(Le,Ue),hreflang:"x-default"})}return Ot}(Re,unref(Hr),Ue),...function(Re,Le,Oe){const Ue=getBaseUrl(),qe=getCanonicalUrl(Re,Ue,Oe);return qe?[{[Le]:"i18n-can",rel:"canonical",href:qe}]:[]}(Re,Ue,Oe)),Ot.meta.push(...function(Re,Le,Oe){const Ue=getBaseUrl(),qe=getCanonicalUrl(Re,Ue,Oe);return qe?[{[Le]:"i18n-og-url",property:"og:url",content:qe}]:[]}(Re,Ue,Oe),...function(Re,Le,Oe){return Re&&Le?[{[Oe]:"i18n-og",property:"og:locale",content:hypenToUnderscore(Le)}]:[]}(Jr,Ln,Ue),...function(Re,Le,Oe){const Ue=Re.filter((Re=>Re.iso&&Re.iso!==Le));return Ue.map((Re=>({[Oe]:`i18n-og-alt-${Re.iso}`,property:"og:locale:alternate",content:hypenToUnderscore(Re.iso)})))}(unref(Hr),Ln,Ue))),Ot}function getBaseUrl(){const Re=useNuxtApp();return joinURL(unref(getComposer(Re.$i18n).baseUrl),Re.$config.app.baseURL)}function getCanonicalUrl(Re,Le,Oe){const Ue=Re.router.currentRoute.value,qe=localeRoute(Re,{...Ue,path:void 0,name:getRouteBaseName(Re,Ue)});if(!qe)return"";let Ct=toAbsoluteUrl(qe.path,Le);const Ot=isObject$3(Oe)&&Oe.canonicalQueries||[],Jt=qe.query,Hr=new URLSearchParams;for(const Re of Ot)if(Re in Jt){const Le=Jt[Re];mE(Le)?Le.forEach((Le=>Hr.append(Re,Le||""))):Hr.append(Re,Le||"")}const Jr=Hr.toString();return Jr&&(Ct=`${Ct}?${Jr}`),Ct}function hypenToUnderscore(Re){return(Re||"").replace(/-/g,"_")}function toAbsoluteUrl(Re,Le){return Re.match(/^https?:\/\//)?Re:joinURL(Le,Re)}function mergeLocaleMessage(Re,Le,Oe){return callVueI18nInterfaces(Re,"mergeLocaleMessage",Le,Oe)}function initCommonComposableOptions(Re){return{i18n:Re??useNuxtApp().$i18n,router:useRouter(),runtimeConfig:useRuntimeConfig(),metaState:useState("nuxt-i18n-meta",(()=>({})))}}async function loadAndSetLocale(Re,Le,Oe,Ue=!1){const{differentDomains:qe,skipSettingLocaleOnNavigate:Ct,lazy:Ot}=Oe,Jt=runtimeDetectBrowserLanguage(Oe),Hr=useNuxtApp(),Jr=getLocale(Le),Ln=function(Re){return unref(getI18nTarget(Re).localeCodes)}(Le);function syncCookie(Re=Jr){!1!==Jt&&Jt.useCookie&&(Ct||function(Re,Le){callVueI18nInterfaces(Re,"setLocaleCookie",Le)}(Le,Re))}if(!Re)return syncCookie(),!1;if(!Ue&&qe)return syncCookie(),!1;if(Jr===Re)return syncCookie(),!1;const Nn=await function(Re,Le,Oe,Ue,qe){return callVueI18nInterfaces(Re,"onBeforeLanguageSwitch",Le,Oe,Ue,qe)}(Le,Jr,Re,Ue,Hr);if(Nn&&Ln.includes(Nn)){if(Jr===Nn)return syncCookie(),!1;Re=Nn}if(Ot){const Oe=function(Re,Le){const Oe=getI18nTarget(Re);return unref(Oe[Le])}(Le,"fallbackLocale"),setter=(Re,Oe)=>mergeLocaleMessage(Le,Re,Oe);if(Oe){const Le=makeFallbackLocaleCodes(Oe,[Re]);await Promise.all(Le.map((Re=>loadLocale(Re,IC,setter))))}await loadLocale(Re,IC,setter)}return!Ct&&(syncCookie(Re),setLocale(Le,Re),await function(Re,Le,Oe){return callVueI18nInterfaces(Re,"onLanguageSwitched",Le,Oe)}(Le,Jr,Re),!0)}function detectLocale(Re,Le,Oe,Ue,qe,Ct){const{strategy:Ot,defaultLocale:Jt,differentDomains:Hr}=Ct,Jr=runtimeDetectBrowserLanguage(Ct),Ln=isFunction(Ue)?Ue():Ue,{ssg:Nn,callType:$n,firstAccess:Gn,localeCookie:qn}=qe,{locale:Zn,stat:Xn,reason:Yn,from:_i}=Jr?function(Re,Le,Oe,Ue=""){const{strategy:qe}=useRuntimeConfig().public.i18n,{ssg:Ct,callType:Ot,firstAccess:Jt,localeCookie:Hr}=Oe;if(!Jt)return{locale:"no_prefix"===qe?Ue:"",stat:!1,reason:"first_access_only"};const{redirectOn:Jr,alwaysRedirect:Ln,useCookie:Nn,fallbackLocale:$n}=runtimeDetectBrowserLanguage(),Gn=isString(Re)?Re:Re.path;if("no_prefix"!==qe)if("root"===Jr){if("/"!==Gn)return{locale:"",stat:!1,reason:"not_redirect_on_root"}}else if("no prefix"===Jr&&!Ln&&Gn.match(getLocalesRegex(AC)))return{locale:"",stat:!1,reason:"not_redirect_on_no_prefix"};let qn,Zn,Xn="unknown";Nn&&(Zn=qn=Hr,Xn="cookie");Zn||(Zn=getBrowserLocale(),Xn="navigator_or_header");const Yn=Zn||$n;!Zn&&$n&&(Xn="fallback");const _i=Ue||Le;if(Yn&&(!Nn||Ln||!qn)){if("no_prefix"===qe)return{locale:Yn,stat:!0,from:Xn};if("setup"===Ot&&Yn!==_i)return{locale:Yn,stat:!0,from:Xn};if(Ln){const Re="/"===Gn,Le="all"===Jr,Oe="no prefix"===Jr&&!Gn.match(getLocalesRegex(AC));if(Re||Le||Oe)return{locale:Yn,stat:!0,from:Xn}}}if("ssg_setup"===Ct&&Yn)return{locale:Yn,stat:!0,from:Xn};if(("navigator_or_header"===Xn||"cookie"===Xn)&&Yn)return{locale:Yn,stat:!0,from:Xn};return{locale:"",stat:!1,reason:"not_found_match"}}(Re,Oe,qe,Ln):zC;if("detect_ignore_on_ssg"===Yn)return Ln;if(("navigator_or_header"===_i||"cookie"===_i||"fallback"===_i)&&Zn)return Zn;let vi=Zn;return vi||(Hr?vi=function(Re,Le,Oe){let Ue=function(){let Re;{const Le=useRequestHeaders(["x-forwarded-host","host"]);let Oe;"x-forwarded-host"in Le?Oe=Le["x-forwarded-host"]:"host"in Le&&(Oe=Le.host),Re=mE(Oe)?Oe[0]:Oe}return Re}()||"";if(Ue){let qe;const Ct=Re.filter((Re=>{if(Re&&Re.domain){let Le=Re.domain;return hasProtocol(Re.domain)&&(Le=Re.domain.replace(/(http|https):\/\//,"")),Le===Ue}return!1}));if(1===Ct.length)qe=Ct[0];else if(Ct.length>1)if("no_prefix"===Le)console.warn(formatMessage("Multiple matching domains found! This is not supported for no_prefix strategy in combination with differentDomains!")),qe=Ct[0];else{if(Oe){const Re=isObject$3(Oe)?Oe.path:isString(Oe)?Oe:"";if(Re&&""!==Re){const Le=Re.match(getLocalesRegex(Ct.map((Re=>Re.code))));Le&&Le.length>1&&(qe=Ct.find((Re=>Re.code===Le[1])))}}qe||(qe=Ct.find((Re=>Re.domainDefault)))}if(qe)return qe.code;Ue=""}return Ue}(MC,Ot,Re):"no_prefix"!==Ot?vi=Le(Re):Jr||(vi=Ln)),!vi&&Jr&&Jr.useCookie&&(vi=qn||""),vi||(vi=Jt||""),vi}function detectRedirect({route:Re,targetLocale:Le,routeLocaleGetter:Oe,calledWithRouting:Ue=!1}){const qe=useNuxtApp(),Ct=initCommonComposableOptions(),{strategy:Ot,differentDomains:Jt}=Ct.runtimeConfig.public.i18n;let Hr="";const{fullPath:Jr}=Re.to;if(!Jt&&(Ue||"no_prefix"!==Ot)&&Oe(Re.to)!==Le){const Oe=qe.$switchLocalePath(Le)||qe.$localePath(Jr,Le);isString(Oe)&&Oe&&!isEqual(Oe,Jr)&&!Oe.startsWith("//")&&(Hr=Re.from&&Re.from.fullPath===Oe?"":Oe)}if(Jt&&Oe(Re.to)!==Le){const Oe=switchLocalePath(Ct,Le,Re.to);isString(Oe)&&Oe&&!isEqual(Oe,Jr)&&!Oe.startsWith("//")&&(Hr=Oe)}return Hr}function _navigate(Re,Le){return navigateTo(Re,{redirectCode:Le})}async function navigate(Re,{status:Le=302,enableNavigate:Oe=!1}={}){const{nuxtApp:Ue,i18n:qe,locale:Ct,route:Ot}=Re,{rootRedirect:Jt,differentDomains:Hr,skipSettingLocaleOnNavigate:Jr}=Ue.$config.public.i18n;let{redirectPath:Ln}=Re;if("/"===Ot.path&&Jt)return isString(Jt)?Ln="/"+Jt:function(Re){return isObject$3(Re)&&"path"in Re&&"statusCode"in Re}(Jt)&&(Ln="/"+Jt.path,Le=Jt.statusCode),Ln=Ue.$localePath(Ln,Ct),_navigate(Ln,Le);if(Hr){const Re=useState(PC+":redirect",(()=>""));Re.value&&Re.value!==Ln&&(Re.value=Ln)}else if(Ln)return _navigate(Ln,Le)}function formatMessage(Re){return PC+" "+Re}function callVueI18nInterfaces(Re,Le,...Oe){const Ue=getI18nTarget(Re),[qe,Ct]=[Ue,Ue[Le]];return Reflect.apply(Ct,qe,[...Oe])}function defineGetter(Re,Le,Oe){Object.defineProperty(Re,Le,{get:()=>Oe})}function wrapComposable(Re,Le=initCommonComposableOptions()){return(...Oe)=>Re(Le,...Oe)}function getBrowserLocale(){let Re;{const Le=useRequestHeaders(["accept-language"])["accept-language"];Le&&(Re=function(Re,Le,{matcher:Oe=DefaultBrowserLocaleMatcher,comparer:Ue=DefaultBrowerLocaleComparer}={}){const qe=[];for(const Le of Re){const{code:Re}=Le,Oe=Le.iso||Re;qe.push({code:Re,iso:Oe})}const Ct=Oe(qe,Le);return Ct.length>1&&Ct.sort(Ue),Ct.length?Ct[0].code:""}(MC,Le.split(",").map((Re=>Re.split(";")[0]))))}return Re}function getLocaleCookie(Re,Le,Oe){if(!1===Le||!Le.useCookie)return;const Ue=Re.value??void 0;return null!=Ue?AC.includes(Ue)?Ue:Oe?(Re.value=Oe,Oe):void(Re.value=void 0):void 0}const zC={locale:"",stat:!1,reason:"unknown",from:"unknown"};function getDomainFromLocale(Re){var Le,Oe;const Ue=useRuntimeConfig(),qe=useNuxtApp(),Ct=Ue.public.i18n,Ot=MC.find((Le=>Le.code===Re)),Jt=(null==(Oe=null==(Le=null==Ct?void 0:Ct.locales)?void 0:Le[Re])?void 0:Oe.domain)??(null==Ot?void 0:Ot.domain);if(Jt){if(hasProtocol(Jt,{strict:!0}))return Jt;let Re;{const{node:{req:Le}}=useRequestEvent(qe);Re=Le&&function(Re,Le=!0){const Oe=Le&&Re.headers?Re.headers["x-forwarded-proto"]:void 0,Ue="string"==typeof Oe?Oe.includes("https"):void 0;if(Ue)return!0;const qe=Re.connection?Re.connection.encrypted:void 0,Ct=void 0!==qe?!0===qe:void 0;return!!Ct||void 0===Ue&&void 0===Ct&&void 0}(Le)?"https:":"http:"}return Re+"//"+Jt}console.warn(formatMessage("Could not find domain name for locale "+Re))}const runtimeDetectBrowserLanguage=(Re=useRuntimeConfig().public.i18n)=>!1!==(null==Re?void 0:Re.detectBrowserLanguage)&&(null==Re?void 0:Re.detectBrowserLanguage);function useLocaleHead({addDirAttribute:Re=!1,addSeoAttributes:Le=!1,identifierAttribute:Oe="hid"}={}){const Ue=initCommonComposableOptions(),qe=ref({htmlAttrs:{},link:[],meta:[]});return qe.value=localeHead(Ue,{addDirAttribute:Re,addSeoAttributes:Le,identifierAttribute:Oe}),qe}function extendI18n(Re,{locales:Le=[],localeCodes:Oe=[],baseUrl:Ue="",hooks:qe={},context:Ct={}}={}){const Ot=effectScope(),Jt=Re.install;return Re.install=(Hr,...Jr)=>{const Ln=function(Re){return isObject$3(Re)&&("inject"in Re||"__composerExtend"in Re||"__vueI18nExtend"in Re)}(Jr[0])?pE({},Jr[0]):{inject:!0};null==Ln.inject&&(Ln.inject=!0);const Nn=Ln.__composerExtend;if(Ln.__composerExtend=Le=>{const Oe=getComposer(Re);let Ue;return Le.locales=computed((()=>Oe.locales.value)),Le.localeCodes=computed((()=>Oe.localeCodes.value)),Le.baseUrl=computed((()=>Oe.baseUrl.value)),isFunction(Nn)&&(Ue=Reflect.apply(Nn,Ln,[Le])),()=>{Ue&&Ue()}},"legacy"===Re.mode){const Re=Ln.__vueI18nExtend;Ln.__vueI18nExtend=Le=>{let Oe;return extendVueI18n(Le,qe.onExtendVueI18n),isFunction(Re)&&(Oe=Reflect.apply(Re,Ln,[Le])),()=>{Oe&&Oe()}}}Jr[0]=Ln,Reflect.apply(Jt,Re,[Hr,...Jr]);const $n=getComposer(Re);Ot.run((()=>{!function(Re,Le){const{locales:Oe,localeCodes:Ue,baseUrl:qe,context:Ct}=Le,Ot=ref(Oe),Jt=ref(Ue),Hr=ref("");Re.locales=computed((()=>Ot.value)),Re.localeCodes=computed((()=>Jt.value)),Re.baseUrl=computed((()=>Hr.value)),Hr.value=function(Re,Le){return isFunction(Re)?Re(Le):Re}(qe,Ct),Le.hooks&&Le.hooks.onExtendComposer&&Le.hooks.onExtendComposer(Re)}($n,{locales:Le,localeCodes:Oe,baseUrl:Ue,hooks:qe,context:Ct}),"legacy"===Re.mode&&isVueI18n(Re.global)&&extendVueI18n(Re.global,qe.onExtendVueI18n)}));const Gn=Hr,qn="composition"===Re.mode?Gn.config.globalProperties.$i18n:null;if(qn&&function(Re,Le,Oe){extendPropertyDescriptors(Le,Re,Oe)}(qn,$n,qe.onExtendExportedGlobal),Ln.inject){const Le=initCommonComposableOptions(Re);Hr.mixin({methods:{getRouteBaseName:wrapComposable(getRouteBaseName,Le),resolveRoute:wrapComposable(resolveRoute,Le),localePath:wrapComposable(localePath,Le),localeRoute:wrapComposable(localeRoute,Le),localeLocation:wrapComposable(localeLocation,Le),switchLocalePath:wrapComposable(switchLocalePath,Le),localeHead:wrapComposable(localeHead,Le)}})}if(Gn.unmount){const Re=Gn.unmount;Gn.unmount=()=>{Ot.stop(),Re()}}},Ot}function extendPropertyDescriptors(Re,Le,Oe){const Ue=[{locales:{get:()=>Re.locales.value},localeCodes:{get:()=>Re.localeCodes.value},baseUrl:{get:()=>Re.baseUrl.value}}];Oe&&Ue.push(Oe(Re));for(const Re of Ue)for(const[Oe,Ue]of Object.entries(Re))Object.defineProperty(Le,Oe,Ue)}function extendVueI18n(Re,Le){extendPropertyDescriptors(getComposer(Re),Re,Le)}const DC=defineNuxtPlugin({name:"i18n:plugin",parallel:!1,async setup(Re){let Le,Oe;const Ue=useRoute(),{vueApp:qe}=Re,Ct=Re,Ot={...Ct.$config.public.i18n};Ot.baseUrl=()=>{const Re=useNuxtApp(),{baseUrl:Le,defaultLocale:Oe,differentDomains:Ue}=Re.$config.public.i18n;if(isFunction(Le))return Le(Re);const qe=isFunction(Oe)?Oe():Oe;if(Ue&&qe){const Re=getDomainFromLocale(qe);if(Re)return Re}return Le||Le};const Jt=runtimeDetectBrowserLanguage(),Hr=([Le,Oe]=executeAsync((()=>async function(Re,Le){const Oe={messages:{}};for(const Ue of Re){const{default:Re}=await Ue();deepCopy("function"==typeof Re?await Le.runWithContext((async()=>await Re())):Re,Oe)}return Oe}(kC,useNuxtApp()))),Le=await Le,Oe(),Le);Hr.messages=Hr.messages||{},Hr.fallbackLocale=Hr.fallbackLocale??!1;const Jr=function(){const{routesNameSeparator:Re,defaultLocaleRouteNameSuffix:Le}=useRuntimeConfig().public.i18n,Oe=`(${AC.join("|")})`,Ue=new RegExp(`${Re}${Oe}(?:${Re}${Le})?$`,"i"),qe=getLocalesRegex(AC);return Re=>{if(isObject$3(Re)){if(Re.name){const Le=(isString(Re.name)?Re.name:Re.name.toString()).match(Ue);if(Le&&Le.length>1)return Le[1]}else if(Re.path){const Le=Re.path.match(qe);if(Le&&Le.length>1)return Le[1]}}else if(isString(Re)){const Le=Re.match(qe);if(Le&&Le.length>1)return Le[1]}return""}}(),getDefaultLocale=Re=>Re||Hr.locale||"en-US",Ln=function(){const Re=runtimeDetectBrowserLanguage(),Le=Re&&Re.cookieKey||"i18n_redirected",Oe=new Date,Ue={expires:new Date(Oe.setDate(Oe.getDate()+365)),path:"/",sameSite:Re&&Re.cookieCrossOrigin?"none":"lax",secure:Re&&Re.cookieCrossOrigin||Re&&Re.cookieSecure};return Re&&Re.cookieDomain&&(Ue.domain=Re.cookieDomain),useCookie(Le,Ue)}();let Nn=detectLocale(Ue,Jr,Hr.locale,getDefaultLocale(Ot.defaultLocale),{ssg:"normal",callType:"setup",firstAccess:!0,localeCookie:getLocaleCookie(Ln,Jt,Ot.defaultLocale)},Ot);Hr.messages=([Le,Oe]=executeAsync((()=>async function(Re,Le,Oe){const{defaultLocale:Ue,initialLocale:qe,localeCodes:Ct,fallbackLocale:Ot,lazy:Jt}=Oe;if(Jt&&Ot){const Oe=makeFallbackLocaleCodes(Ot,[Ue,qe]);await Promise.all(Oe.map((Oe=>loadAndSetLocaleMessages(Oe,Le,Re))))}const Hr=Jt?[...(new Set).add(Ue).add(qe)]:Ct;return await Promise.all(Hr.map((Oe=>loadAndSetLocaleMessages(Oe,Le,Re)))),Re}(Hr.messages,IC,{localeCodes:AC,initialLocale:Nn,lazy:Ot.lazy,defaultLocale:Ot.defaultLocale,fallbackLocale:Hr.fallbackLocale}))),Le=await Le,Oe(),Le),Nn=getDefaultLocale(Nn);const $n=createI18n({...Hr,locale:Nn});let Gn=!0;const isInitialLocaleSetup=Re=>Nn!==Re&&Gn;extendI18n($n,{locales:Ot.configLocales,localeCodes:AC,baseUrl:Ot.baseUrl,context:Ct,hooks:{onExtendComposer(Le){Le.strategy=Ot.strategy,Le.localeProperties=computed((()=>MC.find((Re=>Re.code===Le.locale.value))||{code:Le.locale.value})),Le.setLocale=async Re=>{const Le=isInitialLocaleSetup(Re);await loadAndSetLocale(Re,$n,Ot,Le)&&Le&&(Gn=!1);const Oe=await Ct.runWithContext((()=>detectRedirect({route:{to:Ue},targetLocale:Re,routeLocaleGetter:Jr})));await Ct.runWithContext((async()=>await navigate({nuxtApp:Ct,i18n:$n,redirectPath:Oe,locale:Re,route:Ue},{enableNavigate:!0})))},Le.loadLocaleMessages=async Re=>{await loadLocale(Re,IC,((Re,Le)=>mergeLocaleMessage($n,Re,Le)))},Le.differentDomains=Ot.differentDomains,Le.defaultLocale=Ot.defaultLocale,Le.getBrowserLocale=()=>getBrowserLocale(),Le.getLocaleCookie=()=>getLocaleCookie(Ln,Jt,Ot.defaultLocale),Le.setLocaleCookie=Re=>function(Re,Le,Oe){!1!==Oe&&Oe.useCookie&&(Re.value=Le)}(Ln,Re,Jt),Le.onBeforeLanguageSwitch=(Le,Oe,Ue,qe)=>Re.callHook("i18n:beforeLocaleSwitch",{oldLocale:Le,newLocale:Oe,initialSetup:Ue,context:qe}),Le.onLanguageSwitched=(Le,Oe)=>Re.callHook("i18n:localeSwitched",{oldLocale:Le,newLocale:Oe}),Le.finalizePendingLocaleChange=async()=>{$n.__pendingLocale&&(setLocale($n,$n.__pendingLocale),$n.__resolvePendingLocalePromise&&await $n.__resolvePendingLocalePromise(),$n.__pendingLocale=void 0)},Le.waitForPendingLocaleChange=async()=>{$n.__pendingLocale&&$n.__pendingLocalePromise&&await $n.__pendingLocalePromise}},onExtendExportedGlobal:Re=>({strategy:{get:()=>Re.strategy},localeProperties:{get:()=>Re.localeProperties.value},setLocale:{get:()=>async Le=>Reflect.apply(Re.setLocale,Re,[Le])},differentDomains:{get:()=>Re.differentDomains},defaultLocale:{get:()=>Re.defaultLocale},getBrowserLocale:{get:()=>()=>Reflect.apply(Re.getBrowserLocale,Re,[])},getLocaleCookie:{get:()=>()=>Reflect.apply(Re.getLocaleCookie,Re,[])},setLocaleCookie:{get:()=>Le=>Reflect.apply(Re.setLocaleCookie,Re,[Le])},onBeforeLanguageSwitch:{get:()=>(Le,Oe,Ue,qe)=>Reflect.apply(Re.onBeforeLanguageSwitch,Re,[Le,Oe,Ue,qe])},onLanguageSwitched:{get:()=>(Le,Oe)=>Reflect.apply(Re.onLanguageSwitched,Re,[Le,Oe])},finalizePendingLocaleChange:{get:()=>()=>Reflect.apply(Re.finalizePendingLocaleChange,Re,[])},waitForPendingLocaleChange:{get:()=>()=>Reflect.apply(Re.waitForPendingLocaleChange,Re,[])}}),onExtendVueI18n:Re=>({strategy:{get:()=>Re.strategy},localeProperties:{get:()=>Re.localeProperties.value},setLocale:{get:()=>async Le=>Reflect.apply(Re.setLocale,Re,[Le])},loadLocaleMessages:{get:()=>async Le=>Reflect.apply(Re.loadLocaleMessages,Re,[Le])},differentDomains:{get:()=>Re.differentDomains},defaultLocale:{get:()=>Re.defaultLocale},getBrowserLocale:{get:()=>()=>Reflect.apply(Re.getBrowserLocale,Re,[])},getLocaleCookie:{get:()=>()=>Reflect.apply(Re.getLocaleCookie,Re,[])},setLocaleCookie:{get:()=>Le=>Reflect.apply(Re.setLocaleCookie,Re,[Le])},onBeforeLanguageSwitch:{get:()=>(Le,Oe,Ue,qe)=>Reflect.apply(Re.onBeforeLanguageSwitch,Re,[Le,Oe,Ue,qe])},onLanguageSwitched:{get:()=>(Le,Oe)=>Reflect.apply(Re.onLanguageSwitched,Re,[Le,Oe])},finalizePendingLocaleChange:{get:()=>()=>Reflect.apply(Re.finalizePendingLocaleChange,Re,[])},waitForPendingLocaleChange:{get:()=>()=>Reflect.apply(Re.waitForPendingLocaleChange,Re,[])}})}});const qn={__composerExtend:Re=>{const Le=getComposer($n);return Re.strategy=Le.strategy,Re.localeProperties=computed((()=>Le.localeProperties.value)),Re.setLocale=Le.setLocale,Re.differentDomains=Le.differentDomains,Re.getBrowserLocale=Le.getBrowserLocale,Re.getLocaleCookie=Le.getLocaleCookie,Re.setLocaleCookie=Le.setLocaleCookie,Re.onBeforeLanguageSwitch=Le.onBeforeLanguageSwitch,Re.onLanguageSwitched=Le.onLanguageSwitched,Re.finalizePendingLocaleChange=Le.finalizePendingLocaleChange,Re.waitForPendingLocaleChange=Le.waitForPendingLocaleChange,()=>{}}};if(qe.use($n,qn),function(Re,Le){defineGetter(Re,"$i18n",getI18nTarget(Le)),defineGetter(Re,"$getRouteBaseName",wrapComposable(getRouteBaseName)),defineGetter(Re,"$localePath",wrapComposable(localePath)),defineGetter(Re,"$localeRoute",wrapComposable(localeRoute)),defineGetter(Re,"$switchLocalePath",wrapComposable(switchLocalePath)),defineGetter(Re,"$localeHead",wrapComposable(localeHead))}(Ct,$n),!0===Ot.experimental.switchLocalePathLinkSSR){const Le=wrapComposable(switchLocalePath),Oe=new RegExp([`\x3c!--${RC}-\\[(\\w+)\\]--\x3e`,".+?",`\x3c!--/${RC}--\x3e`].join(""),"g");Re.hook("app:rendered",(Re=>{var Ue;null!=(null==(Ue=Re.renderResult)?void 0:Ue.html)&&(Re.renderResult.html=Re.renderResult.html.replaceAll(Oe,((Re,Oe)=>Re.replace(/href="([^"]+)"/,`href="${Le(Oe??"")}"`))))}))}let Zn=0;((Re,Le,Oe={})=>{const Ue=useNuxtApp(),qe=Oe.global||"string"!=typeof Re,Ct=Le;Ct?qe?Ue._middleware.global.push(Ct):Ue._middleware.named[Re]=Ct:console.warn("[nuxt] No route middleware passed to `addRouteMiddleware`.",Re)})("locale-changing",defineNuxtRouteMiddleware((async(Re,Le)=>{let Oe,Ue;const qe=detectLocale(Re,Jr,Hr.locale,(()=>getLocale($n)||getDefaultLocale(Ot.defaultLocale)),{ssg:"normal",callType:"routing",firstAccess:0===Zn,localeCookie:getLocaleCookie(Ln,Jt,Ot.defaultLocale)},Ot),Nn=isInitialLocaleSetup(qe);([Oe,Ue]=executeAsync((()=>loadAndSetLocale(qe,$n,Ot,Nn))),Oe=await Oe,Ue(),Oe)&&Nn&&(Gn=!1);const qn=([Oe,Ue]=executeAsync((()=>Ct.runWithContext((()=>detectRedirect({route:{to:Re,from:Le},targetLocale:qe,routeLocaleGetter:"no_prefix"===Ot.strategy?()=>qe:Jr,calledWithRouting:!0}))))),Oe=await Oe,Ue(),Oe);return Zn++,[Oe,Ue]=executeAsync((()=>Ct.runWithContext((async()=>navigate({nuxtApp:Ct,i18n:$n,redirectPath:qn,locale:qe,route:Re}))))),Oe=await Oe,Ue(),Oe})),{global:!0})}}),BC="system",FC=defineNuxtPlugin((Re=>{var Le;const Oe=(null==(Le=Re.ssrContext)?void 0:Le.islandContext)?ref({}):useState("color-mode",(()=>reactive({preference:BC,value:BC,unknown:!0,forced:!1}))).value,Ue={};useHead({htmlAttrs:Ue}),useRouter().afterEach((Re=>{const Le=Re.meta.colorMode;Le&&"system"!==Le?(Oe.value=Ue["data-color-mode-forced"]=Le,Oe.forced=!0):"system"===Le&&console.warn("You cannot force the colorMode to system at the page level.")})),Re.provide("colorMode",Oe)})),NC=new RegExp(/Googlebot\/|Googlebot-Mobile|Googlebot-Image|Googlebot-News|Googlebot-Video|AdsBot-Google([^-]|$)|AdsBot-Google-Mobile|Feedfetcher-Google|Mediapartners-Google|Mediapartners \(Googlebot\)|APIs-Google|Google-InspectionTool|Storebot-Google|GoogleOther|bingbot|Slurp|[wW]get|LinkedInBot|Python-urllib|python-requests|aiohttp|httpx|libwww-perl|httpunit|Nutch|Go-http-client|phpcrawl|msnbot|jyxobot|FAST-WebCrawler|FAST Enterprise Crawler|BIGLOTRON|Teoma|convera|seekbot|Gigabot|Gigablast|exabot|ia_archiver|GingerCrawler|webmon |HTTrack|grub\.org|UsineNouvelleCrawler|antibot|netresearchserver|speedy|fluffy|findlink|msrbot|panscient|yacybot|AISearchBot|ips-agent|tagoobot|MJ12bot|woriobot|yanga|buzzbot|mlbot|yandex\.com\/bots|purebot|Linguee Bot|CyberPatrol|voilabot|Baiduspider|citeseerxbot|spbot|twengabot|postrank|Turnitin|scribdbot|page2rss|sitebot|linkdex|Adidxbot|ezooms|dotbot|Mail\.RU_Bot|discobot|heritrix|findthatfile|europarchive\.org|NerdByNature\.Bot|(sistrix|SISTRIX) [cC]rawler|Ahrefs(Bot|SiteAudit)|fuelbot|CrunchBot|IndeedBot|mappydata|woobot|ZoominfoBot|PrivacyAwareBot|Multiviewbot|SWIMGBot|Grobbot|eright|Apercite|semanticbot|Aboundex|domaincrawler|wbsearchbot|summify|CCBot|edisterbot|SeznamBot|ec2linkfinder|gslfbot|aiHitBot|intelium_bot|facebookexternalhit|Yeti|RetrevoPageAnalyzer|lb-spider|Sogou|lssbot|careerbot|wotbox|wocbot|ichiro|DuckDuckBot|lssrocketcrawler|drupact|webcompanycrawler|acoonbot|openindexspider|gnam gnam spider|web-archive-net\.com\.bot|backlinkcrawler|coccoc|integromedb|content crawler spider|toplistbot|it2media-domain-crawler|ip-web-crawler\.com|siteexplorer\.info|elisabot|proximic|changedetection|arabot|WeSEE:Search|niki-bot|CrystalSemanticsBot|rogerbot|360Spider|psbot|InterfaxScanBot|CC Metadata Scaper|g00g1e\.net|GrapeshotCrawler|urlappendbot|brainobot|fr-crawler|binlar|SimpleCrawler|Twitterbot|cXensebot|smtbot|bnf\.fr_bot|A6-Indexer|ADmantX|Facebot|OrangeBot\/|memorybot|AdvBot|MegaIndex|SemanticScholarBot|ltx71|nerdybot|xovibot|BUbiNG|Qwantify|archive\.org_bot|Applebot|TweetmemeBot|crawler4j|findxbot|S[eE][mM]rushBot|yoozBot|lipperhey|Y!J|Domain Re-Animator Bot|AddThis|Screaming Frog SEO Spider|MetaURI|Scrapy|Livelap[bB]ot|OpenHoseBot|CapsuleChecker|collection@infegy\.com|IstellaBot|DeuSu\/|betaBot|Cliqzbot\/|MojeekBot\/|netEstate NE Crawler|SafeSearch microdata crawler|Gluten Free Crawler\/|Sonic|Sysomos|Trove|deadlinkchecker|Slack-ImgProxy|Embedly|RankActiveLinkBot|iskanie|SafeDNSBot|SkypeUriPreview|Veoozbot|Slackbot|redditbot|datagnionbot|Google-Adwords-Instant|adbeat_bot|WhatsApp|contxbot|pinterest\.com\/bot|electricmonk|GarlikCrawler|BingPreview\/|vebidoobot|FemtosearchBot|Yahoo Link Preview|MetaJobBot|DomainStatsBot|mindUpBot|Daum\/|Jugendschutzprogramm-Crawler|Xenu Link Sleuth|Pcore-HTTP|moatbot|KosmioBot|[pP]ingdom|AppInsights|PhantomJS|Gowikibot|PiplBot|Discordbot|TelegramBot|Jetslide|newsharecounts|James BOT|Bark[rR]owler|TinEye|SocialRankIOBot|trendictionbot|Ocarinabot|epicbot|Primalbot|DuckDuckGo-Favicons-Bot|GnowitNewsbot|Leikibot|LinkArchiver|YaK\/|PaperLiBot|Digg Deeper|dcrawl|Snacktory|AndersPinkBot|Fyrebot|EveryoneSocialBot|Mediatoolkitbot|Luminator-robots|ExtLinksBot|SurveyBot|NING\/|okhttp|Nuzzel|omgili|PocketParser|YisouSpider|um-LN|ToutiaoSpider|MuckRack|Jamie's Spider|AHC\/|NetcraftSurveyAgent|Laserlikebot|^Apache-HttpClient|AppEngine-Google|Jetty|Upflow|Thinklab|Traackr\.com|Twurly|Mastodon|http_get|DnyzBot|botify|007ac9 Crawler|BehloolBot|BrandVerity|check_http|BDCbot|ZumBot|EZID|ICC-Crawler|ArchiveBot|^LCC |filterdb\.iss\.net\/crawler|BLP_bbot|BomboraBot|Buck\/|Companybook-Crawler|Genieo|magpie-crawler|MeltwaterNews|Moreover|newspaper\/|ScoutJet|(^| )sentry\/|StorygizeBot|UptimeRobot|OutclicksBot|seoscanners|Hatena|Google Web Preview|MauiBot|AlphaBot|SBL-BOT|IAS crawler|adscanner|Netvibes|acapbot|Baidu-YunGuanCe|bitlybot|blogmuraBot|Bot\.AraTurka\.com|bot-pge\.chlooe\.com|BoxcarBot|BTWebClient|ContextAd Bot|Digincore bot|Disqus|Feedly|Fetch\/|Fever|Flamingo_SearchEngine|FlipboardProxy|g2reader-bot|G2 Web Services|imrbot|K7MLWCBot|Kemvibot|Landau-Media-Spider|linkapediabot|vkShare|Siteimprove\.com|BLEXBot\/|DareBoost|ZuperlistBot\/|Miniflux\/|Feedspot|Diffbot\/|SEOkicks|tracemyfile|Nimbostratus-Bot|zgrab|PR-CY\.RU|AdsTxtCrawler|Datafeedwatch|Zabbix|TangibleeBot|google-xrawler|axios|Amazon CloudFront|Pulsepoint|CloudFlare-AlwaysOnline|Google-Structured-Data-Testing-Tool|WordupInfoSearch|WebDataStats|HttpUrlConnection|ZoomBot|VelenPublicWebCrawler|MoodleBot|jpg-newsbot|outbrain|W3C_Validator|Validator\.nu|W3C-checklink|W3C-mobileOK|W3C_I18n-Checker|FeedValidator|W3C_CSS_Validator|W3C_Unicorn|Google-PhysicalWeb|Blackboard|ICBot\/|BazQux|Twingly|Rivva|Experibot|awesomecrawler|Dataprovider\.com|GroupHigh\/|theoldreader\.com|AnyEvent|Uptimebot\.org|Nmap Scripting Engine|2ip\.ru|Clickagy|Caliperbot|MBCrawler|online-webceo-bot|B2B Bot|AddSearchBot|Google Favicon|HubSpot|Chrome-Lighthouse|HeadlessChrome|CheckMarkNetwork\/|www\.uptime\.com|Streamline3Bot\/|serpstatbot\/|MixnodeCache\/|^curl|SimpleScraper|RSSingBot|Jooblebot|fedoraplanet|Friendica|NextCloud|Tiny Tiny RSS|RegionStuttgartBot|Bytespider|Datanyze|Google-Site-Verification|TrendsmapResolver|tweetedtimes|NTENTbot|Gwene|SimplePie|SearchAtlas|Superfeedr|feedbot|UT-Dorkbot|Amazonbot|SerendeputyBot|Eyeotabot|officestorebot|Neticle Crawler|SurdotlyBot|LinkisBot|AwarioSmartBot|AwarioRssBot|RyteBot|FreeWebMonitoring SiteChecker|AspiegelBot|NAVER Blog Rssbot|zenback bot|SentiBot|Domains Project\/|Pandalytics|VKRobot|bidswitchbot|tigerbot|NIXStatsbot|Atom Feed Robot|[Cc]urebot|PagePeeker\/|Vigil\/|rssbot\/|startmebot\/|JobboerseBot|seewithkids|NINJA bot|Cutbot|BublupBot|BrandONbot|RidderBot|Taboolabot|Dubbotbot|FindITAnswersbot|infoobot|Refindbot|BlogTraffic\/\d\.\d+ Feed-Fetcher|SeobilityBot|Cincraw|Dragonbot|VoluumDSP-content-bot|FreshRSS|BitBot|^PHP-Curl-Class|Google-Certificates-Bridge|centurybot|Viber|e\.ventures Investment Crawler|evc-batch|PetalBot|virustotal|(^| )PTST\/|minicrawler|Cookiebot|trovitBot|seostar\.co|IonCrawl|Uptime-Kuma|Seekport|FreshpingBot|Feedbin|CriteoBot|Snap URL Preview Service|Better Uptime Bot|RuxitSynthetic|Google-Read-Aloud|Valve\/Steam|OdklBot\/|GPTBot|ChatGPT-User|YandexRenderResourcesBot\/|LightspeedSystemsCrawler|ev-crawler\/|BitSightBot\/|woorankreview\/|Google-Safety|AwarioBot|DataForSeoBot|Linespider|WellKnownBot|A Patent Crawler|StractBot|search\.marginalia\.nu|YouBot|Nicecrawler|Neevabot|BrightEdge Crawler|SiteCheckerBotCrawler|TombaPublicWebCrawler|CrawlyProjectCrawler|KomodiaBot|KStandBot|CISPA Webcrawler|MTRobot|hyscore\.io|AlexandriaOrgBot|2ip bot|Yellowbrandprotectionbot|SEOlizer|vuhuvBot|INETDEX-BOT|Synapse|t3versionsBot|deepnoc|Cocolyzebot|hypestat|ReverseEngineeringBot|sempi\.tech|Iframely|MetaInspector|node-fetch|lkxscan|python-opengraph|OpenGraphCheck|developers\.google\.com\/\+\/web\/snippet|SenutoBot|MaCoCu|NewsBlur|inoreader|NetSystemsResearch|PageThing|WordPress\/|PhxBot|ImagesiftBot|Expanse|InternetMeasurement|^BW\/|GeedoBot|Audisto Crawler|PerplexityBot\/|[cC]laude[bB]ot|Monsidobot|GroupMeBot|Vercelbot|vercel-screenshot/),jC=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|FBAN|FBAV|fennec|hiptop|iemobile|ip(hone|od)|Instagram|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i,UC=/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i,VC=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|FBAN|FBAV|fennec|hiptop|iemobile|ip(hone|od)|Instagram|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i,$C=/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i;const GC=[{name:"Samsung",regex:/SamsungBrowser/i},{name:"Edge",regex:/edg(?:[ea]|ios)?\//i},{name:"Firefox",regex:/firefox|iceweasel|fxios/i},{name:"Chrome",regex:/chrome|crios|crmo/i},{name:"Safari",regex:/safari|applewebkit/i}];function generateFlags(Re,Le={}){let Oe=!1,Ue=!1,qe=!1,Ct=!1;if("Amazon CloudFront"===Re)"true"===Le["cloudfront-is-mobile-viewer"]&&(Oe=!0,Ue=!0),"true"===Le["cloudfront-is-tablet-viewer"]&&(Oe=!1,Ue=!0),"true"===Le["cloudfront-is-desktop-viewer"]&&(Oe=!1,Ue=!1),"true"===Le["cloudfront-is-ios-viewer"]&&(qe=!0),"true"===Le["cloudfront-is-android-viewer"]&&(Ct=!0);else if(Le&&Le["cf-device-type"])switch(Le["cf-device-type"]){case"mobile":Oe=!0,Ue=!0;break;case"tablet":Oe=!1,Ue=!0;break;case"desktop":Oe=!1,Ue=!1}else Oe=function(Re){return jC.test(Re)||UC.test(Re.slice(0,4))}(Re),Ue=function(Re){return VC.test(Re)||$C.test(Re.slice(0,4))}(Re),qe=function(Re){return/iPad|iPhone|iPod/.test(Re)}(Re),Ct=function(Re){return/android/i.test(Re)}(Re);const Ot=function(Re){return/Windows/.test(Re)}(Re),Jt=function(Re){return/Mac OS X/.test(Re)}(Re),Hr=function(Re){for(const Le of GC)if(Le.regex.test(Re))return Le.name;return""}(Re);return{userAgent:Re,isMobile:Oe,isMobileOrTablet:Ue,isTablet:!Oe&&Ue,isDesktop:!Ue,isIos:qe,isAndroid:Ct,isWindows:Ot,isMacOS:Jt,isApple:Jt||qe,isDesktopOrTablet:!Oe,isSafari:"Safari"===Hr,isFirefox:"Firefox"===Hr,isEdge:"Edge"===Hr,isChrome:"Chrome"===Hr,isSamsung:"Samsung"===Hr,isCrawler:NC.test(Re)}}const qC=[GS,tE,nE,cE,hE,dE,DC,FC,defineNuxtPlugin((()=>{const Re=useRuntimeConfig().public.device.defaultUserAgent;let Le;{const Oe=useRequestHeaders();Le=reactive(generateFlags(Oe["user-agent"]||Re,Oe))}return{provide:{device:Le}}}))];function createLoadingIndicator(Re={}){const{duration:Le=2e3,throttle:Oe=200,hideDelay:Ue=500,resetDelay:qe=400}=Re;Re.estimatedProgress;const Ct=useNuxtApp(),Ot=ref(0),Jt=ref(!1),Hr=ref(!1);function set(Re=0){if(!Ct.isHydrating){if(Re>=100)return finish();Ot.value=Re<0?0:Re,Jt.value=!0}}function finish(Re={}){Ot.value=100,Re.error&&(Hr.value=!0),Re.force&&(Ot.value=0,Jt.value=!1)}return{_cleanup:()=>{},progress:computed((()=>Ot.value)),isLoading:computed((()=>Jt.value)),error:computed((()=>Hr.value)),start:()=>{Hr.value=!1,set(0)},set:set,finish:finish,clear:function(){}}}const HC=defineComponent({name:"NuxtLoadingIndicator",props:{throttle:{type:Number,default:200},duration:{type:Number,default:2e3},height:{type:Number,default:3},color:{type:[String,Boolean],default:"repeating-linear-gradient(to right,#00dc82 0%,#34cdfe 50%,#0047e1 100%)"},errorColor:{type:String,default:"repeating-linear-gradient(to right,#f87171 0%,#ef4444 100%)"},estimatedProgress:{type:Function,required:!1}},setup(Re,{slots:Le,expose:Oe}){const{progress:Ue,isLoading:qe,error:Ct,start:Ot,finish:Jt,clear:Hr}=function(Re={}){const Le=useNuxtApp();return Le._loadingIndicator=Le._loadingIndicator||createLoadingIndicator(Re)}({duration:Re.duration,throttle:Re.throttle,estimatedProgress:Re.estimatedProgress});return Oe({progress:Ue,isLoading:qe,error:Ct,start:Ot,finish:Jt,clear:Hr}),()=>h("div",{class:"nuxt-loading-indicator",style:{position:"fixed",top:0,right:0,left:0,pointerEvents:"none",width:"auto",height:`${Re.height}px`,opacity:qe.value?1:0,background:Ct.value?Re.errorColor:Re.color||void 0,backgroundSize:100/Ue.value*100+"% auto",transform:`scaleX(${Ue.value}%)`,transformOrigin:"left",transition:"transform 0.1s, height 0.4s, opacity 0.4s",zIndex:999999}},Le)}}),WC={default:()=>Promise.resolve().then((function(){return jk})),fullscreen:()=>Promise.resolve().then((function(){return $k}))},ZC=defineComponent({name:"LayoutLoader",inheritAttrs:!1,props:{name:String,layoutProps:Object},async setup(Re,Le){const Oe=await WC[Re.name]().then((Re=>Re.default||Re));return()=>h(Oe,Re.layoutProps,Le.slots)}}),XC=defineComponent({name:"NuxtLayout",inheritAttrs:!1,props:{name:{type:[String,Boolean,Object],default:null},fallback:{type:[String,Object],default:null}},setup(Re,Le){const Oe=useNuxtApp(),Ue=inject(VS),qe=Ue===useRoute()?inject(hS):Ue,Ct=computed((()=>{let Le=unref(Re.name)??qe.meta.layout??"default";return Le&&!(Le in WC)&&Re.fallback&&(Le=unref(Re.fallback)),Le})),Ot=ref();Le.expose({layoutRef:Ot});const Jt=Oe.deferHydration();return()=>{const Oe=Ct.value&&Ct.value in WC,Ue=qe.meta.layoutTransition??false;return _wrapIf(lw,Oe&&Ue,{default:()=>h(zb,{suspensible:!0,onResolve:()=>{nextTick$1(Jt)}},{default:()=>h(YC,{layoutProps:mergeProps(Le.attrs,{ref:Ot}),key:Ct.value||void 0,name:Ct.value,shouldProvide:!Re.name,hasTransition:!!Ue},Le.slots)})}).default()}}}),YC=defineComponent({name:"NuxtLayoutProvider",inheritAttrs:!1,props:{name:{type:[String,Boolean]},layoutProps:{type:Object},hasTransition:{type:Boolean},shouldProvide:{type:Boolean}},setup(Re,Le){const Oe=Re.name;return Re.shouldProvide&&provide(US,{isCurrent:Re=>Oe===(Re.meta.layout??"default")}),()=>{var Ue,qe;return!Oe||"string"==typeof Oe&&!(Oe in WC)?null==(qe=(Ue=Le.slots).default)?void 0:qe.call(Ue):h(ZC,{key:Oe,layoutProps:Re.layoutProps,name:Oe},Le.slots)}}}),KC=defineComponent({props:{vnode:{type:Object,required:!0},route:{type:Object,required:!0},vnodeRef:Object,renderKey:String,trackRootNodes:Boolean},setup(Re){const Le=Re.renderKey,Oe=Re.route,Ue={};for(const qe in Re.route)Object.defineProperty(Ue,qe,{get:()=>Le===Re.renderKey?Re.route[qe]:Oe[qe],enumerable:!0});return provide(VS,shallowReactive(Ue)),()=>h(Re.vnode,{ref:Re.vnodeRef})}}),JC=defineComponent({name:"NuxtPage",inheritAttrs:!1,props:{name:{type:String},transition:{type:[Boolean,Object],default:void 0},keepalive:{type:[Boolean,Object],default:void 0},route:{type:Object},pageKey:{type:[Function,String],default:null}},setup(Re,{attrs:Le,slots:Oe,expose:Ue}){const qe=useNuxtApp(),Ct=ref(),Ot=inject(VS,null);let Jt,Hr;Ue({pageRef:Ct}),inject(US,null);const Jr=qe.deferHydration();return Re.pageKey&&watch((()=>Re.pageKey),((Re,Le)=>{Re!==Le&&qe.callHook("page:loading:start")})),()=>h(gS,{name:Re.name,route:Re.route,...Le},{default:Le=>{if(!Le.Component)return void Jr();const Ue=((Re,Le)=>{const Oe=Re.route.matched.find((Le=>{var Oe;return(null==(Oe=Le.components)?void 0:Oe.default)===Re.Component.type})),Ue=Le??(null==Oe?void 0:Oe.meta.key)??(Oe&&(qe=Re.route,Oe.path.replace(/(:\w+)\([^)]+\)/g,"$1").replace(/(:\w+)[?+*]/g,"$1").replace(/:\w+/g,(Re=>{var Le;return(null==(Le=qe.params[Re.slice(1)])?void 0:Le.toString())||""}))));var qe;return"function"==typeof Ue?Ue(Re.route):Ue})(Le,Re.pageKey);qe.isHydrating||function(Re,Le,Oe){if(!Re)return!1;const Ue=Le.matched.findIndex((Re=>{var Le;return(null==(Le=Re.components)?void 0:Le.default)===(null==Oe?void 0:Oe.type)}));return Ue<Le.matched.length-1}(Ot,Le.route,Le.Component)||Jt!==Ue||qe.callHook("page:loading:end"),Jt=Ue;const Ln=!!(Re.transition??Le.route.meta.pageTransition??_S),Nn=Ln&&function(Re){const Le=Re.map((Re=>({...Re,onAfterLeave:Re.onAfterLeave?toArray(Re.onAfterLeave):void 0})));return Ql(...Le)}([Re.transition,Le.route.meta.pageTransition,_S,{onAfterLeave:()=>{qe.callHook("page:transition:finish",Le.Component)}}].filter(Boolean));Re.keepalive??Le.route.meta.keepalive;var $n;return Hr=_wrapIf(lw,Ln&&Nn,($n=h(zb,{suspensible:!0,onPending:()=>qe.callHook("page:start",Le.Component),onResolve:()=>{nextTick$1((()=>qe.callHook("page:finish",Le.Component).then((()=>qe.callHook("page:loading:end"))).finally(Jr)))}},{default:()=>h(KC,{key:Ue||void 0,vnode:Oe.default?h(Db,void 0,Oe.default(Le)):Le.Component,route:Le.route,renderKey:Ue||void 0,trackRootNodes:Ln,vnodeRef:Ct})}),{default:()=>$n})).default(),Hr}})}});const QC=defineComponent({__name:"app",__ssrInlineRender:!0,setup(Re){const{locale:Le,t:Oe}=useI18n();useHead({htmlAttrs:{lang:Le,dir:computed((()=>Oe("locale.dir")))},titleTemplate:Re=>Re?`${Re} - ${Oe("site.name")}`:`${Oe("site.name")}`});return useSeoMeta({title:useAppConfig().title}),(Re,Le,Oe,Ue)=>{const qe=HC,Ct=XC,Ot=JC;Le("\x3c!--[--\x3e"),Le(ssrRenderComponent(qe,null,null,Oe)),Le(ssrRenderComponent(Ct,null,{default:withCtx(((Re,Le,Oe,Ue)=>{if(!Le)return[createVNode(Ot)];Le(ssrRenderComponent(Ot,null,null,Oe,Ue))})),_:1},Oe)),Le("\x3c!--]--\x3e")}}}),eA=QC.setup;QC.setup=(Re,Le)=>{const Oe=useSSRContext();return(Oe.modules||(Oe.modules=new Set)).add("app.vue"),eA?eA(Re,Le):void 0};const tA=defineComponent({__name:"error",__ssrInlineRender:!0,props:{error:{type:Object,default:null}},setup:Re=>(Le,Oe,Ue,qe)=>{Oe(`<div${ssrRenderAttrs(mergeProps({class:"h-screen bg-slate-100 p-20 text-slate-900 dark:bg-slate-900 dark:text-white"},qe))}><div class="mx-auto w-auto max-w-md rounded-2xl bg-white p-6 text-center shadow-xl dark:bg-slate-800"><div class="relative flex flex-col justify-center gap-y-4 sm:h-40 sm:gap-y-5"><p class="mb-[-1em] font-semibold text-slate-500 dark:text-slate-400">${ssrInterpolate(Re.error.statusCode)}</p><h1 class="text-xl font-medium">`),404==Re.error.statusCode?Oe(`\x3c!--[--\x3e${ssrInterpolate(Le.$t("error.page-not-found"))}\x3c!--]--\x3e`):Oe(`\x3c!--[--\x3e${ssrInterpolate(Re.error.message)}\x3c!--]--\x3e`),Oe(`</h1><button class="mx-auto mt-3 w-[10rem] rounded-lg border border-slate-200 bg-gray-50 p-4 py-2.5 text-gray-700 hover:cursor-pointer hover:border-slate-200 hover:bg-slate-100 dark:border-gray-700 dark:bg-slate-800 dark:text-white dark:hover:bg-slate-700">${ssrInterpolate(Le.$t("error.return"))}</button></div></div></div>`)}}),rA=tA.setup;tA.setup=(Re,Le)=>{const Oe=useSSRContext();return(Oe.modules||(Oe.modules=new Set)).add("error.vue"),rA?rA(Re,Le):void 0};const nA={__name:"nuxt-root",__ssrInlineRender:!0,setup(Re){const IslandRenderer=()=>null,Le=useNuxtApp();Le.deferHydration(),Le.ssrContext.url;const Oe=!1;provide(VS,useRoute()),Le.hooks.callHookWith((Re=>Re.map((Re=>Re()))),"vue:setup");const Ue=useError(),qe=Ue.value&&!Le.ssrContext.error;onErrorCaptured(((Re,Oe,Ue)=>{Le.hooks.callHook("vue:error",Re,Oe,Ue).catch((Re=>console.error("[nuxt] Error in `vue:error` hook",Re)));{const Oe=Le.runWithContext((()=>showError(Re)));return vb((()=>Oe)),!1}}));const Ct=Le.ssrContext.islandContext;return(Re,Le,Ot,Jt)=>{!async function(Re,{default:Le}){Le?Le():Re("\x3c!----\x3e")}(Le,{default:()=>{unref(qe)?Le("<div></div>"):unref(Ue)?Le(ssrRenderComponent(unref(tA),{error:unref(Ue)},null,Ot)):unref(Ct)?Le(ssrRenderComponent(unref(IslandRenderer),{context:unref(Ct)},null,Ot)):unref(Oe)?renderVNode(Le,createVNode(resolveDynamicComponent(unref(Oe)),null,null),Ot):Le(ssrRenderComponent(unref(QC),null,null,Ot))},_:1})}}},iA=nA.setup;let oA;nA.setup=(Re,Le)=>{const Oe=useSSRContext();return(Oe.modules||(Oe.modules=new Set)).add("node_modules/nuxt/dist/app/components/nuxt-root.vue"),iA?iA(Re,Le):void 0},oA=async function(Re){const Le=createApp(nA),Oe=function(Re){var Le;let Oe=0;const Ue={_id:Re.id||bS||"nuxt-app",_scope:effectScope(),provide:void 0,globalName:"nuxt",versions:{get nuxt(){return"3.13.2"},get vue(){return Ue.vueApp.version}},payload:shallowReactive({...(null==(Le=Re.ssrContext)?void 0:Le.payload)||{},data:shallowReactive({}),state:reactive({}),once:new Set,_errors:shallowReactive({})}),static:{data:{}},runWithContext:Re=>Ue._scope.active&&!getCurrentScope()?Ue._scope.run((()=>callWithNuxt(Ue,Re))):callWithNuxt(Ue,Re),isHydrating:!1,deferHydration(){if(!Ue.isHydrating)return()=>{};Oe++;let Re=!1;return()=>{if(!Re)return Re=!0,Oe--,0===Oe?(Ue.isHydrating=!1,Ue.callHook("app:suspense:resolve")):void 0}},_asyncDataPromises:{},_asyncData:shallowReactive({}),_payloadRevivers:{},...Re};Ue.payload.serverRendered=!0,Ue.ssrContext&&(Ue.payload.path=Ue.ssrContext.url,Ue.ssrContext.nuxt=Ue,Ue.ssrContext.payload=Ue.payload,Ue.ssrContext.config={public:Ue.ssrContext.runtimeConfig.public,app:Ue.ssrContext.runtimeConfig.app}),Ue.hooks=createHooks(),Ue.hook=Ue.hooks.hook;{const contextCaller=async function(Re,Le){for(const Oe of Re)await Ue.runWithContext((()=>Oe(...Le)))};Ue.hooks.callHook=(Re,...Le)=>Ue.hooks.callHookWith(contextCaller,Re,...Le)}Ue.callHook=Ue.hooks.callHook,Ue.provide=(Re,Le)=>{const Oe="$"+Re;defineGetter$1(Ue,Oe,Le),defineGetter$1(Ue.vueApp.config.globalProperties,Oe,Le)},defineGetter$1(Ue.vueApp,"$nuxt",Ue),defineGetter$1(Ue.vueApp.config.globalProperties,"$nuxt",Ue);const qe=Re.ssrContext.runtimeConfig;return Ue.provide("config",qe),Ue}({vueApp:Le,ssrContext:Re});try{await async function(Re,Le){var Oe,Ue,qe,Ct;const Ot=[],Jt=[],Hr=[],Jr=[];let Ln=0;async function executePlugin(Oe){var Ue;const qe=(null==(Ue=Oe.dependsOn)?void 0:Ue.filter((Re=>Le.some((Le=>Le._name===Re))&&!Ot.includes(Re))))??[];if(qe.length>0)Jt.push([new Set(qe),Oe]);else{const Le=async function(Re,Le){if("function"==typeof Le){const{provide:Oe}=await Re.runWithContext((()=>Le(Re)))||{};if(Oe&&"object"==typeof Oe)for(const Le in Oe)Re.provide(Le,Oe[Le])}}(Re,Oe).then((async()=>{Oe._name&&(Ot.push(Oe._name),await Promise.all(Jt.map((async([Re,Le])=>{Re.has(Oe._name)&&(Re.delete(Oe._name),0===Re.size&&(Ln++,await executePlugin(Le)))}))))}));Oe.parallel?Hr.push(Le.catch((Re=>Jr.push(Re)))):await Le}}for(const qe of Le)(null==(Oe=Re.ssrContext)?void 0:Oe.islandContext)&&!1===(null==(Ue=qe.env)?void 0:Ue.islands)||registerPluginHooks(Re,qe);for(const Oe of Le)(null==(qe=Re.ssrContext)?void 0:qe.islandContext)&&!1===(null==(Ct=Oe.env)?void 0:Ct.islands)||await executePlugin(Oe);if(await Promise.all(Hr),Ln)for(let Re=0;Re<Ln;Re++)await Promise.all(Hr);if(Jr.length)throw Jr[0]}(Oe,qC),await Oe.hooks.callHook("app:created",Le)}catch(Re){await Oe.hooks.callHook("app:error",Re),Oe.payload.error=Oe.payload.error||createError(Re)}if(null==Re?void 0:Re._renderResponse)throw new Error("skipping render");return Le};const sA=Object.freeze(Object.defineProperty({__proto__:null,a:useRoute,b:useNuxtApp,c:vS,d:createError,default:Re=>oA(Re),e:useRequestFetch,f:xS,g:useAppConfig,h:useState,i:useRequestEvent,j:hasProtocol,k:joinURL,l:encodeParam,m:encodePath,n:useRuntimeConfig,o:useLocaleHead,p:parseURL,q:useRouter,r:parseQuery,s:yS,t:resolveRouteObject,u:useI18n,v:navigateTo,w:withLeadingSlash,x:withTrailingSlash,y:withoutTrailingSlash},Symbol.toStringTag,{value:"Module"})),interopDefault=Re=>Re.default||Re||[],aA={"node_modules/nuxt/dist/app/entry.js":()=>Promise.resolve().then((function(){return Hk})).then(interopDefault),"app.vue":()=>Promise.resolve().then((function(){return Zk})).then(interopDefault),"app.vue?vue&type=style&index=0&lang.css":()=>Promise.resolve().then((function(){return Yk})).then(interopDefault),"components/TravelCard.vue":()=>Promise.resolve().then((function(){return Qk})).then(interopDefault),"components/TravelCard.vue?vue&type=style&index=0&lang.postcss":()=>Promise.resolve().then((function(){return tM})).then(interopDefault),"node_modules/nuxt-icon/dist/runtime/IconCSS.vue":()=>Promise.resolve().then((function(){return iM})).then(interopDefault),"node_modules/nuxt-icon/dist/runtime/IconCSS.vue?vue&type=style&index=0&scoped=41e8d397&lang.css":()=>Promise.resolve().then((function(){return sM})).then(interopDefault),"node_modules/nuxt-icon/dist/runtime/Icon.vue":()=>Promise.resolve().then((function(){return cM})).then(interopDefault),"node_modules/nuxt-icon/dist/runtime/Icon.vue?vue&type=style&index=0&scoped=e8d572f6&lang.css":()=>Promise.resolve().then((function(){return hM})).then(interopDefault),"components/MapComponent.vue":()=>Promise.resolve().then((function(){return fM})).then(interopDefault),"components/MapComponent.vue?vue&type=style&index=0&lang.css":()=>Promise.resolve().then((function(){return gM})).then(interopDefault),"node_modules/nuxt-rating/dist/runtime/components/NuxtRating.vue":()=>Promise.resolve().then((function(){return vM})).then(interopDefault),"node_modules/nuxt-rating/dist/runtime/components/NuxtRating.vue?vue&type=style&index=0&scoped=038f2b51&lang.css":()=>Promise.resolve().then((function(){return bM})).then(interopDefault),"components/HeaderComponent.vue":()=>Promise.resolve().then((function(){return SM})).then(interopDefault),"components/HeaderComponent.vue?vue&type=style&index=0&lang.postcss":()=>Promise.resolve().then((function(){return CM})).then(interopDefault),"node_modules/nuxt-rating/dist/runtime/components/NuxtStar.vue":()=>Promise.resolve().then((function(){return kM})).then(interopDefault),"node_modules/nuxt-rating/dist/runtime/components/NuxtStar.vue?vue&type=style&index=0&scoped=f0c63eac&lang.css":()=>Promise.resolve().then((function(){return PM})).then(interopDefault)},lA=Object.freeze(Object.defineProperty({__proto__:null,default:aA},Symbol.toStringTag,{value:"Module"})),cA=Object.freeze(Object.defineProperty({__proto__:null,template:""},Symbol.toStringTag,{value:"Module"})),uA={__name:"about",__ssrInlineRender:!0,setup(Re){const{t:Le}=useI18n();return useHead({title:Le("pages.about.meta.title"),meta:[{name:"description",content:Le("pages.about.meta.description")}]}),useSeoMeta({title:Le("pages.about.meta.title"),description:Le("pages.about.meta.description")}),(Re,Le,Oe,Ue)=>{Le(`<div${ssrRenderAttrs(mergeProps({class:"p-5"},Ue))}><h1 class="text-4xl text-black">${ssrInterpolate(Re.$t("pages.about.title"))}</h1><main class="mt-4 text-black [&amp;&gt;*]:mb-4"><p>${ssrInterpolate(Re.$t("pages.about.p"))}</p><p>${ssrInterpolate(Re.$t("pages.about.p"))}</p><p>${ssrInterpolate(Re.$t("pages.about.p"))} ${ssrInterpolate(Re.$t("pages.about.p"))}</p><p>${ssrInterpolate(Re.$t("pages.about.p"))}</p></main></div>`)}}},hA=uA.setup;uA.setup=(Re,Le)=>{const Oe=useSSRContext();return(Oe.modules||(Oe.modules=new Set)).add("pages/about.vue"),hA?hA(Re,Le):void 0};const dA=Object.freeze(Object.defineProperty({__proto__:null,default:uA},Symbol.toStringTag,{value:"Module"})),_export_sfc=(Re,Le)=>{const Oe=Re.__vccOpts||Re;for(const[Re,Ue]of Le)Oe[Re]=Ue;return Oe};function isObject$2(Re){return null!==Re&&"object"==typeof Re&&"constructor"in Re&&Re.constructor===Object}function extend$2(Re,Le){void 0===Re&&(Re={}),void 0===Le&&(Le={}),Object.keys(Le).forEach((Oe=>{void 0===Re[Oe]?Re[Oe]=Le[Oe]:isObject$2(Le[Oe])&&isObject$2(Re[Oe])&&Object.keys(Le[Oe]).length>0&&extend$2(Re[Oe],Le[Oe])}))}const pA={body:{},addEventListener(){},removeEventListener(){},activeElement:{blur(){},nodeName:""},querySelector:()=>null,querySelectorAll:()=>[],getElementById:()=>null,createEvent:()=>({initEvent(){}}),createElement:()=>({children:[],childNodes:[],style:{},setAttribute(){},getElementsByTagName:()=>[]}),createElementNS:()=>({}),importNode:()=>null,location:{hash:"",host:"",hostname:"",href:"",origin:"",pathname:"",protocol:"",search:""}};function getDocument(){const Re="undefined"!=typeof document?document:{};return extend$2(Re,pA),Re}const fA={document:pA,navigator:{userAgent:""},location:{hash:"",host:"",hostname:"",href:"",origin:"",pathname:"",protocol:"",search:""},history:{replaceState(){},pushState(){},go(){},back(){}},CustomEvent:function(){return this},addEventListener(){},removeEventListener(){},getComputedStyle:()=>({getPropertyValue:()=>""}),Image(){},Date(){},screen:{},setTimeout(){},clearTimeout(){},matchMedia:()=>({}),requestAnimationFrame:Re=>"undefined"==typeof setTimeout?(Re(),null):setTimeout(Re,0),cancelAnimationFrame(Re){"undefined"!=typeof setTimeout&&clearTimeout(Re)}};function getWindow(){const Re={};return extend$2(Re,fA),Re}function nextTick(Re,Le){return void 0===Le&&(Le=0),setTimeout(Re,Le)}function now(){return Date.now()}function getTranslate(Re,Le){void 0===Le&&(Le="x");const Oe=getWindow();let Ue,qe,Ct;const Ot=function(Re){const Le=getWindow();let Oe;return Le.getComputedStyle&&(Oe=Le.getComputedStyle(Re,null)),!Oe&&Re.currentStyle&&(Oe=Re.currentStyle),Oe||(Oe=Re.style),Oe}(Re);return Oe.WebKitCSSMatrix?(qe=Ot.transform||Ot.webkitTransform,qe.split(",").length>6&&(qe=qe.split(", ").map((Re=>Re.replace(",","."))).join(", ")),Ct=new Oe.WebKitCSSMatrix("none"===qe?"":qe)):(Ct=Ot.MozTransform||Ot.OTransform||Ot.MsTransform||Ot.msTransform||Ot.transform||Ot.getPropertyValue("transform").replace("translate(","matrix(1, 0, 0, 1,"),Ue=Ct.toString().split(",")),"x"===Le&&(qe=Oe.WebKitCSSMatrix?Ct.m41:16===Ue.length?parseFloat(Ue[12]):parseFloat(Ue[4])),"y"===Le&&(qe=Oe.WebKitCSSMatrix?Ct.m42:16===Ue.length?parseFloat(Ue[13]):parseFloat(Ue[5])),qe||0}function isObject$1(Re){return"object"==typeof Re&&null!==Re&&Re.constructor&&"Object"===Object.prototype.toString.call(Re).slice(8,-1)}function isNode(Re){return Re&&(1===Re.nodeType||11===Re.nodeType)}function extend$1(){const Re=Object(arguments.length<=0?void 0:arguments[0]),Le=["__proto__","constructor","prototype"];for(let Oe=1;Oe<arguments.length;Oe+=1){const Ue=Oe<0||arguments.length<=Oe?void 0:arguments[Oe];if(null!=Ue&&!isNode(Ue)){const Oe=Object.keys(Object(Ue)).filter((Re=>Le.indexOf(Re)<0));for(let Le=0,qe=Oe.length;Le<qe;Le+=1){const qe=Oe[Le],Ct=Object.getOwnPropertyDescriptor(Ue,qe);void 0!==Ct&&Ct.enumerable&&(isObject$1(Re[qe])&&isObject$1(Ue[qe])?Ue[qe].__swiper__?Re[qe]=Ue[qe]:extend$1(Re[qe],Ue[qe]):!isObject$1(Re[qe])&&isObject$1(Ue[qe])?(Re[qe]={},Ue[qe].__swiper__?Re[qe]=Ue[qe]:extend$1(Re[qe],Ue[qe])):Re[qe]=Ue[qe])}}}return Re}function setCSSProperty(Re,Le,Oe){Re.style.setProperty(Le,Oe)}function animateCSSModeScroll(Re){let{swiper:Le,targetPosition:Oe,side:Ue}=Re;const qe=getWindow(),Ct=-Le.translate;let Ot,Jt=null;const Hr=Le.params.speed;Le.wrapperEl.style.scrollSnapType="none",qe.cancelAnimationFrame(Le.cssModeFrameID);const Jr=Oe>Ct?"next":"prev",isOutOfBound=(Re,Le)=>"next"===Jr&&Re>=Le||"prev"===Jr&&Re<=Le,animate=()=>{Ot=(new Date).getTime(),null===Jt&&(Jt=Ot);const Re=Math.max(Math.min((Ot-Jt)/Hr,1),0),Jr=.5-Math.cos(Re*Math.PI)/2;let Ln=Ct+Jr*(Oe-Ct);if(isOutOfBound(Ln,Oe)&&(Ln=Oe),Le.wrapperEl.scrollTo({[Ue]:Ln}),isOutOfBound(Ln,Oe))return Le.wrapperEl.style.overflow="hidden",Le.wrapperEl.style.scrollSnapType="",setTimeout((()=>{Le.wrapperEl.style.overflow="",Le.wrapperEl.scrollTo({[Ue]:Ln})})),void qe.cancelAnimationFrame(Le.cssModeFrameID);Le.cssModeFrameID=qe.requestAnimationFrame(animate)};animate()}function elementChildren(Re,Le){void 0===Le&&(Le="");const Oe=[...Re.children];return Re instanceof HTMLSlotElement&&Oe.push(...Re.assignedElements()),Le?Oe.filter((Re=>Re.matches(Le))):Oe}function showWarning(Re){try{return void console.warn(Re)}catch(Re){}}function createElement(Re,Le){void 0===Le&&(Le=[]);const Oe=document.createElement(Re);return Oe.classList.add(...Array.isArray(Le)?Le:function(Re){return void 0===Re&&(Re=""),Re.trim().split(" ").filter((Re=>!!Re.trim()))}(Le)),Oe}function elementStyle(Re,Le){return getWindow().getComputedStyle(Re,null).getPropertyValue(Le)}function elementIndex(Re){let Le,Oe=Re;if(Oe){for(Le=0;null!==(Oe=Oe.previousSibling);)1===Oe.nodeType&&(Le+=1);return Le}}function elementOuterSize(Re,Le,Oe){const Ue=getWindow();return Re["width"===Le?"offsetWidth":"offsetHeight"]+parseFloat(Ue.getComputedStyle(Re,null).getPropertyValue("width"===Le?"margin-right":"margin-top"))+parseFloat(Ue.getComputedStyle(Re,null).getPropertyValue("width"===Le?"margin-left":"margin-bottom"))}let mA,gA,_A;function getSupport(){return mA||(mA=function(){const Re=getWindow(),Le=getDocument();return{smoothScroll:Le.documentElement&&Le.documentElement.style&&"scrollBehavior"in Le.documentElement.style,touch:!!("ontouchstart"in Re||Re.DocumentTouch&&Le instanceof Re.DocumentTouch)}}()),mA}function getDevice(Re){return void 0===Re&&(Re={}),gA||(gA=function(Re){let{userAgent:Le}=void 0===Re?{}:Re;const Oe=getSupport(),Ue=getWindow(),qe=Ue.navigator.platform,Ct=Le||Ue.navigator.userAgent,Ot={ios:!1,android:!1},Jt=Ue.screen.width,Hr=Ue.screen.height,Jr=Ct.match(/(Android);?[\s\/]+([\d.]+)?/);let Ln=Ct.match(/(iPad).*OS\s([\d_]+)/);const Nn=Ct.match(/(iPod)(.*OS\s([\d_]+))?/),$n=!Ln&&Ct.match(/(iPhone\sOS|iOS)\s([\d_]+)/),Gn="Win32"===qe;let qn="MacIntel"===qe;return!Ln&&qn&&Oe.touch&&["1024x1366","1366x1024","834x1194","1194x834","834x1112","1112x834","768x1024","1024x768","820x1180","1180x820","810x1080","1080x810"].indexOf(`${Jt}x${Hr}`)>=0&&(Ln=Ct.match(/(Version)\/([\d.]+)/),Ln||(Ln=[0,1,"13_0_0"]),qn=!1),Jr&&!Gn&&(Ot.os="android",Ot.android=!0),(Ln||$n||Nn)&&(Ot.os="ios",Ot.ios=!0),Ot}(Re)),gA}function getBrowser(){return _A||(_A=function(){const Re=getWindow(),Le=getDevice();let Oe=!1;function isSafari(){const Le=Re.navigator.userAgent.toLowerCase();return Le.indexOf("safari")>=0&&Le.indexOf("chrome")<0&&Le.indexOf("android")<0}if(isSafari()){const Le=String(Re.navigator.userAgent);if(Le.includes("Version/")){const[Re,Ue]=Le.split("Version/")[1].split(" ")[0].split(".").map((Re=>Number(Re)));Oe=Re<16||16===Re&&Ue<2}}const Ue=/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(Re.navigator.userAgent),qe=isSafari();return{isSafari:Oe||qe,needPerspectiveFix:Oe,need3dFix:qe||Ue&&Le.ios,isWebView:Ue}}()),_A}var yA={on(Re,Le,Oe){const Ue=this;if(!Ue.eventsListeners||Ue.destroyed)return Ue;if("function"!=typeof Le)return Ue;const qe=Oe?"unshift":"push";return Re.split(" ").forEach((Re=>{Ue.eventsListeners[Re]||(Ue.eventsListeners[Re]=[]),Ue.eventsListeners[Re][qe](Le)})),Ue},once(Re,Le,Oe){const Ue=this;if(!Ue.eventsListeners||Ue.destroyed)return Ue;if("function"!=typeof Le)return Ue;function onceHandler(){Ue.off(Re,onceHandler),onceHandler.__emitterProxy&&delete onceHandler.__emitterProxy;for(var Oe=arguments.length,qe=new Array(Oe),Ct=0;Ct<Oe;Ct++)qe[Ct]=arguments[Ct];Le.apply(Ue,qe)}return onceHandler.__emitterProxy=Le,Ue.on(Re,onceHandler,Oe)},onAny(Re,Le){const Oe=this;if(!Oe.eventsListeners||Oe.destroyed)return Oe;if("function"!=typeof Re)return Oe;const Ue=Le?"unshift":"push";return Oe.eventsAnyListeners.indexOf(Re)<0&&Oe.eventsAnyListeners[Ue](Re),Oe},offAny(Re){const Le=this;if(!Le.eventsListeners||Le.destroyed)return Le;if(!Le.eventsAnyListeners)return Le;const Oe=Le.eventsAnyListeners.indexOf(Re);return Oe>=0&&Le.eventsAnyListeners.splice(Oe,1),Le},off(Re,Le){const Oe=this;return!Oe.eventsListeners||Oe.destroyed?Oe:Oe.eventsListeners?(Re.split(" ").forEach((Re=>{void 0===Le?Oe.eventsListeners[Re]=[]:Oe.eventsListeners[Re]&&Oe.eventsListeners[Re].forEach(((Ue,qe)=>{(Ue===Le||Ue.__emitterProxy&&Ue.__emitterProxy===Le)&&Oe.eventsListeners[Re].splice(qe,1)}))})),Oe):Oe},emit(){const Re=this;if(!Re.eventsListeners||Re.destroyed)return Re;if(!Re.eventsListeners)return Re;let Le,Oe,Ue;for(var qe=arguments.length,Ct=new Array(qe),Ot=0;Ot<qe;Ot++)Ct[Ot]=arguments[Ot];"string"==typeof Ct[0]||Array.isArray(Ct[0])?(Le=Ct[0],Oe=Ct.slice(1,Ct.length),Ue=Re):(Le=Ct[0].events,Oe=Ct[0].data,Ue=Ct[0].context||Re),Oe.unshift(Ue);return(Array.isArray(Le)?Le:Le.split(" ")).forEach((Le=>{Re.eventsAnyListeners&&Re.eventsAnyListeners.length&&Re.eventsAnyListeners.forEach((Re=>{Re.apply(Ue,[Le,...Oe])})),Re.eventsListeners&&Re.eventsListeners[Le]&&Re.eventsListeners[Le].forEach((Re=>{Re.apply(Ue,Oe)}))})),Re}};const toggleSlideClasses$1=(Re,Le,Oe)=>{Le&&!Re.classList.contains(Oe)?Re.classList.add(Oe):!Le&&Re.classList.contains(Oe)&&Re.classList.remove(Oe)};const toggleSlideClasses=(Re,Le,Oe)=>{Le&&!Re.classList.contains(Oe)?Re.classList.add(Oe):!Le&&Re.classList.contains(Oe)&&Re.classList.remove(Oe)};const processLazyPreloader=(Re,Le)=>{if(!Re||Re.destroyed||!Re.params)return;const Oe=Le.closest(Re.isElement?"swiper-slide":`.${Re.params.slideClass}`);if(Oe){let Le=Oe.querySelector(`.${Re.params.lazyPreloaderClass}`);!Le&&Re.isElement&&(Oe.shadowRoot?Le=Oe.shadowRoot.querySelector(`.${Re.params.lazyPreloaderClass}`):requestAnimationFrame((()=>{Oe.shadowRoot&&(Le=Oe.shadowRoot.querySelector(`.${Re.params.lazyPreloaderClass}`),Le&&Le.remove())}))),Le&&Le.remove()}},unlazy=(Re,Le)=>{if(!Re.slides[Le])return;const Oe=Re.slides[Le].querySelector('[loading="lazy"]');Oe&&Oe.removeAttribute("loading")},preload=Re=>{if(!Re||Re.destroyed||!Re.params)return;let Le=Re.params.lazyPreloadPrevNext;const Oe=Re.slides.length;if(!Oe||!Le||Le<0)return;Le=Math.min(Le,Oe);const Ue="auto"===Re.params.slidesPerView?Re.slidesPerViewDynamic():Math.ceil(Re.params.slidesPerView),qe=Re.activeIndex;if(Re.params.grid&&Re.params.grid.rows>1){const Oe=qe,Ct=[Oe-Le];return Ct.push(...Array.from({length:Le}).map(((Re,Le)=>Oe+Ue+Le))),void Re.slides.forEach(((Le,Oe)=>{Ct.includes(Le.column)&&unlazy(Re,Oe)}))}const Ct=qe+Ue-1;if(Re.params.rewind||Re.params.loop)for(let Ue=qe-Le;Ue<=Ct+Le;Ue+=1){const Le=(Ue%Oe+Oe)%Oe;(Le<qe||Le>Ct)&&unlazy(Re,Le)}else for(let Ue=Math.max(qe-Le,0);Ue<=Math.min(Ct+Le,Oe-1);Ue+=1)Ue!==qe&&(Ue>Ct||Ue<qe)&&unlazy(Re,Ue)};var vA={updateSize:function(){const Re=this;let Le,Oe;const Ue=Re.el;Le=void 0!==Re.params.width&&null!==Re.params.width?Re.params.width:Ue.clientWidth,Oe=void 0!==Re.params.height&&null!==Re.params.height?Re.params.height:Ue.clientHeight,0===Le&&Re.isHorizontal()||0===Oe&&Re.isVertical()||(Le=Le-parseInt(elementStyle(Ue,"padding-left")||0,10)-parseInt(elementStyle(Ue,"padding-right")||0,10),Oe=Oe-parseInt(elementStyle(Ue,"padding-top")||0,10)-parseInt(elementStyle(Ue,"padding-bottom")||0,10),Number.isNaN(Le)&&(Le=0),Number.isNaN(Oe)&&(Oe=0),Object.assign(Re,{width:Le,height:Oe,size:Re.isHorizontal()?Le:Oe}))},updateSlides:function(){const Re=this;function getDirectionPropertyValue(Le,Oe){return parseFloat(Le.getPropertyValue(Re.getDirectionLabel(Oe))||0)}const Le=Re.params,{wrapperEl:Oe,slidesEl:Ue,size:qe,rtlTranslate:Ct,wrongRTL:Ot}=Re,Jt=Re.virtual&&Le.virtual.enabled,Hr=Jt?Re.virtual.slides.length:Re.slides.length,Jr=elementChildren(Ue,`.${Re.params.slideClass}, swiper-slide`),Ln=Jt?Re.virtual.slides.length:Jr.length;let Nn=[];const $n=[],Gn=[];let qn=Le.slidesOffsetBefore;"function"==typeof qn&&(qn=Le.slidesOffsetBefore.call(Re));let Zn=Le.slidesOffsetAfter;"function"==typeof Zn&&(Zn=Le.slidesOffsetAfter.call(Re));const Xn=Re.snapGrid.length,Yn=Re.slidesGrid.length;let _i=Le.spaceBetween,vi=-qn,xi=0,bi=0;if(void 0===qe)return;"string"==typeof _i&&_i.indexOf("%")>=0?_i=parseFloat(_i.replace("%",""))/100*qe:"string"==typeof _i&&(_i=parseFloat(_i)),Re.virtualSize=-_i,Jr.forEach((Re=>{Ct?Re.style.marginLeft="":Re.style.marginRight="",Re.style.marginBottom="",Re.style.marginTop=""})),Le.centeredSlides&&Le.cssMode&&(setCSSProperty(Oe,"--swiper-centered-offset-before",""),setCSSProperty(Oe,"--swiper-centered-offset-after",""));const Pi=Le.grid&&Le.grid.rows>1&&Re.grid;let lo;Pi?Re.grid.initSlides(Jr):Re.grid&&Re.grid.unsetSlides();const uo="auto"===Le.slidesPerView&&Le.breakpoints&&Object.keys(Le.breakpoints).filter((Re=>void 0!==Le.breakpoints[Re].slidesPerView)).length>0;for(let Oe=0;Oe<Ln;Oe+=1){let Ue;if(lo=0,Jr[Oe]&&(Ue=Jr[Oe]),Pi&&Re.grid.updateSlide(Oe,Ue,Jr),!Jr[Oe]||"none"!==elementStyle(Ue,"display")){if("auto"===Le.slidesPerView){uo&&(Jr[Oe].style[Re.getDirectionLabel("width")]="");const qe=getComputedStyle(Ue),Ct=Ue.style.transform,Ot=Ue.style.webkitTransform;if(Ct&&(Ue.style.transform="none"),Ot&&(Ue.style.webkitTransform="none"),Le.roundLengths)lo=Re.isHorizontal()?elementOuterSize(Ue,"width"):elementOuterSize(Ue,"height");else{const Re=getDirectionPropertyValue(qe,"width"),Le=getDirectionPropertyValue(qe,"padding-left"),Oe=getDirectionPropertyValue(qe,"padding-right"),Ct=getDirectionPropertyValue(qe,"margin-left"),Ot=getDirectionPropertyValue(qe,"margin-right"),Jt=qe.getPropertyValue("box-sizing");if(Jt&&"border-box"===Jt)lo=Re+Ct+Ot;else{const{clientWidth:qe,offsetWidth:Jt}=Ue;lo=Re+Le+Oe+Ct+Ot+(Jt-qe)}}Ct&&(Ue.style.transform=Ct),Ot&&(Ue.style.webkitTransform=Ot),Le.roundLengths&&(lo=Math.floor(lo))}else lo=(qe-(Le.slidesPerView-1)*_i)/Le.slidesPerView,Le.roundLengths&&(lo=Math.floor(lo)),Jr[Oe]&&(Jr[Oe].style[Re.getDirectionLabel("width")]=`${lo}px`);Jr[Oe]&&(Jr[Oe].swiperSlideSize=lo),Gn.push(lo),Le.centeredSlides?(vi=vi+lo/2+xi/2+_i,0===xi&&0!==Oe&&(vi=vi-qe/2-_i),0===Oe&&(vi=vi-qe/2-_i),Math.abs(vi)<.001&&(vi=0),Le.roundLengths&&(vi=Math.floor(vi)),bi%Le.slidesPerGroup==0&&Nn.push(vi),$n.push(vi)):(Le.roundLengths&&(vi=Math.floor(vi)),(bi-Math.min(Re.params.slidesPerGroupSkip,bi))%Re.params.slidesPerGroup==0&&Nn.push(vi),$n.push(vi),vi=vi+lo+_i),Re.virtualSize+=lo+_i,xi=lo,bi+=1}}if(Re.virtualSize=Math.max(Re.virtualSize,qe)+Zn,Ct&&Ot&&("slide"===Le.effect||"coverflow"===Le.effect)&&(Oe.style.width=`${Re.virtualSize+_i}px`),Le.setWrapperSize&&(Oe.style[Re.getDirectionLabel("width")]=`${Re.virtualSize+_i}px`),Pi&&Re.grid.updateWrapperSize(lo,Nn),!Le.centeredSlides){const Oe=[];for(let Ue=0;Ue<Nn.length;Ue+=1){let Ct=Nn[Ue];Le.roundLengths&&(Ct=Math.floor(Ct)),Nn[Ue]<=Re.virtualSize-qe&&Oe.push(Ct)}Nn=Oe,Math.floor(Re.virtualSize-qe)-Math.floor(Nn[Nn.length-1])>1&&Nn.push(Re.virtualSize-qe)}if(Jt&&Le.loop){const Oe=Gn[0]+_i;if(Le.slidesPerGroup>1){const Ue=Math.ceil((Re.virtual.slidesBefore+Re.virtual.slidesAfter)/Le.slidesPerGroup),qe=Oe*Le.slidesPerGroup;for(let Re=0;Re<Ue;Re+=1)Nn.push(Nn[Nn.length-1]+qe)}for(let Ue=0;Ue<Re.virtual.slidesBefore+Re.virtual.slidesAfter;Ue+=1)1===Le.slidesPerGroup&&Nn.push(Nn[Nn.length-1]+Oe),$n.push($n[$n.length-1]+Oe),Re.virtualSize+=Oe}if(0===Nn.length&&(Nn=[0]),0!==_i){const Oe=Re.isHorizontal()&&Ct?"marginLeft":Re.getDirectionLabel("marginRight");Jr.filter(((Re,Oe)=>!(Le.cssMode&&!Le.loop)||Oe!==Jr.length-1)).forEach((Re=>{Re.style[Oe]=`${_i}px`}))}if(Le.centeredSlides&&Le.centeredSlidesBounds){let Re=0;Gn.forEach((Le=>{Re+=Le+(_i||0)})),Re-=_i;const Le=Re>qe?Re-qe:0;Nn=Nn.map((Re=>Re<=0?-qn:Re>Le?Le+Zn:Re))}if(Le.centerInsufficientSlides){let Re=0;Gn.forEach((Le=>{Re+=Le+(_i||0)})),Re-=_i;const Oe=(Le.slidesOffsetBefore||0)+(Le.slidesOffsetAfter||0);if(Re+Oe<qe){const Le=(qe-Re-Oe)/2;Nn.forEach(((Re,Oe)=>{Nn[Oe]=Re-Le})),$n.forEach(((Re,Oe)=>{$n[Oe]=Re+Le}))}}if(Object.assign(Re,{slides:Jr,snapGrid:Nn,slidesGrid:$n,slidesSizesGrid:Gn}),Le.centeredSlides&&Le.cssMode&&!Le.centeredSlidesBounds){setCSSProperty(Oe,"--swiper-centered-offset-before",-Nn[0]+"px"),setCSSProperty(Oe,"--swiper-centered-offset-after",Re.size/2-Gn[Gn.length-1]/2+"px");const Le=-Re.snapGrid[0],Ue=-Re.slidesGrid[0];Re.snapGrid=Re.snapGrid.map((Re=>Re+Le)),Re.slidesGrid=Re.slidesGrid.map((Re=>Re+Ue))}if(Ln!==Hr&&Re.emit("slidesLengthChange"),Nn.length!==Xn&&(Re.params.watchOverflow&&Re.checkOverflow(),Re.emit("snapGridLengthChange")),$n.length!==Yn&&Re.emit("slidesGridLengthChange"),Le.watchSlidesProgress&&Re.updateSlidesOffset(),Re.emit("slidesUpdated"),!(Jt||Le.cssMode||"slide"!==Le.effect&&"fade"!==Le.effect)){const Oe=`${Le.containerModifierClass}backface-hidden`,Ue=Re.el.classList.contains(Oe);Ln<=Le.maxBackfaceHiddenSlides?Ue||Re.el.classList.add(Oe):Ue&&Re.el.classList.remove(Oe)}},updateAutoHeight:function(Re){const Le=this,Oe=[],Ue=Le.virtual&&Le.params.virtual.enabled;let qe,Ct=0;"number"==typeof Re?Le.setTransition(Re):!0===Re&&Le.setTransition(Le.params.speed);const getSlideByIndex=Re=>Ue?Le.slides[Le.getSlideIndexByData(Re)]:Le.slides[Re];if("auto"!==Le.params.slidesPerView&&Le.params.slidesPerView>1)if(Le.params.centeredSlides)(Le.visibleSlides||[]).forEach((Re=>{Oe.push(Re)}));else for(qe=0;qe<Math.ceil(Le.params.slidesPerView);qe+=1){const Re=Le.activeIndex+qe;if(Re>Le.slides.length&&!Ue)break;Oe.push(getSlideByIndex(Re))}else Oe.push(getSlideByIndex(Le.activeIndex));for(qe=0;qe<Oe.length;qe+=1)if(void 0!==Oe[qe]){const Re=Oe[qe].offsetHeight;Ct=Re>Ct?Re:Ct}(Ct||0===Ct)&&(Le.wrapperEl.style.height=`${Ct}px`)},updateSlidesOffset:function(){const Re=this,Le=Re.slides,Oe=Re.isElement?Re.isHorizontal()?Re.wrapperEl.offsetLeft:Re.wrapperEl.offsetTop:0;for(let Ue=0;Ue<Le.length;Ue+=1)Le[Ue].swiperSlideOffset=(Re.isHorizontal()?Le[Ue].offsetLeft:Le[Ue].offsetTop)-Oe-Re.cssOverflowAdjustment()},updateSlidesProgress:function(Re){void 0===Re&&(Re=this&&this.translate||0);const Le=this,Oe=Le.params,{slides:Ue,rtlTranslate:qe,snapGrid:Ct}=Le;if(0===Ue.length)return;void 0===Ue[0].swiperSlideOffset&&Le.updateSlidesOffset();let Ot=-Re;qe&&(Ot=Re),Le.visibleSlidesIndexes=[],Le.visibleSlides=[];let Jt=Oe.spaceBetween;"string"==typeof Jt&&Jt.indexOf("%")>=0?Jt=parseFloat(Jt.replace("%",""))/100*Le.size:"string"==typeof Jt&&(Jt=parseFloat(Jt));for(let Re=0;Re<Ue.length;Re+=1){const Hr=Ue[Re];let Jr=Hr.swiperSlideOffset;Oe.cssMode&&Oe.centeredSlides&&(Jr-=Ue[0].swiperSlideOffset);const Ln=(Ot+(Oe.centeredSlides?Le.minTranslate():0)-Jr)/(Hr.swiperSlideSize+Jt),Nn=(Ot-Ct[0]+(Oe.centeredSlides?Le.minTranslate():0)-Jr)/(Hr.swiperSlideSize+Jt),$n=-(Ot-Jr),Gn=$n+Le.slidesSizesGrid[Re],qn=$n>=0&&$n<=Le.size-Le.slidesSizesGrid[Re],Zn=$n>=0&&$n<Le.size-1||Gn>1&&Gn<=Le.size||$n<=0&&Gn>=Le.size;Zn&&(Le.visibleSlides.push(Hr),Le.visibleSlidesIndexes.push(Re)),toggleSlideClasses$1(Hr,Zn,Oe.slideVisibleClass),toggleSlideClasses$1(Hr,qn,Oe.slideFullyVisibleClass),Hr.progress=qe?-Ln:Ln,Hr.originalProgress=qe?-Nn:Nn}},updateProgress:function(Re){const Le=this;if(void 0===Re){const Oe=Le.rtlTranslate?-1:1;Re=Le&&Le.translate&&Le.translate*Oe||0}const Oe=Le.params,Ue=Le.maxTranslate()-Le.minTranslate();let{progress:qe,isBeginning:Ct,isEnd:Ot,progressLoop:Jt}=Le;const Hr=Ct,Jr=Ot;if(0===Ue)qe=0,Ct=!0,Ot=!0;else{qe=(Re-Le.minTranslate())/Ue;const Oe=Math.abs(Re-Le.minTranslate())<1,Jt=Math.abs(Re-Le.maxTranslate())<1;Ct=Oe||qe<=0,Ot=Jt||qe>=1,Oe&&(qe=0),Jt&&(qe=1)}if(Oe.loop){const Oe=Le.getSlideIndexByData(0),Ue=Le.getSlideIndexByData(Le.slides.length-1),qe=Le.slidesGrid[Oe],Ct=Le.slidesGrid[Ue],Ot=Le.slidesGrid[Le.slidesGrid.length-1],Hr=Math.abs(Re);Jt=Hr>=qe?(Hr-qe)/Ot:(Hr+Ot-Ct)/Ot,Jt>1&&(Jt-=1)}Object.assign(Le,{progress:qe,progressLoop:Jt,isBeginning:Ct,isEnd:Ot}),(Oe.watchSlidesProgress||Oe.centeredSlides&&Oe.autoHeight)&&Le.updateSlidesProgress(Re),Ct&&!Hr&&Le.emit("reachBeginning toEdge"),Ot&&!Jr&&Le.emit("reachEnd toEdge"),(Hr&&!Ct||Jr&&!Ot)&&Le.emit("fromEdge"),Le.emit("progress",qe)},updateSlidesClasses:function(){const Re=this,{slides:Le,params:Oe,slidesEl:Ue,activeIndex:qe}=Re,Ct=Re.virtual&&Oe.virtual.enabled,Ot=Re.grid&&Oe.grid&&Oe.grid.rows>1,getFilteredSlide=Re=>elementChildren(Ue,`.${Oe.slideClass}${Re}, swiper-slide${Re}`)[0];let Jt,Hr,Jr;if(Ct)if(Oe.loop){let Le=qe-Re.virtual.slidesBefore;Le<0&&(Le=Re.virtual.slides.length+Le),Le>=Re.virtual.slides.length&&(Le-=Re.virtual.slides.length),Jt=getFilteredSlide(`[data-swiper-slide-index="${Le}"]`)}else Jt=getFilteredSlide(`[data-swiper-slide-index="${qe}"]`);else Ot?(Jt=Le.filter((Re=>Re.column===qe))[0],Jr=Le.filter((Re=>Re.column===qe+1))[0],Hr=Le.filter((Re=>Re.column===qe-1))[0]):Jt=Le[qe];Jt&&(Ot||(Jr=function(Re,Le){const Oe=[];for(;Re.nextElementSibling;){const Ue=Re.nextElementSibling;Le?Ue.matches(Le)&&Oe.push(Ue):Oe.push(Ue),Re=Ue}return Oe}(Jt,`.${Oe.slideClass}, swiper-slide`)[0],Oe.loop&&!Jr&&(Jr=Le[0]),Hr=function(Re,Le){const Oe=[];for(;Re.previousElementSibling;){const Ue=Re.previousElementSibling;Le?Ue.matches(Le)&&Oe.push(Ue):Oe.push(Ue),Re=Ue}return Oe}(Jt,`.${Oe.slideClass}, swiper-slide`)[0],Oe.loop&&0===!Hr&&(Hr=Le[Le.length-1]))),Le.forEach((Re=>{toggleSlideClasses(Re,Re===Jt,Oe.slideActiveClass),toggleSlideClasses(Re,Re===Jr,Oe.slideNextClass),toggleSlideClasses(Re,Re===Hr,Oe.slidePrevClass)})),Re.emitSlidesClasses()},updateActiveIndex:function(Re){const Le=this,Oe=Le.rtlTranslate?Le.translate:-Le.translate,{snapGrid:Ue,params:qe,activeIndex:Ct,realIndex:Ot,snapIndex:Jt}=Le;let Hr,Jr=Re;const getVirtualRealIndex=Re=>{let Oe=Re-Le.virtual.slidesBefore;return Oe<0&&(Oe=Le.virtual.slides.length+Oe),Oe>=Le.virtual.slides.length&&(Oe-=Le.virtual.slides.length),Oe};if(void 0===Jr&&(Jr=function(Re){const{slidesGrid:Le,params:Oe}=Re,Ue=Re.rtlTranslate?Re.translate:-Re.translate;let qe;for(let Re=0;Re<Le.length;Re+=1)void 0!==Le[Re+1]?Ue>=Le[Re]&&Ue<Le[Re+1]-(Le[Re+1]-Le[Re])/2?qe=Re:Ue>=Le[Re]&&Ue<Le[Re+1]&&(qe=Re+1):Ue>=Le[Re]&&(qe=Re);return Oe.normalizeSlideIndex&&(qe<0||void 0===qe)&&(qe=0),qe}(Le)),Ue.indexOf(Oe)>=0)Hr=Ue.indexOf(Oe);else{const Re=Math.min(qe.slidesPerGroupSkip,Jr);Hr=Re+Math.floor((Jr-Re)/qe.slidesPerGroup)}if(Hr>=Ue.length&&(Hr=Ue.length-1),Jr===Ct&&!Le.params.loop)return void(Hr!==Jt&&(Le.snapIndex=Hr,Le.emit("snapIndexChange")));if(Jr===Ct&&Le.params.loop&&Le.virtual&&Le.params.virtual.enabled)return void(Le.realIndex=getVirtualRealIndex(Jr));const Ln=Le.grid&&qe.grid&&qe.grid.rows>1;let Nn;if(Le.virtual&&qe.virtual.enabled&&qe.loop)Nn=getVirtualRealIndex(Jr);else if(Ln){const Re=Le.slides.filter((Re=>Re.column===Jr))[0];let Oe=parseInt(Re.getAttribute("data-swiper-slide-index"),10);Number.isNaN(Oe)&&(Oe=Math.max(Le.slides.indexOf(Re),0)),Nn=Math.floor(Oe/qe.grid.rows)}else if(Le.slides[Jr]){const Re=Le.slides[Jr].getAttribute("data-swiper-slide-index");Nn=Re?parseInt(Re,10):Jr}else Nn=Jr;Object.assign(Le,{previousSnapIndex:Jt,snapIndex:Hr,previousRealIndex:Ot,realIndex:Nn,previousIndex:Ct,activeIndex:Jr}),Le.initialized&&preload(Le),Le.emit("activeIndexChange"),Le.emit("snapIndexChange"),(Le.initialized||Le.params.runCallbacksOnInit)&&(Ot!==Nn&&Le.emit("realIndexChange"),Le.emit("slideChange"))},updateClickedSlide:function(Re,Le){const Oe=this,Ue=Oe.params;let qe=Re.closest(`.${Ue.slideClass}, swiper-slide`);!qe&&Oe.isElement&&Le&&Le.length>1&&Le.includes(Re)&&[...Le.slice(Le.indexOf(Re)+1,Le.length)].forEach((Re=>{!qe&&Re.matches&&Re.matches(`.${Ue.slideClass}, swiper-slide`)&&(qe=Re)}));let Ct,Ot=!1;if(qe)for(let Re=0;Re<Oe.slides.length;Re+=1)if(Oe.slides[Re]===qe){Ot=!0,Ct=Re;break}if(!qe||!Ot)return Oe.clickedSlide=void 0,void(Oe.clickedIndex=void 0);Oe.clickedSlide=qe,Oe.virtual&&Oe.params.virtual.enabled?Oe.clickedIndex=parseInt(qe.getAttribute("data-swiper-slide-index"),10):Oe.clickedIndex=Ct,Ue.slideToClickedSlide&&void 0!==Oe.clickedIndex&&Oe.clickedIndex!==Oe.activeIndex&&Oe.slideToClickedSlide()}};var xA={getTranslate:function(Re){void 0===Re&&(Re=this.isHorizontal()?"x":"y");const{params:Le,rtlTranslate:Oe,translate:Ue,wrapperEl:qe}=this;if(Le.virtualTranslate)return Oe?-Ue:Ue;if(Le.cssMode)return Ue;let Ct=getTranslate(qe,Re);return Ct+=this.cssOverflowAdjustment(),Oe&&(Ct=-Ct),Ct||0},setTranslate:function(Re,Le){const Oe=this,{rtlTranslate:Ue,params:qe,wrapperEl:Ct,progress:Ot}=Oe;let Jt,Hr=0,Jr=0;Oe.isHorizontal()?Hr=Ue?-Re:Re:Jr=Re,qe.roundLengths&&(Hr=Math.floor(Hr),Jr=Math.floor(Jr)),Oe.previousTranslate=Oe.translate,Oe.translate=Oe.isHorizontal()?Hr:Jr,qe.cssMode?Ct[Oe.isHorizontal()?"scrollLeft":"scrollTop"]=Oe.isHorizontal()?-Hr:-Jr:qe.virtualTranslate||(Oe.isHorizontal()?Hr-=Oe.cssOverflowAdjustment():Jr-=Oe.cssOverflowAdjustment(),Ct.style.transform=`translate3d(${Hr}px, ${Jr}px, 0px)`);const Ln=Oe.maxTranslate()-Oe.minTranslate();Jt=0===Ln?0:(Re-Oe.minTranslate())/Ln,Jt!==Ot&&Oe.updateProgress(Re),Oe.emit("setTranslate",Oe.translate,Le)},minTranslate:function(){return-this.snapGrid[0]},maxTranslate:function(){return-this.snapGrid[this.snapGrid.length-1]},translateTo:function(Re,Le,Oe,Ue,qe){void 0===Re&&(Re=0),void 0===Le&&(Le=this.params.speed),void 0===Oe&&(Oe=!0),void 0===Ue&&(Ue=!0);const Ct=this,{params:Ot,wrapperEl:Jt}=Ct;if(Ct.animating&&Ot.preventInteractionOnTransition)return!1;const Hr=Ct.minTranslate(),Jr=Ct.maxTranslate();let Ln;if(Ln=Ue&&Re>Hr?Hr:Ue&&Re<Jr?Jr:Re,Ct.updateProgress(Ln),Ot.cssMode){const Re=Ct.isHorizontal();if(0===Le)Jt[Re?"scrollLeft":"scrollTop"]=-Ln;else{if(!Ct.support.smoothScroll)return animateCSSModeScroll({swiper:Ct,targetPosition:-Ln,side:Re?"left":"top"}),!0;Jt.scrollTo({[Re?"left":"top"]:-Ln,behavior:"smooth"})}return!0}return 0===Le?(Ct.setTransition(0),Ct.setTranslate(Ln),Oe&&(Ct.emit("beforeTransitionStart",Le,qe),Ct.emit("transitionEnd"))):(Ct.setTransition(Le),Ct.setTranslate(Ln),Oe&&(Ct.emit("beforeTransitionStart",Le,qe),Ct.emit("transitionStart")),Ct.animating||(Ct.animating=!0,Ct.onTranslateToWrapperTransitionEnd||(Ct.onTranslateToWrapperTransitionEnd=function(Re){Ct&&!Ct.destroyed&&Re.target===this&&(Ct.wrapperEl.removeEventListener("transitionend",Ct.onTranslateToWrapperTransitionEnd),Ct.onTranslateToWrapperTransitionEnd=null,delete Ct.onTranslateToWrapperTransitionEnd,Ct.animating=!1,Oe&&Ct.emit("transitionEnd"))}),Ct.wrapperEl.addEventListener("transitionend",Ct.onTranslateToWrapperTransitionEnd))),!0}};function transitionEmit(Re){let{swiper:Le,runCallbacks:Oe,direction:Ue,step:qe}=Re;const{activeIndex:Ct,previousIndex:Ot}=Le;let Jt=Ue;if(Jt||(Jt=Ct>Ot?"next":Ct<Ot?"prev":"reset"),Le.emit(`transition${qe}`),Oe&&Ct!==Ot){if("reset"===Jt)return void Le.emit(`slideResetTransition${qe}`);Le.emit(`slideChangeTransition${qe}`),"next"===Jt?Le.emit(`slideNextTransition${qe}`):Le.emit(`slidePrevTransition${qe}`)}}var bA={slideTo:function(Re,Le,Oe,Ue,qe){void 0===Re&&(Re=0),void 0===Oe&&(Oe=!0),"string"==typeof Re&&(Re=parseInt(Re,10));const Ct=this;let Ot=Re;Ot<0&&(Ot=0);const{params:Jt,snapGrid:Hr,slidesGrid:Jr,previousIndex:Ln,activeIndex:Nn,rtlTranslate:$n,wrapperEl:Gn,enabled:qn}=Ct;if(!qn&&!Ue&&!qe||Ct.destroyed||Ct.animating&&Jt.preventInteractionOnTransition)return!1;void 0===Le&&(Le=Ct.params.speed);const Zn=Math.min(Ct.params.slidesPerGroupSkip,Ot);let Xn=Zn+Math.floor((Ot-Zn)/Ct.params.slidesPerGroup);Xn>=Hr.length&&(Xn=Hr.length-1);const Yn=-Hr[Xn];if(Jt.normalizeSlideIndex)for(let Re=0;Re<Jr.length;Re+=1){const Le=-Math.floor(100*Yn),Oe=Math.floor(100*Jr[Re]),Ue=Math.floor(100*Jr[Re+1]);void 0!==Jr[Re+1]?Le>=Oe&&Le<Ue-(Ue-Oe)/2?Ot=Re:Le>=Oe&&Le<Ue&&(Ot=Re+1):Le>=Oe&&(Ot=Re)}if(Ct.initialized&&Ot!==Nn){if(!Ct.allowSlideNext&&($n?Yn>Ct.translate&&Yn>Ct.minTranslate():Yn<Ct.translate&&Yn<Ct.minTranslate()))return!1;if(!Ct.allowSlidePrev&&Yn>Ct.translate&&Yn>Ct.maxTranslate()&&(Nn||0)!==Ot)return!1}let _i;Ot!==(Ln||0)&&Oe&&Ct.emit("beforeSlideChangeStart"),Ct.updateProgress(Yn),_i=Ot>Nn?"next":Ot<Nn?"prev":"reset";const vi=Ct.virtual&&Ct.params.virtual.enabled;if(!(vi&&qe)&&($n&&-Yn===Ct.translate||!$n&&Yn===Ct.translate))return Ct.updateActiveIndex(Ot),Jt.autoHeight&&Ct.updateAutoHeight(),Ct.updateSlidesClasses(),"slide"!==Jt.effect&&Ct.setTranslate(Yn),"reset"!==_i&&(Ct.transitionStart(Oe,_i),Ct.transitionEnd(Oe,_i)),!1;if(Jt.cssMode){const Re=Ct.isHorizontal(),Oe=$n?Yn:-Yn;if(0===Le)vi&&(Ct.wrapperEl.style.scrollSnapType="none",Ct._immediateVirtual=!0),vi&&!Ct._cssModeVirtualInitialSet&&Ct.params.initialSlide>0?(Ct._cssModeVirtualInitialSet=!0,requestAnimationFrame((()=>{Gn[Re?"scrollLeft":"scrollTop"]=Oe}))):Gn[Re?"scrollLeft":"scrollTop"]=Oe,vi&&requestAnimationFrame((()=>{Ct.wrapperEl.style.scrollSnapType="",Ct._immediateVirtual=!1}));else{if(!Ct.support.smoothScroll)return animateCSSModeScroll({swiper:Ct,targetPosition:Oe,side:Re?"left":"top"}),!0;Gn.scrollTo({[Re?"left":"top"]:Oe,behavior:"smooth"})}return!0}return Ct.setTransition(Le),Ct.setTranslate(Yn),Ct.updateActiveIndex(Ot),Ct.updateSlidesClasses(),Ct.emit("beforeTransitionStart",Le,Ue),Ct.transitionStart(Oe,_i),0===Le?Ct.transitionEnd(Oe,_i):Ct.animating||(Ct.animating=!0,Ct.onSlideToWrapperTransitionEnd||(Ct.onSlideToWrapperTransitionEnd=function(Re){Ct&&!Ct.destroyed&&Re.target===this&&(Ct.wrapperEl.removeEventListener("transitionend",Ct.onSlideToWrapperTransitionEnd),Ct.onSlideToWrapperTransitionEnd=null,delete Ct.onSlideToWrapperTransitionEnd,Ct.transitionEnd(Oe,_i))}),Ct.wrapperEl.addEventListener("transitionend",Ct.onSlideToWrapperTransitionEnd)),!0},slideToLoop:function(Re,Le,Oe,Ue){if(void 0===Re&&(Re=0),void 0===Oe&&(Oe=!0),"string"==typeof Re){Re=parseInt(Re,10)}const qe=this;if(qe.destroyed)return;void 0===Le&&(Le=qe.params.speed);const Ct=qe.grid&&qe.params.grid&&qe.params.grid.rows>1;let Ot=Re;if(qe.params.loop)if(qe.virtual&&qe.params.virtual.enabled)Ot+=qe.virtual.slidesBefore;else{let Re;if(Ct){const Le=Ot*qe.params.grid.rows;Re=qe.slides.filter((Re=>1*Re.getAttribute("data-swiper-slide-index")===Le))[0].column}else Re=qe.getSlideIndexByData(Ot);const Le=Ct?Math.ceil(qe.slides.length/qe.params.grid.rows):qe.slides.length,{centeredSlides:Oe}=qe.params;let Jt=qe.params.slidesPerView;"auto"===Jt?Jt=qe.slidesPerViewDynamic():(Jt=Math.ceil(parseFloat(qe.params.slidesPerView,10)),Oe&&Jt%2==0&&(Jt+=1));let Hr=Le-Re<Jt;if(Oe&&(Hr=Hr||Re<Math.ceil(Jt/2)),Ue&&Oe&&"auto"!==qe.params.slidesPerView&&!Ct&&(Hr=!1),Hr){const Ue=Oe?Re<qe.activeIndex?"prev":"next":Re-qe.activeIndex-1<qe.params.slidesPerView?"next":"prev";qe.loopFix({direction:Ue,slideTo:!0,activeSlideIndex:"next"===Ue?Re+1:Re-Le+1,slideRealIndex:"next"===Ue?qe.realIndex:void 0})}if(Ct){const Re=Ot*qe.params.grid.rows;Ot=qe.slides.filter((Le=>1*Le.getAttribute("data-swiper-slide-index")===Re))[0].column}else Ot=qe.getSlideIndexByData(Ot)}return requestAnimationFrame((()=>{qe.slideTo(Ot,Le,Oe,Ue)})),qe},slideNext:function(Re,Le,Oe){void 0===Le&&(Le=!0);const Ue=this,{enabled:qe,params:Ct,animating:Ot}=Ue;if(!qe||Ue.destroyed)return Ue;void 0===Re&&(Re=Ue.params.speed);let Jt=Ct.slidesPerGroup;"auto"===Ct.slidesPerView&&1===Ct.slidesPerGroup&&Ct.slidesPerGroupAuto&&(Jt=Math.max(Ue.slidesPerViewDynamic("current",!0),1));const Hr=Ue.activeIndex<Ct.slidesPerGroupSkip?1:Jt,Jr=Ue.virtual&&Ct.virtual.enabled;if(Ct.loop){if(Ot&&!Jr&&Ct.loopPreventsSliding)return!1;if(Ue.loopFix({direction:"next"}),Ue._clientLeft=Ue.wrapperEl.clientLeft,Ue.activeIndex===Ue.slides.length-1&&Ct.cssMode)return requestAnimationFrame((()=>{Ue.slideTo(Ue.activeIndex+Hr,Re,Le,Oe)})),!0}return Ct.rewind&&Ue.isEnd?Ue.slideTo(0,Re,Le,Oe):Ue.slideTo(Ue.activeIndex+Hr,Re,Le,Oe)},slidePrev:function(Re,Le,Oe){void 0===Le&&(Le=!0);const Ue=this,{params:qe,snapGrid:Ct,slidesGrid:Ot,rtlTranslate:Jt,enabled:Hr,animating:Jr}=Ue;if(!Hr||Ue.destroyed)return Ue;void 0===Re&&(Re=Ue.params.speed);const Ln=Ue.virtual&&qe.virtual.enabled;if(qe.loop){if(Jr&&!Ln&&qe.loopPreventsSliding)return!1;Ue.loopFix({direction:"prev"}),Ue._clientLeft=Ue.wrapperEl.clientLeft}function normalize(Re){return Re<0?-Math.floor(Math.abs(Re)):Math.floor(Re)}const Nn=normalize(Jt?Ue.translate:-Ue.translate),$n=Ct.map((Re=>normalize(Re)));let Gn=Ct[$n.indexOf(Nn)-1];if(void 0===Gn&&qe.cssMode){let Re;Ct.forEach(((Le,Oe)=>{Nn>=Le&&(Re=Oe)})),void 0!==Re&&(Gn=Ct[Re>0?Re-1:Re])}let qn=0;if(void 0!==Gn&&(qn=Ot.indexOf(Gn),qn<0&&(qn=Ue.activeIndex-1),"auto"===qe.slidesPerView&&1===qe.slidesPerGroup&&qe.slidesPerGroupAuto&&(qn=qn-Ue.slidesPerViewDynamic("previous",!0)+1,qn=Math.max(qn,0))),qe.rewind&&Ue.isBeginning){const qe=Ue.params.virtual&&Ue.params.virtual.enabled&&Ue.virtual?Ue.virtual.slides.length-1:Ue.slides.length-1;return Ue.slideTo(qe,Re,Le,Oe)}return qe.loop&&0===Ue.activeIndex&&qe.cssMode?(requestAnimationFrame((()=>{Ue.slideTo(qn,Re,Le,Oe)})),!0):Ue.slideTo(qn,Re,Le,Oe)},slideReset:function(Re,Le,Oe){void 0===Le&&(Le=!0);const Ue=this;if(!Ue.destroyed)return void 0===Re&&(Re=Ue.params.speed),Ue.slideTo(Ue.activeIndex,Re,Le,Oe)},slideToClosest:function(Re,Le,Oe,Ue){void 0===Le&&(Le=!0),void 0===Ue&&(Ue=.5);const qe=this;if(qe.destroyed)return;void 0===Re&&(Re=qe.params.speed);let Ct=qe.activeIndex;const Ot=Math.min(qe.params.slidesPerGroupSkip,Ct),Jt=Ot+Math.floor((Ct-Ot)/qe.params.slidesPerGroup),Hr=qe.rtlTranslate?qe.translate:-qe.translate;if(Hr>=qe.snapGrid[Jt]){const Re=qe.snapGrid[Jt];Hr-Re>(qe.snapGrid[Jt+1]-Re)*Ue&&(Ct+=qe.params.slidesPerGroup)}else{const Re=qe.snapGrid[Jt-1];Hr-Re<=(qe.snapGrid[Jt]-Re)*Ue&&(Ct-=qe.params.slidesPerGroup)}return Ct=Math.max(Ct,0),Ct=Math.min(Ct,qe.slidesGrid.length-1),qe.slideTo(Ct,Re,Le,Oe)},slideToClickedSlide:function(){const Re=this;if(Re.destroyed)return;const{params:Le,slidesEl:Oe}=Re,Ue="auto"===Le.slidesPerView?Re.slidesPerViewDynamic():Le.slidesPerView;let qe,Ct=Re.clickedIndex;const Ot=Re.isElement?"swiper-slide":`.${Le.slideClass}`;if(Le.loop){if(Re.animating)return;qe=parseInt(Re.clickedSlide.getAttribute("data-swiper-slide-index"),10),Le.centeredSlides?Ct<Re.loopedSlides-Ue/2||Ct>Re.slides.length-Re.loopedSlides+Ue/2?(Re.loopFix(),Ct=Re.getSlideIndex(elementChildren(Oe,`${Ot}[data-swiper-slide-index="${qe}"]`)[0]),nextTick((()=>{Re.slideTo(Ct)}))):Re.slideTo(Ct):Ct>Re.slides.length-Ue?(Re.loopFix(),Ct=Re.getSlideIndex(elementChildren(Oe,`${Ot}[data-swiper-slide-index="${qe}"]`)[0]),nextTick((()=>{Re.slideTo(Ct)}))):Re.slideTo(Ct)}else Re.slideTo(Ct)}};var wA={loopCreate:function(Re){const Le=this,{params:Oe,slidesEl:Ue}=Le;if(!Oe.loop||Le.virtual&&Le.params.virtual.enabled)return;const initSlides=()=>{elementChildren(Ue,`.${Oe.slideClass}, swiper-slide`).forEach(((Re,Le)=>{Re.setAttribute("data-swiper-slide-index",Le)}))},qe=Le.grid&&Oe.grid&&Oe.grid.rows>1,Ct=Oe.slidesPerGroup*(qe?Oe.grid.rows:1),Ot=Le.slides.length%Ct!=0,Jt=qe&&Le.slides.length%Oe.grid.rows!=0,addBlankSlides=Re=>{for(let Ue=0;Ue<Re;Ue+=1){const Re=Le.isElement?createElement("swiper-slide",[Oe.slideBlankClass]):createElement("div",[Oe.slideClass,Oe.slideBlankClass]);Le.slidesEl.append(Re)}};if(Ot){if(Oe.loopAddBlankSlides){addBlankSlides(Ct-Le.slides.length%Ct),Le.recalcSlides(),Le.updateSlides()}else showWarning("Swiper Loop Warning: The number of slides is not even to slidesPerGroup, loop mode may not function properly. You need to add more slides (or make duplicates, or empty slides)");initSlides()}else if(Jt){if(Oe.loopAddBlankSlides){addBlankSlides(Oe.grid.rows-Le.slides.length%Oe.grid.rows),Le.recalcSlides(),Le.updateSlides()}else showWarning("Swiper Loop Warning: The number of slides is not even to grid.rows, loop mode may not function properly. You need to add more slides (or make duplicates, or empty slides)");initSlides()}else initSlides();Le.loopFix({slideRealIndex:Re,direction:Oe.centeredSlides?void 0:"next"})},loopFix:function(Re){let{slideRealIndex:Le,slideTo:Oe=!0,direction:Ue,setTranslate:qe,activeSlideIndex:Ct,byController:Ot,byMousewheel:Jt}=void 0===Re?{}:Re;const Hr=this;if(!Hr.params.loop)return;Hr.emit("beforeLoopFix");const{slides:Jr,allowSlidePrev:Ln,allowSlideNext:Nn,slidesEl:$n,params:Gn}=Hr,{centeredSlides:qn}=Gn;if(Hr.allowSlidePrev=!0,Hr.allowSlideNext=!0,Hr.virtual&&Gn.virtual.enabled)return Oe&&(Gn.centeredSlides||0!==Hr.snapIndex?Gn.centeredSlides&&Hr.snapIndex<Gn.slidesPerView?Hr.slideTo(Hr.virtual.slides.length+Hr.snapIndex,0,!1,!0):Hr.snapIndex===Hr.snapGrid.length-1&&Hr.slideTo(Hr.virtual.slidesBefore,0,!1,!0):Hr.slideTo(Hr.virtual.slides.length,0,!1,!0)),Hr.allowSlidePrev=Ln,Hr.allowSlideNext=Nn,void Hr.emit("loopFix");let Zn=Gn.slidesPerView;"auto"===Zn?Zn=Hr.slidesPerViewDynamic():(Zn=Math.ceil(parseFloat(Gn.slidesPerView,10)),qn&&Zn%2==0&&(Zn+=1));const Xn=Gn.slidesPerGroupAuto?Zn:Gn.slidesPerGroup;let Yn=Xn;Yn%Xn!=0&&(Yn+=Xn-Yn%Xn),Yn+=Gn.loopAdditionalSlides,Hr.loopedSlides=Yn;const _i=Hr.grid&&Gn.grid&&Gn.grid.rows>1;Jr.length<Zn+Yn?showWarning("Swiper Loop Warning: The number of slides is not enough for loop mode, it will be disabled and not function properly. You need to add more slides (or make duplicates) or lower the values of slidesPerView and slidesPerGroup parameters"):_i&&"row"===Gn.grid.fill&&showWarning("Swiper Loop Warning: Loop mode is not compatible with grid.fill = `row`");const vi=[],xi=[];let bi=Hr.activeIndex;void 0===Ct?Ct=Hr.getSlideIndex(Jr.filter((Re=>Re.classList.contains(Gn.slideActiveClass)))[0]):bi=Ct;const Pi="next"===Ue||!Ue,lo="prev"===Ue||!Ue;let uo=0,po=0;const fo=_i?Math.ceil(Jr.length/Gn.grid.rows):Jr.length,Io=(_i?Jr[Ct].column:Ct)+(qn&&void 0===qe?-Zn/2+.5:0);if(Io<Yn){uo=Math.max(Yn-Io,Xn);for(let Re=0;Re<Yn-Io;Re+=1){const Le=Re-Math.floor(Re/fo)*fo;if(_i){const Re=fo-Le-1;for(let Le=Jr.length-1;Le>=0;Le-=1)Jr[Le].column===Re&&vi.push(Le)}else vi.push(fo-Le-1)}}else if(Io+Zn>fo-Yn){po=Math.max(Io-(fo-2*Yn),Xn);for(let Re=0;Re<po;Re+=1){const Le=Re-Math.floor(Re/fo)*fo;_i?Jr.forEach(((Re,Oe)=>{Re.column===Le&&xi.push(Oe)})):xi.push(Le)}}if(Hr.__preventObserver__=!0,requestAnimationFrame((()=>{Hr.__preventObserver__=!1})),lo&&vi.forEach((Re=>{Jr[Re].swiperLoopMoveDOM=!0,$n.prepend(Jr[Re]),Jr[Re].swiperLoopMoveDOM=!1})),Pi&&xi.forEach((Re=>{Jr[Re].swiperLoopMoveDOM=!0,$n.append(Jr[Re]),Jr[Re].swiperLoopMoveDOM=!1})),Hr.recalcSlides(),"auto"===Gn.slidesPerView?Hr.updateSlides():_i&&(vi.length>0&&lo||xi.length>0&&Pi)&&Hr.slides.forEach(((Re,Le)=>{Hr.grid.updateSlide(Le,Re,Hr.slides)})),Gn.watchSlidesProgress&&Hr.updateSlidesOffset(),Oe)if(vi.length>0&&lo){if(void 0===Le){const Re=Hr.slidesGrid[bi],Le=Hr.slidesGrid[bi+uo]-Re;Jt?Hr.setTranslate(Hr.translate-Le):(Hr.slideTo(bi+Math.ceil(uo),0,!1,!0),qe&&(Hr.touchEventsData.startTranslate=Hr.touchEventsData.startTranslate-Le,Hr.touchEventsData.currentTranslate=Hr.touchEventsData.currentTranslate-Le))}else if(qe){const Re=_i?vi.length/Gn.grid.rows:vi.length;Hr.slideTo(Hr.activeIndex+Re,0,!1,!0),Hr.touchEventsData.currentTranslate=Hr.translate}}else if(xi.length>0&&Pi)if(void 0===Le){const Re=Hr.slidesGrid[bi],Le=Hr.slidesGrid[bi-po]-Re;Jt?Hr.setTranslate(Hr.translate-Le):(Hr.slideTo(bi-po,0,!1,!0),qe&&(Hr.touchEventsData.startTranslate=Hr.touchEventsData.startTranslate-Le,Hr.touchEventsData.currentTranslate=Hr.touchEventsData.currentTranslate-Le))}else{const Re=_i?xi.length/Gn.grid.rows:xi.length;Hr.slideTo(Hr.activeIndex-Re,0,!1,!0)}if(Hr.allowSlidePrev=Ln,Hr.allowSlideNext=Nn,Hr.controller&&Hr.controller.control&&!Ot){const Re={slideRealIndex:Le,direction:Ue,setTranslate:qe,activeSlideIndex:Ct,byController:!0};Array.isArray(Hr.controller.control)?Hr.controller.control.forEach((Le=>{!Le.destroyed&&Le.params.loop&&Le.loopFix({...Re,slideTo:Le.params.slidesPerView===Gn.slidesPerView&&Oe})})):Hr.controller.control instanceof Hr.constructor&&Hr.controller.control.params.loop&&Hr.controller.control.loopFix({...Re,slideTo:Hr.controller.control.params.slidesPerView===Gn.slidesPerView&&Oe})}Hr.emit("loopFix")},loopDestroy:function(){const Re=this,{params:Le,slidesEl:Oe}=Re;if(!Le.loop||Re.virtual&&Re.params.virtual.enabled)return;Re.recalcSlides();const Ue=[];Re.slides.forEach((Re=>{const Le=void 0===Re.swiperSlideIndex?1*Re.getAttribute("data-swiper-slide-index"):Re.swiperSlideIndex;Ue[Le]=Re})),Re.slides.forEach((Re=>{Re.removeAttribute("data-swiper-slide-index")})),Ue.forEach((Re=>{Oe.append(Re)})),Re.recalcSlides(),Re.slideTo(Re.realIndex,0)}};function preventEdgeSwipe(Re,Le,Oe){const Ue=getWindow(),{params:qe}=Re,Ct=qe.edgeSwipeDetection,Ot=qe.edgeSwipeThreshold;return!Ct||!(Oe<=Ot||Oe>=Ue.innerWidth-Ot)||"prevent"===Ct&&(Le.preventDefault(),!0)}function onTouchStart(Re){const Le=this,Oe=getDocument();let Ue=Re;Ue.originalEvent&&(Ue=Ue.originalEvent);const qe=Le.touchEventsData;if("pointerdown"===Ue.type){if(null!==qe.pointerId&&qe.pointerId!==Ue.pointerId)return;qe.pointerId=Ue.pointerId}else"touchstart"===Ue.type&&1===Ue.targetTouches.length&&(qe.touchId=Ue.targetTouches[0].identifier);if("touchstart"===Ue.type)return void preventEdgeSwipe(Le,Ue,Ue.targetTouches[0].pageX);const{params:Ct,touches:Ot,enabled:Jt}=Le;if(!Jt)return;if(!Ct.simulateTouch&&"mouse"===Ue.pointerType)return;if(Le.animating&&Ct.preventInteractionOnTransition)return;!Le.animating&&Ct.cssMode&&Ct.loop&&Le.loopFix();let Hr=Ue.target;if("wrapper"===Ct.touchEventsTarget&&!function(Re,Le){const Oe=Le.contains(Re);if(!Oe&&Le instanceof HTMLSlotElement)return[...Le.assignedElements()].includes(Re);return Oe}(Hr,Le.wrapperEl))return;if("which"in Ue&&3===Ue.which)return;if("button"in Ue&&Ue.button>0)return;if(qe.isTouched&&qe.isMoved)return;const Jr=!!Ct.noSwipingClass&&""!==Ct.noSwipingClass,Ln=Ue.composedPath?Ue.composedPath():Ue.path;Jr&&Ue.target&&Ue.target.shadowRoot&&Ln&&(Hr=Ln[0]);const Nn=Ct.noSwipingSelector?Ct.noSwipingSelector:`.${Ct.noSwipingClass}`,$n=!(!Ue.target||!Ue.target.shadowRoot);if(Ct.noSwiping&&($n?function(Re,Le){return void 0===Le&&(Le=this),function __closestFrom(Le){if(!Le||Le===getDocument()||Le===getWindow())return null;Le.assignedSlot&&(Le=Le.assignedSlot);const Oe=Le.closest(Re);return Oe||Le.getRootNode?Oe||__closestFrom(Le.getRootNode().host):null}(Le)}(Nn,Hr):Hr.closest(Nn)))return void(Le.allowClick=!0);if(Ct.swipeHandler&&!Hr.closest(Ct.swipeHandler))return;Ot.currentX=Ue.pageX,Ot.currentY=Ue.pageY;const Gn=Ot.currentX,qn=Ot.currentY;if(!preventEdgeSwipe(Le,Ue,Gn))return;Object.assign(qe,{isTouched:!0,isMoved:!1,allowTouchCallbacks:!0,isScrolling:void 0,startMoving:void 0}),Ot.startX=Gn,Ot.startY=qn,qe.touchStartTime=now(),Le.allowClick=!0,Le.updateSize(),Le.swipeDirection=void 0,Ct.threshold>0&&(qe.allowThresholdMove=!1);let Zn=!0;Hr.matches(qe.focusableElements)&&(Zn=!1,"SELECT"===Hr.nodeName&&(qe.isTouched=!1)),Oe.activeElement&&Oe.activeElement.matches(qe.focusableElements)&&Oe.activeElement!==Hr&&("mouse"===Ue.pointerType||"mouse"!==Ue.pointerType&&!Hr.matches(qe.focusableElements))&&Oe.activeElement.blur();const Xn=Zn&&Le.allowTouchMove&&Ct.touchStartPreventDefault;!Ct.touchStartForcePreventDefault&&!Xn||Hr.isContentEditable||Ue.preventDefault(),Ct.freeMode&&Ct.freeMode.enabled&&Le.freeMode&&Le.animating&&!Ct.cssMode&&Le.freeMode.onTouchStart(),Le.emit("touchStart",Ue)}function onTouchMove(Re){const Le=getDocument(),Oe=this,Ue=Oe.touchEventsData,{params:qe,touches:Ct,rtlTranslate:Ot,enabled:Jt}=Oe;if(!Jt)return;if(!qe.simulateTouch&&"mouse"===Re.pointerType)return;let Hr,Jr=Re;if(Jr.originalEvent&&(Jr=Jr.originalEvent),"pointermove"===Jr.type){if(null!==Ue.touchId)return;if(Jr.pointerId!==Ue.pointerId)return}if("touchmove"===Jr.type){if(Hr=[...Jr.changedTouches].filter((Re=>Re.identifier===Ue.touchId))[0],!Hr||Hr.identifier!==Ue.touchId)return}else Hr=Jr;if(!Ue.isTouched)return void(Ue.startMoving&&Ue.isScrolling&&Oe.emit("touchMoveOpposite",Jr));const Ln=Hr.pageX,Nn=Hr.pageY;if(Jr.preventedByNestedSwiper)return Ct.startX=Ln,void(Ct.startY=Nn);if(!Oe.allowTouchMove)return Jr.target.matches(Ue.focusableElements)||(Oe.allowClick=!1),void(Ue.isTouched&&(Object.assign(Ct,{startX:Ln,startY:Nn,currentX:Ln,currentY:Nn}),Ue.touchStartTime=now()));if(qe.touchReleaseOnEdges&&!qe.loop)if(Oe.isVertical()){if(Nn<Ct.startY&&Oe.translate<=Oe.maxTranslate()||Nn>Ct.startY&&Oe.translate>=Oe.minTranslate())return Ue.isTouched=!1,void(Ue.isMoved=!1)}else if(Ln<Ct.startX&&Oe.translate<=Oe.maxTranslate()||Ln>Ct.startX&&Oe.translate>=Oe.minTranslate())return;if(Le.activeElement&&Le.activeElement.matches(Ue.focusableElements)&&Le.activeElement!==Jr.target&&"mouse"!==Jr.pointerType&&Le.activeElement.blur(),Le.activeElement&&Jr.target===Le.activeElement&&Jr.target.matches(Ue.focusableElements))return Ue.isMoved=!0,void(Oe.allowClick=!1);Ue.allowTouchCallbacks&&Oe.emit("touchMove",Jr),Ct.previousX=Ct.currentX,Ct.previousY=Ct.currentY,Ct.currentX=Ln,Ct.currentY=Nn;const $n=Ct.currentX-Ct.startX,Gn=Ct.currentY-Ct.startY;if(Oe.params.threshold&&Math.sqrt($n**2+Gn**2)<Oe.params.threshold)return;if(void 0===Ue.isScrolling){let Re;Oe.isHorizontal()&&Ct.currentY===Ct.startY||Oe.isVertical()&&Ct.currentX===Ct.startX?Ue.isScrolling=!1:$n*$n+Gn*Gn>=25&&(Re=180*Math.atan2(Math.abs(Gn),Math.abs($n))/Math.PI,Ue.isScrolling=Oe.isHorizontal()?Re>qe.touchAngle:90-Re>qe.touchAngle)}if(Ue.isScrolling&&Oe.emit("touchMoveOpposite",Jr),void 0===Ue.startMoving&&(Ct.currentX===Ct.startX&&Ct.currentY===Ct.startY||(Ue.startMoving=!0)),Ue.isScrolling||"touchmove"===Jr.type&&Ue.preventTouchMoveFromPointerMove)return void(Ue.isTouched=!1);if(!Ue.startMoving)return;Oe.allowClick=!1,!qe.cssMode&&Jr.cancelable&&Jr.preventDefault(),qe.touchMoveStopPropagation&&!qe.nested&&Jr.stopPropagation();let qn=Oe.isHorizontal()?$n:Gn,Zn=Oe.isHorizontal()?Ct.currentX-Ct.previousX:Ct.currentY-Ct.previousY;qe.oneWayMovement&&(qn=Math.abs(qn)*(Ot?1:-1),Zn=Math.abs(Zn)*(Ot?1:-1)),Ct.diff=qn,qn*=qe.touchRatio,Ot&&(qn=-qn,Zn=-Zn);const Xn=Oe.touchesDirection;Oe.swipeDirection=qn>0?"prev":"next",Oe.touchesDirection=Zn>0?"prev":"next";const Yn=Oe.params.loop&&!qe.cssMode,_i="next"===Oe.touchesDirection&&Oe.allowSlideNext||"prev"===Oe.touchesDirection&&Oe.allowSlidePrev;if(!Ue.isMoved){if(Yn&&_i&&Oe.loopFix({direction:Oe.swipeDirection}),Ue.startTranslate=Oe.getTranslate(),Oe.setTransition(0),Oe.animating){const Re=new window.CustomEvent("transitionend",{bubbles:!0,cancelable:!0,detail:{bySwiperTouchMove:!0}});Oe.wrapperEl.dispatchEvent(Re)}Ue.allowMomentumBounce=!1,!qe.grabCursor||!0!==Oe.allowSlideNext&&!0!==Oe.allowSlidePrev||Oe.setGrabCursor(!0),Oe.emit("sliderFirstMove",Jr)}if((new Date).getTime(),Ue.isMoved&&Ue.allowThresholdMove&&Xn!==Oe.touchesDirection&&Yn&&_i&&Math.abs(qn)>=1)return Object.assign(Ct,{startX:Ln,startY:Nn,currentX:Ln,currentY:Nn,startTranslate:Ue.currentTranslate}),Ue.loopSwapReset=!0,void(Ue.startTranslate=Ue.currentTranslate);Oe.emit("sliderMove",Jr),Ue.isMoved=!0,Ue.currentTranslate=qn+Ue.startTranslate;let vi=!0,xi=qe.resistanceRatio;if(qe.touchReleaseOnEdges&&(xi=0),qn>0?(Yn&&_i&&Ue.allowThresholdMove&&Ue.currentTranslate>(qe.centeredSlides?Oe.minTranslate()-Oe.slidesSizesGrid[Oe.activeIndex+1]-("auto"!==qe.slidesPerView&&Oe.slides.length-qe.slidesPerView>=2?Oe.slidesSizesGrid[Oe.activeIndex+1]+Oe.params.spaceBetween:0)-Oe.params.spaceBetween:Oe.minTranslate())&&Oe.loopFix({direction:"prev",setTranslate:!0,activeSlideIndex:0}),Ue.currentTranslate>Oe.minTranslate()&&(vi=!1,qe.resistance&&(Ue.currentTranslate=Oe.minTranslate()-1+(-Oe.minTranslate()+Ue.startTranslate+qn)**xi))):qn<0&&(Yn&&_i&&Ue.allowThresholdMove&&Ue.currentTranslate<(qe.centeredSlides?Oe.maxTranslate()+Oe.slidesSizesGrid[Oe.slidesSizesGrid.length-1]+Oe.params.spaceBetween+("auto"!==qe.slidesPerView&&Oe.slides.length-qe.slidesPerView>=2?Oe.slidesSizesGrid[Oe.slidesSizesGrid.length-1]+Oe.params.spaceBetween:0):Oe.maxTranslate())&&Oe.loopFix({direction:"next",setTranslate:!0,activeSlideIndex:Oe.slides.length-("auto"===qe.slidesPerView?Oe.slidesPerViewDynamic():Math.ceil(parseFloat(qe.slidesPerView,10)))}),Ue.currentTranslate<Oe.maxTranslate()&&(vi=!1,qe.resistance&&(Ue.currentTranslate=Oe.maxTranslate()+1-(Oe.maxTranslate()-Ue.startTranslate-qn)**xi))),vi&&(Jr.preventedByNestedSwiper=!0),!Oe.allowSlideNext&&"next"===Oe.swipeDirection&&Ue.currentTranslate<Ue.startTranslate&&(Ue.currentTranslate=Ue.startTranslate),!Oe.allowSlidePrev&&"prev"===Oe.swipeDirection&&Ue.currentTranslate>Ue.startTranslate&&(Ue.currentTranslate=Ue.startTranslate),Oe.allowSlidePrev||Oe.allowSlideNext||(Ue.currentTranslate=Ue.startTranslate),qe.threshold>0){if(!(Math.abs(qn)>qe.threshold||Ue.allowThresholdMove))return void(Ue.currentTranslate=Ue.startTranslate);if(!Ue.allowThresholdMove)return Ue.allowThresholdMove=!0,Ct.startX=Ct.currentX,Ct.startY=Ct.currentY,Ue.currentTranslate=Ue.startTranslate,void(Ct.diff=Oe.isHorizontal()?Ct.currentX-Ct.startX:Ct.currentY-Ct.startY)}qe.followFinger&&!qe.cssMode&&((qe.freeMode&&qe.freeMode.enabled&&Oe.freeMode||qe.watchSlidesProgress)&&(Oe.updateActiveIndex(),Oe.updateSlidesClasses()),qe.freeMode&&qe.freeMode.enabled&&Oe.freeMode&&Oe.freeMode.onTouchMove(),Oe.updateProgress(Ue.currentTranslate),Oe.setTranslate(Ue.currentTranslate))}function onTouchEnd(Re){const Le=this,Oe=Le.touchEventsData;let Ue,qe=Re;qe.originalEvent&&(qe=qe.originalEvent);if("touchend"===qe.type||"touchcancel"===qe.type){if(Ue=[...qe.changedTouches].filter((Re=>Re.identifier===Oe.touchId))[0],!Ue||Ue.identifier!==Oe.touchId)return}else{if(null!==Oe.touchId)return;if(qe.pointerId!==Oe.pointerId)return;Ue=qe}if(["pointercancel","pointerout","pointerleave","contextmenu"].includes(qe.type)){if(!(["pointercancel","contextmenu"].includes(qe.type)&&(Le.browser.isSafari||Le.browser.isWebView)))return}Oe.pointerId=null,Oe.touchId=null;const{params:Ct,touches:Ot,rtlTranslate:Jt,slidesGrid:Hr,enabled:Jr}=Le;if(!Jr)return;if(!Ct.simulateTouch&&"mouse"===qe.pointerType)return;if(Oe.allowTouchCallbacks&&Le.emit("touchEnd",qe),Oe.allowTouchCallbacks=!1,!Oe.isTouched)return Oe.isMoved&&Ct.grabCursor&&Le.setGrabCursor(!1),Oe.isMoved=!1,void(Oe.startMoving=!1);Ct.grabCursor&&Oe.isMoved&&Oe.isTouched&&(!0===Le.allowSlideNext||!0===Le.allowSlidePrev)&&Le.setGrabCursor(!1);const Ln=now(),Nn=Ln-Oe.touchStartTime;if(Le.allowClick){const Re=qe.path||qe.composedPath&&qe.composedPath();Le.updateClickedSlide(Re&&Re[0]||qe.target,Re),Le.emit("tap click",qe),Nn<300&&Ln-Oe.lastClickTime<300&&Le.emit("doubleTap doubleClick",qe)}if(Oe.lastClickTime=now(),nextTick((()=>{Le.destroyed||(Le.allowClick=!0)})),!Oe.isTouched||!Oe.isMoved||!Le.swipeDirection||0===Ot.diff&&!Oe.loopSwapReset||Oe.currentTranslate===Oe.startTranslate&&!Oe.loopSwapReset)return Oe.isTouched=!1,Oe.isMoved=!1,void(Oe.startMoving=!1);let $n;if(Oe.isTouched=!1,Oe.isMoved=!1,Oe.startMoving=!1,$n=Ct.followFinger?Jt?Le.translate:-Le.translate:-Oe.currentTranslate,Ct.cssMode)return;if(Ct.freeMode&&Ct.freeMode.enabled)return void Le.freeMode.onTouchEnd({currentPos:$n});const Gn=$n>=-Le.maxTranslate()&&!Le.params.loop;let qn=0,Zn=Le.slidesSizesGrid[0];for(let Re=0;Re<Hr.length;Re+=Re<Ct.slidesPerGroupSkip?1:Ct.slidesPerGroup){const Le=Re<Ct.slidesPerGroupSkip-1?1:Ct.slidesPerGroup;void 0!==Hr[Re+Le]?(Gn||$n>=Hr[Re]&&$n<Hr[Re+Le])&&(qn=Re,Zn=Hr[Re+Le]-Hr[Re]):(Gn||$n>=Hr[Re])&&(qn=Re,Zn=Hr[Hr.length-1]-Hr[Hr.length-2])}let Xn=null,Yn=null;Ct.rewind&&(Le.isBeginning?Yn=Ct.virtual&&Ct.virtual.enabled&&Le.virtual?Le.virtual.slides.length-1:Le.slides.length-1:Le.isEnd&&(Xn=0));const _i=($n-Hr[qn])/Zn,vi=qn<Ct.slidesPerGroupSkip-1?1:Ct.slidesPerGroup;if(Nn>Ct.longSwipesMs){if(!Ct.longSwipes)return void Le.slideTo(Le.activeIndex);"next"===Le.swipeDirection&&(_i>=Ct.longSwipesRatio?Le.slideTo(Ct.rewind&&Le.isEnd?Xn:qn+vi):Le.slideTo(qn)),"prev"===Le.swipeDirection&&(_i>1-Ct.longSwipesRatio?Le.slideTo(qn+vi):null!==Yn&&_i<0&&Math.abs(_i)>Ct.longSwipesRatio?Le.slideTo(Yn):Le.slideTo(qn))}else{if(!Ct.shortSwipes)return void Le.slideTo(Le.activeIndex);Le.navigation&&(qe.target===Le.navigation.nextEl||qe.target===Le.navigation.prevEl)?qe.target===Le.navigation.nextEl?Le.slideTo(qn+vi):Le.slideTo(qn):("next"===Le.swipeDirection&&Le.slideTo(null!==Xn?Xn:qn+vi),"prev"===Le.swipeDirection&&Le.slideTo(null!==Yn?Yn:qn))}}function onResize(){const Re=this,{params:Le,el:Oe}=Re;if(Oe&&0===Oe.offsetWidth)return;Le.breakpoints&&Re.setBreakpoint();const{allowSlideNext:Ue,allowSlidePrev:qe,snapGrid:Ct}=Re,Ot=Re.virtual&&Re.params.virtual.enabled;Re.allowSlideNext=!0,Re.allowSlidePrev=!0,Re.updateSize(),Re.updateSlides(),Re.updateSlidesClasses();const Jt=Ot&&Le.loop;!("auto"===Le.slidesPerView||Le.slidesPerView>1)||!Re.isEnd||Re.isBeginning||Re.params.centeredSlides||Jt?Re.params.loop&&!Ot?Re.slideToLoop(Re.realIndex,0,!1,!0):Re.slideTo(Re.activeIndex,0,!1,!0):Re.slideTo(Re.slides.length-1,0,!1,!0),Re.autoplay&&Re.autoplay.running&&Re.autoplay.paused&&(clearTimeout(Re.autoplay.resizeTimeout),Re.autoplay.resizeTimeout=setTimeout((()=>{Re.autoplay&&Re.autoplay.running&&Re.autoplay.paused&&Re.autoplay.resume()}),500)),Re.allowSlidePrev=qe,Re.allowSlideNext=Ue,Re.params.watchOverflow&&Ct!==Re.snapGrid&&Re.checkOverflow()}function onClick(Re){const Le=this;Le.enabled&&(Le.allowClick||(Le.params.preventClicks&&Re.preventDefault(),Le.params.preventClicksPropagation&&Le.animating&&(Re.stopPropagation(),Re.stopImmediatePropagation())))}function onScroll(){const Re=this,{wrapperEl:Le,rtlTranslate:Oe,enabled:Ue}=Re;if(!Ue)return;let qe;Re.previousTranslate=Re.translate,Re.isHorizontal()?Re.translate=-Le.scrollLeft:Re.translate=-Le.scrollTop,0===Re.translate&&(Re.translate=0),Re.updateActiveIndex(),Re.updateSlidesClasses();const Ct=Re.maxTranslate()-Re.minTranslate();qe=0===Ct?0:(Re.translate-Re.minTranslate())/Ct,qe!==Re.progress&&Re.updateProgress(Oe?-Re.translate:Re.translate),Re.emit("setTranslate",Re.translate,!1)}function onLoad(Re){const Le=this;processLazyPreloader(Le,Re.target),Le.params.cssMode||"auto"!==Le.params.slidesPerView&&!Le.params.autoHeight||Le.update()}function onDocumentTouchStart(){const Re=this;Re.documentTouchHandlerProceeded||(Re.documentTouchHandlerProceeded=!0,Re.params.touchReleaseOnEdges&&(Re.el.style.touchAction="auto"))}const events=(Re,Le)=>{const Oe=getDocument(),{params:Ue,el:qe,wrapperEl:Ct,device:Ot}=Re,Jt=!!Ue.nested,Hr="on"===Le?"addEventListener":"removeEventListener",Jr=Le;qe&&"string"!=typeof qe&&(Oe[Hr]("touchstart",Re.onDocumentTouchStart,{passive:!1,capture:Jt}),qe[Hr]("touchstart",Re.onTouchStart,{passive:!1}),qe[Hr]("pointerdown",Re.onTouchStart,{passive:!1}),Oe[Hr]("touchmove",Re.onTouchMove,{passive:!1,capture:Jt}),Oe[Hr]("pointermove",Re.onTouchMove,{passive:!1,capture:Jt}),Oe[Hr]("touchend",Re.onTouchEnd,{passive:!0}),Oe[Hr]("pointerup",Re.onTouchEnd,{passive:!0}),Oe[Hr]("pointercancel",Re.onTouchEnd,{passive:!0}),Oe[Hr]("touchcancel",Re.onTouchEnd,{passive:!0}),Oe[Hr]("pointerout",Re.onTouchEnd,{passive:!0}),Oe[Hr]("pointerleave",Re.onTouchEnd,{passive:!0}),Oe[Hr]("contextmenu",Re.onTouchEnd,{passive:!0}),(Ue.preventClicks||Ue.preventClicksPropagation)&&qe[Hr]("click",Re.onClick,!0),Ue.cssMode&&Ct[Hr]("scroll",Re.onScroll),Ue.updateOnWindowResize?Re[Jr](Ot.ios||Ot.android?"resize orientationchange observerUpdate":"resize observerUpdate",onResize,!0):Re[Jr]("observerUpdate",onResize,!0),qe[Hr]("load",Re.onLoad,{capture:!0}))};const isGridEnabled=(Re,Le)=>Re.grid&&Le.grid&&Le.grid.rows>1;var TA={addClasses:function(){const Re=this,{classNames:Le,params:Oe,rtl:Ue,el:qe,device:Ct}=Re,Ot=function(Re,Le){const Oe=[];return Re.forEach((Re=>{"object"==typeof Re?Object.keys(Re).forEach((Ue=>{Re[Ue]&&Oe.push(Le+Ue)})):"string"==typeof Re&&Oe.push(Le+Re)})),Oe}(["initialized",Oe.direction,{"free-mode":Re.params.freeMode&&Oe.freeMode.enabled},{autoheight:Oe.autoHeight},{rtl:Ue},{grid:Oe.grid&&Oe.grid.rows>1},{"grid-column":Oe.grid&&Oe.grid.rows>1&&"column"===Oe.grid.fill},{android:Ct.android},{ios:Ct.ios},{"css-mode":Oe.cssMode},{centered:Oe.cssMode&&Oe.centeredSlides},{"watch-progress":Oe.watchSlidesProgress}],Oe.containerModifierClass);Le.push(...Ot),qe.classList.add(...Le),Re.emitContainerClasses()},removeClasses:function(){const{el:Re,classNames:Le}=this;Re&&"string"!=typeof Re&&(Re.classList.remove(...Le),this.emitContainerClasses())}};var SA={init:!0,direction:"horizontal",oneWayMovement:!1,swiperElementNodeName:"SWIPER-CONTAINER",touchEventsTarget:"wrapper",initialSlide:0,speed:300,cssMode:!1,updateOnWindowResize:!0,resizeObserver:!0,nested:!1,createElements:!1,eventsPrefix:"swiper",enabled:!0,focusableElements:"input, select, option, textarea, button, video, label",width:null,height:null,preventInteractionOnTransition:!1,userAgent:null,url:null,edgeSwipeDetection:!1,edgeSwipeThreshold:20,autoHeight:!1,setWrapperSize:!1,virtualTranslate:!1,effect:"slide",breakpoints:void 0,breakpointsBase:"window",spaceBetween:0,slidesPerView:1,slidesPerGroup:1,slidesPerGroupSkip:0,slidesPerGroupAuto:!1,centeredSlides:!1,centeredSlidesBounds:!1,slidesOffsetBefore:0,slidesOffsetAfter:0,normalizeSlideIndex:!0,centerInsufficientSlides:!1,watchOverflow:!0,roundLengths:!1,touchRatio:1,touchAngle:45,simulateTouch:!0,shortSwipes:!0,longSwipes:!0,longSwipesRatio:.5,longSwipesMs:300,followFinger:!0,allowTouchMove:!0,threshold:5,touchMoveStopPropagation:!1,touchStartPreventDefault:!0,touchStartForcePreventDefault:!1,touchReleaseOnEdges:!1,uniqueNavElements:!0,resistance:!0,resistanceRatio:.85,watchSlidesProgress:!1,grabCursor:!1,preventClicks:!0,preventClicksPropagation:!0,slideToClickedSlide:!1,loop:!1,loopAddBlankSlides:!0,loopAdditionalSlides:0,loopPreventsSliding:!0,rewind:!1,allowSlidePrev:!0,allowSlideNext:!0,swipeHandler:null,noSwiping:!0,noSwipingClass:"swiper-no-swiping",noSwipingSelector:null,passiveListeners:!0,maxBackfaceHiddenSlides:10,containerModifierClass:"swiper-",slideClass:"swiper-slide",slideBlankClass:"swiper-slide-blank",slideActiveClass:"swiper-slide-active",slideVisibleClass:"swiper-slide-visible",slideFullyVisibleClass:"swiper-slide-fully-visible",slideNextClass:"swiper-slide-next",slidePrevClass:"swiper-slide-prev",wrapperClass:"swiper-wrapper",lazyPreloaderClass:"swiper-lazy-preloader",lazyPreloadPrevNext:0,runCallbacksOnInit:!0,_emitClasses:!1};function moduleExtendParams(Re,Le){return function(Oe){void 0===Oe&&(Oe={});const Ue=Object.keys(Oe)[0],qe=Oe[Ue];"object"==typeof qe&&null!==qe?(!0===Re[Ue]&&(Re[Ue]={enabled:!0}),"navigation"===Ue&&Re[Ue]&&Re[Ue].enabled&&!Re[Ue].prevEl&&!Re[Ue].nextEl&&(Re[Ue].auto=!0),["pagination","scrollbar"].indexOf(Ue)>=0&&Re[Ue]&&Re[Ue].enabled&&!Re[Ue].el&&(Re[Ue].auto=!0),Ue in Re&&"enabled"in qe?("object"!=typeof Re[Ue]||"enabled"in Re[Ue]||(Re[Ue].enabled=!0),Re[Ue]||(Re[Ue]={enabled:!1}),extend$1(Le,Oe)):extend$1(Le,Oe)):extend$1(Le,Oe)}}const EA={eventsEmitter:yA,update:vA,translate:xA,transition:{setTransition:function(Re,Le){const Oe=this;Oe.params.cssMode||(Oe.wrapperEl.style.transitionDuration=`${Re}ms`,Oe.wrapperEl.style.transitionDelay=0===Re?"0ms":""),Oe.emit("setTransition",Re,Le)},transitionStart:function(Re,Le){void 0===Re&&(Re=!0);const Oe=this,{params:Ue}=Oe;Ue.cssMode||(Ue.autoHeight&&Oe.updateAutoHeight(),transitionEmit({swiper:Oe,runCallbacks:Re,direction:Le,step:"Start"}))},transitionEnd:function(Re,Le){void 0===Re&&(Re=!0);const Oe=this,{params:Ue}=Oe;Oe.animating=!1,Ue.cssMode||(Oe.setTransition(0),transitionEmit({swiper:Oe,runCallbacks:Re,direction:Le,step:"End"}))}},slide:bA,loop:wA,grabCursor:{setGrabCursor:function(Re){const Le=this;if(!Le.params.simulateTouch||Le.params.watchOverflow&&Le.isLocked||Le.params.cssMode)return;const Oe="container"===Le.params.touchEventsTarget?Le.el:Le.wrapperEl;Le.isElement&&(Le.__preventObserver__=!0),Oe.style.cursor="move",Oe.style.cursor=Re?"grabbing":"grab",Le.isElement&&requestAnimationFrame((()=>{Le.__preventObserver__=!1}))},unsetGrabCursor:function(){const Re=this;Re.params.watchOverflow&&Re.isLocked||Re.params.cssMode||(Re.isElement&&(Re.__preventObserver__=!0),Re["container"===Re.params.touchEventsTarget?"el":"wrapperEl"].style.cursor="",Re.isElement&&requestAnimationFrame((()=>{Re.__preventObserver__=!1})))}},events:{attachEvents:function(){const Re=this,{params:Le}=Re;Re.onTouchStart=onTouchStart.bind(Re),Re.onTouchMove=onTouchMove.bind(Re),Re.onTouchEnd=onTouchEnd.bind(Re),Re.onDocumentTouchStart=onDocumentTouchStart.bind(Re),Le.cssMode&&(Re.onScroll=onScroll.bind(Re)),Re.onClick=onClick.bind(Re),Re.onLoad=onLoad.bind(Re),events(Re,"on")},detachEvents:function(){events(this,"off")}},breakpoints:{setBreakpoint:function(){const Re=this,{realIndex:Le,initialized:Oe,params:Ue,el:qe}=Re,Ct=Ue.breakpoints;if(!Ct||Ct&&0===Object.keys(Ct).length)return;const Ot=Re.getBreakpoint(Ct,Re.params.breakpointsBase,Re.el);if(!Ot||Re.currentBreakpoint===Ot)return;const Jt=(Ot in Ct?Ct[Ot]:void 0)||Re.originalParams,Hr=isGridEnabled(Re,Ue),Jr=isGridEnabled(Re,Jt),Ln=Re.params.grabCursor,Nn=Jt.grabCursor,$n=Ue.enabled;Hr&&!Jr?(qe.classList.remove(`${Ue.containerModifierClass}grid`,`${Ue.containerModifierClass}grid-column`),Re.emitContainerClasses()):!Hr&&Jr&&(qe.classList.add(`${Ue.containerModifierClass}grid`),(Jt.grid.fill&&"column"===Jt.grid.fill||!Jt.grid.fill&&"column"===Ue.grid.fill)&&qe.classList.add(`${Ue.containerModifierClass}grid-column`),Re.emitContainerClasses()),Ln&&!Nn?Re.unsetGrabCursor():!Ln&&Nn&&Re.setGrabCursor(),["navigation","pagination","scrollbar"].forEach((Le=>{if(void 0===Jt[Le])return;const Oe=Ue[Le]&&Ue[Le].enabled,qe=Jt[Le]&&Jt[Le].enabled;Oe&&!qe&&Re[Le].disable(),!Oe&&qe&&Re[Le].enable()}));const Gn=Jt.direction&&Jt.direction!==Ue.direction,qn=Ue.loop&&(Jt.slidesPerView!==Ue.slidesPerView||Gn),Zn=Ue.loop;Gn&&Oe&&Re.changeDirection(),extend$1(Re.params,Jt);const Xn=Re.params.enabled,Yn=Re.params.loop;Object.assign(Re,{allowTouchMove:Re.params.allowTouchMove,allowSlideNext:Re.params.allowSlideNext,allowSlidePrev:Re.params.allowSlidePrev}),$n&&!Xn?Re.disable():!$n&&Xn&&Re.enable(),Re.currentBreakpoint=Ot,Re.emit("_beforeBreakpoint",Jt),Oe&&(qn?(Re.loopDestroy(),Re.loopCreate(Le),Re.updateSlides()):!Zn&&Yn?(Re.loopCreate(Le),Re.updateSlides()):Zn&&!Yn&&Re.loopDestroy()),Re.emit("breakpoint",Jt)},getBreakpoint:function(Re,Le,Oe){if(void 0===Le&&(Le="window"),!Re||"container"===Le&&!Oe)return;let Ue=!1;const qe=getWindow(),Ct="window"===Le?qe.innerHeight:Oe.clientHeight,Ot=Object.keys(Re).map((Re=>{if("string"==typeof Re&&0===Re.indexOf("@")){const Le=parseFloat(Re.substr(1));return{value:Ct*Le,point:Re}}return{value:Re,point:Re}}));Ot.sort(((Re,Le)=>parseInt(Re.value,10)-parseInt(Le.value,10)));for(let Re=0;Re<Ot.length;Re+=1){const{point:Ct,value:Jt}=Ot[Re];"window"===Le?qe.matchMedia(`(min-width: ${Jt}px)`).matches&&(Ue=Ct):Jt<=Oe.clientWidth&&(Ue=Ct)}return Ue||"max"}},checkOverflow:{checkOverflow:function(){const Re=this,{isLocked:Le,params:Oe}=Re,{slidesOffsetBefore:Ue}=Oe;if(Ue){const Le=Re.slides.length-1,Oe=Re.slidesGrid[Le]+Re.slidesSizesGrid[Le]+2*Ue;Re.isLocked=Re.size>Oe}else Re.isLocked=1===Re.snapGrid.length;!0===Oe.allowSlideNext&&(Re.allowSlideNext=!Re.isLocked),!0===Oe.allowSlidePrev&&(Re.allowSlidePrev=!Re.isLocked),Le&&Le!==Re.isLocked&&(Re.isEnd=!1),Le!==Re.isLocked&&Re.emit(Re.isLocked?"lock":"unlock")}},classes:TA},CA={};let AA=class Swiper{constructor(){let Re,Le;for(var Oe=arguments.length,Ue=new Array(Oe),qe=0;qe<Oe;qe++)Ue[qe]=arguments[qe];1===Ue.length&&Ue[0].constructor&&"Object"===Object.prototype.toString.call(Ue[0]).slice(8,-1)?Le=Ue[0]:[Re,Le]=Ue,Le||(Le={}),Le=extend$1({},Le),Re&&!Le.el&&(Le.el=Re);const Ct=getDocument();if(Le.el&&"string"==typeof Le.el&&Ct.querySelectorAll(Le.el).length>1){const Re=[];return Ct.querySelectorAll(Le.el).forEach((Oe=>{const Ue=extend$1({},Le,{el:Oe});Re.push(new Swiper(Ue))})),Re}const Ot=this;Ot.__swiper__=!0,Ot.support=getSupport(),Ot.device=getDevice({userAgent:Le.userAgent}),Ot.browser=getBrowser(),Ot.eventsListeners={},Ot.eventsAnyListeners=[],Ot.modules=[...Ot.__modules__],Le.modules&&Array.isArray(Le.modules)&&Ot.modules.push(...Le.modules);const Jt={};Ot.modules.forEach((Re=>{Re({params:Le,swiper:Ot,extendParams:moduleExtendParams(Le,Jt),on:Ot.on.bind(Ot),once:Ot.once.bind(Ot),off:Ot.off.bind(Ot),emit:Ot.emit.bind(Ot)})}));const Hr=extend$1({},SA,Jt);return Ot.params=extend$1({},Hr,CA,Le),Ot.originalParams=extend$1({},Ot.params),Ot.passedParams=extend$1({},Le),Ot.params&&Ot.params.on&&Object.keys(Ot.params.on).forEach((Re=>{Ot.on(Re,Ot.params.on[Re])})),Ot.params&&Ot.params.onAny&&Ot.onAny(Ot.params.onAny),Object.assign(Ot,{enabled:Ot.params.enabled,el:Re,classNames:[],slides:[],slidesGrid:[],snapGrid:[],slidesSizesGrid:[],isHorizontal:()=>"horizontal"===Ot.params.direction,isVertical:()=>"vertical"===Ot.params.direction,activeIndex:0,realIndex:0,isBeginning:!0,isEnd:!1,translate:0,previousTranslate:0,progress:0,velocity:0,animating:!1,cssOverflowAdjustment(){return Math.trunc(this.translate/2**23)*2**23},allowSlideNext:Ot.params.allowSlideNext,allowSlidePrev:Ot.params.allowSlidePrev,touchEventsData:{isTouched:void 0,isMoved:void 0,allowTouchCallbacks:void 0,touchStartTime:void 0,isScrolling:void 0,currentTranslate:void 0,startTranslate:void 0,allowThresholdMove:void 0,focusableElements:Ot.params.focusableElements,lastClickTime:0,clickTimeout:void 0,velocities:[],allowMomentumBounce:void 0,startMoving:void 0,pointerId:null,touchId:null},allowClick:!0,allowTouchMove:Ot.params.allowTouchMove,touches:{startX:0,startY:0,currentX:0,currentY:0,diff:0},imagesToLoad:[],imagesLoaded:0}),Ot.emit("_swiper"),Ot.params.init&&Ot.init(),Ot}getDirectionLabel(Re){return this.isHorizontal()?Re:{width:"height","margin-top":"margin-left","margin-bottom ":"margin-right","margin-left":"margin-top","margin-right":"margin-bottom","padding-left":"padding-top","padding-right":"padding-bottom",marginRight:"marginBottom"}[Re]}getSlideIndex(Re){const{slidesEl:Le,params:Oe}=this,Ue=elementIndex(elementChildren(Le,`.${Oe.slideClass}, swiper-slide`)[0]);return elementIndex(Re)-Ue}getSlideIndexByData(Re){return this.getSlideIndex(this.slides.filter((Le=>1*Le.getAttribute("data-swiper-slide-index")===Re))[0])}recalcSlides(){const{slidesEl:Re,params:Le}=this;this.slides=elementChildren(Re,`.${Le.slideClass}, swiper-slide`)}enable(){const Re=this;Re.enabled||(Re.enabled=!0,Re.params.grabCursor&&Re.setGrabCursor(),Re.emit("enable"))}disable(){const Re=this;Re.enabled&&(Re.enabled=!1,Re.params.grabCursor&&Re.unsetGrabCursor(),Re.emit("disable"))}setProgress(Re,Le){const Oe=this;Re=Math.min(Math.max(Re,0),1);const Ue=Oe.minTranslate(),qe=(Oe.maxTranslate()-Ue)*Re+Ue;Oe.translateTo(qe,void 0===Le?0:Le),Oe.updateActiveIndex(),Oe.updateSlidesClasses()}emitContainerClasses(){const Re=this;if(!Re.params._emitClasses||!Re.el)return;const Le=Re.el.className.split(" ").filter((Le=>0===Le.indexOf("swiper")||0===Le.indexOf(Re.params.containerModifierClass)));Re.emit("_containerClasses",Le.join(" "))}getSlideClasses(Re){const Le=this;return Le.destroyed?"":Re.className.split(" ").filter((Re=>0===Re.indexOf("swiper-slide")||0===Re.indexOf(Le.params.slideClass))).join(" ")}emitSlidesClasses(){const Re=this;if(!Re.params._emitClasses||!Re.el)return;const Le=[];Re.slides.forEach((Oe=>{const Ue=Re.getSlideClasses(Oe);Le.push({slideEl:Oe,classNames:Ue}),Re.emit("_slideClass",Oe,Ue)})),Re.emit("_slideClasses",Le)}slidesPerViewDynamic(Re,Le){void 0===Re&&(Re="current"),void 0===Le&&(Le=!1);const{params:Oe,slides:Ue,slidesGrid:qe,slidesSizesGrid:Ct,size:Ot,activeIndex:Jt}=this;let Hr=1;if("number"==typeof Oe.slidesPerView)return Oe.slidesPerView;if(Oe.centeredSlides){let Re,Le=Ue[Jt]?Math.ceil(Ue[Jt].swiperSlideSize):0;for(let Oe=Jt+1;Oe<Ue.length;Oe+=1)Ue[Oe]&&!Re&&(Le+=Math.ceil(Ue[Oe].swiperSlideSize),Hr+=1,Le>Ot&&(Re=!0));for(let Oe=Jt-1;Oe>=0;Oe-=1)Ue[Oe]&&!Re&&(Le+=Ue[Oe].swiperSlideSize,Hr+=1,Le>Ot&&(Re=!0))}else if("current"===Re)for(let Re=Jt+1;Re<Ue.length;Re+=1){(Le?qe[Re]+Ct[Re]-qe[Jt]<Ot:qe[Re]-qe[Jt]<Ot)&&(Hr+=1)}else for(let Re=Jt-1;Re>=0;Re-=1){qe[Jt]-qe[Re]<Ot&&(Hr+=1)}return Hr}update(){const Re=this;if(!Re||Re.destroyed)return;const{snapGrid:Le,params:Oe}=Re;function setTranslate(){const Le=Re.rtlTranslate?-1*Re.translate:Re.translate,Oe=Math.min(Math.max(Le,Re.maxTranslate()),Re.minTranslate());Re.setTranslate(Oe),Re.updateActiveIndex(),Re.updateSlidesClasses()}let Ue;if(Oe.breakpoints&&Re.setBreakpoint(),[...Re.el.querySelectorAll('[loading="lazy"]')].forEach((Le=>{Le.complete&&processLazyPreloader(Re,Le)})),Re.updateSize(),Re.updateSlides(),Re.updateProgress(),Re.updateSlidesClasses(),Oe.freeMode&&Oe.freeMode.enabled&&!Oe.cssMode)setTranslate(),Oe.autoHeight&&Re.updateAutoHeight();else{if(("auto"===Oe.slidesPerView||Oe.slidesPerView>1)&&Re.isEnd&&!Oe.centeredSlides){const Le=Re.virtual&&Oe.virtual.enabled?Re.virtual.slides:Re.slides;Ue=Re.slideTo(Le.length-1,0,!1,!0)}else Ue=Re.slideTo(Re.activeIndex,0,!1,!0);Ue||setTranslate()}Oe.watchOverflow&&Le!==Re.snapGrid&&Re.checkOverflow(),Re.emit("update")}changeDirection(Re,Le){void 0===Le&&(Le=!0);const Oe=this,Ue=Oe.params.direction;return Re||(Re="horizontal"===Ue?"vertical":"horizontal"),Re===Ue||"horizontal"!==Re&&"vertical"!==Re||(Oe.el.classList.remove(`${Oe.params.containerModifierClass}${Ue}`),Oe.el.classList.add(`${Oe.params.containerModifierClass}${Re}`),Oe.emitContainerClasses(),Oe.params.direction=Re,Oe.slides.forEach((Le=>{"vertical"===Re?Le.style.width="":Le.style.height=""})),Oe.emit("changeDirection"),Le&&Oe.update()),Oe}changeLanguageDirection(Re){const Le=this;Le.rtl&&"rtl"===Re||!Le.rtl&&"ltr"===Re||(Le.rtl="rtl"===Re,Le.rtlTranslate="horizontal"===Le.params.direction&&Le.rtl,Le.rtl?(Le.el.classList.add(`${Le.params.containerModifierClass}rtl`),Le.el.dir="rtl"):(Le.el.classList.remove(`${Le.params.containerModifierClass}rtl`),Le.el.dir="ltr"),Le.update())}mount(Re){const Le=this;if(Le.mounted)return!0;let Oe=Re||Le.params.el;if("string"==typeof Oe&&(Oe=document.querySelector(Oe)),!Oe)return!1;Oe.swiper=Le,Oe.parentNode&&Oe.parentNode.host&&Oe.parentNode.host.nodeName===Le.params.swiperElementNodeName.toUpperCase()&&(Le.isElement=!0);const getWrapperSelector=()=>`.${(Le.params.wrapperClass||"").trim().split(" ").join(".")}`;let Ue=(()=>{if(Oe&&Oe.shadowRoot&&Oe.shadowRoot.querySelector){return Oe.shadowRoot.querySelector(getWrapperSelector())}return elementChildren(Oe,getWrapperSelector())[0]})();return!Ue&&Le.params.createElements&&(Ue=createElement("div",Le.params.wrapperClass),Oe.append(Ue),elementChildren(Oe,`.${Le.params.slideClass}`).forEach((Re=>{Ue.append(Re)}))),Object.assign(Le,{el:Oe,wrapperEl:Ue,slidesEl:Le.isElement&&!Oe.parentNode.host.slideSlots?Oe.parentNode.host:Ue,hostEl:Le.isElement?Oe.parentNode.host:Oe,mounted:!0,rtl:"rtl"===Oe.dir.toLowerCase()||"rtl"===elementStyle(Oe,"direction"),rtlTranslate:"horizontal"===Le.params.direction&&("rtl"===Oe.dir.toLowerCase()||"rtl"===elementStyle(Oe,"direction")),wrongRTL:"-webkit-box"===elementStyle(Ue,"display")}),!0}init(Re){const Le=this;if(Le.initialized)return Le;if(!1===Le.mount(Re))return Le;Le.emit("beforeInit"),Le.params.breakpoints&&Le.setBreakpoint(),Le.addClasses(),Le.updateSize(),Le.updateSlides(),Le.params.watchOverflow&&Le.checkOverflow(),Le.params.grabCursor&&Le.enabled&&Le.setGrabCursor(),Le.params.loop&&Le.virtual&&Le.params.virtual.enabled?Le.slideTo(Le.params.initialSlide+Le.virtual.slidesBefore,0,Le.params.runCallbacksOnInit,!1,!0):Le.slideTo(Le.params.initialSlide,0,Le.params.runCallbacksOnInit,!1,!0),Le.params.loop&&Le.loopCreate(),Le.attachEvents();const Oe=[...Le.el.querySelectorAll('[loading="lazy"]')];return Le.isElement&&Oe.push(...Le.hostEl.querySelectorAll('[loading="lazy"]')),Oe.forEach((Re=>{Re.complete?processLazyPreloader(Le,Re):Re.addEventListener("load",(Re=>{processLazyPreloader(Le,Re.target)}))})),preload(Le),Le.initialized=!0,preload(Le),Le.emit("init"),Le.emit("afterInit"),Le}destroy(Re,Le){void 0===Re&&(Re=!0),void 0===Le&&(Le=!0);const Oe=this,{params:Ue,el:qe,wrapperEl:Ct,slides:Ot}=Oe;return void 0===Oe.params||Oe.destroyed||(Oe.emit("beforeDestroy"),Oe.initialized=!1,Oe.detachEvents(),Ue.loop&&Oe.loopDestroy(),Le&&(Oe.removeClasses(),qe&&"string"!=typeof qe&&qe.removeAttribute("style"),Ct&&Ct.removeAttribute("style"),Ot&&Ot.length&&Ot.forEach((Re=>{Re.classList.remove(Ue.slideVisibleClass,Ue.slideFullyVisibleClass,Ue.slideActiveClass,Ue.slideNextClass,Ue.slidePrevClass),Re.removeAttribute("style"),Re.removeAttribute("data-swiper-slide-index")}))),Oe.emit("destroy"),Object.keys(Oe.eventsListeners).forEach((Re=>{Oe.off(Re)})),!1!==Re&&(Oe.el&&"string"!=typeof Oe.el&&(Oe.el.swiper=null),function(Re){const Le=Re;Object.keys(Le).forEach((Re=>{try{Le[Re]=null}catch(Re){}try{delete Le[Re]}catch(Re){}}))}(Oe)),Oe.destroyed=!0),null}static extendDefaults(Re){extend$1(CA,Re)}static get extendedDefaults(){return CA}static get defaults(){return SA}static installModule(Re){Swiper.prototype.__modules__||(Swiper.prototype.__modules__=[]);const Le=Swiper.prototype.__modules__;"function"==typeof Re&&Le.indexOf(Re)<0&&Le.push(Re)}static use(Re){return Array.isArray(Re)?(Re.forEach((Re=>Swiper.installModule(Re))),Swiper):(Swiper.installModule(Re),Swiper)}};Object.keys(EA).forEach((Re=>{Object.keys(EA[Re]).forEach((Le=>{AA.prototype[Le]=EA[Re][Le]}))})),AA.use([function(Re){let{swiper:Le,on:Oe,emit:Ue}=Re;const qe=getWindow();let Ct=null,Ot=null;const resizeHandler=()=>{Le&&!Le.destroyed&&Le.initialized&&(Ue("beforeResize"),Ue("resize"))},orientationChangeHandler=()=>{Le&&!Le.destroyed&&Le.initialized&&Ue("orientationchange")};Oe("init",(()=>{Le.params.resizeObserver&&void 0!==qe.ResizeObserver?Le&&!Le.destroyed&&Le.initialized&&(Ct=new ResizeObserver((Re=>{Ot=qe.requestAnimationFrame((()=>{const{width:Oe,height:Ue}=Le;let qe=Oe,Ct=Ue;Re.forEach((Re=>{let{contentBoxSize:Oe,contentRect:Ue,target:Ot}=Re;Ot&&Ot!==Le.el||(qe=Ue?Ue.width:(Oe[0]||Oe).inlineSize,Ct=Ue?Ue.height:(Oe[0]||Oe).blockSize)})),qe===Oe&&Ct===Ue||resizeHandler()}))})),Ct.observe(Le.el)):(qe.addEventListener("resize",resizeHandler),qe.addEventListener("orientationchange",orientationChangeHandler))})),Oe("destroy",(()=>{Ot&&qe.cancelAnimationFrame(Ot),Ct&&Ct.unobserve&&Le.el&&(Ct.unobserve(Le.el),Ct=null),qe.removeEventListener("resize",resizeHandler),qe.removeEventListener("orientationchange",orientationChangeHandler)}))},function(Re){let{swiper:Le,extendParams:Oe,on:Ue,emit:qe}=Re;const Ct=[],Ot=getWindow(),attach=function(Re,Oe){void 0===Oe&&(Oe={});const Ue=new(Ot.MutationObserver||Ot.WebkitMutationObserver)((Re=>{if(Le.__preventObserver__)return;if(1===Re.length)return void qe("observerUpdate",Re[0]);const observerUpdate=function(){qe("observerUpdate",Re[0])};Ot.requestAnimationFrame?Ot.requestAnimationFrame(observerUpdate):Ot.setTimeout(observerUpdate,0)}));Ue.observe(Re,{attributes:void 0===Oe.attributes||Oe.attributes,childList:Le.isElement||(void 0===Oe.childList||Oe).childList,characterData:void 0===Oe.characterData||Oe.characterData}),Ct.push(Ue)};Oe({observer:!1,observeParents:!1,observeSlideChildren:!1}),Ue("init",(()=>{if(Le.params.observer){if(Le.params.observeParents){const Re=function(Re){const Le=[];let Oe=Re.parentElement;for(;Oe;)Le.push(Oe),Oe=Oe.parentElement;return Le}(Le.hostEl);for(let Le=0;Le<Re.length;Le+=1)attach(Re[Le])}attach(Le.hostEl,{childList:Le.params.observeSlideChildren}),attach(Le.wrapperEl,{attributes:!1})}})),Ue("destroy",(()=>{Ct.forEach((Re=>{Re.disconnect()})),Ct.splice(0,Ct.length)}))}]);const IA=["eventsPrefix","injectStyles","injectStylesUrls","modules","init","_direction","oneWayMovement","swiperElementNodeName","touchEventsTarget","initialSlide","_speed","cssMode","updateOnWindowResize","resizeObserver","nested","focusableElements","_enabled","_width","_height","preventInteractionOnTransition","userAgent","url","_edgeSwipeDetection","_edgeSwipeThreshold","_freeMode","_autoHeight","setWrapperSize","virtualTranslate","_effect","breakpoints","breakpointsBase","_spaceBetween","_slidesPerView","maxBackfaceHiddenSlides","_grid","_slidesPerGroup","_slidesPerGroupSkip","_slidesPerGroupAuto","_centeredSlides","_centeredSlidesBounds","_slidesOffsetBefore","_slidesOffsetAfter","normalizeSlideIndex","_centerInsufficientSlides","_watchOverflow","roundLengths","touchRatio","touchAngle","simulateTouch","_shortSwipes","_longSwipes","longSwipesRatio","longSwipesMs","_followFinger","allowTouchMove","_threshold","touchMoveStopPropagation","touchStartPreventDefault","touchStartForcePreventDefault","touchReleaseOnEdges","uniqueNavElements","_resistance","_resistanceRatio","_watchSlidesProgress","_grabCursor","preventClicks","preventClicksPropagation","_slideToClickedSlide","_loop","loopAdditionalSlides","loopAddBlankSlides","loopPreventsSliding","_rewind","_allowSlidePrev","_allowSlideNext","_swipeHandler","_noSwiping","noSwipingClass","noSwipingSelector","passiveListeners","containerModifierClass","slideClass","slideActiveClass","slideVisibleClass","slideFullyVisibleClass","slideNextClass","slidePrevClass","slideBlankClass","wrapperClass","lazyPreloaderClass","lazyPreloadPrevNext","runCallbacksOnInit","observer","observeParents","observeSlideChildren","a11y","_autoplay","_controller","coverflowEffect","cubeEffect","fadeEffect","flipEffect","creativeEffect","cardsEffect","hashNavigation","history","keyboard","mousewheel","_navigation","_pagination","parallax","_scrollbar","_thumbs","virtual","zoom","control"];function isObject(Re){return"object"==typeof Re&&null!==Re&&Re.constructor&&"Object"===Object.prototype.toString.call(Re).slice(8,-1)&&!Re.__swiper__}function extend(Re,Le){const Oe=["__proto__","constructor","prototype"];Object.keys(Le).filter((Re=>Oe.indexOf(Re)<0)).forEach((Oe=>{void 0===Re[Oe]?Re[Oe]=Le[Oe]:isObject(Le[Oe])&&isObject(Re[Oe])&&Object.keys(Le[Oe]).length>0?Le[Oe].__swiper__?Re[Oe]=Le[Oe]:extend(Re[Oe],Le[Oe]):Re[Oe]=Le[Oe]}))}function needsNavigation(Re){return void 0===Re&&(Re={}),Re.navigation&&void 0===Re.navigation.nextEl&&void 0===Re.navigation.prevEl}function needsPagination(Re){return void 0===Re&&(Re={}),Re.pagination&&void 0===Re.pagination.el}function needsScrollbar(Re){return void 0===Re&&(Re={}),Re.scrollbar&&void 0===Re.scrollbar.el}function uniqueClasses(Re){void 0===Re&&(Re="");const Le=Re.split(" ").map((Re=>Re.trim())).filter((Re=>!!Re)),Oe=[];return Le.forEach((Re=>{Oe.indexOf(Re)<0&&Oe.push(Re)})),Oe.join(" ")}function getParams(Re,Le){void 0===Re&&(Re={});const Oe={on:{}},Ue={};extend(Oe,SA),Oe._emitClasses=!0,Oe.init=!1;const qe={},Ct=IA.map((Re=>Re.replace(/_/,""))),Ot=Object.assign({},Re);return Object.keys(Ot).forEach((Le=>{void 0!==Re[Le]&&(Ct.indexOf(Le)>=0?isObject(Re[Le])?(Oe[Le]={},Ue[Le]={},extend(Oe[Le],Re[Le]),extend(Ue[Le],Re[Le])):(Oe[Le]=Re[Le],Ue[Le]=Re[Le]):0===Le.search(/on[A-Z]/)&&"function"==typeof Re[Le]?Oe.on[`${Le[2].toLowerCase()}${Le.substr(3)}`]=Re[Le]:qe[Le]=Re[Le])})),["navigation","pagination","scrollbar"].forEach((Re=>{!0===Oe[Re]&&(Oe[Re]={}),!1===Oe[Re]&&delete Oe[Re]})),{params:Oe,passedParams:Ue,rest:qe,events:{}}}function getChildren(Re,Le,Oe){void 0===Re&&(Re={});const Ue=[],qe={"container-start":[],"container-end":[],"wrapper-start":[],"wrapper-end":[]},getSlidesFromElements=(Re,Le)=>{Array.isArray(Re)&&Re.forEach((Re=>{const Oe="symbol"==typeof Re.type;"default"===Le&&(Le="container-end"),Oe&&Re.children?getSlidesFromElements(Re.children,Le):Re.type&&("SwiperSlide"===Re.type.name||"AsyncComponentWrapper"===Re.type.name)||Re.componentOptions&&"SwiperSlide"===Re.componentOptions.tag?Ue.push(Re):qe[Le]&&qe[Le].push(Re)}))};return Object.keys(Re).forEach((Le=>{if("function"!=typeof Re[Le])return;const Oe=Re[Le]();getSlidesFromElements(Oe,Le)})),Oe.value=Le.value,Le.value=Ue,{slides:Ue,slots:qe}}const kA={name:"Swiper",props:{tag:{type:String,default:"div"},wrapperTag:{type:String,default:"div"},modules:{type:Array,default:void 0},init:{type:Boolean,default:void 0},direction:{type:String,default:void 0},oneWayMovement:{type:Boolean,default:void 0},swiperElementNodeName:{type:String,default:"SWIPER-CONTAINER"},touchEventsTarget:{type:String,default:void 0},initialSlide:{type:Number,default:void 0},speed:{type:Number,default:void 0},cssMode:{type:Boolean,default:void 0},updateOnWindowResize:{type:Boolean,default:void 0},resizeObserver:{type:Boolean,default:void 0},nested:{type:Boolean,default:void 0},focusableElements:{type:String,default:void 0},width:{type:Number,default:void 0},height:{type:Number,default:void 0},preventInteractionOnTransition:{type:Boolean,default:void 0},userAgent:{type:String,default:void 0},url:{type:String,default:void 0},edgeSwipeDetection:{type:[Boolean,String],default:void 0},edgeSwipeThreshold:{type:Number,default:void 0},autoHeight:{type:Boolean,default:void 0},setWrapperSize:{type:Boolean,default:void 0},virtualTranslate:{type:Boolean,default:void 0},effect:{type:String,default:void 0},breakpoints:{type:Object,default:void 0},breakpointsBase:{type:String,default:void 0},spaceBetween:{type:[Number,String],default:void 0},slidesPerView:{type:[Number,String],default:void 0},maxBackfaceHiddenSlides:{type:Number,default:void 0},slidesPerGroup:{type:Number,default:void 0},slidesPerGroupSkip:{type:Number,default:void 0},slidesPerGroupAuto:{type:Boolean,default:void 0},centeredSlides:{type:Boolean,default:void 0},centeredSlidesBounds:{type:Boolean,default:void 0},slidesOffsetBefore:{type:Number,default:void 0},slidesOffsetAfter:{type:Number,default:void 0},normalizeSlideIndex:{type:Boolean,default:void 0},centerInsufficientSlides:{type:Boolean,default:void 0},watchOverflow:{type:Boolean,default:void 0},roundLengths:{type:Boolean,default:void 0},touchRatio:{type:Number,default:void 0},touchAngle:{type:Number,default:void 0},simulateTouch:{type:Boolean,default:void 0},shortSwipes:{type:Boolean,default:void 0},longSwipes:{type:Boolean,default:void 0},longSwipesRatio:{type:Number,default:void 0},longSwipesMs:{type:Number,default:void 0},followFinger:{type:Boolean,default:void 0},allowTouchMove:{type:Boolean,default:void 0},threshold:{type:Number,default:void 0},touchMoveStopPropagation:{type:Boolean,default:void 0},touchStartPreventDefault:{type:Boolean,default:void 0},touchStartForcePreventDefault:{type:Boolean,default:void 0},touchReleaseOnEdges:{type:Boolean,default:void 0},uniqueNavElements:{type:Boolean,default:void 0},resistance:{type:Boolean,default:void 0},resistanceRatio:{type:Number,default:void 0},watchSlidesProgress:{type:Boolean,default:void 0},grabCursor:{type:Boolean,default:void 0},preventClicks:{type:Boolean,default:void 0},preventClicksPropagation:{type:Boolean,default:void 0},slideToClickedSlide:{type:Boolean,default:void 0},loop:{type:Boolean,default:void 0},loopedSlides:{type:Number,default:void 0},loopPreventsSliding:{type:Boolean,default:void 0},rewind:{type:Boolean,default:void 0},allowSlidePrev:{type:Boolean,default:void 0},allowSlideNext:{type:Boolean,default:void 0},swipeHandler:{type:Boolean,default:void 0},noSwiping:{type:Boolean,default:void 0},noSwipingClass:{type:String,default:void 0},noSwipingSelector:{type:String,default:void 0},passiveListeners:{type:Boolean,default:void 0},containerModifierClass:{type:String,default:void 0},slideClass:{type:String,default:void 0},slideActiveClass:{type:String,default:void 0},slideVisibleClass:{type:String,default:void 0},slideFullyVisibleClass:{type:String,default:void 0},slideBlankClass:{type:String,default:void 0},slideNextClass:{type:String,default:void 0},slidePrevClass:{type:String,default:void 0},wrapperClass:{type:String,default:void 0},lazyPreloaderClass:{type:String,default:void 0},lazyPreloadPrevNext:{type:Number,default:void 0},runCallbacksOnInit:{type:Boolean,default:void 0},observer:{type:Boolean,default:void 0},observeParents:{type:Boolean,default:void 0},observeSlideChildren:{type:Boolean,default:void 0},a11y:{type:[Boolean,Object],default:void 0},autoplay:{type:[Boolean,Object],default:void 0},controller:{type:Object,default:void 0},coverflowEffect:{type:Object,default:void 0},cubeEffect:{type:Object,default:void 0},fadeEffect:{type:Object,default:void 0},flipEffect:{type:Object,default:void 0},creativeEffect:{type:Object,default:void 0},cardsEffect:{type:Object,default:void 0},hashNavigation:{type:[Boolean,Object],default:void 0},history:{type:[Boolean,Object],default:void 0},keyboard:{type:[Boolean,Object],default:void 0},mousewheel:{type:[Boolean,Object],default:void 0},navigation:{type:[Boolean,Object],default:void 0},pagination:{type:[Boolean,Object],default:void 0},parallax:{type:[Boolean,Object],default:void 0},scrollbar:{type:[Boolean,Object],default:void 0},thumbs:{type:Object,default:void 0},virtual:{type:[Boolean,Object],default:void 0},zoom:{type:[Boolean,Object],default:void 0},grid:{type:[Object],default:void 0},freeMode:{type:[Boolean,Object],default:void 0},enabled:{type:Boolean,default:void 0}},emits:["_beforeBreakpoint","_containerClasses","_slideClass","_slideClasses","_swiper","_freeModeNoMomentumRelease","activeIndexChange","afterInit","autoplay","autoplayStart","autoplayStop","autoplayPause","autoplayResume","autoplayTimeLeft","beforeDestroy","beforeInit","beforeLoopFix","beforeResize","beforeSlideChangeStart","beforeTransitionStart","breakpoint","changeDirection","click","disable","doubleTap","doubleClick","destroy","enable","fromEdge","hashChange","hashSet","init","keyPress","lock","loopFix","momentumBounce","navigationHide","navigationShow","navigationPrev","navigationNext","observerUpdate","orientationchange","paginationHide","paginationRender","paginationShow","paginationUpdate","progress","reachBeginning","reachEnd","realIndexChange","resize","scroll","scrollbarDragEnd","scrollbarDragMove","scrollbarDragStart","setTransition","setTranslate","slidesUpdated","slideChange","slideChangeTransitionEnd","slideChangeTransitionStart","slideNextTransitionEnd","slideNextTransitionStart","slidePrevTransitionEnd","slidePrevTransitionStart","slideResetTransitionStart","slideResetTransitionEnd","sliderMove","sliderFirstMove","slidesLengthChange","slidesGridLengthChange","snapGridLengthChange","snapIndexChange","swiper","tap","toEdge","touchEnd","touchMove","touchMoveOpposite","touchStart","transitionEnd","transitionStart","unlock","update","virtualUpdate","zoomChange"],setup(Re,Le){let{slots:Oe,emit:Ue}=Le;const{tag:qe,wrapperTag:Ct}=Re,Ot=ref("swiper"),Jt=ref(null),Hr=ref(!1),Jr=ref(!1),Ln=ref(null),Nn=ref(null),$n=ref(null),Gn={value:[]},qn={value:[]},Zn=ref(null),Xn=ref(null),Yn=ref(null),_i=ref(null),{params:vi,passedParams:xi}=getParams(Re);getChildren(Oe,Gn,qn),$n.value=xi,qn.value=Gn.value;vi.onAny=function(Re){for(var Le=arguments.length,Oe=new Array(Le>1?Le-1:0),qe=1;qe<Le;qe++)Oe[qe-1]=arguments[qe];Ue(Re,...Oe)},Object.assign(vi.on,{_beforeBreakpoint:()=>{getChildren(Oe,Gn,qn),Hr.value=!0},_containerClasses(Re,Le){Ot.value=Le}});const bi={...vi};if(delete bi.wrapperClass,Nn.value=new AA(bi),Nn.value.virtual&&Nn.value.params.virtual.enabled){Nn.value.virtual.slides=Gn.value;const Re={cache:!1,slides:Gn.value,renderExternal:Re=>{Jt.value=Re},renderExternalUpdate:!1};extend(Nn.value.params.virtual,Re),extend(Nn.value.originalParams.virtual,Re)}function renderSlides(Re){return vi.virtual?function(Re,Le,Oe){if(!Oe)return null;const getSlideIndex=Re=>{let Oe=Re;return Re<0?Oe=Le.length+Re:Oe>=Le.length&&(Oe-=Le.length),Oe},Ue=Re.value.isHorizontal()?{[Re.value.rtlTranslate?"right":"left"]:`${Oe.offset}px`}:{top:`${Oe.offset}px`},{from:qe,to:Ct}=Oe,Ot=Re.value.params.loop?-Le.length:0,Jt=Re.value.params.loop?2*Le.length:Le.length,Hr=[];for(let Re=Ot;Re<Jt;Re+=1)Re>=qe&&Re<=Ct&&Hr.length<Le.length&&Hr.push(Le[getSlideIndex(Re)]);return Hr.map((Le=>(Le.props||(Le.props={}),Le.props.style||(Le.props.style={}),Le.props.swiperRef=Re,Le.props.style=Ue,Le.type?h(Le.type,{...Le.props},Le.children):Le.componentOptions?h(Le.componentOptions.Ctor,{...Le.props},Le.componentOptions.children):void 0)))}(Nn,Re,Jt.value):(Re.forEach(((Re,Le)=>{Re.props||(Re.props={}),Re.props.swiperRef=Nn,Re.props.swiperSlideIndex=Le})),Re)}return gb((()=>{!Jr.value&&Nn.value&&(Nn.value.emitSlidesClasses(),Jr.value=!0);const{passedParams:Le}=getParams(Re),Oe=function(Re,Le,Oe,Ue,qe){const Ct=[];if(!Le)return Ct;const addKey=Re=>{Ct.indexOf(Re)<0&&Ct.push(Re)};if(Oe&&Ue){const Re=Ue.map(qe),Le=Oe.map(qe);Re.join("")!==Le.join("")&&addKey("children"),Ue.length!==Oe.length&&addKey("children")}return IA.filter((Re=>"_"===Re[0])).map((Re=>Re.replace(/_/,""))).forEach((Oe=>{if(Oe in Re&&Oe in Le)if(isObject(Re[Oe])&&isObject(Le[Oe])){const Ue=Object.keys(Re[Oe]),qe=Object.keys(Le[Oe]);Ue.length!==qe.length?addKey(Oe):(Ue.forEach((Ue=>{Re[Oe][Ue]!==Le[Oe][Ue]&&addKey(Oe)})),qe.forEach((Ue=>{Re[Oe][Ue]!==Le[Oe][Ue]&&addKey(Oe)})))}else Re[Oe]!==Le[Oe]&&addKey(Oe)})),Ct}(Le,$n.value,Gn.value,qn.value,(Re=>Re.props&&Re.props.key));$n.value=Le,(Oe.length||Hr.value)&&Nn.value&&!Nn.value.destroyed&&function(Re){let{swiper:Le,slides:Oe,passedParams:Ue,changedParams:qe,nextEl:Ct,prevEl:Ot,scrollbarEl:Jt,paginationEl:Hr}=Re;const Jr=qe.filter((Re=>"children"!==Re&&"direction"!==Re&&"wrapperClass"!==Re)),{params:Ln,pagination:Nn,navigation:$n,scrollbar:Gn,virtual:qn,thumbs:Zn}=Le;let Xn,Yn,_i,vi,xi,bi,Pi,lo;qe.includes("thumbs")&&Ue.thumbs&&Ue.thumbs.swiper&&Ln.thumbs&&!Ln.thumbs.swiper&&(Xn=!0),qe.includes("controller")&&Ue.controller&&Ue.controller.control&&Ln.controller&&!Ln.controller.control&&(Yn=!0),qe.includes("pagination")&&Ue.pagination&&(Ue.pagination.el||Hr)&&(Ln.pagination||!1===Ln.pagination)&&Nn&&!Nn.el&&(_i=!0),qe.includes("scrollbar")&&Ue.scrollbar&&(Ue.scrollbar.el||Jt)&&(Ln.scrollbar||!1===Ln.scrollbar)&&Gn&&!Gn.el&&(vi=!0),qe.includes("navigation")&&Ue.navigation&&(Ue.navigation.prevEl||Ot)&&(Ue.navigation.nextEl||Ct)&&(Ln.navigation||!1===Ln.navigation)&&$n&&!$n.prevEl&&!$n.nextEl&&(xi=!0);const destroyModule=Re=>{Le[Re]&&(Le[Re].destroy(),"navigation"===Re?(Le.isElement&&(Le[Re].prevEl.remove(),Le[Re].nextEl.remove()),Ln[Re].prevEl=void 0,Ln[Re].nextEl=void 0,Le[Re].prevEl=void 0,Le[Re].nextEl=void 0):(Le.isElement&&Le[Re].el.remove(),Ln[Re].el=void 0,Le[Re].el=void 0))};qe.includes("loop")&&Le.isElement&&(Ln.loop&&!Ue.loop?bi=!0:!Ln.loop&&Ue.loop?Pi=!0:lo=!0),Jr.forEach((Re=>{if(isObject(Ln[Re])&&isObject(Ue[Re]))Object.assign(Ln[Re],Ue[Re]),"navigation"!==Re&&"pagination"!==Re&&"scrollbar"!==Re||!("enabled"in Ue[Re])||Ue[Re].enabled||destroyModule(Re);else{const Le=Ue[Re];!0!==Le&&!1!==Le||"navigation"!==Re&&"pagination"!==Re&&"scrollbar"!==Re?Ln[Re]=Ue[Re]:!1===Le&&destroyModule(Re)}})),Jr.includes("controller")&&!Yn&&Le.controller&&Le.controller.control&&Ln.controller&&Ln.controller.control&&(Le.controller.control=Ln.controller.control),qe.includes("children")&&Oe&&qn&&Ln.virtual.enabled?(qn.slides=Oe,qn.update(!0)):qe.includes("virtual")&&qn&&Ln.virtual.enabled&&(Oe&&(qn.slides=Oe),qn.update(!0)),qe.includes("children")&&Oe&&Ln.loop&&(lo=!0),Xn&&Zn.init()&&Zn.update(!0);Yn&&(Le.controller.control=Ln.controller.control),_i&&(!Le.isElement||Hr&&"string"!=typeof Hr||(Hr=document.createElement("div"),Hr.classList.add("swiper-pagination"),Hr.part.add("pagination"),Le.el.appendChild(Hr)),Hr&&(Ln.pagination.el=Hr),Nn.init(),Nn.render(),Nn.update()),vi&&(!Le.isElement||Jt&&"string"!=typeof Jt||(Jt=document.createElement("div"),Jt.classList.add("swiper-scrollbar"),Jt.part.add("scrollbar"),Le.el.appendChild(Jt)),Jt&&(Ln.scrollbar.el=Jt),Gn.init(),Gn.updateSize(),Gn.setTranslate()),xi&&(Le.isElement&&(Ct&&"string"!=typeof Ct||(Ct=document.createElement("div"),Ct.classList.add("swiper-button-next"),Ct.innerHTML=Le.hostEl.constructor.nextButtonSvg,Ct.part.add("button-next"),Le.el.appendChild(Ct)),Ot&&"string"!=typeof Ot||(Ot=document.createElement("div"),Ot.classList.add("swiper-button-prev"),Ot.innerHTML=Le.hostEl.constructor.prevButtonSvg,Ot.part.add("button-prev"),Le.el.appendChild(Ot))),Ct&&(Ln.navigation.nextEl=Ct),Ot&&(Ln.navigation.prevEl=Ot),$n.init(),$n.update()),qe.includes("allowSlideNext")&&(Le.allowSlideNext=Ue.allowSlideNext),qe.includes("allowSlidePrev")&&(Le.allowSlidePrev=Ue.allowSlidePrev),qe.includes("direction")&&Le.changeDirection(Ue.direction,!1),(bi||lo)&&Le.loopDestroy(),(Pi||lo)&&Le.loopCreate(),Le.update()}({swiper:Nn.value,slides:Gn.value,passedParams:Le,changedParams:Oe,nextEl:Zn.value,prevEl:Xn.value,scrollbarEl:_i.value,paginationEl:Yn.value}),Hr.value=!1})),provide("swiper",Nn),watch(Jt,(()=>{nextTick$1((()=>{var Re;!(Re=Nn.value)||Re.destroyed||!Re.params.virtual||Re.params.virtual&&!Re.params.virtual.enabled||(Re.updateSlides(),Re.updateProgress(),Re.updateSlidesClasses(),Re.parallax&&Re.params.parallax&&Re.params.parallax.enabled&&Re.parallax.setTranslate())}))})),fb((()=>{Ln.value&&(!function(Re,Le){let{el:Oe,nextEl:Ue,prevEl:qe,paginationEl:Ct,scrollbarEl:Ot,swiper:Jt}=Re;needsNavigation(Le)&&Ue&&qe&&(Jt.params.navigation.nextEl=Ue,Jt.originalParams.navigation.nextEl=Ue,Jt.params.navigation.prevEl=qe,Jt.originalParams.navigation.prevEl=qe),needsPagination(Le)&&Ct&&(Jt.params.pagination.el=Ct,Jt.originalParams.pagination.el=Ct),needsScrollbar(Le)&&Ot&&(Jt.params.scrollbar.el=Ot,Jt.originalParams.scrollbar.el=Ot),Jt.init(Oe)}({el:Ln.value,nextEl:Zn.value,prevEl:Xn.value,paginationEl:Yn.value,scrollbarEl:_i.value,swiper:Nn.value},vi),Ue("swiper",Nn.value))})),_b((()=>{Nn.value&&!Nn.value.destroyed&&Nn.value.destroy(!0,!1)})),()=>{const{slides:Le,slots:Ue}=getChildren(Oe,Gn,qn);return h(qe,{ref:Ln,class:uniqueClasses(Ot.value)},[Ue["container-start"],h(Ct,{class:(Jt=vi.wrapperClass,void 0===Jt&&(Jt=""),Jt?Jt.includes("swiper-wrapper")?Jt:`swiper-wrapper ${Jt}`:"swiper-wrapper")},[Ue["wrapper-start"],renderSlides(Le),Ue["wrapper-end"]]),needsNavigation(Re)&&[h("div",{ref:Xn,class:"swiper-button-prev"}),h("div",{ref:Zn,class:"swiper-button-next"})],needsScrollbar(Re)&&h("div",{ref:_i,class:"swiper-scrollbar"}),needsPagination(Re)&&h("div",{ref:Yn,class:"swiper-pagination"}),Ue["container-end"]]);var Jt}}},MA={name:"SwiperSlide",props:{tag:{type:String,default:"div"},swiperRef:{type:Object,required:!1},swiperSlideIndex:{type:Number,default:void 0,required:!1},zoom:{type:Boolean,default:void 0,required:!1},lazy:{type:Boolean,default:!1,required:!1},virtualIndex:{type:[String,Number],default:void 0}},setup(Re,Le){let{slots:Oe}=Le,Ue=!1;const{swiperRef:qe}=Re,Ct=ref(null),Ot=ref("swiper-slide"),Jt=ref(!1);function updateClasses(Re,Le,Oe){Le===Ct.value&&(Ot.value=Oe)}fb((()=>{qe&&qe.value&&(qe.value.on("_slideClass",updateClasses),Ue=!0)})),mb((()=>{!Ue&&qe&&qe.value&&(qe.value.on("_slideClass",updateClasses),Ue=!0)})),gb((()=>{Ct.value&&qe&&qe.value&&(void 0!==Re.swiperSlideIndex&&(Ct.value.swiperSlideIndex=Re.swiperSlideIndex),qe.value.destroyed&&"swiper-slide"!==Ot.value&&(Ot.value="swiper-slide"))})),_b((()=>{qe&&qe.value&&qe.value.off("_slideClass",updateClasses)}));const Hr=computed((()=>({isActive:Ot.value.indexOf("swiper-slide-active")>=0,isVisible:Ot.value.indexOf("swiper-slide-visible")>=0,isPrev:Ot.value.indexOf("swiper-slide-prev")>=0,isNext:Ot.value.indexOf("swiper-slide-next")>=0})));provide("swiperSlide",Hr);const onLoad=()=>{Jt.value=!0};return()=>h(Re.tag,{class:uniqueClasses(`${Ot.value}`),ref:Ct,"data-swiper-slide-index":void 0===Re.virtualIndex&&qe&&qe.value&&qe.value.params.loop?Re.swiperSlideIndex:Re.virtualIndex,onLoadCapture:onLoad},Re.zoom?h("div",{class:"swiper-zoom-container","data-swiper-zoom":"number"==typeof Re.zoom?Re.zoom:void 0},[Oe.default&&Oe.default(Hr.value),Re.lazy&&!Jt.value&&h("div",{class:"swiper-lazy-preloader"})]):[Oe.default&&Oe.default(Hr.value),Re.lazy&&!Jt.value&&h("div",{class:"swiper-lazy-preloader"})])}};function Parallax(Re){let{swiper:Le,extendParams:Oe,on:Ue}=Re;Oe({parallax:{enabled:!1}});const qe="[data-swiper-parallax], [data-swiper-parallax-x], [data-swiper-parallax-y], [data-swiper-parallax-opacity], [data-swiper-parallax-scale]",setTransform=(Re,Oe)=>{const{rtl:Ue}=Le,qe=Ue?-1:1,Ct=Re.getAttribute("data-swiper-parallax")||"0";let Ot=Re.getAttribute("data-swiper-parallax-x"),Jt=Re.getAttribute("data-swiper-parallax-y");const Hr=Re.getAttribute("data-swiper-parallax-scale"),Jr=Re.getAttribute("data-swiper-parallax-opacity"),Ln=Re.getAttribute("data-swiper-parallax-rotate");if(Ot||Jt?(Ot=Ot||"0",Jt=Jt||"0"):Le.isHorizontal()?(Ot=Ct,Jt="0"):(Jt=Ct,Ot="0"),Ot=Ot.indexOf("%")>=0?parseInt(Ot,10)*Oe*qe+"%":Ot*Oe*qe+"px",Jt=Jt.indexOf("%")>=0?parseInt(Jt,10)*Oe+"%":Jt*Oe+"px",null!=Jr){const Le=Jr-(Jr-1)*(1-Math.abs(Oe));Re.style.opacity=Le}let Nn=`translate3d(${Ot}, ${Jt}, 0px)`;if(null!=Hr){Nn+=` scale(${Hr-(Hr-1)*(1-Math.abs(Oe))})`}if(Ln&&null!=Ln){Nn+=` rotate(${Ln*Oe*-1}deg)`}Re.style.transform=Nn},setTranslate=()=>{const{el:Re,slides:Oe,progress:Ue,snapGrid:Ct,isElement:Ot}=Le,Jt=elementChildren(Re,qe);Le.isElement&&Jt.push(...elementChildren(Le.hostEl,qe)),Jt.forEach((Re=>{setTransform(Re,Ue)})),Oe.forEach(((Re,Oe)=>{let Ot=Re.progress;Le.params.slidesPerGroup>1&&"auto"!==Le.params.slidesPerView&&(Ot+=Math.ceil(Oe/2)-Ue*(Ct.length-1)),Ot=Math.min(Math.max(Ot,-1),1),Re.querySelectorAll(`${qe}, [data-swiper-parallax-rotate]`).forEach((Re=>{setTransform(Re,Ot)}))}))};Ue("beforeInit",(()=>{Le.params.parallax.enabled&&(Le.params.watchSlidesProgress=!0,Le.originalParams.watchSlidesProgress=!0)})),Ue("init",(()=>{Le.params.parallax.enabled&&setTranslate()})),Ue("setTranslate",(()=>{Le.params.parallax.enabled&&setTranslate()})),Ue("setTransition",((Re,Oe)=>{Le.params.parallax.enabled&&function(Re){void 0===Re&&(Re=Le.params.speed);const{el:Oe,hostEl:Ue}=Le,Ct=[...Oe.querySelectorAll(qe)];Le.isElement&&Ct.push(...Ue.querySelectorAll(qe)),Ct.forEach((Le=>{let Oe=parseInt(Le.getAttribute("data-swiper-parallax-duration"),10)||Re;0===Re&&(Oe=0),Le.style.transitionDuration=`${Oe}ms`}))}(Oe)}))}function Autoplay(Re){let Le,Oe,{swiper:Ue,extendParams:qe,on:Ct,emit:Ot,params:Jt}=Re;Ue.autoplay={running:!1,paused:!1,timeLeft:0},qe({autoplay:{enabled:!1,delay:3e3,waitForTransition:!0,disableOnInteraction:!1,stopOnLastSlide:!1,reverseDirection:!1,pauseOnMouseEnter:!1}});let Hr,Jr,Ln,Nn,$n,Gn,qn,Zn,Xn=Jt&&Jt.autoplay?Jt.autoplay.delay:3e3,Yn=Jt&&Jt.autoplay?Jt.autoplay.delay:3e3,_i=(new Date).getTime();function onTransitionEnd(Re){Ue&&!Ue.destroyed&&Ue.wrapperEl&&Re.target===Ue.wrapperEl&&(Ue.wrapperEl.removeEventListener("transitionend",onTransitionEnd),Zn||Re.detail&&Re.detail.bySwiperTouchMove||resume())}const calcTimeLeft=()=>{if(Ue.destroyed||!Ue.autoplay.running)return;Ue.autoplay.paused?Jr=!0:Jr&&(Yn=Hr,Jr=!1);const Re=Ue.autoplay.paused?Hr:_i+Yn-(new Date).getTime();Ue.autoplay.timeLeft=Re,Ot("autoplayTimeLeft",Re,Re/Xn),Oe=requestAnimationFrame((()=>{calcTimeLeft()}))},run=Re=>{if(Ue.destroyed||!Ue.autoplay.running)return;cancelAnimationFrame(Oe),calcTimeLeft();let qe=void 0===Re?Ue.params.autoplay.delay:Re;Xn=Ue.params.autoplay.delay,Yn=Ue.params.autoplay.delay;const Ct=(()=>{let Re;if(Re=Ue.virtual&&Ue.params.virtual.enabled?Ue.slides.filter((Re=>Re.classList.contains("swiper-slide-active")))[0]:Ue.slides[Ue.activeIndex],!Re)return;return parseInt(Re.getAttribute("data-swiper-autoplay"),10)})();!Number.isNaN(Ct)&&Ct>0&&void 0===Re&&(qe=Ct,Xn=Ct,Yn=Ct),Hr=qe;const Jt=Ue.params.speed,proceed=()=>{Ue&&!Ue.destroyed&&(Ue.params.autoplay.reverseDirection?!Ue.isBeginning||Ue.params.loop||Ue.params.rewind?(Ue.slidePrev(Jt,!0,!0),Ot("autoplay")):Ue.params.autoplay.stopOnLastSlide||(Ue.slideTo(Ue.slides.length-1,Jt,!0,!0),Ot("autoplay")):!Ue.isEnd||Ue.params.loop||Ue.params.rewind?(Ue.slideNext(Jt,!0,!0),Ot("autoplay")):Ue.params.autoplay.stopOnLastSlide||(Ue.slideTo(0,Jt,!0,!0),Ot("autoplay")),Ue.params.cssMode&&(_i=(new Date).getTime(),requestAnimationFrame((()=>{run()}))))};return qe>0?(clearTimeout(Le),Le=setTimeout((()=>{proceed()}),qe)):requestAnimationFrame((()=>{proceed()})),qe},start=()=>{_i=(new Date).getTime(),Ue.autoplay.running=!0,run(),Ot("autoplayStart")},stop=()=>{Ue.autoplay.running=!1,clearTimeout(Le),cancelAnimationFrame(Oe),Ot("autoplayStop")},pause=(Re,Oe)=>{if(Ue.destroyed||!Ue.autoplay.running)return;clearTimeout(Le),Re||(qn=!0);const proceed=()=>{Ot("autoplayPause"),Ue.params.autoplay.waitForTransition?Ue.wrapperEl.addEventListener("transitionend",onTransitionEnd):resume()};if(Ue.autoplay.paused=!0,Oe)return Gn&&(Hr=Ue.params.autoplay.delay),Gn=!1,void proceed();const qe=Hr||Ue.params.autoplay.delay;Hr=qe-((new Date).getTime()-_i),Ue.isEnd&&Hr<0&&!Ue.params.loop||(Hr<0&&(Hr=0),proceed())},resume=()=>{Ue.isEnd&&Hr<0&&!Ue.params.loop||Ue.destroyed||!Ue.autoplay.running||(_i=(new Date).getTime(),qn?(qn=!1,run(Hr)):run(),Ue.autoplay.paused=!1,Ot("autoplayResume"))},onVisibilityChange=()=>{if(Ue.destroyed||!Ue.autoplay.running)return;const Re=getDocument();"hidden"===Re.visibilityState&&(qn=!0,pause(!0)),"visible"===Re.visibilityState&&resume()},onPointerEnter=Re=>{"mouse"===Re.pointerType&&(qn=!0,Zn=!0,Ue.animating||Ue.autoplay.paused||pause(!0))},onPointerLeave=Re=>{"mouse"===Re.pointerType&&(Zn=!1,Ue.autoplay.paused&&resume())};Ct("init",(()=>{Ue.params.autoplay.enabled&&(Ue.params.autoplay.pauseOnMouseEnter&&(Ue.el.addEventListener("pointerenter",onPointerEnter),Ue.el.addEventListener("pointerleave",onPointerLeave)),getDocument().addEventListener("visibilitychange",onVisibilityChange),start())})),Ct("destroy",(()=>{Ue.el&&"string"!=typeof Ue.el&&(Ue.el.removeEventListener("pointerenter",onPointerEnter),Ue.el.removeEventListener("pointerleave",onPointerLeave)),getDocument().removeEventListener("visibilitychange",onVisibilityChange),Ue.autoplay.running&&stop()})),Ct("_freeModeStaticRelease",(()=>{(Nn||qn)&&resume()})),Ct("_freeModeNoMomentumRelease",(()=>{Ue.params.autoplay.disableOnInteraction?stop():pause(!0,!0)})),Ct("beforeTransitionStart",((Re,Le,Oe)=>{!Ue.destroyed&&Ue.autoplay.running&&(Oe||!Ue.params.autoplay.disableOnInteraction?pause(!0,!0):stop())})),Ct("sliderFirstMove",(()=>{!Ue.destroyed&&Ue.autoplay.running&&(Ue.params.autoplay.disableOnInteraction?stop():(Ln=!0,Nn=!1,qn=!1,$n=setTimeout((()=>{qn=!0,Nn=!0,pause(!0)}),200)))})),Ct("touchEnd",(()=>{if(!Ue.destroyed&&Ue.autoplay.running&&Ln){if(clearTimeout($n),clearTimeout(Le),Ue.params.autoplay.disableOnInteraction)return Nn=!1,void(Ln=!1);Nn&&Ue.params.cssMode&&resume(),Nn=!1,Ln=!1}})),Ct("slideChange",(()=>{!Ue.destroyed&&Ue.autoplay.running&&(Gn=!0)})),Object.assign(Ue.autoplay,{start:start,stop:stop,pause:pause,resume:resume})}var PA={exports:{}};PA.exports=function(){var Re,Le,Oe;function define(Ue,qe){if(Re)if(Le){var Ct={};Re(Ct),Oe=qe(Ct)}else Le=qe;else Re=qe}define(["exports"],(function(Re){function e(Re){return Re&&Re.__esModule&&Object.prototype.hasOwnProperty.call(Re,"default")?Re.default:Re}var Le,Oe={},Ue={};function s(){if(Le)return Ue;Le=1,Object.defineProperty(Ue,"__esModule",{value:!0}),Ue.setMatrixArrayType=function(Re){Ue.ARRAY_TYPE=Oe=Re},Ue.toRadian=function(Re){return Re*Ct},Ue.equals=function(Le,Oe){return Math.abs(Le-Oe)<=Re*Math.max(1,Math.abs(Le),Math.abs(Oe))},Ue.RANDOM=Ue.ARRAY_TYPE=Ue.EPSILON=void 0;var Re=1e-6;Ue.EPSILON=Re;var Oe="undefined"!=typeof Float32Array?Float32Array:Array;Ue.ARRAY_TYPE=Oe;var qe=Math.random;Ue.RANDOM=qe;var Ct=Math.PI/180;return Math.hypot||(Math.hypot=function(){for(var Re=0,Le=arguments.length;Le--;)Re+=arguments[Le]*arguments[Le];return Math.sqrt(Re)}),Ue}var qe,Ct={};function l(){if(qe)return Ct;function t(Re){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(Re){return typeof Re}:function(Re){return Re&&"function"==typeof Symbol&&Re.constructor===Symbol&&Re!==Symbol.prototype?"symbol":typeof Re})(Re)}qe=1,Object.defineProperty(Ct,"__esModule",{value:!0}),Ct.create=function(){var Le=new Re.ARRAY_TYPE(4);return Re.ARRAY_TYPE!=Float32Array&&(Le[1]=0,Le[2]=0),Le[0]=1,Le[3]=1,Le},Ct.clone=function(Le){var Oe=new Re.ARRAY_TYPE(4);return Oe[0]=Le[0],Oe[1]=Le[1],Oe[2]=Le[2],Oe[3]=Le[3],Oe},Ct.copy=function(Re,Le){return Re[0]=Le[0],Re[1]=Le[1],Re[2]=Le[2],Re[3]=Le[3],Re},Ct.identity=function(Re){return Re[0]=1,Re[1]=0,Re[2]=0,Re[3]=1,Re},Ct.fromValues=function(Le,Oe,Ue,qe){var Ct=new Re.ARRAY_TYPE(4);return Ct[0]=Le,Ct[1]=Oe,Ct[2]=Ue,Ct[3]=qe,Ct},Ct.set=function(Re,Le,Oe,Ue,qe){return Re[0]=Le,Re[1]=Oe,Re[2]=Ue,Re[3]=qe,Re},Ct.transpose=function(Re,Le){if(Re===Le){var Oe=Le[1];Re[1]=Le[2],Re[2]=Oe}else Re[0]=Le[0],Re[1]=Le[2],Re[2]=Le[1],Re[3]=Le[3];return Re},Ct.invert=function(Re,Le){var Oe=Le[0],Ue=Le[1],qe=Le[2],Ct=Le[3],Ot=Oe*Ct-qe*Ue;return Ot?(Re[0]=Ct*(Ot=1/Ot),Re[1]=-Ue*Ot,Re[2]=-qe*Ot,Re[3]=Oe*Ot,Re):null},Ct.adjoint=function(Re,Le){var Oe=Le[0];return Re[0]=Le[3],Re[1]=-Le[1],Re[2]=-Le[2],Re[3]=Oe,Re},Ct.determinant=function(Re){return Re[0]*Re[3]-Re[2]*Re[1]},Ct.multiply=n,Ct.rotate=function(Re,Le,Oe){var Ue=Le[0],qe=Le[1],Ct=Le[2],Ot=Le[3],Jt=Math.sin(Oe),Hr=Math.cos(Oe);return Re[0]=Ue*Hr+Ct*Jt,Re[1]=qe*Hr+Ot*Jt,Re[2]=Ue*-Jt+Ct*Hr,Re[3]=qe*-Jt+Ot*Hr,Re},Ct.scale=function(Re,Le,Oe){var Ue=Le[1],qe=Le[2],Ct=Le[3],Ot=Oe[0],Jt=Oe[1];return Re[0]=Le[0]*Ot,Re[1]=Ue*Ot,Re[2]=qe*Jt,Re[3]=Ct*Jt,Re},Ct.fromRotation=function(Re,Le){var Oe=Math.sin(Le),Ue=Math.cos(Le);return Re[0]=Ue,Re[1]=Oe,Re[2]=-Oe,Re[3]=Ue,Re},Ct.fromScaling=function(Re,Le){return Re[0]=Le[0],Re[1]=0,Re[2]=0,Re[3]=Le[1],Re},Ct.str=function(Re){return"mat2("+Re[0]+", "+Re[1]+", "+Re[2]+", "+Re[3]+")"},Ct.frob=function(Re){return Math.hypot(Re[0],Re[1],Re[2],Re[3])},Ct.LDU=function(Re,Le,Oe,Ue){return Re[2]=Ue[2]/Ue[0],Oe[0]=Ue[0],Oe[1]=Ue[1],Oe[3]=Ue[3]-Re[2]*Oe[1],[Re,Le,Oe]},Ct.add=function(Re,Le,Oe){return Re[0]=Le[0]+Oe[0],Re[1]=Le[1]+Oe[1],Re[2]=Le[2]+Oe[2],Re[3]=Le[3]+Oe[3],Re},Ct.subtract=i,Ct.exactEquals=function(Re,Le){return Re[0]===Le[0]&&Re[1]===Le[1]&&Re[2]===Le[2]&&Re[3]===Le[3]},Ct.equals=function(Le,Oe){var Ue=Le[0],qe=Le[1],Ct=Le[2],Ot=Le[3],Jt=Oe[0],Hr=Oe[1],Jr=Oe[2],Ln=Oe[3];return Math.abs(Ue-Jt)<=Re.EPSILON*Math.max(1,Math.abs(Ue),Math.abs(Jt))&&Math.abs(qe-Hr)<=Re.EPSILON*Math.max(1,Math.abs(qe),Math.abs(Hr))&&Math.abs(Ct-Jr)<=Re.EPSILON*Math.max(1,Math.abs(Ct),Math.abs(Jr))&&Math.abs(Ot-Ln)<=Re.EPSILON*Math.max(1,Math.abs(Ot),Math.abs(Ln))},Ct.multiplyScalar=function(Re,Le,Oe){return Re[0]=Le[0]*Oe,Re[1]=Le[1]*Oe,Re[2]=Le[2]*Oe,Re[3]=Le[3]*Oe,Re},Ct.multiplyScalarAndAdd=function(Re,Le,Oe,Ue){return Re[0]=Le[0]+Oe[0]*Ue,Re[1]=Le[1]+Oe[1]*Ue,Re[2]=Le[2]+Oe[2]*Ue,Re[3]=Le[3]+Oe[3]*Ue,Re},Ct.sub=Ct.mul=void 0;var Re=function(Re){if(Re&&Re.__esModule)return Re;if(null===Re||"object"!==t(Re)&&"function"!=typeof Re)return{default:Re};var Le=r(void 0);if(Le&&Le.has(Re))return Le.get(Re);var Oe={},Ue=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var qe in Re)if("default"!==qe&&Object.prototype.hasOwnProperty.call(Re,qe)){var Ct=Ue?Object.getOwnPropertyDescriptor(Re,qe):null;Ct&&(Ct.get||Ct.set)?Object.defineProperty(Oe,qe,Ct):Oe[qe]=Re[qe]}return Oe.default=Re,Le&&Le.set(Re,Oe),Oe}(s());function r(Re){if("function"!=typeof WeakMap)return null;var Le=new WeakMap,Oe=new WeakMap;return(r=function(Re){return Re?Oe:Le})(Re)}function n(Re,Le,Oe){var Ue=Le[0],qe=Le[1],Ct=Le[2],Ot=Le[3],Jt=Oe[0],Hr=Oe[1],Jr=Oe[2],Ln=Oe[3];return Re[0]=Ue*Jt+Ct*Hr,Re[1]=qe*Jt+Ot*Hr,Re[2]=Ue*Jr+Ct*Ln,Re[3]=qe*Jr+Ot*Ln,Re}function i(Re,Le,Oe){return Re[0]=Le[0]-Oe[0],Re[1]=Le[1]-Oe[1],Re[2]=Le[2]-Oe[2],Re[3]=Le[3]-Oe[3],Re}return Ct.mul=n,Ct.sub=i,Ct}var Ot,Jt={};function h(){if(Ot)return Jt;function t(Re){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(Re){return typeof Re}:function(Re){return Re&&"function"==typeof Symbol&&Re.constructor===Symbol&&Re!==Symbol.prototype?"symbol":typeof Re})(Re)}Ot=1,Object.defineProperty(Jt,"__esModule",{value:!0}),Jt.create=function(){var Le=new Re.ARRAY_TYPE(6);return Re.ARRAY_TYPE!=Float32Array&&(Le[1]=0,Le[2]=0,Le[4]=0,Le[5]=0),Le[0]=1,Le[3]=1,Le},Jt.clone=function(Le){var Oe=new Re.ARRAY_TYPE(6);return Oe[0]=Le[0],Oe[1]=Le[1],Oe[2]=Le[2],Oe[3]=Le[3],Oe[4]=Le[4],Oe[5]=Le[5],Oe},Jt.copy=function(Re,Le){return Re[0]=Le[0],Re[1]=Le[1],Re[2]=Le[2],Re[3]=Le[3],Re[4]=Le[4],Re[5]=Le[5],Re},Jt.identity=function(Re){return Re[0]=1,Re[1]=0,Re[2]=0,Re[3]=1,Re[4]=0,Re[5]=0,Re},Jt.fromValues=function(Le,Oe,Ue,qe,Ct,Ot){var Jt=new Re.ARRAY_TYPE(6);return Jt[0]=Le,Jt[1]=Oe,Jt[2]=Ue,Jt[3]=qe,Jt[4]=Ct,Jt[5]=Ot,Jt},Jt.set=function(Re,Le,Oe,Ue,qe,Ct,Ot){return Re[0]=Le,Re[1]=Oe,Re[2]=Ue,Re[3]=qe,Re[4]=Ct,Re[5]=Ot,Re},Jt.invert=function(Re,Le){var Oe=Le[0],Ue=Le[1],qe=Le[2],Ct=Le[3],Ot=Le[4],Jt=Le[5],Hr=Oe*Ct-Ue*qe;return Hr?(Re[0]=Ct*(Hr=1/Hr),Re[1]=-Ue*Hr,Re[2]=-qe*Hr,Re[3]=Oe*Hr,Re[4]=(qe*Jt-Ct*Ot)*Hr,Re[5]=(Ue*Ot-Oe*Jt)*Hr,Re):null},Jt.determinant=function(Re){return Re[0]*Re[3]-Re[1]*Re[2]},Jt.multiply=n,Jt.rotate=function(Re,Le,Oe){var Ue=Le[0],qe=Le[1],Ct=Le[2],Ot=Le[3],Jt=Le[4],Hr=Le[5],Jr=Math.sin(Oe),Ln=Math.cos(Oe);return Re[0]=Ue*Ln+Ct*Jr,Re[1]=qe*Ln+Ot*Jr,Re[2]=Ue*-Jr+Ct*Ln,Re[3]=qe*-Jr+Ot*Ln,Re[4]=Jt,Re[5]=Hr,Re},Jt.scale=function(Re,Le,Oe){var Ue=Le[1],qe=Le[2],Ct=Le[3],Ot=Le[4],Jt=Le[5],Hr=Oe[0],Jr=Oe[1];return Re[0]=Le[0]*Hr,Re[1]=Ue*Hr,Re[2]=qe*Jr,Re[3]=Ct*Jr,Re[4]=Ot,Re[5]=Jt,Re},Jt.translate=function(Re,Le,Oe){var Ue=Le[0],qe=Le[1],Ct=Le[2],Ot=Le[3],Jt=Le[4],Hr=Le[5],Jr=Oe[0],Ln=Oe[1];return Re[0]=Ue,Re[1]=qe,Re[2]=Ct,Re[3]=Ot,Re[4]=Ue*Jr+Ct*Ln+Jt,Re[5]=qe*Jr+Ot*Ln+Hr,Re},Jt.fromRotation=function(Re,Le){var Oe=Math.sin(Le),Ue=Math.cos(Le);return Re[0]=Ue,Re[1]=Oe,Re[2]=-Oe,Re[3]=Ue,Re[4]=0,Re[5]=0,Re},Jt.fromScaling=function(Re,Le){return Re[0]=Le[0],Re[1]=0,Re[2]=0,Re[3]=Le[1],Re[4]=0,Re[5]=0,Re},Jt.fromTranslation=function(Re,Le){return Re[0]=1,Re[1]=0,Re[2]=0,Re[3]=1,Re[4]=Le[0],Re[5]=Le[1],Re},Jt.str=function(Re){return"mat2d("+Re[0]+", "+Re[1]+", "+Re[2]+", "+Re[3]+", "+Re[4]+", "+Re[5]+")"},Jt.frob=function(Re){return Math.hypot(Re[0],Re[1],Re[2],Re[3],Re[4],Re[5],1)},Jt.add=function(Re,Le,Oe){return Re[0]=Le[0]+Oe[0],Re[1]=Le[1]+Oe[1],Re[2]=Le[2]+Oe[2],Re[3]=Le[3]+Oe[3],Re[4]=Le[4]+Oe[4],Re[5]=Le[5]+Oe[5],Re},Jt.subtract=i,Jt.multiplyScalar=function(Re,Le,Oe){return Re[0]=Le[0]*Oe,Re[1]=Le[1]*Oe,Re[2]=Le[2]*Oe,Re[3]=Le[3]*Oe,Re[4]=Le[4]*Oe,Re[5]=Le[5]*Oe,Re},Jt.multiplyScalarAndAdd=function(Re,Le,Oe,Ue){return Re[0]=Le[0]+Oe[0]*Ue,Re[1]=Le[1]+Oe[1]*Ue,Re[2]=Le[2]+Oe[2]*Ue,Re[3]=Le[3]+Oe[3]*Ue,Re[4]=Le[4]+Oe[4]*Ue,Re[5]=Le[5]+Oe[5]*Ue,Re},Jt.exactEquals=function(Re,Le){return Re[0]===Le[0]&&Re[1]===Le[1]&&Re[2]===Le[2]&&Re[3]===Le[3]&&Re[4]===Le[4]&&Re[5]===Le[5]},Jt.equals=function(Le,Oe){var Ue=Le[0],qe=Le[1],Ct=Le[2],Ot=Le[3],Jt=Le[4],Hr=Le[5],Jr=Oe[0],Ln=Oe[1],Nn=Oe[2],$n=Oe[3],Gn=Oe[4],qn=Oe[5];return Math.abs(Ue-Jr)<=Re.EPSILON*Math.max(1,Math.abs(Ue),Math.abs(Jr))&&Math.abs(qe-Ln)<=Re.EPSILON*Math.max(1,Math.abs(qe),Math.abs(Ln))&&Math.abs(Ct-Nn)<=Re.EPSILON*Math.max(1,Math.abs(Ct),Math.abs(Nn))&&Math.abs(Ot-$n)<=Re.EPSILON*Math.max(1,Math.abs(Ot),Math.abs($n))&&Math.abs(Jt-Gn)<=Re.EPSILON*Math.max(1,Math.abs(Jt),Math.abs(Gn))&&Math.abs(Hr-qn)<=Re.EPSILON*Math.max(1,Math.abs(Hr),Math.abs(qn))},Jt.sub=Jt.mul=void 0;var Re=function(Re){if(Re&&Re.__esModule)return Re;if(null===Re||"object"!==t(Re)&&"function"!=typeof Re)return{default:Re};var Le=r(void 0);if(Le&&Le.has(Re))return Le.get(Re);var Oe={},Ue=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var qe in Re)if("default"!==qe&&Object.prototype.hasOwnProperty.call(Re,qe)){var Ct=Ue?Object.getOwnPropertyDescriptor(Re,qe):null;Ct&&(Ct.get||Ct.set)?Object.defineProperty(Oe,qe,Ct):Oe[qe]=Re[qe]}return Oe.default=Re,Le&&Le.set(Re,Oe),Oe}(s());function r(Re){if("function"!=typeof WeakMap)return null;var Le=new WeakMap,Oe=new WeakMap;return(r=function(Re){return Re?Oe:Le})(Re)}function n(Re,Le,Oe){var Ue=Le[0],qe=Le[1],Ct=Le[2],Ot=Le[3],Jt=Le[4],Hr=Le[5],Jr=Oe[0],Ln=Oe[1],Nn=Oe[2],$n=Oe[3],Gn=Oe[4],qn=Oe[5];return Re[0]=Ue*Jr+Ct*Ln,Re[1]=qe*Jr+Ot*Ln,Re[2]=Ue*Nn+Ct*$n,Re[3]=qe*Nn+Ot*$n,Re[4]=Ue*Gn+Ct*qn+Jt,Re[5]=qe*Gn+Ot*qn+Hr,Re}function i(Re,Le,Oe){return Re[0]=Le[0]-Oe[0],Re[1]=Le[1]-Oe[1],Re[2]=Le[2]-Oe[2],Re[3]=Le[3]-Oe[3],Re[4]=Le[4]-Oe[4],Re[5]=Le[5]-Oe[5],Re}return Jt.mul=n,Jt.sub=i,Jt}var Hr,Jr={};function d(){if(Hr)return Jr;function t(Re){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(Re){return typeof Re}:function(Re){return Re&&"function"==typeof Symbol&&Re.constructor===Symbol&&Re!==Symbol.prototype?"symbol":typeof Re})(Re)}Hr=1,Object.defineProperty(Jr,"__esModule",{value:!0}),Jr.create=function(){var Le=new Re.ARRAY_TYPE(9);return Re.ARRAY_TYPE!=Float32Array&&(Le[1]=0,Le[2]=0,Le[3]=0,Le[5]=0,Le[6]=0,Le[7]=0),Le[0]=1,Le[4]=1,Le[8]=1,Le},Jr.fromMat4=function(Re,Le){return Re[0]=Le[0],Re[1]=Le[1],Re[2]=Le[2],Re[3]=Le[4],Re[4]=Le[5],Re[5]=Le[6],Re[6]=Le[8],Re[7]=Le[9],Re[8]=Le[10],Re},Jr.clone=function(Le){var Oe=new Re.ARRAY_TYPE(9);return Oe[0]=Le[0],Oe[1]=Le[1],Oe[2]=Le[2],Oe[3]=Le[3],Oe[4]=Le[4],Oe[5]=Le[5],Oe[6]=Le[6],Oe[7]=Le[7],Oe[8]=Le[8],Oe},Jr.copy=function(Re,Le){return Re[0]=Le[0],Re[1]=Le[1],Re[2]=Le[2],Re[3]=Le[3],Re[4]=Le[4],Re[5]=Le[5],Re[6]=Le[6],Re[7]=Le[7],Re[8]=Le[8],Re},Jr.fromValues=function(Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr){var Ln=new Re.ARRAY_TYPE(9);return Ln[0]=Le,Ln[1]=Oe,Ln[2]=Ue,Ln[3]=qe,Ln[4]=Ct,Ln[5]=Ot,Ln[6]=Jt,Ln[7]=Hr,Ln[8]=Jr,Ln},Jr.set=function(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr){return Re[0]=Le,Re[1]=Oe,Re[2]=Ue,Re[3]=qe,Re[4]=Ct,Re[5]=Ot,Re[6]=Jt,Re[7]=Hr,Re[8]=Jr,Re},Jr.identity=function(Re){return Re[0]=1,Re[1]=0,Re[2]=0,Re[3]=0,Re[4]=1,Re[5]=0,Re[6]=0,Re[7]=0,Re[8]=1,Re},Jr.transpose=function(Re,Le){if(Re===Le){var Oe=Le[1],Ue=Le[2],qe=Le[5];Re[1]=Le[3],Re[2]=Le[6],Re[3]=Oe,Re[5]=Le[7],Re[6]=Ue,Re[7]=qe}else Re[0]=Le[0],Re[1]=Le[3],Re[2]=Le[6],Re[3]=Le[1],Re[4]=Le[4],Re[5]=Le[7],Re[6]=Le[2],Re[7]=Le[5],Re[8]=Le[8];return Re},Jr.invert=function(Re,Le){var Oe=Le[0],Ue=Le[1],qe=Le[2],Ct=Le[3],Ot=Le[4],Jt=Le[5],Hr=Le[6],Jr=Le[7],Ln=Le[8],Nn=Ln*Ot-Jt*Jr,$n=-Ln*Ct+Jt*Hr,Gn=Jr*Ct-Ot*Hr,qn=Oe*Nn+Ue*$n+qe*Gn;return qn?(Re[0]=Nn*(qn=1/qn),Re[1]=(-Ln*Ue+qe*Jr)*qn,Re[2]=(Jt*Ue-qe*Ot)*qn,Re[3]=$n*qn,Re[4]=(Ln*Oe-qe*Hr)*qn,Re[5]=(-Jt*Oe+qe*Ct)*qn,Re[6]=Gn*qn,Re[7]=(-Jr*Oe+Ue*Hr)*qn,Re[8]=(Ot*Oe-Ue*Ct)*qn,Re):null},Jr.adjoint=function(Re,Le){var Oe=Le[0],Ue=Le[1],qe=Le[2],Ct=Le[3],Ot=Le[4],Jt=Le[5],Hr=Le[6],Jr=Le[7],Ln=Le[8];return Re[0]=Ot*Ln-Jt*Jr,Re[1]=qe*Jr-Ue*Ln,Re[2]=Ue*Jt-qe*Ot,Re[3]=Jt*Hr-Ct*Ln,Re[4]=Oe*Ln-qe*Hr,Re[5]=qe*Ct-Oe*Jt,Re[6]=Ct*Jr-Ot*Hr,Re[7]=Ue*Hr-Oe*Jr,Re[8]=Oe*Ot-Ue*Ct,Re},Jr.determinant=function(Re){var Le=Re[3],Oe=Re[4],Ue=Re[5],qe=Re[6],Ct=Re[7],Ot=Re[8];return Re[0]*(Ot*Oe-Ue*Ct)+Re[1]*(-Ot*Le+Ue*qe)+Re[2]*(Ct*Le-Oe*qe)},Jr.multiply=n,Jr.translate=function(Re,Le,Oe){var Ue=Le[0],qe=Le[1],Ct=Le[2],Ot=Le[3],Jt=Le[4],Hr=Le[5],Jr=Le[6],Ln=Le[7],Nn=Le[8],$n=Oe[0],Gn=Oe[1];return Re[0]=Ue,Re[1]=qe,Re[2]=Ct,Re[3]=Ot,Re[4]=Jt,Re[5]=Hr,Re[6]=$n*Ue+Gn*Ot+Jr,Re[7]=$n*qe+Gn*Jt+Ln,Re[8]=$n*Ct+Gn*Hr+Nn,Re},Jr.rotate=function(Re,Le,Oe){var Ue=Le[0],qe=Le[1],Ct=Le[2],Ot=Le[3],Jt=Le[4],Hr=Le[5],Jr=Le[6],Ln=Le[7],Nn=Le[8],$n=Math.sin(Oe),Gn=Math.cos(Oe);return Re[0]=Gn*Ue+$n*Ot,Re[1]=Gn*qe+$n*Jt,Re[2]=Gn*Ct+$n*Hr,Re[3]=Gn*Ot-$n*Ue,Re[4]=Gn*Jt-$n*qe,Re[5]=Gn*Hr-$n*Ct,Re[6]=Jr,Re[7]=Ln,Re[8]=Nn,Re},Jr.scale=function(Re,Le,Oe){var Ue=Oe[0],qe=Oe[1];return Re[0]=Ue*Le[0],Re[1]=Ue*Le[1],Re[2]=Ue*Le[2],Re[3]=qe*Le[3],Re[4]=qe*Le[4],Re[5]=qe*Le[5],Re[6]=Le[6],Re[7]=Le[7],Re[8]=Le[8],Re},Jr.fromTranslation=function(Re,Le){return Re[0]=1,Re[1]=0,Re[2]=0,Re[3]=0,Re[4]=1,Re[5]=0,Re[6]=Le[0],Re[7]=Le[1],Re[8]=1,Re},Jr.fromRotation=function(Re,Le){var Oe=Math.sin(Le),Ue=Math.cos(Le);return Re[0]=Ue,Re[1]=Oe,Re[2]=0,Re[3]=-Oe,Re[4]=Ue,Re[5]=0,Re[6]=0,Re[7]=0,Re[8]=1,Re},Jr.fromScaling=function(Re,Le){return Re[0]=Le[0],Re[1]=0,Re[2]=0,Re[3]=0,Re[4]=Le[1],Re[5]=0,Re[6]=0,Re[7]=0,Re[8]=1,Re},Jr.fromMat2d=function(Re,Le){return Re[0]=Le[0],Re[1]=Le[1],Re[2]=0,Re[3]=Le[2],Re[4]=Le[3],Re[5]=0,Re[6]=Le[4],Re[7]=Le[5],Re[8]=1,Re},Jr.fromQuat=function(Re,Le){var Oe=Le[0],Ue=Le[1],qe=Le[2],Ct=Le[3],Ot=Oe+Oe,Jt=Ue+Ue,Hr=qe+qe,Jr=Oe*Ot,Ln=Ue*Ot,Nn=Ue*Jt,$n=qe*Ot,Gn=qe*Jt,qn=qe*Hr,Zn=Ct*Ot,Xn=Ct*Jt,Yn=Ct*Hr;return Re[0]=1-Nn-qn,Re[3]=Ln-Yn,Re[6]=$n+Xn,Re[1]=Ln+Yn,Re[4]=1-Jr-qn,Re[7]=Gn-Zn,Re[2]=$n-Xn,Re[5]=Gn+Zn,Re[8]=1-Jr-Nn,Re},Jr.normalFromMat4=function(Re,Le){var Oe=Le[0],Ue=Le[1],qe=Le[2],Ct=Le[3],Ot=Le[4],Jt=Le[5],Hr=Le[6],Jr=Le[7],Ln=Le[8],Nn=Le[9],$n=Le[10],Gn=Le[11],qn=Le[12],Zn=Le[13],Xn=Le[14],Yn=Le[15],_i=Oe*Jt-Ue*Ot,vi=Oe*Hr-qe*Ot,xi=Oe*Jr-Ct*Ot,bi=Ue*Hr-qe*Jt,Pi=Ue*Jr-Ct*Jt,lo=qe*Jr-Ct*Hr,uo=Ln*Zn-Nn*qn,po=Ln*Xn-$n*qn,fo=Ln*Yn-Gn*qn,Io=Nn*Xn-$n*Zn,is=Nn*Yn-Gn*Zn,as=$n*Yn-Gn*Xn,Is=_i*as-vi*is+xi*Io+bi*fo-Pi*po+lo*uo;return Is?(Re[0]=(Jt*as-Hr*is+Jr*Io)*(Is=1/Is),Re[1]=(Hr*fo-Ot*as-Jr*po)*Is,Re[2]=(Ot*is-Jt*fo+Jr*uo)*Is,Re[3]=(qe*is-Ue*as-Ct*Io)*Is,Re[4]=(Oe*as-qe*fo+Ct*po)*Is,Re[5]=(Ue*fo-Oe*is-Ct*uo)*Is,Re[6]=(Zn*lo-Xn*Pi+Yn*bi)*Is,Re[7]=(Xn*xi-qn*lo-Yn*vi)*Is,Re[8]=(qn*Pi-Zn*xi+Yn*_i)*Is,Re):null},Jr.projection=function(Re,Le,Oe){return Re[0]=2/Le,Re[1]=0,Re[2]=0,Re[3]=0,Re[4]=-2/Oe,Re[5]=0,Re[6]=-1,Re[7]=1,Re[8]=1,Re},Jr.str=function(Re){return"mat3("+Re[0]+", "+Re[1]+", "+Re[2]+", "+Re[3]+", "+Re[4]+", "+Re[5]+", "+Re[6]+", "+Re[7]+", "+Re[8]+")"},Jr.frob=function(Re){return Math.hypot(Re[0],Re[1],Re[2],Re[3],Re[4],Re[5],Re[6],Re[7],Re[8])},Jr.add=function(Re,Le,Oe){return Re[0]=Le[0]+Oe[0],Re[1]=Le[1]+Oe[1],Re[2]=Le[2]+Oe[2],Re[3]=Le[3]+Oe[3],Re[4]=Le[4]+Oe[4],Re[5]=Le[5]+Oe[5],Re[6]=Le[6]+Oe[6],Re[7]=Le[7]+Oe[7],Re[8]=Le[8]+Oe[8],Re},Jr.subtract=i,Jr.multiplyScalar=function(Re,Le,Oe){return Re[0]=Le[0]*Oe,Re[1]=Le[1]*Oe,Re[2]=Le[2]*Oe,Re[3]=Le[3]*Oe,Re[4]=Le[4]*Oe,Re[5]=Le[5]*Oe,Re[6]=Le[6]*Oe,Re[7]=Le[7]*Oe,Re[8]=Le[8]*Oe,Re},Jr.multiplyScalarAndAdd=function(Re,Le,Oe,Ue){return Re[0]=Le[0]+Oe[0]*Ue,Re[1]=Le[1]+Oe[1]*Ue,Re[2]=Le[2]+Oe[2]*Ue,Re[3]=Le[3]+Oe[3]*Ue,Re[4]=Le[4]+Oe[4]*Ue,Re[5]=Le[5]+Oe[5]*Ue,Re[6]=Le[6]+Oe[6]*Ue,Re[7]=Le[7]+Oe[7]*Ue,Re[8]=Le[8]+Oe[8]*Ue,Re},Jr.exactEquals=function(Re,Le){return Re[0]===Le[0]&&Re[1]===Le[1]&&Re[2]===Le[2]&&Re[3]===Le[3]&&Re[4]===Le[4]&&Re[5]===Le[5]&&Re[6]===Le[6]&&Re[7]===Le[7]&&Re[8]===Le[8]},Jr.equals=function(Le,Oe){var Ue=Le[0],qe=Le[1],Ct=Le[2],Ot=Le[3],Jt=Le[4],Hr=Le[5],Jr=Le[6],Ln=Le[7],Nn=Le[8],$n=Oe[0],Gn=Oe[1],qn=Oe[2],Zn=Oe[3],Xn=Oe[4],Yn=Oe[5],_i=Oe[6],vi=Oe[7],xi=Oe[8];return Math.abs(Ue-$n)<=Re.EPSILON*Math.max(1,Math.abs(Ue),Math.abs($n))&&Math.abs(qe-Gn)<=Re.EPSILON*Math.max(1,Math.abs(qe),Math.abs(Gn))&&Math.abs(Ct-qn)<=Re.EPSILON*Math.max(1,Math.abs(Ct),Math.abs(qn))&&Math.abs(Ot-Zn)<=Re.EPSILON*Math.max(1,Math.abs(Ot),Math.abs(Zn))&&Math.abs(Jt-Xn)<=Re.EPSILON*Math.max(1,Math.abs(Jt),Math.abs(Xn))&&Math.abs(Hr-Yn)<=Re.EPSILON*Math.max(1,Math.abs(Hr),Math.abs(Yn))&&Math.abs(Jr-_i)<=Re.EPSILON*Math.max(1,Math.abs(Jr),Math.abs(_i))&&Math.abs(Ln-vi)<=Re.EPSILON*Math.max(1,Math.abs(Ln),Math.abs(vi))&&Math.abs(Nn-xi)<=Re.EPSILON*Math.max(1,Math.abs(Nn),Math.abs(xi))},Jr.sub=Jr.mul=void 0;var Re=function(Re){if(Re&&Re.__esModule)return Re;if(null===Re||"object"!==t(Re)&&"function"!=typeof Re)return{default:Re};var Le=r(void 0);if(Le&&Le.has(Re))return Le.get(Re);var Oe={},Ue=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var qe in Re)if("default"!==qe&&Object.prototype.hasOwnProperty.call(Re,qe)){var Ct=Ue?Object.getOwnPropertyDescriptor(Re,qe):null;Ct&&(Ct.get||Ct.set)?Object.defineProperty(Oe,qe,Ct):Oe[qe]=Re[qe]}return Oe.default=Re,Le&&Le.set(Re,Oe),Oe}(s());function r(Re){if("function"!=typeof WeakMap)return null;var Le=new WeakMap,Oe=new WeakMap;return(r=function(Re){return Re?Oe:Le})(Re)}function n(Re,Le,Oe){var Ue=Le[0],qe=Le[1],Ct=Le[2],Ot=Le[3],Jt=Le[4],Hr=Le[5],Jr=Le[6],Ln=Le[7],Nn=Le[8],$n=Oe[0],Gn=Oe[1],qn=Oe[2],Zn=Oe[3],Xn=Oe[4],Yn=Oe[5],_i=Oe[6],vi=Oe[7],xi=Oe[8];return Re[0]=$n*Ue+Gn*Ot+qn*Jr,Re[1]=$n*qe+Gn*Jt+qn*Ln,Re[2]=$n*Ct+Gn*Hr+qn*Nn,Re[3]=Zn*Ue+Xn*Ot+Yn*Jr,Re[4]=Zn*qe+Xn*Jt+Yn*Ln,Re[5]=Zn*Ct+Xn*Hr+Yn*Nn,Re[6]=_i*Ue+vi*Ot+xi*Jr,Re[7]=_i*qe+vi*Jt+xi*Ln,Re[8]=_i*Ct+vi*Hr+xi*Nn,Re}function i(Re,Le,Oe){return Re[0]=Le[0]-Oe[0],Re[1]=Le[1]-Oe[1],Re[2]=Le[2]-Oe[2],Re[3]=Le[3]-Oe[3],Re[4]=Le[4]-Oe[4],Re[5]=Le[5]-Oe[5],Re[6]=Le[6]-Oe[6],Re[7]=Le[7]-Oe[7],Re[8]=Le[8]-Oe[8],Re}return Jr.mul=n,Jr.sub=i,Jr}var Ln,Nn={};function g(){if(Ln)return Nn;function t(Re){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(Re){return typeof Re}:function(Re){return Re&&"function"==typeof Symbol&&Re.constructor===Symbol&&Re!==Symbol.prototype?"symbol":typeof Re})(Re)}Ln=1,Object.defineProperty(Nn,"__esModule",{value:!0}),Nn.create=function(){var Le=new Re.ARRAY_TYPE(16);return Re.ARRAY_TYPE!=Float32Array&&(Le[1]=0,Le[2]=0,Le[3]=0,Le[4]=0,Le[6]=0,Le[7]=0,Le[8]=0,Le[9]=0,Le[11]=0,Le[12]=0,Le[13]=0,Le[14]=0),Le[0]=1,Le[5]=1,Le[10]=1,Le[15]=1,Le},Nn.clone=function(Le){var Oe=new Re.ARRAY_TYPE(16);return Oe[0]=Le[0],Oe[1]=Le[1],Oe[2]=Le[2],Oe[3]=Le[3],Oe[4]=Le[4],Oe[5]=Le[5],Oe[6]=Le[6],Oe[7]=Le[7],Oe[8]=Le[8],Oe[9]=Le[9],Oe[10]=Le[10],Oe[11]=Le[11],Oe[12]=Le[12],Oe[13]=Le[13],Oe[14]=Le[14],Oe[15]=Le[15],Oe},Nn.copy=function(Re,Le){return Re[0]=Le[0],Re[1]=Le[1],Re[2]=Le[2],Re[3]=Le[3],Re[4]=Le[4],Re[5]=Le[5],Re[6]=Le[6],Re[7]=Le[7],Re[8]=Le[8],Re[9]=Le[9],Re[10]=Le[10],Re[11]=Le[11],Re[12]=Le[12],Re[13]=Le[13],Re[14]=Le[14],Re[15]=Le[15],Re},Nn.fromValues=function(Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr,Ln,Nn,$n,Gn,qn,Zn,Xn){var Yn=new Re.ARRAY_TYPE(16);return Yn[0]=Le,Yn[1]=Oe,Yn[2]=Ue,Yn[3]=qe,Yn[4]=Ct,Yn[5]=Ot,Yn[6]=Jt,Yn[7]=Hr,Yn[8]=Jr,Yn[9]=Ln,Yn[10]=Nn,Yn[11]=$n,Yn[12]=Gn,Yn[13]=qn,Yn[14]=Zn,Yn[15]=Xn,Yn},Nn.set=function(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr,Ln,Nn,$n,Gn,qn,Zn,Xn){return Re[0]=Le,Re[1]=Oe,Re[2]=Ue,Re[3]=qe,Re[4]=Ct,Re[5]=Ot,Re[6]=Jt,Re[7]=Hr,Re[8]=Jr,Re[9]=Ln,Re[10]=Nn,Re[11]=$n,Re[12]=Gn,Re[13]=qn,Re[14]=Zn,Re[15]=Xn,Re},Nn.identity=n,Nn.transpose=function(Re,Le){if(Re===Le){var Oe=Le[1],Ue=Le[2],qe=Le[3],Ct=Le[6],Ot=Le[7],Jt=Le[11];Re[1]=Le[4],Re[2]=Le[8],Re[3]=Le[12],Re[4]=Oe,Re[6]=Le[9],Re[7]=Le[13],Re[8]=Ue,Re[9]=Ct,Re[11]=Le[14],Re[12]=qe,Re[13]=Ot,Re[14]=Jt}else Re[0]=Le[0],Re[1]=Le[4],Re[2]=Le[8],Re[3]=Le[12],Re[4]=Le[1],Re[5]=Le[5],Re[6]=Le[9],Re[7]=Le[13],Re[8]=Le[2],Re[9]=Le[6],Re[10]=Le[10],Re[11]=Le[14],Re[12]=Le[3],Re[13]=Le[7],Re[14]=Le[11],Re[15]=Le[15];return Re},Nn.invert=function(Re,Le){var Oe=Le[0],Ue=Le[1],qe=Le[2],Ct=Le[3],Ot=Le[4],Jt=Le[5],Hr=Le[6],Jr=Le[7],Ln=Le[8],Nn=Le[9],$n=Le[10],Gn=Le[11],qn=Le[12],Zn=Le[13],Xn=Le[14],Yn=Le[15],_i=Oe*Jt-Ue*Ot,vi=Oe*Hr-qe*Ot,xi=Oe*Jr-Ct*Ot,bi=Ue*Hr-qe*Jt,Pi=Ue*Jr-Ct*Jt,lo=qe*Jr-Ct*Hr,uo=Ln*Zn-Nn*qn,po=Ln*Xn-$n*qn,fo=Ln*Yn-Gn*qn,Io=Nn*Xn-$n*Zn,is=Nn*Yn-Gn*Zn,as=$n*Yn-Gn*Xn,Is=_i*as-vi*is+xi*Io+bi*fo-Pi*po+lo*uo;return Is?(Re[0]=(Jt*as-Hr*is+Jr*Io)*(Is=1/Is),Re[1]=(qe*is-Ue*as-Ct*Io)*Is,Re[2]=(Zn*lo-Xn*Pi+Yn*bi)*Is,Re[3]=($n*Pi-Nn*lo-Gn*bi)*Is,Re[4]=(Hr*fo-Ot*as-Jr*po)*Is,Re[5]=(Oe*as-qe*fo+Ct*po)*Is,Re[6]=(Xn*xi-qn*lo-Yn*vi)*Is,Re[7]=(Ln*lo-$n*xi+Gn*vi)*Is,Re[8]=(Ot*is-Jt*fo+Jr*uo)*Is,Re[9]=(Ue*fo-Oe*is-Ct*uo)*Is,Re[10]=(qn*Pi-Zn*xi+Yn*_i)*Is,Re[11]=(Nn*xi-Ln*Pi-Gn*_i)*Is,Re[12]=(Jt*po-Ot*Io-Hr*uo)*Is,Re[13]=(Oe*Io-Ue*po+qe*uo)*Is,Re[14]=(Zn*vi-qn*bi-Xn*_i)*Is,Re[15]=(Ln*bi-Nn*vi+$n*_i)*Is,Re):null},Nn.adjoint=function(Re,Le){var Oe=Le[0],Ue=Le[1],qe=Le[2],Ct=Le[3],Ot=Le[4],Jt=Le[5],Hr=Le[6],Jr=Le[7],Ln=Le[8],Nn=Le[9],$n=Le[10],Gn=Le[11],qn=Le[12],Zn=Le[13],Xn=Le[14],Yn=Le[15];return Re[0]=Jt*($n*Yn-Gn*Xn)-Nn*(Hr*Yn-Jr*Xn)+Zn*(Hr*Gn-Jr*$n),Re[1]=-(Ue*($n*Yn-Gn*Xn)-Nn*(qe*Yn-Ct*Xn)+Zn*(qe*Gn-Ct*$n)),Re[2]=Ue*(Hr*Yn-Jr*Xn)-Jt*(qe*Yn-Ct*Xn)+Zn*(qe*Jr-Ct*Hr),Re[3]=-(Ue*(Hr*Gn-Jr*$n)-Jt*(qe*Gn-Ct*$n)+Nn*(qe*Jr-Ct*Hr)),Re[4]=-(Ot*($n*Yn-Gn*Xn)-Ln*(Hr*Yn-Jr*Xn)+qn*(Hr*Gn-Jr*$n)),Re[5]=Oe*($n*Yn-Gn*Xn)-Ln*(qe*Yn-Ct*Xn)+qn*(qe*Gn-Ct*$n),Re[6]=-(Oe*(Hr*Yn-Jr*Xn)-Ot*(qe*Yn-Ct*Xn)+qn*(qe*Jr-Ct*Hr)),Re[7]=Oe*(Hr*Gn-Jr*$n)-Ot*(qe*Gn-Ct*$n)+Ln*(qe*Jr-Ct*Hr),Re[8]=Ot*(Nn*Yn-Gn*Zn)-Ln*(Jt*Yn-Jr*Zn)+qn*(Jt*Gn-Jr*Nn),Re[9]=-(Oe*(Nn*Yn-Gn*Zn)-Ln*(Ue*Yn-Ct*Zn)+qn*(Ue*Gn-Ct*Nn)),Re[10]=Oe*(Jt*Yn-Jr*Zn)-Ot*(Ue*Yn-Ct*Zn)+qn*(Ue*Jr-Ct*Jt),Re[11]=-(Oe*(Jt*Gn-Jr*Nn)-Ot*(Ue*Gn-Ct*Nn)+Ln*(Ue*Jr-Ct*Jt)),Re[12]=-(Ot*(Nn*Xn-$n*Zn)-Ln*(Jt*Xn-Hr*Zn)+qn*(Jt*$n-Hr*Nn)),Re[13]=Oe*(Nn*Xn-$n*Zn)-Ln*(Ue*Xn-qe*Zn)+qn*(Ue*$n-qe*Nn),Re[14]=-(Oe*(Jt*Xn-Hr*Zn)-Ot*(Ue*Xn-qe*Zn)+qn*(Ue*Hr-qe*Jt)),Re[15]=Oe*(Jt*$n-Hr*Nn)-Ot*(Ue*$n-qe*Nn)+Ln*(Ue*Hr-qe*Jt),Re},Nn.determinant=function(Re){var Le=Re[0],Oe=Re[1],Ue=Re[2],qe=Re[3],Ct=Re[4],Ot=Re[5],Jt=Re[6],Hr=Re[7],Jr=Re[8],Ln=Re[9],Nn=Re[10],$n=Re[11],Gn=Re[12],qn=Re[13],Zn=Re[14],Xn=Re[15];return(Le*Ot-Oe*Ct)*(Nn*Xn-$n*Zn)-(Le*Jt-Ue*Ct)*(Ln*Xn-$n*qn)+(Le*Hr-qe*Ct)*(Ln*Zn-Nn*qn)+(Oe*Jt-Ue*Ot)*(Jr*Xn-$n*Gn)-(Oe*Hr-qe*Ot)*(Jr*Zn-Nn*Gn)+(Ue*Hr-qe*Jt)*(Jr*qn-Ln*Gn)},Nn.multiply=i,Nn.translate=function(Re,Le,Oe){var Ue,qe,Ct,Ot,Jt,Hr,Jr,Ln,Nn,$n,Gn,qn,Zn=Oe[0],Xn=Oe[1],Yn=Oe[2];return Le===Re?(Re[12]=Le[0]*Zn+Le[4]*Xn+Le[8]*Yn+Le[12],Re[13]=Le[1]*Zn+Le[5]*Xn+Le[9]*Yn+Le[13],Re[14]=Le[2]*Zn+Le[6]*Xn+Le[10]*Yn+Le[14],Re[15]=Le[3]*Zn+Le[7]*Xn+Le[11]*Yn+Le[15]):(qe=Le[1],Ct=Le[2],Ot=Le[3],Jt=Le[4],Hr=Le[5],Jr=Le[6],Ln=Le[7],Nn=Le[8],$n=Le[9],Gn=Le[10],qn=Le[11],Re[0]=Ue=Le[0],Re[1]=qe,Re[2]=Ct,Re[3]=Ot,Re[4]=Jt,Re[5]=Hr,Re[6]=Jr,Re[7]=Ln,Re[8]=Nn,Re[9]=$n,Re[10]=Gn,Re[11]=qn,Re[12]=Ue*Zn+Jt*Xn+Nn*Yn+Le[12],Re[13]=qe*Zn+Hr*Xn+$n*Yn+Le[13],Re[14]=Ct*Zn+Jr*Xn+Gn*Yn+Le[14],Re[15]=Ot*Zn+Ln*Xn+qn*Yn+Le[15]),Re},Nn.scale=function(Re,Le,Oe){var Ue=Oe[0],qe=Oe[1],Ct=Oe[2];return Re[0]=Le[0]*Ue,Re[1]=Le[1]*Ue,Re[2]=Le[2]*Ue,Re[3]=Le[3]*Ue,Re[4]=Le[4]*qe,Re[5]=Le[5]*qe,Re[6]=Le[6]*qe,Re[7]=Le[7]*qe,Re[8]=Le[8]*Ct,Re[9]=Le[9]*Ct,Re[10]=Le[10]*Ct,Re[11]=Le[11]*Ct,Re[12]=Le[12],Re[13]=Le[13],Re[14]=Le[14],Re[15]=Le[15],Re},Nn.rotate=function(Le,Oe,Ue,qe){var Ct,Ot,Jt,Hr,Jr,Ln,Nn,$n,Gn,qn,Zn,Xn,Yn,_i,vi,xi,bi,Pi,lo,uo,po,fo,Io,is,as=qe[0],Is=qe[1],Xs=qe[2],ta=Math.hypot(as,Is,Xs);return ta<Re.EPSILON?null:(as*=ta=1/ta,Is*=ta,Xs*=ta,Ct=Math.sin(Ue),Ot=Math.cos(Ue),Jr=Oe[1],Ln=Oe[2],Nn=Oe[3],Gn=Oe[5],qn=Oe[6],Zn=Oe[7],Yn=Oe[9],_i=Oe[10],vi=Oe[11],xi=as*as*(Jt=1-Ot)+Ot,lo=as*Is*Jt-Xs*Ct,uo=Is*Is*Jt+Ot,po=Xs*Is*Jt+as*Ct,fo=as*Xs*Jt+Is*Ct,Io=Is*Xs*Jt-as*Ct,is=Xs*Xs*Jt+Ot,Le[0]=(Hr=Oe[0])*xi+($n=Oe[4])*(bi=Is*as*Jt+Xs*Ct)+(Xn=Oe[8])*(Pi=Xs*as*Jt-Is*Ct),Le[1]=Jr*xi+Gn*bi+Yn*Pi,Le[2]=Ln*xi+qn*bi+_i*Pi,Le[3]=Nn*xi+Zn*bi+vi*Pi,Le[4]=Hr*lo+$n*uo+Xn*po,Le[5]=Jr*lo+Gn*uo+Yn*po,Le[6]=Ln*lo+qn*uo+_i*po,Le[7]=Nn*lo+Zn*uo+vi*po,Le[8]=Hr*fo+$n*Io+Xn*is,Le[9]=Jr*fo+Gn*Io+Yn*is,Le[10]=Ln*fo+qn*Io+_i*is,Le[11]=Nn*fo+Zn*Io+vi*is,Oe!==Le&&(Le[12]=Oe[12],Le[13]=Oe[13],Le[14]=Oe[14],Le[15]=Oe[15]),Le)},Nn.rotateX=function(Re,Le,Oe){var Ue=Math.sin(Oe),qe=Math.cos(Oe),Ct=Le[4],Ot=Le[5],Jt=Le[6],Hr=Le[7],Jr=Le[8],Ln=Le[9],Nn=Le[10],$n=Le[11];return Le!==Re&&(Re[0]=Le[0],Re[1]=Le[1],Re[2]=Le[2],Re[3]=Le[3],Re[12]=Le[12],Re[13]=Le[13],Re[14]=Le[14],Re[15]=Le[15]),Re[4]=Ct*qe+Jr*Ue,Re[5]=Ot*qe+Ln*Ue,Re[6]=Jt*qe+Nn*Ue,Re[7]=Hr*qe+$n*Ue,Re[8]=Jr*qe-Ct*Ue,Re[9]=Ln*qe-Ot*Ue,Re[10]=Nn*qe-Jt*Ue,Re[11]=$n*qe-Hr*Ue,Re},Nn.rotateY=function(Re,Le,Oe){var Ue=Math.sin(Oe),qe=Math.cos(Oe),Ct=Le[0],Ot=Le[1],Jt=Le[2],Hr=Le[3],Jr=Le[8],Ln=Le[9],Nn=Le[10],$n=Le[11];return Le!==Re&&(Re[4]=Le[4],Re[5]=Le[5],Re[6]=Le[6],Re[7]=Le[7],Re[12]=Le[12],Re[13]=Le[13],Re[14]=Le[14],Re[15]=Le[15]),Re[0]=Ct*qe-Jr*Ue,Re[1]=Ot*qe-Ln*Ue,Re[2]=Jt*qe-Nn*Ue,Re[3]=Hr*qe-$n*Ue,Re[8]=Ct*Ue+Jr*qe,Re[9]=Ot*Ue+Ln*qe,Re[10]=Jt*Ue+Nn*qe,Re[11]=Hr*Ue+$n*qe,Re},Nn.rotateZ=function(Re,Le,Oe){var Ue=Math.sin(Oe),qe=Math.cos(Oe),Ct=Le[0],Ot=Le[1],Jt=Le[2],Hr=Le[3],Jr=Le[4],Ln=Le[5],Nn=Le[6],$n=Le[7];return Le!==Re&&(Re[8]=Le[8],Re[9]=Le[9],Re[10]=Le[10],Re[11]=Le[11],Re[12]=Le[12],Re[13]=Le[13],Re[14]=Le[14],Re[15]=Le[15]),Re[0]=Ct*qe+Jr*Ue,Re[1]=Ot*qe+Ln*Ue,Re[2]=Jt*qe+Nn*Ue,Re[3]=Hr*qe+$n*Ue,Re[4]=Jr*qe-Ct*Ue,Re[5]=Ln*qe-Ot*Ue,Re[6]=Nn*qe-Jt*Ue,Re[7]=$n*qe-Hr*Ue,Re},Nn.fromTranslation=function(Re,Le){return Re[0]=1,Re[1]=0,Re[2]=0,Re[3]=0,Re[4]=0,Re[5]=1,Re[6]=0,Re[7]=0,Re[8]=0,Re[9]=0,Re[10]=1,Re[11]=0,Re[12]=Le[0],Re[13]=Le[1],Re[14]=Le[2],Re[15]=1,Re},Nn.fromScaling=function(Re,Le){return Re[0]=Le[0],Re[1]=0,Re[2]=0,Re[3]=0,Re[4]=0,Re[5]=Le[1],Re[6]=0,Re[7]=0,Re[8]=0,Re[9]=0,Re[10]=Le[2],Re[11]=0,Re[12]=0,Re[13]=0,Re[14]=0,Re[15]=1,Re},Nn.fromRotation=function(Le,Oe,Ue){var qe,Ct,Ot,Jt=Ue[0],Hr=Ue[1],Jr=Ue[2],Ln=Math.hypot(Jt,Hr,Jr);return Ln<Re.EPSILON?null:(Jt*=Ln=1/Ln,Hr*=Ln,Jr*=Ln,qe=Math.sin(Oe),Ct=Math.cos(Oe),Le[0]=Jt*Jt*(Ot=1-Ct)+Ct,Le[1]=Hr*Jt*Ot+Jr*qe,Le[2]=Jr*Jt*Ot-Hr*qe,Le[3]=0,Le[4]=Jt*Hr*Ot-Jr*qe,Le[5]=Hr*Hr*Ot+Ct,Le[6]=Jr*Hr*Ot+Jt*qe,Le[7]=0,Le[8]=Jt*Jr*Ot+Hr*qe,Le[9]=Hr*Jr*Ot-Jt*qe,Le[10]=Jr*Jr*Ot+Ct,Le[11]=0,Le[12]=0,Le[13]=0,Le[14]=0,Le[15]=1,Le)},Nn.fromXRotation=function(Re,Le){var Oe=Math.sin(Le),Ue=Math.cos(Le);return Re[0]=1,Re[1]=0,Re[2]=0,Re[3]=0,Re[4]=0,Re[5]=Ue,Re[6]=Oe,Re[7]=0,Re[8]=0,Re[9]=-Oe,Re[10]=Ue,Re[11]=0,Re[12]=0,Re[13]=0,Re[14]=0,Re[15]=1,Re},Nn.fromYRotation=function(Re,Le){var Oe=Math.sin(Le),Ue=Math.cos(Le);return Re[0]=Ue,Re[1]=0,Re[2]=-Oe,Re[3]=0,Re[4]=0,Re[5]=1,Re[6]=0,Re[7]=0,Re[8]=Oe,Re[9]=0,Re[10]=Ue,Re[11]=0,Re[12]=0,Re[13]=0,Re[14]=0,Re[15]=1,Re},Nn.fromZRotation=function(Re,Le){var Oe=Math.sin(Le),Ue=Math.cos(Le);return Re[0]=Ue,Re[1]=Oe,Re[2]=0,Re[3]=0,Re[4]=-Oe,Re[5]=Ue,Re[6]=0,Re[7]=0,Re[8]=0,Re[9]=0,Re[10]=1,Re[11]=0,Re[12]=0,Re[13]=0,Re[14]=0,Re[15]=1,Re},Nn.fromRotationTranslation=a,Nn.fromQuat2=function(Le,Oe){var Ue=new Re.ARRAY_TYPE(3),qe=-Oe[0],Ct=-Oe[1],Ot=-Oe[2],Jt=Oe[3],Hr=Oe[4],Jr=Oe[5],Ln=Oe[6],Nn=Oe[7],$n=qe*qe+Ct*Ct+Ot*Ot+Jt*Jt;return $n>0?(Ue[0]=2*(Hr*Jt+Nn*qe+Jr*Ot-Ln*Ct)/$n,Ue[1]=2*(Jr*Jt+Nn*Ct+Ln*qe-Hr*Ot)/$n,Ue[2]=2*(Ln*Jt+Nn*Ot+Hr*Ct-Jr*qe)/$n):(Ue[0]=2*(Hr*Jt+Nn*qe+Jr*Ot-Ln*Ct),Ue[1]=2*(Jr*Jt+Nn*Ct+Ln*qe-Hr*Ot),Ue[2]=2*(Ln*Jt+Nn*Ot+Hr*Ct-Jr*qe)),a(Le,Oe,Ue),Le},Nn.getTranslation=function(Re,Le){return Re[0]=Le[12],Re[1]=Le[13],Re[2]=Le[14],Re},Nn.getScaling=o,Nn.getRotation=function(Le,Oe){var Ue=new Re.ARRAY_TYPE(3);o(Ue,Oe);var qe=1/Ue[0],Ct=1/Ue[1],Ot=1/Ue[2],Jt=Oe[0]*qe,Hr=Oe[1]*Ct,Jr=Oe[2]*Ot,Ln=Oe[4]*qe,Nn=Oe[5]*Ct,$n=Oe[6]*Ot,Gn=Oe[8]*qe,qn=Oe[9]*Ct,Zn=Oe[10]*Ot,Xn=Jt+Nn+Zn,Yn=0;return Xn>0?(Yn=2*Math.sqrt(Xn+1),Le[3]=.25*Yn,Le[0]=($n-qn)/Yn,Le[1]=(Gn-Jr)/Yn,Le[2]=(Hr-Ln)/Yn):Jt>Nn&&Jt>Zn?(Yn=2*Math.sqrt(1+Jt-Nn-Zn),Le[3]=($n-qn)/Yn,Le[0]=.25*Yn,Le[1]=(Hr+Ln)/Yn,Le[2]=(Gn+Jr)/Yn):Nn>Zn?(Yn=2*Math.sqrt(1+Nn-Jt-Zn),Le[3]=(Gn-Jr)/Yn,Le[0]=(Hr+Ln)/Yn,Le[1]=.25*Yn,Le[2]=($n+qn)/Yn):(Yn=2*Math.sqrt(1+Zn-Jt-Nn),Le[3]=(Hr-Ln)/Yn,Le[0]=(Gn+Jr)/Yn,Le[1]=($n+qn)/Yn,Le[2]=.25*Yn),Le},Nn.fromRotationTranslationScale=function(Re,Le,Oe,Ue){var qe=Le[0],Ct=Le[1],Ot=Le[2],Jt=Le[3],Hr=qe+qe,Jr=Ct+Ct,Ln=Ot+Ot,Nn=qe*Hr,$n=qe*Jr,Gn=qe*Ln,qn=Ct*Jr,Zn=Ct*Ln,Xn=Ot*Ln,Yn=Jt*Hr,_i=Jt*Jr,vi=Jt*Ln,xi=Ue[0],bi=Ue[1],Pi=Ue[2];return Re[0]=(1-(qn+Xn))*xi,Re[1]=($n+vi)*xi,Re[2]=(Gn-_i)*xi,Re[3]=0,Re[4]=($n-vi)*bi,Re[5]=(1-(Nn+Xn))*bi,Re[6]=(Zn+Yn)*bi,Re[7]=0,Re[8]=(Gn+_i)*Pi,Re[9]=(Zn-Yn)*Pi,Re[10]=(1-(Nn+qn))*Pi,Re[11]=0,Re[12]=Oe[0],Re[13]=Oe[1],Re[14]=Oe[2],Re[15]=1,Re},Nn.fromRotationTranslationScaleOrigin=function(Re,Le,Oe,Ue,qe){var Ct=Le[0],Ot=Le[1],Jt=Le[2],Hr=Le[3],Jr=Ct+Ct,Ln=Ot+Ot,Nn=Jt+Jt,$n=Ct*Jr,Gn=Ct*Ln,qn=Ct*Nn,Zn=Ot*Ln,Xn=Ot*Nn,Yn=Jt*Nn,_i=Hr*Jr,vi=Hr*Ln,xi=Hr*Nn,bi=Ue[0],Pi=Ue[1],lo=Ue[2],uo=qe[0],po=qe[1],fo=qe[2],Io=(1-(Zn+Yn))*bi,is=(Gn+xi)*bi,as=(qn-vi)*bi,Is=(Gn-xi)*Pi,Xs=(1-($n+Yn))*Pi,ta=(Xn+_i)*Pi,ha=(qn+vi)*lo,el=(Xn-_i)*lo,tl=(1-($n+Zn))*lo;return Re[0]=Io,Re[1]=is,Re[2]=as,Re[3]=0,Re[4]=Is,Re[5]=Xs,Re[6]=ta,Re[7]=0,Re[8]=ha,Re[9]=el,Re[10]=tl,Re[11]=0,Re[12]=Oe[0]+uo-(Io*uo+Is*po+ha*fo),Re[13]=Oe[1]+po-(is*uo+Xs*po+el*fo),Re[14]=Oe[2]+fo-(as*uo+ta*po+tl*fo),Re[15]=1,Re},Nn.fromQuat=function(Re,Le){var Oe=Le[0],Ue=Le[1],qe=Le[2],Ct=Le[3],Ot=Oe+Oe,Jt=Ue+Ue,Hr=qe+qe,Jr=Oe*Ot,Ln=Ue*Ot,Nn=Ue*Jt,$n=qe*Ot,Gn=qe*Jt,qn=qe*Hr,Zn=Ct*Ot,Xn=Ct*Jt,Yn=Ct*Hr;return Re[0]=1-Nn-qn,Re[1]=Ln+Yn,Re[2]=$n-Xn,Re[3]=0,Re[4]=Ln-Yn,Re[5]=1-Jr-qn,Re[6]=Gn+Zn,Re[7]=0,Re[8]=$n+Xn,Re[9]=Gn-Zn,Re[10]=1-Jr-Nn,Re[11]=0,Re[12]=0,Re[13]=0,Re[14]=0,Re[15]=1,Re},Nn.frustum=function(Re,Le,Oe,Ue,qe,Ct,Ot){var Jt=1/(Oe-Le),Hr=1/(qe-Ue),Jr=1/(Ct-Ot);return Re[0]=2*Ct*Jt,Re[1]=0,Re[2]=0,Re[3]=0,Re[4]=0,Re[5]=2*Ct*Hr,Re[6]=0,Re[7]=0,Re[8]=(Oe+Le)*Jt,Re[9]=(qe+Ue)*Hr,Re[10]=(Ot+Ct)*Jr,Re[11]=-1,Re[12]=0,Re[13]=0,Re[14]=Ot*Ct*2*Jr,Re[15]=0,Re},Nn.perspectiveNO=l,Nn.perspectiveZO=function(Re,Le,Oe,Ue,qe){var Ct,Ot=1/Math.tan(Le/2);return Re[0]=Ot/Oe,Re[1]=0,Re[2]=0,Re[3]=0,Re[4]=0,Re[5]=Ot,Re[6]=0,Re[7]=0,Re[8]=0,Re[9]=0,Re[11]=-1,Re[12]=0,Re[13]=0,Re[15]=0,null!=qe&&qe!==1/0?(Re[10]=qe*(Ct=1/(Ue-qe)),Re[14]=qe*Ue*Ct):(Re[10]=-1,Re[14]=-Ue),Re},Nn.perspectiveFromFieldOfView=function(Re,Le,Oe,Ue){var qe=Math.tan(Le.upDegrees*Math.PI/180),Ct=Math.tan(Le.downDegrees*Math.PI/180),Ot=Math.tan(Le.leftDegrees*Math.PI/180),Jt=Math.tan(Le.rightDegrees*Math.PI/180),Hr=2/(Ot+Jt),Jr=2/(qe+Ct);return Re[0]=Hr,Re[1]=0,Re[2]=0,Re[3]=0,Re[4]=0,Re[5]=Jr,Re[6]=0,Re[7]=0,Re[8]=-(Ot-Jt)*Hr*.5,Re[9]=(qe-Ct)*Jr*.5,Re[10]=Ue/(Oe-Ue),Re[11]=-1,Re[12]=0,Re[13]=0,Re[14]=Ue*Oe/(Oe-Ue),Re[15]=0,Re},Nn.orthoNO=u,Nn.orthoZO=function(Re,Le,Oe,Ue,qe,Ct,Ot){var Jt=1/(Le-Oe),Hr=1/(Ue-qe),Jr=1/(Ct-Ot);return Re[0]=-2*Jt,Re[1]=0,Re[2]=0,Re[3]=0,Re[4]=0,Re[5]=-2*Hr,Re[6]=0,Re[7]=0,Re[8]=0,Re[9]=0,Re[10]=Jr,Re[11]=0,Re[12]=(Le+Oe)*Jt,Re[13]=(qe+Ue)*Hr,Re[14]=Ct*Jr,Re[15]=1,Re},Nn.lookAt=function(Le,Oe,Ue,qe){var Ct,Ot,Jt,Hr,Jr,Ln,Nn,$n,Gn,qn,Zn=Oe[0],Xn=Oe[1],Yn=Oe[2],_i=qe[0],vi=qe[1],xi=qe[2],bi=Ue[0],Pi=Ue[1],lo=Ue[2];return Math.abs(Zn-bi)<Re.EPSILON&&Math.abs(Xn-Pi)<Re.EPSILON&&Math.abs(Yn-lo)<Re.EPSILON?n(Le):(Nn=Zn-bi,$n=Xn-Pi,Gn=Yn-lo,Ct=vi*(Gn*=qn=1/Math.hypot(Nn,$n,Gn))-xi*($n*=qn),Ot=xi*(Nn*=qn)-_i*Gn,Jt=_i*$n-vi*Nn,(qn=Math.hypot(Ct,Ot,Jt))?(Ct*=qn=1/qn,Ot*=qn,Jt*=qn):(Ct=0,Ot=0,Jt=0),Hr=$n*Jt-Gn*Ot,Jr=Gn*Ct-Nn*Jt,Ln=Nn*Ot-$n*Ct,(qn=Math.hypot(Hr,Jr,Ln))?(Hr*=qn=1/qn,Jr*=qn,Ln*=qn):(Hr=0,Jr=0,Ln=0),Le[0]=Ct,Le[1]=Hr,Le[2]=Nn,Le[3]=0,Le[4]=Ot,Le[5]=Jr,Le[6]=$n,Le[7]=0,Le[8]=Jt,Le[9]=Ln,Le[10]=Gn,Le[11]=0,Le[12]=-(Ct*Zn+Ot*Xn+Jt*Yn),Le[13]=-(Hr*Zn+Jr*Xn+Ln*Yn),Le[14]=-(Nn*Zn+$n*Xn+Gn*Yn),Le[15]=1,Le)},Nn.targetTo=function(Re,Le,Oe,Ue){var qe=Le[0],Ct=Le[1],Ot=Le[2],Jt=Ue[0],Hr=Ue[1],Jr=Ue[2],Ln=qe-Oe[0],Nn=Ct-Oe[1],$n=Ot-Oe[2],Gn=Ln*Ln+Nn*Nn+$n*$n;Gn>0&&(Ln*=Gn=1/Math.sqrt(Gn),Nn*=Gn,$n*=Gn);var qn=Hr*$n-Jr*Nn,Zn=Jr*Ln-Jt*$n,Xn=Jt*Nn-Hr*Ln;return(Gn=qn*qn+Zn*Zn+Xn*Xn)>0&&(qn*=Gn=1/Math.sqrt(Gn),Zn*=Gn,Xn*=Gn),Re[0]=qn,Re[1]=Zn,Re[2]=Xn,Re[3]=0,Re[4]=Nn*Xn-$n*Zn,Re[5]=$n*qn-Ln*Xn,Re[6]=Ln*Zn-Nn*qn,Re[7]=0,Re[8]=Ln,Re[9]=Nn,Re[10]=$n,Re[11]=0,Re[12]=qe,Re[13]=Ct,Re[14]=Ot,Re[15]=1,Re},Nn.str=function(Re){return"mat4("+Re[0]+", "+Re[1]+", "+Re[2]+", "+Re[3]+", "+Re[4]+", "+Re[5]+", "+Re[6]+", "+Re[7]+", "+Re[8]+", "+Re[9]+", "+Re[10]+", "+Re[11]+", "+Re[12]+", "+Re[13]+", "+Re[14]+", "+Re[15]+")"},Nn.frob=function(Re){return Math.hypot(Re[0],Re[1],Re[2],Re[3],Re[4],Re[5],Re[6],Re[7],Re[8],Re[9],Re[10],Re[11],Re[12],Re[13],Re[14],Re[15])},Nn.add=function(Re,Le,Oe){return Re[0]=Le[0]+Oe[0],Re[1]=Le[1]+Oe[1],Re[2]=Le[2]+Oe[2],Re[3]=Le[3]+Oe[3],Re[4]=Le[4]+Oe[4],Re[5]=Le[5]+Oe[5],Re[6]=Le[6]+Oe[6],Re[7]=Le[7]+Oe[7],Re[8]=Le[8]+Oe[8],Re[9]=Le[9]+Oe[9],Re[10]=Le[10]+Oe[10],Re[11]=Le[11]+Oe[11],Re[12]=Le[12]+Oe[12],Re[13]=Le[13]+Oe[13],Re[14]=Le[14]+Oe[14],Re[15]=Le[15]+Oe[15],Re},Nn.subtract=c,Nn.multiplyScalar=function(Re,Le,Oe){return Re[0]=Le[0]*Oe,Re[1]=Le[1]*Oe,Re[2]=Le[2]*Oe,Re[3]=Le[3]*Oe,Re[4]=Le[4]*Oe,Re[5]=Le[5]*Oe,Re[6]=Le[6]*Oe,Re[7]=Le[7]*Oe,Re[8]=Le[8]*Oe,Re[9]=Le[9]*Oe,Re[10]=Le[10]*Oe,Re[11]=Le[11]*Oe,Re[12]=Le[12]*Oe,Re[13]=Le[13]*Oe,Re[14]=Le[14]*Oe,Re[15]=Le[15]*Oe,Re},Nn.multiplyScalarAndAdd=function(Re,Le,Oe,Ue){return Re[0]=Le[0]+Oe[0]*Ue,Re[1]=Le[1]+Oe[1]*Ue,Re[2]=Le[2]+Oe[2]*Ue,Re[3]=Le[3]+Oe[3]*Ue,Re[4]=Le[4]+Oe[4]*Ue,Re[5]=Le[5]+Oe[5]*Ue,Re[6]=Le[6]+Oe[6]*Ue,Re[7]=Le[7]+Oe[7]*Ue,Re[8]=Le[8]+Oe[8]*Ue,Re[9]=Le[9]+Oe[9]*Ue,Re[10]=Le[10]+Oe[10]*Ue,Re[11]=Le[11]+Oe[11]*Ue,Re[12]=Le[12]+Oe[12]*Ue,Re[13]=Le[13]+Oe[13]*Ue,Re[14]=Le[14]+Oe[14]*Ue,Re[15]=Le[15]+Oe[15]*Ue,Re},Nn.exactEquals=function(Re,Le){return Re[0]===Le[0]&&Re[1]===Le[1]&&Re[2]===Le[2]&&Re[3]===Le[3]&&Re[4]===Le[4]&&Re[5]===Le[5]&&Re[6]===Le[6]&&Re[7]===Le[7]&&Re[8]===Le[8]&&Re[9]===Le[9]&&Re[10]===Le[10]&&Re[11]===Le[11]&&Re[12]===Le[12]&&Re[13]===Le[13]&&Re[14]===Le[14]&&Re[15]===Le[15]},Nn.equals=function(Le,Oe){var Ue=Le[0],qe=Le[1],Ct=Le[2],Ot=Le[3],Jt=Le[4],Hr=Le[5],Jr=Le[6],Ln=Le[7],Nn=Le[8],$n=Le[9],Gn=Le[10],qn=Le[11],Zn=Le[12],Xn=Le[13],Yn=Le[14],_i=Le[15],vi=Oe[0],xi=Oe[1],bi=Oe[2],Pi=Oe[3],lo=Oe[4],uo=Oe[5],po=Oe[6],fo=Oe[7],Io=Oe[8],is=Oe[9],as=Oe[10],Is=Oe[11],Xs=Oe[12],ta=Oe[13],ha=Oe[14],el=Oe[15];return Math.abs(Ue-vi)<=Re.EPSILON*Math.max(1,Math.abs(Ue),Math.abs(vi))&&Math.abs(qe-xi)<=Re.EPSILON*Math.max(1,Math.abs(qe),Math.abs(xi))&&Math.abs(Ct-bi)<=Re.EPSILON*Math.max(1,Math.abs(Ct),Math.abs(bi))&&Math.abs(Ot-Pi)<=Re.EPSILON*Math.max(1,Math.abs(Ot),Math.abs(Pi))&&Math.abs(Jt-lo)<=Re.EPSILON*Math.max(1,Math.abs(Jt),Math.abs(lo))&&Math.abs(Hr-uo)<=Re.EPSILON*Math.max(1,Math.abs(Hr),Math.abs(uo))&&Math.abs(Jr-po)<=Re.EPSILON*Math.max(1,Math.abs(Jr),Math.abs(po))&&Math.abs(Ln-fo)<=Re.EPSILON*Math.max(1,Math.abs(Ln),Math.abs(fo))&&Math.abs(Nn-Io)<=Re.EPSILON*Math.max(1,Math.abs(Nn),Math.abs(Io))&&Math.abs($n-is)<=Re.EPSILON*Math.max(1,Math.abs($n),Math.abs(is))&&Math.abs(Gn-as)<=Re.EPSILON*Math.max(1,Math.abs(Gn),Math.abs(as))&&Math.abs(qn-Is)<=Re.EPSILON*Math.max(1,Math.abs(qn),Math.abs(Is))&&Math.abs(Zn-Xs)<=Re.EPSILON*Math.max(1,Math.abs(Zn),Math.abs(Xs))&&Math.abs(Xn-ta)<=Re.EPSILON*Math.max(1,Math.abs(Xn),Math.abs(ta))&&Math.abs(Yn-ha)<=Re.EPSILON*Math.max(1,Math.abs(Yn),Math.abs(ha))&&Math.abs(_i-el)<=Re.EPSILON*Math.max(1,Math.abs(_i),Math.abs(el))},Nn.sub=Nn.mul=Nn.ortho=Nn.perspective=void 0;var Re=function(Re){if(Re&&Re.__esModule)return Re;if(null===Re||"object"!==t(Re)&&"function"!=typeof Re)return{default:Re};var Le=r(void 0);if(Le&&Le.has(Re))return Le.get(Re);var Oe={},Ue=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var qe in Re)if("default"!==qe&&Object.prototype.hasOwnProperty.call(Re,qe)){var Ct=Ue?Object.getOwnPropertyDescriptor(Re,qe):null;Ct&&(Ct.get||Ct.set)?Object.defineProperty(Oe,qe,Ct):Oe[qe]=Re[qe]}return Oe.default=Re,Le&&Le.set(Re,Oe),Oe}(s());function r(Re){if("function"!=typeof WeakMap)return null;var Le=new WeakMap,Oe=new WeakMap;return(r=function(Re){return Re?Oe:Le})(Re)}function n(Re){return Re[0]=1,Re[1]=0,Re[2]=0,Re[3]=0,Re[4]=0,Re[5]=1,Re[6]=0,Re[7]=0,Re[8]=0,Re[9]=0,Re[10]=1,Re[11]=0,Re[12]=0,Re[13]=0,Re[14]=0,Re[15]=1,Re}function i(Re,Le,Oe){var Ue=Le[0],qe=Le[1],Ct=Le[2],Ot=Le[3],Jt=Le[4],Hr=Le[5],Jr=Le[6],Ln=Le[7],Nn=Le[8],$n=Le[9],Gn=Le[10],qn=Le[11],Zn=Le[12],Xn=Le[13],Yn=Le[14],_i=Le[15],vi=Oe[0],xi=Oe[1],bi=Oe[2],Pi=Oe[3];return Re[0]=vi*Ue+xi*Jt+bi*Nn+Pi*Zn,Re[1]=vi*qe+xi*Hr+bi*$n+Pi*Xn,Re[2]=vi*Ct+xi*Jr+bi*Gn+Pi*Yn,Re[3]=vi*Ot+xi*Ln+bi*qn+Pi*_i,Re[4]=(vi=Oe[4])*Ue+(xi=Oe[5])*Jt+(bi=Oe[6])*Nn+(Pi=Oe[7])*Zn,Re[5]=vi*qe+xi*Hr+bi*$n+Pi*Xn,Re[6]=vi*Ct+xi*Jr+bi*Gn+Pi*Yn,Re[7]=vi*Ot+xi*Ln+bi*qn+Pi*_i,Re[8]=(vi=Oe[8])*Ue+(xi=Oe[9])*Jt+(bi=Oe[10])*Nn+(Pi=Oe[11])*Zn,Re[9]=vi*qe+xi*Hr+bi*$n+Pi*Xn,Re[10]=vi*Ct+xi*Jr+bi*Gn+Pi*Yn,Re[11]=vi*Ot+xi*Ln+bi*qn+Pi*_i,Re[12]=(vi=Oe[12])*Ue+(xi=Oe[13])*Jt+(bi=Oe[14])*Nn+(Pi=Oe[15])*Zn,Re[13]=vi*qe+xi*Hr+bi*$n+Pi*Xn,Re[14]=vi*Ct+xi*Jr+bi*Gn+Pi*Yn,Re[15]=vi*Ot+xi*Ln+bi*qn+Pi*_i,Re}function a(Re,Le,Oe){var Ue=Le[0],qe=Le[1],Ct=Le[2],Ot=Le[3],Jt=Ue+Ue,Hr=qe+qe,Jr=Ct+Ct,Ln=Ue*Jt,Nn=Ue*Hr,$n=Ue*Jr,Gn=qe*Hr,qn=qe*Jr,Zn=Ct*Jr,Xn=Ot*Jt,Yn=Ot*Hr,_i=Ot*Jr;return Re[0]=1-(Gn+Zn),Re[1]=Nn+_i,Re[2]=$n-Yn,Re[3]=0,Re[4]=Nn-_i,Re[5]=1-(Ln+Zn),Re[6]=qn+Xn,Re[7]=0,Re[8]=$n+Yn,Re[9]=qn-Xn,Re[10]=1-(Ln+Gn),Re[11]=0,Re[12]=Oe[0],Re[13]=Oe[1],Re[14]=Oe[2],Re[15]=1,Re}function o(Re,Le){var Oe=Le[4],Ue=Le[5],qe=Le[6],Ct=Le[8],Ot=Le[9],Jt=Le[10];return Re[0]=Math.hypot(Le[0],Le[1],Le[2]),Re[1]=Math.hypot(Oe,Ue,qe),Re[2]=Math.hypot(Ct,Ot,Jt),Re}function l(Re,Le,Oe,Ue,qe){var Ct,Ot=1/Math.tan(Le/2);return Re[0]=Ot/Oe,Re[1]=0,Re[2]=0,Re[3]=0,Re[4]=0,Re[5]=Ot,Re[6]=0,Re[7]=0,Re[8]=0,Re[9]=0,Re[11]=-1,Re[12]=0,Re[13]=0,Re[15]=0,null!=qe&&qe!==1/0?(Re[10]=(qe+Ue)*(Ct=1/(Ue-qe)),Re[14]=2*qe*Ue*Ct):(Re[10]=-1,Re[14]=-2*Ue),Re}function u(Re,Le,Oe,Ue,qe,Ct,Ot){var Jt=1/(Le-Oe),Hr=1/(Ue-qe),Jr=1/(Ct-Ot);return Re[0]=-2*Jt,Re[1]=0,Re[2]=0,Re[3]=0,Re[4]=0,Re[5]=-2*Hr,Re[6]=0,Re[7]=0,Re[8]=0,Re[9]=0,Re[10]=2*Jr,Re[11]=0,Re[12]=(Le+Oe)*Jt,Re[13]=(qe+Ue)*Hr,Re[14]=(Ot+Ct)*Jr,Re[15]=1,Re}function c(Re,Le,Oe){return Re[0]=Le[0]-Oe[0],Re[1]=Le[1]-Oe[1],Re[2]=Le[2]-Oe[2],Re[3]=Le[3]-Oe[3],Re[4]=Le[4]-Oe[4],Re[5]=Le[5]-Oe[5],Re[6]=Le[6]-Oe[6],Re[7]=Le[7]-Oe[7],Re[8]=Le[8]-Oe[8],Re[9]=Le[9]-Oe[9],Re[10]=Le[10]-Oe[10],Re[11]=Le[11]-Oe[11],Re[12]=Le[12]-Oe[12],Re[13]=Le[13]-Oe[13],Re[14]=Le[14]-Oe[14],Re[15]=Le[15]-Oe[15],Re}return Nn.perspective=l,Nn.ortho=u,Nn.mul=i,Nn.sub=c,Nn}var $n,Gn={},qn={};function w(){if($n)return qn;function t(Re){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(Re){return typeof Re}:function(Re){return Re&&"function"==typeof Symbol&&Re.constructor===Symbol&&Re!==Symbol.prototype?"symbol":typeof Re})(Re)}$n=1,Object.defineProperty(qn,"__esModule",{value:!0}),qn.create=n,qn.clone=function(Le){var Oe=new Re.ARRAY_TYPE(3);return Oe[0]=Le[0],Oe[1]=Le[1],Oe[2]=Le[2],Oe},qn.length=i,qn.fromValues=function(Le,Oe,Ue){var qe=new Re.ARRAY_TYPE(3);return qe[0]=Le,qe[1]=Oe,qe[2]=Ue,qe},qn.copy=function(Re,Le){return Re[0]=Le[0],Re[1]=Le[1],Re[2]=Le[2],Re},qn.set=function(Re,Le,Oe,Ue){return Re[0]=Le,Re[1]=Oe,Re[2]=Ue,Re},qn.add=function(Re,Le,Oe){return Re[0]=Le[0]+Oe[0],Re[1]=Le[1]+Oe[1],Re[2]=Le[2]+Oe[2],Re},qn.subtract=a,qn.multiply=o,qn.divide=l,qn.ceil=function(Re,Le){return Re[0]=Math.ceil(Le[0]),Re[1]=Math.ceil(Le[1]),Re[2]=Math.ceil(Le[2]),Re},qn.floor=function(Re,Le){return Re[0]=Math.floor(Le[0]),Re[1]=Math.floor(Le[1]),Re[2]=Math.floor(Le[2]),Re},qn.min=function(Re,Le,Oe){return Re[0]=Math.min(Le[0],Oe[0]),Re[1]=Math.min(Le[1],Oe[1]),Re[2]=Math.min(Le[2],Oe[2]),Re},qn.max=function(Re,Le,Oe){return Re[0]=Math.max(Le[0],Oe[0]),Re[1]=Math.max(Le[1],Oe[1]),Re[2]=Math.max(Le[2],Oe[2]),Re},qn.round=function(Re,Le){return Re[0]=Math.round(Le[0]),Re[1]=Math.round(Le[1]),Re[2]=Math.round(Le[2]),Re},qn.scale=function(Re,Le,Oe){return Re[0]=Le[0]*Oe,Re[1]=Le[1]*Oe,Re[2]=Le[2]*Oe,Re},qn.scaleAndAdd=function(Re,Le,Oe,Ue){return Re[0]=Le[0]+Oe[0]*Ue,Re[1]=Le[1]+Oe[1]*Ue,Re[2]=Le[2]+Oe[2]*Ue,Re},qn.distance=u,qn.squaredDistance=c,qn.squaredLength=h,qn.negate=function(Re,Le){return Re[0]=-Le[0],Re[1]=-Le[1],Re[2]=-Le[2],Re},qn.inverse=function(Re,Le){return Re[0]=1/Le[0],Re[1]=1/Le[1],Re[2]=1/Le[2],Re},qn.normalize=function(Re,Le){var Oe=Le[0],Ue=Le[1],qe=Le[2],Ct=Oe*Oe+Ue*Ue+qe*qe;return Ct>0&&(Ct=1/Math.sqrt(Ct)),Re[0]=Le[0]*Ct,Re[1]=Le[1]*Ct,Re[2]=Le[2]*Ct,Re},qn.dot=p,qn.cross=function(Re,Le,Oe){var Ue=Le[0],qe=Le[1],Ct=Le[2],Ot=Oe[0],Jt=Oe[1],Hr=Oe[2];return Re[0]=qe*Hr-Ct*Jt,Re[1]=Ct*Ot-Ue*Hr,Re[2]=Ue*Jt-qe*Ot,Re},qn.lerp=function(Re,Le,Oe,Ue){var qe=Le[0],Ct=Le[1],Ot=Le[2];return Re[0]=qe+Ue*(Oe[0]-qe),Re[1]=Ct+Ue*(Oe[1]-Ct),Re[2]=Ot+Ue*(Oe[2]-Ot),Re},qn.hermite=function(Re,Le,Oe,Ue,qe,Ct){var Ot=Ct*Ct,Jt=Ot*(2*Ct-3)+1,Hr=Ot*(Ct-2)+Ct,Jr=Ot*(Ct-1),Ln=Ot*(3-2*Ct);return Re[0]=Le[0]*Jt+Oe[0]*Hr+Ue[0]*Jr+qe[0]*Ln,Re[1]=Le[1]*Jt+Oe[1]*Hr+Ue[1]*Jr+qe[1]*Ln,Re[2]=Le[2]*Jt+Oe[2]*Hr+Ue[2]*Jr+qe[2]*Ln,Re},qn.bezier=function(Re,Le,Oe,Ue,qe,Ct){var Ot=1-Ct,Jt=Ot*Ot,Hr=Ct*Ct,Jr=Jt*Ot,Ln=3*Ct*Jt,Nn=3*Hr*Ot,$n=Hr*Ct;return Re[0]=Le[0]*Jr+Oe[0]*Ln+Ue[0]*Nn+qe[0]*$n,Re[1]=Le[1]*Jr+Oe[1]*Ln+Ue[1]*Nn+qe[1]*$n,Re[2]=Le[2]*Jr+Oe[2]*Ln+Ue[2]*Nn+qe[2]*$n,Re},qn.random=function(Le,Oe){Oe=Oe||1;var Ue=2*Re.RANDOM()*Math.PI,qe=2*Re.RANDOM()-1,Ct=Math.sqrt(1-qe*qe)*Oe;return Le[0]=Math.cos(Ue)*Ct,Le[1]=Math.sin(Ue)*Ct,Le[2]=qe*Oe,Le},qn.transformMat4=function(Re,Le,Oe){var Ue=Le[0],qe=Le[1],Ct=Le[2],Ot=Oe[3]*Ue+Oe[7]*qe+Oe[11]*Ct+Oe[15];return Re[0]=(Oe[0]*Ue+Oe[4]*qe+Oe[8]*Ct+Oe[12])/(Ot=Ot||1),Re[1]=(Oe[1]*Ue+Oe[5]*qe+Oe[9]*Ct+Oe[13])/Ot,Re[2]=(Oe[2]*Ue+Oe[6]*qe+Oe[10]*Ct+Oe[14])/Ot,Re},qn.transformMat3=function(Re,Le,Oe){var Ue=Le[0],qe=Le[1],Ct=Le[2];return Re[0]=Ue*Oe[0]+qe*Oe[3]+Ct*Oe[6],Re[1]=Ue*Oe[1]+qe*Oe[4]+Ct*Oe[7],Re[2]=Ue*Oe[2]+qe*Oe[5]+Ct*Oe[8],Re},qn.transformQuat=function(Re,Le,Oe){var Ue=Oe[0],qe=Oe[1],Ct=Oe[2],Ot=Le[0],Jt=Le[1],Hr=Le[2],Jr=qe*Hr-Ct*Jt,Ln=Ct*Ot-Ue*Hr,Nn=Ue*Jt-qe*Ot,$n=qe*Nn-Ct*Ln,Gn=Ct*Jr-Ue*Nn,qn=Ue*Ln-qe*Jr,Zn=2*Oe[3];return Ln*=Zn,Nn*=Zn,Gn*=2,qn*=2,Re[0]=Ot+(Jr*=Zn)+($n*=2),Re[1]=Jt+Ln+Gn,Re[2]=Hr+Nn+qn,Re},qn.rotateX=function(Re,Le,Oe,Ue){var qe=[],Ct=[];return qe[0]=Le[0]-Oe[0],qe[1]=Le[1]-Oe[1],qe[2]=Le[2]-Oe[2],Ct[0]=qe[0],Ct[1]=qe[1]*Math.cos(Ue)-qe[2]*Math.sin(Ue),Ct[2]=qe[1]*Math.sin(Ue)+qe[2]*Math.cos(Ue),Re[0]=Ct[0]+Oe[0],Re[1]=Ct[1]+Oe[1],Re[2]=Ct[2]+Oe[2],Re},qn.rotateY=function(Re,Le,Oe,Ue){var qe=[],Ct=[];return qe[0]=Le[0]-Oe[0],qe[1]=Le[1]-Oe[1],qe[2]=Le[2]-Oe[2],Ct[0]=qe[2]*Math.sin(Ue)+qe[0]*Math.cos(Ue),Ct[1]=qe[1],Ct[2]=qe[2]*Math.cos(Ue)-qe[0]*Math.sin(Ue),Re[0]=Ct[0]+Oe[0],Re[1]=Ct[1]+Oe[1],Re[2]=Ct[2]+Oe[2],Re},qn.rotateZ=function(Re,Le,Oe,Ue){var qe=[],Ct=[];return qe[0]=Le[0]-Oe[0],qe[1]=Le[1]-Oe[1],qe[2]=Le[2]-Oe[2],Ct[0]=qe[0]*Math.cos(Ue)-qe[1]*Math.sin(Ue),Ct[1]=qe[0]*Math.sin(Ue)+qe[1]*Math.cos(Ue),Ct[2]=qe[2],Re[0]=Ct[0]+Oe[0],Re[1]=Ct[1]+Oe[1],Re[2]=Ct[2]+Oe[2],Re},qn.angle=function(Re,Le){var Oe=Re[0],Ue=Re[1],qe=Re[2],Ct=Le[0],Ot=Le[1],Jt=Le[2],Hr=Math.sqrt(Oe*Oe+Ue*Ue+qe*qe)*Math.sqrt(Ct*Ct+Ot*Ot+Jt*Jt),Jr=Hr&&p(Re,Le)/Hr;return Math.acos(Math.min(Math.max(Jr,-1),1))},qn.zero=function(Re){return Re[0]=0,Re[1]=0,Re[2]=0,Re},qn.str=function(Re){return"vec3("+Re[0]+", "+Re[1]+", "+Re[2]+")"},qn.exactEquals=function(Re,Le){return Re[0]===Le[0]&&Re[1]===Le[1]&&Re[2]===Le[2]},qn.equals=function(Le,Oe){var Ue=Le[0],qe=Le[1],Ct=Le[2],Ot=Oe[0],Jt=Oe[1],Hr=Oe[2];return Math.abs(Ue-Ot)<=Re.EPSILON*Math.max(1,Math.abs(Ue),Math.abs(Ot))&&Math.abs(qe-Jt)<=Re.EPSILON*Math.max(1,Math.abs(qe),Math.abs(Jt))&&Math.abs(Ct-Hr)<=Re.EPSILON*Math.max(1,Math.abs(Ct),Math.abs(Hr))},qn.forEach=qn.sqrLen=qn.len=qn.sqrDist=qn.dist=qn.div=qn.mul=qn.sub=void 0;var Re=function(Re){if(Re&&Re.__esModule)return Re;if(null===Re||"object"!==t(Re)&&"function"!=typeof Re)return{default:Re};var Le=r(void 0);if(Le&&Le.has(Re))return Le.get(Re);var Oe={},Ue=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var qe in Re)if("default"!==qe&&Object.prototype.hasOwnProperty.call(Re,qe)){var Ct=Ue?Object.getOwnPropertyDescriptor(Re,qe):null;Ct&&(Ct.get||Ct.set)?Object.defineProperty(Oe,qe,Ct):Oe[qe]=Re[qe]}return Oe.default=Re,Le&&Le.set(Re,Oe),Oe}(s());function r(Re){if("function"!=typeof WeakMap)return null;var Le=new WeakMap,Oe=new WeakMap;return(r=function(Re){return Re?Oe:Le})(Re)}function n(){var Le=new Re.ARRAY_TYPE(3);return Re.ARRAY_TYPE!=Float32Array&&(Le[0]=0,Le[1]=0,Le[2]=0),Le}function i(Re){return Math.hypot(Re[0],Re[1],Re[2])}function a(Re,Le,Oe){return Re[0]=Le[0]-Oe[0],Re[1]=Le[1]-Oe[1],Re[2]=Le[2]-Oe[2],Re}function o(Re,Le,Oe){return Re[0]=Le[0]*Oe[0],Re[1]=Le[1]*Oe[1],Re[2]=Le[2]*Oe[2],Re}function l(Re,Le,Oe){return Re[0]=Le[0]/Oe[0],Re[1]=Le[1]/Oe[1],Re[2]=Le[2]/Oe[2],Re}function u(Re,Le){return Math.hypot(Le[0]-Re[0],Le[1]-Re[1],Le[2]-Re[2])}function c(Re,Le){var Oe=Le[0]-Re[0],Ue=Le[1]-Re[1],qe=Le[2]-Re[2];return Oe*Oe+Ue*Ue+qe*qe}function h(Re){var Le=Re[0],Oe=Re[1],Ue=Re[2];return Le*Le+Oe*Oe+Ue*Ue}function p(Re,Le){return Re[0]*Le[0]+Re[1]*Le[1]+Re[2]*Le[2]}qn.sub=a,qn.mul=o,qn.div=l,qn.dist=u,qn.sqrDist=c,qn.len=i,qn.sqrLen=h;var Le,Oe=(Le=n(),function(Re,Oe,Ue,qe,Ct,Ot){var Jt,Hr;for(Oe||(Oe=3),Ue||(Ue=0),Hr=qe?Math.min(qe*Oe+Ue,Re.length):Re.length,Jt=Ue;Jt<Hr;Jt+=Oe)Le[0]=Re[Jt],Le[1]=Re[Jt+1],Le[2]=Re[Jt+2],Ct(Le,Le,Ot),Re[Jt]=Le[0],Re[Jt+1]=Le[1],Re[Jt+2]=Le[2];return Re});return qn.forEach=Oe,qn}var Zn,Xn,Yn={};function S(){if(Zn)return Yn;function t(Re){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(Re){return typeof Re}:function(Re){return Re&&"function"==typeof Symbol&&Re.constructor===Symbol&&Re!==Symbol.prototype?"symbol":typeof Re})(Re)}Zn=1,Object.defineProperty(Yn,"__esModule",{value:!0}),Yn.create=n,Yn.clone=function(Le){var Oe=new Re.ARRAY_TYPE(4);return Oe[0]=Le[0],Oe[1]=Le[1],Oe[2]=Le[2],Oe[3]=Le[3],Oe},Yn.fromValues=function(Le,Oe,Ue,qe){var Ct=new Re.ARRAY_TYPE(4);return Ct[0]=Le,Ct[1]=Oe,Ct[2]=Ue,Ct[3]=qe,Ct},Yn.copy=function(Re,Le){return Re[0]=Le[0],Re[1]=Le[1],Re[2]=Le[2],Re[3]=Le[3],Re},Yn.set=function(Re,Le,Oe,Ue,qe){return Re[0]=Le,Re[1]=Oe,Re[2]=Ue,Re[3]=qe,Re},Yn.add=function(Re,Le,Oe){return Re[0]=Le[0]+Oe[0],Re[1]=Le[1]+Oe[1],Re[2]=Le[2]+Oe[2],Re[3]=Le[3]+Oe[3],Re},Yn.subtract=i,Yn.multiply=a,Yn.divide=o,Yn.ceil=function(Re,Le){return Re[0]=Math.ceil(Le[0]),Re[1]=Math.ceil(Le[1]),Re[2]=Math.ceil(Le[2]),Re[3]=Math.ceil(Le[3]),Re},Yn.floor=function(Re,Le){return Re[0]=Math.floor(Le[0]),Re[1]=Math.floor(Le[1]),Re[2]=Math.floor(Le[2]),Re[3]=Math.floor(Le[3]),Re},Yn.min=function(Re,Le,Oe){return Re[0]=Math.min(Le[0],Oe[0]),Re[1]=Math.min(Le[1],Oe[1]),Re[2]=Math.min(Le[2],Oe[2]),Re[3]=Math.min(Le[3],Oe[3]),Re},Yn.max=function(Re,Le,Oe){return Re[0]=Math.max(Le[0],Oe[0]),Re[1]=Math.max(Le[1],Oe[1]),Re[2]=Math.max(Le[2],Oe[2]),Re[3]=Math.max(Le[3],Oe[3]),Re},Yn.round=function(Re,Le){return Re[0]=Math.round(Le[0]),Re[1]=Math.round(Le[1]),Re[2]=Math.round(Le[2]),Re[3]=Math.round(Le[3]),Re},Yn.scale=function(Re,Le,Oe){return Re[0]=Le[0]*Oe,Re[1]=Le[1]*Oe,Re[2]=Le[2]*Oe,Re[3]=Le[3]*Oe,Re},Yn.scaleAndAdd=function(Re,Le,Oe,Ue){return Re[0]=Le[0]+Oe[0]*Ue,Re[1]=Le[1]+Oe[1]*Ue,Re[2]=Le[2]+Oe[2]*Ue,Re[3]=Le[3]+Oe[3]*Ue,Re},Yn.distance=l,Yn.squaredDistance=u,Yn.length=c,Yn.squaredLength=h,Yn.negate=function(Re,Le){return Re[0]=-Le[0],Re[1]=-Le[1],Re[2]=-Le[2],Re[3]=-Le[3],Re},Yn.inverse=function(Re,Le){return Re[0]=1/Le[0],Re[1]=1/Le[1],Re[2]=1/Le[2],Re[3]=1/Le[3],Re},Yn.normalize=function(Re,Le){var Oe=Le[0],Ue=Le[1],qe=Le[2],Ct=Le[3],Ot=Oe*Oe+Ue*Ue+qe*qe+Ct*Ct;return Ot>0&&(Ot=1/Math.sqrt(Ot)),Re[0]=Oe*Ot,Re[1]=Ue*Ot,Re[2]=qe*Ot,Re[3]=Ct*Ot,Re},Yn.dot=function(Re,Le){return Re[0]*Le[0]+Re[1]*Le[1]+Re[2]*Le[2]+Re[3]*Le[3]},Yn.cross=function(Re,Le,Oe,Ue){var qe=Oe[0]*Ue[1]-Oe[1]*Ue[0],Ct=Oe[0]*Ue[2]-Oe[2]*Ue[0],Ot=Oe[0]*Ue[3]-Oe[3]*Ue[0],Jt=Oe[1]*Ue[2]-Oe[2]*Ue[1],Hr=Oe[1]*Ue[3]-Oe[3]*Ue[1],Jr=Oe[2]*Ue[3]-Oe[3]*Ue[2],Ln=Le[0],Nn=Le[1],$n=Le[2],Gn=Le[3];return Re[0]=Nn*Jr-$n*Hr+Gn*Jt,Re[1]=-Ln*Jr+$n*Ot-Gn*Ct,Re[2]=Ln*Hr-Nn*Ot+Gn*qe,Re[3]=-Ln*Jt+Nn*Ct-$n*qe,Re},Yn.lerp=function(Re,Le,Oe,Ue){var qe=Le[0],Ct=Le[1],Ot=Le[2],Jt=Le[3];return Re[0]=qe+Ue*(Oe[0]-qe),Re[1]=Ct+Ue*(Oe[1]-Ct),Re[2]=Ot+Ue*(Oe[2]-Ot),Re[3]=Jt+Ue*(Oe[3]-Jt),Re},Yn.random=function(Le,Oe){var Ue,qe,Ct,Ot,Jt,Hr;Oe=Oe||1;do{Jt=(Ue=2*Re.RANDOM()-1)*Ue+(qe=2*Re.RANDOM()-1)*qe}while(Jt>=1);do{Hr=(Ct=2*Re.RANDOM()-1)*Ct+(Ot=2*Re.RANDOM()-1)*Ot}while(Hr>=1);var Jr=Math.sqrt((1-Jt)/Hr);return Le[0]=Oe*Ue,Le[1]=Oe*qe,Le[2]=Oe*Ct*Jr,Le[3]=Oe*Ot*Jr,Le},Yn.transformMat4=function(Re,Le,Oe){var Ue=Le[0],qe=Le[1],Ct=Le[2],Ot=Le[3];return Re[0]=Oe[0]*Ue+Oe[4]*qe+Oe[8]*Ct+Oe[12]*Ot,Re[1]=Oe[1]*Ue+Oe[5]*qe+Oe[9]*Ct+Oe[13]*Ot,Re[2]=Oe[2]*Ue+Oe[6]*qe+Oe[10]*Ct+Oe[14]*Ot,Re[3]=Oe[3]*Ue+Oe[7]*qe+Oe[11]*Ct+Oe[15]*Ot,Re},Yn.transformQuat=function(Re,Le,Oe){var Ue=Le[0],qe=Le[1],Ct=Le[2],Ot=Oe[0],Jt=Oe[1],Hr=Oe[2],Jr=Oe[3],Ln=Jr*Ue+Jt*Ct-Hr*qe,Nn=Jr*qe+Hr*Ue-Ot*Ct,$n=Jr*Ct+Ot*qe-Jt*Ue,Gn=-Ot*Ue-Jt*qe-Hr*Ct;return Re[0]=Ln*Jr+Gn*-Ot+Nn*-Hr-$n*-Jt,Re[1]=Nn*Jr+Gn*-Jt+$n*-Ot-Ln*-Hr,Re[2]=$n*Jr+Gn*-Hr+Ln*-Jt-Nn*-Ot,Re[3]=Le[3],Re},Yn.zero=function(Re){return Re[0]=0,Re[1]=0,Re[2]=0,Re[3]=0,Re},Yn.str=function(Re){return"vec4("+Re[0]+", "+Re[1]+", "+Re[2]+", "+Re[3]+")"},Yn.exactEquals=function(Re,Le){return Re[0]===Le[0]&&Re[1]===Le[1]&&Re[2]===Le[2]&&Re[3]===Le[3]},Yn.equals=function(Le,Oe){var Ue=Le[0],qe=Le[1],Ct=Le[2],Ot=Le[3],Jt=Oe[0],Hr=Oe[1],Jr=Oe[2],Ln=Oe[3];return Math.abs(Ue-Jt)<=Re.EPSILON*Math.max(1,Math.abs(Ue),Math.abs(Jt))&&Math.abs(qe-Hr)<=Re.EPSILON*Math.max(1,Math.abs(qe),Math.abs(Hr))&&Math.abs(Ct-Jr)<=Re.EPSILON*Math.max(1,Math.abs(Ct),Math.abs(Jr))&&Math.abs(Ot-Ln)<=Re.EPSILON*Math.max(1,Math.abs(Ot),Math.abs(Ln))},Yn.forEach=Yn.sqrLen=Yn.len=Yn.sqrDist=Yn.dist=Yn.div=Yn.mul=Yn.sub=void 0;var Re=function(Re){if(Re&&Re.__esModule)return Re;if(null===Re||"object"!==t(Re)&&"function"!=typeof Re)return{default:Re};var Le=r(void 0);if(Le&&Le.has(Re))return Le.get(Re);var Oe={},Ue=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var qe in Re)if("default"!==qe&&Object.prototype.hasOwnProperty.call(Re,qe)){var Ct=Ue?Object.getOwnPropertyDescriptor(Re,qe):null;Ct&&(Ct.get||Ct.set)?Object.defineProperty(Oe,qe,Ct):Oe[qe]=Re[qe]}return Oe.default=Re,Le&&Le.set(Re,Oe),Oe}(s());function r(Re){if("function"!=typeof WeakMap)return null;var Le=new WeakMap,Oe=new WeakMap;return(r=function(Re){return Re?Oe:Le})(Re)}function n(){var Le=new Re.ARRAY_TYPE(4);return Re.ARRAY_TYPE!=Float32Array&&(Le[0]=0,Le[1]=0,Le[2]=0,Le[3]=0),Le}function i(Re,Le,Oe){return Re[0]=Le[0]-Oe[0],Re[1]=Le[1]-Oe[1],Re[2]=Le[2]-Oe[2],Re[3]=Le[3]-Oe[3],Re}function a(Re,Le,Oe){return Re[0]=Le[0]*Oe[0],Re[1]=Le[1]*Oe[1],Re[2]=Le[2]*Oe[2],Re[3]=Le[3]*Oe[3],Re}function o(Re,Le,Oe){return Re[0]=Le[0]/Oe[0],Re[1]=Le[1]/Oe[1],Re[2]=Le[2]/Oe[2],Re[3]=Le[3]/Oe[3],Re}function l(Re,Le){return Math.hypot(Le[0]-Re[0],Le[1]-Re[1],Le[2]-Re[2],Le[3]-Re[3])}function u(Re,Le){var Oe=Le[0]-Re[0],Ue=Le[1]-Re[1],qe=Le[2]-Re[2],Ct=Le[3]-Re[3];return Oe*Oe+Ue*Ue+qe*qe+Ct*Ct}function c(Re){return Math.hypot(Re[0],Re[1],Re[2],Re[3])}function h(Re){var Le=Re[0],Oe=Re[1],Ue=Re[2],qe=Re[3];return Le*Le+Oe*Oe+Ue*Ue+qe*qe}Yn.sub=i,Yn.mul=a,Yn.div=o,Yn.dist=l,Yn.sqrDist=u,Yn.len=c,Yn.sqrLen=h;var Le,Oe=(Le=n(),function(Re,Oe,Ue,qe,Ct,Ot){var Jt,Hr;for(Oe||(Oe=4),Ue||(Ue=0),Hr=qe?Math.min(qe*Oe+Ue,Re.length):Re.length,Jt=Ue;Jt<Hr;Jt+=Oe)Le[0]=Re[Jt],Le[1]=Re[Jt+1],Le[2]=Re[Jt+2],Le[3]=Re[Jt+3],Ct(Le,Le,Ot),Re[Jt]=Le[0],Re[Jt+1]=Le[1],Re[Jt+2]=Le[2],Re[Jt+3]=Le[3];return Re});return Yn.forEach=Oe,Yn}function I(){if(Xn)return Gn;function t(Re){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(Re){return typeof Re}:function(Re){return Re&&"function"==typeof Symbol&&Re.constructor===Symbol&&Re!==Symbol.prototype?"symbol":typeof Re})(Re)}Xn=1,Object.defineProperty(Gn,"__esModule",{value:!0}),Gn.create=l,Gn.identity=function(Re){return Re[0]=0,Re[1]=0,Re[2]=0,Re[3]=1,Re},Gn.setAxisAngle=u,Gn.getAxisAngle=function(Le,Oe){var Ue=2*Math.acos(Oe[3]),qe=Math.sin(Ue/2);return qe>Re.EPSILON?(Le[0]=Oe[0]/qe,Le[1]=Oe[1]/qe,Le[2]=Oe[2]/qe):(Le[0]=1,Le[1]=0,Le[2]=0),Ue},Gn.getAngle=function(Re,Le){var Oe=Ct(Re,Le);return Math.acos(2*Oe*Oe-1)},Gn.multiply=c,Gn.rotateX=function(Re,Le,Oe){Oe*=.5;var Ue=Le[0],qe=Le[1],Ct=Le[2],Ot=Le[3],Jt=Math.sin(Oe),Hr=Math.cos(Oe);return Re[0]=Ue*Hr+Ot*Jt,Re[1]=qe*Hr+Ct*Jt,Re[2]=Ct*Hr-qe*Jt,Re[3]=Ot*Hr-Ue*Jt,Re},Gn.rotateY=function(Re,Le,Oe){Oe*=.5;var Ue=Le[0],qe=Le[1],Ct=Le[2],Ot=Le[3],Jt=Math.sin(Oe),Hr=Math.cos(Oe);return Re[0]=Ue*Hr-Ct*Jt,Re[1]=qe*Hr+Ot*Jt,Re[2]=Ct*Hr+Ue*Jt,Re[3]=Ot*Hr-qe*Jt,Re},Gn.rotateZ=function(Re,Le,Oe){Oe*=.5;var Ue=Le[0],qe=Le[1],Ct=Le[2],Ot=Le[3],Jt=Math.sin(Oe),Hr=Math.cos(Oe);return Re[0]=Ue*Hr+qe*Jt,Re[1]=qe*Hr-Ue*Jt,Re[2]=Ct*Hr+Ot*Jt,Re[3]=Ot*Hr-Ct*Jt,Re},Gn.calculateW=function(Re,Le){var Oe=Le[0],Ue=Le[1],qe=Le[2];return Re[0]=Oe,Re[1]=Ue,Re[2]=qe,Re[3]=Math.sqrt(Math.abs(1-Oe*Oe-Ue*Ue-qe*qe)),Re},Gn.exp=h,Gn.ln=p,Gn.pow=function(Re,Le,Oe){return p(Re,Le),qe(Re,Re,Oe),h(Re,Re),Re},Gn.slerp=f,Gn.random=function(Le){var Oe=Re.RANDOM(),Ue=Re.RANDOM(),qe=Re.RANDOM(),Ct=Math.sqrt(1-Oe),Ot=Math.sqrt(Oe);return Le[0]=Ct*Math.sin(2*Math.PI*Ue),Le[1]=Ct*Math.cos(2*Math.PI*Ue),Le[2]=Ot*Math.sin(2*Math.PI*qe),Le[3]=Ot*Math.cos(2*Math.PI*qe),Le},Gn.invert=function(Re,Le){var Oe=Le[0],Ue=Le[1],qe=Le[2],Ct=Le[3],Ot=Oe*Oe+Ue*Ue+qe*qe+Ct*Ct,Jt=Ot?1/Ot:0;return Re[0]=-Oe*Jt,Re[1]=-Ue*Jt,Re[2]=-qe*Jt,Re[3]=Ct*Jt,Re},Gn.conjugate=function(Re,Le){return Re[0]=-Le[0],Re[1]=-Le[1],Re[2]=-Le[2],Re[3]=Le[3],Re},Gn.fromMat3=m,Gn.fromEuler=function(Re,Le,Oe,Ue){var qe=.5*Math.PI/180;Le*=qe,Oe*=qe,Ue*=qe;var Ct=Math.sin(Le),Ot=Math.cos(Le),Jt=Math.sin(Oe),Hr=Math.cos(Oe),Jr=Math.sin(Ue),Ln=Math.cos(Ue);return Re[0]=Ct*Hr*Ln-Ot*Jt*Jr,Re[1]=Ot*Jt*Ln+Ct*Hr*Jr,Re[2]=Ot*Hr*Jr-Ct*Jt*Ln,Re[3]=Ot*Hr*Ln+Ct*Jt*Jr,Re},Gn.str=function(Re){return"quat("+Re[0]+", "+Re[1]+", "+Re[2]+", "+Re[3]+")"},Gn.setAxes=Gn.sqlerp=Gn.rotationTo=Gn.equals=Gn.exactEquals=Gn.normalize=Gn.sqrLen=Gn.squaredLength=Gn.len=Gn.length=Gn.lerp=Gn.dot=Gn.scale=Gn.mul=Gn.add=Gn.set=Gn.copy=Gn.fromValues=Gn.clone=void 0;var Re=o(s()),Le=o(d()),Oe=o(w()),Ue=o(S());function a(Re){if("function"!=typeof WeakMap)return null;var Le=new WeakMap,Oe=new WeakMap;return(a=function(Re){return Re?Oe:Le})(Re)}function o(Re,Le){if(Re&&Re.__esModule)return Re;if(null===Re||"object"!==t(Re)&&"function"!=typeof Re)return{default:Re};var Oe=a(Le);if(Oe&&Oe.has(Re))return Oe.get(Re);var Ue={},qe=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Ct in Re)if("default"!==Ct&&Object.prototype.hasOwnProperty.call(Re,Ct)){var Ot=qe?Object.getOwnPropertyDescriptor(Re,Ct):null;Ot&&(Ot.get||Ot.set)?Object.defineProperty(Ue,Ct,Ot):Ue[Ct]=Re[Ct]}return Ue.default=Re,Oe&&Oe.set(Re,Ue),Ue}function l(){var Le=new Re.ARRAY_TYPE(4);return Re.ARRAY_TYPE!=Float32Array&&(Le[0]=0,Le[1]=0,Le[2]=0),Le[3]=1,Le}function u(Re,Le,Oe){Oe*=.5;var Ue=Math.sin(Oe);return Re[0]=Ue*Le[0],Re[1]=Ue*Le[1],Re[2]=Ue*Le[2],Re[3]=Math.cos(Oe),Re}function c(Re,Le,Oe){var Ue=Le[0],qe=Le[1],Ct=Le[2],Ot=Le[3],Jt=Oe[0],Hr=Oe[1],Jr=Oe[2],Ln=Oe[3];return Re[0]=Ue*Ln+Ot*Jt+qe*Jr-Ct*Hr,Re[1]=qe*Ln+Ot*Hr+Ct*Jt-Ue*Jr,Re[2]=Ct*Ln+Ot*Jr+Ue*Hr-qe*Jt,Re[3]=Ot*Ln-Ue*Jt-qe*Hr-Ct*Jr,Re}function h(Re,Le){var Oe=Le[0],Ue=Le[1],qe=Le[2],Ct=Le[3],Ot=Math.sqrt(Oe*Oe+Ue*Ue+qe*qe),Jt=Math.exp(Ct),Hr=Ot>0?Jt*Math.sin(Ot)/Ot:0;return Re[0]=Oe*Hr,Re[1]=Ue*Hr,Re[2]=qe*Hr,Re[3]=Jt*Math.cos(Ot),Re}function p(Re,Le){var Oe=Le[0],Ue=Le[1],qe=Le[2],Ct=Le[3],Ot=Math.sqrt(Oe*Oe+Ue*Ue+qe*qe),Jt=Ot>0?Math.atan2(Ot,Ct)/Ot:0;return Re[0]=Oe*Jt,Re[1]=Ue*Jt,Re[2]=qe*Jt,Re[3]=.5*Math.log(Oe*Oe+Ue*Ue+qe*qe+Ct*Ct),Re}function f(Le,Oe,Ue,qe){var Ct,Ot,Jt,Hr,Jr,Ln=Oe[0],Nn=Oe[1],$n=Oe[2],Gn=Oe[3],qn=Ue[0],Zn=Ue[1],Xn=Ue[2],Yn=Ue[3];return(Ot=Ln*qn+Nn*Zn+$n*Xn+Gn*Yn)<0&&(Ot=-Ot,qn=-qn,Zn=-Zn,Xn=-Xn,Yn=-Yn),1-Ot>Re.EPSILON?(Ct=Math.acos(Ot),Jt=Math.sin(Ct),Hr=Math.sin((1-qe)*Ct)/Jt,Jr=Math.sin(qe*Ct)/Jt):(Hr=1-qe,Jr=qe),Le[0]=Hr*Ln+Jr*qn,Le[1]=Hr*Nn+Jr*Zn,Le[2]=Hr*$n+Jr*Xn,Le[3]=Hr*Gn+Jr*Yn,Le}function m(Re,Le){var Oe,Ue=Le[0]+Le[4]+Le[8];if(Ue>0)Oe=Math.sqrt(Ue+1),Re[3]=.5*Oe,Re[0]=(Le[5]-Le[7])*(Oe=.5/Oe),Re[1]=(Le[6]-Le[2])*Oe,Re[2]=(Le[1]-Le[3])*Oe;else{var qe=0;Le[4]>Le[0]&&(qe=1),Le[8]>Le[3*qe+qe]&&(qe=2);var Ct=(qe+1)%3,Ot=(qe+2)%3;Oe=Math.sqrt(Le[3*qe+qe]-Le[3*Ct+Ct]-Le[3*Ot+Ot]+1),Re[qe]=.5*Oe,Re[3]=(Le[3*Ct+Ot]-Le[3*Ot+Ct])*(Oe=.5/Oe),Re[Ct]=(Le[3*Ct+qe]+Le[3*qe+Ct])*Oe,Re[Ot]=(Le[3*Ot+qe]+Le[3*qe+Ot])*Oe}return Re}Gn.clone=Ue.clone,Gn.fromValues=Ue.fromValues,Gn.copy=Ue.copy,Gn.set=Ue.set,Gn.add=Ue.add,Gn.mul=c;var qe=Ue.scale;Gn.scale=qe;var Ct=Ue.dot;Gn.dot=Ct,Gn.lerp=Ue.lerp;var Ot=Ue.length;Gn.length=Ot,Gn.len=Ot;var Jt=Ue.squaredLength;Gn.squaredLength=Jt,Gn.sqrLen=Jt;var Hr=Ue.normalize;Gn.normalize=Hr,Gn.exactEquals=Ue.exactEquals,Gn.equals=Ue.equals;var Jr,Ln,Nn,$n=(Jr=Oe.create(),Ln=Oe.fromValues(1,0,0),Nn=Oe.fromValues(0,1,0),function(Re,Le,Ue){var qe=Oe.dot(Le,Ue);return qe<-.999999?(Oe.cross(Jr,Ln,Le),Oe.len(Jr)<1e-6&&Oe.cross(Jr,Nn,Le),Oe.normalize(Jr,Jr),u(Re,Jr,Math.PI),Re):qe>.999999?(Re[0]=0,Re[1]=0,Re[2]=0,Re[3]=1,Re):(Oe.cross(Jr,Le,Ue),Re[0]=Jr[0],Re[1]=Jr[1],Re[2]=Jr[2],Re[3]=1+qe,Hr(Re,Re))});Gn.rotationTo=$n;var qn,Zn,Yn=(qn=l(),Zn=l(),function(Re,Le,Oe,Ue,qe,Ct){return f(qn,Le,qe,Ct),f(Zn,Oe,Ue,Ct),f(Re,qn,Zn,2*Ct*(1-Ct)),Re});Gn.sqlerp=Yn;var _i,vi=(_i=Le.create(),function(Re,Le,Oe,Ue){return _i[0]=Oe[0],_i[3]=Oe[1],_i[6]=Oe[2],_i[1]=Ue[0],_i[4]=Ue[1],_i[7]=Ue[2],_i[2]=-Le[0],_i[5]=-Le[1],_i[8]=-Le[2],Hr(Re,m(Re,_i))});return Gn.setAxes=vi,Gn}var _i,vi={};function k(){if(_i)return vi;function t(Re){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(Re){return typeof Re}:function(Re){return Re&&"function"==typeof Symbol&&Re.constructor===Symbol&&Re!==Symbol.prototype?"symbol":typeof Re})(Re)}_i=1,Object.defineProperty(vi,"__esModule",{value:!0}),vi.create=function(){var Le=new Re.ARRAY_TYPE(8);return Re.ARRAY_TYPE!=Float32Array&&(Le[0]=0,Le[1]=0,Le[2]=0,Le[4]=0,Le[5]=0,Le[6]=0,Le[7]=0),Le[3]=1,Le},vi.clone=function(Le){var Oe=new Re.ARRAY_TYPE(8);return Oe[0]=Le[0],Oe[1]=Le[1],Oe[2]=Le[2],Oe[3]=Le[3],Oe[4]=Le[4],Oe[5]=Le[5],Oe[6]=Le[6],Oe[7]=Le[7],Oe},vi.fromValues=function(Le,Oe,Ue,qe,Ct,Ot,Jt,Hr){var Jr=new Re.ARRAY_TYPE(8);return Jr[0]=Le,Jr[1]=Oe,Jr[2]=Ue,Jr[3]=qe,Jr[4]=Ct,Jr[5]=Ot,Jr[6]=Jt,Jr[7]=Hr,Jr},vi.fromRotationTranslationValues=function(Le,Oe,Ue,qe,Ct,Ot,Jt){var Hr=new Re.ARRAY_TYPE(8);Hr[0]=Le,Hr[1]=Oe,Hr[2]=Ue,Hr[3]=qe;var Jr=.5*Ct,Ln=.5*Ot,Nn=.5*Jt;return Hr[4]=Jr*qe+Ln*Ue-Nn*Oe,Hr[5]=Ln*qe+Nn*Le-Jr*Ue,Hr[6]=Nn*qe+Jr*Oe-Ln*Le,Hr[7]=-Jr*Le-Ln*Oe-Nn*Ue,Hr},vi.fromRotationTranslation=o,vi.fromTranslation=function(Re,Le){return Re[0]=0,Re[1]=0,Re[2]=0,Re[3]=1,Re[4]=.5*Le[0],Re[5]=.5*Le[1],Re[6]=.5*Le[2],Re[7]=0,Re},vi.fromRotation=function(Re,Le){return Re[0]=Le[0],Re[1]=Le[1],Re[2]=Le[2],Re[3]=Le[3],Re[4]=0,Re[5]=0,Re[6]=0,Re[7]=0,Re},vi.fromMat4=function(Ue,qe){var Ct=Le.create();Oe.getRotation(Ct,qe);var Ot=new Re.ARRAY_TYPE(3);return Oe.getTranslation(Ot,qe),o(Ue,Ct,Ot),Ue},vi.copy=l,vi.identity=function(Re){return Re[0]=0,Re[1]=0,Re[2]=0,Re[3]=1,Re[4]=0,Re[5]=0,Re[6]=0,Re[7]=0,Re},vi.set=function(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr){return Re[0]=Le,Re[1]=Oe,Re[2]=Ue,Re[3]=qe,Re[4]=Ct,Re[5]=Ot,Re[6]=Jt,Re[7]=Hr,Re},vi.getDual=function(Re,Le){return Re[0]=Le[4],Re[1]=Le[5],Re[2]=Le[6],Re[3]=Le[7],Re},vi.setDual=function(Re,Le){return Re[4]=Le[0],Re[5]=Le[1],Re[6]=Le[2],Re[7]=Le[3],Re},vi.getTranslation=function(Re,Le){var Oe=Le[4],Ue=Le[5],qe=Le[6],Ct=Le[7],Ot=-Le[0],Jt=-Le[1],Hr=-Le[2],Jr=Le[3];return Re[0]=2*(Oe*Jr+Ct*Ot+Ue*Hr-qe*Jt),Re[1]=2*(Ue*Jr+Ct*Jt+qe*Ot-Oe*Hr),Re[2]=2*(qe*Jr+Ct*Hr+Oe*Jt-Ue*Ot),Re},vi.translate=function(Re,Le,Oe){var Ue=Le[0],qe=Le[1],Ct=Le[2],Ot=Le[3],Jt=.5*Oe[0],Hr=.5*Oe[1],Jr=.5*Oe[2],Ln=Le[4],Nn=Le[5],$n=Le[6],Gn=Le[7];return Re[0]=Ue,Re[1]=qe,Re[2]=Ct,Re[3]=Ot,Re[4]=Ot*Jt+qe*Jr-Ct*Hr+Ln,Re[5]=Ot*Hr+Ct*Jt-Ue*Jr+Nn,Re[6]=Ot*Jr+Ue*Hr-qe*Jt+$n,Re[7]=-Ue*Jt-qe*Hr-Ct*Jr+Gn,Re},vi.rotateX=function(Re,Oe,Ue){var qe=-Oe[0],Ct=-Oe[1],Ot=-Oe[2],Jt=Oe[3],Hr=Oe[4],Jr=Oe[5],Ln=Oe[6],Nn=Oe[7],$n=Hr*Jt+Nn*qe+Jr*Ot-Ln*Ct,Gn=Jr*Jt+Nn*Ct+Ln*qe-Hr*Ot,qn=Ln*Jt+Nn*Ot+Hr*Ct-Jr*qe,Zn=Nn*Jt-Hr*qe-Jr*Ct-Ln*Ot;return Le.rotateX(Re,Oe,Ue),Re[4]=$n*(Jt=Re[3])+Zn*(qe=Re[0])+Gn*(Ot=Re[2])-qn*(Ct=Re[1]),Re[5]=Gn*Jt+Zn*Ct+qn*qe-$n*Ot,Re[6]=qn*Jt+Zn*Ot+$n*Ct-Gn*qe,Re[7]=Zn*Jt-$n*qe-Gn*Ct-qn*Ot,Re},vi.rotateY=function(Re,Oe,Ue){var qe=-Oe[0],Ct=-Oe[1],Ot=-Oe[2],Jt=Oe[3],Hr=Oe[4],Jr=Oe[5],Ln=Oe[6],Nn=Oe[7],$n=Hr*Jt+Nn*qe+Jr*Ot-Ln*Ct,Gn=Jr*Jt+Nn*Ct+Ln*qe-Hr*Ot,qn=Ln*Jt+Nn*Ot+Hr*Ct-Jr*qe,Zn=Nn*Jt-Hr*qe-Jr*Ct-Ln*Ot;return Le.rotateY(Re,Oe,Ue),Re[4]=$n*(Jt=Re[3])+Zn*(qe=Re[0])+Gn*(Ot=Re[2])-qn*(Ct=Re[1]),Re[5]=Gn*Jt+Zn*Ct+qn*qe-$n*Ot,Re[6]=qn*Jt+Zn*Ot+$n*Ct-Gn*qe,Re[7]=Zn*Jt-$n*qe-Gn*Ct-qn*Ot,Re},vi.rotateZ=function(Re,Oe,Ue){var qe=-Oe[0],Ct=-Oe[1],Ot=-Oe[2],Jt=Oe[3],Hr=Oe[4],Jr=Oe[5],Ln=Oe[6],Nn=Oe[7],$n=Hr*Jt+Nn*qe+Jr*Ot-Ln*Ct,Gn=Jr*Jt+Nn*Ct+Ln*qe-Hr*Ot,qn=Ln*Jt+Nn*Ot+Hr*Ct-Jr*qe,Zn=Nn*Jt-Hr*qe-Jr*Ct-Ln*Ot;return Le.rotateZ(Re,Oe,Ue),Re[4]=$n*(Jt=Re[3])+Zn*(qe=Re[0])+Gn*(Ot=Re[2])-qn*(Ct=Re[1]),Re[5]=Gn*Jt+Zn*Ct+qn*qe-$n*Ot,Re[6]=qn*Jt+Zn*Ot+$n*Ct-Gn*qe,Re[7]=Zn*Jt-$n*qe-Gn*Ct-qn*Ot,Re},vi.rotateByQuatAppend=function(Re,Le,Oe){var Ue=Oe[0],qe=Oe[1],Ct=Oe[2],Ot=Oe[3],Jt=Le[0],Hr=Le[1],Jr=Le[2],Ln=Le[3];return Re[0]=Jt*Ot+Ln*Ue+Hr*Ct-Jr*qe,Re[1]=Hr*Ot+Ln*qe+Jr*Ue-Jt*Ct,Re[2]=Jr*Ot+Ln*Ct+Jt*qe-Hr*Ue,Re[3]=Ln*Ot-Jt*Ue-Hr*qe-Jr*Ct,Re[4]=(Jt=Le[4])*Ot+(Ln=Le[7])*Ue+(Hr=Le[5])*Ct-(Jr=Le[6])*qe,Re[5]=Hr*Ot+Ln*qe+Jr*Ue-Jt*Ct,Re[6]=Jr*Ot+Ln*Ct+Jt*qe-Hr*Ue,Re[7]=Ln*Ot-Jt*Ue-Hr*qe-Jr*Ct,Re},vi.rotateByQuatPrepend=function(Re,Le,Oe){var Ue=Le[0],qe=Le[1],Ct=Le[2],Ot=Le[3],Jt=Oe[0],Hr=Oe[1],Jr=Oe[2],Ln=Oe[3];return Re[0]=Ue*Ln+Ot*Jt+qe*Jr-Ct*Hr,Re[1]=qe*Ln+Ot*Hr+Ct*Jt-Ue*Jr,Re[2]=Ct*Ln+Ot*Jr+Ue*Hr-qe*Jt,Re[3]=Ot*Ln-Ue*Jt-qe*Hr-Ct*Jr,Re[4]=Ue*(Ln=Oe[7])+Ot*(Jt=Oe[4])+qe*(Jr=Oe[6])-Ct*(Hr=Oe[5]),Re[5]=qe*Ln+Ot*Hr+Ct*Jt-Ue*Jr,Re[6]=Ct*Ln+Ot*Jr+Ue*Hr-qe*Jt,Re[7]=Ot*Ln-Ue*Jt-qe*Hr-Ct*Jr,Re},vi.rotateAroundAxis=function(Le,Oe,Ue,qe){if(Math.abs(qe)<Re.EPSILON)return l(Le,Oe);var Ct=Math.hypot(Ue[0],Ue[1],Ue[2]);qe*=.5;var Ot=Math.sin(qe),Jt=Ot*Ue[0]/Ct,Hr=Ot*Ue[1]/Ct,Jr=Ot*Ue[2]/Ct,Ln=Math.cos(qe),Nn=Oe[0],$n=Oe[1],Gn=Oe[2],qn=Oe[3];Le[0]=Nn*Ln+qn*Jt+$n*Jr-Gn*Hr,Le[1]=$n*Ln+qn*Hr+Gn*Jt-Nn*Jr,Le[2]=Gn*Ln+qn*Jr+Nn*Hr-$n*Jt,Le[3]=qn*Ln-Nn*Jt-$n*Hr-Gn*Jr;var Zn=Oe[4],Xn=Oe[5],Yn=Oe[6],_i=Oe[7];return Le[4]=Zn*Ln+_i*Jt+Xn*Jr-Yn*Hr,Le[5]=Xn*Ln+_i*Hr+Yn*Jt-Zn*Jr,Le[6]=Yn*Ln+_i*Jr+Zn*Hr-Xn*Jt,Le[7]=_i*Ln-Zn*Jt-Xn*Hr-Yn*Jr,Le},vi.add=function(Re,Le,Oe){return Re[0]=Le[0]+Oe[0],Re[1]=Le[1]+Oe[1],Re[2]=Le[2]+Oe[2],Re[3]=Le[3]+Oe[3],Re[4]=Le[4]+Oe[4],Re[5]=Le[5]+Oe[5],Re[6]=Le[6]+Oe[6],Re[7]=Le[7]+Oe[7],Re},vi.multiply=u,vi.scale=function(Re,Le,Oe){return Re[0]=Le[0]*Oe,Re[1]=Le[1]*Oe,Re[2]=Le[2]*Oe,Re[3]=Le[3]*Oe,Re[4]=Le[4]*Oe,Re[5]=Le[5]*Oe,Re[6]=Le[6]*Oe,Re[7]=Le[7]*Oe,Re},vi.lerp=function(Re,Le,Oe,qe){var Ct=1-qe;return Ue(Le,Oe)<0&&(qe=-qe),Re[0]=Le[0]*Ct+Oe[0]*qe,Re[1]=Le[1]*Ct+Oe[1]*qe,Re[2]=Le[2]*Ct+Oe[2]*qe,Re[3]=Le[3]*Ct+Oe[3]*qe,Re[4]=Le[4]*Ct+Oe[4]*qe,Re[5]=Le[5]*Ct+Oe[5]*qe,Re[6]=Le[6]*Ct+Oe[6]*qe,Re[7]=Le[7]*Ct+Oe[7]*qe,Re},vi.invert=function(Re,Le){var Oe=Ct(Le);return Re[0]=-Le[0]/Oe,Re[1]=-Le[1]/Oe,Re[2]=-Le[2]/Oe,Re[3]=Le[3]/Oe,Re[4]=-Le[4]/Oe,Re[5]=-Le[5]/Oe,Re[6]=-Le[6]/Oe,Re[7]=Le[7]/Oe,Re},vi.conjugate=function(Re,Le){return Re[0]=-Le[0],Re[1]=-Le[1],Re[2]=-Le[2],Re[3]=Le[3],Re[4]=-Le[4],Re[5]=-Le[5],Re[6]=-Le[6],Re[7]=Le[7],Re},vi.normalize=function(Re,Le){var Oe=Ct(Le);if(Oe>0){Oe=Math.sqrt(Oe);var Ue=Le[0]/Oe,qe=Le[1]/Oe,Ot=Le[2]/Oe,Jt=Le[3]/Oe,Hr=Le[4],Jr=Le[5],Ln=Le[6],Nn=Le[7],$n=Ue*Hr+qe*Jr+Ot*Ln+Jt*Nn;Re[0]=Ue,Re[1]=qe,Re[2]=Ot,Re[3]=Jt,Re[4]=(Hr-Ue*$n)/Oe,Re[5]=(Jr-qe*$n)/Oe,Re[6]=(Ln-Ot*$n)/Oe,Re[7]=(Nn-Jt*$n)/Oe}return Re},vi.str=function(Re){return"quat2("+Re[0]+", "+Re[1]+", "+Re[2]+", "+Re[3]+", "+Re[4]+", "+Re[5]+", "+Re[6]+", "+Re[7]+")"},vi.exactEquals=function(Re,Le){return Re[0]===Le[0]&&Re[1]===Le[1]&&Re[2]===Le[2]&&Re[3]===Le[3]&&Re[4]===Le[4]&&Re[5]===Le[5]&&Re[6]===Le[6]&&Re[7]===Le[7]},vi.equals=function(Le,Oe){var Ue=Le[0],qe=Le[1],Ct=Le[2],Ot=Le[3],Jt=Le[4],Hr=Le[5],Jr=Le[6],Ln=Le[7],Nn=Oe[0],$n=Oe[1],Gn=Oe[2],qn=Oe[3],Zn=Oe[4],Xn=Oe[5],Yn=Oe[6],_i=Oe[7];return Math.abs(Ue-Nn)<=Re.EPSILON*Math.max(1,Math.abs(Ue),Math.abs(Nn))&&Math.abs(qe-$n)<=Re.EPSILON*Math.max(1,Math.abs(qe),Math.abs($n))&&Math.abs(Ct-Gn)<=Re.EPSILON*Math.max(1,Math.abs(Ct),Math.abs(Gn))&&Math.abs(Ot-qn)<=Re.EPSILON*Math.max(1,Math.abs(Ot),Math.abs(qn))&&Math.abs(Jt-Zn)<=Re.EPSILON*Math.max(1,Math.abs(Jt),Math.abs(Zn))&&Math.abs(Hr-Xn)<=Re.EPSILON*Math.max(1,Math.abs(Hr),Math.abs(Xn))&&Math.abs(Jr-Yn)<=Re.EPSILON*Math.max(1,Math.abs(Jr),Math.abs(Yn))&&Math.abs(Ln-_i)<=Re.EPSILON*Math.max(1,Math.abs(Ln),Math.abs(_i))},vi.sqrLen=vi.squaredLength=vi.len=vi.length=vi.dot=vi.mul=vi.setReal=vi.getReal=void 0;var Re=a(s()),Le=a(I()),Oe=a(g());function i(Re){if("function"!=typeof WeakMap)return null;var Le=new WeakMap,Oe=new WeakMap;return(i=function(Re){return Re?Oe:Le})(Re)}function a(Re,Le){if(Re&&Re.__esModule)return Re;if(null===Re||"object"!==t(Re)&&"function"!=typeof Re)return{default:Re};var Oe=i(Le);if(Oe&&Oe.has(Re))return Oe.get(Re);var Ue={},qe=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Ct in Re)if("default"!==Ct&&Object.prototype.hasOwnProperty.call(Re,Ct)){var Ot=qe?Object.getOwnPropertyDescriptor(Re,Ct):null;Ot&&(Ot.get||Ot.set)?Object.defineProperty(Ue,Ct,Ot):Ue[Ct]=Re[Ct]}return Ue.default=Re,Oe&&Oe.set(Re,Ue),Ue}function o(Re,Le,Oe){var Ue=.5*Oe[0],qe=.5*Oe[1],Ct=.5*Oe[2],Ot=Le[0],Jt=Le[1],Hr=Le[2],Jr=Le[3];return Re[0]=Ot,Re[1]=Jt,Re[2]=Hr,Re[3]=Jr,Re[4]=Ue*Jr+qe*Hr-Ct*Jt,Re[5]=qe*Jr+Ct*Ot-Ue*Hr,Re[6]=Ct*Jr+Ue*Jt-qe*Ot,Re[7]=-Ue*Ot-qe*Jt-Ct*Hr,Re}function l(Re,Le){return Re[0]=Le[0],Re[1]=Le[1],Re[2]=Le[2],Re[3]=Le[3],Re[4]=Le[4],Re[5]=Le[5],Re[6]=Le[6],Re[7]=Le[7],Re}function u(Re,Le,Oe){var Ue=Le[0],qe=Le[1],Ct=Le[2],Ot=Le[3],Jt=Oe[4],Hr=Oe[5],Jr=Oe[6],Ln=Oe[7],Nn=Le[4],$n=Le[5],Gn=Le[6],qn=Le[7],Zn=Oe[0],Xn=Oe[1],Yn=Oe[2],_i=Oe[3];return Re[0]=Ue*_i+Ot*Zn+qe*Yn-Ct*Xn,Re[1]=qe*_i+Ot*Xn+Ct*Zn-Ue*Yn,Re[2]=Ct*_i+Ot*Yn+Ue*Xn-qe*Zn,Re[3]=Ot*_i-Ue*Zn-qe*Xn-Ct*Yn,Re[4]=Ue*Ln+Ot*Jt+qe*Jr-Ct*Hr+Nn*_i+qn*Zn+$n*Yn-Gn*Xn,Re[5]=qe*Ln+Ot*Hr+Ct*Jt-Ue*Jr+$n*_i+qn*Xn+Gn*Zn-Nn*Yn,Re[6]=Ct*Ln+Ot*Jr+Ue*Hr-qe*Jt+Gn*_i+qn*Yn+Nn*Xn-$n*Zn,Re[7]=Ot*Ln-Ue*Jt-qe*Hr-Ct*Jr+qn*_i-Nn*Zn-$n*Xn-Gn*Yn,Re}vi.getReal=Le.copy,vi.setReal=Le.copy,vi.mul=u;var Ue=Le.dot;vi.dot=Ue;var qe=Le.length;vi.length=qe,vi.len=qe;var Ct=Le.squaredLength;return vi.squaredLength=Ct,vi.sqrLen=Ct,vi}var xi,bi,Pi={};function V(){if(xi)return Pi;function t(Re){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(Re){return typeof Re}:function(Re){return Re&&"function"==typeof Symbol&&Re.constructor===Symbol&&Re!==Symbol.prototype?"symbol":typeof Re})(Re)}xi=1,Object.defineProperty(Pi,"__esModule",{value:!0}),Pi.create=n,Pi.clone=function(Le){var Oe=new Re.ARRAY_TYPE(2);return Oe[0]=Le[0],Oe[1]=Le[1],Oe},Pi.fromValues=function(Le,Oe){var Ue=new Re.ARRAY_TYPE(2);return Ue[0]=Le,Ue[1]=Oe,Ue},Pi.copy=function(Re,Le){return Re[0]=Le[0],Re[1]=Le[1],Re},Pi.set=function(Re,Le,Oe){return Re[0]=Le,Re[1]=Oe,Re},Pi.add=function(Re,Le,Oe){return Re[0]=Le[0]+Oe[0],Re[1]=Le[1]+Oe[1],Re},Pi.subtract=i,Pi.multiply=a,Pi.divide=o,Pi.ceil=function(Re,Le){return Re[0]=Math.ceil(Le[0]),Re[1]=Math.ceil(Le[1]),Re},Pi.floor=function(Re,Le){return Re[0]=Math.floor(Le[0]),Re[1]=Math.floor(Le[1]),Re},Pi.min=function(Re,Le,Oe){return Re[0]=Math.min(Le[0],Oe[0]),Re[1]=Math.min(Le[1],Oe[1]),Re},Pi.max=function(Re,Le,Oe){return Re[0]=Math.max(Le[0],Oe[0]),Re[1]=Math.max(Le[1],Oe[1]),Re},Pi.round=function(Re,Le){return Re[0]=Math.round(Le[0]),Re[1]=Math.round(Le[1]),Re},Pi.scale=function(Re,Le,Oe){return Re[0]=Le[0]*Oe,Re[1]=Le[1]*Oe,Re},Pi.scaleAndAdd=function(Re,Le,Oe,Ue){return Re[0]=Le[0]+Oe[0]*Ue,Re[1]=Le[1]+Oe[1]*Ue,Re},Pi.distance=l,Pi.squaredDistance=u,Pi.length=c,Pi.squaredLength=h,Pi.negate=function(Re,Le){return Re[0]=-Le[0],Re[1]=-Le[1],Re},Pi.inverse=function(Re,Le){return Re[0]=1/Le[0],Re[1]=1/Le[1],Re},Pi.normalize=function(Re,Le){var Oe=Le[0],Ue=Le[1],qe=Oe*Oe+Ue*Ue;return qe>0&&(qe=1/Math.sqrt(qe)),Re[0]=Le[0]*qe,Re[1]=Le[1]*qe,Re},Pi.dot=function(Re,Le){return Re[0]*Le[0]+Re[1]*Le[1]},Pi.cross=function(Re,Le,Oe){var Ue=Le[0]*Oe[1]-Le[1]*Oe[0];return Re[0]=Re[1]=0,Re[2]=Ue,Re},Pi.lerp=function(Re,Le,Oe,Ue){var qe=Le[0],Ct=Le[1];return Re[0]=qe+Ue*(Oe[0]-qe),Re[1]=Ct+Ue*(Oe[1]-Ct),Re},Pi.random=function(Le,Oe){Oe=Oe||1;var Ue=2*Re.RANDOM()*Math.PI;return Le[0]=Math.cos(Ue)*Oe,Le[1]=Math.sin(Ue)*Oe,Le},Pi.transformMat2=function(Re,Le,Oe){var Ue=Le[0],qe=Le[1];return Re[0]=Oe[0]*Ue+Oe[2]*qe,Re[1]=Oe[1]*Ue+Oe[3]*qe,Re},Pi.transformMat2d=function(Re,Le,Oe){var Ue=Le[0],qe=Le[1];return Re[0]=Oe[0]*Ue+Oe[2]*qe+Oe[4],Re[1]=Oe[1]*Ue+Oe[3]*qe+Oe[5],Re},Pi.transformMat3=function(Re,Le,Oe){var Ue=Le[0],qe=Le[1];return Re[0]=Oe[0]*Ue+Oe[3]*qe+Oe[6],Re[1]=Oe[1]*Ue+Oe[4]*qe+Oe[7],Re},Pi.transformMat4=function(Re,Le,Oe){var Ue=Le[0],qe=Le[1];return Re[0]=Oe[0]*Ue+Oe[4]*qe+Oe[12],Re[1]=Oe[1]*Ue+Oe[5]*qe+Oe[13],Re},Pi.rotate=function(Re,Le,Oe,Ue){var qe=Le[0]-Oe[0],Ct=Le[1]-Oe[1],Ot=Math.sin(Ue),Jt=Math.cos(Ue);return Re[0]=qe*Jt-Ct*Ot+Oe[0],Re[1]=qe*Ot+Ct*Jt+Oe[1],Re},Pi.angle=function(Re,Le){var Oe=Re[0],Ue=Re[1],qe=Le[0],Ct=Le[1],Ot=Math.sqrt(Oe*Oe+Ue*Ue)*Math.sqrt(qe*qe+Ct*Ct);return Math.acos(Math.min(Math.max(Ot&&(Oe*qe+Ue*Ct)/Ot,-1),1))},Pi.zero=function(Re){return Re[0]=0,Re[1]=0,Re},Pi.str=function(Re){return"vec2("+Re[0]+", "+Re[1]+")"},Pi.exactEquals=function(Re,Le){return Re[0]===Le[0]&&Re[1]===Le[1]},Pi.equals=function(Le,Oe){var Ue=Le[0],qe=Le[1],Ct=Oe[0],Ot=Oe[1];return Math.abs(Ue-Ct)<=Re.EPSILON*Math.max(1,Math.abs(Ue),Math.abs(Ct))&&Math.abs(qe-Ot)<=Re.EPSILON*Math.max(1,Math.abs(qe),Math.abs(Ot))},Pi.forEach=Pi.sqrLen=Pi.sqrDist=Pi.dist=Pi.div=Pi.mul=Pi.sub=Pi.len=void 0;var Re=function(Re){if(Re&&Re.__esModule)return Re;if(null===Re||"object"!==t(Re)&&"function"!=typeof Re)return{default:Re};var Le=r(void 0);if(Le&&Le.has(Re))return Le.get(Re);var Oe={},Ue=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var qe in Re)if("default"!==qe&&Object.prototype.hasOwnProperty.call(Re,qe)){var Ct=Ue?Object.getOwnPropertyDescriptor(Re,qe):null;Ct&&(Ct.get||Ct.set)?Object.defineProperty(Oe,qe,Ct):Oe[qe]=Re[qe]}return Oe.default=Re,Le&&Le.set(Re,Oe),Oe}(s());function r(Re){if("function"!=typeof WeakMap)return null;var Le=new WeakMap,Oe=new WeakMap;return(r=function(Re){return Re?Oe:Le})(Re)}function n(){var Le=new Re.ARRAY_TYPE(2);return Re.ARRAY_TYPE!=Float32Array&&(Le[0]=0,Le[1]=0),Le}function i(Re,Le,Oe){return Re[0]=Le[0]-Oe[0],Re[1]=Le[1]-Oe[1],Re}function a(Re,Le,Oe){return Re[0]=Le[0]*Oe[0],Re[1]=Le[1]*Oe[1],Re}function o(Re,Le,Oe){return Re[0]=Le[0]/Oe[0],Re[1]=Le[1]/Oe[1],Re}function l(Re,Le){return Math.hypot(Le[0]-Re[0],Le[1]-Re[1])}function u(Re,Le){var Oe=Le[0]-Re[0],Ue=Le[1]-Re[1];return Oe*Oe+Ue*Ue}function c(Re){return Math.hypot(Re[0],Re[1])}function h(Re){var Le=Re[0],Oe=Re[1];return Le*Le+Oe*Oe}Pi.len=c,Pi.sub=i,Pi.mul=a,Pi.div=o,Pi.dist=l,Pi.sqrDist=u,Pi.sqrLen=h;var Le,Oe=(Le=n(),function(Re,Oe,Ue,qe,Ct,Ot){var Jt,Hr;for(Oe||(Oe=2),Ue||(Ue=0),Hr=qe?Math.min(qe*Oe+Ue,Re.length):Re.length,Jt=Ue;Jt<Hr;Jt+=Oe)Le[0]=Re[Jt],Le[1]=Re[Jt+1],Ct(Le,Le,Ot),Re[Jt]=Le[0],Re[Jt+1]=Le[1];return Re});return Pi.forEach=Oe,Pi}function C(){if(bi)return Oe;function t(Re){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(Re){return typeof Re}:function(Re){return Re&&"function"==typeof Symbol&&Re.constructor===Symbol&&Re!==Symbol.prototype?"symbol":typeof Re})(Re)}bi=1,Object.defineProperty(Oe,"__esModule",{value:!0}),Oe.vec4=Oe.vec3=Oe.vec2=Oe.quat2=Oe.quat=Oe.mat4=Oe.mat3=Oe.mat2d=Oe.mat2=Oe.glMatrix=void 0;var Re=x(s());Oe.glMatrix=Re;var Le=x(l());Oe.mat2=Le;var Ue=x(h());Oe.mat2d=Ue;var qe=x(d());Oe.mat3=qe;var Ct=x(g());Oe.mat4=Ct;var Ot=x(I());Oe.quat=Ot;var Jt=x(k());Oe.quat2=Jt;var Hr=x(V());Oe.vec2=Hr;var Jr=x(w());Oe.vec3=Jr;var Ln=x(S());function y(Re){if("function"!=typeof WeakMap)return null;var Le=new WeakMap,Oe=new WeakMap;return(y=function(Re){return Re?Oe:Le})(Re)}function x(Re,Le){if(Re&&Re.__esModule)return Re;if(null===Re||"object"!==t(Re)&&"function"!=typeof Re)return{default:Re};var Oe=y(Le);if(Oe&&Oe.has(Re))return Oe.get(Re);var Ue={},qe=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Ct in Re)if("default"!==Ct&&Object.prototype.hasOwnProperty.call(Re,Ct)){var Ot=qe?Object.getOwnPropertyDescriptor(Re,Ct):null;Ot&&(Ot.get||Ot.set)?Object.defineProperty(Ue,Ct,Ot):Ue[Ct]=Re[Ct]}return Ue.default=Re,Oe&&Oe.set(Re,Ue),Ue}return Oe.vec4=Ln,Oe}var lo,uo,po,fo,Io=C(),is=function(){if(uo)return lo;function t(Re,Le,Oe,Ue){this.cx=3*Re,this.bx=3*(Oe-Re)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*Le,this.by=3*(Ue-Le)-this.cy,this.ay=1-this.cy-this.by,this.p1x=Re,this.p1y=Le,this.p2x=Oe,this.p2y=Ue}return uo=1,lo=t,t.prototype={sampleCurveX:function(Re){return((this.ax*Re+this.bx)*Re+this.cx)*Re},sampleCurveY:function(Re){return((this.ay*Re+this.by)*Re+this.cy)*Re},sampleCurveDerivativeX:function(Re){return(3*this.ax*Re+2*this.bx)*Re+this.cx},solveCurveX:function(Re,Le){if(void 0===Le&&(Le=1e-6),Re<0)return 0;if(Re>1)return 1;for(var Oe=Re,Ue=0;Ue<8;Ue++){var qe=this.sampleCurveX(Oe)-Re;if(Math.abs(qe)<Le)return Oe;var Ct=this.sampleCurveDerivativeX(Oe);if(Math.abs(Ct)<1e-6)break;Oe-=qe/Ct}var Ot=0,Jt=1;for(Oe=Re,Ue=0;Ue<20&&(qe=this.sampleCurveX(Oe),!(Math.abs(qe-Re)<Le));Ue++)Re>qe?Ot=Oe:Jt=Oe,Oe=.5*(Jt-Ot)+Ot;return Oe},solve:function(Re,Le){return this.sampleCurveY(this.solveCurveX(Re,Le))}},lo}(),as=e(is);function N(){if(fo)return po;function t(Re,Le){this.x=Re,this.y=Le}return fo=1,po=t,t.prototype={clone:function(){return new t(this.x,this.y)},add:function(Re){return this.clone()._add(Re)},sub:function(Re){return this.clone()._sub(Re)},multByPoint:function(Re){return this.clone()._multByPoint(Re)},divByPoint:function(Re){return this.clone()._divByPoint(Re)},mult:function(Re){return this.clone()._mult(Re)},div:function(Re){return this.clone()._div(Re)},rotate:function(Re){return this.clone()._rotate(Re)},rotateAround:function(Re,Le){return this.clone()._rotateAround(Re,Le)},matMult:function(Re){return this.clone()._matMult(Re)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(Re){return this.x===Re.x&&this.y===Re.y},dist:function(Re){return Math.sqrt(this.distSqr(Re))},distSqr:function(Re){var Le=Re.x-this.x,Oe=Re.y-this.y;return Le*Le+Oe*Oe},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(Re){return Math.atan2(this.y-Re.y,this.x-Re.x)},angleWith:function(Re){return this.angleWithSep(Re.x,Re.y)},angleWithSep:function(Re,Le){return Math.atan2(this.x*Le-this.y*Re,this.x*Re+this.y*Le)},_matMult:function(Re){var Le=Re[2]*this.x+Re[3]*this.y;return this.x=Re[0]*this.x+Re[1]*this.y,this.y=Le,this},_add:function(Re){return this.x+=Re.x,this.y+=Re.y,this},_sub:function(Re){return this.x-=Re.x,this.y-=Re.y,this},_mult:function(Re){return this.x*=Re,this.y*=Re,this},_div:function(Re){return this.x/=Re,this.y/=Re,this},_multByPoint:function(Re){return this.x*=Re.x,this.y*=Re.y,this},_divByPoint:function(Re){return this.x/=Re.x,this.y/=Re.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var Re=this.y;return this.y=this.x,this.x=-Re,this},_rotate:function(Re){var Le=Math.cos(Re),Oe=Math.sin(Re),Ue=Oe*this.x+Le*this.y;return this.x=Le*this.x-Oe*this.y,this.y=Ue,this},_rotateAround:function(Re,Le){var Oe=Math.cos(Re),Ue=Math.sin(Re),qe=Le.y+Ue*(this.x-Le.x)+Oe*(this.y-Le.y);return this.x=Le.x+Oe*(this.x-Le.x)-Ue*(this.y-Le.y),this.y=qe,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},t.convert=function(Re){return Re instanceof t?Re:Array.isArray(Re)?new t(Re[0],Re[1]):Re},po}var Is=e(N());function $(Re,Le){if(Array.isArray(Re)){if(!Array.isArray(Le)||Re.length!==Le.length)return!1;for(let Oe=0;Oe<Re.length;Oe++)if(!$(Re[Oe],Le[Oe]))return!1;return!0}if("object"==typeof Re&&null!==Re&&null!==Le){if("object"!=typeof Le)return!1;if(Object.keys(Re).length!==Object.keys(Le).length)return!1;for(const Oe in Re)if(!$(Re[Oe],Le[Oe]))return!1;return!0}return Re===Le}const Xs=Math.PI/180,ta=180/Math.PI;function Y(Re){return Re*Xs}function Z(Re){return Re*ta}const ha=[[0,0],[1,0],[1,1],[0,1]];function H(Re){if(Re<=0)return 0;if(Re>=1)return 1;const Le=Re*Re,Oe=Le*Re;return 4*(Re<.5?Oe:3*(Re-Le)+Oe-.75)}function K(Re,Le,Oe,Ue){const qe=new as(Re,Le,Oe,Ue);return function(Re){return qe.solve(Re)}}const el=K(.25,.1,.25,1);function Q(Re,Le,Oe){return Math.min(Oe,Math.max(Le,Re))}function tt(Re,Le,Oe){return(Oe=Q((Oe-Re)/(Le-Re),0,1))*Oe*(3-2*Oe)}function et(Re,Le,Oe){const Ue=Oe-Le,qe=((Re-Le)%Ue+Ue)%Ue+Le;return qe===Le?Oe:qe}function rt(Re,Le,Oe){if(!Re.length)return Oe(null,[]);let Ue=Re.length;const qe=new Array(Re.length);let Ct=null;Re.forEach(((Re,Ot)=>{Le(Re,((Re,Le)=>{Re&&(Ct=Re),qe[Ot]=Le,0==--Ue&&Oe(Ct,qe)}))}))}function nt(Re,...Le){for(const Oe of Le)for(const Le in Oe)Re[Le]=Oe[Le];return Re}let tl=1;function st(){return tl++}function at(Re){return Re<=1?1:Math.pow(2,Math.ceil(Math.log(Re)/Math.LN2))}function ot(Re,Le){Re.forEach((Re=>{Le[Re]&&(Le[Re]=Le[Re].bind(Le))}))}function lt(Re,Le){return-1!==Re.indexOf(Le,Re.length-Le.length)}function ut(Re,Le,Oe){const Ue={};for(const Oe in Re)Ue[Oe]=Le.call(this,Re[Oe],Oe,Re);return Ue}function ct(Re,Le,Oe){const Ue={};for(const Oe in Re)Le.call(this,Re[Oe],Oe,Re)&&(Ue[Oe]=Re[Oe]);return Ue}function ht(Re){return Array.isArray(Re)?Re.map(ht):"object"==typeof Re&&Re?ut(Re,ht):Re}const il={};function ft(Re){il[Re]||("undefined"!=typeof console&&console.warn(Re),il[Re]=!0)}function dt(Re,Le,Oe){return(Oe.y-Re.y)*(Le.x-Re.x)>(Le.y-Re.y)*(Oe.x-Re.x)}function mt(Re){let Le=0;for(let Oe,Ue,qe=0,Ct=Re.length,Ot=Ct-1;qe<Ct;Ot=qe++)Oe=Re[qe],Ue=Re[Ot],Le+=(Ue.x-Oe.x)*(Oe.y+Ue.y);return Le}function yt([Re,Le,Oe]){const Ue=Y(Le+90),qe=Y(Oe);return{x:Re*Math.cos(Ue)*Math.sin(qe),y:Re*Math.sin(Ue)*Math.sin(qe),z:Re*Math.cos(qe),azimuthal:Le,polar:Oe}}function gt(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function xt(Re){const Le={};if(Re.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((Re,Oe,Ue,qe)=>{const Ct=Ue||qe;return Le[Oe]=!Ct||Ct.toLowerCase(),""})),Le["max-age"]){const Re=parseInt(Le["max-age"],10);isNaN(Re)?delete Le["max-age"]:Le["max-age"]=Re}return Le}let sl,fl=null;function wt(Re,Le){return[Re[4*Le],Re[4*Le+1],Re[4*Le+2],Re[4*Le+3]]}function _t(Re,Le,Oe,Ue){for(;Le<Oe;){const qe=Le+Oe>>1;Re[qe]<Ue?Le=qe+1:Oe=qe}return Le}function Mt(Re,Le,Oe,Ue){for(;Le<Oe;){const qe=Le+Oe>>1;Re[qe]<=Ue?Le=qe+1:Oe=qe}return Le}function At(Re){return Re>0?1/(1.001-Re):1+Re}function St(Re){return Re>0?1-1/(1.001-Re):-Re}const Al={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==sl){const Re=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{sl=null!=process.env.API_URL_REGEX?new RegExp(process.env.API_URL_REGEX):Re}catch(Le){sl=Re}}return sl},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!Al.API_URL)return null;try{const Re=new URL(Al.API_URL);return"api.mapbox.cn"===Re.hostname?"https://events.mapbox.cn/events/v2":"api.mapbox.com"===Re.hostname?"https://events.mapbox.com/events/v2":null}catch(Re){return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function Pt(Re){return Al.API_URL_REGEX.test(Re)}function zt(Re){return Al.API_SPRITE_REGEX.test(Re)}let Ml,Hl,Wl,Kl,Jl,Ql;function Rt(){return null==Ml&&(Ml=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof self.createImageBitmap),Ml}const oc={now:()=>void 0!==Kl?Kl:performance.now(),setNow(Re){Kl=Re},restoreNow(){Kl=void 0},frame(Re){const Le=requestAnimationFrame(Re);return{cancel:()=>cancelAnimationFrame(Le)}},getImageData(Re,Le=0){const{width:Oe,height:Ue}=Re;Jl||(Jl=document.createElement("canvas"));const qe=Jl.getContext("2d",{willReadFrequently:!0});if(!qe)throw new Error("failed to create canvas 2d context");return(Oe>Jl.width||Ue>Jl.height)&&(Jl.width=Oe,Jl.height=Ue),qe.clearRect(-Le,-Le,Oe+2*Le,Ue+2*Le),qe.drawImage(Re,0,0,Oe,Ue),qe.getImageData(-Le,-Le,Oe+2*Le,Ue+2*Le)},resolveURL:Re=>(Hl||(Hl=document.createElement("a")),Hl.href=Re,Hl.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(null==Wl&&(Wl=window.matchMedia("(prefers-reduced-motion: reduce)")),Wl.matches)},hasCanvasFingerprintNoise(){if(void 0!==Ql)return Ql;if(!Rt())return Ql=!1,!1;const Re=new OffscreenCanvas(85,1),Le=Re.getContext("2d",{willReadFrequently:!0});let Oe=0;for(let Ue=0;Ue<Re.width;++Ue)Le.fillStyle=`rgba(${Oe++},${Oe++},${Oe++}, 255)`,Le.fillRect(Ue,0,1,1);const Ue=Le.getImageData(0,0,Re.width,Re.height);Oe=0;for(let Re=0;Re<Ue.data.length;++Re)if(Re%4!=3&&Oe++!==Ue.data[Re])return Ql=!0,!0;return Ql=!1,!1}};function Lt(Re,Le){const Oe=Re.indexOf("?");if(Oe<0)return`${Re}?${new URLSearchParams(Le).toString()}`;const Ue=new URLSearchParams(Re.slice(Oe));for(const Re in Le)Ue.set(Re,Le[Re]);return`${Re.slice(0,Oe)}?${Ue.toString()}`}function Ft(Re,Le={persistentParams:[]}){const Oe=Re.indexOf("?");if(Oe<0)return Re;const Ue=new URLSearchParams,qe=new URLSearchParams(Re.slice(Oe));for(const Re of Le.persistentParams){const Le=qe.get(Re);Le&&Ue.set(Re,Le)}const Ct=Ue.toString();return`${Re.slice(0,Oe)}${Ct.length>0?`?${Ct}`:""}`}const lc="mapbox-tiles";let Oc=500,Nc=50;const jc=["language","worldview","jobid"];let Uc,Hc;function Gt(){try{return caches}catch(Re){}}function Xt(){const Re=Gt();Re&&null==Uc&&(Uc=Re.open(lc))}let Wc=1/0;const Zc={supported:!1,testSupport:function(Re){!Kc&&Yc&&(Jc?te(Re):Xc=Re)}};let Xc,Yc,Kc=!1,Jc=!1;const Qc="undefined"!=typeof self?self:{};function te(Re){const Le=Re.createTexture();Re.bindTexture(Re.TEXTURE_2D,Le);try{if(Re.texImage2D(Re.TEXTURE_2D,0,Re.RGBA,Re.RGBA,Re.UNSIGNED_BYTE,Yc),Re.isContextLost())return;Zc.supported=!0}catch(Re){}Re.deleteTexture(Le),Kc=!0}Qc.document&&(Yc=Qc.document.createElement("img"),Yc.onload=function(){Xc&&te(Xc),Xc=null,Jc=!0},Yc.onerror=function(){Kc=!0,Xc=null},Yc.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const iu={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image",Model:"Model"};"function"==typeof Object.freeze&&Object.freeze(iu);class re extends Error{constructor(Re,Le,Oe){401===Le&&Pt(Oe)&&(Re+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(Re),this.status=Le,this.url=Oe}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const ou=gt()?()=>self.worker&&self.worker.referrer:()=>("blob:"===location.protocol?parent:self).location.href,ie=function(Re,Le){if(!(/^file:/.test(Oe=Re.url)||/^file:/.test(ou())&&!/^\w+:/.test(Oe))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(Re,Le){const Oe=new AbortController,Ue=new Request(Re.url,{method:Re.method||"GET",body:Re.body,credentials:Re.credentials,headers:Re.headers,referrer:ou(),referrerPolicy:Re.referrerPolicy,signal:Oe.signal});let qe=!1,Ct=!1;const Ot=(Jt=Ue.url).indexOf("sku=")>0&&Pt(Jt);var Jt;"json"===Re.type&&Ue.headers.set("Accept","application/json");const l=(Oe,qe,Jt)=>{if(Ct)return;if(Oe&&"SecurityError"!==Oe.message&&ft(Oe.toString()),qe&&Jt)return u(qe);const Hr=Date.now();fetch(Ue).then((Oe=>{if(Oe.ok){const Re=Ot?Oe.clone():null;return u(Oe,Re,Hr)}return Le(new re(Oe.statusText,Oe.status,Re.url))})).catch((Oe=>{"AbortError"!==Oe.name&&Le(new Error(`${Oe.message} ${Re.url}`))}))},u=(Oe,Ot,Jt)=>{("arrayBuffer"===Re.type?Oe.arrayBuffer():"json"===Re.type?Oe.json():Oe.text()).then((Re=>{Ct||(Ot&&Jt&&function(Re,Le,Oe){if(Xt(),null==Uc)return;const Ue=xt(Le.headers.get("Cache-Control")||"");if(Ue["no-store"])return;const qe={status:Le.status,statusText:Le.statusText,headers:new Headers};Le.headers.forEach(((Re,Le)=>qe.headers.set(Le,Re))),Ue["max-age"]&&qe.headers.set("Expires",new Date(Oe+1e3*Ue["max-age"]).toUTCString());const Ct=qe.headers.get("Expires");if(!Ct)return;if(new Date(Ct).getTime()-Oe<42e4)return;let Ot=Ft(Re.url,{persistentParams:jc});if(206===Le.status){const Le=Re.headers.get("Range");if(!Le)return;qe.status=200,Ot=Lt(Ot,{range:Le})}!function(Re,Le){if(void 0===Hc)try{new Response(new ReadableStream),Hc=!0}catch(Re){Hc=!1}Hc?Le(Re.body):Re.blob().then(Le)}(Le,(Re=>{const Oe=new Response(200!==(Ue=Le.status)&&404!==Ue&&[101,103,204,205,304].includes(Ue)?null:Re,qe);var Ue;Xt(),null!=Uc&&Uc.then((Re=>Re.put(Ot,Oe))).catch((Re=>ft(Re.message)))}))}(Ue,Ot,Jt),qe=!0,Le(null,Re,Oe.headers.get("Cache-Control"),Oe.headers.get("Expires")))})).catch((Re=>{Ct||Le(new Error(Re.message))}))};return Ot?function(Re,Le){if(Xt(),null==Uc)return Le(null);Uc.then((Oe=>{let Ue=Ft(Re.url,{persistentParams:jc});const qe=Re.headers.get("Range");qe&&(Ue=Lt(Ue,{range:qe})),Oe.match(Ue).then((Re=>{const qe=function(Re){if(!Re)return!1;const Le=new Date(Re.headers.get("Expires")||0),Oe=xt(Re.headers.get("Cache-Control")||"");return Le>Date.now()&&!Oe["no-cache"]}(Re);Oe.delete(Ue),qe&&Oe.put(Ue,Re.clone()),Le(null,Re,qe)})).catch(Le)})).catch(Le)}(Ue,l):l(null,null),{cancel:()=>{Ct=!0,qe||Oe.abort()}}}(Re,Le);if(gt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",Re,Le,void 0,!0)}var Oe;return function(Re,Le){const Oe=new XMLHttpRequest;Oe.open(Re.method||"GET",Re.url,!0),"arrayBuffer"===Re.type&&(Oe.responseType="arraybuffer");for(const Le in Re.headers)Oe.setRequestHeader(Le,Re.headers[Le]);return"json"===Re.type&&(Oe.responseType="text",Oe.setRequestHeader("Accept","application/json")),Oe.withCredentials="include"===Re.credentials,Oe.onerror=()=>{Le(new Error(Oe.statusText))},Oe.onload=()=>{if((Oe.status>=200&&Oe.status<300||0===Oe.status)&&null!==Oe.response){let Ue=Oe.response;if("json"===Re.type)try{Ue=JSON.parse(Oe.response)}catch(Re){return Le(Re)}Le(null,Ue,Oe.getResponseHeader("Cache-Control"),Oe.getResponseHeader("Expires"))}else Le(new re(Oe.statusText,Oe.status,Re.url))},Oe.send(Re.body),{cancel:()=>Oe.abort()}}(Re,Le)},se=function(Re,Le){return ie(nt(Re,{type:"arrayBuffer"}),Le)};function ae(Re){const Le=document.createElement("a");return Le.href=Re,Le.protocol===location.protocol&&Le.host===location.host}const su="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let au,lu;au=[],lu=0;const ce=function(Re,Le){if(Zc.supported&&(Re.headers||(Re.headers={}),Re.headers.accept="image/webp,*/*"),lu>=Al.MAX_PARALLEL_IMAGE_REQUESTS){const Oe={requestParameters:Re,callback:Le,cancelled:!1,cancel(){this.cancelled=!0}};return au.push(Oe),Oe}lu++;let Oe=!1;const n=()=>{if(!Oe)for(Oe=!0,lu--;au.length&&lu<Al.MAX_PARALLEL_IMAGE_REQUESTS;){const Re=au.shift(),{requestParameters:Le,callback:Oe,cancelled:Ue}=Re;Ue||(Re.cancel=ce(Le,Oe).cancel)}},Ue=se(Re,((Re,Oe,Ue,qe)=>{n(),Re?Le(Re):Oe&&(self.createImageBitmap?function(Re,Le){const Oe=new Blob([new Uint8Array(Re)],{type:"image/png"});createImageBitmap(Oe).then((Re=>{Le(null,Re)})).catch((Re=>{Le(new Error(`Could not load image because of ${Re.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))}))}(Oe,((Re,Oe)=>Le(Re,Oe,Ue,qe))):function(Re,Le){const Oe=new Image;Oe.onload=()=>{Le(null,Oe),URL.revokeObjectURL(Oe.src),Oe.onload=null,requestAnimationFrame((()=>{Oe.src=su}))},Oe.onerror=()=>Le(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const Ue=new Blob([new Uint8Array(Re)],{type:"image/png"});Oe.src=Re.byteLength?URL.createObjectURL(Ue):su}(Oe,((Re,Oe)=>Le(Re,Oe,Ue,qe))))}));return{cancel:()=>{Ue.cancel(),n()}}};var xu,Tu,Ou,Nu={exports:{}},ju={exports:{}},Uu={exports:{}},Hu=function(){if(Ou)return Nu.exports;Ou=1;var Re=(xu||(xu=1,ju.exports=function(Re,Le){var Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr;for(Ue=Re.length-(Oe=3&Re.length),qe=Le,Ot=3432918353,Jt=461845907,Jr=0;Jr<Ue;)Hr=255&Re.charCodeAt(Jr)|(255&Re.charCodeAt(++Jr))<<8|(255&Re.charCodeAt(++Jr))<<16|(255&Re.charCodeAt(++Jr))<<24,++Jr,qe=27492+(65535&(Ct=5*(65535&(qe=(qe^=Hr=(65535&(Hr=(Hr=(65535&Hr)*Ot+(((Hr>>>16)*Ot&65535)<<16)&4294967295)<<15|Hr>>>17))*Jt+(((Hr>>>16)*Jt&65535)<<16)&4294967295)<<13|qe>>>19))+((5*(qe>>>16)&65535)<<16)&4294967295))+((58964+(Ct>>>16)&65535)<<16);switch(Hr=0,Oe){case 3:Hr^=(255&Re.charCodeAt(Jr+2))<<16;case 2:Hr^=(255&Re.charCodeAt(Jr+1))<<8;case 1:qe^=Hr=(65535&(Hr=(Hr=(65535&(Hr^=255&Re.charCodeAt(Jr)))*Ot+(((Hr>>>16)*Ot&65535)<<16)&4294967295)<<15|Hr>>>17))*Jt+(((Hr>>>16)*Jt&65535)<<16)&4294967295}return qe^=Re.length,qe=2246822507*(65535&(qe^=qe>>>16))+((2246822507*(qe>>>16)&65535)<<16)&4294967295,qe=3266489909*(65535&(qe^=qe>>>13))+((3266489909*(qe>>>16)&65535)<<16)&4294967295,(qe^=qe>>>16)>>>0}),ju.exports),Le=(Tu||(Tu=1,Uu.exports=function(Re,Le){for(var Oe,Ue=Re.length,qe=Le^Ue,Ct=0;Ue>=4;)Oe=1540483477*(65535&(Oe=255&Re.charCodeAt(Ct)|(255&Re.charCodeAt(++Ct))<<8|(255&Re.charCodeAt(++Ct))<<16|(255&Re.charCodeAt(++Ct))<<24))+((1540483477*(Oe>>>16)&65535)<<16),qe=1540483477*(65535&qe)+((1540483477*(qe>>>16)&65535)<<16)^(Oe=1540483477*(65535&(Oe^=Oe>>>24))+((1540483477*(Oe>>>16)&65535)<<16)),Ue-=4,++Ct;switch(Ue){case 3:qe^=(255&Re.charCodeAt(Ct+2))<<16;case 2:qe^=(255&Re.charCodeAt(Ct+1))<<8;case 1:qe=1540483477*(65535&(qe^=255&Re.charCodeAt(Ct)))+((1540483477*(qe>>>16)&65535)<<16)}return qe=1540483477*(65535&(qe^=qe>>>13))+((1540483477*(qe>>>16)&65535)<<16),(qe^=qe>>>15)>>>0}),Uu.exports);return Nu.exports=Re,Nu.exports.murmur3=Re,Nu.exports.murmur2=Le,Nu.exports}(),Xu=e(Hu);class be{constructor(Re,...Le){nt(this,Le[0]||{}),this.type=Re}}class ve extends be{constructor(Re,Le={}){super("error",nt({error:Re},Le))}}function we(Re,Le,Oe){Oe[Re]&&-1!==Oe[Re].indexOf(Le)||(Oe[Re]=Oe[Re]||[],Oe[Re].push(Le))}function _e(Re,Le,Oe){if(Oe&&Oe[Re]){const Ue=Oe[Re].indexOf(Le);-1!==Ue&&Oe[Re].splice(Ue,1)}}class Me{on(Re,Le){return this._listeners=this._listeners||{},we(Re,Le,this._listeners),this}off(Re,Le){return _e(Re,Le,this._listeners),_e(Re,Le,this._oneTimeListeners),this}once(Re,Le){return Le?(this._oneTimeListeners=this._oneTimeListeners||{},we(Re,Le,this._oneTimeListeners),this):new Promise((Le=>this.once(Re,Le)))}fire(Re,Le){const Oe="string"==typeof Re?new be(Re,Le):Re,Ue=Oe.type;if(this.listens(Ue)){Oe.target=this;const Re=this._listeners&&this._listeners[Ue]?this._listeners[Ue].slice():[];for(const Le of Re)Le.call(this,Oe);const Le=this._oneTimeListeners&&this._oneTimeListeners[Ue]?this._oneTimeListeners[Ue].slice():[];for(const Re of Le)_e(Ue,Re,this._oneTimeListeners),Re.call(this,Oe);const qe=this._eventedParent;qe&&(nt(Oe,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),qe.fire(Oe))}else Oe instanceof ve&&console.error(Oe.error);return this}listens(Re){return!!(this._listeners&&this._listeners[Re]&&this._listeners[Re].length>0||this._oneTimeListeners&&this._oneTimeListeners[Re]&&this._oneTimeListeners[Re].length>0||this._eventedParent&&this._eventedParent.listens(Re))}setEventedParent(Re,Le){return this._eventedParent=Re,this._eventedParentData=Le,this}}var Yu,Ku={},Ju=function(){if(Yu)return Ku;Yu=1;var Re={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function e(Re){return(Re=Math.round(Re))<0?0:Re>255?255:Re}function r(Re){return e("%"===Re[Re.length-1]?parseFloat(Re)/100*255:parseInt(Re))}function n(Re){return(Le="%"===Re[Re.length-1]?parseFloat(Re)/100:parseFloat(Re))<0?0:Le>1?1:Le;var Le}function i(Re,Le,Oe){return Oe<0?Oe+=1:Oe>1&&(Oe-=1),6*Oe<1?Re+(Le-Re)*Oe*6:2*Oe<1?Le:3*Oe<2?Re+(Le-Re)*(2/3-Oe)*6:Re}try{Ku.parseCSSColor=function(Le){var Oe,Ue=Le.replace(/ /g,"").toLowerCase();if(Ue in Re)return Re[Ue].slice();if("#"===Ue[0])return 4===Ue.length?(Oe=parseInt(Ue.substr(1),16))>=0&&Oe<=4095?[(3840&Oe)>>4|(3840&Oe)>>8,240&Oe|(240&Oe)>>4,15&Oe|(15&Oe)<<4,1]:null:7===Ue.length&&(Oe=parseInt(Ue.substr(1),16))>=0&&Oe<=16777215?[(16711680&Oe)>>16,(65280&Oe)>>8,255&Oe,1]:null;var qe=Ue.indexOf("("),Ct=Ue.indexOf(")");if(-1!==qe&&Ct+1===Ue.length){var Ot=Ue.substr(0,qe),Jt=Ue.substr(qe+1,Ct-(qe+1)).split(","),Hr=1;switch(Ot){case"rgba":if(4!==Jt.length)return null;Hr=n(Jt.pop());case"rgb":return 3!==Jt.length?null:[r(Jt[0]),r(Jt[1]),r(Jt[2]),Hr];case"hsla":if(4!==Jt.length)return null;Hr=n(Jt.pop());case"hsl":if(3!==Jt.length)return null;var Jr=(parseFloat(Jt[0])%360+360)%360/360,Ln=n(Jt[1]),Nn=n(Jt[2]),$n=Nn<=.5?Nn*(Ln+1):Nn+Ln-Nn*Ln,Gn=2*Nn-$n;return[e(255*i(Gn,$n,Jr+1/3)),e(255*i(Gn,$n,Jr)),e(255*i(Gn,$n,Jr-1/3)),Hr];default:return null}}return null}}catch(Re){}return Ku}();class Pe{constructor(Re,Le,Oe,Ue=1){this.r=Re,this.g=Le,this.b=Oe,this.a=Ue}static parse(Re){if(!Re)return;if(Re instanceof Pe)return Re;if("string"!=typeof Re)return;const Le=Ju.parseCSSColor(Re);return Le?new Pe(Le[0]/255*Le[3],Le[1]/255*Le[3],Le[2]/255*Le[3],Le[3]):void 0}toString(){const[Re,Le,Oe,Ue]=0===this.a?[0,0,0,0]:[255*this.r/this.a,255*this.g/this.a,255*this.b/this.a,this.a];return`rgba(${Math.round(Re)},${Math.round(Le)},${Math.round(Oe)},${Ue})`}toRenderColor(Re){const{r:Le,g:Oe,b:Ue,a:qe}=this;return new ze(Re,Le,Oe,Ue,qe)}}class ze{constructor(Re,Le,Oe,Ue,qe){if(Re){const Ct=Re.image.height,Ot=Ct*Ct;Le=0===qe?0:Le/qe*(Ct-1),Oe=0===qe?0:Oe/qe*(Ct-1),Ue=0===qe?0:Ue/qe*(Ct-1);const Jt=Math.floor(Le),Hr=Math.floor(Oe),Jr=Math.floor(Ue),Ln=Math.ceil(Le),Nn=Math.ceil(Oe),$n=Math.ceil(Ue),Gn=Le-Jt,qn=Oe-Hr,Zn=Ue-Jr,Xn=Re.image.data,Yn=4*(Jt+Hr*Ot+Jr*Ct),_i=4*(Jt+Hr*Ot+$n*Ct),vi=4*(Jt+Nn*Ot+Jr*Ct),xi=4*(Jt+Nn*Ot+$n*Ct),bi=4*(Ln+Hr*Ot+Jr*Ct),Pi=4*(Ln+Hr*Ot+$n*Ct),lo=4*(Ln+Nn*Ot+Jr*Ct),uo=4*(Ln+Nn*Ot+$n*Ct);if(Yn<0||uo>=Xn.length)throw new Error("out of range");this.r=ke(ke(ke(Xn[Yn],Xn[_i],Zn),ke(Xn[vi],Xn[xi],Zn),qn),ke(ke(Xn[bi],Xn[Pi],Zn),ke(Xn[lo],Xn[uo],Zn),qn),Gn)/255*qe,this.g=ke(ke(ke(Xn[Yn+1],Xn[_i+1],Zn),ke(Xn[vi+1],Xn[xi+1],Zn),qn),ke(ke(Xn[bi+1],Xn[Pi+1],Zn),ke(Xn[lo+1],Xn[uo+1],Zn),qn),Gn)/255*qe,this.b=ke(ke(ke(Xn[Yn+2],Xn[_i+2],Zn),ke(Xn[vi+2],Xn[xi+2],Zn),qn),ke(ke(Xn[bi+2],Xn[Pi+2],Zn),ke(Xn[lo+2],Xn[uo+2],Zn),qn),Gn)/255*qe,this.a=qe}else this.r=Le,this.g=Oe,this.b=Ue,this.a=qe}toArray(){const{r:Re,g:Le,b:Oe,a:Ue}=this;return 0===Ue?[0,0,0,0]:[255*Re/Ue,255*Le/Ue,255*Oe/Ue,Ue]}toArray01(){const{r:Re,g:Le,b:Oe,a:Ue}=this;return 0===Ue?[0,0,0,0]:[Re/Ue,Le/Ue,Oe/Ue,Ue]}toArray01Scaled(Re){const{r:Le,g:Oe,b:Ue,a:qe}=this;return 0===qe?[0,0,0]:[Le/qe*Re,Oe/qe*Re,Ue/qe*Re]}toArray01PremultipliedAlpha(){const{r:Re,g:Le,b:Oe,a:Ue}=this;return[Re,Le,Oe,Ue]}toArray01Linear(){const{r:Re,g:Le,b:Oe,a:Ue}=this;return 0===Ue?[0,0,0,0]:[Math.pow(Re/Ue,2.2),Math.pow(Le/Ue,2.2),Math.pow(Oe/Ue,2.2),Ue]}}function ke(Re,Le,Oe){return Re*(1-Oe)+Le*Oe}function Te(Re,Le,Oe){return Re.map(((Re,Ue)=>ke(Re,Le[Ue],Oe)))}Pe.black=new Pe(0,0,0,1),Pe.white=new Pe(1,1,1,1),Pe.transparent=new Pe(0,0,0,0),Pe.red=new Pe(1,0,0,1),Pe.blue=new Pe(0,0,1,1);var Qu=Object.freeze({__proto__:null,array:Te,color:function(Re,Le,Oe){return new Pe(ke(Re.r,Le.r,Oe),ke(Re.g,Le.g,Oe),ke(Re.b,Le.b,Oe),ke(Re.a,Le.a,Oe))},number:ke});function Be(Re,...Le){for(const Oe of Le)for(const Le in Oe)Re[Le]=Oe[Le];return Re}class Ve extends Error{constructor(Re,Le){super(Le),this.message=Le,this.key=Re}}class Ce{constructor(Re,Le=[]){this.parent=Re,this.bindings={};for(const[Re,Oe]of Le)this.bindings[Re]=Oe}concat(Re){return new Ce(this,Re)}get(Re){if(this.bindings[Re])return this.bindings[Re];if(this.parent)return this.parent.get(Re);throw new Error(`${Re} not found in scope.`)}has(Re){return!!this.bindings[Re]||!!this.parent&&this.parent.has(Re)}}const eh={kind:"null"},th={kind:"number"},rh={kind:"string"},nh={kind:"boolean"},ih={kind:"color"},sh={kind:"object"},ah={kind:"value"},ch={kind:"collator"},yh={kind:"formatted"},Th={kind:"resolvedImage"};function Ge(Re,Le){return{kind:"array",itemType:Re,N:Le}}function Xe(Re){if("array"===Re.kind){const Le=Xe(Re.itemType);return"number"==typeof Re.N?`array<${Le}, ${Re.N}>`:"value"===Re.itemType.kind?"array":`array<${Le}>`}return Re.kind}const Eh=[eh,th,rh,nh,ih,yh,sh,Ge(ah),Th];function Ze(Re,Le){if("error"===Le.kind)return null;if("array"===Re.kind){if("array"===Le.kind&&(0===Le.N&&"value"===Le.itemType.kind||!Ze(Re.itemType,Le.itemType))&&("number"!=typeof Re.N||Re.N===Le.N))return null}else{if(Re.kind===Le.kind)return null;if("value"===Re.kind)for(const Re of Eh)if(!Ze(Re,Le))return null}return`Expected ${Xe(Re)} but found ${Xe(Le)} instead.`}function We(Re,Le){return Le.some((Le=>Le.kind===Re.kind))}function He(Re,Le){return Le.some((Le=>"null"===Le?null===Re:"array"===Le?Array.isArray(Re):"object"===Le?Re&&!Array.isArray(Re)&&"object"==typeof Re:Le===typeof Re))}class Ke{constructor(Re,Le,Oe){this.sensitivity=Re?Le?"variant":"case":Le?"accent":"base",this.locale=Oe,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(Re,Le){return this.collator.compare(Re,Le)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Je{constructor(Re,Le,Oe,Ue,qe){this.text=Re.normalize?Re.normalize():Re,this.image=Le,this.scale=Oe,this.fontStack=Ue,this.textColor=qe}}class Qe{constructor(Re){this.sections=Re}static fromString(Re){return new Qe([new Je(Re,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some((Re=>0!==Re.text.length||Re.image&&0!==Re.image.namePrimary.length))}static factory(Re){return Re instanceof Qe?Re:Qe.fromString(Re)}toString(){return 0===this.sections.length?"":this.sections.map((Re=>Re.text)).join("")}serialize(){const Re=["format"];for(const Le of this.sections){if(Le.image){Re.push(["image",Le.image.namePrimary]);continue}Re.push(Le.text);const Oe={};Le.fontStack&&(Oe["text-font"]=["literal",Le.fontStack.split(",")]),Le.scale&&(Oe["font-scale"]=Le.scale),Le.textColor&&(Oe["text-color"]=["rgba"].concat(Le.textColor.toRenderColor(null).toArray())),Re.push(Oe)}return Re}}class tr{constructor(Re){this.namePrimary=Re.namePrimary,Re.nameSecondary&&(this.nameSecondary=Re.nameSecondary),this.available=Re.available}toString(){return this.nameSecondary?`[${this.namePrimary},${this.nameSecondary}]`:this.namePrimary}static fromString(Re,Le){return Re?new tr({namePrimary:Re,nameSecondary:Le,available:!1}):null}serialize(){return this.nameSecondary?["image",this.namePrimary,this.nameSecondary]:["image",this.namePrimary]}}function er(Re,Le,Oe,Ue){return"number"==typeof Re&&Re>=0&&Re<=255&&"number"==typeof Le&&Le>=0&&Le<=255&&"number"==typeof Oe&&Oe>=0&&Oe<=255?void 0===Ue||"number"==typeof Ue&&Ue>=0&&Ue<=1?null:`Invalid rgba value [${[Re,Le,Oe,Ue].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof Ue?[Re,Le,Oe,Ue]:[Re,Le,Oe]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function rr(Re){if(null===Re)return!0;if("string"==typeof Re)return!0;if("boolean"==typeof Re)return!0;if("number"==typeof Re)return!0;if(Re instanceof Pe)return!0;if(Re instanceof Ke)return!0;if(Re instanceof Qe)return!0;if(Re instanceof tr)return!0;if(Array.isArray(Re)){for(const Le of Re)if(!rr(Le))return!1;return!0}if("object"==typeof Re){for(const Le in Re)if(!rr(Re[Le]))return!1;return!0}return!1}function nr(Re){if(null===Re)return eh;if("string"==typeof Re)return rh;if("boolean"==typeof Re)return nh;if("number"==typeof Re)return th;if(Re instanceof Pe)return ih;if(Re instanceof Ke)return ch;if(Re instanceof Qe)return yh;if(Re instanceof tr)return Th;if(Array.isArray(Re)){const Le=Re.length;let Oe;for(const Le of Re){const Re=nr(Le);if(Oe){if(Oe===Re)continue;Oe=ah;break}Oe=Re}return Ge(Oe||ah,Le)}return sh}function ir(Re){const Le=typeof Re;return null===Re?"":"string"===Le||"number"===Le||"boolean"===Le?String(Re):Re instanceof Pe||Re instanceof Qe||Re instanceof tr?Re.toString():JSON.stringify(Re)}class sr{constructor(Re,Le){this.type=Re,this.value=Le}static parse(Re,Le){if(2!==Re.length)return Le.error(`'literal' expression requires exactly one argument, but found ${Re.length-1} instead.`);if(!rr(Re[1]))return Le.error("invalid value");const Oe=Re[1];let Ue=nr(Oe);const qe=Le.expectedType;return"array"!==Ue.kind||0!==Ue.N||!qe||"array"!==qe.kind||"number"==typeof qe.N&&0!==qe.N||(Ue=qe),new sr(Ue,Oe)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof Pe?["rgba"].concat(this.value.toRenderColor(null).toArray()):this.value instanceof Qe?this.value.serialize():this.value}}class ar{constructor(Re){this.name="ExpressionEvaluationError",this.message=Re}toJSON(){return this.message}}const Ch={string:rh,number:th,boolean:nh,object:sh};class lr{constructor(Re,Le){this.type=Re,this.args=Le}static parse(Re,Le){if(Re.length<2)return Le.error("Expected at least one argument.");let Oe,Ue=1;const qe=Re[0];if("array"===qe){let qe,Ct;if(Re.length>2){const Oe=Re[1];if("string"!=typeof Oe||!(Oe in Ch)||"object"===Oe)return Le.error('The item type argument of "array" must be one of string, number, boolean',1);qe=Ch[Oe],Ue++}else qe=ah;if(Re.length>3){if(null!==Re[2]&&("number"!=typeof Re[2]||Re[2]<0||Re[2]!==Math.floor(Re[2])))return Le.error('The length argument to "array" must be a positive integer literal',2);Ct=Re[2],Ue++}Oe=Ge(qe,Ct)}else Oe=Ch[qe];const Ct=[];for(;Ue<Re.length;Ue++){const Oe=Le.parse(Re[Ue],Ue,ah);if(!Oe)return null;Ct.push(Oe)}return new lr(Oe,Ct)}evaluate(Re){for(let Le=0;Le<this.args.length;Le++){const Oe=this.args[Le].evaluate(Re);if(!Ze(this.type,nr(Oe)))return Oe;if(Le===this.args.length-1)throw new ar(`The expression ${JSON.stringify(this.args[Le].serialize())} evaluated to ${Xe(nr(Oe))} but was expected to be of type ${Xe(this.type)}.`)}return null}eachChild(Re){this.args.forEach(Re)}outputDefined(){return this.args.every((Re=>Re.outputDefined()))}serialize(){const Re=this.type,Le=[Re.kind];if("array"===Re.kind){const Oe=Re.itemType;if("string"===Oe.kind||"number"===Oe.kind||"boolean"===Oe.kind){Le.push(Oe.kind);const Ue=Re.N;("number"==typeof Ue||this.args.length>1)&&Le.push(Ue)}}return Le.concat(this.args.map((Re=>Re.serialize())))}}class ur{constructor(Re){this.type=yh,this.sections=Re}static parse(Re,Le){if(Re.length<2)return Le.error("Expected at least one argument.");const Oe=Re[1];if(!Array.isArray(Oe)&&"object"==typeof Oe)return Le.error("First argument must be an image or text section.");const Ue=[];let qe=!1;for(let Oe=1;Oe<=Re.length-1;++Oe){const Ct=Re[Oe];if(qe&&"object"==typeof Ct&&!Array.isArray(Ct)){qe=!1;let Re=null;if(Ct["font-scale"]&&(Re=Le.parseObjectValue(Ct["font-scale"],Oe,"font-scale",th),!Re))return null;let Ot=null;if(Ct["text-font"]&&(Ot=Le.parseObjectValue(Ct["text-font"],Oe,"text-font",Ge(rh)),!Ot))return null;let Jt=null;if(Ct["text-color"]&&(Jt=Le.parseObjectValue(Ct["text-color"],Oe,"text-color",ih),!Jt))return null;const Hr=Ue[Ue.length-1];Hr.scale=Re,Hr.font=Ot,Hr.textColor=Jt}else{const Ct=Le.parse(Re[Oe],Oe,ah);if(!Ct)return null;const Ot=Ct.type.kind;if("string"!==Ot&&"value"!==Ot&&"null"!==Ot&&"resolvedImage"!==Ot)return Le.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");qe=!0,Ue.push({content:Ct,scale:null,font:null,textColor:null})}}return new ur(Ue)}evaluate(Re){return new Qe(this.sections.map((Le=>{const Oe=Le.content.evaluate(Re);return nr(Oe)===Th?new Je("",Oe,null,null,null):new Je(ir(Oe),null,Le.scale?Le.scale.evaluate(Re):null,Le.font?Le.font.evaluate(Re).join(","):null,Le.textColor?Le.textColor.evaluate(Re):null)})))}eachChild(Re){for(const Le of this.sections)Re(Le.content),Le.scale&&Re(Le.scale),Le.font&&Re(Le.font),Le.textColor&&Re(Le.textColor)}outputDefined(){return!1}serialize(){const Re=["format"];for(const Le of this.sections){Re.push(Le.content.serialize());const Oe={};Le.scale&&(Oe["font-scale"]=Le.scale.serialize()),Le.font&&(Oe["text-font"]=Le.font.serialize()),Le.textColor&&(Oe["text-color"]=Le.textColor.serialize()),Re.push(Oe)}return Re}}class cr{constructor(Re,Le){this.type=Th,this.inputPrimary=Re,this.inputSecondary=Le}static parse(Re,Le){if(Re.length<2)return Le.error("Expected two or more arguments.");const Oe=Le.parse(Re[1],1,rh);if(!Oe)return Le.error("No image name provided.");if(2===Re.length)return new cr(Oe);const Ue=Le.parse(Re[2],1,rh);return Ue?new cr(Oe,Ue):Le.error("Secondary image variant is not a string.")}evaluate(Re){const Le=tr.fromString(this.inputPrimary.evaluate(Re),this.inputSecondary?this.inputSecondary.evaluate(Re):void 0);return Le&&Re.availableImages&&(Le.available=Re.availableImages.indexOf(Le.namePrimary)>-1,Le.nameSecondary&&Le.available&&Re.availableImages&&(Le.available=Re.availableImages.indexOf(Le.nameSecondary)>-1)),Le}eachChild(Re){Re(this.inputPrimary),this.inputSecondary&&Re(this.inputSecondary)}outputDefined(){return!1}serialize(){return this.inputSecondary?["image",this.inputPrimary.serialize(),this.inputSecondary.serialize()]:["image",this.inputPrimary.serialize()]}}function hr(Re){return Re instanceof Number?"number":Re instanceof String?"string":Re instanceof Boolean?"boolean":Array.isArray(Re)?"array":null===Re?"null":typeof Re}const Rh={"to-boolean":nh,"to-color":ih,"to-number":th,"to-string":rh};class fr{constructor(Re,Le){this.type=Re,this.args=Le}static parse(Re,Le){if(Re.length<2)return Le.error("Expected at least one argument.");const Oe=Re[0],Ue=[];let qe=eh;if("to-array"===Oe){if(!Array.isArray(Re[1]))return null;const Oe=Re[1].length;if(Le.expectedType){if("array"!==Le.expectedType.kind)return Le.error(`Expected ${Le.expectedType.kind} but found array.`);qe=Ge(Le.expectedType.itemType,Oe)}else{if(!(Oe>0&&rr(Re[1][0])))return null;qe=Ge(nr(Re[1][0]),Oe)}for(let Ct=0;Ct<Oe;Ct++){const Oe=Re[1][Ct];let Ot;if("array"===hr(Oe))Ot=Le.parse(Oe,void 0,qe.itemType);else{const Re=hr(Oe);if(Re!==qe.itemType.kind)return Le.error(`Expected ${qe.itemType.kind} but found ${Re}.`);Ot=Le.registry.literal.parse(["literal",void 0===Oe?null:Oe],Le)}if(!Ot)return null;Ue.push(Ot)}}else{if(("to-boolean"===Oe||"to-string"===Oe)&&2!==Re.length)return Le.error("Expected one argument.");qe=Rh[Oe];for(let Oe=1;Oe<Re.length;Oe++){const qe=Le.parse(Re[Oe],Oe,ah);if(!qe)return null;Ue.push(qe)}}return new fr(qe,Ue)}evaluate(Re){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(Re));if("color"===this.type.kind){let Le,Oe;for(const Ue of this.args){if(Le=Ue.evaluate(Re),Oe=null,Le instanceof Pe)return Le;if("string"==typeof Le){const Oe=Re.parseColor(Le);if(Oe)return Oe}else if(Array.isArray(Le)&&(Oe=Le.length<3||Le.length>4?`Invalid rbga value ${JSON.stringify(Le)}: expected an array containing either three or four numeric values.`:er(Le[0],Le[1],Le[2],Le[3]),!Oe))return new Pe(Le[0]/255,Le[1]/255,Le[2]/255,Le[3])}throw new ar(Oe||`Could not parse color from value '${"string"==typeof Le?Le:String(JSON.stringify(Le))}'`)}if("number"===this.type.kind){let Le=null;for(const Oe of this.args){if(Le=Oe.evaluate(Re),null===Le)return 0;const Ue=Number(Le);if(!isNaN(Ue))return Ue}throw new ar(`Could not convert ${JSON.stringify(Le)} to number.`)}return"formatted"===this.type.kind?Qe.fromString(ir(this.args[0].evaluate(Re))):"resolvedImage"===this.type.kind?tr.fromString(ir(this.args[0].evaluate(Re))):"array"===this.type.kind?this.args.map((Le=>Le.evaluate(Re))):ir(this.args[0].evaluate(Re))}eachChild(Re){this.args.forEach(Re)}outputDefined(){return this.args.every((Re=>Re.outputDefined()))}serialize(){if("formatted"===this.type.kind)return new ur([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new cr(this.args[0]).serialize();const Re="array"===this.type.kind?[]:[`to-${this.type.kind}`];return this.eachChild((Le=>{Re.push(Le.serialize())})),Re}}const zh=["Unknown","Point","LineString","Polygon"];class mr{constructor(Re,Le){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=Re,this.options=Le}id(){return this.feature&&void 0!==this.feature.id?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?zh[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(Re){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const Re=this.featureDistanceData.center,Le=this.featureDistanceData.scale,{x:Oe,y:Ue}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(Oe*Le-Re[0])+this.featureDistanceData.bearing[1]*(Ue*Le-Re[1])}return 0}parseColor(Re){let Le=this._parseColorCache[Re];return Le||(Le=this._parseColorCache[Re]=Pe.parse(Re)),Le}getConfig(Re){return this.options?this.options.get(Re):null}}class yr{constructor(Re,Le,Oe,Ue,qe){this.name=Re,this.type=Le,this._evaluate=Oe,this.args=Ue,this._overloadIndex=qe}evaluate(Re){if(!this._evaluate){const Re=yr.definitions[this.name];this._evaluate=Array.isArray(Re)?Re[2]:Re.overloads[this._overloadIndex][1]}return this._evaluate(Re,this.args)}eachChild(Re){this.args.forEach(Re)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map((Re=>Re.serialize())))}static parse(Re,Le){const Oe=Re[0],Ue=yr.definitions[Oe];if(!Ue)return Le.error(`Unknown expression "${Oe}". If you wanted a literal array, use ["literal", [...]].`,0);const qe=Array.isArray(Ue)?Ue[0]:Ue.type,Ct=Array.isArray(Ue)?[[Ue[1],Ue[2]]]:Ue.overloads,Ot=[];let Jt=null,Hr=-1;for(const[Ue,Jr]of Ct){if(Array.isArray(Ue)&&Ue.length!==Re.length-1)continue;Ot.push(Ue),Hr++,Jt=new _d(Le.registry,Le.path,null,Le.scope,void 0,Le._scope,Le.options);const Ct=[];let Ln=!1;for(let Le=1;Le<Re.length;Le++){const Oe=Re[Le],qe=Array.isArray(Ue)?Ue[Le-1]:Ue.type,Ot=Jt.parse(Oe,1+Ct.length,qe);if(!Ot){Ln=!0;break}Ct.push(Ot)}if(!Ln)if(Array.isArray(Ue)&&Ue.length!==Ct.length)Jt.error(`Expected ${Ue.length} arguments, but found ${Ct.length} instead.`);else{for(let Re=0;Re<Ct.length;Re++){const Le=Array.isArray(Ue)?Ue[Re]:Ue.type,Oe=Ct[Re];Jt.concat(Re+1).checkSubtype(Le,Oe.type)}if(0===Jt.errors.length)return new yr(Oe,qe,Jr,Ct,Hr)}}if(1===Ot.length)Le.errors.push(...Jt.errors);else{const Oe=(Ot.length?Ot:Ct.map((([Re])=>Re))).map(gr).join(" | "),Ue=[];for(let Oe=1;Oe<Re.length;Oe++){const qe=Le.parse(Re[Oe],1+Ue.length);if(!qe)return null;Ue.push(Xe(qe.type))}Le.error(`Expected arguments of type ${Oe}, but found (${Ue.join(", ")}) instead.`)}return null}static register(Re,Le){yr.definitions=Le;for(const Oe in Le)Re[Oe]=yr}}function gr(Re){return Array.isArray(Re)?`(${Re.map(Xe).join(", ")})`:`(${Xe(Re.type)}...)`}class xr{constructor(Re,Le,Oe){this.type=ch,this.locale=Oe,this.caseSensitive=Re,this.diacriticSensitive=Le}static parse(Re,Le){if(2!==Re.length)return Le.error("Expected one argument.");const Oe=Re[1];if("object"!=typeof Oe||Array.isArray(Oe))return Le.error("Collator options argument must be an object.");const Ue=void 0===Oe["case-sensitive"]?Le.parse(!1,1,nh):Le.parseObjectValue(Oe["case-sensitive"],1,"case-sensitive",nh);if(!Ue)return null;const qe=void 0===Oe["diacritic-sensitive"]?Le.parse(!1,1,nh):Le.parseObjectValue(Oe["diacritic-sensitive"],1,"diacritic-sensitive",nh);if(!qe)return null;let Ct=null;return Oe.locale&&(Ct=Le.parseObjectValue(Oe.locale,1,"locale",rh),!Ct)?null:new xr(Ue,qe,Ct)}evaluate(Re){return new Ke(this.caseSensitive.evaluate(Re),this.diacriticSensitive.evaluate(Re),this.locale?this.locale.evaluate(Re):null)}eachChild(Re){Re(this.caseSensitive),Re(this.diacriticSensitive),this.locale&&Re(this.locale)}outputDefined(){return!1}serialize(){const Re={};return Re["case-sensitive"]=this.caseSensitive.serialize(),Re["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(Re.locale=this.locale.serialize()),["collator",Re]}}function br(Re,Le,Oe=0,Ue=Re.length-1,qe=wr){for(;Ue>Oe;){if(Ue-Oe>600){const Ct=Ue-Oe+1,Ot=Le-Oe+1,Jt=Math.log(Ct),Hr=.5*Math.exp(2*Jt/3),Jr=.5*Math.sqrt(Jt*Hr*(Ct-Hr)/Ct)*(Ot-Ct/2<0?-1:1);br(Re,Le,Math.max(Oe,Math.floor(Le-Ot*Hr/Ct+Jr)),Math.min(Ue,Math.floor(Le+(Ct-Ot)*Hr/Ct+Jr)),qe)}const Ct=Re[Le];let Ot=Oe,Jt=Ue;for(vr(Re,Oe,Le),qe(Re[Ue],Ct)>0&&vr(Re,Oe,Ue);Ot<Jt;){for(vr(Re,Ot,Jt),Ot++,Jt--;qe(Re[Ot],Ct)<0;)Ot++;for(;qe(Re[Jt],Ct)>0;)Jt--}0===qe(Re[Oe],Ct)?vr(Re,Oe,Jt):(Jt++,vr(Re,Jt,Ue)),Jt<=Le&&(Oe=Jt+1),Le<=Jt&&(Ue=Jt-1)}}function vr(Re,Le,Oe){const Ue=Re[Le];Re[Le]=Re[Oe],Re[Oe]=Ue}function wr(Re,Le){return Re<Le?-1:Re>Le?1:0}function _r(Re){let Le=0;for(let Oe,Ue,qe=0,Ct=Re.length,Ot=Ct-1;qe<Ct;Ot=qe++)Oe=Re[qe],Ue=Re[Ot],Le+=(Ue.x-Oe.x)*(Oe.y+Ue.y);return Le}function Mr(Re,Le){Re[0]=Math.min(Re[0],Le[0]),Re[1]=Math.min(Re[1],Le[1]),Re[2]=Math.max(Re[2],Le[0]),Re[3]=Math.max(Re[3],Le[1])}function Ar(Re,Le){return!(Re[0]<=Le[0]||Re[2]>=Le[2]||Re[1]<=Le[1]||Re[3]>=Le[3])}function Sr(Re,Le,Oe){const Ue=Re[0]-Le[0],qe=Re[1]-Le[1],Ct=Re[0]-Oe[0],Ot=Re[1]-Oe[1];return Ue*Ot-Ct*qe==0&&Ue*Ct<=0&&qe*Ot<=0}function Ir(Re,Le,Oe=!1){let Ue=!1;for(let Jt=0,Hr=Le.length;Jt<Hr;Jt++){const Hr=Le[Jt];for(let Le=0,Jt=Hr.length,Jr=Jt-1;Le<Jt;Jr=Le++){const Jt=Hr[Jr],Ln=Hr[Le];if(Sr(Re,Jt,Ln))return Oe;(Ct=Jt)[1]>(qe=Re)[1]!=(Ot=Ln)[1]>qe[1]&&qe[0]<(Ot[0]-Ct[0])*(qe[1]-Ct[1])/(Ot[1]-Ct[1])+Ct[0]&&(Ue=!Ue)}}var qe,Ct,Ot;return Ue}function Pr(Re,Le,Oe,Ue){const qe=Ue[0]-Oe[0],Ct=Ue[1]-Oe[1],Ot=(Re[0]-Oe[0])*Ct-qe*(Re[1]-Oe[1]),Jt=(Le[0]-Oe[0])*Ct-qe*(Le[1]-Oe[1]);return Ot>0&&Jt<0||Ot<0&&Jt>0}function zr(Re,Le,Oe,Ue){return 0!=(qe=[Ue[0]-Oe[0],Ue[1]-Oe[1]])[0]*(Ct=[Le[0]-Re[0],Le[1]-Re[1]])[1]-qe[1]*Ct[0]&&!(!Pr(Re,Le,Oe,Ue)||!Pr(Oe,Ue,Re,Le));var qe,Ct}const Dh=8192;function Tr(Re,Le){const Oe=(180+Re[0])/360,Ue=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+Re[1]*Math.PI/360)))/360,qe=Math.pow(2,Le.z);return[Math.round(Oe*qe*Dh),Math.round(Ue*qe*Dh)]}function Er(Re,Le){for(let Oe=0;Oe<Le.length;Oe++)if(Ir(Re,Le[Oe]))return!0;return!1}function Br(Re,Le,Oe){for(const Ue of Oe)for(let Oe=0,qe=Ue.length,Ct=qe-1;Oe<qe;Ct=Oe++)if(zr(Re,Le,Ue[Ct],Ue[Oe]))return!0;return!1}function Vr(Re,Le){for(let Oe=0;Oe<Re.length;++Oe)if(!Ir(Re[Oe],Le))return!1;for(let Oe=0;Oe<Re.length-1;++Oe)if(Br(Re[Oe],Re[Oe+1],Le))return!1;return!0}function Cr(Re,Le){for(let Oe=0;Oe<Le.length;Oe++)if(Vr(Re,Le[Oe]))return!0;return!1}function Rr(Re,Le,Oe){const Ue=[];for(let qe=0;qe<Re.length;qe++){const Ct=[];for(let Ue=0;Ue<Re[qe].length;Ue++){const Ot=Tr(Re[qe][Ue],Oe);Mr(Le,Ot),Ct.push(Ot)}Ue.push(Ct)}return Ue}function Dr(Re,Le,Oe){const Ue=[];for(let qe=0;qe<Re.length;qe++){const Ct=Rr(Re[qe],Le,Oe);Ue.push(Ct)}return Ue}function Lr(Re,Le,Oe,Ue){if(Re[0]<Oe[0]||Re[0]>Oe[2]){const Le=.5*Ue;let qe=Re[0]-Oe[0]>Le?-Ue:Oe[0]-Re[0]>Le?Ue:0;0===qe&&(qe=Re[0]-Oe[2]>Le?-Ue:Oe[2]-Re[0]>Le?Ue:0),Re[0]+=qe}Mr(Le,Re)}function Fr(Re,Le,Oe,Ue){const qe=Math.pow(2,Ue.z)*Dh,Ct=[Ue.x*Dh,Ue.y*Dh],Ot=[];if(!Re)return Ot;for(const Ue of Re)for(const Re of Ue){const Ue=[Re.x+Ct[0],Re.y+Ct[1]];Lr(Ue,Le,Oe,qe),Ot.push(Ue)}return Ot}function Or(Re,Le,Oe,Ue){const qe=Math.pow(2,Ue.z)*Dh,Ct=[Ue.x*Dh,Ue.y*Dh],Ot=[];if(!Re)return Ot;for(const Oe of Re){const Re=[];for(const Ue of Oe){const Oe=[Ue.x+Ct[0],Ue.y+Ct[1]];Mr(Le,Oe),Re.push(Oe)}Ot.push(Re)}if(Le[2]-Le[0]<=qe/2){(Jt=Le)[0]=Jt[1]=1/0,Jt[2]=Jt[3]=-1/0;for(const Re of Ot)for(const Ue of Re)Lr(Ue,Le,Oe,qe)}var Jt;return Ot}class Ur{constructor(Re,Le){this.type=nh,this.geojson=Re,this.geometries=Le}static parse(Re,Le){if(2!==Re.length)return Le.error(`'within' expression requires exactly one argument, but found ${Re.length-1} instead.`);if(rr(Re[1])){const Le=Re[1];if("FeatureCollection"===Le.type)for(let Re=0;Re<Le.features.length;++Re){const Oe=Le.features[Re].geometry.type;if("Polygon"===Oe||"MultiPolygon"===Oe)return new Ur(Le,Le.features[Re].geometry)}else if("Feature"===Le.type){const Re=Le.geometry.type;if("Polygon"===Re||"MultiPolygon"===Re)return new Ur(Le,Le.geometry)}else if("Polygon"===Le.type||"MultiPolygon"===Le.type)return new Ur(Le,Le)}return Le.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(Re){if(null!=Re.geometry()&&null!=Re.canonicalID()){if("Point"===Re.geometryType())return function(Re,Le){const Oe=[1/0,1/0,-1/0,-1/0],Ue=[1/0,1/0,-1/0,-1/0],qe=Re.canonicalID();if(!qe)return!1;if("Polygon"===Le.type){const Ct=Rr(Le.coordinates,Ue,qe),Ot=Fr(Re.geometry(),Oe,Ue,qe);if(!Ar(Oe,Ue))return!1;for(const Re of Ot)if(!Ir(Re,Ct))return!1}if("MultiPolygon"===Le.type){const Ct=Dr(Le.coordinates,Ue,qe),Ot=Fr(Re.geometry(),Oe,Ue,qe);if(!Ar(Oe,Ue))return!1;for(const Re of Ot)if(!Er(Re,Ct))return!1}return!0}(Re,this.geometries);if("LineString"===Re.geometryType())return function(Re,Le){const Oe=[1/0,1/0,-1/0,-1/0],Ue=[1/0,1/0,-1/0,-1/0],qe=Re.canonicalID();if(!qe)return!1;if("Polygon"===Le.type){const Ct=Rr(Le.coordinates,Ue,qe),Ot=Or(Re.geometry(),Oe,Ue,qe);if(!Ar(Oe,Ue))return!1;for(const Re of Ot)if(!Vr(Re,Ct))return!1}if("MultiPolygon"===Le.type){const Ct=Dr(Le.coordinates,Ue,qe),Ot=Or(Re.geometry(),Oe,Ue,qe);if(!Ar(Oe,Ue))return!1;for(const Re of Ot)if(!Cr(Re,Ct))return!1}return!0}(Re,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const Bh={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},Vh=1/298.257223563,Gh=Vh*(2-Vh),nd=Math.PI/180;class Gr{static fromTile(Re,Le,Oe){const Ue=Math.PI*(1-2*(Re+.5)/Math.pow(2,Le)),qe=Math.atan(.5*(Math.exp(Ue)-Math.exp(-Ue)))/nd;return new Gr(qe,Oe)}static get units(){return Bh}constructor(Re,Le){if(void 0===Re)throw new Error("No latitude given.");if(Le&&!Bh[Le])throw new Error(`Unknown unit ${Le}. Use one of: ${Object.keys(Bh).join(", ")}`);const Oe=6378.137*nd*(Le?Bh[Le]:1),Ue=Math.cos(Re*nd),qe=1/(1-Gh*(1-Ue*Ue)),Ct=Math.sqrt(qe);this.kx=Oe*Ct*Ue,this.ky=Oe*Ct*qe*(1-Gh)}distance(Re,Le){const Oe=Zr(Re[0]-Le[0])*this.kx,Ue=(Re[1]-Le[1])*this.ky;return Math.sqrt(Oe*Oe+Ue*Ue)}bearing(Re,Le){const Oe=Zr(Le[0]-Re[0])*this.kx;return Math.atan2(Oe,(Le[1]-Re[1])*this.ky)/nd}destination(Re,Le,Oe){const Ue=Oe*nd;return this.offset(Re,Math.sin(Ue)*Le,Math.cos(Ue)*Le)}offset(Re,Le,Oe){return[Re[0]+Le/this.kx,Re[1]+Oe/this.ky]}lineDistance(Re){let Le=0;for(let Oe=0;Oe<Re.length-1;Oe++)Le+=this.distance(Re[Oe],Re[Oe+1]);return Le}area(Re){let Le=0;for(let Oe=0;Oe<Re.length;Oe++){const Ue=Re[Oe];for(let Re=0,qe=Ue.length,Ct=qe-1;Re<qe;Ct=Re++)Le+=Zr(Ue[Re][0]-Ue[Ct][0])*(Ue[Re][1]+Ue[Ct][1])*(Oe?-1:1)}return Math.abs(Le)/2*this.kx*this.ky}along(Re,Le){let Oe=0;if(Le<=0)return Re[0];for(let Ue=0;Ue<Re.length-1;Ue++){const qe=Re[Ue],Ct=Re[Ue+1],Ot=this.distance(qe,Ct);if(Oe+=Ot,Oe>Le)return Yr(qe,Ct,(Le-(Oe-Ot))/Ot)}return Re[Re.length-1]}pointToSegmentDistance(Re,Le,Oe){let[Ue,qe]=Le,Ct=Zr(Oe[0]-Ue)*this.kx,Ot=(Oe[1]-qe)*this.ky;if(0!==Ct||0!==Ot){const Le=(Zr(Re[0]-Ue)*this.kx*Ct+(Re[1]-qe)*this.ky*Ot)/(Ct*Ct+Ot*Ot);Le>1?(Ue=Oe[0],qe=Oe[1]):Le>0&&(Ue+=Ct/this.kx*Le,qe+=Ot/this.ky*Le)}return Ct=Zr(Re[0]-Ue)*this.kx,Ot=(Re[1]-qe)*this.ky,Math.sqrt(Ct*Ct+Ot*Ot)}pointOnLine(Re,Le){let Oe=1/0,Ue=Re[0][0],qe=Re[0][1],Ct=0,Ot=0;for(let Jt=0;Jt<Re.length-1;Jt++){let Hr=Re[Jt][0],Jr=Re[Jt][1],Ln=Zr(Re[Jt+1][0]-Hr)*this.kx,Nn=(Re[Jt+1][1]-Jr)*this.ky,$n=0;0===Ln&&0===Nn||($n=(Zr(Le[0]-Hr)*this.kx*Ln+(Le[1]-Jr)*this.ky*Nn)/(Ln*Ln+Nn*Nn),$n>1?(Hr=Re[Jt+1][0],Jr=Re[Jt+1][1]):$n>0&&(Hr+=Ln/this.kx*$n,Jr+=Nn/this.ky*$n)),Ln=Zr(Le[0]-Hr)*this.kx,Nn=(Le[1]-Jr)*this.ky;const Gn=Ln*Ln+Nn*Nn;Gn<Oe&&(Oe=Gn,Ue=Hr,qe=Jr,Ct=Jt,Ot=$n)}return{point:[Ue,qe],index:Ct,t:Math.max(0,Math.min(1,Ot))}}lineSlice(Re,Le,Oe){let Ue=this.pointOnLine(Oe,Re),qe=this.pointOnLine(Oe,Le);if(Ue.index>qe.index||Ue.index===qe.index&&Ue.t>qe.t){const Re=Ue;Ue=qe,qe=Re}const Ct=[Ue.point],Ot=Ue.index+1,Jt=qe.index;!Xr(Oe[Ot],Ct[0])&&Ot<=Jt&&Ct.push(Oe[Ot]);for(let Re=Ot+1;Re<=Jt;Re++)Ct.push(Oe[Re]);return Xr(Oe[Jt],qe.point)||Ct.push(qe.point),Ct}lineSliceAlong(Re,Le,Oe){let Ue=0;const qe=[];for(let Ct=0;Ct<Oe.length-1;Ct++){const Ot=Oe[Ct],Jt=Oe[Ct+1],Hr=this.distance(Ot,Jt);if(Ue+=Hr,Ue>Re&&0===qe.length&&qe.push(Yr(Ot,Jt,(Re-(Ue-Hr))/Hr)),Ue>=Le)return qe.push(Yr(Ot,Jt,(Le-(Ue-Hr))/Hr)),qe;Ue>Re&&qe.push(Jt)}return qe}bufferPoint(Re,Le){const Oe=Le/this.ky,Ue=Le/this.kx;return[Re[0]-Ue,Re[1]-Oe,Re[0]+Ue,Re[1]+Oe]}bufferBBox(Re,Le){const Oe=Le/this.ky,Ue=Le/this.kx;return[Re[0]-Ue,Re[1]-Oe,Re[2]+Ue,Re[3]+Oe]}insideBBox(Re,Le){return Zr(Re[0]-Le[0])>=0&&Zr(Re[0]-Le[2])<=0&&Re[1]>=Le[1]&&Re[1]<=Le[3]}}function Xr(Re,Le){return Re[0]===Le[0]&&Re[1]===Le[1]}function Yr(Re,Le,Oe){const Ue=Zr(Le[0]-Re[0]);return[Re[0]+Ue*Oe,Re[1]+(Le[1]-Re[1])*Oe]}function Zr(Re){for(;Re<-180;)Re+=360;for(;Re>180;)Re-=360;return Re}class Wr{constructor(Re=[],Le=(Re,Le)=>Re<Le?-1:Re>Le?1:0){if(this.data=Re,this.length=this.data.length,this.compare=Le,this.length>0)for(let Re=(this.length>>1)-1;Re>=0;Re--)this._down(Re)}push(Re){this.data.push(Re),this._up(this.length++)}pop(){if(0===this.length)return;const Re=this.data[0],Le=this.data.pop();return--this.length>0&&(this.data[0]=Le,this._down(0)),Re}peek(){return this.data[0]}_up(Re){const{data:Le,compare:Oe}=this,Ue=Le[Re];for(;Re>0;){const qe=Re-1>>1,Ct=Le[qe];if(Oe(Ue,Ct)>=0)break;Le[Re]=Ct,Re=qe}Le[Re]=Ue}_down(Re){const{data:Le,compare:Oe}=this,Ue=this.length>>1,qe=Le[Re];for(;Re<Ue;){let Ue=1+(Re<<1);const Ct=Ue+1;if(Ct<this.length&&Oe(Le[Ct],Le[Ue])<0&&(Ue=Ct),Oe(Le[Ue],qe)>=0)break;Le[Re]=Le[Ue],Re=Ue}Le[Re]=qe}}var id=8192;function Kr(Re,Le){return Le.dist-Re.dist}const ld=100,ud=50;function tn(Re){const Le=[1/0,1/0,-1/0,-1/0];if(Le.length!==Re.length)return!1;for(let Oe=0;Oe<Le.length;Oe++)if(Le[Oe]!==Re[Oe])return!1;return!0}function en(Re){return Re[1]-Re[0]+1}function rn(Re,Le){const Oe=Re[1]>=Re[0]&&Re[1]<Le;return Oe||console.warn("Distance Expression: Index is out of range"),Oe}function nn(Re,Le){if(Re[0]>Re[1])return[null,null];const Oe=en(Re);if(Le){if(2===Oe)return[Re,null];const Le=Math.floor(Oe/2);return[[Re[0],Re[0]+Le],[Re[0]+Le,Re[1]]]}{if(1===Oe)return[Re,null];const Le=Math.floor(Oe/2)-1;return[[Re[0],Re[0]+Le],[Re[0]+Le+1,Re[1]]]}}function sn(Re,Le){const Oe=[1/0,1/0,-1/0,-1/0];if(!rn(Le,Re.length))return Oe;for(let Ue=Le[0];Ue<=Le[1];++Ue)Mr(Oe,Re[Ue]);return Oe}function an(Re){const Le=[1/0,1/0,-1/0,-1/0];for(let Oe=0;Oe<Re.length;++Oe)for(let Ue=0;Ue<Re[Oe].length;++Ue)Mr(Le,Re[Oe][Ue]);return Le}function on(Re,Le,Oe){if(tn(Re)||tn(Le))return NaN;let Ue=0,qe=0;return Re[2]<Le[0]&&(Ue=Le[0]-Re[2]),Re[0]>Le[2]&&(Ue=Re[0]-Le[2]),Re[1]>Le[3]&&(qe=Re[1]-Le[3]),Re[3]<Le[1]&&(qe=Le[1]-Re[3]),Oe.distance([0,0],[Ue,qe])}function ln(Re){return 360*Re-180}function un(Re){return 360/Math.PI*Math.atan(Math.exp((180-360*Re)*Math.PI/180))-90}function cn(Re,Le){const Oe=Math.pow(2,Le.z),Ue=(Re.y/id+Le.y)/Oe;return[ln((Re.x/id+Le.x)/Oe),un(Ue)]}function hn(Re,Le){const Oe=[];for(let Ue=0;Ue<Re.length;++Ue)Oe.push(cn(Re[Ue],Le));return Oe}function pn(Re,Le,Oe){const Ue=Oe.pointOnLine(Le,Re).point;return Oe.distance(Re,Ue)}function fn(Re,Le,Oe,Ue,qe){const Ct=Oe.slice(Ue[0],Ue[1]+1);let Ot=1/0;for(let Oe=Le[0];Oe<=Le[1];++Oe)if(0===(Ot=Math.min(Ot,pn(Re[Oe],Ct,qe))))return 0;return Ot}function dn(Re,Le,Oe,Ue,qe){const Ct=Math.min(qe.pointToSegmentDistance(Re,Oe,Ue),qe.pointToSegmentDistance(Le,Oe,Ue)),Ot=Math.min(qe.pointToSegmentDistance(Oe,Re,Le),qe.pointToSegmentDistance(Ue,Re,Le));return Math.min(Ct,Ot)}function mn(Re,Le,Oe,Ue,qe){if(!rn(Le,Re.length)||!rn(Ue,Oe.length))return NaN;let Ct=1/0;for(let Ot=Le[0];Ot<Le[1];++Ot)for(let Le=Ue[0];Le<Ue[1];++Le){if(zr(Re[Ot],Re[Ot+1],Oe[Le],Oe[Le+1]))return 0;Ct=Math.min(Ct,dn(Re[Ot],Re[Ot+1],Oe[Le],Oe[Le+1],qe))}return Ct}function yn(Re,Le,Oe,Ue,qe){if(!rn(Le,Re.length)||!rn(Ue,Oe.length))return NaN;let Ct=1/0;for(let Ot=Le[0];Ot<=Le[1];++Ot)for(let Le=Ue[0];Le<=Ue[1];++Le)if(0===(Ct=Math.min(Ct,qe.distance(Re[Ot],Oe[Le]))))return Ct;return Ct}function gn(Re,Le,Oe){if(Ir(Re,Le,!0))return 0;let Ue=1/0;for(const qe of Le){const Le=qe.length;if(Le<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(qe[0]!==qe[Le-1]&&0===(Ue=Math.min(Ue,Oe.pointToSegmentDistance(Re,qe[Le-1],qe[0]))))return Ue;if(0===(Ue=Math.min(Ue,pn(Re,qe,Oe))))return Ue}return Ue}function xn(Re,Le,Oe,Ue){if(!rn(Le,Re.length))return NaN;for(let Ue=Le[0];Ue<=Le[1];++Ue)if(Ir(Re[Ue],Oe,!0))return 0;let qe=1/0;for(let Ct=Le[0];Ct<Le[1];++Ct)for(const Le of Oe)for(let Oe=0,Ot=Le.length,Jt=Ot-1;Oe<Ot;Jt=Oe++){if(zr(Re[Ct],Re[Ct+1],Le[Jt],Le[Oe]))return 0;qe=Math.min(qe,dn(Re[Ct],Re[Ct+1],Le[Jt],Le[Oe],Ue))}return qe}function bn(Re,Le){for(const Oe of Re)for(let Re=0;Re<=Oe.length-1;++Re)if(Ir(Oe[Re],Le,!0))return!0;return!1}function vn(Re,Le,Oe,Ue=1/0){const qe=an(Re),Ct=an(Le);if(Ue!==1/0&&on(qe,Ct,Oe)>=Ue)return Ue;if(Ar(qe,Ct)){if(bn(Re,Le))return 0}else if(bn(Le,Re))return 0;let Ot=Ue;for(const Ue of Re)for(let Re=0,qe=Ue.length,Ct=qe-1;Re<qe;Ct=Re++)for(const qe of Le)for(let Le=0,Jt=qe.length,Hr=Jt-1;Le<Jt;Hr=Le++){if(zr(Ue[Ct],Ue[Re],qe[Hr],qe[Le]))return 0;Ot=Math.min(Ot,dn(Ue[Ct],Ue[Re],qe[Hr],qe[Le],Oe))}return Ot}function wn(Re,Le,Oe,Ue,qe,Ct,Ot){if(null===Ct||null===Ot)return;const Jt=on(sn(Ue,Ct),sn(qe,Ot),Oe);Jt<Le&&Re.push({dist:Jt,range1:Ct,range2:Ot})}function _n(Re,Le,Oe,Ue,qe=1/0){let Ct=Math.min(Ue.distance(Re[0],Oe[0][0]),qe);if(0===Ct)return Ct;const Ot=new Wr([{dist:0,range1:[0,Re.length-1],range2:[0,0]}],Kr),Jt=Le?ud:ld,Hr=an(Oe);for(;Ot.length;){const qe=Ot.pop();if(qe.dist>=Ct)continue;const Jr=qe.range1;if(en(Jr)<=Jt){if(!rn(Jr,Re.length))return NaN;if(Le){const Le=xn(Re,Jr,Oe,Ue);if(0===(Ct=Math.min(Ct,Le)))return Ct}else for(let Le=Jr[0];Le<=Jr[1];++Le){const qe=gn(Re[Le],Oe,Ue);if(0===(Ct=Math.min(Ct,qe)))return Ct}}else{const Oe=nn(Jr,Le);if(null!==Oe[0]){const Le=on(sn(Re,Oe[0]),Hr,Ue);Le<Ct&&Ot.push({dist:Le,range1:Oe[0],range2:[0,0]})}if(null!==Oe[1]){const Le=on(sn(Re,Oe[1]),Hr,Ue);Le<Ct&&Ot.push({dist:Le,range1:Oe[1],range2:[0,0]})}}}return Ct}function Mn(Re,Le,Oe,Ue,qe,Ct=1/0){let Ot=Math.min(Ct,qe.distance(Re[0],Oe[0]));if(0===Ot)return Ot;const Jt=new Wr([{dist:0,range1:[0,Re.length-1],range2:[0,Oe.length-1]}],Kr),Hr=Le?ud:ld,Jr=Ue?ud:ld;for(;Jt.length;){const Ct=Jt.pop();if(Ct.dist>=Ot)continue;const Ln=Ct.range1,Nn=Ct.range2;if(en(Ln)<=Hr&&en(Nn)<=Jr){if(!rn(Ln,Re.length)||!rn(Nn,Oe.length))return NaN;if(Le&&Ue?Ot=Math.min(Ot,mn(Re,Ln,Oe,Nn,qe)):Le||Ue?Le&&!Ue?Ot=Math.min(Ot,fn(Oe,Nn,Re,Ln,qe)):!Le&&Ue&&(Ot=Math.min(Ot,fn(Re,Ln,Oe,Nn,qe))):Ot=Math.min(Ot,yn(Re,Ln,Oe,Nn,qe)),0===Ot)return Ot}else{const Ct=nn(Ln,Le),Hr=nn(Nn,Ue);wn(Jt,Ot,qe,Re,Oe,Ct[0],Hr[0]),wn(Jt,Ot,qe,Re,Oe,Ct[0],Hr[1]),wn(Jt,Ot,qe,Re,Oe,Ct[1],Hr[0]),wn(Jt,Ot,qe,Re,Oe,Ct[1],Hr[1])}}return Ot}function An(Re,Le,Oe,Ue,qe=1/0){let Ct=qe;const Ot=sn(Re,[0,Re.length-1]);for(const qe of Oe)if(!(Ct!==1/0&&on(Ot,sn(qe,[0,qe.length-1]),Ue)>=Ct)&&(Ct=Math.min(Ct,Mn(Re,Le,qe,!0,Ue,Ct)),0===Ct))return Ct;return Ct}function Sn(Re,Le,Oe,Ue,qe=1/0){let Ct=qe;const Ot=sn(Re,[0,Re.length-1]);for(const qe of Oe){if(Ct!==1/0&&on(Ot,an(qe),Ue)>=Ct)continue;const Oe=_n(Re,Le,qe,Ue,Ct);if(isNaN(Oe))return Oe;if(0===(Ct=Math.min(Ct,Oe)))return Ct}return Ct}function In(Re){return"Point"===Re||"MultiPoint"===Re||"LineString"===Re||"MultiLineString"===Re||"Polygon"===Re||"MultiPolygon"===Re}class Pn{constructor(Re,Le){this.type=th,this.geojson=Re,this.geometries=Le}static parse(Re,Le){if(2!==Re.length)return Le.error(`'distance' expression requires either one argument, but found ' ${Re.length-1} instead.`);if(rr(Re[1])){const Le=Re[1];if("FeatureCollection"===Le.type){for(let Re=0;Re<Le.features.length;++Re)if(In(Le.features[Re].geometry.type))return new Pn(Le,Le.features[Re].geometry)}else if("Feature"===Le.type){if(In(Le.geometry.type))return new Pn(Le,Le.geometry)}else if(In(Le.type))return new Pn(Le,Le)}return Le.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(Re){const Le=Re.geometry(),Oe=Re.canonicalID();if(null!=Le&&null!=Oe){if("Point"===Re.geometryType())return function(Re,Le,Oe){const Ue=[];for(const Oe of Re)for(const Re of Oe)Ue.push(cn(Re,Le));const qe=new Gr(Ue[0][1],"meters");return"Point"===Oe.type||"MultiPoint"===Oe.type||"LineString"===Oe.type?Mn(Ue,!1,"Point"===Oe.type?[Oe.coordinates]:Oe.coordinates,"LineString"===Oe.type,qe):"MultiLineString"===Oe.type?An(Ue,!1,Oe.coordinates,qe):"Polygon"===Oe.type||"MultiPolygon"===Oe.type?Sn(Ue,!1,"Polygon"===Oe.type?[Oe.coordinates]:Oe.coordinates,qe):null}(Le,Oe,this.geometries);if("LineString"===Re.geometryType())return function(Re,Le,Oe){const Ue=[];for(const Oe of Re){const Re=[];for(const Ue of Oe)Re.push(cn(Ue,Le));Ue.push(Re)}const qe=new Gr(Ue[0][0][1],"meters");if("Point"===Oe.type||"MultiPoint"===Oe.type||"LineString"===Oe.type)return An("Point"===Oe.type?[Oe.coordinates]:Oe.coordinates,"LineString"===Oe.type,Ue,qe);if("MultiLineString"===Oe.type){let Re=1/0;for(let Le=0;Le<Oe.coordinates.length;Le++){const Ct=An(Oe.coordinates[Le],!0,Ue,qe,Re);if(isNaN(Ct))return Ct;if(0===(Re=Math.min(Re,Ct)))return Re}return Re}if("Polygon"===Oe.type||"MultiPolygon"===Oe.type){let Re=1/0;for(let Le=0;Le<Ue.length;Le++){const Ct=Sn(Ue[Le],!0,"Polygon"===Oe.type?[Oe.coordinates]:Oe.coordinates,qe,Re);if(isNaN(Ct))return Ct;if(0===(Re=Math.min(Re,Ct)))return Re}return Re}return null}(Le,Oe,this.geometries);if("Polygon"===Re.geometryType())return function(Re,Le,Oe){const Ue=[];for(const Oe of function(Re){const Le=Re.length;if(Le<=1)return[Re];const Oe=[];let Ue,qe;for(let Ct=0;Ct<Le;Ct++){const Le=_r(Re[Ct]);0!==Le&&(Re[Ct].area=Math.abs(Le),void 0===qe&&(qe=Le<0),qe===Le<0?(Ue&&Oe.push(Ue),Ue=[Re[Ct]]):Ue.push(Re[Ct]))}return Ue&&Oe.push(Ue),Oe}(Re)){const Re=[];for(let Ue=0;Ue<Oe.length;++Ue)Re.push(hn(Oe[Ue],Le));Ue.push(Re)}const qe=new Gr(Ue[0][0][0][1],"meters");if("Point"===Oe.type||"MultiPoint"===Oe.type||"LineString"===Oe.type)return Sn("Point"===Oe.type?[Oe.coordinates]:Oe.coordinates,"LineString"===Oe.type,Ue,qe);if("MultiLineString"===Oe.type){let Re=1/0;for(let Le=0;Le<Oe.coordinates.length;Le++){const Ct=Sn(Oe.coordinates[Le],!0,Ue,qe,Re);if(isNaN(Ct))return Ct;if(0===(Re=Math.min(Re,Ct)))return Re}return Re}return"Polygon"===Oe.type||"MultiPolygon"===Oe.type?function(Re,Le,Oe){let Ue=1/0;for(const qe of Re)for(const Re of Le){const Le=vn(qe,Re,Oe,Ue);if(isNaN(Le))return Le;if(0===(Ue=Math.min(Ue,Le)))return Ue}return Ue}("Polygon"===Oe.type?[Oe.coordinates]:Oe.coordinates,Ue,qe):null}(Le,Oe,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function zn(Re,Le){switch(Re){case"string":return ir(Le);case"number":return+Le;case"boolean":return!!Le;case"color":return Pe.parse(Le);case"formatted":return Qe.fromString(ir(Le));case"resolvedImage":return tr.fromString(ir(Le))}return Le}function kn(Re,Le,Oe,Ue){return void 0!==Ue&&(Re=Ue*Math.round(Re/Ue)),void 0!==Le&&Re<Le&&(Re=Le),void 0!==Oe&&Re>Oe&&(Re=Oe),Re}class Tn{constructor(Re,Le,Oe){this.type=Re,this.key=Le,this.scope=Oe}static parse(Re,Le){let Oe=Le.expectedType;if(null==Oe&&(Oe=ah),Re.length<2||Re.length>3)return Le.error("Invalid number of arguments for 'config' expression.");const Ue=Le.parse(Re[1],1);if(!(Ue instanceof sr))return Le.error("Key name of 'config' expression must be a string literal.");if(Re.length>=3){const qe=Le.parse(Re[2],2);return qe instanceof sr?new Tn(Oe,ir(Ue.value),ir(qe.value)):Le.error("Scope of 'config' expression must be a string literal.")}return new Tn(Oe,ir(Ue.value))}evaluate(Re){const Le=[this.key,this.scope,Re.scope].filter(Boolean).join(""),Oe=Re.getConfig(Le);if(!Oe)return null;const{type:Ue,value:qe,values:Ct,minValue:Ot,maxValue:Jt,stepValue:Hr}=Oe,Jr=Oe.default.evaluate(Re);let Ln=Jr;if(qe){const Le=Re.scope;Re.scope=(Le||"").split("").slice(1).join(""),Ln=qe.evaluate(Re),Re.scope=Le}return Ue&&(Ln=zn(Ue,Ln)),void 0===Ln||void 0===Ot&&void 0===Jt&&void 0===Hr||("number"==typeof Ln?Ln=kn(Ln,Ot,Jt,Hr):Array.isArray(Ln)&&(Ln=Ln.map((Re=>"number"==typeof Re?kn(Re,Ot,Jt,Hr):Re)))),void 0!==qe&&void 0!==Ln&&Ct&&!Ct.includes(Ln)&&(Ln=Jr,Ue&&(Ln=zn(Ue,Ln))),(Ue&&Ue!==this.type||void 0!==Ln&&nr(Ln)!==this.type)&&(Ln=zn(this.type.kind,Ln)),Ln}eachChild(){}outputDefined(){return!1}serialize(){const Re=["config",this.key];return this.scope&&Re.concat(this.key),Re}}function En(Re){if(Re instanceof yr){if("get"===Re.name&&1===Re.args.length)return!1;if("feature-state"===Re.name)return!1;if("has"===Re.name&&1===Re.args.length)return!1;if("properties"===Re.name||"geometry-type"===Re.name||"id"===Re.name)return!1;if(/^filter-/.test(Re.name))return!1}if(Re instanceof Ur)return!1;if(Re instanceof Pn)return!1;let Le=!0;return Re.eachChild((Re=>{Le&&!En(Re)&&(Le=!1)})),Le}function Bn(Re){if(Re instanceof yr&&"feature-state"===Re.name)return!1;let Le=!0;return Re.eachChild((Re=>{Le&&!Bn(Re)&&(Le=!1)})),Le}function Vn(Re){if(Re instanceof Tn)return new Set([Re.key]);let Le=new Set;return Re.eachChild((Re=>{Le=new Set([...Le,...Vn(Re)])})),Le}function Cn(Re,Le){if(Re instanceof yr&&Le.indexOf(Re.name)>=0)return!1;let Oe=!0;return Re.eachChild((Re=>{Oe&&!Cn(Re,Le)&&(Oe=!1)})),Oe}class Rn{constructor(Re,Le){this.type=Le.type,this.name=Re,this.boundExpression=Le}static parse(Re,Le){if(2!==Re.length||"string"!=typeof Re[1])return Le.error("'var' expression requires exactly one string literal argument.");const Oe=Re[1];return Le.scope.has(Oe)?new Rn(Oe,Le.scope.get(Oe)):Le.error(`Unknown variable "${Oe}". Make sure "${Oe}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(Re){return this.boundExpression.evaluate(Re)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class Dn{constructor(Re,Le=[],Oe,Ue=new Ce,qe=[],Ct,Ot){this.registry=Re,this.path=Le,this.key=Le.map((Re=>"string"==typeof Re?`['${Re}']`:`[${Re}]`)).join(""),this.scope=Ue,this.errors=qe,this.expectedType=Oe,this._scope=Ct,this.options=Ot}parse(Re,Le,Oe,Ue,qe={}){return Le||Oe?this.concat(Le,null,Oe,Ue)._parse(Re,qe):this._parse(Re,qe)}parseObjectValue(Re,Le,Oe,Ue,qe,Ct={}){return this.concat(Le,Oe,Ue,qe)._parse(Re,Ct)}_parse(Re,Le){function r(Re,Le,Oe){return"assert"===Oe?new lr(Le,[Re]):"coerce"===Oe?new fr(Le,[Re]):Re}if(null!==Re&&"string"!=typeof Re&&"boolean"!=typeof Re&&"number"!=typeof Re||(Re=["literal",Re]),Array.isArray(Re)){if(0===Re.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const Oe="string"==typeof Re[0]?this.registry[Re[0]]:void 0;if(Oe){let Ue=Oe.parse(Re,this);if(!Ue)return null;if(this.expectedType){const Re=this.expectedType,Oe=Ue.type;if("string"!==Re.kind&&"number"!==Re.kind&&"boolean"!==Re.kind&&"object"!==Re.kind&&"array"!==Re.kind||"value"!==Oe.kind)if("color"!==Re.kind&&"formatted"!==Re.kind&&"resolvedImage"!==Re.kind||"value"!==Oe.kind&&"string"!==Oe.kind){if(this.checkSubtype(Re,Oe))return null}else Ue=r(Ue,Re,Le.typeAnnotation||"coerce");else Ue=r(Ue,Re,Le.typeAnnotation||"assert")}if(!(Ue instanceof sr)&&"resolvedImage"!==Ue.type.kind&&Fn(Ue)){const Le=new mr(this._scope,this.options);try{Ue=new sr(Ue.type,Ue.evaluate(Le))}catch(Re){return this.error(Re.message),null}}return Ue}return fr.parse(["to-array",Re],this)}return this.error(void 0===Re?"'undefined' value invalid. Use null instead.":"object"==typeof Re?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof Re} instead.`)}concat(Re,Le,Oe,Ue){let qe="number"==typeof Re?this.path.concat(Re):this.path;qe="string"==typeof Le?qe.concat(Le):qe;const Ct=Ue?this.scope.concat(Ue):this.scope;return new Dn(this.registry,qe,Oe||null,Ct,this.errors,this._scope,this.options)}error(Re,...Le){const Oe=`${this.key}${Le.map((Re=>`[${Re}]`)).join("")}`;this.errors.push(new Ve(Oe,Re))}checkSubtype(Re,Le){const Oe=Ze(Re,Le);return Oe&&this.error(Oe),Oe}}var _d=Dn;function Fn(Re){if(Re instanceof Rn)return Fn(Re.boundExpression);if(Re instanceof yr&&"error"===Re.name)return!1;if(Re instanceof xr)return!1;if(Re instanceof Ur)return!1;if(Re instanceof Pn)return!1;if(Re instanceof Tn)return!1;const Le=Re instanceof fr||Re instanceof lr;let Oe=!0;return Re.eachChild((Re=>{Oe=Le?Oe&&Fn(Re):Oe&&Re instanceof sr})),!!Oe&&En(Re)&&Cn(Re,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function On(Re,Le){const Oe=Re.length-1;let Ue,qe,Ct=0,Ot=Oe,Jt=0;for(;Ct<=Ot;)if(Jt=Math.floor((Ct+Ot)/2),Ue=Re[Jt],qe=Re[Jt+1],Ue<=Le){if(Jt===Oe||Le<qe)return Jt;Ct=Jt+1}else{if(!(Ue>Le))throw new ar("Input is not a number.");Ot=Jt-1}return 0}class Un{constructor(Re,Le,Oe){this.type=Re,this.input=Le,this.labels=[],this.outputs=[];for(const[Re,Le]of Oe)this.labels.push(Re),this.outputs.push(Le)}static parse(Re,Le){if(Re.length-1<4)return Le.error(`Expected at least 4 arguments, but found only ${Re.length-1}.`);if((Re.length-1)%2!=0)return Le.error("Expected an even number of arguments.");const Oe=Le.parse(Re[1],1,th);if(!Oe)return null;const Ue=[];let qe=null;Le.expectedType&&"value"!==Le.expectedType.kind&&(qe=Le.expectedType);for(let Oe=1;Oe<Re.length;Oe+=2){const Ct=1===Oe?-1/0:Re[Oe],Ot=Re[Oe+1],Jt=Oe,Hr=Oe+1;if("number"!=typeof Ct)return Le.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Jt);if(Ue.length&&Ue[Ue.length-1][0]>=Ct)return Le.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',Jt);const Jr=Le.parse(Ot,Hr,qe);if(!Jr)return null;qe=qe||Jr.type,Ue.push([Ct,Jr])}return new Un(qe,Oe,Ue)}evaluate(Re){const Le=this.labels,Oe=this.outputs;if(1===Le.length)return Oe[0].evaluate(Re);const Ue=this.input.evaluate(Re);if(Ue<=Le[0])return Oe[0].evaluate(Re);const qe=Le.length;return Ue>=Le[qe-1]?Oe[qe-1].evaluate(Re):Oe[On(Le,Ue)].evaluate(Re)}eachChild(Re){Re(this.input);for(const Le of this.outputs)Re(Le)}outputDefined(){return this.outputs.every((Re=>Re.outputDefined()))}serialize(){const Re=["step",this.input.serialize()];for(let Le=0;Le<this.labels.length;Le++)Le>0&&Re.push(this.labels[Le]),Re.push(this.outputs[Le].serialize());return Re}}const xd=.95047,wd=1.08883,Sd=4/29,Cd=6/29,Ad=3*Cd*Cd,Md=Cd*Cd*Cd,Od=Math.PI/180,zd=180/Math.PI;function Wn(Re){return Re>Md?Math.pow(Re,1/3):Re/Ad+Sd}function Hn(Re){return Re>Cd?Re*Re*Re:Ad*(Re-Sd)}function Kn(Re){return 255*(Re<=.0031308?12.92*Re:1.055*Math.pow(Re,1/2.4)-.055)}function Jn(Re){return(Re/=255)<=.04045?Re/12.92:Math.pow((Re+.055)/1.055,2.4)}function Qn(Re){const Le=Jn(Re.r),Oe=Jn(Re.g),Ue=Jn(Re.b),qe=Wn((.4124564*Le+.3575761*Oe+.1804375*Ue)/xd),Ct=Wn((.2126729*Le+.7151522*Oe+.072175*Ue)/1);return{l:116*Ct-16,a:500*(qe-Ct),b:200*(Ct-Wn((.0193339*Le+.119192*Oe+.9503041*Ue)/wd)),alpha:Re.a}}function ti(Re){let Le=(Re.l+16)/116,Oe=isNaN(Re.a)?Le:Le+Re.a/500,Ue=isNaN(Re.b)?Le:Le-Re.b/200;return Le=1*Hn(Le),Oe=xd*Hn(Oe),Ue=wd*Hn(Ue),new Pe(Kn(3.2404542*Oe-1.5371385*Le-.4985314*Ue),Kn(-.969266*Oe+1.8760108*Le+.041556*Ue),Kn(.0556434*Oe-.2040259*Le+1.0572252*Ue),Re.alpha)}function ei(Re,Le,Oe){const Ue=Le-Re;return Re+Oe*(Ue>180||Ue<-180?Ue-360*Math.round(Ue/360):Ue)}const Bd={forward:Qn,reverse:ti,interpolate:function(Re,Le,Oe){return{l:ke(Re.l,Le.l,Oe),a:ke(Re.a,Le.a,Oe),b:ke(Re.b,Le.b,Oe),alpha:ke(Re.alpha,Le.alpha,Oe)}}},Ud={forward:function(Re){const{l:Le,a:Oe,b:Ue}=Qn(Re),qe=Math.atan2(Ue,Oe)*zd;return{h:qe<0?qe+360:qe,c:Math.sqrt(Oe*Oe+Ue*Ue),l:Le,alpha:Re.a}},reverse:function(Re){const Le=Re.h*Od,Oe=Re.c;return ti({l:Re.l,a:Math.cos(Le)*Oe,b:Math.sin(Le)*Oe,alpha:Re.alpha})},interpolate:function(Re,Le,Oe){return{h:ei(Re.h,Le.h,Oe),c:ke(Re.c,Le.c,Oe),l:ke(Re.l,Le.l,Oe),alpha:ke(Re.alpha,Le.alpha,Oe)}}};var Hd=Object.freeze({__proto__:null,hcl:Ud,lab:Bd});class si{constructor(Re,Le,Oe,Ue,qe){this.type=Re,this.operator=Le,this.interpolation=Oe,this.input=Ue,this.labels=[],this.outputs=[];for(const[Re,Le]of qe)this.labels.push(Re),this.outputs.push(Le)}static interpolationFactor(Re,Le,Oe,Ue){let qe=0;if("exponential"===Re.name)qe=ai(Le,Re.base,Oe,Ue);else if("linear"===Re.name)qe=ai(Le,1,Oe,Ue);else if("cubic-bezier"===Re.name){const Ct=Re.controlPoints;qe=new as(Ct[0],Ct[1],Ct[2],Ct[3]).solve(ai(Le,1,Oe,Ue))}return qe}static parse(Re,Le){let[Oe,Ue,qe,...Ct]=Re;if(!Array.isArray(Ue)||0===Ue.length)return Le.error("Expected an interpolation type expression.",1);if("linear"===Ue[0])Ue={name:"linear"};else if("exponential"===Ue[0]){const Re=Ue[1];if("number"!=typeof Re)return Le.error("Exponential interpolation requires a numeric base.",1,1);Ue={name:"exponential",base:Re}}else{if("cubic-bezier"!==Ue[0])return Le.error(`Unknown interpolation type ${String(Ue[0])}`,1,0);{const Re=Ue.slice(1);if(4!==Re.length||Re.some((Re=>"number"!=typeof Re||Re<0||Re>1)))return Le.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);Ue={name:"cubic-bezier",controlPoints:Re}}}if(Re.length-1<4)return Le.error(`Expected at least 4 arguments, but found only ${Re.length-1}.`);if((Re.length-1)%2!=0)return Le.error("Expected an even number of arguments.");if(qe=Le.parse(qe,2,th),!qe)return null;const Ot=[];let Jt=null;"interpolate-hcl"===Oe||"interpolate-lab"===Oe?Jt=ih:Le.expectedType&&"value"!==Le.expectedType.kind&&(Jt=Le.expectedType);for(let Re=0;Re<Ct.length;Re+=2){const Oe=Ct[Re],Ue=Ct[Re+1],qe=Re+3,Hr=Re+4;if("number"!=typeof Oe)return Le.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',qe);if(Ot.length&&Ot[Ot.length-1][0]>=Oe)return Le.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',qe);const Jr=Le.parse(Ue,Hr,Jt);if(!Jr)return null;Jt=Jt||Jr.type,Ot.push([Oe,Jr])}return"number"===Jt.kind||"color"===Jt.kind||"array"===Jt.kind&&"number"===Jt.itemType.kind&&"number"==typeof Jt.N?new si(Jt,Oe,Ue,qe,Ot):Le.error(`Type ${Xe(Jt)} is not interpolatable.`)}evaluate(Re){const Le=this.labels,Oe=this.outputs;if(1===Le.length)return Oe[0].evaluate(Re);const Ue=this.input.evaluate(Re);if(Ue<=Le[0])return Oe[0].evaluate(Re);const qe=Le.length;if(Ue>=Le[qe-1])return Oe[qe-1].evaluate(Re);const Ct=On(Le,Ue),Ot=si.interpolationFactor(this.interpolation,Ue,Le[Ct],Le[Ct+1]),Jt=Oe[Ct].evaluate(Re),Hr=Oe[Ct+1].evaluate(Re);return"interpolate"===this.operator?Qu[this.type.kind.toLowerCase()](Jt,Hr,Ot):"interpolate-hcl"===this.operator?Ud.reverse(Ud.interpolate(Ud.forward(Jt),Ud.forward(Hr),Ot)):Bd.reverse(Bd.interpolate(Bd.forward(Jt),Bd.forward(Hr),Ot))}eachChild(Re){Re(this.input);for(const Le of this.outputs)Re(Le)}outputDefined(){return this.outputs.every((Re=>Re.outputDefined()))}serialize(){let Re;Re="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const Le=[this.operator,Re,this.input.serialize()];for(let Re=0;Re<this.labels.length;Re++)Le.push(this.labels[Re],this.outputs[Re].serialize());return Le}}function ai(Re,Le,Oe,Ue){const qe=Ue-Oe,Ct=Re-Oe;return 0===qe?0:1===Le?Ct/qe:(Math.pow(Le,Ct)-1)/(Math.pow(Le,qe)-1)}class oi{constructor(Re,Le){this.type=Re,this.args=Le}static parse(Re,Le){if(Re.length<2)return Le.error("Expectected at least one argument.");let Oe=null;const Ue=Le.expectedType;Ue&&"value"!==Ue.kind&&(Oe=Ue);const qe=[];for(const Ue of Re.slice(1)){const Re=Le.parse(Ue,1+qe.length,Oe,void 0,{typeAnnotation:"omit"});if(!Re)return null;Oe=Oe||Re.type,qe.push(Re)}const Ct=Ue&&qe.some((Re=>Ze(Ue,Re.type)));return new oi(Ct?ah:Oe,qe)}evaluate(Re){let Le,Oe=null,Ue=0;for(const qe of this.args){if(Ue++,Oe=qe.evaluate(Re),Oe&&Oe instanceof tr&&!Oe.available&&(Le||(Le=Oe),Oe=null,Ue===this.args.length))return Le;if(null!==Oe)break}return Oe}eachChild(Re){this.args.forEach(Re)}outputDefined(){return this.args.every((Re=>Re.outputDefined()))}serialize(){const Re=["coalesce"];return this.eachChild((Le=>{Re.push(Le.serialize())})),Re}}class li{constructor(Re,Le){this.type=Le.type,this.bindings=[].concat(Re),this.result=Le}evaluate(Re){return this.result.evaluate(Re)}eachChild(Re){for(const Le of this.bindings)Re(Le[1]);Re(this.result)}static parse(Re,Le){if(Re.length<4)return Le.error(`Expected at least 3 arguments, but found ${Re.length-1} instead.`);const Oe=[];for(let Ue=1;Ue<Re.length-1;Ue+=2){const qe=Re[Ue];if("string"!=typeof qe)return Le.error(`Expected string, but found ${typeof qe} instead.`,Ue);if(/[^a-zA-Z0-9_]/.test(qe))return Le.error("Variable names must contain only alphanumeric characters or '_'.",Ue);const Ct=Le.parse(Re[Ue+1],Ue+1);if(!Ct)return null;Oe.push([qe,Ct])}const Ue=Le.parse(Re[Re.length-1],Re.length-1,Le.expectedType,Oe);return Ue?new li(Oe,Ue):null}outputDefined(){return this.result.outputDefined()}serialize(){const Re=["let"];for(const[Le,Oe]of this.bindings)Re.push(Le,Oe.serialize());return Re.push(this.result.serialize()),Re}}class ui{constructor(Re,Le,Oe){this.type=Re,this.index=Le,this.input=Oe}static parse(Re,Le){if(3!==Re.length)return Le.error(`Expected 2 arguments, but found ${Re.length-1} instead.`);const Oe=Le.parse(Re[1],1,th),Ue=Le.parse(Re[2],2,Ge(Le.expectedType||ah));return Oe&&Ue?new ui(Ue.type.itemType,Oe,Ue):null}evaluate(Re){const Le=this.index.evaluate(Re),Oe=this.input.evaluate(Re);if(Le<0)throw new ar(`Array index out of bounds: ${Le} < 0.`);if(Le>=Oe.length)throw new ar(`Array index out of bounds: ${Le} > ${Oe.length-1}.`);if(Le!==Math.floor(Le))throw new ar(`Array index must be an integer, but found ${Le} instead.`);return Oe[Le]}eachChild(Re){Re(this.index),Re(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class ci{constructor(Re,Le){this.type=nh,this.needle=Re,this.haystack=Le}static parse(Re,Le){if(3!==Re.length)return Le.error(`Expected 2 arguments, but found ${Re.length-1} instead.`);const Oe=Le.parse(Re[1],1,ah),Ue=Le.parse(Re[2],2,ah);return Oe&&Ue?We(Oe.type,[nh,rh,th,eh,ah])?new ci(Oe,Ue):Le.error(`Expected first argument to be of type boolean, string, number or null, but found ${Xe(Oe.type)} instead`):null}evaluate(Re){const Le=this.needle.evaluate(Re),Oe=this.haystack.evaluate(Re);if(null==Oe)return!1;if(!He(Le,["boolean","string","number","null"]))throw new ar(`Expected first argument to be of type boolean, string, number or null, but found ${Xe(nr(Le))} instead.`);if(!He(Oe,["string","array"]))throw new ar(`Expected second argument to be of type array or string, but found ${Xe(nr(Oe))} instead.`);return Oe.indexOf(Le)>=0}eachChild(Re){Re(this.needle),Re(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class hi{constructor(Re,Le,Oe){this.type=th,this.needle=Re,this.haystack=Le,this.fromIndex=Oe}static parse(Re,Le){if(Re.length<=2||Re.length>=5)return Le.error(`Expected 3 or 4 arguments, but found ${Re.length-1} instead.`);const Oe=Le.parse(Re[1],1,ah),Ue=Le.parse(Re[2],2,ah);if(!Oe||!Ue)return null;if(!We(Oe.type,[nh,rh,th,eh,ah]))return Le.error(`Expected first argument to be of type boolean, string, number or null, but found ${Xe(Oe.type)} instead`);if(4===Re.length){const qe=Le.parse(Re[3],3,th);return qe?new hi(Oe,Ue,qe):null}return new hi(Oe,Ue)}evaluate(Re){const Le=this.needle.evaluate(Re),Oe=this.haystack.evaluate(Re);if(!He(Le,["boolean","string","number","null"]))throw new ar(`Expected first argument to be of type boolean, string, number or null, but found ${Xe(nr(Le))} instead.`);if(!He(Oe,["string","array"]))throw new ar(`Expected second argument to be of type array or string, but found ${Xe(nr(Oe))} instead.`);if(this.fromIndex){const Ue=this.fromIndex.evaluate(Re);return Oe.indexOf(Le,Ue)}return Oe.indexOf(Le)}eachChild(Re){Re(this.needle),Re(this.haystack),this.fromIndex&&Re(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const Re=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),Re]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class pi{constructor(Re,Le,Oe,Ue,qe,Ct){this.inputType=Re,this.type=Le,this.input=Oe,this.cases=Ue,this.outputs=qe,this.otherwise=Ct}static parse(Re,Le){if(Re.length<5)return Le.error(`Expected at least 4 arguments, but found only ${Re.length-1}.`);if(Re.length%2!=1)return Le.error("Expected an even number of arguments.");let Oe,Ue;Le.expectedType&&"value"!==Le.expectedType.kind&&(Ue=Le.expectedType);const qe={},Ct=[];for(let Ot=2;Ot<Re.length-1;Ot+=2){let Jt=Re[Ot];const Hr=Re[Ot+1];Array.isArray(Jt)||(Jt=[Jt]);const Jr=Le.concat(Ot);if(0===Jt.length)return Jr.error("Expected at least one branch label.");for(const Re of Jt){if("number"!=typeof Re&&"string"!=typeof Re)return Jr.error("Branch labels must be numbers or strings.");if("number"==typeof Re&&Math.abs(Re)>Number.MAX_SAFE_INTEGER)return Jr.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof Re&&Math.floor(Re)!==Re)return Jr.error("Numeric branch labels must be integer values.");if(Oe){if(Jr.checkSubtype(Oe,nr(Re)))return null}else Oe=nr(Re);if(void 0!==qe[String(Re)])return Jr.error("Branch labels must be unique.");qe[String(Re)]=Ct.length}const Ln=Le.parse(Hr,Ot,Ue);if(!Ln)return null;Ue=Ue||Ln.type,Ct.push(Ln)}const Ot=Le.parse(Re[1],1,ah);if(!Ot)return null;const Jt=Le.parse(Re[Re.length-1],Re.length-1,Ue);return Jt?"value"!==Ot.type.kind&&Le.concat(1).checkSubtype(Oe,Ot.type)?null:new pi(Oe,Ue,Ot,qe,Ct,Jt):null}evaluate(Re){const Le=this.input.evaluate(Re);return(nr(Le)===this.inputType&&this.outputs[this.cases[Le]]||this.otherwise).evaluate(Re)}eachChild(Re){Re(this.input),this.outputs.forEach(Re),Re(this.otherwise)}outputDefined(){return this.outputs.every((Re=>Re.outputDefined()))&&this.otherwise.outputDefined()}serialize(){const Re=["match",this.input.serialize()],Le=Object.keys(this.cases).sort(),Oe=[],Ue={};for(const Re of Le){const Le=Ue[this.cases[Re]];void 0===Le?(Ue[this.cases[Re]]=Oe.length,Oe.push([this.cases[Re],[Re]])):Oe[Le][1].push(Re)}const i=Re=>"number"===this.inputType.kind?Number(Re):Re;for(const[Le,Ue]of Oe)Re.push(1===Ue.length?i(Ue[0]):Ue.map(i)),Re.push(this.outputs[Le].serialize());return Re.push(this.otherwise.serialize()),Re}}class fi{constructor(Re,Le,Oe){this.type=Re,this.branches=Le,this.otherwise=Oe}static parse(Re,Le){if(Re.length<4)return Le.error(`Expected at least 3 arguments, but found only ${Re.length-1}.`);if(Re.length%2!=0)return Le.error("Expected an odd number of arguments.");let Oe;Le.expectedType&&"value"!==Le.expectedType.kind&&(Oe=Le.expectedType);const Ue=[];for(let qe=1;qe<Re.length-1;qe+=2){const Ct=Le.parse(Re[qe],qe,nh);if(!Ct)return null;const Ot=Le.parse(Re[qe+1],qe+1,Oe);if(!Ot)return null;Ue.push([Ct,Ot]),Oe=Oe||Ot.type}const qe=Le.parse(Re[Re.length-1],Re.length-1,Oe);return qe?new fi(Oe,Ue,qe):null}evaluate(Re){for(const[Le,Oe]of this.branches)if(Le.evaluate(Re))return Oe.evaluate(Re);return this.otherwise.evaluate(Re)}eachChild(Re){for(const[Le,Oe]of this.branches)Re(Le),Re(Oe);Re(this.otherwise)}outputDefined(){return this.branches.every((([Re,Le])=>Le.outputDefined()))&&this.otherwise.outputDefined()}serialize(){const Re=["case"];return this.eachChild((Le=>{Re.push(Le.serialize())})),Re}}class di{constructor(Re,Le,Oe,Ue){this.type=Re,this.input=Le,this.beginIndex=Oe,this.endIndex=Ue}static parse(Re,Le){if(Re.length<=2||Re.length>=5)return Le.error(`Expected 3 or 4 arguments, but found ${Re.length-1} instead.`);const Oe=Le.parse(Re[1],1,ah),Ue=Le.parse(Re[2],2,th);if(!Oe||!Ue)return null;if(!We(Oe.type,[Ge(ah),rh,ah]))return Le.error(`Expected first argument to be of type array or string, but found ${Xe(Oe.type)} instead`);if(4===Re.length){const qe=Le.parse(Re[3],3,th);return qe?new di(Oe.type,Oe,Ue,qe):null}return new di(Oe.type,Oe,Ue)}evaluate(Re){const Le=this.input.evaluate(Re),Oe=this.beginIndex.evaluate(Re);if(!He(Le,["string","array"]))throw new ar(`Expected first argument to be of type array or string, but found ${Xe(nr(Le))} instead.`);if(this.endIndex){const Ue=this.endIndex.evaluate(Re);return Le.slice(Oe,Ue)}return Le.slice(Oe)}eachChild(Re){Re(this.input),Re(this.beginIndex),this.endIndex&&Re(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const Re=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),Re]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function mi(Re,Le){return"=="===Re||"!="===Re?"boolean"===Le.kind||"string"===Le.kind||"number"===Le.kind||"null"===Le.kind||"value"===Le.kind:"string"===Le.kind||"number"===Le.kind||"value"===Le.kind}function yi(Re,Le,Oe,Ue){return 0===Ue.compare(Le,Oe)}function gi(Re,Le,Oe){const Ue="=="!==Re&&"!="!==Re;return class i{constructor(Re,Le,Oe){this.type=nh,this.lhs=Re,this.rhs=Le,this.collator=Oe,this.hasUntypedArgument="value"===Re.type.kind||"value"===Le.type.kind}static parse(Re,Le){if(3!==Re.length&&4!==Re.length)return Le.error("Expected two or three arguments.");const Oe=Re[0];let qe=Le.parse(Re[1],1,ah);if(!qe)return null;if(!mi(Oe,qe.type))return Le.concat(1).error(`"${Oe}" comparisons are not supported for type '${Xe(qe.type)}'.`);let Ct=Le.parse(Re[2],2,ah);if(!Ct)return null;if(!mi(Oe,Ct.type))return Le.concat(2).error(`"${Oe}" comparisons are not supported for type '${Xe(Ct.type)}'.`);if(qe.type.kind!==Ct.type.kind&&"value"!==qe.type.kind&&"value"!==Ct.type.kind)return Le.error(`Cannot compare types '${Xe(qe.type)}' and '${Xe(Ct.type)}'.`);Ue&&("value"===qe.type.kind&&"value"!==Ct.type.kind?qe=new lr(Ct.type,[qe]):"value"!==qe.type.kind&&"value"===Ct.type.kind&&(Ct=new lr(qe.type,[Ct])));let Ot=null;if(4===Re.length){if("string"!==qe.type.kind&&"string"!==Ct.type.kind&&"value"!==qe.type.kind&&"value"!==Ct.type.kind)return Le.error("Cannot use collator to compare non-string types.");if(Ot=Le.parse(Re[3],3,ch),!Ot)return null}return new i(qe,Ct,Ot)}evaluate(qe){const Ct=this.lhs.evaluate(qe),Ot=this.rhs.evaluate(qe);if(Ue&&this.hasUntypedArgument){const Le=nr(Ct),Oe=nr(Ot);if(Le.kind!==Oe.kind||"string"!==Le.kind&&"number"!==Le.kind)throw new ar(`Expected arguments for "${Re}" to be (string, string) or (number, number), but found (${Le.kind}, ${Oe.kind}) instead.`)}if(this.collator&&!Ue&&this.hasUntypedArgument){const Re=nr(Ct),Oe=nr(Ot);if("string"!==Re.kind||"string"!==Oe.kind)return Le(qe,Ct,Ot)}return this.collator?Oe(qe,Ct,Ot,this.collator.evaluate(qe)):Le(qe,Ct,Ot)}eachChild(Re){Re(this.lhs),Re(this.rhs),this.collator&&Re(this.collator)}outputDefined(){return!0}serialize(){const Le=[Re];return this.eachChild((Re=>{Le.push(Re.serialize())})),Le}}}const Wd=gi("==",(function(Re,Le,Oe){return Le===Oe}),yi),Kd=gi("!=",(function(Re,Le,Oe){return Le!==Oe}),(function(Re,Le,Oe,Ue){return!yi(0,Le,Oe,Ue)})),sp=gi("<",(function(Re,Le,Oe){return Le<Oe}),(function(Re,Le,Oe,Ue){return Ue.compare(Le,Oe)<0})),ap=gi(">",(function(Re,Le,Oe){return Le>Oe}),(function(Re,Le,Oe,Ue){return Ue.compare(Le,Oe)>0})),cp=gi("<=",(function(Re,Le,Oe){return Le<=Oe}),(function(Re,Le,Oe,Ue){return Ue.compare(Le,Oe)<=0})),hp=gi(">=",(function(Re,Le,Oe){return Le>=Oe}),(function(Re,Le,Oe,Ue){return Ue.compare(Le,Oe)>=0}));class Ai{constructor(Re,Le,Oe,Ue,qe,Ct){this.type=rh,this.number=Re,this.locale=Le,this.currency=Oe,this.unit=Ue,this.minFractionDigits=qe,this.maxFractionDigits=Ct}static parse(Re,Le){if(3!==Re.length)return Le.error("Expected two arguments.");const Oe=Le.parse(Re[1],1,th);if(!Oe)return null;const Ue=Re[2];if("object"!=typeof Ue||Array.isArray(Ue))return Le.error("NumberFormat options argument must be an object.");let qe=null;if(Ue.locale&&(qe=Le.parseObjectValue(Ue.locale,2,"locale",rh),!qe))return null;let Ct=null;if(Ue.currency&&(Ct=Le.parseObjectValue(Ue.currency,2,"currency",rh),!Ct))return null;let Ot=null;if(Ue.unit&&(Ot=Le.parseObjectValue(Ue.unit,2,"unit",rh),!Ot))return null;let Jt=null;if(Ue["min-fraction-digits"]&&(Jt=Le.parseObjectValue(Ue["min-fraction-digits"],2,"min-fraction-digits",th),!Jt))return null;let Hr=null;return Ue["max-fraction-digits"]&&(Hr=Le.parseObjectValue(Ue["max-fraction-digits"],2,"max-fraction-digits",th),!Hr)?null:new Ai(Oe,qe,Ct,Ot,Jt,Hr)}evaluate(Re){return new Intl.NumberFormat(this.locale?this.locale.evaluate(Re):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(Re):void 0,unit:this.unit?this.unit.evaluate(Re):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(Re):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(Re):void 0}).format(this.number.evaluate(Re))}eachChild(Re){Re(this.number),this.locale&&Re(this.locale),this.currency&&Re(this.currency),this.unit&&Re(this.unit),this.minFractionDigits&&Re(this.minFractionDigits),this.maxFractionDigits&&Re(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const Re={};return this.locale&&(Re.locale=this.locale.serialize()),this.currency&&(Re.currency=this.currency.serialize()),this.unit&&(Re.unit=this.unit.serialize()),this.minFractionDigits&&(Re["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(Re["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),Re]}}class Si{constructor(Re){this.type=th,this.input=Re}static parse(Re,Le){if(2!==Re.length)return Le.error(`Expected 1 argument, but found ${Re.length-1} instead.`);const Oe=Le.parse(Re[1],1);return Oe?"array"!==Oe.type.kind&&"string"!==Oe.type.kind&&"value"!==Oe.type.kind?Le.error(`Expected argument of type string or array, but found ${Xe(Oe.type)} instead.`):new Si(Oe):null}evaluate(Re){const Le=this.input.evaluate(Re);if("string"==typeof Le)return Le.length;if(Array.isArray(Le))return Le.length;throw new ar(`Expected value to be of type string or array, but found ${Xe(nr(Le))} instead.`)}eachChild(Re){Re(this.input)}outputDefined(){return!1}serialize(){const Re=["length"];return this.eachChild((Le=>{Re.push(Le.serialize())})),Re}}function Ii(Re){return function(){Re=1831565813+(Re|=0)|0;let Le=Math.imul(Re^Re>>>15,1|Re);return Le=Le+Math.imul(Le^Le>>>7,61|Le)^Le,((Le^Le>>>14)>>>0)/4294967296}}const dp={"==":Wd,"!=":Kd,">":ap,"<":sp,">=":hp,"<=":cp,array:lr,at:ui,boolean:lr,case:fi,coalesce:oi,collator:xr,format:ur,image:cr,in:ci,"index-of":hi,interpolate:si,"interpolate-hcl":si,"interpolate-lab":si,length:Si,let:li,literal:sr,match:pi,number:lr,"number-format":Ai,object:lr,slice:di,step:Un,string:lr,"to-boolean":fr,"to-color":fr,"to-number":fr,"to-string":fr,var:Rn,within:Ur,distance:Pn,config:Tn};function zi(Re,[Le,Oe,Ue,qe]){Le=Le.evaluate(Re),Oe=Oe.evaluate(Re),Ue=Ue.evaluate(Re);const Ct=qe?qe.evaluate(Re):1,Ot=er(Le,Oe,Ue,Ct);if(Ot)throw new ar(Ot);return new Pe(Le/255*Ct,Oe/255*Ct,Ue/255*Ct,Ct)}function ki(Re,[Le,Oe,Ue,qe]){Le=Le.evaluate(Re),Oe=Oe.evaluate(Re),Ue=Ue.evaluate(Re);const Ct=qe?qe.evaluate(Re):1,Ot=function(Re,Le,Oe,Ue){return"number"==typeof Re&&Re>=0&&Re<=360?"number"==typeof Le&&Le>=0&&Le<=100&&"number"==typeof Oe&&Oe>=0&&Oe<=100?void 0===Ue||"number"==typeof Ue&&Ue>=0&&Ue<=1?null:`Invalid hsla value [${[Re,Le,Oe,Ue].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${("number"==typeof Ue?[Re,Le,Oe,Ue]:[Re,Le,Oe]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${("number"==typeof Ue?[Re,Le,Oe,Ue]:[Re,Le,Oe]).join(", ")}]: 'h' must be between 0 and 360.`}(Le,Oe,Ue,Ct);if(Ot)throw new ar(Ot);const Jt=`hsla(${Le}, ${Oe}%, ${Ue}%, ${Ct})`,Hr=Pe.parse(Jt);if(!Hr)throw new ar(`Failed to parse HSLA color: ${Jt}`);return Hr}function Ti(Re,Le){return Re in Le}function Ei(Re,Le){const Oe=Le[Re];return void 0===Oe?null:Oe}function Bi(Re){return{type:Re}}function Vi(Re){return{result:"success",value:Re}}function Ci(Re){return{result:"error",value:Re}}function Ri(Re,Le){return!!Re&&!!Re.parameters&&Re.parameters.indexOf(Le)>-1}function Di(Re){return"data-driven"===Re["property-type"]}function Li(Re){return Ri(Re.expression,"measure-light")}function Fi(Re){return Ri(Re.expression,"zoom")}function Oi(Re){return!!Re.expression&&Re.expression.interpolated}function Ui(Re){return"object"==typeof Re&&null!==Re&&!Array.isArray(Re)}function ji(Re){return Re}function Ni(Re,Le){const Oe="color"===Le.type,Ue=Re.stops&&"object"==typeof Re.stops[0][0],qe=Ue||!(Ue||void 0!==Re.property),Ct=Re.type||(Oi(Le)?"exponential":"interval");if(Oe&&((Re=Be({},Re)).stops&&(Re.stops=Re.stops.map((Re=>[Re[0],Pe.parse(Re[1])]))),Re.default=Pe.parse(Re.default?Re.default:Le.default)),Re.colorSpace&&"rgb"!==Re.colorSpace&&!Hd[Re.colorSpace])throw new Error(`Unknown color space: ${Re.colorSpace}`);let Ot,Jt,Hr;if("exponential"===Ct)Ot=Xi;else if("interval"===Ct)Ot=Gi;else if("categorical"===Ct){Ot=$i,Jt=Object.create(null);for(const Le of Re.stops)Jt[Le[0]]=Le[1];Hr=typeof Re.stops[0][0]}else{if("identity"!==Ct)throw new Error(`Unknown function type "${Ct}"`);Ot=Yi}if(Ue){const Oe={},Ue=[];for(let Le=0;Le<Re.stops.length;Le++){const qe=Re.stops[Le],Ct=qe[0].zoom;void 0===Oe[Ct]&&(Oe[Ct]={zoom:Ct,type:Re.type,property:Re.property,default:Re.default,stops:[]},Ue.push(Ct)),Oe[Ct].stops.push([qe[0].value,qe[1]])}const qe=[];for(const Re of Ue)qe.push([Oe[Re].zoom,Ni(Oe[Re],Le)]);const Ct={name:"linear"};return{kind:"composite",interpolationType:Ct,interpolationFactor:si.interpolationFactor.bind(void 0,Ct),zoomStops:qe.map((Re=>Re[0])),evaluate:({zoom:Oe},Ue)=>Xi({stops:qe,base:Re.base},Le,Oe).evaluate(Oe,Ue)}}if(qe){const Oe="exponential"===Ct?{name:"exponential",base:void 0!==Re.base?Re.base:1}:null;return{kind:"camera",interpolationType:Oe,interpolationFactor:si.interpolationFactor.bind(void 0,Oe),zoomStops:Re.stops.map((Re=>Re[0])),evaluate:({zoom:Oe})=>Ot(Re,Le,Oe,Jt,Hr)}}return{kind:"source",evaluate(Oe,Ue){const qe=Ue&&Ue.properties?Ue.properties[Re.property]:void 0;return void 0===qe?qi(Re.default,Le.default):Ot(Re,Le,qe,Jt,Hr)}}}function qi(Re,Le,Oe){return void 0!==Re?Re:void 0!==Le?Le:void 0!==Oe?Oe:void 0}function $i(Re,Le,Oe,Ue,qe){return qi(typeof Oe===qe?Ue[Oe]:void 0,Re.default,Le.default)}function Gi(Re,Le,Oe){if("number"!==hr(Oe))return qi(Re.default,Le.default);const Ue=Re.stops.length;if(1===Ue)return Re.stops[0][1];if(Oe<=Re.stops[0][0])return Re.stops[0][1];if(Oe>=Re.stops[Ue-1][0])return Re.stops[Ue-1][1];const qe=On(Re.stops.map((Re=>Re[0])),Oe);return Re.stops[qe][1]}function Xi(Re,Le,Oe){const Ue=void 0!==Re.base?Re.base:1;if("number"!==hr(Oe))return qi(Re.default,Le.default);const qe=Re.stops.length;if(1===qe)return Re.stops[0][1];if(Oe<=Re.stops[0][0])return Re.stops[0][1];if(Oe>=Re.stops[qe-1][0])return Re.stops[qe-1][1];const Ct=On(Re.stops.map((Re=>Re[0])),Oe),Ot=function(Re,Le,Oe,Ue){const qe=Ue-Oe,Ct=Re-Oe;return 0===qe?0:1===Le?Ct/qe:(Math.pow(Le,Ct)-1)/(Math.pow(Le,qe)-1)}(Oe,Ue,Re.stops[Ct][0],Re.stops[Ct+1][0]),Jt=Re.stops[Ct][1],Hr=Re.stops[Ct+1][1];let Jr=Qu[Le.type]||ji;if(Re.colorSpace&&"rgb"!==Re.colorSpace){const Le=Hd[Re.colorSpace];Jr=(Re,Oe)=>Le.reverse(Le.interpolate(Le.forward(Re),Le.forward(Oe),Ot))}return"function"==typeof Jt.evaluate?{evaluate(...Re){const Le=Jt.evaluate.apply(void 0,Re),Oe=Hr.evaluate.apply(void 0,Re);if(void 0!==Le&&void 0!==Oe)return Jr(Le,Oe,Ot)}}:Jr(Jt,Hr,Ot)}function Yi(Re,Le,Oe){return"color"===Le.type?Oe=Pe.parse(Oe):"formatted"===Le.type?Oe=Qe.fromString(Oe.toString()):"resolvedImage"===Le.type?Oe=tr.fromString(Oe.toString()):hr(Oe)===Le.type||"enum"===Le.type&&Le.values[Oe]||(Oe=void 0),qi(Oe,Re.default,Le.default)}yr.register(dp,{error:[{kind:"error"},[rh],(Re,[Le])=>{throw new ar(Le.evaluate(Re))}],typeof:[rh,[ah],(Re,[Le])=>Xe(nr(Le.evaluate(Re)))],"to-rgba":[Ge(th,4),[ih],(Re,[Le])=>Le.evaluate(Re).toRenderColor(null).toArray()],rgb:[ih,[th,th,th],zi],rgba:[ih,[th,th,th,th],zi],hsl:[ih,[th,th,th],ki],hsla:[ih,[th,th,th,th],ki],has:{type:nh,overloads:[[[rh],(Re,[Le])=>Ti(Le.evaluate(Re),Re.properties())],[[rh,sh],(Re,[Le,Oe])=>Ti(Le.evaluate(Re),Oe.evaluate(Re))]]},get:{type:ah,overloads:[[[rh],(Re,[Le])=>Ei(Le.evaluate(Re),Re.properties())],[[rh,sh],(Re,[Le,Oe])=>Ei(Le.evaluate(Re),Oe.evaluate(Re))]]},"feature-state":[ah,[rh],(Re,[Le])=>Ei(Le.evaluate(Re),Re.featureState||{})],properties:[sh,[],Re=>Re.properties()],"geometry-type":[rh,[],Re=>Re.geometryType()],id:[ah,[],Re=>Re.id()],zoom:[th,[],Re=>Re.globals.zoom],pitch:[th,[],Re=>Re.globals.pitch||0],"distance-from-center":[th,[],Re=>Re.distanceFromCenter()],"measure-light":[th,[rh],(Re,[Le])=>Re.measureLight(Le.evaluate(Re))],"heatmap-density":[th,[],Re=>Re.globals.heatmapDensity||0],"line-progress":[th,[],Re=>Re.globals.lineProgress||0],"raster-value":[th,[],Re=>Re.globals.rasterValue||0],"raster-particle-speed":[th,[],Re=>Re.globals.rasterParticleSpeed||0],"sky-radial-progress":[th,[],Re=>Re.globals.skyRadialProgress||0],accumulated:[ah,[],Re=>void 0===Re.globals.accumulated?null:Re.globals.accumulated],"+":[th,Bi(th),(Re,Le)=>{let Oe=0;for(const Ue of Le)Oe+=Ue.evaluate(Re);return Oe}],"*":[th,Bi(th),(Re,Le)=>{let Oe=1;for(const Ue of Le)Oe*=Ue.evaluate(Re);return Oe}],"-":{type:th,overloads:[[[th,th],(Re,[Le,Oe])=>Le.evaluate(Re)-Oe.evaluate(Re)],[[th],(Re,[Le])=>-Le.evaluate(Re)]]},"/":[th,[th,th],(Re,[Le,Oe])=>Le.evaluate(Re)/Oe.evaluate(Re)],"%":[th,[th,th],(Re,[Le,Oe])=>Le.evaluate(Re)%Oe.evaluate(Re)],ln2:[th,[],()=>Math.LN2],pi:[th,[],()=>Math.PI],e:[th,[],()=>Math.E],"^":[th,[th,th],(Re,[Le,Oe])=>Math.pow(Le.evaluate(Re),Oe.evaluate(Re))],sqrt:[th,[th],(Re,[Le])=>Math.sqrt(Le.evaluate(Re))],log10:[th,[th],(Re,[Le])=>Math.log(Le.evaluate(Re))/Math.LN10],ln:[th,[th],(Re,[Le])=>Math.log(Le.evaluate(Re))],log2:[th,[th],(Re,[Le])=>Math.log(Le.evaluate(Re))/Math.LN2],sin:[th,[th],(Re,[Le])=>Math.sin(Le.evaluate(Re))],cos:[th,[th],(Re,[Le])=>Math.cos(Le.evaluate(Re))],tan:[th,[th],(Re,[Le])=>Math.tan(Le.evaluate(Re))],asin:[th,[th],(Re,[Le])=>Math.asin(Le.evaluate(Re))],acos:[th,[th],(Re,[Le])=>Math.acos(Le.evaluate(Re))],atan:[th,[th],(Re,[Le])=>Math.atan(Le.evaluate(Re))],min:[th,Bi(th),(Re,Le)=>Math.min(...Le.map((Le=>Le.evaluate(Re))))],max:[th,Bi(th),(Re,Le)=>Math.max(...Le.map((Le=>Le.evaluate(Re))))],abs:[th,[th],(Re,[Le])=>Math.abs(Le.evaluate(Re))],round:[th,[th],(Re,[Le])=>{const Oe=Le.evaluate(Re);return Oe<0?-Math.round(-Oe):Math.round(Oe)}],floor:[th,[th],(Re,[Le])=>Math.floor(Le.evaluate(Re))],ceil:[th,[th],(Re,[Le])=>Math.ceil(Le.evaluate(Re))],"filter-==":[nh,[rh,ah],(Re,[Le,Oe])=>Re.properties()[Le.value]===Oe.value],"filter-id-==":[nh,[ah],(Re,[Le])=>Re.id()===Le.value],"filter-type-==":[nh,[rh],(Re,[Le])=>Re.geometryType()===Le.value],"filter-<":[nh,[rh,ah],(Re,[Le,Oe])=>{const Ue=Re.properties()[Le.value],qe=Oe.value;return typeof Ue==typeof qe&&Ue<qe}],"filter-id-<":[nh,[ah],(Re,[Le])=>{const Oe=Re.id(),Ue=Le.value;return typeof Oe==typeof Ue&&Oe<Ue}],"filter->":[nh,[rh,ah],(Re,[Le,Oe])=>{const Ue=Re.properties()[Le.value],qe=Oe.value;return typeof Ue==typeof qe&&Ue>qe}],"filter-id->":[nh,[ah],(Re,[Le])=>{const Oe=Re.id(),Ue=Le.value;return typeof Oe==typeof Ue&&Oe>Ue}],"filter-<=":[nh,[rh,ah],(Re,[Le,Oe])=>{const Ue=Re.properties()[Le.value],qe=Oe.value;return typeof Ue==typeof qe&&Ue<=qe}],"filter-id-<=":[nh,[ah],(Re,[Le])=>{const Oe=Re.id(),Ue=Le.value;return typeof Oe==typeof Ue&&Oe<=Ue}],"filter->=":[nh,[rh,ah],(Re,[Le,Oe])=>{const Ue=Re.properties()[Le.value],qe=Oe.value;return typeof Ue==typeof qe&&Ue>=qe}],"filter-id->=":[nh,[ah],(Re,[Le])=>{const Oe=Re.id(),Ue=Le.value;return typeof Oe==typeof Ue&&Oe>=Ue}],"filter-has":[nh,[ah],(Re,[Le])=>Le.value in Re.properties()],"filter-has-id":[nh,[],Re=>null!==Re.id()&&void 0!==Re.id()],"filter-type-in":[nh,[Ge(rh)],(Re,[Le])=>Le.value.indexOf(Re.geometryType())>=0],"filter-id-in":[nh,[Ge(ah)],(Re,[Le])=>Le.value.indexOf(Re.id())>=0],"filter-in-small":[nh,[rh,Ge(ah)],(Re,[Le,Oe])=>Oe.value.indexOf(Re.properties()[Le.value])>=0],"filter-in-large":[nh,[rh,Ge(ah)],(Re,[Le,Oe])=>function(Re,Le,Oe,Ue){for(;Oe<=Ue;){const qe=Oe+Ue>>1;if(Le[qe]===Re)return!0;Le[qe]>Re?Ue=qe-1:Oe=qe+1}return!1}(Re.properties()[Le.value],Oe.value,0,Oe.value.length-1)],all:{type:nh,overloads:[[[nh,nh],(Re,[Le,Oe])=>Le.evaluate(Re)&&Oe.evaluate(Re)],[Bi(nh),(Re,Le)=>{for(const Oe of Le)if(!Oe.evaluate(Re))return!1;return!0}]]},any:{type:nh,overloads:[[[nh,nh],(Re,[Le,Oe])=>Le.evaluate(Re)||Oe.evaluate(Re)],[Bi(nh),(Re,Le)=>{for(const Oe of Le)if(Oe.evaluate(Re))return!0;return!1}]]},"!":[nh,[nh],(Re,[Le])=>!Le.evaluate(Re)],"is-supported-script":[nh,[rh],(Re,[Le])=>{const Oe=Re.globals&&Re.globals.isSupportedScript;return!Oe||Oe(Le.evaluate(Re))}],upcase:[rh,[rh],(Re,[Le])=>Le.evaluate(Re).toUpperCase()],downcase:[rh,[rh],(Re,[Le])=>Le.evaluate(Re).toLowerCase()],concat:[rh,Bi(ah),(Re,Le)=>Le.map((Le=>ir(Le.evaluate(Re)))).join("")],"resolved-locale":[rh,[ch],(Re,[Le])=>Le.evaluate(Re).resolvedLocale()],random:[th,[th,th,ah],(Re,Le)=>{const[Oe,Ue,qe]=Le.map((Le=>Le.evaluate(Re)));if(Oe>Ue)return Oe;if(Oe===Ue)return Oe;let Ct;if("string"==typeof qe)Ct=function(Re){let Le=0;if(0===Re.length)return Le;for(let Oe=0;Oe<Re.length;Oe++)Le=(Le<<5)-Le+Re.charCodeAt(Oe),Le|=0;return Le}(qe);else{if("number"!=typeof qe)throw new ar(`Invalid seed input: ${qe}`);Ct=qe}return Oe+Ii(Ct)()*(Ue-Oe)}]});class Zi{constructor(Re,Le,Oe,Ue){this.expression=Re,this._warningHistory={},this._evaluator=new mr(Oe,Ue),this._defaultValue=Le?function(Re){return"color"===Re.type&&(Ui(Re.default)||Array.isArray(Re.default))?new Pe(0,0,0,0):"color"===Re.type?Pe.parse(Re.default)||null:void 0===Re.default?null:Re.default}(Le):null,this._enumValues=Le&&"enum"===Le.type?Le.values:null}evaluateWithoutErrorHandling(Re,Le,Oe,Ue,qe,Ct,Ot,Jt){return this._evaluator.globals=Re,this._evaluator.feature=Le,this._evaluator.featureState=Oe,this._evaluator.canonical=Ue||null,this._evaluator.availableImages=qe||null,this._evaluator.formattedSection=Ct,this._evaluator.featureTileCoord=Ot||null,this._evaluator.featureDistanceData=Jt||null,this.expression.evaluate(this._evaluator)}evaluate(Re,Le,Oe,Ue,qe,Ct,Ot,Jt){this._evaluator.globals=Re,this._evaluator.feature=Le||null,this._evaluator.featureState=Oe||null,this._evaluator.canonical=Ue||null,this._evaluator.availableImages=qe||null,this._evaluator.formattedSection=Ct||null,this._evaluator.featureTileCoord=Ot||null,this._evaluator.featureDistanceData=Jt||null;try{const Re=this.expression.evaluate(this._evaluator);if(null==Re||"number"==typeof Re&&Re!=Re)return this._defaultValue;if(this._enumValues&&!(Re in this._enumValues))throw new ar(`Expected value to be one of ${Object.keys(this._enumValues).map((Re=>JSON.stringify(Re))).join(", ")}, but found ${JSON.stringify(Re)} instead.`);return Re}catch(Re){return this._warningHistory[Re.message]||(this._warningHistory[Re.message]=!0,"undefined"!=typeof console&&console.warn(`Failed to evaluate expression "${JSON.stringify(this.expression.serialize())}". ${Re.message}`)),this._defaultValue}}}function Wi(Re){return Array.isArray(Re)&&Re.length>0&&"string"==typeof Re[0]&&Re[0]in dp}function Hi(Re,Le,Oe,Ue){const qe=new _d(dp,[],Le?function(Re){const Le={color:ih,string:rh,number:th,enum:rh,boolean:nh,formatted:yh,resolvedImage:Th};return"array"===Re.type?Ge(Le[Re.value]||ah,Re.length):Le[Re.type]}(Le):void 0,void 0,void 0,Oe,Ue),Ct=qe.parse(Re,void 0,void 0,void 0,Le&&"string"===Le.type?{typeAnnotation:"coerce"}:void 0);return Ct?Vi(new Zi(Ct,Le,Oe,Ue)):Ci(qe.errors)}class Ki{constructor(Re,Le,Oe){this.kind=Re,this._styleExpression=Le,this.isLightConstant=Oe,this.isStateDependent="constant"!==Re&&!Bn(Le.expression),this.configDependencies=Vn(Le.expression)}evaluateWithoutErrorHandling(Re,Le,Oe,Ue,qe,Ct){return this._styleExpression.evaluateWithoutErrorHandling(Re,Le,Oe,Ue,qe,Ct)}evaluate(Re,Le,Oe,Ue,qe,Ct){return this._styleExpression.evaluate(Re,Le,Oe,Ue,qe,Ct)}}class Ji{constructor(Re,Le,Oe,Ue,qe){this.kind=Re,this.zoomStops=Oe,this._styleExpression=Le,this.isStateDependent="camera"!==Re&&!Bn(Le.expression),this.isLightConstant=qe,this.configDependencies=Vn(Le.expression),this.interpolationType=Ue}evaluateWithoutErrorHandling(Re,Le,Oe,Ue,qe,Ct){return this._styleExpression.evaluateWithoutErrorHandling(Re,Le,Oe,Ue,qe,Ct)}evaluate(Re,Le,Oe,Ue,qe,Ct){return this._styleExpression.evaluate(Re,Le,Oe,Ue,qe,Ct)}interpolationFactor(Re,Le,Oe){return this.interpolationType?si.interpolationFactor(this.interpolationType,Re,Le,Oe):0}}function Qi(Re,Le,Oe,Ue){if("error"===(Re=Hi(Re,Le,Oe,Ue)).result)return Re;const qe=Re.value.expression,Ct=En(qe);if(!Ct&&!Di(Le))return Ci([new Ve("","data expressions not supported")]);const Ot=Cn(qe,["zoom","pitch","distance-from-center"]);if(!Ot&&!Fi(Le))return Ci([new Ve("","zoom expressions not supported")]);const Jt=Cn(qe,["measure-light"]);if(!Jt&&!Li(Le))return Ci([new Ve("","measure-light expression not supported")]);const Hr=Le.expression&&Le.expression.relaxZoomRestriction,Jr=es(qe);return Jr||Ot||Hr?Jr instanceof Ve?Ci([Jr]):Jr instanceof si&&!Oi(Le)?Ci([new Ve("",'"interpolate" expressions cannot be used with this property')]):Vi(Jr?new Ji(Ct?"camera":"composite",Re.value,Jr.labels,Jr instanceof si?Jr.interpolation:void 0,Jt):new Ki(Ct?"constant":"source",Re.value,Jt)):Ci([new Ve("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class ts{constructor(Re,Le){this._parameters=Re,this._specification=Le,Be(this,Ni(this._parameters,this._specification))}static deserialize(Re){return new ts(Re._parameters,Re._specification)}static serialize(Re){return{_parameters:Re._parameters,_specification:Re._specification}}}function es(Re){let Le=null;if(Re instanceof li)Le=es(Re.result);else if(Re instanceof oi){for(const Oe of Re.args)if(Le=es(Oe),Le)break}else(Re instanceof Un||Re instanceof si)&&Re.input instanceof yr&&"zoom"===Re.input.name&&(Le=Re);return Le instanceof Ve||Re.eachChild((Re=>{const Oe=es(Re);Oe instanceof Ve?Le=Oe:Le&&Oe&&Le!==Oe&&(Le=new Ve("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),Le}var pp,fp,mp=function(){if(fp)return pp;fp=1,pp=e;var Re=3;function e(Le,Oe,Ue){var qe=this.cells=[];if(Le instanceof ArrayBuffer){this.arrayBuffer=Le;var Ct=new Int32Array(this.arrayBuffer);Le=Ct[0],this.d=(Oe=Ct[1])+2*(Ue=Ct[2]);for(var Ot=0;Ot<this.d*this.d;Ot++){var Jt=Ct[Re+Ot],Hr=Ct[Re+Ot+1];qe.push(Jt===Hr?null:Ct.subarray(Jt,Hr))}var Jr=Ct[Re+qe.length+1];this.keys=Ct.subarray(Ct[Re+qe.length],Jr),this.bboxes=Ct.subarray(Jr),this.insert=this._insertReadonly}else{this.d=Oe+2*Ue;for(var Ln=0;Ln<this.d*this.d;Ln++)qe.push([]);this.keys=[],this.bboxes=[]}this.n=Oe,this.extent=Le,this.padding=Ue,this.scale=Oe/Le,this.uid=0;var Nn=Ue/Oe*Le;this.min=-Nn,this.max=Le+Nn}return e.prototype.insert=function(Re,Le,Oe,Ue,qe){this._forEachCell(Le,Oe,Ue,qe,this._insertCell,this.uid++),this.keys.push(Re),this.bboxes.push(Le),this.bboxes.push(Oe),this.bboxes.push(Ue),this.bboxes.push(qe)},e.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},e.prototype._insertCell=function(Re,Le,Oe,Ue,qe,Ct){this.cells[qe].push(Ct)},e.prototype.query=function(Re,Le,Oe,Ue,qe){var Ct=this.min,Ot=this.max;if(Re<=Ct&&Le<=Ct&&Ot<=Oe&&Ot<=Ue&&!qe)return Array.prototype.slice.call(this.keys);var Jt=[];return this._forEachCell(Re,Le,Oe,Ue,this._queryCell,Jt,{},qe),Jt},e.prototype._queryCell=function(Re,Le,Oe,Ue,qe,Ct,Ot,Jt){var Hr=this.cells[qe];if(null!==Hr)for(var Jr=this.keys,Ln=this.bboxes,Nn=0;Nn<Hr.length;Nn++){var $n=Hr[Nn];if(void 0===Ot[$n]){var Gn=4*$n;(Jt?Jt(Ln[Gn+0],Ln[Gn+1],Ln[Gn+2],Ln[Gn+3]):Re<=Ln[Gn+2]&&Le<=Ln[Gn+3]&&Oe>=Ln[Gn+0]&&Ue>=Ln[Gn+1])?(Ot[$n]=!0,Ct.push(Jr[$n])):Ot[$n]=!1}}},e.prototype._forEachCell=function(Re,Le,Oe,Ue,qe,Ct,Ot,Jt){for(var Hr=this._convertToCellCoord(Re),Jr=this._convertToCellCoord(Le),Ln=this._convertToCellCoord(Oe),Nn=this._convertToCellCoord(Ue),$n=Hr;$n<=Ln;$n++)for(var Gn=Jr;Gn<=Nn;Gn++){var qn=this.d*Gn+$n;if((!Jt||Jt(this._convertFromCellCoord($n),this._convertFromCellCoord(Gn),this._convertFromCellCoord($n+1),this._convertFromCellCoord(Gn+1)))&&qe.call(this,Re,Le,Oe,Ue,qn,Ct,Ot,Jt))return}},e.prototype._convertFromCellCoord=function(Re){return(Re-this.padding)/this.scale},e.prototype._convertToCellCoord=function(Re){return Math.max(0,Math.min(this.d-1,Math.floor(Re*this.scale)+this.padding))},e.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var Le=this.cells,Oe=Re+this.cells.length+1+1,Ue=0,qe=0;qe<this.cells.length;qe++)Ue+=this.cells[qe].length;var Ct=new Int32Array(Oe+Ue+this.keys.length+this.bboxes.length);Ct[0]=this.extent,Ct[1]=this.n,Ct[2]=this.padding;for(var Ot=Oe,Jt=0;Jt<Le.length;Jt++){var Hr=Le[Jt];Ct[Re+Jt]=Ot,Ct.set(Hr,Ot),Ot+=Hr.length}return Ct[Re+Le.length]=Ot,Ct.set(this.keys,Ot),Ct[Re+Le.length+1]=Ot+=this.keys.length,Ct.set(this.bboxes,Ot),Ot+=this.bboxes.length,Ct.buffer},pp}(),yp=e(mp);const vp={};function os(Re,Le,Oe={}){Object.defineProperty(Re,"_classRegistryKey",{value:Le,writable:!1}),vp[Le]={klass:Re,omit:Oe.omit||[]}}os(Object,"Object"),yp.serialize=function(Re,Le){const Oe=Re.toArrayBuffer();return Le&&Le.add(Oe),{buffer:Oe}},yp.deserialize=function(Re){return new yp(Re.buffer)},Object.defineProperty(yp,"name",{value:"Grid"}),os(yp,"Grid"),os(Pe,"Color"),os(Error,"Error"),os(Qe,"Formatted"),os(Je,"FormattedSection"),os(re,"AJAXError"),os(tr,"ResolvedImage"),os(ts,"StylePropertyFunction"),os(Zi,"StyleExpression",{omit:["_evaluator"]}),os(Ji,"ZoomDependentExpression"),os(Ki,"ZoomConstantExpression"),os(yr,"CompoundExpression",{omit:["_evaluate"]});for(const Re in dp)vp[dp[Re]._classRegistryKey]||os(dp[Re],`Expression${Re}`);function ls(Re){return Re&&"undefined"!=typeof ArrayBuffer&&(Re instanceof ArrayBuffer||Re.constructor&&"ArrayBuffer"===Re.constructor.name)}function us(Re){return self.ImageBitmap&&Re instanceof ImageBitmap}function cs(Re,Le){if(null==Re||"boolean"==typeof Re||"number"==typeof Re||"string"==typeof Re||Re instanceof Boolean||Re instanceof Number||Re instanceof String||Re instanceof Date||Re instanceof RegExp)return Re;if(ls(Re)||us(Re))return Le&&Le.add(Re),Re;if(ArrayBuffer.isView(Re)){const Oe=Re;return Le&&Le.add(Oe.buffer),Oe}if(Re instanceof ImageData)return Le&&Le.add(Re.data.buffer),Re;if(Array.isArray(Re)){const Oe=[];for(const Ue of Re)Oe.push(cs(Ue,Le));return Oe}if(Re instanceof Map){const Le={$name:"Map"};for(const[Oe,Ue]of Re.entries())Le[Oe]=cs(Ue);return Le}if(Re instanceof Set){const Le={$name:"Set"};let Oe=0;for(const Ue of Re.values())Le[++Oe]=cs(Ue);return Le}if("object"==typeof Re){const Oe=Re.constructor,Ue=Oe._classRegistryKey;if(!Ue)throw new Error(`can't serialize object of unregistered class ${Ue}`);const qe=Oe.serialize?Oe.serialize(Re,Le):{};if(!Oe.serialize){for(const Oe in Re)Re.hasOwnProperty(Oe)&&(vp[Ue].omit.indexOf(Oe)>=0||(qe[Oe]=cs(Re[Oe],Le)));Re instanceof Error&&(qe.message=Re.message)}if(qe.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==Ue&&(qe.$name=Ue),qe}throw new Error("can't serialize object of type "+typeof Re)}function hs(Re){if(null==Re||"boolean"==typeof Re||"number"==typeof Re||"string"==typeof Re||Re instanceof Boolean||Re instanceof Number||Re instanceof String||Re instanceof Date||Re instanceof RegExp||ls(Re)||us(Re)||ArrayBuffer.isView(Re)||Re instanceof ImageData)return Re;if(Array.isArray(Re))return Re.map(hs);if("object"==typeof Re){const Le=Re.$name||"Object";if("Map"===Le){const Le=new Map;for(const Oe of Object.keys(Re))"$name"!==Oe&&Le.set(Oe,hs(Re[Oe]));return Le}if("Set"===Le){const Le=new Set;for(const Oe of Object.keys(Re))"$name"!==Oe&&Le.add(hs(Re[Oe]));return Le}const{klass:Oe}=vp[Le];if(!Oe)throw new Error(`can't deserialize unregistered class ${Le}`);if(Oe.deserialize)return Oe.deserialize(Re);const Ue=Object.create(Oe.prototype);for(const Le of Object.keys(Re))"$name"!==Le&&(Ue[Le]=hs(Re[Le]));return Ue}throw new Error("can't deserialize object of type "+typeof Re)}const xp={"Latin-1 Supplement":Re=>Re>=128&&Re<=255,Arabic:Re=>Re>=1536&&Re<=1791,"Arabic Supplement":Re=>Re>=1872&&Re<=1919,"Arabic Extended-A":Re=>Re>=2208&&Re<=2303,"Hangul Jamo":Re=>Re>=4352&&Re<=4607,"Unified Canadian Aboriginal Syllabics":Re=>Re>=5120&&Re<=5759,Khmer:Re=>Re>=6016&&Re<=6143,"Unified Canadian Aboriginal Syllabics Extended":Re=>Re>=6320&&Re<=6399,"General Punctuation":Re=>Re>=8192&&Re<=8303,"Letterlike Symbols":Re=>Re>=8448&&Re<=8527,"Number Forms":Re=>Re>=8528&&Re<=8591,"Miscellaneous Technical":Re=>Re>=8960&&Re<=9215,"Control Pictures":Re=>Re>=9216&&Re<=9279,"Optical Character Recognition":Re=>Re>=9280&&Re<=9311,"Enclosed Alphanumerics":Re=>Re>=9312&&Re<=9471,"Geometric Shapes":Re=>Re>=9632&&Re<=9727,"Miscellaneous Symbols":Re=>Re>=9728&&Re<=9983,"Miscellaneous Symbols and Arrows":Re=>Re>=11008&&Re<=11263,"CJK Radicals Supplement":Re=>Re>=11904&&Re<=12031,"Kangxi Radicals":Re=>Re>=12032&&Re<=12255,"Ideographic Description Characters":Re=>Re>=12272&&Re<=12287,"CJK Symbols and Punctuation":Re=>Re>=12288&&Re<=12351,Hiragana:Re=>Re>=12352&&Re<=12447,Katakana:Re=>Re>=12448&&Re<=12543,Bopomofo:Re=>Re>=12544&&Re<=12591,"Hangul Compatibility Jamo":Re=>Re>=12592&&Re<=12687,Kanbun:Re=>Re>=12688&&Re<=12703,"Bopomofo Extended":Re=>Re>=12704&&Re<=12735,"CJK Strokes":Re=>Re>=12736&&Re<=12783,"Katakana Phonetic Extensions":Re=>Re>=12784&&Re<=12799,"Enclosed CJK Letters and Months":Re=>Re>=12800&&Re<=13055,"CJK Compatibility":Re=>Re>=13056&&Re<=13311,"CJK Unified Ideographs Extension A":Re=>Re>=13312&&Re<=19903,"Yijing Hexagram Symbols":Re=>Re>=19904&&Re<=19967,"CJK Unified Ideographs":Re=>Re>=19968&&Re<=40959,"Yi Syllables":Re=>Re>=40960&&Re<=42127,"Yi Radicals":Re=>Re>=42128&&Re<=42191,"Hangul Jamo Extended-A":Re=>Re>=43360&&Re<=43391,"Hangul Syllables":Re=>Re>=44032&&Re<=55215,"Hangul Jamo Extended-B":Re=>Re>=55216&&Re<=55295,"Private Use Area":Re=>Re>=57344&&Re<=63743,"CJK Compatibility Ideographs":Re=>Re>=63744&&Re<=64255,"Arabic Presentation Forms-A":Re=>Re>=64336&&Re<=65023,"Vertical Forms":Re=>Re>=65040&&Re<=65055,"CJK Compatibility Forms":Re=>Re>=65072&&Re<=65103,"Small Form Variants":Re=>Re>=65104&&Re<=65135,"Arabic Presentation Forms-B":Re=>Re>=65136&&Re<=65279,"Halfwidth and Fullwidth Forms":Re=>Re>=65280&&Re<=65519,"CJK Unified Ideographs Extension B":Re=>Re>=131072&&Re<=173791};function fs(Re){for(const Le of Re)if(ys(Le.charCodeAt(0)))return!0;return!1}function ds(Re){for(const Le of Re)if(!ms(Le.charCodeAt(0)))return!1;return!0}function ms(Re){return!(xp.Arabic(Re)||xp["Arabic Supplement"](Re)||xp["Arabic Extended-A"](Re)||xp["Arabic Presentation Forms-A"](Re)||xp["Arabic Presentation Forms-B"](Re))}function ys(Re){return!(746!==Re&&747!==Re&&(Re<4352||!(xp["Bopomofo Extended"](Re)||xp.Bopomofo(Re)||xp["CJK Compatibility Forms"](Re)&&!(Re>=65097&&Re<=65103)||xp["CJK Compatibility Ideographs"](Re)||xp["CJK Compatibility"](Re)||xp["CJK Radicals Supplement"](Re)||xp["CJK Strokes"](Re)||!(!xp["CJK Symbols and Punctuation"](Re)||Re>=12296&&Re<=12305||Re>=12308&&Re<=12319||12336===Re)||xp["CJK Unified Ideographs Extension A"](Re)||xp["CJK Unified Ideographs"](Re)||xp["Enclosed CJK Letters and Months"](Re)||xp["Hangul Compatibility Jamo"](Re)||xp["Hangul Jamo Extended-A"](Re)||xp["Hangul Jamo Extended-B"](Re)||xp["Hangul Jamo"](Re)||xp["Hangul Syllables"](Re)||xp.Hiragana(Re)||xp["Ideographic Description Characters"](Re)||xp.Kanbun(Re)||xp["Kangxi Radicals"](Re)||xp["Katakana Phonetic Extensions"](Re)||xp.Katakana(Re)&&12540!==Re||!(!xp["Halfwidth and Fullwidth Forms"](Re)||65288===Re||65289===Re||65293===Re||Re>=65306&&Re<=65310||65339===Re||65341===Re||65343===Re||Re>=65371&&Re<=65503||65507===Re||Re>=65512&&Re<=65519)||!(!xp["Small Form Variants"](Re)||Re>=65112&&Re<=65118||Re>=65123&&Re<=65126)||xp["Unified Canadian Aboriginal Syllabics"](Re)||xp["Unified Canadian Aboriginal Syllabics Extended"](Re)||xp["Vertical Forms"](Re)||xp["Yijing Hexagram Symbols"](Re)||xp["Yi Syllables"](Re)||xp["Yi Radicals"](Re))))}function gs(Re){return!(ys(Re)||function(Re){return!!(xp["Latin-1 Supplement"](Re)&&(167===Re||169===Re||174===Re||177===Re||188===Re||189===Re||190===Re||215===Re||247===Re)||xp["General Punctuation"](Re)&&(8214===Re||8224===Re||8225===Re||8240===Re||8241===Re||8251===Re||8252===Re||8258===Re||8263===Re||8264===Re||8265===Re||8273===Re)||xp["Letterlike Symbols"](Re)||xp["Number Forms"](Re)||xp["Miscellaneous Technical"](Re)&&(Re>=8960&&Re<=8967||Re>=8972&&Re<=8991||Re>=8996&&Re<=9e3||9003===Re||Re>=9085&&Re<=9114||Re>=9150&&Re<=9165||9167===Re||Re>=9169&&Re<=9179||Re>=9186&&Re<=9215)||xp["Control Pictures"](Re)&&9251!==Re||xp["Optical Character Recognition"](Re)||xp["Enclosed Alphanumerics"](Re)||xp["Geometric Shapes"](Re)||xp["Miscellaneous Symbols"](Re)&&!(Re>=9754&&Re<=9759)||xp["Miscellaneous Symbols and Arrows"](Re)&&(Re>=11026&&Re<=11055||Re>=11088&&Re<=11097||Re>=11192&&Re<=11243)||xp["CJK Symbols and Punctuation"](Re)||xp.Katakana(Re)||xp["Private Use Area"](Re)||xp["CJK Compatibility Forms"](Re)||xp["Small Form Variants"](Re)||xp["Halfwidth and Fullwidth Forms"](Re)||8734===Re||8756===Re||8757===Re||Re>=9984&&Re<=10087||Re>=10102&&Re<=10131||65532===Re||65533===Re)}(Re))}function xs(Re){return Re>=1424&&Re<=2303||xp["Arabic Presentation Forms-A"](Re)||xp["Arabic Presentation Forms-B"](Re)}function bs(Re,Le){return!(!Le&&xs(Re)||Re>=2304&&Re<=3583||Re>=3840&&Re<=4255||xp.Khmer(Re))}function vs(Re){for(const Le of Re)if(xs(Le.charCodeAt(0)))return!0;return!1}const bp="deferred",Tp="loading",Ap="loaded";let Mp=null,Rp="unavailable",Lp=null;const Ps=function(Re){Re&&"string"==typeof Re&&Re.indexOf("NetworkError")>-1&&(Rp="error"),Mp&&Mp(Re)};function zs(){Op.fire(new be("pluginStateChange",{pluginStatus:Rp,pluginURL:Lp}))}const Op=new Me,Ts=function(){return Rp},Es=function(){if(Rp!==bp||!Lp)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Rp=Tp,zs(),Lp&&se({url:Lp},(Re=>{Re?Ps(Re):(Rp=Ap,zs())}))},Dp={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Rp===Ap||null!=Dp.applyArabicShaping,isLoading:()=>Rp===Tp,setState(Re){Rp=Re.pluginStatus,Lp=Re.pluginURL},isParsed:()=>null!=Dp.applyArabicShaping&&null!=Dp.processBidirectionalText&&null!=Dp.processStyledBidirectionalText,getPluginURL:()=>Lp};class Vs{constructor(Re,Le){this.zoom=Re,Le?(this.now=Le.now,this.fadeDuration=Le.fadeDuration,this.transition=Le.transition,this.pitch=Le.pitch,this.brightness=Le.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(Re){return function(Re,Le){for(const Oe of Re)if(!bs(Oe.charCodeAt(0),Le))return!1;return!0}(Re,Dp.isLoaded())}}class Cs{constructor(Re,Le,Oe,Ue){this.property=Re,this.value=Le,this.expression=function(Re,Le,Oe,Ue){if(Ui(Re))return new ts(Re,Le);if(Wi(Re)||Array.isArray(Re)&&Re.length>0){const qe=Qi(Re,Le,Oe,Ue);if("error"===qe.result)throw new Error(qe.value.map((Re=>`${Re.key}: ${Re.message}`)).join(", "));return qe.value}{let Oe=Re;return"string"==typeof Re&&"color"===Le.type&&(Oe=Pe.parse(Re)),{kind:"constant",configDependencies:new Set,evaluate:()=>Oe}}}(void 0===Le?Re.specification.default:Le,Re.specification,Oe,Ue)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(Re,Le,Oe){return this.property.possiblyEvaluate(this,Re,Le,Oe)}}class Rs{constructor(Re,Le,Oe){this.property=Re,this.value=new Cs(Re,void 0,Le,Oe)}transitioned(Re,Le){return new Ls(this.property,this.value,Le,nt({},Re.transition,this.transition),Re.now)}untransitioned(){return new Ls(this.property,this.value,null,{},0)}}class Ds{constructor(Re,Le,Oe){this._properties=Re,this._values=Object.create(Re.defaultTransitionablePropertyValues),this._scope=Le,this._options=Oe,this.configDependencies=new Set}getValue(Re){return ht(this._values[Re].value.value)}setValue(Re,Le){this._values.hasOwnProperty(Re)||(this._values[Re]=new Rs(this._values[Re].property,this._scope,this._options)),this._values[Re].value=new Cs(this._values[Re].property,null===Le?void 0:ht(Le),this._scope,this._options),this._values[Re].value.expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[Re].value.expression.configDependencies]))}setTransitionOrValue(Re,Le){Le&&(this._options=Le);const Oe=this._properties.properties;if(Re)for(const Le in Re){const Ue=Re[Le];if(lt(Le,"-transition")){const Re=Le.slice(0,-11);Oe[Re]&&this.setTransition(Re,Ue)}else Oe.hasOwnProperty(Le)&&this.setValue(Le,Ue)}}getTransition(Re){return ht(this._values[Re].transition)}setTransition(Re,Le){this._values.hasOwnProperty(Re)||(this._values[Re]=new Rs(this._values[Re].property)),this._values[Re].transition=ht(Le)||void 0}serialize(){const Re={};for(const Le of Object.keys(this._values)){const Oe=this.getValue(Le);void 0!==Oe&&(Re[Le]=Oe);const Ue=this.getTransition(Le);void 0!==Ue&&(Re[`${Le}-transition`]=Ue)}return Re}transitioned(Re,Le){const Oe=new Fs(this._properties);for(const Ue of Object.keys(this._values))Oe._values[Ue]=this._values[Ue].transitioned(Re,Le._values[Ue]);return Oe}untransitioned(){const Re=new Fs(this._properties);for(const Le of Object.keys(this._values))Re._values[Le]=this._values[Le].untransitioned();return Re}}class Ls{constructor(Re,Le,Oe,Ue,qe){const Ct=Ue.delay||0,Ot=Ue.duration||0;qe=qe||0,this.property=Re,this.value=Le,this.begin=qe+Ct,this.end=this.begin+Ot,Re.specification.transition&&(Ue.delay||Ue.duration)&&(this.prior=Oe)}possiblyEvaluate(Re,Le,Oe){const Ue=Re.now||0,qe=this.value.possiblyEvaluate(Re,Le,Oe),Ct=this.prior;if(Ct){if(Ue>this.end)return this.prior=null,qe;if(this.value.isDataDriven())return this.prior=null,qe;if(Ue<this.begin)return Ct.possiblyEvaluate(Re,Le,Oe);{const Ot=(Ue-this.begin)/(this.end-this.begin);return this.property.interpolate(Ct.possiblyEvaluate(Re,Le,Oe),qe,H(Ot))}}return qe}}class Fs{constructor(Re){this._properties=Re,this._values=Object.create(Re.defaultTransitioningPropertyValues)}possiblyEvaluate(Re,Le,Oe){const Ue=new js(this._properties);for(const qe of Object.keys(this._values))Ue._values[qe]=this._values[qe].possiblyEvaluate(Re,Le,Oe);return Ue}hasTransition(){for(const Re of Object.keys(this._values))if(this._values[Re].prior)return!0;return!1}}class Os{constructor(Re,Le,Oe){this._properties=Re,this._values=Object.create(Re.defaultPropertyValues),this._scope=Le,this._options=Oe,this.configDependencies=new Set}getValue(Re){return ht(this._values[Re].value)}setValue(Re,Le){this._values[Re]=new Cs(this._values[Re].property,null===Le?void 0:ht(Le),this._scope,this._options),this._values[Re].expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[Re].expression.configDependencies]))}serialize(){const Re={};for(const Le of Object.keys(this._values)){const Oe=this.getValue(Le);void 0!==Oe&&(Re[Le]=Oe)}return Re}possiblyEvaluate(Re,Le,Oe){const Ue=new js(this._properties);for(const qe of Object.keys(this._values))Ue._values[qe]=this._values[qe].possiblyEvaluate(Re,Le,Oe);return Ue}}class Us{constructor(Re,Le,Oe){this.property=Re,this.value=Le,this.parameters=Oe}isConstant(){return"constant"===this.value.kind}constantOr(Re){return"constant"===this.value.kind?this.value.value:Re}evaluate(Re,Le,Oe,Ue){return this.property.evaluate(this.value,this.parameters,Re,Le,Oe,Ue)}}class js{constructor(Re){this._properties=Re,this._values=Object.create(Re.defaultPossiblyEvaluatedValues)}get(Re){return this._values[Re]}}class Ns{constructor(Re){this.specification=Re}possiblyEvaluate(Re,Le){return Re.expression.evaluate(Le)}interpolate(Re,Le,Oe){const Ue=Qu[this.specification.type];return Ue?Ue(Re,Le,Oe):Re}}class qs{constructor(Re,Le){this.specification=Re,this.overrides=Le}possiblyEvaluate(Re,Le,Oe,Ue){return new Us(this,"constant"===Re.expression.kind||"camera"===Re.expression.kind?{kind:"constant",value:Re.expression.evaluate(Le,null,{},Oe,Ue)}:Re.expression,Le)}interpolate(Re,Le,Oe){if("constant"!==Re.value.kind||"constant"!==Le.value.kind)return Re;if(void 0===Re.value.value||void 0===Le.value.value)return new Us(this,{kind:"constant",value:void 0},Re.parameters);const Ue=Qu[this.specification.type];return Ue?new Us(this,{kind:"constant",value:Ue(Re.value.value,Le.value.value,Oe)},Re.parameters):Re}evaluate(Re,Le,Oe,Ue,qe,Ct){return"constant"===Re.kind?Re.value:Re.evaluate(Le,Oe,Ue,qe,Ct)}}class $s{constructor(Re){this.specification=Re}possiblyEvaluate(Re,Le,Oe,Ue){return!!Re.expression.evaluate(Le,null,{},Oe,Ue)}interpolate(){return!1}}class Gs{constructor(Re){this.properties=Re,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const Le=new Vs(0,{});for(const Oe in Re){const Ue=Re[Oe];Ue.specification.overridable&&this.overridableProperties.push(Oe);const qe=this.defaultPropertyValues[Oe]=new Cs(Ue,void 0),Ct=this.defaultTransitionablePropertyValues[Oe]=new Rs(Ue);this.defaultTransitioningPropertyValues[Oe]=Ct.untransitioned(),this.defaultPossiblyEvaluatedValues[Oe]=qe.possiblyEvaluate(Le)}}}os(qs,"DataDrivenProperty"),os(Ns,"DataConstantProperty"),os($s,"ColorRampProperty");var Fp=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"imports":{"type":"array","value":"import"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"},"featuresets":{"experimental":true,"type":"featuresets"}},"featuresets":{"experimental":true,"*":{"type":"featureset"}},"featureset":{"experimental":true,"selectors":{"type":"array","value":"selector"}},"selector":{"experimental":true,"layer":{"type":"string","required":true},"properties":{"type":"selectorProperty","required":false},"featureNamespace":{"type":"string","required":false}},"selectorProperty":{"experimental":true,"*":{"type":"*"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","property-type":"data-constant","expression":{},"required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"property-type":"data-constant"},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"experimental":true,"type":{"required":true,"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"raster-particle":{"experimental":true},"hillshade":{},"model":{"experimental":true},"background":{},"sky":{},"slot":{},"clip":{"experimental":true}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{},"property-type":"data-constant","experimental":true},"clip-layer-scope":{"type":"array","value":"string","default":[],"expression":{},"property-type":"data-constant","experimental":true}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","experimental":true,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"colorTheme":{"data":{"type":"string","property-type":"data-constant","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"fill-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","experimental":true,"default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","experimental":true,"default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"experimental":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"fill-extrusion-line-width":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-trim-fade-range":{"type":"array","value":"number","experimental":true,"length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-trim-color":{"type":"color","experimental":true,"default":"transparent","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"property-type":"data-constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"symbol-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1},"default":"ground","experimental":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"raster-array-band":{"type":"string","required":false,"experimental":true,"property-type":"data-constant"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-particle-count":{"type":"number","default":512,"minimum":1,"property-type":"data-constant"},"raster-particle-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-particle-speed"]},"property-type":"color-ramp"},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1,"property-type":"data-constant"},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1,"property-type":"data-constant"},"raster-particle-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":[]},"property-type":"data-constant"},"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"model-front-cutoff":{"type":"array","private":true,"value":"number","property-type":"data-constant","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Ys(Re){return Re instanceof Number||Re instanceof String||Re instanceof Boolean?Re.valueOf():Re}function Zs(Re){if(Array.isArray(Re))return Re.map(Zs);if(Re instanceof Object&&!(Re instanceof Number||Re instanceof String||Re instanceof Boolean)){const Le={};for(const Oe in Re)Le[Oe]=Zs(Re[Oe]);return Le}return Ys(Re)}function Ws(Re){if(!0===Re||!1===Re)return!0;if(!Array.isArray(Re)||0===Re.length)return!1;switch(Re[0]){case"has":return Re.length>=2&&"$id"!==Re[1]&&"$type"!==Re[1];case"in":return Re.length>=3&&("string"!=typeof Re[1]||Array.isArray(Re[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==Re.length||Array.isArray(Re[1])||Array.isArray(Re[2]);case"any":case"all":for(const Le of Re.slice(1))if(!Ws(Le)&&"boolean"!=typeof Le)return!1;return!0;default:return!0}}function Hs(Re,Le="",Oe=null,Ue="fill"){if(null==Re)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Ws(Re)||(Re=na(Re));const qe=Re;let Ct=!0;try{Ct=function(Re){if(!Qs(Re))return Re;let Le=Zs(Re);return Js(Le),Le=Ks(Le),Le}(qe)}catch(Re){console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n${JSON.stringify(qe,null,2)}\n        `)}const Ot=Fp[`filter_${Ue}`],Jt=Hi(Ct,Ot,Le,Oe);let Hr=null;if("error"===Jt.result)throw new Error(Jt.value.map((Re=>`${Re.key}: ${Re.message}`)).join(", "));Hr=(Re,Le,Oe)=>Jt.value.evaluate(Re,Le,{},Oe);let Jr=null,Ln=null;if(Ct!==qe){const Re=Hi(qe,Ot,Le,Oe);if("error"===Re.result)throw new Error(Re.value.map((Re=>`${Re.key}: ${Re.message}`)).join(", "));Jr=(Le,Oe,Ue,qe,Ct)=>Re.value.evaluate(Le,Oe,{},Ue,void 0,void 0,qe,Ct),Ln=!En(Re.value.expression)}return{filter:Hr,dynamicFilter:Jr||void 0,needGeometry:ra(Ct),needFeature:!!Ln}}function Ks(Re){if(!Array.isArray(Re))return Re;const Le=function(Re){if(Np.has(Re[0]))for(let Le=1;Le<Re.length;Le++)if(Qs(Re[Le]))return!0;return Re}(Re);return!0===Le?Le:Le.map((Re=>Ks(Re)))}function Js(Re){let Le=!1;const Oe=[];if("case"===Re[0]){for(let Ue=1;Ue<Re.length-1;Ue+=2)Le=Le||Qs(Re[Ue]),Oe.push(Re[Ue+1]);Oe.push(Re[Re.length-1])}else if("match"===Re[0]){Le=Le||Qs(Re[1]);for(let Le=2;Le<Re.length-1;Le+=2)Oe.push(Re[Le+1]);Oe.push(Re[Re.length-1])}else if("step"===Re[0]){Le=Le||Qs(Re[1]);for(let Le=1;Le<Re.length-1;Le+=2)Oe.push(Re[Le+1])}Le&&(Re.length=0,Re.push("any",...Oe));for(let Le=1;Le<Re.length;Le++)Js(Re[Le])}function Qs(Re){if(!Array.isArray(Re))return!1;if("pitch"===(Le=Re[0])||"distance-from-center"===Le)return!0;var Le;for(let Le=1;Le<Re.length;Le++)if(Qs(Re[Le]))return!0;return!1}const Np=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function ea(Re,Le){return Re<Le?-1:Re>Le?1:0}function ra(Re){if(!Array.isArray(Re))return!1;if("within"===Re[0]||"distance"===Re[0])return!0;for(let Le=1;Le<Re.length;Le++)if(ra(Re[Le]))return!0;return!1}function na(Re){if(!Re)return!0;const Le=Re[0];return Re.length<=1?"any"!==Le:"=="===Le?ia(Re[1],Re[2],"=="):"!="===Le?oa(ia(Re[1],Re[2],"==")):"<"===Le||">"===Le||"<="===Le||">="===Le?ia(Re[1],Re[2],Le):"any"===Le?(Oe=Re.slice(1),["any"].concat(Oe.map(na))):"all"===Le?["all"].concat(Re.slice(1).map(na)):"none"===Le?["all"].concat(Re.slice(1).map(na).map(oa)):"in"===Le?sa(Re[1],Re.slice(2)):"!in"===Le?oa(sa(Re[1],Re.slice(2))):"has"===Le?aa(Re[1]):"!has"!==Le||oa(aa(Re[1]));var Oe}function ia(Re,Le,Oe){switch(Re){case"$type":return[`filter-type-${Oe}`,Le];case"$id":return[`filter-id-${Oe}`,Le];default:return[`filter-${Oe}`,Re,Le]}}function sa(Re,Le){if(0===Le.length)return!1;switch(Re){case"$type":return["filter-type-in",["literal",Le]];case"$id":return["filter-id-in",["literal",Le]];default:return Le.length>200&&!Le.some((Re=>typeof Re!=typeof Le[0]))?["filter-in-large",Re,["literal",Le.sort(ea)]]:["filter-in-small",Re,["literal",Le]]}}function aa(Re){switch(Re){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",Re]}}function oa(Re){return["!",Re]}const jp="";function ua(Re,Le){return Le?`${Re}${jp}${Le}`:Re}const Up="-transition",Vp=new Set(["fill","line","background","hillshade","raster"]);class pa extends Me{constructor(Re,Le,Oe,Ue,qe){if(super(),this.id=Re.id,this.fqid=ua(this.id,Oe),this.type=Re.type,this.scope=Oe,this.lut=Ue,this.options=qe,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.configDependencies=new Set,"custom"!==Re.type&&(this.metadata=Re.metadata,this.minzoom=Re.minzoom,this.maxzoom=Re.maxzoom,"background"!==Re.type&&"sky"!==Re.type&&"slot"!==Re.type&&(this.source=Re.source,this.sourceLayer=Re["source-layer"],this.filter=Re.filter),Re.slot&&(this.slot=Re.slot),Le.layout&&(this._unevaluatedLayout=new Os(Le.layout,this.scope,qe),this.configDependencies=new Set([...this.configDependencies,...this._unevaluatedLayout.configDependencies])),Le.paint)){this._transitionablePaint=new Ds(Le.paint,this.scope,qe);for(const Le in Re.paint)this.setPaintProperty(Le,Re.paint[Le]);for(const Le in Re.layout)this.setLayoutProperty(Le,Re.layout[Le]);this.configDependencies=new Set([...this.configDependencies,...this._transitionablePaint.configDependencies]),this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new js(Le.paint)}}onAdd(Re){}onRemove(Re){}isDraped(Re){return!this.is3D()&&Vp.has(this.type)}getLayoutProperty(Re){return"visibility"===Re?this.visibility:this._unevaluatedLayout.getValue(Re)}setLayoutProperty(Re,Le){if("custom"===this.type&&"visibility"===Re)return void(this.visibility=Le);const Oe=this._unevaluatedLayout;Oe._properties.properties[Re]&&(Oe.setValue(Re,Le),this.configDependencies=new Set([...this.configDependencies,...Oe.configDependencies]),"visibility"===Re&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0})}getPaintProperty(Re){return lt(Re,Up)?this._transitionablePaint.getTransition(Re.slice(0,-11)):this._transitionablePaint.getValue(Re)}setPaintProperty(Re,Le){const Oe=this._transitionablePaint,Ue=Oe._properties.properties;if(lt(Re,Up)){const qe=Re.slice(0,-11);return Ue[qe]&&Oe.setTransition(qe,Le||void 0),!1}if(!Ue[Re])return!1;const qe=Oe._values[Re],Ct=qe.value.isDataDriven(),Ot=qe.value;Oe.setValue(Re,Le),this.configDependencies=new Set([...this.configDependencies,...Oe.configDependencies]),this._handleSpecialPaintPropertyUpdate(Re);const Jt=Oe._values[Re].value,Hr=Jt.isDataDriven(),Jr=lt(Re,"pattern")||"line-dasharray"===Re;return Hr||Ct||Jr||this._handleOverridablePaintPropertyUpdate(Re,Ot,Jt)}_handleSpecialPaintPropertyUpdate(Re){}getProgramIds(){return null}getDefaultProgramParams(Re,Le,Oe){return null}_handleOverridablePaintPropertyUpdate(Re,Le,Oe){return!1}isHidden(Re){return!!(this.minzoom&&Re<this.minzoom)||!!(this.maxzoom&&Re>=this.maxzoom)||"none"===this.visibility}updateTransitions(Re){this._transitioningPaint=this._transitionablePaint.transitioned(Re,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(Re,Le){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(Re,void 0,Le)),this.paint=this._transitioningPaint.possiblyEvaluate(Re,void 0,Le)}serialize(){return ct({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},((Re,Le)=>!(void 0===Re||"layout"===Le&&!Object.keys(Re).length||"paint"===Le&&!Object.keys(Re).length)))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}isStateDependent(){for(const Re in this.paint._values){const Le=this.paint.get(Re);if(Le instanceof Us&&Di(Le.property.specification)&&("source"===Le.value.kind||"composite"===Le.value.kind)&&Le.value.isStateDependent)return!0}return!1}compileFilter(Re){this._filterCompiled||(this._featureFilter=Hs(this.filter,this.scope,Re),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(Re){this._stats&&("shadow"===Re.renderPass?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}queryRadius(Re){}queryIntersectsFeature(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr){}queryIntersectsMatchingFeature(Re,Le,Oe,Ue){}}const $p={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class da{constructor(Re,Le){this._structArray=Re,this._pos1=Le*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class ma{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(Re,Le){return Re._trim(),Le&&(Re.isTransferred=!0,Le.add(Re.arrayBuffer)),{length:Re.length,arrayBuffer:Re.arrayBuffer}}static deserialize(Re){const Le=Object.create(this.prototype);return Le.arrayBuffer=Re.arrayBuffer,Le.length=Re.length,Le.capacity=Re.arrayBuffer.byteLength/Le.bytesPerElement,Le._refreshViews(),Le}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(Re){this.reserve(Re),this.length=Re}reserve(Re){if(Re>this.capacity){this.capacity=Math.max(Re,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const Le=this.uint8;this._refreshViews(),Le&&this.uint8.set(Le)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...Re){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...Re){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function ya(Re,Le=1){let Oe=0,Ue=0;return{members:Re.map((Re=>{const qe=$p[Re.type].BYTES_PER_ELEMENT,Ct=Oe=ga(Oe,Math.max(Le,qe)),Ot=Re.components||1;return Ue=Math.max(Ue,qe),Oe+=qe*Ot,{name:Re.name,type:Re.type,components:Ot,offset:Ct}})),size:ga(Oe,Math.max(Ue,Le)),alignment:Le}}function ga(Re,Le){return Math.ceil(Re/Le)*Le}class xa extends ma{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(Re,Le){const Oe=this.length;return this.resize(Oe+1),this.emplace(Oe,Re,Le)}emplace(Re,Le,Oe){const Ue=2*Re;return this.int16[Ue+0]=Le,this.int16[Ue+1]=Oe,Re}}xa.prototype.bytesPerElement=4,os(xa,"StructArrayLayout2i4");class ba extends ma{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(Re,Le,Oe){const Ue=this.length;return this.resize(Ue+1),this.emplace(Ue,Re,Le,Oe)}emplace(Re,Le,Oe,Ue){const qe=3*Re;return this.int16[qe+0]=Le,this.int16[qe+1]=Oe,this.int16[qe+2]=Ue,Re}}ba.prototype.bytesPerElement=6,os(ba,"StructArrayLayout3i6");class va extends ma{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(Re,Le,Oe,Ue){const qe=this.length;return this.resize(qe+1),this.emplace(qe,Re,Le,Oe,Ue)}emplace(Re,Le,Oe,Ue,qe){const Ct=4*Re;return this.int16[Ct+0]=Le,this.int16[Ct+1]=Oe,this.int16[Ct+2]=Ue,this.int16[Ct+3]=qe,Re}}va.prototype.bytesPerElement=8,os(va,"StructArrayLayout4i8");class wa extends ma{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(Re,Le,Oe,Ue,qe){const Ct=this.length;return this.resize(Ct+1),this.emplace(Ct,Re,Le,Oe,Ue,qe)}emplace(Re,Le,Oe,Ue,qe,Ct){const Ot=5*Re;return this.int16[Ot+0]=Le,this.int16[Ot+1]=Oe,this.int16[Ot+2]=Ue,this.int16[Ot+3]=qe,this.int16[Ot+4]=Ct,Re}}wa.prototype.bytesPerElement=10,os(wa,"StructArrayLayout5i10");class _a extends ma{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(Re,Le,Oe,Ue,qe,Ct,Ot){const Jt=this.length;return this.resize(Jt+1),this.emplace(Jt,Re,Le,Oe,Ue,qe,Ct,Ot)}emplace(Re,Le,Oe,Ue,qe,Ct,Ot,Jt){const Hr=6*Re,Jr=12*Re,Ln=3*Re;return this.int16[Hr+0]=Le,this.int16[Hr+1]=Oe,this.uint8[Jr+4]=Ue,this.uint8[Jr+5]=qe,this.uint8[Jr+6]=Ct,this.uint8[Jr+7]=Ot,this.float32[Ln+2]=Jt,Re}}_a.prototype.bytesPerElement=12,os(_a,"StructArrayLayout2i4ub1f12");class Ma extends ma{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(Re,Le,Oe,Ue){const qe=this.length;return this.resize(qe+1),this.emplace(qe,Re,Le,Oe,Ue)}emplace(Re,Le,Oe,Ue,qe){const Ct=4*Re;return this.float32[Ct+0]=Le,this.float32[Ct+1]=Oe,this.float32[Ct+2]=Ue,this.float32[Ct+3]=qe,Re}}Ma.prototype.bytesPerElement=16,os(Ma,"StructArrayLayout4f16");class Aa extends ma{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(Re,Le,Oe){const Ue=this.length;return this.resize(Ue+1),this.emplace(Ue,Re,Le,Oe)}emplace(Re,Le,Oe,Ue){const qe=3*Re;return this.float32[qe+0]=Le,this.float32[qe+1]=Oe,this.float32[qe+2]=Ue,Re}}Aa.prototype.bytesPerElement=12,os(Aa,"StructArrayLayout3f12");class Sa extends ma{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(Re,Le,Oe,Ue,qe){const Ct=this.length;return this.resize(Ct+1),this.emplace(Ct,Re,Le,Oe,Ue,qe)}emplace(Re,Le,Oe,Ue,qe,Ct){const Ot=6*Re,Jt=3*Re;return this.uint16[Ot+0]=Le,this.uint16[Ot+1]=Oe,this.uint16[Ot+2]=Ue,this.uint16[Ot+3]=qe,this.float32[Jt+2]=Ct,Re}}Sa.prototype.bytesPerElement=12,os(Sa,"StructArrayLayout4ui1f12");class Ia extends ma{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(Re,Le,Oe,Ue){const qe=this.length;return this.resize(qe+1),this.emplace(qe,Re,Le,Oe,Ue)}emplace(Re,Le,Oe,Ue,qe){const Ct=4*Re;return this.uint16[Ct+0]=Le,this.uint16[Ct+1]=Oe,this.uint16[Ct+2]=Ue,this.uint16[Ct+3]=qe,Re}}Ia.prototype.bytesPerElement=8,os(Ia,"StructArrayLayout4ui8");class Pa extends ma{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(Re,Le,Oe,Ue,qe,Ct){const Ot=this.length;return this.resize(Ot+1),this.emplace(Ot,Re,Le,Oe,Ue,qe,Ct)}emplace(Re,Le,Oe,Ue,qe,Ct,Ot){const Jt=6*Re;return this.int16[Jt+0]=Le,this.int16[Jt+1]=Oe,this.int16[Jt+2]=Ue,this.int16[Jt+3]=qe,this.int16[Jt+4]=Ct,this.int16[Jt+5]=Ot,Re}}Pa.prototype.bytesPerElement=12,os(Pa,"StructArrayLayout6i12");class za extends ma{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr,Ln,Nn){const $n=this.length;return this.resize($n+1),this.emplace($n,Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr,Ln,Nn)}emplace(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr,Ln,Nn,$n){const Gn=12*Re;return this.int16[Gn+0]=Le,this.int16[Gn+1]=Oe,this.int16[Gn+2]=Ue,this.int16[Gn+3]=qe,this.uint16[Gn+4]=Ct,this.uint16[Gn+5]=Ot,this.uint16[Gn+6]=Jt,this.uint16[Gn+7]=Hr,this.int16[Gn+8]=Jr,this.int16[Gn+9]=Ln,this.int16[Gn+10]=Nn,this.int16[Gn+11]=$n,Re}}za.prototype.bytesPerElement=24,os(za,"StructArrayLayout4i4ui4i24");class ka extends ma{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(Re,Le,Oe,Ue,qe,Ct){const Ot=this.length;return this.resize(Ot+1),this.emplace(Ot,Re,Le,Oe,Ue,qe,Ct)}emplace(Re,Le,Oe,Ue,qe,Ct,Ot){const Jt=10*Re,Hr=5*Re;return this.int16[Jt+0]=Le,this.int16[Jt+1]=Oe,this.int16[Jt+2]=Ue,this.float32[Hr+2]=qe,this.float32[Hr+3]=Ct,this.float32[Hr+4]=Ot,Re}}ka.prototype.bytesPerElement=20,os(ka,"StructArrayLayout3i3f20");class Ta extends ma{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(Re){const Le=this.length;return this.resize(Le+1),this.emplace(Le,Re)}emplace(Re,Le){return this.uint32[1*Re+0]=Le,Re}}Ta.prototype.bytesPerElement=4,os(Ta,"StructArrayLayout1ul4");class Ea extends ma{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(Re,Le){const Oe=this.length;return this.resize(Oe+1),this.emplace(Oe,Re,Le)}emplace(Re,Le,Oe){const Ue=2*Re;return this.uint16[Ue+0]=Le,this.uint16[Ue+1]=Oe,Re}}Ea.prototype.bytesPerElement=4,os(Ea,"StructArrayLayout2ui4");class Ba extends ma{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr,Ln,Nn,$n){const Gn=this.length;return this.resize(Gn+1),this.emplace(Gn,Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr,Ln,Nn,$n)}emplace(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr,Ln,Nn,$n,Gn){const qn=20*Re,Zn=10*Re;return this.int16[qn+0]=Le,this.int16[qn+1]=Oe,this.int16[qn+2]=Ue,this.int16[qn+3]=qe,this.int16[qn+4]=Ct,this.float32[Zn+3]=Ot,this.float32[Zn+4]=Jt,this.float32[Zn+5]=Hr,this.float32[Zn+6]=Jr,this.int16[qn+14]=Ln,this.uint32[Zn+8]=Nn,this.uint16[qn+18]=$n,this.uint16[qn+19]=Gn,Re}}Ba.prototype.bytesPerElement=40,os(Ba,"StructArrayLayout5i4f1i1ul2ui40");class Va extends ma{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(Re,Le,Oe,Ue,qe,Ct,Ot){const Jt=this.length;return this.resize(Jt+1),this.emplace(Jt,Re,Le,Oe,Ue,qe,Ct,Ot)}emplace(Re,Le,Oe,Ue,qe,Ct,Ot,Jt){const Hr=8*Re;return this.int16[Hr+0]=Le,this.int16[Hr+1]=Oe,this.int16[Hr+2]=Ue,this.int16[Hr+4]=qe,this.int16[Hr+5]=Ct,this.int16[Hr+6]=Ot,this.int16[Hr+7]=Jt,Re}}Va.prototype.bytesPerElement=16,os(Va,"StructArrayLayout3i2i2i16");class Ca extends ma{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(Re,Le,Oe,Ue,qe){const Ct=this.length;return this.resize(Ct+1),this.emplace(Ct,Re,Le,Oe,Ue,qe)}emplace(Re,Le,Oe,Ue,qe,Ct){const Ot=4*Re,Jt=8*Re;return this.float32[Ot+0]=Le,this.float32[Ot+1]=Oe,this.float32[Ot+2]=Ue,this.int16[Jt+6]=qe,this.int16[Jt+7]=Ct,Re}}Ca.prototype.bytesPerElement=16,os(Ca,"StructArrayLayout2f1f2i16");class Ra extends ma{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(Re,Le,Oe,Ue,qe,Ct){const Ot=this.length;return this.resize(Ot+1),this.emplace(Ot,Re,Le,Oe,Ue,qe,Ct)}emplace(Re,Le,Oe,Ue,qe,Ct,Ot){const Jt=20*Re,Hr=5*Re;return this.uint8[Jt+0]=Le,this.uint8[Jt+1]=Oe,this.float32[Hr+1]=Ue,this.float32[Hr+2]=qe,this.float32[Hr+3]=Ct,this.float32[Hr+4]=Ot,Re}}Ra.prototype.bytesPerElement=20,os(Ra,"StructArrayLayout2ub4f20");class Da extends ma{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(Re,Le,Oe){const Ue=this.length;return this.resize(Ue+1),this.emplace(Ue,Re,Le,Oe)}emplace(Re,Le,Oe,Ue){const qe=3*Re;return this.uint16[qe+0]=Le,this.uint16[qe+1]=Oe,this.uint16[qe+2]=Ue,Re}}Da.prototype.bytesPerElement=6,os(Da,"StructArrayLayout3ui6");class La extends ma{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr,Ln,Nn,$n,Gn,qn,Zn,Xn,Yn,_i,vi,xi){const bi=this.length;return this.resize(bi+1),this.emplace(bi,Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr,Ln,Nn,$n,Gn,qn,Zn,Xn,Yn,_i,vi,xi)}emplace(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr,Ln,Nn,$n,Gn,qn,Zn,Xn,Yn,_i,vi,xi,bi){const Pi=30*Re,lo=15*Re,uo=60*Re;return this.int16[Pi+0]=Le,this.int16[Pi+1]=Oe,this.int16[Pi+2]=Ue,this.float32[lo+2]=qe,this.float32[lo+3]=Ct,this.uint16[Pi+8]=Ot,this.uint16[Pi+9]=Jt,this.uint32[lo+5]=Hr,this.uint32[lo+6]=Jr,this.uint32[lo+7]=Ln,this.uint16[Pi+16]=Nn,this.uint16[Pi+17]=$n,this.uint16[Pi+18]=Gn,this.float32[lo+10]=qn,this.float32[lo+11]=Zn,this.uint8[uo+48]=Xn,this.uint8[uo+49]=Yn,this.uint8[uo+50]=_i,this.uint32[lo+13]=vi,this.int16[Pi+28]=xi,this.uint8[uo+58]=bi,Re}}La.prototype.bytesPerElement=60,os(La,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Fa extends ma{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr,Ln,Nn,$n,Gn,qn,Zn,Xn,Yn,_i,vi,xi,bi,Pi,lo,uo,po,fo,Io,is,as,Is,Xs){const ta=this.length;return this.resize(ta+1),this.emplace(ta,Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr,Ln,Nn,$n,Gn,qn,Zn,Xn,Yn,_i,vi,xi,bi,Pi,lo,uo,po,fo,Io,is,as,Is,Xs)}emplace(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr,Ln,Nn,$n,Gn,qn,Zn,Xn,Yn,_i,vi,xi,bi,Pi,lo,uo,po,fo,Io,is,as,Is,Xs,ta){const ha=20*Re,el=40*Re,tl=80*Re;return this.float32[ha+0]=Le,this.float32[ha+1]=Oe,this.int16[el+4]=Ue,this.int16[el+5]=qe,this.int16[el+6]=Ct,this.int16[el+7]=Ot,this.int16[el+8]=Jt,this.int16[el+9]=Hr,this.int16[el+10]=Jr,this.int16[el+11]=Ln,this.int16[el+12]=Nn,this.uint16[el+13]=$n,this.uint16[el+14]=Gn,this.uint16[el+15]=qn,this.uint16[el+16]=Zn,this.uint16[el+17]=Xn,this.uint16[el+18]=Yn,this.uint16[el+19]=_i,this.uint16[el+20]=vi,this.uint16[el+21]=xi,this.uint16[el+22]=bi,this.uint16[el+23]=Pi,this.uint16[el+24]=lo,this.uint16[el+25]=uo,this.uint16[el+26]=po,this.uint16[el+27]=fo,this.uint32[ha+14]=Io,this.float32[ha+15]=is,this.float32[ha+16]=as,this.float32[ha+17]=Is,this.float32[ha+18]=Xs,this.uint8[tl+76]=ta,Re}}Fa.prototype.bytesPerElement=80,os(Fa,"StructArrayLayout2f9i15ui1ul4f1ub80");class Oa extends ma{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(Re){const Le=this.length;return this.resize(Le+1),this.emplace(Le,Re)}emplace(Re,Le){return this.float32[1*Re+0]=Le,Re}}Oa.prototype.bytesPerElement=4,os(Oa,"StructArrayLayout1f4");class Ua extends ma{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(Re,Le,Oe,Ue,qe){const Ct=this.length;return this.resize(Ct+1),this.emplace(Ct,Re,Le,Oe,Ue,qe)}emplace(Re,Le,Oe,Ue,qe,Ct){const Ot=5*Re;return this.float32[Ot+0]=Le,this.float32[Ot+1]=Oe,this.float32[Ot+2]=Ue,this.float32[Ot+3]=qe,this.float32[Ot+4]=Ct,Re}}Ua.prototype.bytesPerElement=20,os(Ua,"StructArrayLayout5f20");class ja extends ma{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(Re,Le,Oe,Ue,qe,Ct,Ot){const Jt=this.length;return this.resize(Jt+1),this.emplace(Jt,Re,Le,Oe,Ue,qe,Ct,Ot)}emplace(Re,Le,Oe,Ue,qe,Ct,Ot,Jt){const Hr=7*Re;return this.float32[Hr+0]=Le,this.float32[Hr+1]=Oe,this.float32[Hr+2]=Ue,this.float32[Hr+3]=qe,this.float32[Hr+4]=Ct,this.float32[Hr+5]=Ot,this.float32[Hr+6]=Jt,Re}}ja.prototype.bytesPerElement=28,os(ja,"StructArrayLayout7f28");class Na extends ma{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(Re,Le,Oe,Ue){const qe=this.length;return this.resize(qe+1),this.emplace(qe,Re,Le,Oe,Ue)}emplace(Re,Le,Oe,Ue,qe){const Ct=6*Re;return this.uint32[3*Re+0]=Le,this.uint16[Ct+2]=Oe,this.uint16[Ct+3]=Ue,this.uint16[Ct+4]=qe,Re}}Na.prototype.bytesPerElement=12,os(Na,"StructArrayLayout1ul3ui12");class qa extends ma{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(Re){const Le=this.length;return this.resize(Le+1),this.emplace(Le,Re)}emplace(Re,Le){return this.uint16[1*Re+0]=Le,Re}}qa.prototype.bytesPerElement=2,os(qa,"StructArrayLayout1ui2");class $a extends ma{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(Re,Le){const Oe=this.length;return this.resize(Oe+1),this.emplace(Oe,Re,Le)}emplace(Re,Le,Oe){const Ue=2*Re;return this.float32[Ue+0]=Le,this.float32[Ue+1]=Oe,Re}}$a.prototype.bytesPerElement=8,os($a,"StructArrayLayout2f8");class Ga extends ma{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr,Ln,Nn,$n,Gn,qn,Zn){const Xn=this.length;return this.resize(Xn+1),this.emplace(Xn,Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr,Ln,Nn,$n,Gn,qn,Zn)}emplace(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr,Ln,Nn,$n,Gn,qn,Zn,Xn){const Yn=16*Re;return this.float32[Yn+0]=Le,this.float32[Yn+1]=Oe,this.float32[Yn+2]=Ue,this.float32[Yn+3]=qe,this.float32[Yn+4]=Ct,this.float32[Yn+5]=Ot,this.float32[Yn+6]=Jt,this.float32[Yn+7]=Hr,this.float32[Yn+8]=Jr,this.float32[Yn+9]=Ln,this.float32[Yn+10]=Nn,this.float32[Yn+11]=$n,this.float32[Yn+12]=Gn,this.float32[Yn+13]=qn,this.float32[Yn+14]=Zn,this.float32[Yn+15]=Xn,Re}}Ga.prototype.bytesPerElement=64,os(Ga,"StructArrayLayout16f64");class Xa extends ma{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(Re,Le,Oe,Ue,qe,Ct,Ot){const Jt=this.length;return this.resize(Jt+1),this.emplace(Jt,Re,Le,Oe,Ue,qe,Ct,Ot)}emplace(Re,Le,Oe,Ue,qe,Ct,Ot,Jt){const Hr=10*Re,Jr=5*Re;return this.uint16[Hr+0]=Le,this.uint16[Hr+1]=Oe,this.uint16[Hr+2]=Ue,this.uint16[Hr+3]=qe,this.float32[Jr+2]=Ct,this.float32[Jr+3]=Ot,this.float32[Jr+4]=Jt,Re}}Xa.prototype.bytesPerElement=20,os(Xa,"StructArrayLayout4ui3f20");class Ya extends ma{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(Re){const Le=this.length;return this.resize(Le+1),this.emplace(Le,Re)}emplace(Re,Le){return this.int16[1*Re+0]=Le,Re}}Ya.prototype.bytesPerElement=2,os(Ya,"StructArrayLayout1i2");class Za extends ma{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(Re){const Le=this.length;return this.resize(Le+1),this.emplace(Le,Re)}emplace(Re,Le){return this.uint8[1*Re+0]=Le,Re}}Za.prototype.bytesPerElement=1,os(Za,"StructArrayLayout1ub1");class Wa extends da{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Wa.prototype.size=40;class Ha extends Ba{get(Re){return new Wa(this,Re)}}os(Ha,"CollisionBoxArray");class Ka extends da{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(Re){this._structArray.uint8[this._pos1+49]=Re}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(Re){this._structArray.uint8[this._pos1+50]=Re}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(Re){this._structArray.uint32[this._pos4+13]=Re}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(Re){this._structArray.uint8[this._pos1+58]=Re}}Ka.prototype.size=60;class Ja extends La{get(Re){return new Ka(this,Re)}}os(Ja,"PlacedSymbolArray");class Qa extends da{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(Re){this._structArray.uint32[this._pos4+14]=Re}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(Re){this._structArray.float32[this._pos4+18]=Re}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}}Qa.prototype.size=80;class to extends Fa{get(Re){return new Qa(this,Re)}}os(to,"SymbolInstanceArray");class eo extends Oa{getoffsetX(Re){return this.float32[1*Re+0]}}os(eo,"GlyphOffsetArray");class ro extends xa{getx(Re){return this.int16[2*Re+0]}gety(Re){return this.int16[2*Re+1]}}os(ro,"SymbolLineVertexArray");class no extends da{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}no.prototype.size=12;class io extends Na{get(Re){return new no(this,Re)}}os(io,"FeatureIndexArray");class so extends Ea{geta_centroid_pos0(Re){return this.uint16[2*Re+0]}geta_centroid_pos1(Re){return this.uint16[2*Re+1]}}os(so,"FillExtrusionCentroidArray");class ao extends da{get a_join_normal_inside0(){return this._structArray.int16[this._pos2+0]}get a_join_normal_inside1(){return this._structArray.int16[this._pos2+1]}get a_join_normal_inside2(){return this._structArray.int16[this._pos2+2]}}ao.prototype.size=6;class oo extends ba{get(Re){return new ao(this,Re)}}os(oo,"FillExtrusionWallArray");const Gp=ya([{name:"a_pos",components:2,type:"Int16"}],4),qp=ya([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class co{constructor(Re=[]){this.segments=Re}_prepareSegment(Re,Le,Oe,Ue){let qe=this.segments[this.segments.length-1];return Re>co.MAX_VERTEX_ARRAY_LENGTH&&ft(`Max vertices per segment is ${co.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${Re}`),(!qe||qe.vertexLength+Re>co.MAX_VERTEX_ARRAY_LENGTH||qe.sortKey!==Ue)&&(qe={vertexOffset:Le,primitiveOffset:Oe,vertexLength:0,primitiveLength:0},void 0!==Ue&&(qe.sortKey=Ue),this.segments.push(qe)),qe}prepareSegment(Re,Le,Oe,Ue){return this._prepareSegment(Re,Le.length,Oe.length,Ue)}get(){return this.segments}destroy(){for(const Re of this.segments)for(const Le in Re.vaos)Re.vaos[Le].destroy()}static simpleSegment(Re,Le,Oe,Ue){return new co([{vertexOffset:Re,primitiveOffset:Le,vertexLength:Oe,primitiveLength:Ue,vaos:{},sortKey:0}])}}function ho(Re,Le){return 256*(Re=Q(Math.floor(Re),0,255))+Q(Math.floor(Le),0,255)}co.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,os(co,"SegmentVector");const Wp=ya([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Kp=ya([{name:"a_dash",components:4,type:"Uint16"}]);class mo{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(Re,Le,Oe,Ue){this.ids.push(yo(Re)),this.positions.push(Le,Oe,Ue)}eachPosition(Re,Le){const Oe=yo(Re);let Ue=0,qe=this.ids.length-1;for(;Ue<qe;){const Re=Ue+qe>>1;this.ids[Re]>=Oe?qe=Re:Ue=Re+1}for(;this.ids[Ue]===Oe;)Le(this.positions[3*Ue],this.positions[3*Ue+1],this.positions[3*Ue+2]),Ue++}static serialize(Re,Le){const Oe=new Float64Array(Re.ids),Ue=new Uint32Array(Re.positions);return go(Oe,Ue,0,Oe.length-1),Le&&(Le.add(Oe.buffer),Le.add(Ue.buffer)),{ids:Oe,positions:Ue}}static deserialize(Re){const Le=new mo;let Oe;Le.ids=Re.ids,Le.positions=Re.positions;for(const Re of Le.ids)Re!==Oe&&Le.uniqueIds.push(Re),Oe=Re;return Le.indexed=!0,Le}}function yo(Re){const Le=+Re;return!isNaN(Le)&&Number.MIN_SAFE_INTEGER<=Le&&Le<=Number.MAX_SAFE_INTEGER?Le:Xu(String(Re))}function go(Re,Le,Oe,Ue){for(;Oe<Ue;){const qe=Re[Oe+Ue>>1];let Ct=Oe-1,Ot=Ue+1;for(;;){do{Ct++}while(Re[Ct]<qe);do{Ot--}while(Re[Ot]>qe);if(Ct>=Ot)break;xo(Re,Ct,Ot),xo(Le,3*Ct,3*Ot),xo(Le,3*Ct+1,3*Ot+1),xo(Le,3*Ct+2,3*Ot+2)}Ot-Oe<Ue-Ot?(go(Re,Le,Oe,Ot),Oe=Ot+1):(go(Re,Le,Ot+1,Ue),Ue=Ot)}}function xo(Re,Le,Oe){const Ue=Re[Le];Re[Le]=Re[Oe],Re[Oe]=Ue}os(mo,"FeaturePositionMap");class bo{constructor(Re){this.gl=Re.gl,this.initialized=!1}fetchUniformLocation(Re,Le){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(Re,Le),this.initialized=!0),!!this.location}set(Re,Le,Oe){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class vo extends bo{constructor(Re){super(Re),this.current=0}set(Re,Le,Oe){this.fetchUniformLocation(Re,Le)&&this.current!==Oe&&(this.current=Oe,this.gl.uniform1i(this.location,Oe))}}class wo extends bo{constructor(Re){super(Re),this.current=0}set(Re,Le,Oe){this.fetchUniformLocation(Re,Le)&&this.current!==Oe&&(this.current=Oe,this.gl.uniform1f(this.location,Oe))}}class _o extends bo{constructor(Re){super(Re),this.current=[0,0]}set(Re,Le,Oe){this.fetchUniformLocation(Re,Le)&&(Oe[0]===this.current[0]&&Oe[1]===this.current[1]||(this.current=Oe,this.gl.uniform2f(this.location,Oe[0],Oe[1])))}}class Mo extends bo{constructor(Re){super(Re),this.current=[0,0,0]}set(Re,Le,Oe){this.fetchUniformLocation(Re,Le)&&(Oe[0]===this.current[0]&&Oe[1]===this.current[1]&&Oe[2]===this.current[2]||(this.current=Oe,this.gl.uniform3f(this.location,Oe[0],Oe[1],Oe[2])))}}class Ao extends bo{constructor(Re){super(Re),this.current=[0,0,0,0]}set(Re,Le,Oe){this.fetchUniformLocation(Re,Le)&&(Oe[0]===this.current[0]&&Oe[1]===this.current[1]&&Oe[2]===this.current[2]&&Oe[3]===this.current[3]||(this.current=Oe,this.gl.uniform4f(this.location,Oe[0],Oe[1],Oe[2],Oe[3])))}}class So extends bo{constructor(Re){super(Re),this.current=Pe.transparent.toRenderColor(null)}set(Re,Le,Oe){this.fetchUniformLocation(Re,Le)&&(Oe.r===this.current.r&&Oe.g===this.current.g&&Oe.b===this.current.b&&Oe.a===this.current.a||(this.current=Oe,this.gl.uniform4f(this.location,Oe.r,Oe.g,Oe.b,Oe.a)))}}const ef=new Float32Array(16);class Po extends bo{constructor(Re){super(Re),this.current=ef}set(Re,Le,Oe){if(this.fetchUniformLocation(Re,Le)){if(Oe[12]!==this.current[12]||Oe[0]!==this.current[0])return this.current=Oe,void this.gl.uniformMatrix4fv(this.location,!1,Oe);for(let Re=1;Re<16;Re++)if(Oe[Re]!==this.current[Re]){this.current=Oe,this.gl.uniformMatrix4fv(this.location,!1,Oe);break}}}}const tf=new Float32Array(9),rf=new Float32Array(4);class To extends bo{constructor(Re){super(Re),this.current=rf}set(Re,Le,Oe){if(this.fetchUniformLocation(Re,Le))for(let Re=0;Re<4;Re++)if(Oe[Re]!==this.current[Re]){this.current=Oe,this.gl.uniformMatrix2fv(this.location,!1,Oe);break}}}function Eo(Re){return[ho(255*Re.r,255*Re.g),ho(255*Re.b,255*Re.a)]}class Bo{constructor(Re,Le,Oe,Ue){this.value=Re,this.uniformNames=Le.map((Re=>`u_${Re}`)),this.type=Oe,this.context=Ue}setUniform(Re,Le,Oe,Ue,qe){const Ct=Ue.constantOr(this.value);Le.set(Re,qe,Ct instanceof Pe?Ct.toRenderColor(this.context.lut):Ct)}getBinding(Re,Le){return"color"===this.type?new So(Re):new wo(Re)}}class Vo{constructor(Re,Le){this.uniformNames=Le.map((Re=>`u_${Re}`)),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(Re){this.pixelRatio=Re.pixelRatio||1,this.pattern=Re.tl.concat(Re.br)}setUniform(Re,Le,Oe,Ue,qe){const Ct="u_pattern"===qe||"u_dash"===qe?this.pattern:"u_pixel_ratio"===qe?this.pixelRatio:null;Ct&&Le.set(Re,qe,Ct)}getBinding(Re,Le){return"u_pattern"===Le||"u_dash"===Le?new Ao(Re):new wo(Re)}}class Co{constructor(Re,Le,Oe,Ue){this.expression=Re,this.type=Oe,this.maxValue=0,this.paintVertexAttributes=Le.map((Re=>({name:`a_${Re}`,type:"Float32",components:"color"===Oe?2:1,offset:0}))),this.paintVertexArray=new Ue}populatePaintArray(Re,Le,Oe,Ue,qe,Ct,Ot){const Jt=this.paintVertexArray.length,Hr=this.expression.evaluate(new Vs(0,{brightness:Ct}),Le,{},qe,Ue,Ot);this.paintVertexArray.resize(Re),this._setPaintValue(Jt,Re,Hr,this.context)}updatePaintArray(Re,Le,Oe,Ue,qe,Ct,Ot){const Jt=this.expression.evaluate({zoom:0,brightness:Ot},Oe,Ue,void 0,qe);this._setPaintValue(Re,Le,Jt,this.context)}_setPaintValue(Re,Le,Oe,Ue){if("color"===this.type){const qe=Eo(Oe.toRenderColor(Ue.lut));for(let Oe=Re;Oe<Le;Oe++)this.paintVertexArray.emplace(Oe,qe[0],qe[1])}else{for(let Ue=Re;Ue<Le;Ue++)this.paintVertexArray.emplace(Ue,Oe);this.maxValue=Math.max(this.maxValue,Math.abs(Oe))}}upload(Re){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=Re.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ro{constructor(Re,Le,Oe,Ue,qe,Ct){this.expression=Re,this.uniformNames=Le.map((Re=>`u_${Re}_t`)),this.type=Oe,this.useIntegerZoom=Ue,this.context=qe,this.maxValue=0,this.paintVertexAttributes=Le.map((Re=>({name:`a_${Re}`,type:"Float32",components:"color"===Oe?4:2,offset:0}))),this.paintVertexArray=new Ct}populatePaintArray(Re,Le,Oe,Ue,qe,Ct,Ot){const Jt=this.expression.evaluate(new Vs(this.context.zoom,{brightness:Ct}),Le,{},qe,Ue,Ot),Hr=this.expression.evaluate(new Vs(this.context.zoom+1,{brightness:Ct}),Le,{},qe,Ue,Ot),Jr=this.paintVertexArray.length;this.paintVertexArray.resize(Re),this._setPaintValue(Jr,Re,Jt,Hr,this.context)}updatePaintArray(Re,Le,Oe,Ue,qe,Ct,Ot){const Jt=this.expression.evaluate({zoom:this.context.zoom,brightness:Ot},Oe,Ue,void 0,qe),Hr=this.expression.evaluate({zoom:this.context.zoom+1,brightness:Ot},Oe,Ue,void 0,qe);this._setPaintValue(Re,Le,Jt,Hr,this.context)}_setPaintValue(Re,Le,Oe,Ue,qe){if("color"===this.type){const Ue=Eo(Oe.toRenderColor(qe.lut)),Ct=Eo(Oe.toRenderColor(qe.lut));for(let Oe=Re;Oe<Le;Oe++)this.paintVertexArray.emplace(Oe,Ue[0],Ue[1],Ct[0],Ct[1])}else{for(let qe=Re;qe<Le;qe++)this.paintVertexArray.emplace(qe,Oe,Ue);this.maxValue=Math.max(this.maxValue,Math.abs(Oe),Math.abs(Ue))}}upload(Re){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=Re.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(Re,Le,Oe,Ue,qe){const Ct=this.useIntegerZoom?Math.floor(Oe.zoom):Oe.zoom,Ot=Q(this.expression.interpolationFactor(Ct,this.context.zoom,this.context.zoom+1),0,1);Le.set(Re,qe,Ot)}getBinding(Re,Le){return new wo(Re)}}class Do{constructor(Re,Le,Oe,Ue,qe){this.expression=Re,this.layerId=qe,this.paintVertexAttributes=("array"===Oe?Kp:Wp).members;for(let Re=0;Re<Le.length;++Re);this.paintVertexArray=new Ue}populatePaintArray(Re,Le,Oe,Ue){const qe=this.paintVertexArray.length;this.paintVertexArray.resize(Re),this._setPaintValues(qe,Re,Le.patterns&&Le.patterns[this.layerId],Oe)}updatePaintArray(Re,Le,Oe,Ue,qe,Ct,Ot){this._setPaintValues(Re,Le,Oe.patterns&&Oe.patterns[this.layerId],Ct)}_setPaintValues(Re,Le,Oe,Ue){if(!Ue||!Oe)return;const qe=Ue[Oe];if(!qe)return;const{tl:Ct,br:Ot,pixelRatio:Jt}=qe;for(let Oe=Re;Oe<Le;Oe++)this.paintVertexArray.emplace(Oe,Ct[0],Ct[1],Ot[0],Ot[1],Jt)}upload(Re){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=Re.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Lo{constructor(Re,Le,Oe=()=>!0){this.binders={},this._buffers=[],this.context=Le;const Ue=[];for(const qe in Re.paint._values){const Ct=Re.paint.get(qe);if(!Oe(qe))continue;if(!(Ct instanceof Us&&Di(Ct.property.specification)))continue;const Ot=Uo(qe,Re.type),Jt=Ct.value,Hr=Ct.property.specification.type,Jr=!!Ct.property.useIntegerZoom,Ln="line-dasharray"===qe||qe.endsWith("pattern"),Nn="line-dasharray"===qe&&"constant"!==Re.layout.get("line-cap").value.kind;if("constant"!==Jt.kind||Nn)if("source"===Jt.kind||Nn||Ln){const Le=qo(qe,Hr,"source");this.binders[qe]=Ln?new Do(Jt,Ot,Hr,Le,Re.id):new Co(Jt,Ot,Hr,Le),Ue.push(`/a_${qe}`)}else{const Re=qo(qe,Hr,"composite");this.binders[qe]=new Ro(Jt,Ot,Hr,Jr,Le,Re),Ue.push(`/z_${qe}`)}else this.binders[qe]=Ln?new Vo(Jt.value,Ot):new Bo(Jt.value,Ot,Hr,Le),Ue.push(`/u_${qe}`)}this.cacheKey=Ue.sort().join("")}getMaxValue(Re){const Le=this.binders[Re];return Le instanceof Co||Le instanceof Ro?Le.maxValue:0}populatePaintArrays(Re,Le,Oe,Ue,qe,Ct,Ot){for(const Jt in this.binders){const Hr=this.binders[Jt];Hr.context=this.context,(Hr instanceof Co||Hr instanceof Ro||Hr instanceof Do)&&Hr.populatePaintArray(Re,Le,Oe,Ue,qe,Ct,Ot)}}setConstantPatternPositions(Re){for(const Le in this.binders){const Oe=this.binders[Le];Oe instanceof Vo&&Oe.setConstantPatternPositions(Re)}}updatePaintArrays(Re,Le,Oe,Ue,qe,Ct,Ot,Jt){let Hr=!1;const Jr=Object.keys(Re),Ln=0!==Jr.length,Nn=Ln?Jr:Le.uniqueIds;this.context.lut=qe.lut;for(const Jr in this.binders){const $n=this.binders[Jr];if($n.context=this.context,($n instanceof Co||$n instanceof Ro||$n instanceof Do)&&(!0===$n.expression.isStateDependent||!1===$n.expression.isLightConstant)){const Gn=qe.paint.get(Jr);$n.expression=Gn.value;for(const Oe of Nn){const qe=Re[Oe.toString()];Le.eachPosition(Oe,((Re,Le,Oe)=>{const Hr=Ue.feature(Re);$n.updatePaintArray(Le,Oe,Hr,qe,Ct,Ot,Jt)}))}if(!Ln)for(const Le of Oe.uniqueIds){const qe=Re[Le.toString()];Oe.eachPosition(Le,((Re,Le,Oe)=>{const Hr=Ue.feature(Re);$n.updatePaintArray(Le,Oe,Hr,qe,Ct,Ot,Jt)}))}Hr=!0}}return Hr}defines(){const Re=[];for(const Le in this.binders){const Oe=this.binders[Le];(Oe instanceof Bo||Oe instanceof Vo)&&Re.push(...Oe.uniformNames.map((Re=>`#define HAS_UNIFORM_${Re}`)))}return Re}getBinderAttributes(){const Re=[];for(const Le in this.binders){const Oe=this.binders[Le];if(Oe instanceof Co||Oe instanceof Ro||Oe instanceof Do)for(let Le=0;Le<Oe.paintVertexAttributes.length;Le++)Re.push(Oe.paintVertexAttributes[Le].name)}return Re}getBinderUniforms(){const Re=[];for(const Le in this.binders){const Oe=this.binders[Le];if(Oe instanceof Bo||Oe instanceof Vo||Oe instanceof Ro)for(const Le of Oe.uniformNames)Re.push(Le)}return Re}getPaintVertexBuffers(){return this._buffers}getUniforms(Re){const Le=[];for(const Oe in this.binders){const Ue=this.binders[Oe];if(Ue instanceof Bo||Ue instanceof Vo||Ue instanceof Ro)for(const qe of Ue.uniformNames)Le.push({name:qe,property:Oe,binding:Ue.getBinding(Re,qe)})}return Le}setUniforms(Re,Le,Oe,Ue,qe){for(const{name:Le,property:Ct,binding:Ot}of Oe)this.binders[Ct].setUniform(Re,Ot,qe,Ue.get(Ct),Le)}updatePaintBuffers(){this._buffers=[];for(const Re in this.binders){const Le=this.binders[Re];(Le instanceof Co||Le instanceof Ro||Le instanceof Do)&&Le.paintVertexBuffer&&this._buffers.push(Le.paintVertexBuffer)}}upload(Re){for(const Le in this.binders){const Oe=this.binders[Le];(Oe instanceof Co||Oe instanceof Ro||Oe instanceof Do)&&Oe.upload(Re)}this.updatePaintBuffers()}destroy(){for(const Re in this.binders){const Le=this.binders[Re];(Le instanceof Co||Le instanceof Ro||Le instanceof Do)&&Le.destroy()}}}class Fo{constructor(Re,Le,Oe=()=>!0){this.programConfigurations={};for(const Ue of Re)this.programConfigurations[Ue.id]=new Lo(Ue,Le,Oe);this.needsUpload=!1,this._featureMap=new mo,this._featureMapWithoutIds=new mo,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(Re,Le,Oe,Ue,qe,Ct,Ot,Jt){for(const Oe in this.programConfigurations)this.programConfigurations[Oe].populatePaintArrays(Re,Le,Ue,qe,Ct,Ot,Jt);void 0!==Le.id?this._featureMap.add(Le.id,Oe,this._bufferOffset,Re):(this._featureMapWithoutIds.add(this._idlessCounter,Oe,this._bufferOffset,Re),this._idlessCounter+=1),this._bufferOffset=Re,this.needsUpload=!0}updatePaintArrays(Re,Le,Oe,Ue,qe,Ct){for(const Ot of Oe)this.needsUpload=this.programConfigurations[Ot.id].updatePaintArrays(Re,this._featureMap,this._featureMapWithoutIds,Le,Ot,Ue,qe,Ct||0)||this.needsUpload}get(Re){return this.programConfigurations[Re]}upload(Re){if(this.needsUpload){for(const Le in this.programConfigurations)this.programConfigurations[Le].upload(Re);this.needsUpload=!1}}destroy(){for(const Re in this.programConfigurations)this.programConfigurations[Re].destroy()}}const nf={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"symbol-z-offset":["z_offset"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function Uo(Re,Le){return nf[Re]||[Re.replace(`${Le}-`,"").replace(/-/g,"_")]}const of={"line-pattern":{source:Sa,composite:Sa},"fill-pattern":{source:Sa,composite:Sa},"fill-extrusion-pattern":{source:Sa,composite:Sa},"line-dasharray":{source:Ia,composite:Ia}},lf={color:{source:$a,composite:Ma},number:{source:Oa,composite:$a}};function qo(Re,Le,Oe){const Ue=of[Re];return Ue&&Ue[Oe]||lf[Le][Oe]}os(Bo,"ConstantBinder"),os(Vo,"PatternConstantBinder"),os(Co,"SourceExpressionBinder"),os(Do,"PatternCompositeBinder"),os(Ro,"CompositeExpressionBinder"),os(Lo,"ProgramConfiguration",{omit:["_buffers"]}),os(Fo,"ProgramConfigurationSet");const pf=id/Math.PI/2,ff=5,gf=6,xf=16383,Ff=64,jf=[Ff,32,16],$f=-pf,Gf=pf;function Jo(Re,Le,Oe,Ue=pf){return Oe=Y(Oe),[Re*Math.sin(Oe)*Ue,-Le*Ue,Re*Math.cos(Oe)*Ue]}function Qo(Re,Le,Oe){return Jo(Math.cos(Y(Re)),Math.sin(Y(Re)),Le,Oe)}const Yf=6371008.8,em=2*Math.PI*Yf;class rl{constructor(Re,Le){if(isNaN(Re)||isNaN(Le))throw new Error(`Invalid LngLat object: (${Re}, ${Le})`);if(this.lng=+Re,this.lat=+Le,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new rl(et(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(Re){const Le=Math.PI/180,Oe=this.lat*Le,Ue=Re.lat*Le,qe=Math.sin(Oe)*Math.sin(Ue)+Math.cos(Oe)*Math.cos(Ue)*Math.cos((Re.lng-this.lng)*Le);return Yf*Math.acos(Math.min(qe,1))}toBounds(Re=0){const Le=360*Re/40075017,Oe=Le/Math.cos(Math.PI/180*this.lat);return new nl({lng:this.lng-Oe,lat:this.lat-Le},{lng:this.lng+Oe,lat:this.lat+Le})}toEcef(Re){return Qo(this.lat,this.lng,pf+Re*pf/Yf)}static convert(Re){if(Re instanceof rl)return Re;if(Array.isArray(Re)&&(2===Re.length||3===Re.length))return new rl(Number(Re[0]),Number(Re[1]));if(!Array.isArray(Re)&&"object"==typeof Re&&null!==Re)return new rl(Number("lng"in Re?Re.lng:Re.lon),Number(Re.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class nl{constructor(Re,Le){if(Re)if(Le)this.setSouthWest(Re).setNorthEast(Le);else if(4===Re.length){const Le=Re;this.setSouthWest([Le[0],Le[1]]).setNorthEast([Le[2],Le[3]])}else{const Le=Re;this.setSouthWest(Le[0]).setNorthEast(Le[1])}}setNorthEast(Re){return this._ne=Re instanceof rl?new rl(Re.lng,Re.lat):rl.convert(Re),this}setSouthWest(Re){return this._sw=Re instanceof rl?new rl(Re.lng,Re.lat):rl.convert(Re),this}extend(Re){const Le=this._sw,Oe=this._ne;let Ue,qe;if(Re instanceof rl)Ue=Re,qe=Re;else{if(!(Re instanceof nl))return Array.isArray(Re)?4===Re.length||Re.every(Array.isArray)?this.extend(nl.convert(Re)):this.extend(rl.convert(Re)):"object"==typeof Re&&null!==Re&&Re.hasOwnProperty("lat")&&(Re.hasOwnProperty("lon")||Re.hasOwnProperty("lng"))?this.extend(rl.convert(Re)):this;if(Ue=Re._sw,qe=Re._ne,!Ue||!qe)return this}return Le||Oe?(Le.lng=Math.min(Ue.lng,Le.lng),Le.lat=Math.min(Ue.lat,Le.lat),Oe.lng=Math.max(qe.lng,Oe.lng),Oe.lat=Math.max(qe.lat,Oe.lat)):(this._sw=new rl(Ue.lng,Ue.lat),this._ne=new rl(qe.lng,qe.lat)),this}getCenter(){return new rl((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new rl(this.getWest(),this.getNorth())}getSouthEast(){return new rl(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(Re){const{lng:Le,lat:Oe}=rl.convert(Re);let Ue=this._sw.lng<=Le&&Le<=this._ne.lng;return this._sw.lng>this._ne.lng&&(Ue=this._sw.lng>=Le&&Le>=this._ne.lng),this._sw.lat<=Oe&&Oe<=this._ne.lat&&Ue}static convert(Re){if(Re)return Re instanceof nl?Re:new nl(Re)}}const rm=0,nm=25.5;function al(Re){return em*Math.cos(Re*Math.PI/180)}function ol(Re){return(180+Re)/360}function ll(Re){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+Re*Math.PI/360)))/360}function ul(Re,Le){return Re/al(Le)}function cl(Re){return 360*Re-180}function hl(Re){return 360/Math.PI*Math.atan(Math.exp((180-360*Re)*Math.PI/180))-90}function pl(Re,Le){return Re*al(hl(Le))}const im=85.051129;function dl(Re){return Math.cos(Y(Q(Re,-im,im)))}function ml(Re,Le){const Oe=Q(Le,rm,nm),Ue=Math.pow(2,Oe);return dl(Re)*em/(512*Ue)}function yl(Re){return 1/Math.cos(Re*Math.PI/180)}function gl(Re,Le=0){const Oe=Math.exp(Math.PI*(1-(Re.y+Le/id)/(1<<Re.z)*2));return 80150034*Oe/(Oe*Oe+1)/id/(1<<Re.z)}class xl{constructor(Re,Le,Oe=0){this.x=+Re,this.y=+Le,this.z=+Oe}static fromLngLat(Re,Le=0){const Oe=rl.convert(Re);return new xl(ol(Oe.lng),ll(Oe.lat),ul(Le,Oe.lat))}toLngLat(){return new rl(cl(this.x),hl(this.y))}toAltitude(){return pl(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/em*yl(hl(this.y))}}function bl(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr){const Jr=(Le+Ue)/2,Ln=(Oe+qe)/2,Nn=new Is(Jr,Ln);Jt(Nn),function(Re,Le,Oe,Ue,qe,Ct){const Ot=Oe-qe,Jt=Ue-Ct;return Math.abs((Ue-Le)*Ot-(Oe-Re)*Jt)/Math.hypot(Ot,Jt)}(Nn.x,Nn.y,Ct.x,Ct.y,Ot.x,Ot.y)>=Hr?(bl(Re,Le,Oe,Jr,Ln,Ct,Nn,Jt,Hr),bl(Re,Jr,Ln,Ue,qe,Nn,Ot,Jt,Hr)):Re.push(Ot)}function vl(Re,Le,Oe){let Ue=Re[0],qe=Ue.x,Ct=Ue.y;Le(Ue);const Ot=[Ue];for(let Jt=1;Jt<Re.length;Jt++){const Hr=Re[Jt],{x:Jr,y:Ln}=Hr;Le(Hr),bl(Ot,qe,Ct,Jr,Ln,Ue,Hr,Le,Oe),qe=Jr,Ct=Ln,Ue=Hr}return Ot}function wl(Re,Le,Oe,Ue){if(Ue(Le,Oe)){const qe=Le.add(Oe)._mult(.5);wl(Re,Le,qe,Ue),wl(Re,qe,Oe,Ue)}else Re.push(Oe)}function _l(Re,Le){let Oe=Re[0];const Ue=[Oe];for(let qe=1;qe<Re.length;qe++){const Ct=Re[qe];wl(Ue,Oe,Ct,Le),Oe=Ct}return Ue}const sm=Math.pow(2,14)-1,dm=-sm-1;function Sl(Re,Le){const Oe=Math.round(Re.x*Le),Ue=Math.round(Re.y*Le);return Re.x=Q(Oe,dm,sm),Re.y=Q(Ue,dm,sm),(Oe<Re.x||Oe>Re.x+1||Ue<Re.y||Ue>Re.y+1)&&ft("Geometry exceeds allowed extent, reduce your vector tile buffer size"),Re}function Il(Re,Le,Oe){const Ue=Re.loadGeometry(),qe=Re.extent,Ct=id/qe;if(Le&&Oe&&Oe.projection.isReprojectedInTileSpace){const Ct=1<<Le.z,{scale:Ot,x:Jt,y:Hr,projection:Jr}=Oe,c=Re=>{const Oe=cl((Le.x+Re.x/qe)/Ct),Ue=hl((Le.y+Re.y/qe)/Ct),Ln=Jr.project(Oe,Ue);Re.x=(Ln.x*Ot-Jt)*qe,Re.y=(Ln.y*Ot-Hr)*qe};for(let Le=0;Le<Ue.length;Le++)if(1!==Re.type)Ue[Le]=vl(Ue[Le],c,1);else{const Re=[];for(const Oe of Ue[Le])Oe.x<0||Oe.x>=qe||Oe.y<0||Oe.y>=qe||(c(Oe),Re.push(Oe));Ue[Le]=Re}}for(const Re of Ue)for(const Le of Re)Sl(Le,Ct);return Ue}function Pl(Re,Le){return{type:Re.type,id:Re.id,properties:Re.properties,geometry:Le?Il(Re):[]}}function zl(Re,Le,Oe,Ue,qe){Re.emplaceBack(2*Le+(Ue+1)/2,2*Oe+(qe+1)/2)}function kl(Re,Le,Oe){const Ue=16384;Re.emplaceBack(Le.x,Le.y,Le.z,Oe[0]*Ue,Oe[1]*Ue,Oe[2]*Ue)}class Tl{constructor(Re){this.zoom=Re.zoom,this.overscaling=Re.overscaling,this.layers=Re.layers,this.layerIds=this.layers.map((Re=>Re.fqid)),this.index=Re.index,this.hasPattern=!1,this.projection=Re.projection,this.layoutVertexArray=new xa,this.indexArray=new Da,this.segments=new co,this.programConfigurations=new Fo(Re.layers,{zoom:Re.zoom,lut:Re.lut}),this.stateDependentLayerIds=this.layers.filter((Re=>Re.isStateDependent())).map((Re=>Re.id))}updateFootprints(Re,Le){}populate(Re,Le,Oe,Ue){const qe=this.layers[0],Ct=[];let Ot=null;"circle"===qe.type&&(Ot=qe.layout.get("circle-sort-key"));for(const{feature:Le,id:qe,index:Jt,sourceLayerIndex:Hr}of Re){const Re=this.layers[0]._featureFilter.needGeometry,Jr=Pl(Le,Re);if(!this.layers[0]._featureFilter.filter(new Vs(this.zoom),Jr,Oe))continue;const Ln=Ot?Ot.evaluate(Jr,{},Oe):void 0,Nn={id:qe,properties:Le.properties,type:Le.type,sourceLayerIndex:Hr,index:Jt,geometry:Re?Jr.geometry:Il(Le,Oe,Ue),patterns:{},sortKey:Ln};Ct.push(Nn)}Ot&&Ct.sort(((Re,Le)=>Re.sortKey-Le.sortKey));let Jt=null;"globe"===Ue.projection.name&&(this.globeExtVertexArray=new Pa,Jt=Ue.projection);for(const Ue of Ct){const{geometry:qe,index:Ct,sourceLayerIndex:Ot}=Ue,Hr=Re[Ct].feature;this.addFeature(Ue,qe,Ct,Le.availableImages,Oe,Jt,Le.brightness),Le.featureIndex.insert(Hr,qe,Ct,Ot,this.index)}}update(Re,Le,Oe,Ue,qe){const Ct=0!==Object.keys(Re).length;Ct&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(Re,Le,Ct?this.stateDependentLayers:this.layers,Oe,Ue,qe)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(Re){this.uploaded||(this.layoutVertexBuffer=Re.createVertexBuffer(this.layoutVertexArray,Gp.members),this.indexBuffer=Re.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=Re.createVertexBuffer(this.globeExtVertexArray,qp.members))),this.programConfigurations.upload(Re),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(Re,Le,Oe,Ue,qe,Ct,Ot){for(const Oe of Le)for(const Le of Oe){const Oe=Le.x,Ue=Le.y;if(Oe<0||Oe>=id||Ue<0||Ue>=id)continue;if(Ct){const Re=Ct.projectTilePoint(Oe,Ue,qe),Le=Ct.upVector(qe,Oe,Ue),Ot=this.globeExtVertexArray;kl(Ot,Re,Le),kl(Ot,Re,Le),kl(Ot,Re,Le),kl(Ot,Re,Le)}const Ot=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,Re.sortKey),Jt=Ot.vertexLength;zl(this.layoutVertexArray,Oe,Ue,-1,-1),zl(this.layoutVertexArray,Oe,Ue,1,-1),zl(this.layoutVertexArray,Oe,Ue,1,1),zl(this.layoutVertexArray,Oe,Ue,-1,1),this.indexArray.emplaceBack(Jt,Jt+1,Jt+2),this.indexArray.emplaceBack(Jt,Jt+2,Jt+3),Ot.vertexLength+=4,Ot.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,Re,Oe,{},Ue,qe,Ot)}}function El(Re,Le){for(let Oe=0;Oe<Re.length;Oe++)if(Ul(Le,Re[Oe]))return!0;for(let Oe=0;Oe<Le.length;Oe++)if(Ul(Re,Le[Oe]))return!0;return!!Rl(Re,Le)}function Bl(Re,Le,Oe){return!!Ul(Re,Le)||!!Ll(Le,Re,Oe)}function Vl(Re,Le){if(1===Re.length)return Ol(Le,Re[0]);for(let Oe=0;Oe<Le.length;Oe++){const Ue=Le[Oe];for(let Le=0;Le<Ue.length;Le++)if(Ul(Re,Ue[Le]))return!0}for(let Oe=0;Oe<Re.length;Oe++)if(Ol(Le,Re[Oe]))return!0;for(let Oe=0;Oe<Le.length;Oe++)if(Rl(Re,Le[Oe]))return!0;return!1}function Cl(Re,Le,Oe){if(Re.length>1){if(Rl(Re,Le))return!0;for(let Ue=0;Ue<Le.length;Ue++)if(Ll(Le[Ue],Re,Oe))return!0}for(let Ue=0;Ue<Re.length;Ue++)if(Ll(Re[Ue],Le,Oe))return!0;return!1}function Rl(Re,Le){if(0===Re.length||0===Le.length)return!1;for(let Oe=0;Oe<Re.length-1;Oe++){const Ue=Re[Oe],qe=Re[Oe+1];for(let Re=0;Re<Le.length-1;Re++)if(Dl(Ue,qe,Le[Re],Le[Re+1]))return!0}return!1}function Dl(Re,Le,Oe,Ue){return dt(Re,Oe,Ue)!==dt(Le,Oe,Ue)&&dt(Re,Le,Oe)!==dt(Re,Le,Ue)}function Ll(Re,Le,Oe){const Ue=Oe*Oe;if(1===Le.length)return Re.distSqr(Le[0])<Ue;for(let Oe=1;Oe<Le.length;Oe++)if(Fl(Re,Le[Oe-1],Le[Oe])<Ue)return!0;return!1}function Fl(Re,Le,Oe){const Ue=Le.distSqr(Oe);if(0===Ue)return Re.distSqr(Le);const qe=((Re.x-Le.x)*(Oe.x-Le.x)+(Re.y-Le.y)*(Oe.y-Le.y))/Ue;return Re.distSqr(qe<0?Le:qe>1?Oe:Oe.sub(Le)._mult(qe)._add(Le))}function Ol(Re,Le){let Oe,Ue,qe,Ct=!1;for(let Ot=0;Ot<Re.length;Ot++){Oe=Re[Ot];for(let Re=0,Ot=Oe.length-1;Re<Oe.length;Ot=Re++)Ue=Oe[Re],qe=Oe[Ot],Ue.y>Le.y!=qe.y>Le.y&&Le.x<(qe.x-Ue.x)*(Le.y-Ue.y)/(qe.y-Ue.y)+Ue.x&&(Ct=!Ct)}return Ct}function Ul(Re,Le){let Oe=!1;for(let Ue=0,qe=Re.length-1;Ue<Re.length;qe=Ue++){const Ct=Re[Ue],Ot=Re[qe];Ct.y>Le.y!=Ot.y>Le.y&&Le.x<(Ot.x-Ct.x)*(Le.y-Ct.y)/(Ot.y-Ct.y)+Ct.x&&(Oe=!Oe)}return Oe}function jl(Re,Le,Oe,Ue,qe){for(const Ct of Re)if(Le<=Ct.x&&Oe<=Ct.y&&Ue>=Ct.x&&qe>=Ct.y)return!0;const Ct=[new Is(Le,Oe),new Is(Le,qe),new Is(Ue,qe),new Is(Ue,Oe)];if(Re.length>2)for(const Le of Ct)if(Ul(Re,Le))return!0;for(let Le=0;Le<Re.length-1;Le++)if(Nl(Re[Le],Re[Le+1],Ct))return!0;return!1}function Nl(Re,Le,Oe){const Ue=Oe[0],qe=Oe[2];if(Re.x<Ue.x&&Le.x<Ue.x||Re.x>qe.x&&Le.x>qe.x||Re.y<Ue.y&&Le.y<Ue.y||Re.y>qe.y&&Le.y>qe.y)return!1;const Ct=dt(Re,Le,Oe[0]);return Ct!==dt(Re,Le,Oe[1])||Ct!==dt(Re,Le,Oe[2])||Ct!==dt(Re,Le,Oe[3])}function ql(Re,Le,Oe,Ue,qe,Ct){let Ot=Le.y-Re.y,Jt=Re.x-Le.x;if(Ct=Ct||0){const Re=Ot*Ot+Jt*Jt;if(0===Re)return!0;const Le=Math.sqrt(Re);Ot/=Le,Jt/=Le}return!((Oe.x-Re.x)*Ot+(Oe.y-Re.y)*Jt-Ct<0||(Ue.x-Re.x)*Ot+(Ue.y-Re.y)*Jt-Ct<0||(qe.x-Re.x)*Ot+(qe.y-Re.y)*Jt-Ct<0)}function $l(Re,Le,Oe,Ue,qe,Ct,Ot){return!(ql(Re,Le,Ue,qe,Ct,Ot)||ql(Le,Oe,Ue,qe,Ct,Ot)||ql(Oe,Re,Ue,qe,Ct,Ot)||ql(Ue,qe,Re,Le,Oe,Ot)||ql(qe,Ct,Re,Le,Oe,Ot)||ql(Ct,Ue,Re,Le,Oe,Ot))}function Gl(Re,Le,Oe){const Ue=Le.paint.get(Re).value;return"constant"===Ue.kind?Ue.value:Oe.programConfigurations.get(Le.id).getMaxValue(Re)}function Xl(Re){return Math.sqrt(Re[0]*Re[0]+Re[1]*Re[1])}function Yl(Re,Le,Oe,Ue,qe){if(!Le[0]&&!Le[1])return Re;const Ct=Is.convert(Le)._mult(qe);"viewport"===Oe&&Ct._rotate(-Ue);const Ot=[];for(let Le=0;Le<Re.length;Le++)Ot.push(Re[Le].sub(Ct));return Ot}function Zl(Re,Le,Oe,Ue){const qe=Is.convert(Re)._mult(Ue);return"viewport"===Le&&qe._rotate(-Oe),qe}let gm,ym;os(Tl,"CircleBucket",{omit:["layers"]});var vm,xm={exports:{}},bm=(vm||(vm=1,function(Re,Le){!function(Re){function e(Re,Le,Oe){var Ue=r(256*Re,256*(Le=Math.pow(2,Oe)-Le-1),Oe),qe=r(256*(Re+1),256*(Le+1),Oe);return Ue[0]+","+Ue[1]+","+qe[0]+","+qe[1]}function r(Re,Le,Oe){var Ue=2*Math.PI*6378137/256/Math.pow(2,Oe);return[Re*Ue-2*Math.PI*6378137/2,Le*Ue-2*Math.PI*6378137/2]}Re.getURL=function(Re,Le,Oe,Ue,qe,Ct){return Ct=Ct||{},Re+"?"+["bbox="+e(Oe,Ue,qe),"format="+(Ct.format||"image/png"),"service="+(Ct.service||"WMS"),"version="+(Ct.version||"1.1.1"),"request="+(Ct.request||"GetMap"),"srs="+(Ct.srs||"EPSG:3857"),"width="+(Ct.width||256),"height="+(Ct.height||256),"layers="+Le].join("&")},Re.getTileBBox=e,Re.getMercCoords=r,Object.defineProperty(Re,"__esModule",{value:!0})}(Le)}(0,xm.exports)),xm.exports);class tu{constructor(Re,Le,Oe){this.z=Re,this.x=Le,this.y=Oe,this.key=nu(0,Re,Re,Le,Oe)}equals(Re){return this.z===Re.z&&this.x===Re.x&&this.y===Re.y}url(Re,Le){const Oe=bm.getTileBBox(this.x,this.y,this.z),Ue=function(Re,Le,Oe){let Ue,qe="";for(let Ct=Re;Ct>0;Ct--)Ue=1<<Ct-1,qe+=(Le&Ue?1:0)+(Oe&Ue?2:0);return qe}(this.z,this.x,this.y);return Re[(this.x+this.y)%Re.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===Le?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",Ue).replace("{bbox-epsg-3857}",Oe)}toString(){return`${this.z}/${this.x}/${this.y}`}}class eu{constructor(Re,Le){this.wrap=Re,this.canonical=Le,this.key=nu(Re,Le.z,Le.z,Le.x,Le.y)}}class ru{constructor(Re,Le,Oe,Ue,qe){this.overscaledZ=Re,this.wrap=Le,this.canonical=new tu(Oe,+Ue,+qe),this.key=0===Le&&Re===Oe?this.canonical.key:nu(Le,Re,Oe,Ue,qe)}equals(Re){return this.overscaledZ===Re.overscaledZ&&this.wrap===Re.wrap&&this.canonical.equals(Re.canonical)}scaledTo(Re){const Le=this.canonical.z-Re;return Re>this.canonical.z?new ru(Re,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ru(Re,this.wrap,Re,this.canonical.x>>Le,this.canonical.y>>Le)}calculateScaledKey(Re,Le=!0){if(this.overscaledZ===Re&&Le)return this.key;if(Re>this.canonical.z)return nu(this.wrap*+Le,Re,this.canonical.z,this.canonical.x,this.canonical.y);{const Oe=this.canonical.z-Re;return nu(this.wrap*+Le,Re,Re,this.canonical.x>>Oe,this.canonical.y>>Oe)}}isChildOf(Re){if(Re.wrap!==this.wrap)return!1;const Le=this.canonical.z-Re.canonical.z;return 0===Re.overscaledZ||Re.overscaledZ<this.overscaledZ&&Re.canonical.z<this.canonical.z&&Re.canonical.x===this.canonical.x>>Le&&Re.canonical.y===this.canonical.y>>Le}children(Re){if(this.overscaledZ>=Re)return[new ru(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const Le=this.canonical.z+1,Oe=2*this.canonical.x,Ue=2*this.canonical.y;return[new ru(Le,this.wrap,Le,Oe,Ue),new ru(Le,this.wrap,Le,Oe+1,Ue),new ru(Le,this.wrap,Le,Oe,Ue+1),new ru(Le,this.wrap,Le,Oe+1,Ue+1)]}isLessThan(Re){return this.wrap<Re.wrap||!(this.wrap>Re.wrap)&&(this.overscaledZ<Re.overscaledZ||!(this.overscaledZ>Re.overscaledZ)&&(this.canonical.x<Re.canonical.x||!(this.canonical.x>Re.canonical.x)&&this.canonical.y<Re.canonical.y))}wrapped(){return new ru(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(Re){return new ru(this.overscaledZ,Re,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new eu(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function nu(Re,Le,Oe,Ue,qe){const Ct=1<<Math.min(Oe,22);let Ot=Ct*(qe%Ct)+Ue%Ct;return Re&&Oe<22&&(Ot+=Ct*Ct*((Re<0?-2*Re-1:2*Re)%(1<<2*(22-Oe)))),16*(32*Ot+Oe)+(Le-Oe)}const Cm=[Re=>{let Le=Re.canonical.x-1,Oe=Re.wrap;return Le<0&&(Le=(1<<Re.canonical.z)-1,Oe--),new ru(Re.overscaledZ,Oe,Re.canonical.z,Le,Re.canonical.y)},Re=>{let Le=Re.canonical.x+1,Oe=Re.wrap;return Le===1<<Re.canonical.z&&(Le=0,Oe++),new ru(Re.overscaledZ,Oe,Re.canonical.z,Le,Re.canonical.y)},Re=>new ru(Re.overscaledZ,Re.wrap,Re.canonical.z,Re.canonical.x,(0===Re.canonical.y?1<<Re.canonical.z:Re.canonical.y)-1),Re=>new ru(Re.overscaledZ,Re.wrap,Re.canonical.z,Re.canonical.x,Re.canonical.y===(1<<Re.canonical.z)-1?0:Re.canonical.y+1)];os(tu,"CanonicalTileID"),os(ru,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const Pm=ya([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:Rm}=Pm,Lm=ya([{name:"a_pos_3",components:3,type:"Int16"}]);var Om=ya([{name:"a_pos",type:"Int16",components:2}]);class uu{constructor(Re,Le){this.pos=Re,this.dir=Le}intersectsPlane(Re,Le,Oe){const Ue=Io.vec3.dot(Le,this.dir);if(Math.abs(Ue)<1e-6)return!1;const qe=((Re[0]-this.pos[0])*Le[0]+(Re[1]-this.pos[1])*Le[1]+(Re[2]-this.pos[2])*Le[2])/Ue;return Oe[0]=this.pos[0]+this.dir[0]*qe,Oe[1]=this.pos[1]+this.dir[1]*qe,Oe[2]=this.pos[2]+this.dir[2]*qe,!0}closestPointOnSphere(Re,Le,Oe){if(Io.vec3.equals(this.pos,Re)||0===Le)return Oe[0]=Oe[1]=Oe[2]=0,!1;const[Ue,qe,Ct]=this.dir,Ot=this.pos[0]-Re[0],Jt=this.pos[1]-Re[1],Hr=this.pos[2]-Re[2],Jr=Ue*Ue+qe*qe+Ct*Ct,Ln=2*(Ot*Ue+Jt*qe+Hr*Ct),Nn=Ln*Ln-4*Jr*(Ot*Ot+Jt*Jt+Hr*Hr-Le*Le);if(Nn<0){const Re=Math.max(-Ln/2,0),Jr=Ot+Ue*Re,Nn=Jt+qe*Re,$n=Hr+Ct*Re,Gn=Math.hypot(Jr,Nn,$n);return Oe[0]=Jr*Le/Gn,Oe[1]=Nn*Le/Gn,Oe[2]=$n*Le/Gn,!1}{const Re=(-Ln-Math.sqrt(Nn))/(2*Jr);if(Re<0){const Re=Math.hypot(Ot,Jt,Hr);return Oe[0]=Ot*Le/Re,Oe[1]=Jt*Le/Re,Oe[2]=Hr*Le/Re,!1}return Oe[0]=Ot+Ue*Re,Oe[1]=Jt+qe*Re,Oe[2]=Hr+Ct*Re,!0}}}class cu{constructor(Re,Le,Oe,Ue,qe){this.TL=Re,this.TR=Le,this.BR=Oe,this.BL=Ue,this.horizon=qe}static fromInvProjectionMatrix(Re,Le,Oe){const Ue=[-1,1,1],qe=[1,1,1],Ct=[1,-1,1],Ot=[-1,-1,1],Jt=Io.vec3.transformMat4(Ue,Ue,Re),Hr=Io.vec3.transformMat4(qe,qe,Re),Jr=Io.vec3.transformMat4(Ct,Ct,Re),Ln=Io.vec3.transformMat4(Ot,Ot,Re);return new cu(Jt,Hr,Jr,Ln,Le/Oe)}}function hu(Re,Le,Oe){let Ue=1/0,qe=-1/0;const Ct=[];for(const Ot of Re){Io.vec3.sub(Ct,Ot,Le);const Re=Io.vec3.dot(Ct,Oe);Ue=Math.min(Ue,Re),qe=Math.max(qe,Re)}return[Ue,qe]}function pu(Re,Le){let Oe=!0;for(let Ue=0;Ue<Re.planes.length;Ue++){const qe=Re.planes[Ue];let Ct=0;for(let Re=0;Re<Le.length;Re++)Ct+=Io.vec3.dot(qe,Le[Re])+qe[3]>=0;if(0===Ct)return 0;Ct!==Le.length&&(Oe=!1)}return Oe?2:1}function fu(Re,Le){for(const Oe of Re.projections){const Ue=hu(Le,Re.points[0],Oe.axis);if(Oe.projection[1]<Ue[0]||Oe.projection[0]>Ue[1])return 0}return 1}function du(Re,Le){let Oe=0;const Ue=[0,0,0,0];for(let qe=0;qe<Re.length;qe++)Ue[0]=Re[qe][0],Ue[1]=Re[qe][1],Ue[2]=Re[qe][2],Ue[3]=1,Io.vec4.dot(Ue,Le)>=0&&Oe++;return Oe}class mu{constructor(Re,Le){this.points=Re||new Array(8).fill([0,0,0]),this.planes=Le||new Array(6).fill([0,0,0,0]),this.bounds=yu.fromPoints(this.points),this.projections=[],this.frustumEdges=[Io.vec3.sub([],this.points[2],this.points[3]),Io.vec3.sub([],this.points[0],this.points[3]),Io.vec3.sub([],this.points[4],this.points[0]),Io.vec3.sub([],this.points[5],this.points[1]),Io.vec3.sub([],this.points[6],this.points[2]),Io.vec3.sub([],this.points[7],this.points[3])];for(const Re of this.frustumEdges){const Le=[0,-Re[2],Re[1]],Oe=[Re[2],0,-Re[0]];this.projections.push({axis:Le,projection:hu(this.points,this.points[0],Le)}),this.projections.push({axis:Oe,projection:hu(this.points,this.points[0],Oe)})}}static fromInvProjectionMatrix(Re,Le,Oe,Ue){const qe=Math.pow(2,Oe),Ct=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((Oe=>{const Ct=Io.vec4.transformMat4([],Oe,Re),Ot=1/Ct[3]/Le*qe;return Io.vec4.mul(Ct,Ct,[Ot,Ot,Ue?1/Ct[3]:Ot,Ot])})),Ot=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map((Re=>{const Le=Io.vec3.sub([],Ct[Re[0]],Ct[Re[1]]),Oe=Io.vec3.sub([],Ct[Re[2]],Ct[Re[1]]),Ue=Io.vec3.normalize([],Io.vec3.cross([],Le,Oe)),qe=-Io.vec3.dot(Ue,Ct[Re[1]]);return Ue.concat(qe)})),Jt=[];for(let Re=0;Re<Ct.length;Re++)Jt.push([Ct[Re][0],Ct[Re][1],Ct[Re][2]]);return new mu(Jt,Ot)}intersectsPrecise(Re,Le,Oe){for(let Oe=0;Oe<Le.length;Oe++)if(!du(Re,Le[Oe]))return 0;for(let Le=0;Le<this.planes.length;Le++)if(!du(Re,this.planes[Le]))return 0;for(const Le of Oe)for(const Oe of this.frustumEdges){const Ue=Io.vec3.cross([],Le,Oe),qe=Io.vec3.length(Ue);if(0===qe)continue;Io.vec3.scale(Ue,Ue,1/qe);const Ct=hu(this.points,this.points[0],Ue),Ot=hu(Re,this.points[0],Ue);if(Ct[0]>Ot[1]||Ot[0]>Ct[1])return 0}return 1}containsPoint(Re){for(const Le of this.planes){const Oe=Le[3];if(Io.vec3.dot([Le[0],Le[1],Le[2]],Re)+Oe<0)return!1}return!0}}class yu{static fromPoints(Re){const Le=[1/0,1/0,1/0],Oe=[-1/0,-1/0,-1/0];for(const Ue of Re)Io.vec3.min(Le,Le,Ue),Io.vec3.max(Oe,Oe,Ue);return new yu(Le,Oe)}static fromTileIdAndHeight(Re,Le,Oe){const Ue=1<<Re.canonical.z,qe=Re.canonical.x,Ct=Re.canonical.y;return new yu([qe/Ue,Ct/Ue,Le],[(qe+1)/Ue,(Ct+1)/Ue,Oe])}static applyTransform(Re,Le){const Oe=Re.getCorners();for(let Re=0;Re<Oe.length;++Re)Io.vec3.transformMat4(Oe[Re],Oe[Re],Le);return yu.fromPoints(Oe)}static applyTransformFast(Re,Le){const Oe=[Le[12],Le[13],Le[14]],Ue=[...Oe];for(let qe=0;qe<3;qe++)for(let Ct=0;Ct<3;Ct++){const Ot=Le[4*Ct+qe],Jt=Ot*Re.min[Ct],Hr=Ot*Re.max[Ct];Oe[qe]+=Math.min(Jt,Hr),Ue[qe]+=Math.max(Jt,Hr)}return new yu(Oe,Ue)}static projectAabbCorners(Re,Le){const Oe=Re.getCorners();for(let Re=0;Re<Oe.length;++Re)Io.vec3.transformMat4(Oe[Re],Oe[Re],Le);return Oe}constructor(Re,Le){this.min=Re,this.max=Le,this.center=Io.vec3.scale([],Io.vec3.add([],this.min,this.max),.5)}quadrant(Re){const Le=[Re%2==0,Re<2],Oe=Io.vec3.clone(this.min),Ue=Io.vec3.clone(this.max);for(let Re=0;Re<Le.length;Re++)Oe[Re]=Le[Re]?this.min[Re]:this.center[Re],Ue[Re]=Le[Re]?this.center[Re]:this.max[Re];return Ue[2]=this.max[2],new yu(Oe,Ue)}distanceX(Re){return Math.max(Math.min(this.max[0],Re[0]),this.min[0])-Re[0]}distanceY(Re){return Math.max(Math.min(this.max[1],Re[1]),this.min[1])-Re[1]}distanceZ(Re){return Math.max(Math.min(this.max[2],Re[2]),this.min[2])-Re[2]}getCorners(){const Re=this.min,Le=this.max;return[[Re[0],Re[1],Re[2]],[Le[0],Re[1],Re[2]],[Le[0],Le[1],Re[2]],[Re[0],Le[1],Re[2]],[Re[0],Re[1],Le[2]],[Le[0],Re[1],Le[2]],[Le[0],Le[1],Le[2]],[Re[0],Le[1],Le[2]]]}intersects(Re){return this.intersectsAabb(Re.bounds)?pu(Re,this.getCorners()):0}intersectsFlat(Re){return this.intersectsAabb(Re.bounds)?pu(Re,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(Re,Le){return Le||this.intersects(Re)?fu(Re,this.getCorners()):0}intersectsPreciseFlat(Re,Le){return Le||this.intersectsFlat(Re)?fu(Re,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(Re){for(let Le=0;Le<3;++Le)if(this.min[Le]>Re.max[Le]||Re.min[Le]>this.max[Le])return!1;return!0}intersectsAabbXY(Re){return!(this.min[0]>Re.max[0]||Re.min[0]>this.max[0]||this.min[1]>Re.max[1]||Re.min[1]>this.max[1])}encapsulate(Re){for(let Le=0;Le<3;Le++)this.min[Le]=Math.min(this.min[Le],Re.min[Le]),this.max[Le]=Math.max(this.max[Le],Re.max[Le])}encapsulatePoint(Re){for(let Le=0;Le<3;Le++)this.min[Le]=Math.min(this.min[Le],Re[Le]),this.max[Le]=Math.max(this.max[Le],Re[Le])}closestPoint(Re){return[Math.max(Math.min(this.max[0],Re[0]),this.min[0]),Math.max(Math.min(this.max[1],Re[1]),this.min[1]),Math.max(Math.min(this.max[2],Re[2]),this.min[2])]}}function gu(Re){return Re*pf/Yf}os(yu,"Aabb");const Dm=[new yu([$f,$f,$f],[Gf,Gf,Gf]),new yu([$f,$f,$f],[0,0,Gf]),new yu([0,$f,$f],[Gf,0,Gf]),new yu([$f,0,$f],[0,Gf,Gf]),new yu([0,0,$f],[Gf,Gf,Gf])];function bu(Re,Le,Oe,Ue=!0){const qe=Io.vec3.scale([],Re._camera.position,Re.worldSize),Ct=[Le,Oe,1,1];Io.vec4.transformMat4(Ct,Ct,Re.pixelMatrixInverse),Io.vec4.scale(Ct,Ct,1/Ct[3]);const Ot=Io.vec3.sub([],Ct,qe),Jt=Io.vec3.normalize([],Ot),Hr=Re.globeMatrix,Jr=[Hr[12],Hr[13],Hr[14]],Ln=Io.vec3.sub([],Jr,qe),Nn=Io.vec3.length(Ln),$n=Io.vec3.normalize([],Ln),Gn=Re.worldSize/(2*Math.PI),qn=Io.vec3.dot($n,Jt),Zn=Math.asin(Gn/Nn);if(Zn<Math.acos(qn)){if(!Ue)return null;const Re=[],Le=[];Io.vec3.scale(Re,Jt,Nn/qn),Io.vec3.normalize(Le,Io.vec3.sub(Le,Re,Ln)),Io.vec3.normalize(Jt,Io.vec3.add(Jt,Ln,Io.vec3.scale(Jt,Le,Math.tan(Zn)*Nn)))}const Xn=[];new uu(qe,Jt).closestPointOnSphere(Jr,Gn,Xn);const Yn=Io.vec3.normalize([],wt(Hr,0)),_i=Io.vec3.normalize([],wt(Hr,1)),vi=Io.vec3.normalize([],wt(Hr,2)),xi=Io.vec3.dot(Yn,Xn),bi=Io.vec3.dot(_i,Xn),Pi=Io.vec3.dot(vi,Xn),lo=Z(Math.asin(-bi/Gn));let uo=Z(Math.atan2(xi,Pi));uo=Re.center.lng+function(Re,Le){const Oe=(Le-Re+180)%360-180;return Oe<-180?Oe+360:Oe}(Re.center.lng,uo);const po=ol(uo),fo=Q(ll(lo),0,1);return new xl(po,fo)}class vu{constructor(Re,Le,Oe){this.a=Io.vec3.sub([],Re,Oe),this.b=Io.vec3.sub([],Le,Oe),this.center=Oe;const Ue=Io.vec3.normalize([],this.a),qe=Io.vec3.normalize([],this.b);this.angle=Math.acos(Io.vec3.dot(Ue,qe))}}function wu(Re,Le){if(0===Re.angle)return null;let Oe;return Oe=0===Re.a[Le]?1/Re.angle*.5*Math.PI:1/Re.angle*Math.atan(Re.b[Le]/Re.a[Le]/Math.sin(Re.angle)-1/Math.tan(Re.angle)),Oe<0||Oe>1?null:function(Re,Le,Oe,Ue){const qe=Math.sin(Oe);return Re*(Math.sin((1-Ue)*Oe)/qe)+Le*(Math.sin(Ue*Oe)/qe)}(Re.a[Le],Re.b[Le],Re.angle,Q(Oe,0,1))+Re.center[Le]}function _u(Re){if(Re.z<=1)return Dm[Re.z+2*Re.y+Re.x];const Le=Pu(Iu(Re));return yu.fromPoints(Le)}function Mu(Re,Le,Oe){return Io.vec3.scale(Re,Re,1-Oe),Io.vec3.scaleAndAdd(Re,Re,Le,Oe)}function Au(Re,Le,Oe){for(const Ue of Re)Io.vec3.transformMat4(Ue,Ue,Le),Io.vec3.scale(Ue,Ue,Oe)}function Su(Re,Le,Oe,Ue){const qe=Le/Re.worldSize,Ct=Re.globeMatrix;if(Oe.z<=1){const Re=_u(Oe).getCorners();return Au(Re,Ct,qe),yu.fromPoints(Re)}const Ot=Iu(Oe,Ue),Jt=Pu(Ot,pf+gu(Re._tileCoverLift));Au(Jt,Ct,qe);const Hr=Number.MAX_VALUE,Jr=[-Hr,-Hr,-Hr],Ln=[Hr,Hr,Hr];if(Ot.contains(Re.center)){for(const Re of Jt)Io.vec3.min(Ln,Ln,Re),Io.vec3.max(Jr,Jr,Re);Jr[2]=0;const Le=Re.point,Oe=[Le.x*qe,Le.y*qe,0];return Io.vec3.min(Ln,Ln,Oe),Io.vec3.max(Jr,Jr,Oe),new yu(Ln,Jr)}if(Re._tileCoverLift>0){for(const Re of Jt)Io.vec3.min(Ln,Ln,Re),Io.vec3.max(Jr,Jr,Re);return new yu(Ln,Jr)}const Nn=[Ct[12]*qe,Ct[13]*qe,Ct[14]*qe],$n=Ot.getCenter(),Gn=Q(Re.center.lat,-im,im),qn=Q($n.lat,-im,im),Zn=ol(Re.center.lng),Xn=ll(Gn);let Yn=Zn-ol($n.lng);const _i=Xn-ll(qn);Yn>.5?Yn-=1:Yn<-.5&&(Yn+=1);let vi=0;if(Math.abs(Yn)>Math.abs(_i))vi=Yn>=0?1:3;else{vi=_i>=0?0:2;const Re=[Ct[4]*qe,Ct[5]*qe,Ct[6]*qe],Le=-Math.sin(Y(_i>=0?Ot.getSouth():Ot.getNorth()))*pf;Io.vec3.scaleAndAdd(Nn,Nn,Re,Le)}const xi=Jt[vi],bi=Jt[(vi+1)%4],Pi=new vu(xi,bi,Nn),lo=[wu(Pi,0)||xi[0],wu(Pi,1)||xi[1],wu(Pi,2)||xi[2]],uo=Du(Re.zoom);if(uo>0){const Ue=function({x:Re,y:Le,z:Oe},Ue,qe,Ct,Ot){const Jt=1/(1<<Oe);let Hr=Re*Jt,Jr=Hr+Jt,Ln=Le*Jt,Nn=Ln+Jt,$n=0;const Gn=(Hr+Jr)/2-Ct;return Gn>.5?$n=-1:Gn<-.5&&($n=1),Hr=((Hr+$n)*Ue-(Ct*=Ue))*qe+Ct,Jr=((Jr+$n)*Ue-Ct)*qe+Ct,Ln=(Ln*Ue-(Ot*=Ue))*qe+Ot,Nn=(Nn*Ue-Ot)*qe+Ot,[[Hr,Nn,0],[Jr,Nn,0],[Jr,Ln,0],[Hr,Ln,0]]}(Oe,Le,Re._pixelsPerMercatorPixel,Zn,Xn);for(let Re=0;Re<Jt.length;Re++)Mu(Jt[Re],Ue[Re],uo);const qe=Io.vec3.add([],Ue[vi],Ue[(vi+1)%4]);Io.vec3.scale(qe,qe,.5),Mu(lo,qe,uo)}for(const Re of Jt)Io.vec3.min(Ln,Ln,Re),Io.vec3.max(Jr,Jr,Re);return Ln[2]=Math.min(xi[2],bi[2]),Io.vec3.min(Ln,Ln,lo),Io.vec3.max(Jr,Jr,lo),new yu(Ln,Jr)}function Iu({x:Re,y:Le,z:Oe},Ue=!1){const qe=1/(1<<Oe),Ct=new rl(cl(Re*qe),Le===(1<<Oe)-1&&Ue?-90:hl((Le+1)*qe)),Ot=new rl(cl((Re+1)*qe),0===Le&&Ue?90:hl(Le*qe));return new nl(Ct,Ot)}function Pu(Re,Le=pf){const Oe=Y(Re.getNorth()),Ue=Y(Re.getSouth()),qe=Math.cos(Oe),Ct=Math.cos(Ue),Ot=Math.sin(Oe),Jt=Math.sin(Ue),Hr=Re.getWest(),Jr=Re.getEast();return[Jo(Ct,Jt,Hr,Le),Jo(Ct,Jt,Jr,Le),Jo(qe,Ot,Jr,Le),Jo(qe,Ot,Hr,Le)]}function zu(Re,Le,Oe,Ue){const qe=1<<Oe.z,Ct=(Re/id+Oe.x)/qe;return Qo(hl((Le/id+Oe.y)/qe),cl(Ct),Ue)}function ku({min:Re,max:Le}){return xf/Math.max(Le[0]-Re[0],Le[1]-Re[1],Le[2]-Re[2])}const Fm=new Float64Array(16);function Eu(Re){const Le=ku(Re),Oe=Io.mat4.fromScaling(Fm,[Le,Le,Le]);return Io.mat4.translate(Oe,Oe,Io.vec3.negate([],Re.min))}function Bu(Re){const Le=Io.mat4.fromTranslation(Fm,Re.min),Oe=1/ku(Re);return Io.mat4.scale(Le,Le,[Oe,Oe,Oe])}function Vu(Re){const Le=id/(2*Math.PI);return Re/(2*Math.PI)/Le}function Cu(Re,Le){return id/(512*Math.pow(2,Re))*ku(_u(Le))}function Ru(Re,Le,Oe,Ue,qe){const Ct=Vu(Oe),Ot=[Re,Le,-Oe/(2*Math.PI)],Jt=Io.mat4.identity(new Float64Array(16));return Io.mat4.translate(Jt,Jt,Ot),Io.mat4.scale(Jt,Jt,[Ct,Ct,Ct]),Io.mat4.rotateX(Jt,Jt,Y(-qe)),Io.mat4.rotateY(Jt,Jt,Y(-Ue)),Jt}function Du(Re){return tt(ff,gf,Re)}function Lu(Re,Le){const Oe=Qo(Le.lat,Le.lng),Ue=function(Re){const Le=Qo(Re._center.lat,Re._center.lng),Oe=Io.vec3.fromValues(0,1,0);let Ue=Io.vec3.cross([],Oe,Le);const qe=Io.mat4.fromRotation([],-Re.angle,Le);Ue=Io.vec3.transformMat4(Ue,Ue,qe),Io.mat4.fromRotation(qe,-Re._pitch,Ue);const Ct=Io.vec3.normalize([],Le);return Io.vec3.scale(Ct,Ct,gu(Re.cameraToCenterDistance/Re.pixelsPerMeter)),Io.vec3.transformMat4(Ct,Ct,qe),Io.vec3.add([],Le,Ct)}(Re),qe=Io.vec3.subtract([],Ue,Oe);return Io.vec3.angle(qe,Oe)}function Fu(Re,Le){return Lu(Re,Le)>Math.PI/2*1.01}const jm=Y(85),Um=Math.cos(jm),Hm=Math.sin(jm),Wm=Io.mat4.create(),qu=Re=>{const Le=[];return"map"===Re.paint.get("circle-pitch-alignment")&&Le.push("PITCH_WITH_MAP"),"map"===Re.paint.get("circle-pitch-scale")&&Le.push("SCALE_WITH_MAP"),Le};function $u(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr){if(Ct&&Re.queryGeometry.isAboveHorizon)return!1;Ct&&(Hr*=Re.pixelToTileUnitsFactor);const Jr=Re.tileID.canonical,Ln=Oe.projection.upVectorScale(Jr,Oe.center.lat,Oe.worldSize).metersToTile;for(const Nn of Le)for(const Le of Nn){const Nn=Le.add(Jt),$n=qe&&Oe.elevation?Oe.elevation.exaggeration()*qe.getElevationAt(Nn.x,Nn.y,!0):0,Gn=Oe.projection.projectTilePoint(Nn.x,Nn.y,Jr);if($n>0){const Re=Oe.projection.upVector(Jr,Nn.x,Nn.y);Gn.x+=Re[0]*Ln*$n,Gn.y+=Re[1]*Ln*$n,Gn.z+=Re[2]*Ln*$n}const qn=Ct?Nn:Gu(Gn.x,Gn.y,Gn.z,Ue),Zn=Ct?Re.tilespaceRays.map((Re=>Zu(Re,$n))):Re.queryGeometry.screenGeometry,Xn=Io.vec4.transformMat4([],[Gn.x,Gn.y,Gn.z,1],Ue);if(!Ot&&Ct?Hr*=Xn[3]/Oe.cameraToCenterDistance:Ot&&!Ct&&(Hr*=Oe.cameraToCenterDistance/Xn[3]),Ct){const Re=hl((Le.y/id+Jr.y)/(1<<Jr.z));Hr/=Oe.projection.pixelsPerMeter(Re,1)/ul(1,Re)}if(Bl(Zn,qn,Hr))return!0}return!1}function Gu(Re,Le,Oe,Ue){const qe=Io.vec4.transformMat4([],[Re,Le,Oe,1],Ue);return new Is(qe[0]/qe[3],qe[1]/qe[3])}const Zm=Io.vec3.fromValues(0,0,0),Ym=Io.vec3.fromValues(0,0,1);function Zu(Re,Le){const Oe=Io.vec3.create();return Zm[2]=Le,Re.intersectsPlane(Zm,Ym,Oe),new Is(Oe[0],Oe[1])}class Wu extends Tl{}let eg,tg,rg,ng;function tc(Re,{width:Le,height:Oe},Ue,qe){if(qe){if(qe instanceof Uint8ClampedArray)qe=new Uint8Array(qe.buffer);else if(qe.length!==Le*Oe*Ue)throw new RangeError("mismatched image size")}else qe=new Uint8Array(Le*Oe*Ue);return Re.width=Le,Re.height=Oe,Re.data=qe,Re}function ec(Re,Le,Oe){const{width:Ue,height:qe}=Le;Ue===Re.width&&qe===Re.height||(rc(Re,Le,{x:0,y:0},{x:0,y:0},{width:Math.min(Re.width,Ue),height:Math.min(Re.height,qe)},Oe,null),Re.width=Ue,Re.height=qe,Re.data=Le.data)}function rc(Re,Le,Oe,Ue,qe,Ct,Ot,Jt){if(0===qe.width||0===qe.height)return Le;if(qe.width>Re.width||qe.height>Re.height||Oe.x>Re.width-qe.width||Oe.y>Re.height-qe.height)throw new RangeError("out of range source coordinates for image copy");if(qe.width>Le.width||qe.height>Le.height||Ue.x>Le.width-qe.width||Ue.y>Le.height-qe.height)throw new RangeError("out of range destination coordinates for image copy");const Hr=Re.data,Jr=Le.data,Ln=4===Ct&&Jt;for(let Jt=0;Jt<qe.height;Jt++){const Nn=((Oe.y+Jt)*Re.width+Oe.x)*Ct,$n=((Ue.y+Jt)*Le.width+Ue.x)*Ct;if(Ln)for(let Re=0;Re<qe.width;Re++){const Le=Nn+Re*Ct+3,Oe=$n+Re*Ct;Jr[Oe+0]=255,Jr[Oe+1]=255,Jr[Oe+2]=255,Jr[Oe+3]=Hr[Le]}else if(Ot)for(let Re=0;Re<qe.width;Re++){const Le=Nn+Re*Ct,Oe=$n+Re*Ct,Ue=Hr[Le+3],qe=new Pe(Hr[Le+0]/255*Ue,Hr[Le+1]/255*Ue,Hr[Le+2]/255*Ue,Ue).toRenderColor(Ot).toArray();Jr[Oe+0]=qe[0],Jr[Oe+1]=qe[1],Jr[Oe+2]=qe[2],Jr[Oe+3]=qe[3]}else for(let Re=0;Re<qe.width*Ct;Re++)Jr[$n+Re]=Hr[Nn+Re]}return Le}os(Wu,"HeatmapBucket",{omit:["layers"]});class nc{constructor(Re,Le){tc(this,Re,1,Le)}resize(Re){ec(this,new nc(Re),1)}clone(){return new nc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(Re,Le,Oe,Ue,qe){rc(Re,Le,Oe,Ue,qe,1,null)}}class ic{constructor(Re,Le){tc(this,Re,4,Le)}resize(Re){ec(this,new ic(Re),4)}replace(Re,Le){Le?this.data.set(Re):this.data=Re instanceof Uint8ClampedArray?new Uint8Array(Re.buffer):Re}clone(){return new ic({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(Re,Le,Oe,Ue,qe,Ct,Ot){rc(Re,Le,Oe,Ue,qe,4,Ct,Ot)}}class sc{constructor(Re,Le){this.width=Re.width,this.height=Re.height,this.data=Le instanceof Uint8Array?new Float32Array(Le.buffer):Le}}function ac(Re){const Le={},Oe=Re.resolution||256,Ue=Re.clips?Re.clips.length:1,qe=Re.image||new ic({width:Oe,height:Ue}),s=(Oe,Ue,Ct)=>{Le[Re.evaluationKey]=Ct;const Ot=Re.expression.evaluate(Le);Ot&&(qe.data[Oe+Ue+0]=Math.floor(255*Ot.r/Ot.a),qe.data[Oe+Ue+1]=Math.floor(255*Ot.g/Ot.a),qe.data[Oe+Ue+2]=Math.floor(255*Ot.b/Ot.a),qe.data[Oe+Ue+3]=Math.floor(255*Ot.a))};if(Re.clips)for(let Le=0,qe=0;Le<Ue;++Le,qe+=4*Oe)for(let Ue=0,Ct=0;Ue<Oe;Ue++,Ct+=4){const Ot=Ue/(Oe-1),{start:Jt,end:Hr}=Re.clips[Le];s(qe,Ct,Jt*(1-Ot)+Hr*Ot)}else for(let Re=0,Le=0;Re<Oe;Re++,Le+=4)s(0,Le,Re/(Oe-1));return qe}os(nc,"AlphaImage"),os(ic,"RGBAImage");const og=ya([{name:"a_pos",components:2,type:"Int16"}],4),{members:sg}=og;function uc(Re,Le,Oe=2){const Ue=Le&&Le.length,qe=Ue?Le[0]*Oe:Re.length;let Ct=cc(Re,0,qe,Oe,!0);const Ot=[];if(!Ct||Ct.next===Ct.prev)return Ot;let Jt,Hr,Jr;if(Ue&&(Ct=function(Re,Le,Oe,Ue){const qe=[];for(let Oe=0,Ct=Le.length;Oe<Ct;Oe++){const Ot=cc(Re,Le[Oe]*Ue,Oe<Ct-1?Le[Oe+1]*Ue:Re.length,Ue,!1);Ot===Ot.next&&(Ot.steiner=!0),qe.push(wc(Ot))}qe.sort(gc);for(let Re=0;Re<qe.length;Re++)Oe=xc(qe[Re],Oe);return Oe}(Re,Le,Ct,Oe)),Re.length>80*Oe){Jt=1/0,Hr=1/0;let Le=-1/0,Ue=-1/0;for(let Ct=Oe;Ct<qe;Ct+=Oe){const Oe=Re[Ct],qe=Re[Ct+1];Oe<Jt&&(Jt=Oe),qe<Hr&&(Hr=qe),Oe>Le&&(Le=Oe),qe>Ue&&(Ue=qe)}Jr=Math.max(Le-Jt,Ue-Hr),Jr=0!==Jr?32767/Jr:0}return pc(Ct,Ot,Oe,Jt,Hr,Jr,0),Ot}function cc(Re,Le,Oe,Ue,qe){let Ct;if(qe===function(Re,Le,Oe,Ue){let qe=0;for(let Ct=Le,Ot=Oe-Ue;Ct<Oe;Ct+=Ue)qe+=(Re[Ot]-Re[Ct])*(Re[Ct+1]+Re[Ot+1]),Ot=Ct;return qe}(Re,Le,Oe,Ue)>0)for(let qe=Le;qe<Oe;qe+=Ue)Ct=Ec(qe/Ue|0,Re[qe],Re[qe+1],Ct);else for(let qe=Oe-Ue;qe>=Le;qe-=Ue)Ct=Ec(qe/Ue|0,Re[qe],Re[qe+1],Ct);return Ct&&Sc(Ct,Ct.next)&&(Bc(Ct),Ct=Ct.next),Ct}function hc(Re,Le){if(!Re)return Re;Le||(Le=Re);let Oe,Ue=Re;do{if(Oe=!1,Ue.steiner||!Sc(Ue,Ue.next)&&0!==Ac(Ue.prev,Ue,Ue.next))Ue=Ue.next;else{if(Bc(Ue),Ue=Le=Ue.prev,Ue===Ue.next)break;Oe=!0}}while(Oe||Ue!==Le);return Le}function pc(Re,Le,Oe,Ue,qe,Ct,Ot){if(!Re)return;!Ot&&Ct&&function(Re,Le,Oe,Ue){let qe=Re;do{0===qe.z&&(qe.z=vc(qe.x,qe.y,Le,Oe,Ue)),qe.prevZ=qe.prev,qe.nextZ=qe.next,qe=qe.next}while(qe!==Re);qe.prevZ.nextZ=null,qe.prevZ=null,function(Re){let Le,Oe=1;do{let Ue,qe=Re;Re=null;let Ct=null;for(Le=0;qe;){Le++;let Ot=qe,Jt=0;for(let Re=0;Re<Oe&&(Jt++,Ot=Ot.nextZ,Ot);Re++);let Hr=Oe;for(;Jt>0||Hr>0&&Ot;)0!==Jt&&(0===Hr||!Ot||qe.z<=Ot.z)?(Ue=qe,qe=qe.nextZ,Jt--):(Ue=Ot,Ot=Ot.nextZ,Hr--),Ct?Ct.nextZ=Ue:Re=Ue,Ue.prevZ=Ct,Ct=Ue;qe=Ot}Ct.nextZ=null,Oe*=2}while(Le>1)}(qe)}(Re,Ue,qe,Ct);let Jt=Re;for(;Re.prev!==Re.next;){const Hr=Re.prev,Jr=Re.next;if(Ct?dc(Re,Ue,qe,Ct):fc(Re))Le.push(Hr.i,Re.i,Jr.i),Bc(Re),Re=Jr.next,Jt=Jr.next;else if((Re=Jr)===Jt){Ot?1===Ot?pc(Re=mc(hc(Re),Le),Le,Oe,Ue,qe,Ct,2):2===Ot&&yc(Re,Le,Oe,Ue,qe,Ct):pc(hc(Re),Le,Oe,Ue,qe,Ct,1);break}}}function fc(Re){const Le=Re.prev,Oe=Re,Ue=Re.next;if(Ac(Le,Oe,Ue)>=0)return!1;const qe=Le.x,Ct=Oe.x,Ot=Ue.x,Jt=Le.y,Hr=Oe.y,Jr=Ue.y,Ln=qe<Ct?qe<Ot?qe:Ot:Ct<Ot?Ct:Ot,Nn=Jt<Hr?Jt<Jr?Jt:Jr:Hr<Jr?Hr:Jr,$n=qe>Ct?qe>Ot?qe:Ot:Ct>Ot?Ct:Ot,Gn=Jt>Hr?Jt>Jr?Jt:Jr:Hr>Jr?Hr:Jr;let qn=Ue.next;for(;qn!==Le;){if(qn.x>=Ln&&qn.x<=$n&&qn.y>=Nn&&qn.y<=Gn&&_c(qe,Jt,Ct,Hr,Ot,Jr,qn.x,qn.y)&&Ac(qn.prev,qn,qn.next)>=0)return!1;qn=qn.next}return!0}function dc(Re,Le,Oe,Ue){const qe=Re.prev,Ct=Re,Ot=Re.next;if(Ac(qe,Ct,Ot)>=0)return!1;const Jt=qe.x,Hr=Ct.x,Jr=Ot.x,Ln=qe.y,Nn=Ct.y,$n=Ot.y,Gn=Jt<Hr?Jt<Jr?Jt:Jr:Hr<Jr?Hr:Jr,qn=Ln<Nn?Ln<$n?Ln:$n:Nn<$n?Nn:$n,Zn=Jt>Hr?Jt>Jr?Jt:Jr:Hr>Jr?Hr:Jr,Xn=Ln>Nn?Ln>$n?Ln:$n:Nn>$n?Nn:$n,Yn=vc(Gn,qn,Le,Oe,Ue),_i=vc(Zn,Xn,Le,Oe,Ue);let vi=Re.prevZ,xi=Re.nextZ;for(;vi&&vi.z>=Yn&&xi&&xi.z<=_i;){if(vi.x>=Gn&&vi.x<=Zn&&vi.y>=qn&&vi.y<=Xn&&vi!==qe&&vi!==Ot&&_c(Jt,Ln,Hr,Nn,Jr,$n,vi.x,vi.y)&&Ac(vi.prev,vi,vi.next)>=0)return!1;if(vi=vi.prevZ,xi.x>=Gn&&xi.x<=Zn&&xi.y>=qn&&xi.y<=Xn&&xi!==qe&&xi!==Ot&&_c(Jt,Ln,Hr,Nn,Jr,$n,xi.x,xi.y)&&Ac(xi.prev,xi,xi.next)>=0)return!1;xi=xi.nextZ}for(;vi&&vi.z>=Yn;){if(vi.x>=Gn&&vi.x<=Zn&&vi.y>=qn&&vi.y<=Xn&&vi!==qe&&vi!==Ot&&_c(Jt,Ln,Hr,Nn,Jr,$n,vi.x,vi.y)&&Ac(vi.prev,vi,vi.next)>=0)return!1;vi=vi.prevZ}for(;xi&&xi.z<=_i;){if(xi.x>=Gn&&xi.x<=Zn&&xi.y>=qn&&xi.y<=Xn&&xi!==qe&&xi!==Ot&&_c(Jt,Ln,Hr,Nn,Jr,$n,xi.x,xi.y)&&Ac(xi.prev,xi,xi.next)>=0)return!1;xi=xi.nextZ}return!0}function mc(Re,Le){let Oe=Re;do{const Ue=Oe.prev,qe=Oe.next.next;!Sc(Ue,qe)&&Ic(Ue,Oe,Oe.next,qe)&&kc(Ue,qe)&&kc(qe,Ue)&&(Le.push(Ue.i,Oe.i,qe.i),Bc(Oe),Bc(Oe.next),Oe=Re=qe),Oe=Oe.next}while(Oe!==Re);return hc(Oe)}function yc(Re,Le,Oe,Ue,qe,Ct){let Ot=Re;do{let Re=Ot.next.next;for(;Re!==Ot.prev;){if(Ot.i!==Re.i&&Mc(Ot,Re)){let Jt=Tc(Ot,Re);return Ot=hc(Ot,Ot.next),Jt=hc(Jt,Jt.next),pc(Ot,Le,Oe,Ue,qe,Ct,0),void pc(Jt,Le,Oe,Ue,qe,Ct,0)}Re=Re.next}Ot=Ot.next}while(Ot!==Re)}function gc(Re,Le){return Re.x-Le.x}function xc(Re,Le){const Oe=function(Re,Le){let Oe=Le;const Ue=Re.x,qe=Re.y;let Ct,Ot=-1/0;do{if(qe<=Oe.y&&qe>=Oe.next.y&&Oe.next.y!==Oe.y){const Re=Oe.x+(qe-Oe.y)*(Oe.next.x-Oe.x)/(Oe.next.y-Oe.y);if(Re<=Ue&&Re>Ot&&(Ot=Re,Ct=Oe.x<Oe.next.x?Oe:Oe.next,Re===Ue))return Ct}Oe=Oe.next}while(Oe!==Le);if(!Ct)return null;const Jt=Ct,Hr=Ct.x,Jr=Ct.y;let Ln=1/0;Oe=Ct;do{if(Ue>=Oe.x&&Oe.x>=Hr&&Ue!==Oe.x&&_c(qe<Jr?Ue:Ot,qe,Hr,Jr,qe<Jr?Ot:Ue,qe,Oe.x,Oe.y)){const Le=Math.abs(qe-Oe.y)/(Ue-Oe.x);kc(Oe,Re)&&(Le<Ln||Le===Ln&&(Oe.x>Ct.x||Oe.x===Ct.x&&bc(Ct,Oe)))&&(Ct=Oe,Ln=Le)}Oe=Oe.next}while(Oe!==Jt);return Ct}(Re,Le);if(!Oe)return Le;const Ue=Tc(Oe,Re);return hc(Ue,Ue.next),hc(Oe,Oe.next)}function bc(Re,Le){return Ac(Re.prev,Re,Le.prev)<0&&Ac(Le.next,Re,Re.next)<0}function vc(Re,Le,Oe,Ue,qe){return(Re=1431655765&((Re=858993459&((Re=252645135&((Re=16711935&((Re=(Re-Oe)*qe|0)|Re<<8))|Re<<4))|Re<<2))|Re<<1))|(Le=1431655765&((Le=858993459&((Le=252645135&((Le=16711935&((Le=(Le-Ue)*qe|0)|Le<<8))|Le<<4))|Le<<2))|Le<<1))<<1}function wc(Re){let Le=Re,Oe=Re;do{(Le.x<Oe.x||Le.x===Oe.x&&Le.y<Oe.y)&&(Oe=Le),Le=Le.next}while(Le!==Re);return Oe}function _c(Re,Le,Oe,Ue,qe,Ct,Ot,Jt){return(qe-Ot)*(Le-Jt)>=(Re-Ot)*(Ct-Jt)&&(Re-Ot)*(Ue-Jt)>=(Oe-Ot)*(Le-Jt)&&(Oe-Ot)*(Ct-Jt)>=(qe-Ot)*(Ue-Jt)}function Mc(Re,Le){return Re.next.i!==Le.i&&Re.prev.i!==Le.i&&!function(Re,Le){let Oe=Re;do{if(Oe.i!==Re.i&&Oe.next.i!==Re.i&&Oe.i!==Le.i&&Oe.next.i!==Le.i&&Ic(Oe,Oe.next,Re,Le))return!0;Oe=Oe.next}while(Oe!==Re);return!1}(Re,Le)&&(kc(Re,Le)&&kc(Le,Re)&&function(Re,Le){let Oe=Re,Ue=!1;const qe=(Re.x+Le.x)/2,Ct=(Re.y+Le.y)/2;do{Oe.y>Ct!=Oe.next.y>Ct&&Oe.next.y!==Oe.y&&qe<(Oe.next.x-Oe.x)*(Ct-Oe.y)/(Oe.next.y-Oe.y)+Oe.x&&(Ue=!Ue),Oe=Oe.next}while(Oe!==Re);return Ue}(Re,Le)&&(Ac(Re.prev,Re,Le.prev)||Ac(Re,Le.prev,Le))||Sc(Re,Le)&&Ac(Re.prev,Re,Re.next)>0&&Ac(Le.prev,Le,Le.next)>0)}function Ac(Re,Le,Oe){return(Le.y-Re.y)*(Oe.x-Le.x)-(Le.x-Re.x)*(Oe.y-Le.y)}function Sc(Re,Le){return Re.x===Le.x&&Re.y===Le.y}function Ic(Re,Le,Oe,Ue){const qe=zc(Ac(Re,Le,Oe)),Ct=zc(Ac(Re,Le,Ue)),Ot=zc(Ac(Oe,Ue,Re)),Jt=zc(Ac(Oe,Ue,Le));return qe!==Ct&&Ot!==Jt||!(0!==qe||!Pc(Re,Oe,Le))||!(0!==Ct||!Pc(Re,Ue,Le))||!(0!==Ot||!Pc(Oe,Re,Ue))||!(0!==Jt||!Pc(Oe,Le,Ue))}function Pc(Re,Le,Oe){return Le.x<=Math.max(Re.x,Oe.x)&&Le.x>=Math.min(Re.x,Oe.x)&&Le.y<=Math.max(Re.y,Oe.y)&&Le.y>=Math.min(Re.y,Oe.y)}function zc(Re){return Re>0?1:Re<0?-1:0}function kc(Re,Le){return Ac(Re.prev,Re,Re.next)<0?Ac(Re,Le,Re.next)>=0&&Ac(Re,Re.prev,Le)>=0:Ac(Re,Le,Re.prev)<0||Ac(Re,Re.next,Le)<0}function Tc(Re,Le){const Oe=Vc(Re.i,Re.x,Re.y),Ue=Vc(Le.i,Le.x,Le.y),qe=Re.next,Ct=Le.prev;return Re.next=Le,Le.prev=Re,Oe.next=qe,qe.prev=Oe,Ue.next=Oe,Oe.prev=Ue,Ct.next=Ue,Ue.prev=Ct,Ue}function Ec(Re,Le,Oe,Ue){const qe=Vc(Re,Le,Oe);return Ue?(qe.next=Ue.next,qe.prev=Ue,Ue.next.prev=qe,Ue.next=qe):(qe.prev=qe,qe.next=qe),qe}function Bc(Re){Re.next.prev=Re.prev,Re.prev.next=Re.next,Re.prevZ&&(Re.prevZ.nextZ=Re.nextZ),Re.nextZ&&(Re.nextZ.prevZ=Re.prevZ)}function Vc(Re,Le,Oe){return{i:Re,x:Le,y:Oe,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function Cc(Re,Le){const Oe=Re.length;if(Oe<=1)return[Re];const Ue=[];let qe,Ct;for(let Le=0;Le<Oe;Le++){const Oe=mt(Re[Le]);0!==Oe&&(Re[Le].area=Math.abs(Oe),void 0===Ct&&(Ct=Oe<0),Ct===Oe<0?(qe&&Ue.push(qe),qe=[Re[Le]]):qe.push(Re[Le]))}if(qe&&Ue.push(qe),Le>1)for(let Re=0;Re<Ue.length;Re++)Ue[Re].length<=Le||(br(Ue[Re],Le,1,Ue[Re].length-1,Rc),Ue[Re]=Ue[Re].slice(0,Le));return Ue}function Rc(Re,Le){return Le.area-Re.area}function Dc(Re,Le,Oe){const Ue=Oe.patternDependencies;let qe=!1;for(const Oe of Le){const Le=Oe.paint.get(`${Re}-pattern`);Le.isConstant()||(qe=!0);const Ct=Le.constantOr(null);Ct&&(qe=!0,Ue[Ct]=!0)}return qe}function Lc(Re,Le,Oe,Ue,qe){const Ct=qe.patternDependencies;for(const Ot of Le){const Le=Ot.paint.get(`${Re}-pattern`).value;if("constant"!==Le.kind){let Re=Le.evaluate({zoom:Ue},Oe,{},qe.availableImages);Re=Re&&Re.name?Re.name:Re,Ct[Re]=!0,Oe.patterns[Ot.id]=Re}}return Oe}class Fc{constructor(Re){this.zoom=Re.zoom,this.overscaling=Re.overscaling,this.layers=Re.layers,this.layerIds=this.layers.map((Re=>Re.fqid)),this.index=Re.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new xa,this.indexArray=new Da,this.indexArray2=new Ea,this.programConfigurations=new Fo(Re.layers,{zoom:Re.zoom,lut:Re.lut}),this.segments=new co,this.segments2=new co,this.stateDependentLayerIds=this.layers.filter((Re=>Re.isStateDependent())).map((Re=>Re.id)),this.projection=Re.projection}updateFootprints(Re,Le){}populate(Re,Le,Oe,Ue){this.hasPattern=Dc("fill",this.layers,Le);const qe=this.layers[0].layout.get("fill-sort-key"),Ct=[];for(const{feature:Ot,id:Jt,index:Hr,sourceLayerIndex:Jr}of Re){const Re=this.layers[0]._featureFilter.needGeometry,Ln=Pl(Ot,Re);if(!this.layers[0]._featureFilter.filter(new Vs(this.zoom),Ln,Oe))continue;const Nn=qe?qe.evaluate(Ln,{},Oe,Le.availableImages):void 0,$n={id:Jt,properties:Ot.properties,type:Ot.type,sourceLayerIndex:Jr,index:Hr,geometry:Re?Ln.geometry:Il(Ot,Oe,Ue),patterns:{},sortKey:Nn};Ct.push($n)}qe&&Ct.sort(((Re,Le)=>Re.sortKey-Le.sortKey));for(const Ue of Ct){const{geometry:qe,index:Ct,sourceLayerIndex:Ot}=Ue;if(this.hasPattern){const Re=Lc("fill",this.layers,Ue,this.zoom,Le);this.patternFeatures.push(Re)}else this.addFeature(Ue,qe,Ct,Oe,{},Le.availableImages,Le.brightness);Le.featureIndex.insert(Re[Ct].feature,qe,Ct,Ot,this.index)}}update(Re,Le,Oe,Ue,qe){const Ct=0!==Object.keys(Re).length;Ct&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(Re,Le,Ct?this.stateDependentLayers:this.layers,Oe,Ue,qe)}addFeatures(Re,Le,Oe,Ue,qe,Ct){for(const Re of this.patternFeatures)this.addFeature(Re,Re.geometry,Re.index,Le,Oe,Ue,Ct)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(Re){this.uploaded||(this.layoutVertexBuffer=Re.createVertexBuffer(this.layoutVertexArray,sg),this.indexBuffer=Re.createIndexBuffer(this.indexArray),this.indexBuffer2=Re.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(Re),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(Re,Le,Oe,Ue,qe,Ct=[],Ot){for(const Re of Cc(Le,500)){let Le=0;for(const Oe of Re)Le+=Oe.length;const Oe=this.segments.prepareSegment(Le,this.layoutVertexArray,this.indexArray),Ue=Oe.vertexLength,qe=[],Ct=[];for(const Le of Re){if(0===Le.length)continue;Le!==Re[0]&&Ct.push(qe.length/2);const Oe=this.segments2.prepareSegment(Le.length,this.layoutVertexArray,this.indexArray2),Ue=Oe.vertexLength;this.layoutVertexArray.emplaceBack(Le[0].x,Le[0].y),this.indexArray2.emplaceBack(Ue+Le.length-1,Ue),qe.push(Le[0].x),qe.push(Le[0].y);for(let Re=1;Re<Le.length;Re++)this.layoutVertexArray.emplaceBack(Le[Re].x,Le[Re].y),this.indexArray2.emplaceBack(Ue+Re-1,Ue+Re),qe.push(Le[Re].x),qe.push(Le[Re].y);Oe.vertexLength+=Le.length,Oe.primitiveLength+=Le.length}const Ot=uc(qe,Ct);for(let Re=0;Re<Ot.length;Re+=3)this.indexArray.emplaceBack(Ue+Ot[Re],Ue+Ot[Re+1],Ue+Ot[Re+2]);Oe.vertexLength+=Le,Oe.primitiveLength+=Ot.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,Re,Oe,qe,Ct,Ue,Ot)}}let ag,lg,dg,pg;os(Fc,"FillBucket",{omit:["layers","patternFeatures"]});class qc{constructor(Re,Le,Oe,Ue){if(this.triangleCount=Le.length/3,this.min=new Is(0,0),this.max=new Is(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],0===this.triangleCount||0===Re.length)return;const[qe,Ct]=[Re[0].clone(),Re[0].clone()];for(let Le=1;Le<Re.length;++Le){const Oe=Re[Le];qe.x=Math.min(qe.x,Oe.x),qe.y=Math.min(qe.y,Oe.y),Ct.x=Math.max(Ct.x,Oe.x),Ct.y=Math.max(Ct.y,Oe.y)}if(Ue){const Re=Math.ceil(Math.max(Ct.x-qe.x,Ct.y-qe.y)/Ue);Oe=Math.max(Oe,Re)}if(0===Oe)return;this.min=qe,this.max=Ct;const Ot=this.max.sub(this.min);Ot.x=Math.max(Ot.x,1),Ot.y=Math.max(Ot.y,1);const Jt=Math.max(Ot.x,Ot.y)/Oe;this.cellsX=Math.max(1,Math.ceil(Ot.x/Jt)),this.cellsY=Math.max(1,Math.ceil(Ot.y/Jt)),this.xScale=1/Jt,this.yScale=1/Jt;const Hr=[];for(let Oe=0;Oe<this.triangleCount;Oe++){const Ue=Re[Le[3*Oe+0]].sub(this.min),qe=Re[Le[3*Oe+1]].sub(this.min),Ct=Re[Le[3*Oe+2]].sub(this.min),Ot=$c(Math.floor(Math.min(Ue.x,qe.x,Ct.x)),this.xScale,this.cellsX),Jr=$c(Math.floor(Math.max(Ue.x,qe.x,Ct.x)),this.xScale,this.cellsX),Ln=$c(Math.floor(Math.min(Ue.y,qe.y,Ct.y)),this.yScale,this.cellsY),Nn=$c(Math.floor(Math.max(Ue.y,qe.y,Ct.y)),this.yScale,this.cellsY),$n=new Is(0,0),Gn=new Is(0,0),qn=new Is(0,0),Zn=new Is(0,0);for(let Re=Ln;Re<=Nn;++Re){$n.y=Gn.y=Re*Jt,qn.y=Zn.y=(Re+1)*Jt;for(let Le=Ot;Le<=Jr;++Le)$n.x=qn.x=Le*Jt,Gn.x=Zn.x=(Le+1)*Jt,($l(Ue,qe,Ct,$n,Gn,Zn)||$l(Ue,qe,Ct,$n,Zn,qn))&&Hr.push({cellIdx:Re*this.cellsX+Le,triIdx:Oe})}}if(0===Hr.length)return;Hr.sort(((Re,Le)=>Re.cellIdx-Le.cellIdx||Re.triIdx-Le.triIdx));let Jr=0;for(;Jr<Hr.length;){const Re=Hr[Jr].cellIdx,Le={start:this.payload.length,len:0};for(;Jr<Hr.length&&Hr[Jr].cellIdx===Re;)++Le.len,this.payload.push(Hr[Jr++].triIdx);this.cells[Re]=Le}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(Re,Le){if(0===this.triangleCount||0===this.cells.length)return;if(Re.x>this.max.x||this.min.x>Re.x||Re.y>this.max.y||this.min.y>Re.y)return;const Oe=$c(Re.x-this.min.x,this.xScale,this.cellsX),Ue=$c(Re.y-this.min.y,this.yScale,this.cellsY),qe=this.cells[Ue*this.cellsX+Oe];if(qe){this._lazyInitLookup();for(let Re=0;Re<qe.len;Re++){const Oe=this.payload[qe.start+Re],Ue=Math.floor(Oe/8),Ct=1<<Oe%8;if(!(this.lookup[Ue]&Ct)&&(this.lookup[Ue]|=Ct,Le.push(Oe),Le.length===this.triangleCount))return}}}query(Re,Le,Oe){if(0===this.triangleCount||0===this.cells.length)return;if(Re.x>this.max.x||this.min.x>Le.x)return;if(Re.y>this.max.y||this.min.y>Le.y)return;this._lazyInitLookup();const Ue=$c(Re.x-this.min.x,this.xScale,this.cellsX),qe=$c(Le.x-this.min.x,this.xScale,this.cellsX),Ct=$c(Re.y-this.min.y,this.yScale,this.cellsY),Ot=$c(Le.y-this.min.y,this.yScale,this.cellsY);for(let Re=Ct;Re<=Ot;Re++)for(let Le=Ue;Le<=qe;Le++){const Ue=this.cells[Re*this.cellsX+Le];if(Ue)for(let Re=0;Re<Ue.len;Re++){const Le=this.payload[Ue.start+Re],qe=Math.floor(Le/8),Ct=1<<Le%8;if(!(this.lookup[qe]&Ct)&&(this.lookup[qe]|=Ct,Oe.push(Le),Oe.length===this.triangleCount))return}}}}function $c(Re,Le,Oe){return Math.max(0,Math.min(Oe-1,Math.floor(Re*Le)))}os(qc,"TriangleGridIndex");class Gc{constructor(Re){this.zoom=Re.zoom,this.layers=Re.layers,this.layerIds=this.layers.map((Re=>Re.fqid)),this.index=Re.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter((Re=>Re.isStateDependent())).map((Re=>Re.id)),this.footprints=[]}updateFootprints(Re,Le){for(const Oe of this.footprints)Le.push({footprint:Oe,id:Re})}populate(Re,Le,Oe,Ue){const qe=[];for(const{feature:Le,id:Ct,index:Ot,sourceLayerIndex:Jt}of Re){const Re=this.layers[0]._featureFilter.needGeometry,Hr=Pl(Le,Re);if(!this.layers[0]._featureFilter.filter(new Vs(this.zoom),Hr,Oe))continue;const Jr={id:Ct,properties:Le.properties,type:Le.type,sourceLayerIndex:Jt,index:Ot,geometry:Re?Hr.geometry:Il(Le,Oe,Ue),patterns:{}};qe.push(Jr)}for(const Ue of qe){const{geometry:qe,index:Ct,sourceLayerIndex:Ot}=Ue;this.addFeature(Ue,qe,Ct,Oe,{},Le.availableImages,Le.brightness),Le.featureIndex.insert(Re[Ct].feature,qe,Ct,Ot,this.index)}}isEmpty(){return 0===this.footprints.length}uploadPending(){return!1}upload(Re){}update(Re,Le,Oe,Ue,qe){}destroy(){}addFeature(Re,Le,Oe,Ue,qe,Ct=[],Ot){for(const Re of Cc(Le,2)){const Le=[],Oe=[],Ue=[],qe=new Is(1/0,1/0),Ct=new Is(-1/0,-1/0);for(const Ot of Re)if(0!==Ot.length){Ot!==Re[0]&&Ue.push(Oe.length/2);for(let Re=0;Re<Ot.length;Re++)Oe.push(Ot[Re].x),Oe.push(Ot[Re].y),Le.push(Ot[Re]),qe.x=Math.min(qe.x,Ot[Re].x),qe.y=Math.min(qe.y,Ot[Re].y),Ct.x=Math.max(Ct.x,Ot[Re].x),Ct.y=Math.max(Ct.y,Ot[Re].y)}const Ot=uc(Oe,Ue),Jt=new qc(Le,Ot,8,256);this.footprints.push({vertices:Le,indices:Ot,grid:Jt,min:qe,max:Ct})}}}os(Gc,"ClipBucket",{omit:["layers"]});const mg=ya([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),yg=ya([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),vg=ya([{name:"a_centroid_pos",components:2,type:"Uint16"}]),xg=ya([{name:"a_join_normal_inside",components:3,type:"Int16"}]),bg=ya([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),wg=ya([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:Tg}=mg;var Sg,Eg,Cg,Ig,Rg,Og,zg,Bg={};function oh(){if(Eg)return Sg;Eg=1;var Re=N();function e(Re,Le,Oe,Ue,qe){this.properties={},this.extent=Oe,this.type=0,this._pbf=Re,this._geometry=-1,this._keys=Ue,this._values=qe,Re.readFields(r,this,Le)}function r(Re,Le,Oe){1==Re?Le.id=Oe.readVarint():2==Re?function(Re,Le){for(var Oe=Re.readVarint()+Re.pos;Re.pos<Oe;){var Ue=Le._keys[Re.readVarint()],qe=Le._values[Re.readVarint()];Le.properties[Ue]=qe}}(Oe,Le):3==Re?Le.type=Oe.readVarint():4==Re&&(Le._geometry=Oe.pos)}function n(Re){for(var Le,Oe,Ue=0,qe=0,Ct=Re.length,Ot=Ct-1;qe<Ct;Ot=qe++)Ue+=((Oe=Re[Ot]).x-(Le=Re[qe]).x)*(Le.y+Oe.y);return Ue}return Sg=e,e.types=["Unknown","Point","LineString","Polygon"],e.prototype.loadGeometry=function(){var Le=this._pbf;Le.pos=this._geometry;for(var Oe,Ue=Le.readVarint()+Le.pos,qe=1,Ct=0,Ot=0,Jt=0,Hr=[];Le.pos<Ue;){if(Ct<=0){var Jr=Le.readVarint();qe=7&Jr,Ct=Jr>>3}if(Ct--,1===qe||2===qe)Ot+=Le.readSVarint(),Jt+=Le.readSVarint(),1===qe&&(Oe&&Hr.push(Oe),Oe=[]),Oe.push(new Re(Ot,Jt));else{if(7!==qe)throw new Error("unknown command "+qe);Oe&&Oe.push(Oe[0].clone())}}return Oe&&Hr.push(Oe),Hr},e.prototype.bbox=function(){var Re=this._pbf;Re.pos=this._geometry;for(var Le=Re.readVarint()+Re.pos,Oe=1,Ue=0,qe=0,Ct=0,Ot=1/0,Jt=-1/0,Hr=1/0,Jr=-1/0;Re.pos<Le;){if(Ue<=0){var Ln=Re.readVarint();Oe=7&Ln,Ue=Ln>>3}if(Ue--,1===Oe||2===Oe)(qe+=Re.readSVarint())<Ot&&(Ot=qe),qe>Jt&&(Jt=qe),(Ct+=Re.readSVarint())<Hr&&(Hr=Ct),Ct>Jr&&(Jr=Ct);else if(7!==Oe)throw new Error("unknown command "+Oe)}return[Ot,Hr,Jt,Jr]},e.prototype.toGeoJSON=function(Re,Le,Oe){var Ue,qe,Ct=this.extent*Math.pow(2,Oe),Ot=this.extent*Re,Jt=this.extent*Le,Hr=this.loadGeometry(),Jr=e.types[this.type];function p(Re){for(var Le=0;Le<Re.length;Le++){var Oe=Re[Le];Re[Le]=[360*(Oe.x+Ot)/Ct-180,360/Math.PI*Math.atan(Math.exp((180-360*(Oe.y+Jt)/Ct)*Math.PI/180))-90]}}switch(this.type){case 1:var Ln=[];for(Ue=0;Ue<Hr.length;Ue++)Ln[Ue]=Hr[Ue][0];p(Hr=Ln);break;case 2:for(Ue=0;Ue<Hr.length;Ue++)p(Hr[Ue]);break;case 3:for(Hr=function(Re){var Le=Re.length;if(Le<=1)return[Re];for(var Oe,Ue,qe=[],Ct=0;Ct<Le;Ct++){var Ot=n(Re[Ct]);0!==Ot&&(void 0===Ue&&(Ue=Ot<0),Ue===Ot<0?(Oe&&qe.push(Oe),Oe=[Re[Ct]]):Oe.push(Re[Ct]))}return Oe&&qe.push(Oe),qe}(Hr),Ue=0;Ue<Hr.length;Ue++)for(qe=0;qe<Hr[Ue].length;qe++)p(Hr[Ue][qe])}1===Hr.length?Hr=Hr[0]:Jr="Multi"+Jr;var Nn={type:"Feature",geometry:{type:Jr,coordinates:Hr},properties:this.properties};return"id"in this&&(Nn.id=this.id),Nn},Sg}function lh(){if(Ig)return Cg;Ig=1;var Re=oh();function e(Re,Le){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=Re,this._keys=[],this._values=[],this._features=[],Re.readFields(r,this,Le),this.length=this._features.length}function r(Re,Le,Oe){15===Re?Le.version=Oe.readVarint():1===Re?Le.name=Oe.readString():5===Re?Le.extent=Oe.readVarint():2===Re?Le._features.push(Oe.pos):3===Re?Le._keys.push(Oe.readString()):4===Re&&Le._values.push(function(Re){for(var Le=null,Oe=Re.readVarint()+Re.pos;Re.pos<Oe;){var Ue=Re.readVarint()>>3;Le=1===Ue?Re.readString():2===Ue?Re.readFloat():3===Ue?Re.readDouble():4===Ue?Re.readVarint64():5===Ue?Re.readVarint():6===Ue?Re.readSVarint():7===Ue?Re.readBoolean():null}return Le}(Oe))}return Cg=e,e.prototype.feature=function(Le){if(Le<0||Le>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[Le];var Oe=this._pbf.readVarint()+this._pbf.pos;return new Re(this._pbf,Oe,this.extent,this._keys,this._values)},Cg}function uh(){return zg||(zg=1,Bg.VectorTile=function(){if(Og)return Rg;Og=1;var Re=lh();function e(Le,Oe,Ue){if(3===Le){var qe=new Re(Ue,Ue.readVarint()+Ue.pos);qe.length&&(Oe[qe.name]=qe)}}return Rg=function(Re,Le){this.layers=Re.readFields(e,{},Le)},Rg}(),Bg.VectorTileFeature=oh(),Bg.VectorTileLayer=lh()),Bg}var Fg=uh();class hh extends Is{constructor(Re,Le,Oe){super(Re,Le),this.z=Oe}}class ph extends hh{constructor(Re,Le,Oe,Ue){super(Re,Le,Oe),this.w=Ue}}function fh(Re,Le,Oe,Ue){const qe=[],Ct=0===Ue?(Re,Le,Oe,Ue,qe,Ct)=>{Re.push(new Is(Ct,Oe+(Ct-Le)/(Ue-Le)*(qe-Oe)))}:(Re,Le,Oe,Ue,qe,Ct)=>{Re.push(new Is(Le+(Ct-Oe)/(qe-Oe)*(Ue-Le),Ct))};for(const Ot of Re){const Re=[];for(const qe of Ot){if(qe.length<=2)continue;const Ot=[];for(let Re=0;Re<qe.length-1;Re++){const Jt=qe[Re].x,Hr=qe[Re].y,Jr=qe[Re+1].x,Ln=qe[Re+1].y,Nn=0===Ue?Jt:Hr,$n=0===Ue?Jr:Ln;Nn<Le?$n>Le&&Ct(Ot,Jt,Hr,Jr,Ln,Le):Nn>Oe?$n<Oe&&Ct(Ot,Jt,Hr,Jr,Ln,Oe):Ot.push(qe[Re]),$n<Le&&Nn>=Le&&Ct(Ot,Jt,Hr,Jr,Ln,Le),$n>Oe&&Nn<=Oe&&Ct(Ot,Jt,Hr,Jr,Ln,Oe)}let Jt=qe[qe.length-1];const Hr=0===Ue?Jt.x:Jt.y;Hr>=Le&&Hr<=Oe&&Ot.push(Jt),Ot.length&&(Jt=Ot[Ot.length-1],Ot[0].x===Jt.x&&Ot[0].y===Jt.y||Ot.push(Ot[0]),Re.push(Ot))}Re.length&&qe.push(Re)}return qe}function dh(Re,Le,Oe,Ue){const qe="x"===Oe?"y":"x",Ct=(Ue-Re[Oe])/(Le[Oe]-Re[Oe]);Re[qe]=Re[qe]+(Le[qe]-Re[qe])*Ct,Re[Oe]=Ue,Re.hasOwnProperty("z")&&(Re.z=ke(Re.z,Le.z,Ct)),Re.hasOwnProperty("w")&&(Re.w=ke(Re.w,Le.w,Ct))}function mh(Re,Le,Oe,Ue){const qe=Oe,Ct=Ue;for(const Oe of["x","y"]){let Ue=Re,Ot=Le;Ue[Oe]>=Ot[Oe]&&(Ue=Le,Ot=Re),Ue[Oe]<qe&&Ot[Oe]>qe&&dh(Ue,Ot,Oe,qe),Ue[Oe]<Ct&&Ot[Oe]>Ct&&dh(Ot,Ue,Oe,Ct)}}const Ng=Number.MAX_SAFE_INTEGER;function gh(Re,Le,Oe,Ue){return Re.order<Le||Re.order===Ng||!(Re.clipMask&Oe)||function(Re,Le){return 0!==Le.length&&void 0===Le.find((Le=>Le===Re))}(Ue,Re.clipScope)}function xh(Re,Le){return Re.x-Le.x||Re.y-Le.y}function bh(Re,Le){return 0===xh(Re.min,Le.min)&&0===xh(Re.max,Le.max)}function vh(Re,Le){return!(Re.min.x>Le.max.x||Re.max.x<Le.min.x||Re.min.y>Le.max.y||Re.max.y<Le.min.y)}function wh(Re,Le){if(Re.length!==Le.length)return!1;for(let Oe=0;Oe<Re.length;Oe++)if(Re[Oe].sourceId!==Le[Oe].sourceId||!bh(Re[Oe],Le[Oe])||Re[Oe].order!==Le[Oe].order||Re[Oe].clipMask!==Le[Oe].clipMask||!$(Re[Oe].clipScope,Le[Oe].clipScope))return!1;return!0}function _h(Re,Le,Oe){const Ue=1/id,qe=1/(1<<Oe.canonical.z),Ct=(Le.x*Ue+Oe.canonical.x)*qe+Oe.wrap,Ot=(Le.y*Ue+Oe.canonical.y)*qe;return{min:new Is((Re.x*Ue+Oe.canonical.x)*qe+Oe.wrap,(Re.y*Ue+Oe.canonical.y)*qe),max:new Is(Ct,Ot)}}function Mh(Re,Le,Oe){const Ue=1<<Oe.canonical.z,qe=((Le.x-Oe.wrap)*Ue-Oe.canonical.x)*id,Ct=(Le.y*Ue-Oe.canonical.y)*id;return{min:new Is(((Re.x-Oe.wrap)*Ue-Oe.canonical.x)*id,(Re.y*Ue-Oe.canonical.y)*id),max:new Is(qe,Ct)}}function Ah(Re,Le,Oe,Ue,qe,Ct,Ot){const Jt=Re.indices,Hr=Re.vertices,Jr=[];for(let Ln=Ue;Ln<Ue+qe;Ln+=3){const Ue=Le[Oe[Ln+0]+Ct],qe=Le[Oe[Ln+1]+Ct],Nn=Le[Oe[Ln+2]+Ct],$n=Math.min(Ue.x,qe.x,Nn.x),Gn=Math.max(Ue.x,qe.x,Nn.x),qn=Math.min(Ue.y,qe.y,Nn.y),Zn=Math.max(Ue.y,qe.y,Nn.y);Jr.length=0,Re.grid.query(new Is($n,qn),new Is(Gn,Zn),Jr);for(let Re=0;Re<Jr.length;Re++){const Le=Jr[Re];if($l(Hr[Jt[3*Le+0]],Hr[Jt[3*Le+1]],Hr[Jt[3*Le+2]],Ue,qe,Nn,Ot))return!0}}return!1}function Sh(Re,Le,Oe,Ue){if(!Re||!Oe)return!1;let qe=Re.vertices;if(!Le.canonical.equals(Ue.canonical)||Le.wrap!==Ue.wrap){if(Oe.vertices.length<Re.vertices.length)return Sh(Oe,Ue,Re,Le);const Ct=Le.canonical,Ot=Ue.canonical,Jt=Math.pow(2,Ot.z-Ct.z);qe=Re.vertices.map((Re=>new Is((Re.x+Ct.x*id)*Jt-Ot.x*id,(Re.y+Ct.y*id)*Jt-Ot.y*id)))}return Ah(Oe,qe,Re.indices,0,Re.indices.length,0,0)}function Ih(Re,Le,Oe,Ue){const qe=Math.pow(2,Ue.z-Oe.z);return new Is((Re+Oe.x*id)*qe-Ue.x*id,(Le+Oe.y*id)*qe-Ue.y*id)}function Ph(Re,Le){const Oe=[];Le.grid.queryPoint(Re,Oe);const Ue=Le.indices,qe=Le.vertices;for(let Le=0;Le<Oe.length;Le++){const Ct=Oe[Le];if(Ul([qe[Ue[3*Ct+0]],qe[Ue[3*Ct+1]],qe[Ue[3*Ct+2]]],Re))return!0}return!1}const Ug=[new Is(0,0),new Is(id,0),new Is(id,id),new Is(0,id)];function kh(Re,Le){const Oe=[];let Ue=[];if(!Le||Re.length<2)return[Re];if(2===Re.length)return Nl(Re[0],Re[1],Ug)?[Re]:[];for(let Le=0;Le<Re.length+2;Le++){const qe=Re[Le%Re.length],Ct=Re[(Le+1)%Re.length],Ot=Nl(0===Le?Re[Re.length-1]:Re[(Le-1)%Re.length],qe,Ug),Jt=Nl(qe,Ct,Ug),Hr=Ot||Jt;Hr&&Ue.push(qe),Hr&&Jt||Ue.length>0&&(Ue.length>1&&Oe.push(Ue),Ue=[])}return Ue.length>1&&Oe.push(Ue),Oe}const Vg=Fg.VectorTileFeature.types,$g=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius","fill-extrusion-line-width","fill-extrusion-emissive-strength"],Xg=["fill-extrusion-flood-light-ground-radius"],Yg=Math.pow(2,13),e_=Math.pow(2,15)-1,t_=new Is(0,1),r_=2147483648;function Lh(Re,Le,Oe,Ue,qe,Ct,Ot,Jt){Re.emplaceBack((Le<<1)+Ot,(Oe<<1)+Ct,(Math.floor(Ue*Yg)<<1)+qe,Math.round(Jt))}function Fh(Re,Le,Oe){Re.emplaceBack(Le.x*id,Le.y*id,Oe?1:0)}function Oh(Re,Le,Oe,Ue,qe,Ct){Re.emplaceBack(Le.x,Le.y,(Oe.x<<1)+Ue,(Oe.y<<1)+qe,Ct)}function Uh(Re,Le,Oe){const Ue=16384;Re.emplaceBack(Le.x,Le.y,Le.z,Oe[0]*Ue,Oe[1]*Ue,Oe[2]*Ue)}class jh{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class Nh{constructor(){this.centroidXY=new Is(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new Is(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new Is(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new Is(this.max.x-this.min.x,this.max.y-this.min.y)}}class qh{constructor(){this.acc=new Is(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(Re,Le){Re.min.x===Number.MAX_VALUE&&(Re.min.x=Re.max.x=Le.x,Re.min.y=Re.max.y=Le.y)}appendEdge(Re,Le,Oe){this.accCount++,this.acc._add(Le);let Ue=!!this.borders;Le.x<Re.min.x?(Re.min.x=Le.x,Ue=!0):Le.x>Re.max.x&&(Re.max.x=Le.x,Ue=!0),Le.y<Re.min.y?(Re.min.y=Le.y,Ue=!0):Le.y>Re.max.y&&(Re.max.y=Le.y,Ue=!0),((0===Le.x||Le.x===id)&&Le.x===Oe.x)!=((0===Le.y||Le.y===id)&&Le.y===Oe.y)&&this.processBorderOverlap(Le,Oe),Ue&&this.checkBorderIntersection(Le,Oe)}checkBorderIntersection(Re,Le){Le.x<0!=Re.x<0&&this.addBorderIntersection(0,ke(Le.y,Re.y,(0-Le.x)/(Re.x-Le.x))),Le.x>id!=Re.x>id&&this.addBorderIntersection(1,ke(Le.y,Re.y,(id-Le.x)/(Re.x-Le.x))),Le.y<0!=Re.y<0&&this.addBorderIntersection(2,ke(Le.x,Re.x,(0-Le.y)/(Re.y-Le.y))),Le.y>id!=Re.y>id&&this.addBorderIntersection(3,ke(Le.x,Re.x,(id-Le.y)/(Re.y-Le.y)))}addBorderIntersection(Re,Le){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const Oe=this.borders[Re];Le<Oe[0]&&(Oe[0]=Le),Le>Oe[1]&&(Oe[1]=Le)}processBorderOverlap(Re,Le){if(Re.x===Le.x){if(Re.y===Le.y)return;const Oe=0===Re.x?0:1;this.addBorderIntersection(Oe,Le.y),this.addBorderIntersection(Oe,Re.y)}else{const Oe=0===Re.y?2:3;this.addBorderIntersection(Oe,Le.x),this.addBorderIntersection(Oe,Re.x)}}centroid(){return 0===this.accCount?new Is(0,0):new Is(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce(((Re,Le)=>Re+ +(Le[0]!==Number.MAX_VALUE)),0):0}}function $h(Re,Le){const Oe=Re.add(Le)._unit(),Ue=Q(Re.x*Oe.x+Re.y*Oe.y,-1,1);var qe,Ct,Ot;return Ot=Math.acos(Ue),Math.min(4,Math.max(-4,Math.tan(Ot)))/4*e_*((qe=Re).x*(Ct=Le).y-qe.y*Ct.x<0?-1:1)}const n_=[Re=>Re.x<0,Re=>Re.x>id,Re=>Re.y<0,Re=>Re.y>id];function Xh(Re,Le,Oe,Ue){const qe=[4];if(0===Ue)return qe;Oe._mult(Ue);const Ct=Re.sub(Oe),Ot=Le.sub(Oe),Jt=[Re,Le,Ct,Ot];for(let Re=0;Re<4;Re++)for(const Le of Jt)if(n_[Re](Le)){qe.push(Re);break}return qe}class Yh{constructor(Re){this.vertexArray=new wa,this.indexArray=new Da,this.programConfigurations=new Fo(Re.layers,{zoom:Re.zoom,lut:Re.lut},(Re=>Xg.includes(Re))),this._segments=new co,this.hiddenByLandmarkVertexArray=new Za,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new co}getDefaultSegment(){return this.regionSegments[4]}hasData(){return 0!==this.vertexArray.length}addData(Re,Le,Oe,Ue=!1){const qe=Re.length;if(qe>2){let Ct=Math.max(0,this._segments.get().length-1);const Ot=this._segments._prepareSegment(4*qe,this.vertexArray.length,2*this._segmentToGroundQuads[Ct].length);let Jt;Ct!==this._segments.get().length-1&&(Ct++,this._segmentToGroundQuads[Ct]=[],this._segmentToRegionTriCounts[Ct]=[0,0,0,0,0]);{const Le=Re[0],Oe=Re[1];Jt=$h(Le.sub(Re[qe-1])._perp()._unit(),Oe.sub(Le)._perp()._unit())}for(let Hr=0;Hr<qe;Hr++){const Jr=Hr===qe-1?0:Hr+1,Ln=Re[Hr],Nn=Re[Jr],$n=Re[Jr===qe-1?0:Jr+1],Gn=Nn.sub(Ln)._perp()._unit(),qn=$h(Gn,$n.sub(Nn)._perp()._unit()),Zn=Jt,Xn=qn;if(Jh(Ln,Nn,Le)||Ue&&Qh(Ln,Le)&&Qh(Nn,Le)){Jt=qn;continue}const Yn=Ot.vertexLength;Oh(this.vertexArray,Ln,Nn,1,1,Zn),Oh(this.vertexArray,Ln,Nn,1,0,Zn),Oh(this.vertexArray,Ln,Nn,0,1,Xn),Oh(this.vertexArray,Ln,Nn,0,0,Xn),Ot.vertexLength+=4;const _i=Xh(Ln,Nn,Gn,Oe);for(const Re of _i)this._segmentToGroundQuads[Ct].push({id:Yn,region:Re}),this._segmentToRegionTriCounts[Ct][Re]+=2,Ot.primitiveLength+=2;Jt=qn}}}prepareBorderSegments(){if(!this.hasData())return;const Re=this._segments.get(),Le=Re.length;for(let Re=0;Re<Le;Re++)this._segmentToGroundQuads[Re].sort(((Re,Le)=>Re.region-Le.region));for(let Oe=0;Oe<Le;Oe++){const Le=this._segmentToGroundQuads[Oe],Ue=Re[Oe],qe=this._segmentToRegionTriCounts[Oe];qe.reduce(((Re,Le)=>Re+Le),0);let Ct=0;for(let Re=0;Re<=4;Re++){const Le=qe[Re];if(0!==Le){let Oe=this.regionSegments[Re];Oe||(Oe=this.regionSegments[Re]=new co);const qe={vertexOffset:Ue.vertexOffset,primitiveOffset:Ue.primitiveOffset+Ct,vertexLength:Ue.vertexLength,primitiveLength:Le};Oe.get().push(qe)}Ct+=Le}for(let Re=0;Re<Le.length;Re++){const Oe=Le[Re].id;this.indexArray.emplaceBack(Oe,Oe+1,Oe+3),this.indexArray.emplaceBack(Oe,Oe+3,Oe+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(Re,Le,Oe,Ue,qe,Ct){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,Re,Le,Oe,Ue,qe,Ct)}upload(Re){this.hasData()&&(this.vertexBuffer=Re.createVertexBuffer(this.vertexArray,yg.members),this.indexBuffer=Re.createIndexBuffer(this.indexArray))}uploadPaintProperties(Re){this.hasData()&&this.programConfigurations.upload(Re)}update(Re,Le,Oe,Ue,qe,Ct){this.hasData()&&this.programConfigurations.updatePaintArrays(Re,Le,Oe,Ue,qe,Ct)}updateHiddenByLandmark(Re){if(!this.hasData())return;const Le=Re.groundVertexCount+Re.groundVertexArrayOffset;if(0===Re.groundVertexCount)return;const Oe=Re.flags&r_?1:0;for(let Ue=Re.groundVertexArrayOffset;Ue<Le;++Ue)this.hiddenByLandmarkVertexArray.emplace(Ue,Oe);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(Re){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=Re.createVertexBuffer(this.hiddenByLandmarkVertexArray,bg.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let Re=0;Re<=4;Re++){const Le=this.regionSegments[Re];Le&&Le.destroy()}}}}class Zh{constructor(Re){this.zoom=Re.zoom,this.canonical=Re.canonical,this.overscaling=Re.overscaling,this.layers=Re.layers,this.layerIds=this.layers.map((Re=>Re.fqid)),this.index=Re.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=Re.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new Da,this.footprintVertices=new xa,this.footprintSegments=[],this.layoutVertexArray=new va,this.centroidVertexArray=new so,this.wallVertexArray=new oo,this.indexArray=new Da,this.programConfigurations=new Fo(Re.layers,{zoom:Re.zoom,lut:Re.lut},(Re=>$g.includes(Re))),this.segments=new co,this.stateDependentLayerIds=this.layers.filter((Re=>Re.isStateDependent())).map((Re=>Re.id)),this.groundEffect=new Yh(Re),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}updateFootprints(Re,Le){}populate(Re,Le,Oe,Ue){this.features=[],this.hasPattern=Dc("fill-extrusion",this.layers,Le),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=gl(Oe),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter,this.wallMode=0!==this.layers[0].paint.get("fill-extrusion-line-width").constantOr(1);for(const{feature:qe,id:Ct,index:Ot,sourceLayerIndex:Jt}of Re){const Re=this.layers[0]._featureFilter.needGeometry,Hr=Pl(qe,Re);if(!this.layers[0]._featureFilter.filter(new Vs(this.zoom),Hr,Oe))continue;const Jr={id:Ct,sourceLayerIndex:Jt,index:Ot,geometry:Re?Hr.geometry:Il(qe,Oe,Ue),properties:qe.properties,type:qe.type,patterns:{}},Ln=this.layoutVertexArray.length,Nn="Polygon"===Vg[Jr.type];if(this.hasPattern)this.features.push(Lc("fill-extrusion",this.layers,Jr,this.zoom,Le));else if(this.wallMode)for(const Re of Jr.geometry)for(const qe of kh(Re,Nn))this.addFeature(Jr,[qe],Ot,Oe,{},Le.availableImages,Ue,Le.brightness);else this.addFeature(Jr,Jr.geometry,Ot,Oe,{},Le.availableImages,Ue,Le.brightness);Le.featureIndex.insert(qe,Jr.geometry,Ot,Jt,this.index,Ln)}this.sortBorders(),"mercator"===this.projection.name&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(Re,Le,Oe,Ue,qe,Ct){for(const Re of this.features){const Ot="Polygon"===Vg[Re.type],{geometry:Jt}=Re;if(this.wallMode)for(const Hr of Jt)for(const Jt of kh(Hr,Ot))this.addFeature(Re,[Jt],Re.index,Le,Oe,Ue,qe,Ct);else this.addFeature(Re,Jt,Re.index,Le,Oe,Ue,qe,Ct)}this.sortBorders(),"mercator"===this.projection.name&&this.splitToSubtiles()}update(Re,Le,Oe,Ue,qe){const Ct=0!==Object.keys(Re).length;if(Ct&&!this.stateDependentLayers.length)return;const Ot=Ct?this.stateDependentLayers:this.layers;this.programConfigurations.updatePaintArrays(Re,Le,Ot,Oe,Ue,qe),this.groundEffect.update(Re,Le,Ot,Oe,Ue,qe)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(Re){this.uploaded||(this.layoutVertexBuffer=Re.createVertexBuffer(this.layoutVertexArray,Tg),this.indexBuffer=Re.createIndexBuffer(this.indexArray),this.wallVertexBuffer=Re.createVertexBuffer(this.wallVertexArray,xg.members),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=Re.createVertexBuffer(this.layoutVertexExtArray,wg.members,!0)),this.groundEffect.upload(Re)),this.groundEffect.uploadPaintProperties(Re),this.programConfigurations.upload(Re),this.uploaded=!0}uploadCentroid(Re){this.groundEffect.uploadHiddenByLandmark(Re),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=Re.createVertexBuffer(this.centroidVertexArray,vg.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(Re,Le,Oe,Ue,qe,Ct,Ot,Jt){const Hr=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(Re,{})/this.tileToMeter,Jr=[new Is(0,0),new Is(id,id)],Ln=Ot.projection,Nn="globe"===Ln.name,$n=this.wallMode||"Polygon"===Vg[Re.type],Gn=new qh;Gn.centroidDataIndex=this.centroidData.length;const qn=new Nh,Zn=this.layers[0].paint.get("fill-extrusion-base").evaluate(Re,{},Ue)<=0,Xn=this.layers[0].paint.get("fill-extrusion-height").evaluate(Re,{},Ue);let Yn;if(qn.height=Xn,qn.vertexArrayOffset=this.layoutVertexArray.length,qn.groundVertexArrayOffset=this.groundEffect.vertexArray.length,Nn&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Pa),this.wallMode){if(Nn)return void ft("Non zero fill-extrusion-line-width is not yet supported on globe.");if(1!==Le.length)return;Yn=function(Re){const Le=Re[0].x===Re[Re.length-1].x&&Re[0].y===Re[Re.length-1].y,Oe=function(Re){let Le=0;const Oe=Re.length;for(let Ue=0;Ue<Oe;Ue++)Le+=(Re[(Ue+1)%Oe].x-Re[Ue].x)*(Re[(Ue+1)%Oe].y+Re[Ue].y);return Le>=0}(Re);Oe||(Re=Re.reverse());const Ue={geometry:[],joinNormals:[],indices:[]},qe=[],Ct=[],Ot=[];let Jt=Re.length;if(Jt<(Le?3:2))return Ue;for(;Jt>=2&&Re[Jt-1].equals(Re[Jt-2]);)Jt--;let Hr,Jr,Ln,Nn,$n,Gn=0;for(;Gn<Jt-1&&Re[Gn].equals(Re[Gn+1]);)Gn++;Le&&(Hr=Re[Jt-2],$n=Re[Gn].sub(Hr)._unit()._perp());for(let Oe=Gn;Oe<Jt;Oe++){if(Ln=Oe===Jt-1?Le?Re[Gn+1]:void 0:Re[Oe+1],Ln&&Re[Oe].equals(Ln))continue;$n&&(Nn=$n),Hr&&(Jr=Hr),Hr=Re[Oe],$n=Ln?Ln.sub(Hr)._unit()._perp():Nn,Nn=Nn||$n;let Ue=Nn.add($n);0===Ue.x&&0===Ue.y||Ue._unit();const qn=Ue.x*$n.x+Ue.y*$n.y,Zn=0!==qn?1/qn:1/0,Xn=Nn.x*$n.y-Nn.y*$n.x>0;let Yn="miter";const _i=2;"miter"===Yn&&Zn>_i&&(Yn="bevel"),"bevel"===Yn&&(Zn>100&&(Yn="flipbevel"),Zn<_i&&(Yn="miter"));const b=(Re,Le,Oe,Ue)=>{const Jt=new Is(Re.x,Re.y),Hr=new Is(Re.x,Re.y);Jt.x+=Le.x*Ue,Jt.y+=Le.y*Ue,Hr.x-=Le.x*Math.max(Oe,1),Hr.y-=Le.y*Math.max(Oe,1),Ot.push(Le),qe.push(Jt),Ct.push(Hr)};if("miter"===Yn)Ue._mult(Zn),b(Hr,Ue,0,0);else if("flipbevel"===Yn)Ue=$n.mult(-1),b(Hr,Ue,0,0),b(Hr,Ue.mult(-1),0,0);else{const Re=-Math.sqrt(Zn*Zn-1),Le=Xn?Re:0,Oe=Xn?0:Re;Jr&&b(Hr,Nn,Le,Oe),Ln&&b(Hr,$n,Le,Oe)}}Ue.geometry=[...qe,...Ct.reverse(),qe[0]],Ue.joinNormals=[...Ot,...Ot.reverse(),Ot[Ot.length-1]];const qn=Ue.geometry.length-1;for(let Re=0;Re<qn/2;Re++)if(Re+1<qn/2){let Le=Re,Oe=Re+1,qe=qn-1-Re,Ct=qn-2-Re;Le=0===Le?qn-1:Le-1,Oe=0===Oe?qn-1:Oe-1,qe=0===qe?qn-1:qe-1,Ct=0===Ct?qn-1:Ct-1,Ue.indices.push(qe),Ue.indices.push(Oe),Ue.indices.push(Le),Ue.indices.push(qe),Ue.indices.push(Ct),Ue.indices.push(Oe)}return Ue}(Le[0]),Le=[Yn.geometry]}const x=(Re,Le)=>Re<(Le.length-1)/2||Re===Le.length-1,_i=this.wallMode?[Le]:Cc(Le,500);for(let Re=_i.length-1;Re>=0;Re--){const Le=_i[Re];(0===Le.length||(vi=Le[0]).every((Re=>Re.x<=0))||vi.every((Re=>Re.x>=id))||vi.every((Re=>Re.y<=0))||vi.every((Re=>Re.y>=id)))&&_i.splice(Re,1)}var vi;let xi;if(Nn)xi=np(_i,Jr,Ue);else{xi=[];for(const Re of _i)xi.push({polygon:Re,bounds:Jr})}const bi=$n?this.edgeRadius:0,Pi=bi>0&&this.zoom<17,A=(Re,Le)=>{if(0===Re.length)return!1;const Oe=Re[Re.length-1];return Le.x===Oe.x&&Le.y===Oe.y};for(const{polygon:Re,bounds:Le}of xi){let Oe=0,qe=0;for(const Le of Re)$n&&!Le[0].equals(Le[Le.length-1])&&Le.push(Le[0]),qe+=$n?Le.length-1:Le.length;const Ct=this.segments.prepareSegment(($n?5:4)*qe,this.layoutVertexArray,this.indexArray);qn.footprintSegIdx<0&&(qn.footprintSegIdx=this.footprintSegments.length),qn.polygonSegIdx<0&&(qn.polygonSegIdx=this.polygonSegments.length);const Ot={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},Jt=new jh;if(Jt.vertexOffset=this.footprintVertices.length,Jt.indexOffset=3*this.footprintIndices.length,Jt.ringIndices=[],$n){const qe=[],Ot=[];Oe=Ct.vertexLength;for(let Oe=0;Oe<Re.length;Oe++){const Jr=Re[Oe];Jr.length&&0!==Oe&&Ot.push(qe.length/2);const $n=[];let Gn,qn;Gn=Jr[1].sub(Jr[0])._perp()._unit(),Jt.ringIndices.push(Jr.length-1);for(let Re=1;Re<Jr.length;Re++){const Le=Jr[Re],Oe=Jr[Re===Jr.length-1?1:Re+1],Ot=Le.clone();if(bi){qn=Oe.sub(Le)._perp()._unit();const Re=Gn.add(qn)._unit(),Ue=bi*Math.min(4,1/(Gn.x*Re.x+Gn.y*Re.y));Ot.x+=Ue*Re.x,Ot.y+=Ue*Re.y,Ot.x=Math.round(Ot.x),Ot.y=Math.round(Ot.y),Gn=qn}if(!Zn||0!==bi&&!Pi||A($n,Ot)||$n.push(Ot),Lh(this.layoutVertexArray,Ot.x,Ot.y,0,0,1,1,0),this.wallMode){const Le=x(Re,Jr);Fh(this.wallVertexArray,Yn.joinNormals[Re],!Le)}Ct.vertexLength++,this.footprintVertices.emplaceBack(Le.x,Le.y),qe.push(Le.x,Le.y),Nn&&Uh(this.layoutVertexExtArray,Ln.projectTilePoint(Ot.x,Ot.y,Ue),Ln.upVector(Ue,Ot.x,Ot.y))}Zn&&(0===bi||Pi)&&(0!==$n.length&&A($n,$n[0])&&$n.pop(),this.groundEffect.addData($n,Le,Hr))}const Jr=this.wallMode?Yn.indices:uc(qe,Ot);for(let Re=0;Re<Jr.length;Re+=3)this.footprintIndices.emplaceBack(Jt.vertexOffset+Jr[Re+0],Jt.vertexOffset+Jr[Re+1],Jt.vertexOffset+Jr[Re+2]),this.indexArray.emplaceBack(Oe+Jr[Re],Oe+Jr[Re+2],Oe+Jr[Re+1]),Ct.primitiveLength++;Jt.indexCount+=Jr.length,Jt.vertexCount+=this.footprintVertices.length-Jt.vertexOffset}for(let qe=0;qe<Re.length;qe++){const Ot=Re[qe];Gn.startRing(qn,Ot[0]);let Jt=Ot.length>4&&tp(Ot[Ot.length-2],Ot[0],Ot[1]),Jr=bi?Hh(Ot[Ot.length-2],Ot[0],Ot[1],bi):0;const Xn=[];let _i,vi,xi;vi=Ot[1].sub(Ot[0])._perp()._unit();let Pi=!0;for(let Re=1,qe=0;Re<Ot.length;Re++){let Hr=Ot[Re-1],$n=Ot[Re];const lo=Ot[Re===Ot.length-1?1:Re+1];if(Gn.appendEdge(qn,$n,Hr),Jh($n,Hr,Le)){bi&&(vi=lo.sub($n)._perp()._unit(),Pi=!Pi);continue}const uo=$n.sub(Hr)._perp(),po=uo.x/(Math.abs(uo.x)+Math.abs(uo.y)),fo=uo.y>0?1:0,Io=Hr.dist($n);if(qe+Io>32768&&(qe=0),bi){xi=lo.sub($n)._perp()._unit();let Re=Kh(Hr,$n,lo,Wh(vi,xi),bi);isNaN(Re)&&(Re=0);const Le=$n.sub(Hr)._unit();Hr=Hr.add(Le.mult(Jr))._round(),$n=$n.add(Le.mult(-Re))._round(),Jr=Re,vi=xi,Zn&&this.zoom>=17&&(A(Xn,Hr)||Xn.push(Hr),A(Xn,$n)||Xn.push($n))}const is=Ct.vertexLength,as=Ot.length>4&&tp(Hr,$n,lo);let Is=ep(qe,Jt,Pi);if(Lh(this.layoutVertexArray,Hr.x,Hr.y,po,fo,0,0,Is),Lh(this.layoutVertexArray,Hr.x,Hr.y,po,fo,0,1,Is),this.wallMode){const Le=x(Re-1,Ot),Oe=Yn.joinNormals[Re-1];Fh(this.wallVertexArray,Oe,Le),Fh(this.wallVertexArray,Oe,Le)}if(qe+=Io,Is=ep(qe,as,!Pi),Jt=as,Lh(this.layoutVertexArray,$n.x,$n.y,po,fo,0,0,Is),Lh(this.layoutVertexArray,$n.x,$n.y,po,fo,0,1,Is),this.wallMode){const Le=x(Re,Ot),Oe=Yn.joinNormals[Re];Fh(this.wallVertexArray,Oe,Le),Fh(this.wallVertexArray,Oe,Le)}if(Ct.vertexLength+=4,this.indexArray.emplaceBack(is+0,is+1,is+2),this.indexArray.emplaceBack(is+1,is+3,is+2),Ct.primitiveLength+=2,bi){const Ue=Oe+(1===Re?Ot.length-2:Re-2),qe=1===Re?Oe:Ue+1;if(this.indexArray.emplaceBack(is+1,Ue,is+3),this.indexArray.emplaceBack(Ue,qe,is+3),Ct.primitiveLength+=2,void 0===_i&&(_i=is),!Jh(lo,Ot[Re],Le)){const Le=Re===Ot.length-1?_i:Ct.vertexLength;this.indexArray.emplaceBack(is+2,is+3,Le),this.indexArray.emplaceBack(is+3,Le+1,Le),this.indexArray.emplaceBack(is+3,qe,Le+1),Ct.primitiveLength+=3}Pi=!Pi}if(Nn){const Re=this.layoutVertexExtArray,Le=Ln.projectTilePoint(Hr.x,Hr.y,Ue),Oe=Ln.projectTilePoint($n.x,$n.y,Ue),qe=Ln.upVector(Ue,Hr.x,Hr.y),Ct=Ln.upVector(Ue,$n.x,$n.y);Uh(Re,Le,qe),Uh(Re,Le,qe),Uh(Re,Oe,Ct),Uh(Re,Oe,Ct)}}$n&&(Oe+=Ot.length-1),Zn&&bi&&this.zoom>=17&&(0!==Xn.length&&A(Xn,Xn[0])&&Xn.pop(),this.groundEffect.addData(Xn,Le,Hr,bi>0))}this.footprintSegments.push(Jt),Ot.triangleCount=this.indexArray.length-Ot.triangleArrayOffset,this.polygonSegments.push(Ot),++qn.footprintSegLen,++qn.polygonSegLen}if(qn.vertexCount=this.layoutVertexArray.length-qn.vertexArrayOffset,qn.groundVertexCount=this.groundEffect.vertexArray.length-qn.groundVertexArrayOffset,0!==qn.vertexCount){if(qn.centroidXY=Gn.borders?t_:this.encodeCentroid(Gn,qn),this.centroidData.push(qn),Gn.borders){this.featuresOnBorder.push(Gn);const Re=this.featuresOnBorder.length-1;for(let Le=0;Le<Gn.borders.length;Le++)Gn.borders[Le][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[Le].push(Re)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,Re,Oe,qe,Ct,Ue,Jt),this.groundEffect.addPaintPropertiesData(Re,Oe,qe,Ct,Ue,Jt),this.maxHeight=Math.max(this.maxHeight,Xn)}}sortBorders(){for(let Re=0;Re<this.borderFeatureIndices.length;Re++)this.borderFeatureIndices[Re].sort(((Le,Oe)=>this.featuresOnBorder[Le].borders[Re][0]-this.featuresOnBorder[Oe].borders[Re][0]))}splitToSubtiles(){const Re=[];for(let Le=0;Le<this.centroidData.length;Le++){const Oe=this.centroidData[Le],Ue=+(Oe.min.y+Oe.max.y>id),qe=2*Ue+(+(Oe.min.x+Oe.max.x>id)^Ue);for(let Ue=0;Ue<Oe.polygonSegLen;Ue++){const Ct=Oe.polygonSegIdx+Ue;Re.push({centroidIdx:Le,subtile:qe,polygonSegmentIdx:Ct,triangleSegmentIdx:this.polygonSegments[Ct].triangleSegIdx})}}const Le=new Da;Re.sort(((Re,Le)=>Re.triangleSegmentIdx===Le.triangleSegmentIdx?Re.subtile-Le.subtile:Re.triangleSegmentIdx-Le.triangleSegmentIdx));let Oe=0,Ue=0,qe=0;for(const Le of Re){if(Le.triangleSegmentIdx!==Oe)break;qe++}const Ct=Re.length;for(;Ue!==Re.length;){Oe=Re[Ue].triangleSegmentIdx;let Ot=0,Jt=Ue,Hr=Ue;for(let Le=Jt;Le<qe&&Re[Le].subtile===Ot;Le++)Hr++;for(;Jt!==qe;){const Ue=Re[Jt];Ot=Ue.subtile;const Ct=this.centroidData[Ue.centroidIdx].min.clone(),Jr=this.centroidData[Ue.centroidIdx].max.clone(),Ln={vertexOffset:this.segments.segments[Oe].vertexOffset,primitiveOffset:Le.length,vertexLength:this.segments.segments[Oe].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let Oe=Jt;Oe<Hr;Oe++){const Ue=Re[Oe],qe=this.polygonSegments[Ue.polygonSegmentIdx],Ot=this.centroidData[Ue.centroidIdx].min,Jt=this.centroidData[Ue.centroidIdx].max,Hr=this.indexArray.uint16;for(let Re=qe.triangleArrayOffset;Re<qe.triangleArrayOffset+qe.triangleCount;Re++)Le.emplaceBack(Hr[3*Re],Hr[3*Re+1],Hr[3*Re+2]);Ln.primitiveLength+=qe.triangleCount,Ct.x=Math.min(Ct.x,Ot.x),Ct.y=Math.min(Ct.y,Ot.y),Jr.x=Math.max(Jr.x,Jt.x),Jr.y=Math.max(Jr.y,Jt.y)}Ln.primitiveLength>0&&this.triangleSubSegments.push({segment:Ln,min:Ct,max:Jr}),Jt=Hr;for(let Le=Jt;Le<qe&&Re[Le].subtile===Re[Jt].subtile;Le++)Hr++}Ue=qe;for(let Le=Ue;Le<Ct&&Re[Le].triangleSegmentIdx===Re[Ue].triangleSegmentIdx;Le++)qe++}Le._trim(),this.indexArray=Le}getVisibleSegments(Re,Le,Oe){const Ue=new co;if(this.wallMode){for(const Re of this.triangleSubSegments)Ue.segments.push(Re.segment);return Ue}let qe=0,Ct=0;const Ot=1<<Re.canonical.z;if(Le){const Oe=Le.getMinMaxForTile(Re);Oe&&(qe=Oe.min,Ct=Oe.max)}Ct+=this.maxHeight;const Jt=Re.toUnwrapped();let Hr;const Jr=[Jt.canonical.x/Ot+Jt.wrap,Jt.canonical.y/Ot],Ln=[(Jt.canonical.x+1)/Ot+Jt.wrap,(Jt.canonical.y+1)/Ot],h=(Re,Le,Oe)=>[Re[0]*(1-Oe[0])+Le[0]*Oe[0],Re[1]*(1-Oe[1])+Le[1]*Oe[1]],Nn=[],$n=[];for(const Re of this.triangleSubSegments){Nn[0]=Re.min.x/id,Nn[1]=Re.min.y/id,$n[0]=Re.max.x/id,$n[1]=Re.max.y/id;const Le=h(Jr,Ln,Nn),Ot=h(Jr,Ln,$n);if(0===new yu([Le[0],Le[1],qe],[Ot[0],Ot[1],Ct]).intersectsPrecise(Oe)){Hr&&(Ue.segments.push(Hr),Hr=void 0);continue}const Jt=Re.segment;Hr&&Hr.vertexOffset!==Jt.vertexOffset&&(Ue.segments.push(Hr),Hr=void 0),Hr?(Hr.vertexLength+=Jt.vertexLength,Hr.primitiveLength+=Jt.primitiveLength):Hr={vertexOffset:Jt.vertexOffset,primitiveLength:Jt.primitiveLength,vertexLength:Jt.vertexLength,primitiveOffset:Jt.primitiveOffset,sortKey:void 0,vaos:{}}}return Hr&&Ue.segments.push(Hr),Ue}encodeCentroid(Re,Le){const Oe=Re.centroid(),Ue=Le.span(),qe=Math.min(7,Math.round(Ue.x*this.tileToMeter/10)),Ct=Math.min(7,Math.round(Ue.y*this.tileToMeter/10));return new Is(Q(Oe.x,1,id-1)<<3|qe,Q(Oe.y,1,id-1)<<3|Ct)}encodeBorderCentroid(Re){if(!Re.borders)return new Is(0,0);const Le=Re.borders,Oe=Number.MAX_VALUE;if(Le[0][0]!==Oe||Le[1][0]!==Oe){const Re=Le[0][0]!==Oe?0:1;return new Is(6|(Le[0][0]!==Oe?0:65528),(Le[Re][0]+Le[Re][1])/2<<3|6)}{const Re=Le[2][0]!==Oe?2:3;return new Is((Le[Re][0]+Le[Re][1])/2<<3|6,6|(Le[2][0]!==Oe?0:65528))}}showCentroid(Re){const Le=this.centroidData[Re.centroidDataIndex];Le.flags&=r_,Le.centroidXY.x=0,Le.centroidXY.y=0,this.writeCentroidToBuffer(Le)}writeCentroidToBuffer(Re){this.groundEffect.updateHiddenByLandmark(Re);const Le=Re.vertexArrayOffset,Oe=Re.vertexCount+Re.vertexArrayOffset,Ue=Re.flags&r_?t_:Re.centroidXY,qe=this.centroidVertexArray.geta_centroid_pos0(Le);if(this.centroidVertexArray.geta_centroid_pos1(Le)!==Ue.y||qe!==Ue.x){for(let Re=Le;Re<Oe;++Re)this.centroidVertexArray.emplace(Re,Ue.x,Ue.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const Re of this.centroidData)this.writeCentroidToBuffer(Re)}updateReplacement(Re,Le,Oe){if(Le.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=Le.updateTime;const Ue=Le.getReplacementRegionsForTile(Re.toUnwrapped());if(wh(this.activeReplacements,Ue))return;if(this.activeReplacements=Ue,0===this.centroidVertexArray.length)this.createCentroidsBuffer();else for(const Re of this.centroidData)Re.flags&=2147483647;const qe=[];for(const Le of this.activeReplacements){if(Le.order<Oe)continue;const Ue=Math.pow(2,Le.footprintTileId.canonical.z-Re.canonical.z);for(const Oe of this.centroidData)if(!(Oe.flags&r_||Le.min.x>Oe.max.x||Oe.min.x>Le.max.x||Le.min.y>Oe.max.y||Oe.min.y>Le.max.y))for(let Ct=0;Ct<Oe.footprintSegLen;Ct++){const Ot=this.footprintSegments[Oe.footprintSegIdx+Ct];if(qe.length=0,ip(this.footprintVertices,Ot.vertexOffset,Ot.vertexCount,Le.footprintTileId.canonical,Re.canonical,qe),Ah(Le.footprint,qe,this.footprintIndices.uint16,Ot.indexOffset,Ot.indexCount,-Ot.vertexOffset,-Ue)){Oe.flags|=r_;break}}}for(const Re of this.centroidData)this.writeCentroidToBuffer(Re);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(Re,Le,Oe){let Ue=!1;for(let qe=0;qe<Oe.footprintSegLen;qe++){const Ct=this.footprintSegments[Oe.footprintSegIdx+qe];let Ot=0;for(const Oe of Ct.ringIndices){for(let qe=Ot,Jt=Oe+Ot-1;qe<Oe+Ot;Jt=qe++){const Oe=this.footprintVertices.int16[2*(qe+Ct.vertexOffset)+0],Ot=this.footprintVertices.int16[2*(qe+Ct.vertexOffset)+1],Hr=this.footprintVertices.int16[2*(Jt+Ct.vertexOffset)+1];Ot>Le!=Hr>Le&&Re<(this.footprintVertices.int16[2*(Jt+Ct.vertexOffset)+0]-Oe)*(Le-Ot)/(Hr-Ot)+Oe&&(Ue=!Ue)}Ot=Oe}}return Ue}getHeightAtTileCoord(Re,Le){let Oe=Number.NEGATIVE_INFINITY,Ue=!0;const qe=4*(Re+id)*id+(Le+id);if(this.partLookup.hasOwnProperty(qe)){const Re=this.partLookup[qe];return Re?{height:Re.height,hidden:!!(Re.flags&r_)}:void 0}for(const Ct of this.centroidData)Re>Ct.max.x||Ct.min.x>Re||Le>Ct.max.y||Ct.min.y>Le||this.footprintContainsPoint(Re,Le,Ct)&&Ct&&Ct.height>Oe&&(Oe=Ct.height,this.partLookup[qe]=Ct,Ue=!!(Ct.flags&r_));if(Oe!==Number.NEGATIVE_INFINITY)return{height:Oe,hidden:Ue};this.partLookup[qe]=void 0}}function Wh(Re,Le){const Oe=Re.add(Le)._unit();return Re.x*Oe.x+Re.y*Oe.y}function Hh(Re,Le,Oe,Ue){const qe=Le.sub(Re)._perp()._unit(),Ct=Oe.sub(Le)._perp()._unit();return Kh(Re,Le,Oe,Wh(qe,Ct),Ue)}function Kh(Re,Le,Oe,Ue,qe){const Ct=Math.sqrt(1-Ue*Ue);return Math.min(Re.dist(Le)/3,Le.dist(Oe)/3,qe*Ct/Ue)}function Jh(Re,Le,Oe){return Re.x<Oe[0].x&&Le.x<Oe[0].x||Re.x>Oe[1].x&&Le.x>Oe[1].x||Re.y<Oe[0].y&&Le.y<Oe[0].y||Re.y>Oe[1].y&&Le.y>Oe[1].y}function Qh(Re,Le){return Re.x<Le[0].x||Re.x>Le[1].x||Re.y<Le[0].y||Re.y>Le[1].y}function tp(Re,Le,Oe){if(Re.x<0||Re.x>=id||Le.x<0||Le.x>=id||Oe.x<0||Oe.x>=id)return!1;const Ue=Oe.sub(Le),qe=Ue.perp(),Ct=Re.sub(Le);return(Ue.x*Ct.x+Ue.y*Ct.y)/Math.sqrt((Ue.x*Ue.x+Ue.y*Ue.y)*(Ct.x*Ct.x+Ct.y*Ct.y))>-.866&&qe.x*Ct.x+qe.y*Ct.y<0}function ep(Re,Le,Oe){const Ue=Le?2|Re:-3&Re;return Oe?1|Ue:-2&Ue}function rp(){const Re=Math.PI/32,Le=Math.tan(Re),Oe=Yf;return Oe*Math.sqrt(1+2*Le*Le)-Oe}function np(Re,Le,Oe){const Ue=1<<Oe.z,qe=cl(Oe.x/Ue),Ct=cl((Oe.x+1)/Ue),Ot=hl(Oe.y/Ue),Jt=hl((Oe.y+1)/Ue);return function(Re,Le,Oe,Ue,qe=0,Ct){const Ot=[];if(!Re.length||!Oe||!Ue)return Ot;const o=(Re,Le)=>{for(const Oe of Re)Ot.push({polygon:Oe,bounds:Le})},Jt=Math.ceil(Math.log2(Oe)),Hr=Math.ceil(Math.log2(Ue)),Jr=Jt-Hr,Ln=[];for(let Re=0;Re<Math.abs(Jr);Re++)Ln.push(Jr>0?0:1);for(let Re=0;Re<Math.min(Jt,Hr);Re++)Ln.push(0),Ln.push(1);let Nn=Re;if(Nn=fh(Nn,Le[0].y-qe,Le[1].y+qe,1),Nn=fh(Nn,Le[0].x-qe,Le[1].x+qe,0),!Nn.length)return Ot;const $n=[];for(Ln.length?$n.push({polygons:Nn,bounds:Le,depth:0}):o(Nn,Le);$n.length;){const Re=$n.pop(),Le=Re.depth,Oe=Ln[Le],Ue=Re.bounds[0],Ot=Re.bounds[1],Jt=0===Oe?Ue.x:Ue.y,Hr=0===Oe?Ot.x:Ot.y,Jr=Ct?Ct(Oe,Jt,Hr):.5*(Jt+Hr),Nn=fh(Re.polygons,Jt-qe,Jr+qe,Oe),Gn=fh(Re.polygons,Jr-qe,Hr+qe,Oe);if(Nn.length){const Re=[Ue,new Is(0===Oe?Jr:Ot.x,1===Oe?Jr:Ot.y)];Ln.length>Le+1?$n.push({polygons:Nn,bounds:Re,depth:Le+1}):o(Nn,Re)}if(Gn.length){const Re=[new Is(0===Oe?Jr:Ue.x,1===Oe?Jr:Ue.y),Ot];Ln.length>Le+1?$n.push({polygons:Gn,bounds:Re,depth:Le+1}):o(Gn,Re)}}return Ot}(Re,Le,Math.ceil((Ct-qe)/11.25),Math.ceil((Ot-Jt)/11.25),1,((Re,Le,qe)=>{if(0===Re)return.5*(Le+qe);{const Re=hl((Oe.y+Le/id)/Ue);return(ll(.5*(hl((Oe.y+qe/id)/Ue)+Re))*Ue-Oe.y)*id}}))}function ip(Re,Le,Oe,Ue,qe,Ct){const Ot=Math.pow(2,Ue.z-qe.z);for(let Jt=0;Jt<Oe;Jt++){let Oe=Re.int16[2*(Jt+Le)+0],Hr=Re.int16[2*(Jt+Le)+1];Oe=(Oe+qe.x*id)*Ot-Ue.x*id,Hr=(Hr+qe.y*id)*Ot-Ue.y*id,Ct.push(new Is(Oe,Hr))}}let i_,o_;function op(Re,Le){return Re.x*Le.x+Re.y*Le.y}function lp(Re,Le){if(1===Re.length){let Oe=0;const Ue=Le[Oe++];let qe;for(;!qe||Ue.equals(qe);)if(qe=Le[Oe++],!qe)return 1/0;for(;Oe<Le.length;Oe++){const Ct=Le[Oe],Ot=Re[0],Jt=qe.sub(Ue),Hr=Ct.sub(Ue),Jr=Ot.sub(Ue),Ln=op(Jt,Jt),Nn=op(Jt,Hr),$n=op(Hr,Hr),Gn=op(Jr,Jt),qn=op(Jr,Hr),Zn=Ln*$n-Nn*Nn,Xn=($n*Gn-Nn*qn)/Zn,Yn=(Ln*qn-Nn*Gn)/Zn,_i=Ue.z*(1-Xn-Yn)+qe.z*Xn+Ct.z*Yn;if(isFinite(_i))return _i}return 1/0}{let Re=1/0;for(const Oe of Le)Re=Math.min(Re,Oe.z);return Re}}function up(Re,Le,Oe,Ue,qe,Ct,Ot,Jt){const Hr=Ot*qe.getElevationAt(Re,Le,!0,!0),Jr=0!==Ct[0],Ln=Jr?0===Ct[1]?Ot*(Ct[0]/7-450):Ot*function(Re,Le,Oe){const Ue=Math.floor(Le[0]/8),qe=Math.floor(Le[1]/8),Ct=10*(Le[0]-8*Ue),Ot=10*(Le[1]-8*qe),Jt=Re.getElevationAt(Ue,qe,!0,!0),Hr=Re.getMeterToDEM(Oe),Jr=Math.floor(.5*(Ct*Hr-1)),Ln=Math.floor(.5*(Ot*Hr-1)),Nn=Re.tileCoordToPixel(Ue,qe),$n=2*Jr+1,Gn=2*Ln+1,qn=function(Re,Le,Oe,Ue,qe){return[Re.getElevationAtPixel(Le,Oe,!0),Re.getElevationAtPixel(Le+qe,Oe,!0),Re.getElevationAtPixel(Le,Oe+qe,!0),Re.getElevationAtPixel(Le+Ue,Oe+qe,!0)]}(Re,Nn.x-Jr,Nn.y-Ln,$n,Gn),Zn=Math.abs(qn[0]-qn[1]),Xn=Math.abs(qn[2]-qn[3]),Yn=Math.abs(qn[0]-qn[2])+Math.abs(qn[1]-qn[3]),_i=Math.min(.25,.5*Hr*(Zn+Xn)/$n),vi=Math.min(.25,.5*Hr*Yn/Gn);return Jt+Math.max(_i*Ct,vi*Ot)}(qe,Ct,Jt):Hr;return{base:Hr+(0===Oe)?-1:Oe,top:Jr?Math.max(Ln+Ue,Hr+Oe+2):Hr+Ue}}os(Zh,"FillExtrusionBucket",{omit:["layers","features"]}),os(Nh,"PartData"),os(jh,"FootprintSegment"),os(qh,"BorderCentroidData"),os(Yh,"GroundEffect");const s_=ya([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),a_=ya([{name:"a_z_offset",components:1,type:"Float32"}],4),{members:l_}=s_,c_=ya([{name:"a_packed",components:4,type:"Float32"}]),{members:u_}=c_,h_=ya([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:d_}=h_;class gp{constructor(Re,Le){this.width=Re,this.height=Le,this.nextRow=0,this.image=new nc({width:Re,height:Le}),this.positions={},this.uploaded=!1}getDash(Re,Le){const Oe=this.getKey(Re,Le);return this.positions[Oe]}trim(){const Re=this.width,Le=this.height=at(this.nextRow);this.image.resize({width:Re,height:Le})}getKey(Re,Le){return Re.join(",")+Le}getDashRanges(Re,Le,Oe){const Ue=[];let qe=Re.length%2==1?-Re[Re.length-1]*Oe:0,Ct=Re[0]*Oe,Ot=!0;Ue.push({left:qe,right:Ct,isDash:Ot,zeroLength:0===Re[0]});let Jt=Re[0];for(let Le=1;Le<Re.length;Le++){Ot=!Ot;const Hr=Re[Le];qe=Jt*Oe,Jt+=Hr,Ct=Jt*Oe,Ue.push({left:qe,right:Ct,isDash:Ot,zeroLength:0===Hr})}return Ue}addRoundDash(Re,Le,Oe){const Ue=Le/2;for(let Le=-Oe;Le<=Oe;Le++){const qe=this.width*(this.nextRow+Oe+Le);let Ct=0,Ot=Re[Ct];for(let Jt=0;Jt<this.width;Jt++){Jt/Ot.right>1&&(Ot=Re[++Ct]);const Hr=Math.abs(Jt-Ot.left),Jr=Math.abs(Jt-Ot.right),Ln=Math.min(Hr,Jr);let Nn;const $n=Le/Oe*(Ue+1);if(Ot.isDash){const Re=Ue-Math.abs($n);Nn=Math.sqrt(Ln*Ln+Re*Re)}else Nn=Ue-Math.sqrt(Ln*Ln+$n*$n);this.image.data[qe+Jt]=Math.max(0,Math.min(255,Nn+128))}}}addRegularDash(Re,Le){for(let Le=Re.length-1;Le>=0;--Le){const Oe=Re[Le],Ue=Re[Le+1];Oe.zeroLength?Re.splice(Le,1):Ue&&Ue.isDash===Oe.isDash&&(Ue.left=Oe.left,Re.splice(Le,1))}const Oe=Re[0],Ue=Re[Re.length-1];Oe.isDash===Ue.isDash&&(Oe.left=Ue.left-this.width,Ue.right=Oe.right+this.width);const qe=this.width*this.nextRow;let Ct=0,Ot=Re[Ct];for(let Oe=0;Oe<this.width;Oe++){Oe/Ot.right>1&&(Ot=Re[++Ct]);const Ue=Math.abs(Oe-Ot.left),Jt=Math.abs(Oe-Ot.right),Hr=Math.min(Ue,Jt);this.image.data[qe+Oe]=Math.max(0,Math.min(255,(Ot.isDash?Hr:-Hr)+Le+128))}}addDash(Re,Le){const Oe=this.getKey(Re,Le);if(this.positions[Oe])return this.positions[Oe];const Ue="round"===Le,qe=Ue?7:0,Ct=2*qe+1;if(this.nextRow+Ct>this.height)return ft("LineAtlas out of space"),null;0===Re.length&&Re.push(1);let Ot=0;for(let Le=0;Le<Re.length;Le++)Re[Le]<0&&(ft("Negative value is found in line dasharray, replacing values with 0"),Re[Le]=0),Ot+=Re[Le];if(0!==Ot){const Oe=this.width/Ot,Ct=this.getDashRanges(Re,this.width,Oe);Ue?this.addRoundDash(Ct,Oe,qe):this.addRegularDash(Ct,"square"===Le?.5*Oe:0)}const Jt=this.nextRow+qe;this.nextRow+=Ct;const Hr={tl:[Jt,qe],br:[Ot,0]};return this.positions[Oe]=Hr,Hr}}os(gp,"LineAtlas");const p_=Fg.VectorTileFeature.types,f_=Math.cos(Math.PI/180*37.5),m_=Math.cos(Math.PI/180*5);class wp{constructor(Re){this.zoom=Re.zoom,this.overscaling=Re.overscaling,this.layers=Re.layers,this.layerIds=this.layers.map((Re=>Re.fqid)),this.index=Re.index,this.projection=Re.projection,this.hasPattern=!1,this.hasZOffset=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((Re=>{this.gradients[Re.id]={}})),this.layoutVertexArray=new _a,this.layoutVertexArray2=new Ma,this.patternVertexArray=new Aa,this.indexArray=new Da,this.programConfigurations=new Fo(Re.layers,{zoom:Re.zoom,lut:Re.lut}),this.segments=new co,this.maxLineLength=0,this.zOffsetVertexArray=new Oa,this.stateDependentLayerIds=this.layers.filter((Re=>Re.isStateDependent())).map((Re=>Re.id)),this.tessellationStep=Re.tessellationStep?Re.tessellationStep:id/64}updateFootprints(Re,Le){}populate(Re,Le,Oe,Ue){this.hasPattern=Dc("line",this.layers,Le);const qe=this.layers[0].layout.get("line-sort-key"),Ct=this.layers[0].layout.get("line-z-offset");this.hasZOffset=!Ct.isConstant()||!!Ct.constantOr(0);const Ot=[];for(const{feature:Le,id:Ct,index:Jt,sourceLayerIndex:Hr}of Re){const Re=this.layers[0]._featureFilter.needGeometry,Jr=Pl(Le,Re);if(!this.layers[0]._featureFilter.filter(new Vs(this.zoom),Jr,Oe))continue;const Ln=qe?qe.evaluate(Jr,{},Oe):void 0,Nn={id:Ct,properties:Le.properties,type:Le.type,sourceLayerIndex:Hr,index:Jt,geometry:Re?Jr.geometry:Il(Le,Oe,Ue),patterns:{},sortKey:Ln};Ot.push(Nn)}qe&&Ot.sort(((Re,Le)=>Re.sortKey-Le.sortKey));const{lineAtlas:Jt,featureIndex:Hr}=Le,Jr=this.addConstantDashes(Jt);for(const Ue of Ot){const{geometry:qe,index:Ct,sourceLayerIndex:Ot}=Ue;if(Jr&&this.addFeatureDashes(Ue,Jt),this.hasPattern){const Re=Lc("line",this.layers,Ue,this.zoom,Le);this.patternFeatures.push(Re)}else this.addFeature(Ue,qe,Ct,Oe,Jt.positions,Le.availableImages,Le.brightness);Hr.insert(Re[Ct].feature,qe,Ct,Ot,this.index)}}addConstantDashes(Re){let Le=!1;for(const Oe of this.layers){const Ue=Oe.paint.get("line-dasharray").value,qe=Oe.layout.get("line-cap").value;if("constant"!==Ue.kind||"constant"!==qe.kind)Le=!0;else{const Le=qe.value,Oe=Ue.value;if(!Oe)continue;Re.addDash(Oe,Le)}}return Le}addFeatureDashes(Re,Le){const Oe=this.zoom;for(const Ue of this.layers){const qe=Ue.paint.get("line-dasharray").value,Ct=Ue.layout.get("line-cap").value;if("constant"===qe.kind&&"constant"===Ct.kind)continue;let Ot,Jt;if("constant"===qe.kind){if(Ot=qe.value,!Ot)continue}else Ot=qe.evaluate({zoom:Oe},Re);Jt="constant"===Ct.kind?Ct.value:Ct.evaluate({zoom:Oe},Re),Le.addDash(Ot,Jt),Re.patterns[Ue.id]=Le.getKey(Ot,Jt)}}update(Re,Le,Oe,Ue,qe){const Ct=0!==Object.keys(Re).length;Ct&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(Re,Le,Ct?this.stateDependentLayers:this.layers,Oe,Ue,qe)}addFeatures(Re,Le,Oe,Ue,qe,Ct){for(const Re of this.patternFeatures)this.addFeature(Re,Re.geometry,Re.index,Le,Oe,Ue,Ct)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(Re){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=Re.createVertexBuffer(this.layoutVertexArray2,u_)),0!==this.patternVertexArray.length&&(this.patternVertexBuffer=Re.createVertexBuffer(this.patternVertexArray,d_)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=Re.createVertexBuffer(this.zOffsetVertexArray,a_.members,!0)),this.layoutVertexBuffer=Re.createVertexBuffer(this.layoutVertexArray,l_),this.indexBuffer=Re.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(Re),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(Re){if(Re.properties&&Re.properties.hasOwnProperty("mapbox_clip_start")&&Re.properties.hasOwnProperty("mapbox_clip_end"))return{start:+Re.properties.mapbox_clip_start,end:+Re.properties.mapbox_clip_end}}addFeature(Re,Le,Oe,Ue,qe,Ct,Ot){const Jt=this.layers[0].layout,Hr=Jt.get("line-join").evaluate(Re,{}),Jr=Jt.get("line-cap").evaluate(Re,{}),Ln=Jt.get("line-miter-limit"),Nn=Jt.get("line-round-limit");this.lineClips=this.lineFeatureClips(Re);for(const Oe of Le)this.addLine(Oe,Re,Ue,Hr,Jr,Ln,Nn);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,Re,Oe,qe,Ct,Ue,Ot)}addLine(Re,Le,Oe,Ue,qe,Ct,Ot){this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.currentVertex=void 0;const Jt={zoom:this.zoom,lineProgress:void 0},Hr=this.layers[0].layout,Jr="none"===Ue;if(this.patternJoinNone=this.hasPattern&&Jr,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[],this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Le=0;Le<Re.length-1;Le++)this.totalDistance+=Re[Le].dist(Re[Le+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const Ln="Polygon"===p_[Le.type];let Nn=Re.length;for(;Nn>=2&&Re[Nn-1].equals(Re[Nn-2]);)Nn--;let $n=0;for(;$n<Nn-1&&Re[$n].equals(Re[$n+1]);)$n++;if(Nn<(Ln?3:2))return;"bevel"===Ue&&(Ct=1.05);const Gn=this.overscaling<=16?15*id/(512*this.overscaling):0,qn=this.segments.prepareSegment(10*Nn,this.layoutVertexArray,this.indexArray);let Zn,Xn,Yn,_i,vi,xi;this.e1=this.e2=-1,Ln&&(Zn=Re[Nn-2],vi=Re[$n].sub(Zn)._unit()._perp());for(let Oe=$n;Oe<Nn;Oe++){if(Yn=Oe===Nn-1?Ln?Re[$n+1]:void 0:Re[Oe+1],Yn&&Re[Oe].equals(Yn))continue;if(vi&&(_i=vi),Zn&&(Xn=Zn),Zn=Re[Oe],this.hasZOffset){const Re=Hr.get("line-z-offset").value;if("constant"===Re.kind)xi=Re.value;else{if(this.lineClips){const Re=this.totalDistance/(this.lineClips.end-this.lineClips.start);Jt.lineProgress=(Re*this.lineClips.start+this.distance+(Xn?Xn.dist(Zn):0))/Re}else ft(`line-z-offset evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`),Jt.lineProgress=0;xi=Re.evaluate(Jt,Le)}xi=xi||0}vi=Yn?Yn.sub(Zn)._unit()._perp():_i,_i=_i||vi;const bi=Xn&&Yn;let Pi=bi?Ue:Ln||Jr?"butt":qe;const lo=_i.x*vi.x+_i.y*vi.y;if(Jr){const t=function(Re){if(Re.patternJoinNone){const Le=Re.segmentPoints.length/2,Oe=Re.lineSoFar-Re.segmentStart;for(let Ue=0;Ue<Le;++Ue){const Le=Re.segmentPoints[2*Ue+1],qe=Math.round(Re.segmentPoints[2*Ue])+.5+.25*Le;Re.patternVertexArray.emplaceBack(qe,Oe,Re.segmentStart),Re.patternVertexArray.emplaceBack(qe,Oe,Re.segmentStart)}Re.segmentPoints.length=0}Re.e1=Re.e2=-1};if(bi&&lo<m_){this.updateDistance(Xn,Zn),this.addCurrentVertex(Zn,_i,1,1,qn,xi),t(this),this.addCurrentVertex(Zn,vi,-1,-1,qn,xi);continue}if(Xn){if(!Yn){this.updateDistance(Xn,Zn),this.addCurrentVertex(Zn,_i,1,1,qn,xi),t(this);continue}Pi="miter"}}let uo=_i.add(vi);0===uo.x&&0===uo.y||uo._unit();const po=uo.x*vi.x+uo.y*vi.y,fo=0!==po?1/po:1/0,Io=2*Math.sqrt(2-2*po),is=po<f_&&Xn&&Yn,as=_i.x*vi.y-_i.y*vi.x>0;if(is&&Oe>$n){const Re=Zn.dist(Xn);if(Re>2*Gn){const Le=Zn.sub(Zn.sub(Xn)._mult(Gn/Re)._round());this.updateDistance(Xn,Le),this.addCurrentVertex(Le,_i,0,0,qn,xi),Xn=Le}}if(bi&&"round"===Pi&&(fo<Ot?Pi="miter":fo<=2&&(Pi="fakeround")),"miter"===Pi&&fo>Ct&&(Pi="bevel"),"bevel"===Pi&&(fo>2&&(Pi="flipbevel"),fo<Ct&&(Pi="miter")),Xn&&this.updateDistance(Xn,Zn),"miter"===Pi)uo._mult(fo),this.addCurrentVertex(Zn,uo,0,0,qn,xi);else if("flipbevel"===Pi){if(fo>100)uo=vi.mult(-1);else{const Re=fo*_i.add(vi).mag()/_i.sub(vi).mag();uo._perp()._mult(Re*(as?-1:1))}this.addCurrentVertex(Zn,uo,0,0,qn,xi),this.addCurrentVertex(Zn,uo.mult(-1),0,0,qn,xi)}else if("bevel"===Pi||"fakeround"===Pi){const Re=-Math.sqrt(fo*fo-1),Le=as?Re:0,Oe=as?0:Re;if(Xn&&this.addCurrentVertex(Zn,_i,Le,Oe,qn,xi),"fakeround"===Pi){const Re=Math.round(180*Io/Math.PI/20);for(let Le=1;Le<Re;Le++){let Oe=Le/Re;if(.5!==Oe){const Re=Oe-.5;Oe+=Oe*Re*(Oe-1)*((1.0904+lo*(lo*(3.55645-1.43519*lo)-3.2452))*Re*Re+(.848013+lo*(.215638*lo-1.06021)))}const Ue=vi.sub(_i)._mult(Oe)._add(_i)._unit()._mult(as?-1:1);this.addHalfVertex(Zn,Ue.x,Ue.y,!1,as,0,qn,xi)}}Yn&&this.addCurrentVertex(Zn,vi,-Le,-Oe,qn,xi)}else"butt"===Pi?this.addCurrentVertex(Zn,uo,0,0,qn,xi):"square"===Pi?(Xn||this.addCurrentVertex(Zn,uo,-1,-1,qn,xi),this.addCurrentVertex(Zn,uo,0,0,qn,xi),Xn&&this.addCurrentVertex(Zn,uo,1,1,qn,xi)):"round"===Pi&&(Xn&&(this.addCurrentVertex(Zn,_i,0,0,qn,xi),this.addCurrentVertex(Zn,_i,1,1,qn,xi,!0)),Yn&&(this.addCurrentVertex(Zn,vi,-1,-1,qn,xi,!0),this.addCurrentVertex(Zn,vi,0,0,qn,xi)));if(is&&Oe<Nn-1){const Re=Zn.dist(Yn);if(Re>2*Gn){const Le=Zn.add(Yn.sub(Zn)._mult(Gn/Re)._round());this.updateDistance(Zn,Le),this.addCurrentVertex(Le,vi,0,0,qn,xi),Zn=Le}}}}addVerticesTo(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr){const Ln=(Le.w-Re.w)/this.tessellationStep|0;if(Ln>1){this.lineSoFar=Re.w;const Nn=(Le.x-Re.x)/Ln,$n=(Le.y-Re.y)/Ln,Gn=(Le.z-Re.z)/Ln,qn=(Le.w-Re.w)/Ln;for(let Le=1;Le<Ln;++Le)Re.x+=Nn,Re.y+=$n,Re.z+=Gn,this.lineSoFar+=qn,this.addHalfVertex(Re,Oe,Ue,Jr,!1,Ot,Hr,Re.z),this.addHalfVertex(Re,qe,Ct,Jr,!0,-Jt,Hr,Re.z)}this.lineSoFar=Le.w,this.addHalfVertex(Le,Oe,Ue,Jr,!1,Ot,Hr,Le.z),this.addHalfVertex(Le,qe,Ct,Jr,!0,-Jt,Hr,Le.z)}addCurrentVertex(Re,Le,Oe,Ue,qe,Ct,Ot=!1){const Jt=Le.x+Le.y*Oe,Hr=Le.y-Le.x*Oe,Jr=Le.y*Ue-Le.x,Ln=-Le.y-Le.x*Ue;if(null!=Ct){const Le=-10,Nn=id+10,$n=Ct,Gn=new ph(Re.x,Re.y,$n,this.lineSoFar),qn=_p(Re,Le,Nn),Zn=this.lineSoFar;if(this.currentVertex)if(qn){const Ct=this.currentVertexIsOutside,Gn=this.currentVertex,qn=new ph(Re.x,Re.y,$n,this.lineSoFar);mh(Gn,qn,Le,Nn),_p(qn,Le,Nn)||(Ct&&(this.e1=this.e2=-1,this.lineSoFar=Gn.w,this.addHalfVertex(Gn,Jt,Hr,Ot,!1,Oe,qe,Gn.z),this.addHalfVertex(Gn,Jr,Ln,Ot,!0,-Ue,qe,Gn.z)),this.addVerticesTo(Gn,qn,Jt,Hr,Jr,Ln,Oe,Ue,qe,Ot))}else{const Re=this.currentVertex;this.currentVertexIsOutside&&(mh(Re,Gn,Le,Nn),this.e1=this.e2=-1,this.lineSoFar=Re.w,this.addHalfVertex(Re,Jt,Hr,Ot,!1,Oe,qe,Re.z),this.addHalfVertex(Re,Jr,Ln,Ot,!0,-Ue,qe,Re.z)),this.addVerticesTo(Re,Gn,Jt,Hr,Jr,Ln,Oe,Ue,qe,Ot)}else qn||(this.addHalfVertex(Re,Jt,Hr,Ot,!1,Oe,qe,Ct),this.addHalfVertex(Re,Jr,Ln,Ot,!0,-Ue,qe,Ct));this.currentVertex=Gn,this.currentVertexIsOutside=qn,this.lineSoFar=Zn}else this.addHalfVertex(Re,Jt,Hr,Ot,!1,Oe,qe,Ct),this.addHalfVertex(Re,Jr,Ln,Ot,!0,-Ue,qe,Ct)}addHalfVertex({x:Re,y:Le},Oe,Ue,qe,Ct,Ot,Jt,Hr){this.patternJoinNone&&(0===this.segmentPoints.length&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),Ct||this.segmentPoints.push(this.lineSoFar-this.segmentStart,Ot)),this.layoutVertexArray.emplaceBack((Re<<1)+(qe?1:0),(Le<<1)+(Ct?1:0),Math.round(63*Oe)+128,Math.round(63*Ue)+128,1+(0===Ot?0:Ot<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const Jr=Jt.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,Jr),Jt.primitiveLength++),Ct?this.e2=Jr:this.e1=Jr,null!=Hr&&this.zOffsetVertexArray.emplaceBack(Hr)}updateScaledDistance(){if(this.lineClips){const Re=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=Re*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(Re,Le){this.distance+=Re.dist(Le),this.updateScaledDistance()}}function _p(Re,Le,Oe){return Re.x<Le||Re.x>Oe||Re.y<Le||Re.y>Oe}let g_,__;function Sp(Re,Le,Oe){return Le*(id/(Re.tileSize*Math.pow(2,Oe-Re.tileID.overscaledZ)))}function Ip(Re,Le){return 1/Sp(Re,1,Le.tileZoom)}function Pp(Re,Le,Oe,Ue){return Re.translatePosMatrix(Ue||Le.tileID.projMatrix,Le,Oe.paint.get("line-translate"),Oe.paint.get("line-translate-anchor"))}os(wp,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const zp=Re=>{const Le=[];kp(Re)&&Le.push("RENDER_LINE_DASH"),Re.paint.get("line-gradient")&&Le.push("RENDER_LINE_GRADIENT");const Oe=Re.paint.get("line-trim-offset");0===Oe[0]&&0===Oe[1]||Le.push("RENDER_LINE_TRIM_OFFSET"),0!==Re.paint.get("line-border-width").constantOr(1)&&Le.push("RENDER_LINE_BORDER");const Ue="none"===Re.layout.get("line-join").constantOr("miter"),qe=!!Re.paint.get("line-pattern").constantOr(1);return Ue&&qe&&Le.push("LINE_JOIN_NONE"),Le};function kp(Re){const Le=Re.paint.get("line-dasharray").value;return Le.value||"constant"!==Le.kind}let y_;const Ep=()=>y_||(y_={layout:g_||(g_=new Gs({"line-cap":new qs(Fp.layout_line["line-cap"]),"line-join":new qs(Fp.layout_line["line-join"]),"line-miter-limit":new Ns(Fp.layout_line["line-miter-limit"]),"line-round-limit":new Ns(Fp.layout_line["line-round-limit"]),"line-sort-key":new qs(Fp.layout_line["line-sort-key"]),"line-z-offset":new qs(Fp.layout_line["line-z-offset"]),visibility:new Ns(Fp.layout_line.visibility)})),paint:__||(__=new Gs({"line-opacity":new qs(Fp.paint_line["line-opacity"]),"line-color":new qs(Fp.paint_line["line-color"]),"line-translate":new Ns(Fp.paint_line["line-translate"]),"line-translate-anchor":new Ns(Fp.paint_line["line-translate-anchor"]),"line-width":new qs(Fp.paint_line["line-width"]),"line-gap-width":new qs(Fp.paint_line["line-gap-width"]),"line-offset":new qs(Fp.paint_line["line-offset"]),"line-blur":new qs(Fp.paint_line["line-blur"]),"line-dasharray":new qs(Fp.paint_line["line-dasharray"]),"line-pattern":new qs(Fp.paint_line["line-pattern"]),"line-gradient":new $s(Fp.paint_line["line-gradient"]),"line-trim-offset":new Ns(Fp.paint_line["line-trim-offset"]),"line-trim-fade-range":new Ns(Fp.paint_line["line-trim-fade-range"]),"line-trim-color":new Ns(Fp.paint_line["line-trim-color"]),"line-emissive-strength":new Ns(Fp.paint_line["line-emissive-strength"]),"line-border-width":new qs(Fp.paint_line["line-border-width"]),"line-border-color":new qs(Fp.paint_line["line-border-color"]),"line-occlusion-opacity":new Ns(Fp.paint_line["line-occlusion-opacity"])}))},y_);class Bp extends qs{possiblyEvaluate(Re,Le){return Le=new Vs(Math.floor(Le.zoom),{now:Le.now,fadeDuration:Le.fadeDuration,transition:Le.transition}),super.possiblyEvaluate(Re,Le)}evaluate(Re,Le,Oe,Ue){return Le=nt({},Le,{zoom:Math.floor(Le.zoom)}),super.evaluate(Re,Le,Oe,Ue)}}let v_;function Cp(Re,Le){return Le>0?Le+2*Re:Re}const x_=ya([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),b_=ya([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),w_=ya([{name:"a_projected_pos",components:4,type:"Float32"}],4);ya([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const T_=ya([{name:"a_auto_z_offset",components:1,type:"Float32"}],4),S_=ya([{name:"a_texb",components:2,type:"Uint16"}]),E_=ya([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_elevation_from_sea",components:2,type:"Float32"}]),C_=ya([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_auto_z_offset",components:1,type:"Float32"}]);ya([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const A_=ya([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),I_=ya([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);ya([{name:"triangle",components:3,type:"Uint16"}]),ya([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),ya([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"}]),ya([{type:"Float32",name:"offsetX"}]),ya([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var k_=24;const M_=128;function Xp(Re,Le){const{expression:Oe}=Le;if("constant"===Oe.kind)return{kind:"constant",layoutSize:Oe.evaluate(new Vs(Re+1))};if("source"===Oe.kind)return{kind:"source"};{const{zoomStops:Le,interpolationType:Ue}=Oe;let qe=0;for(;qe<Le.length&&Le[qe]<=Re;)qe++;qe=Math.max(0,qe-1);let Ct=qe;for(;Ct<Le.length&&Le[Ct]<Re+1;)Ct++;Ct=Math.min(Le.length-1,Ct);const Ot=Le[qe],Jt=Le[Ct];return"composite"===Oe.kind?{kind:"composite",minZoom:Ot,maxZoom:Jt,interpolationType:Ue}:{kind:"camera",minZoom:Ot,maxZoom:Jt,minSize:Oe.evaluate(new Vs(Ot)),maxSize:Oe.evaluate(new Vs(Jt)),interpolationType:Ue}}}function Yp(Re,{uSize:Le,uSizeT:Oe},{lowerSize:Ue,upperSize:qe}){return"source"===Re.kind?Ue/M_:"composite"===Re.kind?ke(Ue/M_,qe/M_,Oe):Le}function Zp(Re,Le){let Oe=0,Ue=0;if("constant"===Re.kind)Ue=Re.layoutSize;else if("source"!==Re.kind){const{interpolationType:qe,minZoom:Ct,maxZoom:Ot}=Re,Jt=qe?Q(si.interpolationFactor(qe,Le,Ct,Ot),0,1):0;"camera"===Re.kind?Ue=ke(Re.minSize,Re.maxSize,Jt):Oe=Jt}return{uSizeT:Oe,uSize:Ue}}var P_=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:M_,evaluateSizeForFeature:Yp,evaluateSizeForZoom:Zp,getSizeData:Xp});function Hp(Re,Le,Oe){return Re.sections.forEach((Re=>{Re.text=function(Re,Le,Oe){const Ue=Le.layout.get("text-transform").evaluate(Oe,{});return"uppercase"===Ue?Re=Re.toLocaleUpperCase():"lowercase"===Ue&&(Re=Re.toLocaleLowerCase()),Dp.applyArabicShaping&&(Re=Dp.applyArabicShaping(Re)),Re}(Re.text,Le,Oe)})),Re}const R_={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂","←":"↑","→":"↓"};function Jp(Re){return"︶"===Re||"﹈"===Re||"︸"===Re||"﹄"===Re||"﹂"===Re||"︾"===Re||"︼"===Re||"︺"===Re||"︘"===Re||"﹀"===Re||"︐"===Re||"︓"===Re||"︔"===Re||"｀"===Re||"￣"===Re||"︑"===Re||"︒"===Re}function Qp(Re){return"︵"===Re||"﹇"===Re||"︷"===Re||"﹃"===Re||"﹁"===Re||"︽"===Re||"︻"===Re||"︹"===Re||"︗"===Re||"︿"===Re}var L_,O_,z_,D_={};function sf(){return L_||(L_=1,D_.read=function(Re,Le,Oe,Ue,qe){var Ct,Ot,Jt=8*qe-Ue-1,Hr=(1<<Jt)-1,Jr=Hr>>1,Ln=-7,Nn=Oe?qe-1:0,$n=Oe?-1:1,Gn=Re[Le+Nn];for(Nn+=$n,Ct=Gn&(1<<-Ln)-1,Gn>>=-Ln,Ln+=Jt;Ln>0;Ct=256*Ct+Re[Le+Nn],Nn+=$n,Ln-=8);for(Ot=Ct&(1<<-Ln)-1,Ct>>=-Ln,Ln+=Ue;Ln>0;Ot=256*Ot+Re[Le+Nn],Nn+=$n,Ln-=8);if(0===Ct)Ct=1-Jr;else{if(Ct===Hr)return Ot?NaN:1/0*(Gn?-1:1);Ot+=Math.pow(2,Ue),Ct-=Jr}return(Gn?-1:1)*Ot*Math.pow(2,Ct-Ue)},D_.write=function(Re,Le,Oe,Ue,qe,Ct){var Ot,Jt,Hr,Jr=8*Ct-qe-1,Ln=(1<<Jr)-1,Nn=Ln>>1,$n=23===qe?Math.pow(2,-24)-Math.pow(2,-77):0,Gn=Ue?0:Ct-1,qn=Ue?1:-1,Zn=Le<0||0===Le&&1/Le<0?1:0;for(Le=Math.abs(Le),isNaN(Le)||Le===1/0?(Jt=isNaN(Le)?1:0,Ot=Ln):(Ot=Math.floor(Math.log(Le)/Math.LN2),Le*(Hr=Math.pow(2,-Ot))<1&&(Ot--,Hr*=2),(Le+=Ot+Nn>=1?$n/Hr:$n*Math.pow(2,1-Nn))*Hr>=2&&(Ot++,Hr/=2),Ot+Nn>=Ln?(Jt=0,Ot=Ln):Ot+Nn>=1?(Jt=(Le*Hr-1)*Math.pow(2,qe),Ot+=Nn):(Jt=Le*Math.pow(2,Nn-1)*Math.pow(2,qe),Ot=0));qe>=8;Re[Oe+Gn]=255&Jt,Gn+=qn,Jt/=256,qe-=8);for(Ot=Ot<<qe|Jt,Jr+=qe;Jr>0;Re[Oe+Gn]=255&Ot,Gn+=qn,Ot/=256,Jr-=8);Re[Oe+Gn-qn]|=128*Zn}),D_}function af(){if(z_)return O_;z_=1,O_=e;var Re=sf();function e(Re){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(Re)?Re:new Uint8Array(Re||0),this.pos=0,this.type=0,this.length=this.buf.length}e.Varint=0,e.Fixed64=1,e.Bytes=2,e.Fixed32=5;var Le=4294967296,Oe=1/Le,Ue="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function s(Re){return Re.type===e.Bytes?Re.readVarint()+Re.pos:Re.pos+1}function a(Re,Le,Oe){return Oe?4294967296*Le+(Re>>>0):4294967296*(Le>>>0)+(Re>>>0)}function o(Re,Le,Oe){var Ue=Le<=16383?1:Le<=2097151?2:Le<=268435455?3:Math.floor(Math.log(Le)/(7*Math.LN2));Oe.realloc(Ue);for(var qe=Oe.pos-1;qe>=Re;qe--)Oe.buf[qe+Ue]=Oe.buf[qe]}function l(Re,Le){for(var Oe=0;Oe<Re.length;Oe++)Le.writeVarint(Re[Oe])}function u(Re,Le){for(var Oe=0;Oe<Re.length;Oe++)Le.writeSVarint(Re[Oe])}function c(Re,Le){for(var Oe=0;Oe<Re.length;Oe++)Le.writeFloat(Re[Oe])}function h(Re,Le){for(var Oe=0;Oe<Re.length;Oe++)Le.writeDouble(Re[Oe])}function p(Re,Le){for(var Oe=0;Oe<Re.length;Oe++)Le.writeBoolean(Re[Oe])}function f(Re,Le){for(var Oe=0;Oe<Re.length;Oe++)Le.writeFixed32(Re[Oe])}function d(Re,Le){for(var Oe=0;Oe<Re.length;Oe++)Le.writeSFixed32(Re[Oe])}function m(Re,Le){for(var Oe=0;Oe<Re.length;Oe++)Le.writeFixed64(Re[Oe])}function y(Re,Le){for(var Oe=0;Oe<Re.length;Oe++)Le.writeSFixed64(Re[Oe])}function g(Re,Le){return(Re[Le]|Re[Le+1]<<8|Re[Le+2]<<16)+16777216*Re[Le+3]}function x(Re,Le,Oe){Re[Oe]=Le,Re[Oe+1]=Le>>>8,Re[Oe+2]=Le>>>16,Re[Oe+3]=Le>>>24}function b(Re,Le){return(Re[Le]|Re[Le+1]<<8|Re[Le+2]<<16)+(Re[Le+3]<<24)}return e.prototype={destroy:function(){this.buf=null},readFields:function(Re,Le,Oe){for(Oe=Oe||this.length;this.pos<Oe;){var Ue=this.readVarint(),qe=Ue>>3,Ct=this.pos;this.type=7&Ue,Re(qe,Le,this),this.pos===Ct&&this.skip(Ue)}return Le},readMessage:function(Re,Le){return this.readFields(Re,Le,this.readVarint()+this.pos)},readFixed32:function(){var Re=g(this.buf,this.pos);return this.pos+=4,Re},readSFixed32:function(){var Re=b(this.buf,this.pos);return this.pos+=4,Re},readFixed64:function(){var Re=g(this.buf,this.pos)+g(this.buf,this.pos+4)*Le;return this.pos+=8,Re},readSFixed64:function(){var Re=g(this.buf,this.pos)+b(this.buf,this.pos+4)*Le;return this.pos+=8,Re},readFloat:function(){var Le=Re.read(this.buf,this.pos,!0,23,4);return this.pos+=4,Le},readDouble:function(){var Le=Re.read(this.buf,this.pos,!0,52,8);return this.pos+=8,Le},readVarint:function(Re){var Le,Oe,Ue=this.buf;return Le=127&(Oe=Ue[this.pos++]),Oe<128?Le:(Le|=(127&(Oe=Ue[this.pos++]))<<7,Oe<128?Le:(Le|=(127&(Oe=Ue[this.pos++]))<<14,Oe<128?Le:(Le|=(127&(Oe=Ue[this.pos++]))<<21,Oe<128?Le:function(Re,Le,Oe){var Ue,qe,Ct=Oe.buf;if(Ue=(112&(qe=Ct[Oe.pos++]))>>4,qe<128)return a(Re,Ue,Le);if(Ue|=(127&(qe=Ct[Oe.pos++]))<<3,qe<128)return a(Re,Ue,Le);if(Ue|=(127&(qe=Ct[Oe.pos++]))<<10,qe<128)return a(Re,Ue,Le);if(Ue|=(127&(qe=Ct[Oe.pos++]))<<17,qe<128)return a(Re,Ue,Le);if(Ue|=(127&(qe=Ct[Oe.pos++]))<<24,qe<128)return a(Re,Ue,Le);if(Ue|=(1&(qe=Ct[Oe.pos++]))<<31,qe<128)return a(Re,Ue,Le);throw new Error("Expected varint not more than 10 bytes")}(Le|=(15&(Oe=Ue[this.pos]))<<28,Re,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var Re=this.readVarint();return Re%2==1?(Re+1)/-2:Re/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var Re=this.readVarint()+this.pos,Le=this.pos;return this.pos=Re,Re-Le>=12&&Ue?function(Re,Le,Oe){return Ue.decode(Re.subarray(Le,Oe))}(this.buf,Le,Re):function(Re,Le,Oe){for(var Ue="",qe=Le;qe<Oe;){var Ct,Ot,Jt,Hr=Re[qe],Jr=null,Ln=Hr>239?4:Hr>223?3:Hr>191?2:1;if(qe+Ln>Oe)break;1===Ln?Hr<128&&(Jr=Hr):2===Ln?128==(192&(Ct=Re[qe+1]))&&(Jr=(31&Hr)<<6|63&Ct)<=127&&(Jr=null):3===Ln?(Ot=Re[qe+2],128==(192&(Ct=Re[qe+1]))&&128==(192&Ot)&&((Jr=(15&Hr)<<12|(63&Ct)<<6|63&Ot)<=2047||Jr>=55296&&Jr<=57343)&&(Jr=null)):4===Ln&&(Ot=Re[qe+2],Jt=Re[qe+3],128==(192&(Ct=Re[qe+1]))&&128==(192&Ot)&&128==(192&Jt)&&((Jr=(15&Hr)<<18|(63&Ct)<<12|(63&Ot)<<6|63&Jt)<=65535||Jr>=1114112)&&(Jr=null)),null===Jr?(Jr=65533,Ln=1):Jr>65535&&(Jr-=65536,Ue+=String.fromCharCode(Jr>>>10&1023|55296),Jr=56320|1023&Jr),Ue+=String.fromCharCode(Jr),qe+=Ln}return Ue}(this.buf,Le,Re)},readBytes:function(){var Re=this.readVarint()+this.pos,Le=this.buf.subarray(this.pos,Re);return this.pos=Re,Le},readPackedVarint:function(Re,Le){if(this.type!==e.Bytes)return Re.push(this.readVarint(Le));var Oe=s(this);for(Re=Re||[];this.pos<Oe;)Re.push(this.readVarint(Le));return Re},readPackedSVarint:function(Re){if(this.type!==e.Bytes)return Re.push(this.readSVarint());var Le=s(this);for(Re=Re||[];this.pos<Le;)Re.push(this.readSVarint());return Re},readPackedBoolean:function(Re){if(this.type!==e.Bytes)return Re.push(this.readBoolean());var Le=s(this);for(Re=Re||[];this.pos<Le;)Re.push(this.readBoolean());return Re},readPackedFloat:function(Re){if(this.type!==e.Bytes)return Re.push(this.readFloat());var Le=s(this);for(Re=Re||[];this.pos<Le;)Re.push(this.readFloat());return Re},readPackedDouble:function(Re){if(this.type!==e.Bytes)return Re.push(this.readDouble());var Le=s(this);for(Re=Re||[];this.pos<Le;)Re.push(this.readDouble());return Re},readPackedFixed32:function(Re){if(this.type!==e.Bytes)return Re.push(this.readFixed32());var Le=s(this);for(Re=Re||[];this.pos<Le;)Re.push(this.readFixed32());return Re},readPackedSFixed32:function(Re){if(this.type!==e.Bytes)return Re.push(this.readSFixed32());var Le=s(this);for(Re=Re||[];this.pos<Le;)Re.push(this.readSFixed32());return Re},readPackedFixed64:function(Re){if(this.type!==e.Bytes)return Re.push(this.readFixed64());var Le=s(this);for(Re=Re||[];this.pos<Le;)Re.push(this.readFixed64());return Re},readPackedSFixed64:function(Re){if(this.type!==e.Bytes)return Re.push(this.readSFixed64());var Le=s(this);for(Re=Re||[];this.pos<Le;)Re.push(this.readSFixed64());return Re},skip:function(Re){var Le=7&Re;if(Le===e.Varint)for(;this.buf[this.pos++]>127;);else if(Le===e.Bytes)this.pos=this.readVarint()+this.pos;else if(Le===e.Fixed32)this.pos+=4;else{if(Le!==e.Fixed64)throw new Error("Unimplemented type: "+Le);this.pos+=8}},writeTag:function(Re,Le){this.writeVarint(Re<<3|Le)},realloc:function(Re){for(var Le=this.length||16;Le<this.pos+Re;)Le*=2;if(Le!==this.length){var Oe=new Uint8Array(Le);Oe.set(this.buf),this.buf=Oe,this.length=Le}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(Re){this.realloc(4),x(this.buf,Re,this.pos),this.pos+=4},writeSFixed32:function(Re){this.realloc(4),x(this.buf,Re,this.pos),this.pos+=4},writeFixed64:function(Re){this.realloc(8),x(this.buf,-1&Re,this.pos),x(this.buf,Math.floor(Re*Oe),this.pos+4),this.pos+=8},writeSFixed64:function(Re){this.realloc(8),x(this.buf,-1&Re,this.pos),x(this.buf,Math.floor(Re*Oe),this.pos+4),this.pos+=8},writeVarint:function(Re){(Re=+Re||0)>268435455||Re<0?function(Re,Le){var Oe,Ue;if(Re>=0?(Oe=Re%4294967296|0,Ue=Re/4294967296|0):(Ue=~(-Re/4294967296),4294967295^(Oe=~(-Re%4294967296))?Oe=Oe+1|0:(Oe=0,Ue=Ue+1|0)),Re>=0x10000000000000000||Re<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");Le.realloc(10),function(Re,Le,Oe){Oe.buf[Oe.pos++]=127&Re|128,Re>>>=7,Oe.buf[Oe.pos++]=127&Re|128,Re>>>=7,Oe.buf[Oe.pos++]=127&Re|128,Re>>>=7,Oe.buf[Oe.pos++]=127&Re|128,Oe.buf[Oe.pos]=127&(Re>>>=7)}(Oe,0,Le),function(Re,Le){var Oe=(7&Re)<<4;Le.buf[Le.pos++]|=Oe|((Re>>>=3)?128:0),Re&&(Le.buf[Le.pos++]=127&Re|((Re>>>=7)?128:0),Re&&(Le.buf[Le.pos++]=127&Re|((Re>>>=7)?128:0),Re&&(Le.buf[Le.pos++]=127&Re|((Re>>>=7)?128:0),Re&&(Le.buf[Le.pos++]=127&Re|((Re>>>=7)?128:0),Re&&(Le.buf[Le.pos++]=127&Re)))))}(Ue,Le)}(Re,this):(this.realloc(4),this.buf[this.pos++]=127&Re|(Re>127?128:0),Re<=127||(this.buf[this.pos++]=127&(Re>>>=7)|(Re>127?128:0),Re<=127||(this.buf[this.pos++]=127&(Re>>>=7)|(Re>127?128:0),Re<=127||(this.buf[this.pos++]=Re>>>7&127))))},writeSVarint:function(Re){this.writeVarint(Re<0?2*-Re-1:2*Re)},writeBoolean:function(Re){this.writeVarint(Boolean(Re))},writeString:function(Re){Re=String(Re),this.realloc(4*Re.length),this.pos++;var Le=this.pos;this.pos=function(Re,Le,Oe){for(var Ue,qe,Ct=0;Ct<Le.length;Ct++){if((Ue=Le.charCodeAt(Ct))>55295&&Ue<57344){if(!qe){Ue>56319||Ct+1===Le.length?(Re[Oe++]=239,Re[Oe++]=191,Re[Oe++]=189):qe=Ue;continue}if(Ue<56320){Re[Oe++]=239,Re[Oe++]=191,Re[Oe++]=189,qe=Ue;continue}Ue=qe-55296<<10|Ue-56320|65536,qe=null}else qe&&(Re[Oe++]=239,Re[Oe++]=191,Re[Oe++]=189,qe=null);Ue<128?Re[Oe++]=Ue:(Ue<2048?Re[Oe++]=Ue>>6|192:(Ue<65536?Re[Oe++]=Ue>>12|224:(Re[Oe++]=Ue>>18|240,Re[Oe++]=Ue>>12&63|128),Re[Oe++]=Ue>>6&63|128),Re[Oe++]=63&Ue|128)}return Oe}(this.buf,Re,this.pos);var Oe=this.pos-Le;Oe>=128&&o(Le,Oe,this),this.pos=Le-1,this.writeVarint(Oe),this.pos+=Oe},writeFloat:function(Le){this.realloc(4),Re.write(this.buf,Le,this.pos,!0,23,4),this.pos+=4},writeDouble:function(Le){this.realloc(8),Re.write(this.buf,Le,this.pos,!0,52,8),this.pos+=8},writeBytes:function(Re){var Le=Re.length;this.writeVarint(Le),this.realloc(Le);for(var Oe=0;Oe<Le;Oe++)this.buf[this.pos++]=Re[Oe]},writeRawMessage:function(Re,Le){this.pos++;var Oe=this.pos;Re(Le,this);var Ue=this.pos-Oe;Ue>=128&&o(Oe,Ue,this),this.pos=Oe-1,this.writeVarint(Ue),this.pos+=Ue},writeMessage:function(Re,Le,Oe){this.writeTag(Re,e.Bytes),this.writeRawMessage(Le,Oe)},writePackedVarint:function(Re,Le){Le.length&&this.writeMessage(Re,l,Le)},writePackedSVarint:function(Re,Le){Le.length&&this.writeMessage(Re,u,Le)},writePackedBoolean:function(Re,Le){Le.length&&this.writeMessage(Re,p,Le)},writePackedFloat:function(Re,Le){Le.length&&this.writeMessage(Re,c,Le)},writePackedDouble:function(Re,Le){Le.length&&this.writeMessage(Re,h,Le)},writePackedFixed32:function(Re,Le){Le.length&&this.writeMessage(Re,f,Le)},writePackedSFixed32:function(Re,Le){Le.length&&this.writeMessage(Re,d,Le)},writePackedFixed64:function(Re,Le){Le.length&&this.writeMessage(Re,m,Le)},writePackedSFixed64:function(Re,Le){Le.length&&this.writeMessage(Re,y,Le)},writeBytesField:function(Re,Le){this.writeTag(Re,e.Bytes),this.writeBytes(Le)},writeFixed32Field:function(Re,Le){this.writeTag(Re,e.Fixed32),this.writeFixed32(Le)},writeSFixed32Field:function(Re,Le){this.writeTag(Re,e.Fixed32),this.writeSFixed32(Le)},writeFixed64Field:function(Re,Le){this.writeTag(Re,e.Fixed64),this.writeFixed64(Le)},writeSFixed64Field:function(Re,Le){this.writeTag(Re,e.Fixed64),this.writeSFixed64(Le)},writeVarintField:function(Re,Le){this.writeTag(Re,e.Varint),this.writeVarint(Le)},writeSVarintField:function(Re,Le){this.writeTag(Re,e.Varint),this.writeSVarint(Le)},writeStringField:function(Re,Le){this.writeTag(Re,e.Bytes),this.writeString(Le)},writeFloatField:function(Re,Le){this.writeTag(Re,e.Fixed32),this.writeFloat(Le)},writeDoubleField:function(Re,Le){this.writeTag(Re,e.Fixed64),this.writeDouble(Le)},writeBooleanField:function(Re,Le){this.writeVarintField(Re,Boolean(Le))}},O_}var B_=e(af());const F_=3;function uf(Re,Le,Oe){Le.glyphs=[],1===Re&&Oe.readMessage(cf,Le)}function cf(Re,Le,Oe){if(3===Re){const{id:Re,bitmap:Ue,width:qe,height:Ct,left:Ot,top:Jt,advance:Hr}=Oe.readMessage(hf,{});Le.glyphs.push({id:Re,bitmap:new nc({width:qe+2*F_,height:Ct+2*F_},Ue),metrics:{width:qe,height:Ct,left:Ot,top:Jt,advance:Hr}})}else 4===Re?Le.ascender=Oe.readSVarint():5===Re&&(Le.descender=Oe.readSVarint())}function hf(Re,Le,Oe){1===Re?Le.id=Oe.readVarint():2===Re?Le.bitmap=Oe.readBytes():3===Re?Le.width=Oe.readVarint():4===Re?Le.height=Oe.readVarint():5===Re?Le.left=Oe.readSVarint():6===Re?Le.top=Oe.readSVarint():7===Re&&(Le.advance=Oe.readVarint())}const N_=F_,j_={horizontal:1,vertical:2,horizontalOnly:3};class df{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(Re,Le){const Oe=new df;return Oe.scale=Re||1,Oe.fontStack=Le,Oe}static forImage(Re){const Le=new df;return Le.imageName=Re,Le}}class mf{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(Re,Le){const Oe=new mf;for(let Ue=0;Ue<Re.sections.length;Ue++){const qe=Re.sections[Ue];qe.image?Oe.addImageSection(qe):Oe.addTextSection(qe,Le)}return Oe}length(){return this.text.length}getSection(Re){return this.sections[this.sectionIndex[Re]]}getSections(){return this.sections}getSectionIndex(Re){return this.sectionIndex[Re]}getCodePoint(Re){return this.text.codePointAt(Re)}verticalizePunctuation(Re){this.text=function(Re,Le){let Oe="";for(let Ue=0;Ue<Re.length;Ue++){const qe=Re.charCodeAt(Ue+1)||null,Ct=Re.charCodeAt(Ue-1)||null;Oe+=!Le&&(qe&&gs(qe)&&!R_[Re[Ue+1]]||Ct&&gs(Ct)&&!R_[Re[Ue-1]])||!R_[Re[Ue]]?Re[Ue]:R_[Re[Ue]]}return Oe}(this.text,Re)}trim(){let Re=0;for(let Le=0;Le<this.text.length&&U_[this.text.charCodeAt(Le)];Le++)Re++;let Le=this.text.length;for(let Oe=this.text.length-1;Oe>=0&&Oe>=Re&&U_[this.text.charCodeAt(Oe)];Oe--)Le--;this.text=this.text.substring(Re,Le),this.sectionIndex=this.sectionIndex.slice(Re,Le)}substring(Re,Le){const Oe=new mf;return Oe.text=this.text.substring(Re,Le),Oe.sectionIndex=this.sectionIndex.slice(Re,Le),Oe.sections=this.sections,Oe}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((Re,Le)=>Math.max(Re,this.sections[Le].scale)),0)}addTextSection(Re,Le){this.text+=Re.text,this.sections.push(df.forText(Re.scale,Re.fontStack||Le));const Oe=this.sections.length-1;for(let Le=0;Le<Re.text.length;++Le)this.sectionIndex.push(Oe)}addImageSection(Re){const Le=Re.image?Re.image.namePrimary:"";if(0===Le.length)return void ft("Can't add FormattedSection with an empty image.");const Oe=this.getNextImageSectionCharCode();Oe?(this.text+=String.fromCodePoint(Oe),this.sections.push(df.forImage(Le)),this.sectionIndex.push(this.sections.length-1)):ft("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function yf(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr,Ln,Nn,$n,Gn,qn){const Zn=mf.fromFeature(Re,qe);Nn===j_.vertical&&Zn.verticalizePunctuation($n);let Xn=[];const Yn=function(Re,Le,Oe,Ue,qe,Ct){if(!Re)return[];const Ot=[],Jt=function(Re,Le,Oe,Ue,qe,Ct){let Ot=0;for(let Oe=0;Oe<Re.length();Oe++){const Jt=Re.getSection(Oe);Ot+=bf(Re.getCodePoint(Oe),Jt,Ue,qe,Le,Ct)}return Ot/Math.max(1,Math.ceil(Ot/Oe))}(Re,Le,Oe,Ue,qe,Ct),Hr=Re.text.indexOf("​")>=0;let Jr=0;for(let Oe=0;Oe<Re.length();Oe++){const Nn=Re.getSection(Oe),$n=Re.getCodePoint(Oe);if(U_[$n]||(Jr+=bf($n,Nn,Ue,qe,Le,Ct)),Oe<Re.length()-1){const Le=!((Ln=$n)<11904||!(xp["Bopomofo Extended"](Ln)||xp.Bopomofo(Ln)||xp["CJK Compatibility Forms"](Ln)||xp["CJK Compatibility Ideographs"](Ln)||xp["CJK Compatibility"](Ln)||xp["CJK Radicals Supplement"](Ln)||xp["CJK Strokes"](Ln)||xp["CJK Symbols and Punctuation"](Ln)||xp["CJK Unified Ideographs Extension A"](Ln)||xp["CJK Unified Ideographs"](Ln)||xp["Enclosed CJK Letters and Months"](Ln)||xp["Halfwidth and Fullwidth Forms"](Ln)||xp.Hiragana(Ln)||xp["Ideographic Description Characters"](Ln)||xp["Kangxi Radicals"](Ln)||xp["Katakana Phonetic Extensions"](Ln)||xp.Katakana(Ln)||xp["Vertical Forms"](Ln)||xp["Yi Radicals"](Ln)||xp["Yi Syllables"](Ln)));(V_[$n]||Le||Nn.imageName)&&Ot.push(_f(Oe+1,Jr,Jt,Ot,wf($n,Re.getCodePoint(Oe+1),Le&&Hr),!1))}}var Ln;return Mf(_f(Re.length(),Jr,Jt,Ot,0,!0))}(Zn,Jr,Ct,Le,Ue,Gn),{processBidirectionalText:_i,processStyledBidirectionalText:vi}=Dp;if(_i&&1===Zn.sections.length){const Re=_i(Zn.toString(),Yn);for(const Le of Re){const Re=new mf;Re.text=Le,Re.sections=Zn.sections;for(let Oe=0;Oe<Le.length;Oe++)Re.sectionIndex.push(0);Xn.push(Re)}}else if(vi){const Re=vi(Zn.text,Zn.sectionIndex,Yn);for(const Le of Re){const Re=new mf;Re.text=Le[0],Re.sectionIndex=Le[1],Re.sections=Zn.sections,Xn.push(Re)}}else Xn=function(Re,Le){const Oe=[],Ue=Re.text;let qe=0;for(const Ue of Le)Oe.push(Re.substring(qe,Ue)),qe=Ue;return qe<Ue.length&&Oe.push(Re.substring(qe,Ue.length)),Oe}(Zn,Yn);const xi=[],bi={positionedLines:xi,text:Zn.toString(),top:Ln[1],bottom:Ln[1],left:Ln[0],right:Ln[0],writingMode:Nn,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr,Ln,Nn){let $n=0,Gn=0,qn=0;const Zn="right"===Jt?1:"left"===Jt?0:.5;let Xn=!1;for(const Re of qe){const Oe=Re.getSections();for(const Re of Oe){if(Re.imageName)continue;const Oe=Le[Re.fontStack];if(Oe&&(Xn=void 0!==Oe.ascender&&void 0!==Oe.descender,!Xn))break}if(!Xn)break}let Yn=0;for(const Ot of qe){Ot.trim();const qe=Ot.getMaxScale(),Jt=(qe-1)*k_,vi={positionedGlyphs:[],lineOffset:0};Re.positionedLines[Yn]=vi;const xi=vi.positionedGlyphs;let bi=0;if(!Ot.length()){Gn+=Ct,++Yn;continue}let Pi=0,lo=0;for(let Ct=0;Ct<Ot.length();Ct++){const Jt=Ot.getSection(Ct),qn=Ot.getSectionIndex(Ct),Zn=Ot.getCodePoint(Ct);let Yn=Jt.scale,vi=null,uo=null,po=null,fo=k_,Io=0;const is=!(Hr===j_.horizontal||!Ln&&!ys(Zn)||Ln&&(U_[Zn]||(_i=Zn,xp.Arabic(_i)||xp["Arabic Supplement"](_i)||xp["Arabic Extended-A"](_i)||xp["Arabic Presentation Forms-A"](_i)||xp["Arabic Presentation Forms-B"](_i))));if(Jt.imageName){const Le=Ue[Jt.imageName];if(!Le)continue;po=Jt.imageName,Re.iconsInText=Re.iconsInText||!0,uo=Le.paddedRect;const Oe=Le.displaySize;Yn=Yn*k_/Nn,vi={width:Oe[0],height:Oe[1],left:0,top:-N_,advance:is?Oe[1]:Oe[0],localGlyph:!1},Io=Xn?-vi.height*Yn:qe*k_-17-Oe[1]*Yn,fo=vi.advance;const Ct=(is?Oe[0]:Oe[1])*Yn-k_*qe;Ct>0&&Ct>bi&&(bi=Ct)}else{const Re=Oe[Jt.fontStack];if(!Re)continue;Re[Zn]&&(uo=Re[Zn]);const Ue=Le[Jt.fontStack];if(!Ue)continue;const Ct=Ue.glyphs[Zn];if(!Ct)continue;if(vi=Ct.metrics,fo=8203!==Zn?k_:0,Xn){const Re=void 0!==Ue.ascender?Math.abs(Ue.ascender):0,Le=void 0!==Ue.descender?Math.abs(Ue.descender):0,Oe=(Re+Le)*Yn;Pi<Oe&&(Pi=Oe,lo=(Re-Le)/2*Yn),Io=-Re*Yn}else Io=(qe-Yn)*k_-17}is?(Re.verticalizable=!0,xi.push({glyph:Zn,imageName:po,x:$n,y:Gn+Io,vertical:is,scale:Yn,localGlyph:vi.localGlyph,fontStack:Jt.fontStack,sectionIndex:qn,metrics:vi,rect:uo}),$n+=fo*Yn+Jr):(xi.push({glyph:Zn,imageName:po,x:$n,y:Gn+Io,vertical:is,scale:Yn,localGlyph:vi.localGlyph,fontStack:Jt.fontStack,sectionIndex:qn,metrics:vi,rect:uo}),$n+=vi.advance*Yn+Jr)}0!==xi.length&&(qn=Math.max($n-Jr,qn),Xn?Sf(xi,Zn,bi,lo,Ct*qe/2):Sf(xi,Zn,bi,0,Ct/2)),$n=0;const uo=Ct*qe+bi;vi.lineOffset=Math.max(bi,Jt),Gn+=uo,++Yn}var _i;const vi=Gn,{horizontalAlign:xi,verticalAlign:bi}=Af(Ot);(function(Re,Le,Oe,Ue,qe,Ct){const Ot=(Le-Oe)*qe,Jt=-Ct*Ue;for(const Le of Re)for(const Re of Le.positionedGlyphs)Re.x+=Ot,Re.y+=Jt})(Re.positionedLines,Zn,xi,bi,qn,vi),Re.top+=-bi*vi,Re.bottom=Re.top+vi,Re.left+=-xi*qn,Re.right=Re.left+qn,Re.hasBaseline=Xn}(bi,Le,Oe,Ue,Xn,Ot,Jt,Hr,Nn,Jr,$n,qn),!function(Re){for(const Le of Re)if(0!==Le.positionedGlyphs.length)return!1;return!0}(xi)&&bi}const U_={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},V_={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function bf(Re,Le,Oe,Ue,qe,Ct){if(Le.imageName){const Re=Ue[Le.imageName];return Re?Re.displaySize[0]*Le.scale*k_/Ct+qe:0}{const Ue=Oe[Le.fontStack],Ct=Ue&&Ue.glyphs[Re];return Ct?Ct.metrics.advance*Le.scale+qe:0}}function vf(Re,Le,Oe,Ue){const qe=Math.pow(Re-Le,2);return Ue?Re<Le?qe/2:2*qe:qe+Math.abs(Oe)*Oe}function wf(Re,Le,Oe){let Ue=0;return 10===Re&&(Ue-=1e4),Oe&&(Ue+=150),40!==Re&&65288!==Re||(Ue+=50),41!==Le&&65289!==Le||(Ue+=50),Ue}function _f(Re,Le,Oe,Ue,qe,Ct){let Ot=null,Jt=vf(Le,Oe,qe,Ct);for(const Re of Ue){const Ue=vf(Le-Re.x,Oe,qe,Ct)+Re.badness;Ue<=Jt&&(Ot=Re,Jt=Ue)}return{index:Re,x:Le,priorBreak:Ot,badness:Jt}}function Mf(Re){return Re?Mf(Re.priorBreak).concat(Re.index):[]}function Af(Re){let Le=.5,Oe=.5;switch(Re){case"right":case"top-right":case"bottom-right":Le=1;break;case"left":case"top-left":case"bottom-left":Le=0}switch(Re){case"bottom":case"bottom-right":case"bottom-left":Oe=1;break;case"top":case"top-right":case"top-left":Oe=0}return{horizontalAlign:Le,verticalAlign:Oe}}function Sf(Re,Le,Oe,Ue,qe){if(!(Le||Oe||Ue||qe))return;const Ct=Re.length-1,Ot=Re[Ct],Jt=(Ot.x+Ot.metrics.advance*Ot.scale)*Le;for(let Le=0;Le<=Ct;Le++)Re[Le].x-=Jt,Re[Le].y+=Oe+Ue+qe}function If(Re,Le,Oe,Ue){const{horizontalAlign:qe,verticalAlign:Ct}=Af(Ue),Ot=Oe[0]-Re.displaySize[0]*qe,Jt=Oe[1]-Re.displaySize[1]*Ct;return{imagePrimary:Re,imageSecondary:Le,top:Jt,bottom:Jt+Re.displaySize[1],left:Ot,right:Ot+Re.displaySize[0]}}function Pf(Re,Le,Oe,Ue,qe,Ct){const Ot=Re.imagePrimary;let Jt;if(Ot.content){const Re=Ot.content,Le=Ot.pixelRatio||1;Jt=[Re[0]/Le,Re[1]/Le,Ot.displaySize[0]-Re[2]/Le,Ot.displaySize[1]-Re[3]/Le]}const Hr=Le.left*Ct,Jr=Le.right*Ct;let Ln,Nn,$n,Gn;"width"===Oe||"both"===Oe?(Gn=qe[0]+Hr-Ue[3],Nn=qe[0]+Jr+Ue[1]):(Gn=qe[0]+(Hr+Jr-Ot.displaySize[0])/2,Nn=Gn+Ot.displaySize[0]);const qn=Le.top*Ct,Zn=Le.bottom*Ct;return"height"===Oe||"both"===Oe?(Ln=qe[1]+qn-Ue[0],$n=qe[1]+Zn+Ue[2]):(Ln=qe[1]+(qn+Zn-Ot.displaySize[1])/2,$n=Ln+Ot.displaySize[1]),{imagePrimary:Ot,imageSecondary:void 0,top:Ln,right:Nn,bottom:$n,left:Gn,collisionPadding:Jt}}class zf extends Is{constructor(Re,Le,Oe,Ue,qe){super(Re,Le),this.angle=Ue,this.z=Oe,void 0!==qe&&(this.segment=qe)}clone(){return new zf(this.x,this.y,this.z,this.angle,this.segment)}}function kf(Re,Le,Oe,Ue,qe){if(void 0===Le.segment)return!0;let Ct=Le,Ot=Le.segment+1,Jt=0;for(;Jt>-Oe/2;){if(Ot--,Ot<0)return!1;Jt-=Re[Ot].dist(Ct),Ct=Re[Ot]}Jt+=Re[Ot].dist(Re[Ot+1]),Ot++;const Hr=[];let Jr=0;for(;Jt<Oe/2;){const Le=Re[Ot],Oe=Re[Ot+1];if(!Oe)return!1;let Ct=Re[Ot-1].angleTo(Le)-Le.angleTo(Oe);for(Ct=Math.abs((Ct+3*Math.PI)%(2*Math.PI)-Math.PI),Hr.push({distance:Jt,angleDelta:Ct}),Jr+=Ct;Jt-Hr[0].distance>Ue;)Jr-=Hr.shift().angleDelta;if(Jr>qe)return!1;Ot++,Jt+=Le.dist(Oe)}return!0}function Tf(Re){let Le=0;for(let Oe=0;Oe<Re.length-1;Oe++)Le+=Re[Oe].dist(Re[Oe+1]);return Le}function Ef(Re,Le,Oe){return Re?.6*Le*Oe:0}function Bf(Re,Le){return Math.max(Re?Re.right-Re.left:0,Le?Le.right-Le.left:0)}function Vf(Re,Le,Oe,Ue,qe,Ct){const Ot=Ef(Oe,qe,Ct),Jt=Bf(Oe,Ue)*Ct;let Hr=0;const Jr=Tf(Re)/2;for(let Oe=0;Oe<Re.length-1;Oe++){const Ue=Re[Oe],qe=Re[Oe+1],Ct=Ue.dist(qe);if(Hr+Ct>Jr){const Ln=(Jr-Hr)/Ct,Nn=ke(Ue.x,qe.x,Ln),$n=ke(Ue.y,qe.y,Ln),Gn=new zf(Nn,$n,0,qe.angleTo(Ue),Oe);return!Ot||kf(Re,Gn,Jt,Ot,Le)?Gn:void 0}Hr+=Ct}}function Cf(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr){const Jr=Ef(Ue,Ct,Ot),Ln=Bf(Ue,qe),Nn=Ln*Ot,$n=0===Re[0].x||Re[0].x===Hr||0===Re[0].y||Re[0].y===Hr;return Le-Nn<Le/4&&(Le=Nn+Le/4),Rf(Re,$n?Le/2*Jt%Le:(Ln/2+2*Ct)*Ot*Jt%Le,Le,Jr,Oe,Nn,$n,!1,Hr)}function Rf(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr){const Jr=Ct/2,Ln=Tf(Re);let Nn=0,$n=Le-Oe,Gn=[];for(let Le=0;Le<Re.length-1;Le++){const Ot=Re[Le],Jt=Re[Le+1],qn=Ot.dist(Jt),Zn=Jt.angleTo(Ot);for(;$n+Oe<Nn+qn;){$n+=Oe;const Xn=($n-Nn)/qn,Yn=ke(Ot.x,Jt.x,Xn),_i=ke(Ot.y,Jt.y,Xn);if(Yn>=0&&Yn<Hr&&_i>=0&&_i<Hr&&$n-Jr>=0&&$n+Jr<=Ln){const Oe=new zf(Yn,_i,0,Zn,Le);Ue&&!kf(Re,Oe,Ct,Ue,qe)||Gn.push(Oe)}}Nn+=qn}return Jt||Gn.length||Ot||(Gn=Rf(Re,Nn/2,Oe,Ue,qe,Ct,Ot,!0,Hr)),Gn}function Df(Re,Le,Oe,Ue,qe){const Ct=[];for(let Ot=0;Ot<Re.length;Ot++){const Jt=Re[Ot];let Hr;for(let Re=0;Re<Jt.length-1;Re++){let Ot=Jt[Re],Jr=Jt[Re+1];Ot.x<Le&&Jr.x<Le||(Ot.x<Le?Ot=new Is(Le,Ot.y+(Le-Ot.x)/(Jr.x-Ot.x)*(Jr.y-Ot.y))._round():Jr.x<Le&&(Jr=new Is(Le,Ot.y+(Le-Ot.x)/(Jr.x-Ot.x)*(Jr.y-Ot.y))._round()),Ot.y<Oe&&Jr.y<Oe||(Ot.y<Oe?Ot=new Is(Ot.x+(Oe-Ot.y)/(Jr.y-Ot.y)*(Jr.x-Ot.x),Oe)._round():Jr.y<Oe&&(Jr=new Is(Ot.x+(Oe-Ot.y)/(Jr.y-Ot.y)*(Jr.x-Ot.x),Oe)._round()),Ot.x>=Ue&&Jr.x>=Ue||(Ot.x>=Ue?Ot=new Is(Ue,Ot.y+(Ue-Ot.x)/(Jr.x-Ot.x)*(Jr.y-Ot.y))._round():Jr.x>=Ue&&(Jr=new Is(Ue,Ot.y+(Ue-Ot.x)/(Jr.x-Ot.x)*(Jr.y-Ot.y))._round()),Ot.y>=qe&&Jr.y>=qe||(Ot.y>=qe?Ot=new Is(Ot.x+(qe-Ot.y)/(Jr.y-Ot.y)*(Jr.x-Ot.x),qe)._round():Jr.y>=qe&&(Jr=new Is(Ot.x+(qe-Ot.y)/(Jr.y-Ot.y)*(Jr.x-Ot.x),qe)._round()),Hr&&Ot.equals(Hr[Hr.length-1])||(Hr=[Ot],Ct.push(Hr)),Hr.push(Jr)))))}}return Ct}function Lf(Re){let Le=0,Oe=0;for(const Ue of Re)Le+=Ue.w*Ue.h,Oe=Math.max(Oe,Ue.w);Re.sort(((Re,Le)=>Le.h-Re.h));const Ue=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(Le/.95)),Oe),h:1/0}];let qe=0,Ct=0;for(const Le of Re)for(let Re=Ue.length-1;Re>=0;Re--){const Oe=Ue[Re];if(!(Le.w>Oe.w||Le.h>Oe.h)){if(Le.x=Oe.x,Le.y=Oe.y,Ct=Math.max(Ct,Le.y+Le.h),qe=Math.max(qe,Le.x+Le.w),Le.w===Oe.w&&Le.h===Oe.h){const Le=Ue.pop();Re<Ue.length&&(Ue[Re]=Le)}else Le.h===Oe.h?(Oe.x+=Le.w,Oe.w-=Le.w):Le.w===Oe.w?(Oe.y+=Le.h,Oe.h-=Le.h):(Ue.push({x:Oe.x+Le.w,y:Oe.y,w:Oe.w-Le.w,h:Le.h}),Oe.y+=Le.h,Oe.h-=Le.h);break}}return{w:qe,h:Ct,fill:Le/(qe*Ct)||0}}os(zf,"Anchor");const $_=1;class Of{constructor(Re,{pixelRatio:Le,version:Oe,stretchX:Ue,stretchY:qe,content:Ct},Ot){this.paddedRect=Re,this.pixelRatio=Le,this.stretchX=Ue,this.stretchY=qe,this.content=Ct,this.version=Oe,this.padding=Ot}get tl(){return[this.paddedRect.x+this.padding,this.paddedRect.y+this.padding]}get br(){return[this.paddedRect.x+this.paddedRect.w-this.padding,this.paddedRect.y+this.paddedRect.h-this.padding]}get displaySize(){return[(this.paddedRect.w-2*this.padding)/this.pixelRatio,(this.paddedRect.h-2*this.padding)/this.pixelRatio]}}class Uf{constructor(Re,Le,Oe){const Ue={},qe={};this.haveRenderCallbacks=[];const Ct=[];this.addImages(Re,Ue,$_,Ct),this.addImages(Le,qe,2,Ct);const{w:Ot,h:Jt}=Lf(Ct),Hr=new ic({width:Ot||1,height:Jt||1});for(const Le in Re){const qe=Re[Le],Ct=Ue[Le].paddedRect;ic.copy(qe.data,Hr,{x:0,y:0},{x:Ct.x+$_,y:Ct.y+$_},qe.data,Oe,qe.sdf)}for(const Re in Le){const Ue=Le[Re],Ct=qe[Re].paddedRect;let Ot=qe[Re].padding;const Jt=Ct.x+Ot,Jr=Ct.y+Ot,Ln=Ue.data.width,Nn=Ue.data.height;Ot=Ot>1?Ot-1:Ot,ic.copy(Ue.data,Hr,{x:0,y:0},{x:Jt,y:Jr},Ue.data,Oe),ic.copy(Ue.data,Hr,{x:0,y:Nn-Ot},{x:Jt,y:Jr-Ot},{width:Ln,height:Ot},Oe),ic.copy(Ue.data,Hr,{x:0,y:0},{x:Jt,y:Jr+Nn},{width:Ln,height:Ot},Oe),ic.copy(Ue.data,Hr,{x:Ln-Ot,y:0},{x:Jt-Ot,y:Jr},{width:Ot,height:Nn},Oe),ic.copy(Ue.data,Hr,{x:0,y:0},{x:Jt+Ln,y:Jr},{width:Ot,height:Nn},Oe),ic.copy(Ue.data,Hr,{x:Ln-Ot,y:Nn-Ot},{x:Jt-Ot,y:Jr-Ot},{width:Ot,height:Ot},Oe),ic.copy(Ue.data,Hr,{x:0,y:Nn-Ot},{x:Jt+Ln,y:Jr-Ot},{width:Ot,height:Ot},Oe),ic.copy(Ue.data,Hr,{x:0,y:0},{x:Jt+Ln,y:Jr+Nn},{width:Ot,height:Ot},Oe),ic.copy(Ue.data,Hr,{x:Ln-Ot,y:0},{x:Jt-Ot,y:Jr+Nn},{width:Ot,height:Ot},Oe)}this.image=Hr,this.iconPositions=Ue,this.patternPositions=qe}addImages(Re,Le,Oe,Ue){for(const qe in Re){const Ct=Re[qe],Ot={x:0,y:0,w:Ct.data.width+2*Oe,h:Ct.data.height+2*Oe};Ue.push(Ot),Le[qe]=new Of(Ot,Ct,Oe),Ct.hasRenderCallback&&this.haveRenderCallbacks.push(qe)}}patchUpdatedImages(Re,Le,Oe){this.haveRenderCallbacks=this.haveRenderCallbacks.filter((Le=>Re.hasImage(Le,Oe))),Re.dispatchRenderCallbacks(this.haveRenderCallbacks,Oe);for(const Ue in Re.getUpdatedImages(Oe))this.patchUpdatedImage(this.iconPositions[Ue],Re.getImage(Ue,Oe),Le),this.patchUpdatedImage(this.patternPositions[Ue],Re.getImage(Ue,Oe),Le)}patchUpdatedImage(Re,Le,Oe){if(!Re||!Le)return;if(Re.version===Le.version)return;Re.version=Le.version;const[Ue,qe]=Re.tl;Oe.update(Le.data,{position:{x:Ue,y:qe}})}}os(Of,"ImagePosition"),os(Uf,"ImageAtlas");const G_=1e20;function Nf(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr){for(let Jr=Le;Jr<Le+Ue;Jr++)qf(Re,Oe*Ct+Jr,Ct,qe,Ot,Jt,Hr);for(let Jr=Oe;Jr<Oe+qe;Jr++)qf(Re,Jr*Ct+Le,1,Ue,Ot,Jt,Hr)}function qf(Re,Le,Oe,Ue,qe,Ct,Ot){Ct[0]=0,Ot[0]=-G_,Ot[1]=G_,qe[0]=Re[Le];for(let Jt=1,Hr=0,Jr=0;Jt<Ue;Jt++){qe[Jt]=Re[Le+Jt*Oe];const Ue=Jt*Jt;do{const Re=Ct[Hr];Jr=(qe[Jt]-qe[Re]+Ue-Re*Re)/(Jt-Re)/2}while(Jr<=Ot[Hr]&&--Hr>-1);Hr++,Ct[Hr]=Jt,Ot[Hr]=Jr,Ot[Hr+1]=G_}for(let Jt=0,Hr=0;Jt<Ue;Jt++){for(;Ot[Hr+1]<Jt;)Hr++;const Ue=Ct[Hr],Jr=Jt-Ue;Re[Le+Jt*Oe]=qe[Ue]+Jr*Jr}}const q_=2,H_={none:0,ideographs:1,all:2};class Xf{constructor(Re,Le,Oe){this.requestManager=Re,this.localGlyphMode=Le,this.localFontFamily=Oe,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(Re,Le){this.urls[Le]=Re}getGlyphs(Re,Le,Oe){const Ue=[],qe=this.urls[Le]||Al.GLYPHS_URL;for(const Le in Re)for(const Oe of Re[Le])Ue.push({stack:Le,id:Oe});rt(Ue,(({stack:Re,id:Le},Oe)=>{let Ue=this.entries[Re];Ue||(Ue=this.entries[Re]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let Ct=Ue.glyphs[Le];if(void 0!==Ct)return void Oe(null,{stack:Re,id:Le,glyph:Ct});if(Ct=this._tinySDF(Ue,Re,Le),Ct)return Ue.glyphs[Le]=Ct,void Oe(null,{stack:Re,id:Le,glyph:Ct});const Ot=Math.floor(Le/256);if(256*Ot>65535)return void Oe(new Error("glyphs > 65535 not supported"));if(Ue.ranges[Ot])return void Oe(null,{stack:Re,id:Le,glyph:Ct});let Jt=Ue.requests[Ot];Jt||(Jt=Ue.requests[Ot]=[],Xf.loadGlyphRange(Re,Ot,qe,this.requestManager,((Re,Le)=>{if(Le){Ue.ascender=Le.ascender,Ue.descender=Le.descender;for(const Re in Le.glyphs)this._doesCharSupportLocalGlyph(+Re)||(Ue.glyphs[+Re]=Le.glyphs[+Re]);Ue.ranges[Ot]=!0}for(const Oe of Jt)Oe(Re,Le);delete Ue.requests[Ot]}))),Jt.push(((Ue,qe)=>{Ue?Oe(Ue):qe&&Oe(null,{stack:Re,id:Le,glyph:qe.glyphs[Le]||null})}))}),((Re,Le)=>{if(Re)Oe(Re);else if(Le){const Re={};for(const{stack:Oe,id:Ue,glyph:qe}of Le)void 0===Re[Oe]&&(Re[Oe]={}),void 0===Re[Oe].glyphs&&(Re[Oe].glyphs={}),Re[Oe].glyphs[Ue]=qe&&{id:qe.id,bitmap:qe.bitmap.clone(),metrics:qe.metrics},Re[Oe].ascender=this.entries[Oe].ascender,Re[Oe].descender=this.entries[Oe].descender;Oe(null,Re)}}))}_doesCharSupportLocalGlyph(Re){return this.localGlyphMode!==H_.none&&(this.localGlyphMode===H_.all?!!this.localFontFamily:!!this.localFontFamily&&(xp["CJK Unified Ideographs"](Re)||xp["Hangul Syllables"](Re)||xp.Hiragana(Re)||xp.Katakana(Re)||xp["CJK Symbols and Punctuation"](Re)||xp["CJK Unified Ideographs Extension A"](Re)||xp["CJK Unified Ideographs Extension B"](Re)))}_tinySDF(Re,Le,Oe){const Ue=this.localFontFamily;if(!Ue||!this._doesCharSupportLocalGlyph(Oe))return;let qe=Re.tinySDF;if(!qe){let Oe="400";/bold/i.test(Le)?Oe="900":/medium/i.test(Le)?Oe="500":/light/i.test(Le)&&(Oe="200"),qe=Re.tinySDF=new Xf.TinySDF({fontFamily:Ue,fontWeight:Oe,fontSize:24*q_,buffer:3*q_,radius:8*q_}),qe.fontWeight=Oe}if(this.localGlyphs[qe.fontWeight][Oe])return this.localGlyphs[qe.fontWeight][Oe];const Ct=String.fromCodePoint(Oe),{data:Ot,width:Jt,height:Hr,glyphWidth:Jr,glyphHeight:Ln,glyphLeft:Nn,glyphTop:$n,glyphAdvance:Gn}=qe.draw(Ct);return this.localGlyphs[qe.fontWeight][Oe]={id:Oe,bitmap:new nc({width:Jt,height:Hr},Ot),metrics:{width:Jr/q_,height:Ln/q_,left:Nn/q_,top:$n/q_-27,advance:Gn/q_,localGlyph:!0}}}}Xf.loadGlyphRange=function(Re,Le,Oe,Ue,qe){const Ct=256*Le,Ot=Ct+255,Jt=Ue.transformRequest(Ue.normalizeGlyphsURL(Oe).replace("{fontstack}",Re).replace("{range}",`${Ct}-${Ot}`),iu.Glyphs);se(Jt,((Re,Le)=>{if(Re)qe(Re);else if(Le){const Re={},Oe=function(Re){return new B_(Re).readFields(uf,{})}(Le);for(const Le of Oe.glyphs)Re[Le.id]=Le;qe(null,{glyphs:Re,ascender:Oe.ascender,descender:Oe.descender})}}))},Xf.TinySDF=class{constructor({fontSize:Re=24,buffer:Le=3,radius:Oe=8,cutoff:Ue=.25,fontFamily:qe="sans-serif",fontWeight:Ct="normal",fontStyle:Ot="normal"}={}){this.buffer=Le,this.cutoff=Ue,this.radius=Oe;const Jt=this.size=Re+4*Le,Hr=this._createCanvas(Jt),Jr=this.ctx=Hr.getContext("2d",{willReadFrequently:!0});Jr.font=`${Ot} ${Ct} ${Re}px ${qe}`,Jr.textBaseline="alphabetic",Jr.textAlign="left",Jr.fillStyle="black",this.gridOuter=new Float64Array(Jt*Jt),this.gridInner=new Float64Array(Jt*Jt),this.f=new Float64Array(Jt),this.z=new Float64Array(Jt+1),this.v=new Uint16Array(Jt)}_createCanvas(Re){const Le=document.createElement("canvas");return Le.width=Le.height=Re,Le}draw(Re){const{width:Le,actualBoundingBoxAscent:Oe,actualBoundingBoxDescent:Ue,actualBoundingBoxLeft:qe,actualBoundingBoxRight:Ct}=this.ctx.measureText(Re),Ot=Math.ceil(Oe),Jt=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(Ct-qe))),Hr=Math.min(this.size-this.buffer,Ot+Math.ceil(Ue)),Jr=Jt+2*this.buffer,Ln=Hr+2*this.buffer,Nn=Math.max(Jr*Ln,0),$n=new Uint8ClampedArray(Nn),Gn={data:$n,width:Jr,height:Ln,glyphWidth:Jt,glyphHeight:Hr,glyphTop:Ot,glyphLeft:0,glyphAdvance:Le};if(0===Jt||0===Hr)return Gn;const{ctx:qn,buffer:Zn,gridInner:Xn,gridOuter:Yn}=this;qn.clearRect(Zn,Zn,Jt,Hr),qn.fillText(Re,Zn,Zn+Ot);const _i=qn.getImageData(Zn,Zn,Jt,Hr);Yn.fill(G_,0,Nn),Xn.fill(0,0,Nn);for(let Re=0;Re<Hr;Re++)for(let Le=0;Le<Jt;Le++){const Oe=_i.data[4*(Re*Jt+Le)+3]/255;if(0===Oe)continue;const Ue=(Re+Zn)*Jr+Le+Zn;if(1===Oe)Yn[Ue]=0,Xn[Ue]=G_;else{const Re=.5-Oe;Yn[Ue]=Re>0?Re*Re:0,Xn[Ue]=Re<0?Re*Re:0}}Nf(Yn,0,0,Jr,Ln,Jr,this.f,this.v,this.z),Nf(Xn,Zn,Zn,Jt,Hr,Jr,this.f,this.v,this.z);for(let Re=0;Re<Nn;Re++){const Le=Math.sqrt(Yn[Re])-Math.sqrt(Xn[Re]);$n[Re]=Math.round(255-255*(Le/this.radius+this.cutoff))}return Gn}};const W_=$_;function Zf(Re,Le,Oe,Ue){const qe=[],Ct=Re.imagePrimary,Ot=Ct.pixelRatio,Jt=Ct.paddedRect.w-2*W_,Hr=Ct.paddedRect.h-2*W_,Jr=Re.right-Re.left,Ln=Re.bottom-Re.top,Nn=Ct.stretchX||[[0,Jt]],$n=Ct.stretchY||[[0,Hr]],f=(Re,Le)=>Re+Le[1]-Le[0],Gn=Nn.reduce(f,0),qn=$n.reduce(f,0),Zn=Jt-Gn,Xn=Hr-qn;let Yn=0,_i=Gn,vi=0,xi=qn,bi=0,Pi=Zn,lo=0,uo=Xn;if(Ct.content&&Ue){const Re=Ct.content;Yn=Wf(Nn,0,Re[0]),vi=Wf($n,0,Re[1]),_i=Wf(Nn,Re[0],Re[2]),xi=Wf($n,Re[1],Re[3]),bi=Re[0]-Yn,lo=Re[1]-vi,Pi=Re[2]-Re[0]-_i,uo=Re[3]-Re[1]-xi}const I=(Ue,qe,Jt,Hr)=>{const Nn=Kf(Ue.stretch-Yn,_i,Jr,Re.left),$n=Jf(Ue.fixed-bi,Pi,Ue.stretch,Gn),Zn=Kf(qe.stretch-vi,xi,Ln,Re.top),Xn=Jf(qe.fixed-lo,uo,qe.stretch,qn),po=Kf(Jt.stretch-Yn,_i,Jr,Re.left),fo=Jf(Jt.fixed-bi,Pi,Jt.stretch,Gn),Io=Kf(Hr.stretch-vi,xi,Ln,Re.top),is=Jf(Hr.fixed-lo,uo,Hr.stretch,qn),as=new Is(Nn,Zn),Xs=new Is(po,Zn),ta=new Is(po,Io),ha=new Is(Nn,Io),el=new Is($n/Ot,Xn/Ot),tl=new Is(fo/Ot,is/Ot),il=Le*Math.PI/180;if(il){const Re=Math.sin(il),Le=Math.cos(il),Oe=[Le,-Re,Re,Le];as._matMult(Oe),Xs._matMult(Oe),ha._matMult(Oe),ta._matMult(Oe)}const sl=Ue.stretch+Ue.fixed,fl=Jt.stretch+Jt.fixed,Al=qe.stretch+qe.fixed,Ml=Hr.stretch+Hr.fixed,Hl=Re.imageSecondary;return{tl:as,tr:Xs,bl:ha,br:ta,texPrimary:{x:Ct.paddedRect.x+W_+sl,y:Ct.paddedRect.y+W_+Al,w:fl-sl,h:Ml-Al},texSecondary:Hl?{x:Hl.paddedRect.x+W_+sl,y:Hl.paddedRect.y+W_+Al,w:fl-sl,h:Ml-Al}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:el,pixelOffsetBR:tl,minFontScaleX:Pi/Ot/Jr,minFontScaleY:uo/Ot/Ln,isSDF:Oe}};if(Ue&&(Ct.stretchX||Ct.stretchY)){const Re=Hf(Nn,Zn,Gn),Le=Hf($n,Xn,qn);for(let Oe=0;Oe<Re.length-1;Oe++){const Ue=Re[Oe],Ct=Re[Oe+1];for(let Re=0;Re<Le.length-1;Re++)qe.push(I(Ue,Le[Re],Ct,Le[Re+1]))}}else qe.push(I({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:Jt+1},{fixed:0,stretch:Hr+1}));return qe}function Wf(Re,Le,Oe){let Ue=0;for(const qe of Re)Ue+=Math.max(Le,Math.min(Oe,qe[1]))-Math.max(Le,Math.min(Oe,qe[0]));return Ue}function Hf(Re,Le,Oe){const Ue=[{fixed:-W_,stretch:0}];for(const[Le,Oe]of Re){const Re=Ue[Ue.length-1];Ue.push({fixed:Le-Re.stretch,stretch:Re.stretch}),Ue.push({fixed:Le-Re.stretch,stretch:Re.stretch+(Oe-Le)})}return Ue.push({fixed:Le+W_,stretch:Oe}),Ue}function Kf(Re,Le,Oe,Ue){return Re/Le*Oe+Ue}function Jf(Re,Le,Oe,Ue){return Re-Le*Oe/Ue}function Qf(Re,Le,Oe,Ue){const qe=Le+Re.positionedLines[Ue].lineOffset;return 0===Ue?Oe+qe/2:Oe+(qe+(Le+Re.positionedLines[Ue-1].lineOffset))/2}function td(Re,Le=1,Oe=!1){let Ue=1/0,qe=1/0,Ct=-1/0,Ot=-1/0;const Jt=Re[0];for(let Re=0;Re<Jt.length;Re++){const Le=Jt[Re];(!Re||Le.x<Ue)&&(Ue=Le.x),(!Re||Le.y<qe)&&(qe=Le.y),(!Re||Le.x>Ct)&&(Ct=Le.x),(!Re||Le.y>Ot)&&(Ot=Le.y)}const Hr=Math.min(Ct-Ue,Ot-qe);let Jr=Hr/2;const Ln=new Wr([],ed);if(0===Hr)return new Is(Ue,qe);for(let Le=Ue;Le<Ct;Le+=Hr)for(let Oe=qe;Oe<Ot;Oe+=Hr)Ln.push(new rd(Le+Jr,Oe+Jr,Jr,Re));let Nn=function(Re){let Le=0,Oe=0,Ue=0;const qe=Re[0];for(let Re=0,Ct=qe.length,Ot=Ct-1;Re<Ct;Ot=Re++){const Ct=qe[Re],Jt=qe[Ot],Hr=Ct.x*Jt.y-Jt.x*Ct.y;Oe+=(Ct.x+Jt.x)*Hr,Ue+=(Ct.y+Jt.y)*Hr,Le+=3*Hr}return new rd(Oe/Le,Ue/Le,0,Re)}(Re),$n=Ln.length;for(;Ln.length;){const Ue=Ln.pop();(Ue.d>Nn.d||!Nn.d)&&(Nn=Ue,Oe&&console.log("found best %d after %d probes",Math.round(1e4*Ue.d)/1e4,$n)),Ue.max-Nn.d<=Le||(Jr=Ue.h/2,Ln.push(new rd(Ue.p.x-Jr,Ue.p.y-Jr,Jr,Re)),Ln.push(new rd(Ue.p.x+Jr,Ue.p.y-Jr,Jr,Re)),Ln.push(new rd(Ue.p.x-Jr,Ue.p.y+Jr,Jr,Re)),Ln.push(new rd(Ue.p.x+Jr,Ue.p.y+Jr,Jr,Re)),$n+=4)}return Oe&&(console.log(`num probes: ${$n}`),console.log(`best distance: ${Nn.d}`)),Nn.p}function ed(Re,Le){return Le.max-Re.max}class rd{constructor(Re,Le,Oe,Ue){this.p=new Is(Re,Le),this.h=Oe,this.d=function(Re,Le){let Oe=!1,Ue=1/0;for(let qe=0;qe<Le.length;qe++){const Ct=Le[qe];for(let Le=0,qe=Ct.length,Ot=qe-1;Le<qe;Ot=Le++){const qe=Ct[Le],Jt=Ct[Ot];qe.y>Re.y!=Jt.y>Re.y&&Re.x<(Jt.x-qe.x)*(Re.y-qe.y)/(Jt.y-qe.y)+qe.x&&(Oe=!Oe),Ue=Math.min(Ue,Fl(Re,qe,Jt))}}return(Oe?1:-1)*Math.sqrt(Ue)}(this.p,Ue),this.max=this.d+this.h*Math.SQRT2}}const Z_=Number.POSITIVE_INFINITY,X_=Math.sqrt(2);function sd(Re,[Le,Oe]){let Ue=0,qe=0;if(Oe===Z_){Le<0&&(Le=0);const Oe=Le/X_;switch(Re){case"top-right":case"top-left":qe=Oe-7;break;case"bottom-right":case"bottom-left":qe=7-Oe;break;case"bottom":qe=7-Le;break;case"top":qe=Le-7}switch(Re){case"top-right":case"bottom-right":Ue=-Oe;break;case"top-left":case"bottom-left":Ue=Oe;break;case"left":Ue=Le;break;case"right":Ue=-Le}}else{switch(Le=Math.abs(Le),Oe=Math.abs(Oe),Re){case"top-right":case"top-left":case"top":qe=Oe-7;break;case"bottom-right":case"bottom-left":case"bottom":qe=7-Oe}switch(Re){case"top-right":case"bottom-right":case"right":Ue=-Le;break;case"top-left":case"bottom-left":case"left":Ue=Le}}return[Ue,qe]}function ad(Re){switch(Re){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function od(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr,Ln,Nn,$n,Gn,qn){let Zn=Ct.textMaxSize.evaluate(Le,{},Nn);void 0===Zn&&(Zn=Ot);const Xn=Re.layers[0].layout,Yn=Xn.get("icon-offset").evaluate(Le,{},Nn),_i=hd(Oe.horizontal)||Oe.vertical,vi="globe"===$n.name,xi=k_,bi=Ot/xi,Pi=Re.tilePixelRatio*Zn/xi,lo=(Xs=Re.overscaling,Re.zoom>18&&Xs>2&&(Xs>>=1),Math.max(id/(512*Xs),1)*Xn.get("symbol-spacing")),uo=Xn.get("text-padding")*Re.tilePixelRatio,po=Xn.get("icon-padding")*Re.tilePixelRatio,fo=Y(Xn.get("text-max-angle")),Io="map"===Xn.get("text-rotation-alignment")&&"point"!==Xn.get("symbol-placement"),is="map"===Xn.get("icon-rotation-alignment")&&"point"!==Xn.get("symbol-placement"),as=Xn.get("symbol-placement"),Is=lo/2;var Xs;const ta=Xn.get("icon-text-fit").evaluate(Le,{},Nn),ha=Xn.get("icon-text-fit-padding").evaluate(Le,{},Nn),el="none"!==ta;let tl;!1===Re.hasAnyIconTextFit&&el&&(Re.hasAnyIconTextFit=!0),Ue&&el&&(Re.allowVerticalPlacement&&Oe.vertical&&(tl=Pf(Ue,Oe.vertical,ta,ha,Yn,bi)),_i&&(Ue=Pf(Ue,_i,ta,ha,Yn,bi)));const D=(Ot,Jt,Zn)=>{if(Jt.x<0||Jt.x>=id||Jt.y<0||Jt.y>=id)return;let Xn=null;if(vi){const{x:Re,y:Le,z:Oe}=$n.projectTilePoint(Jt.x,Jt.y,Zn);Xn={anchor:new zf(Re,Le,Oe,0,void 0),up:$n.upVector(Zn,Jt.x,Jt.y)}}!function(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr,Ln,Nn,$n,Gn,qn,Zn,Xn,Yn,_i,vi,xi,bi,Pi,lo,uo,po,fo){const Io=Re.addToLineVertexArray(Le,Ue);let is,as,Is,Xs,ta,ha,el,tl=0,il=0,sl=0,fl=0,Al=-1,Ml=-1;const Hl={};let Wl=Xu("");const Kl=Oe?Oe.anchor:Le,Jl="none"!==Hr.layout.get("icon-text-fit").evaluate(xi,{},uo);let Ql=0,oc=0;if(void 0===Hr._unevaluatedLayout.getValue("text-radial-offset")?[Ql,oc]=Hr.layout.get("text-offset").evaluate(xi,{},uo).map((Re=>Re*k_)):(Ql=Hr.layout.get("text-radial-offset").evaluate(xi,{},uo)*k_,oc=Z_),Re.allowVerticalPlacement&&qe.vertical){const Re=qe.vertical;if(qn)ha=fd(Re),Jt&&(el=fd(Jt));else{const Oe=Hr.layout.get("text-rotate").evaluate(xi,{},uo)+90;Is=pd(Jr,Kl,Le,Ln,Nn,$n,Re,Gn,Oe,Zn),Jt&&(Xs=pd(Jr,Kl,Le,Ln,Nn,$n,Jt,Yn,Oe))}}if(Ct){const Ue=Hr.layout.get("icon-rotate").evaluate(xi,{},uo),qe=Zf(Ct,Ue,Pi,Jl),Ot=Jt?Zf(Jt,Ue,Pi,Jl):void 0;as=pd(Jr,Kl,Le,Ln,Nn,$n,Ct,Yn,Ue),tl=4*qe.length;const Gn=Re.iconSizeData;let qn=null;"source"===Gn.kind?(qn=[M_*Hr.layout.get("icon-size").evaluate(xi,{},uo)],qn[0]>K_&&ft(`${Re.layerIds[0]}: Value for "icon-size" is >= ${Y_}. Reduce your "icon-size".`)):"composite"===Gn.kind&&(qn=[M_*bi.compositeIconSizes[0].evaluate(xi,{},uo),M_*bi.compositeIconSizes[1].evaluate(xi,{},uo)],(qn[0]>K_||qn[1]>K_)&&ft(`${Re.layerIds[0]}: Value for "icon-size" is >= ${Y_}. Reduce your "icon-size".`)),Re.addSymbols(Re.icon,qe,qn,vi,_i,xi,!1,Oe,Le,Io.lineStartIndex,Io.lineLength,-1,lo,uo,po,fo),Al=Re.icon.placedSymbolArray.length-1,Ot&&(il=4*Ot.length,Re.addSymbols(Re.icon,Ot,qn,vi,_i,xi,j_.vertical,Oe,Le,Io.lineStartIndex,Io.lineLength,-1,lo,uo,po,fo),Ml=Re.icon.placedSymbolArray.length-1)}for(const Ue in qe.horizontal){const Ct=qe.horizontal[Ue];is||(Wl=Xu(Ct.text),qn?ta=fd(Ct):is=pd(Jr,Kl,Le,Ln,Nn,$n,Ct,Gn,Hr.layout.get("text-rotate").evaluate(xi,{},uo),Zn));const Jt=1===Ct.positionedLines.length;if(sl+=cd(Re,Oe,Le,Ct,Ot,Hr,qn,xi,Zn,Io,qe.vertical?j_.horizontal:j_.horizontalOnly,Jt?Object.keys(qe.horizontal):[Ue],Hl,Al,bi,lo,uo,po),Jt)break}qe.vertical&&(fl+=cd(Re,Oe,Le,qe.vertical,Ot,Hr,qn,xi,Zn,Io,j_.vertical,["vertical"],Hl,Ml,bi,lo,uo,po));let lc=-1;const Z=(Re,Le)=>Re?Math.max(Re,Le):Le;lc=Z(ta,lc),lc=Z(ha,lc),lc=Z(el,lc);const Oc=lc>-1?1:0;Re.glyphOffsetArray.length>=65535&&ft("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==xi.sortKey&&Re.addToSortKeyRanges(Re.symbolInstances.length,xi.sortKey),Re.symbolInstances.emplaceBack(Le.x,Le.y,Kl.x,Kl.y,Kl.z,Hl.right>=0?Hl.right:-1,Hl.center>=0?Hl.center:-1,Hl.left>=0?Hl.left:-1,Hl.vertical>=0?Hl.vertical:-1,Al,Ml,Wl,void 0!==is?is:Re.collisionBoxArray.length,void 0!==is?is+1:Re.collisionBoxArray.length,void 0!==Is?Is:Re.collisionBoxArray.length,void 0!==Is?Is+1:Re.collisionBoxArray.length,void 0!==as?as:Re.collisionBoxArray.length,void 0!==as?as+1:Re.collisionBoxArray.length,Xs||Re.collisionBoxArray.length,Xs?Xs+1:Re.collisionBoxArray.length,Ln,sl,fl,tl,il,Oc,0,Ql,oc,lc,0,Jl?1:0)}(Re,Jt,Xn,Ot,Oe,Ue,qe,tl,Re.layers[0],Re.collisionBoxArray,Le.index,Le.sourceLayerIndex,Re.index,uo,Io,Hr,0,po,is,Yn,Le,Ct,Jr,Ln,Nn,Gn,qn)};if("line"===as)for(const qe of Df(Le.geometry,0,0,id,id)){const Le=Cf(qe,lo,fo,Oe.vertical||_i,Ue,xi,Pi,Re.overscaling,id);for(const Oe of Le)_i&&dd(Re,_i.text,Is,Oe)||D(qe,Oe,Nn)}else if("line-center"===as){for(const Re of Le.geometry)if(Re.length>1){const Le=Vf(Re,fo,Oe.vertical||_i,Ue,xi,Pi);Le&&D(Re,Le,Nn)}}else if("Polygon"===Le.type)for(const Re of Cc(Le.geometry,0)){const Le=td(Re,16);D(Re[0],new zf(Le.x,Le.y,0,0,void 0),Nn)}else if("LineString"===Le.type)for(const Re of Le.geometry)D(Re,new zf(Re[0].x,Re[0].y,0,0,void 0),Nn);else if("Point"===Le.type)for(const Re of Le.geometry)for(const Le of Re)D([Le],new zf(Le.x,Le.y,0,0,void 0),Nn)}const Y_=255,K_=Y_*M_;function cd(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr,Ln,Nn,$n,Gn,qn,Zn,Xn,Yn){const _i=function(Re,Le,Oe,Ue,qe,Ct,Ot,Jt){const Hr=[];if(0===Le.positionedLines.length)return Hr;const Jr=Ue.layout.get("text-rotate").evaluate(Ct,{})*Math.PI/180,Ln=function(Re){const Le=Re[0],Oe=Re[1],Ue=Le*Oe;return Ue>0?[Le,-Oe]:Ue<0?[-Le,Oe]:0===Le?[Oe,Le]:[Oe,-Le]}(Oe);let Nn=Math.abs(Le.top-Le.bottom);for(const Re of Le.positionedLines)Nn-=Re.lineOffset;const $n=Le.positionedLines.length,Gn=Nn/$n;let qn=Le.top-Oe[1];for(let Re=0;Re<$n;++Re){const Ue=Le.positionedLines[Re];qn=Qf(Le,Gn,qn,Re);for(const Re of Ue.positionedGlyphs){if(!Re.rect)continue;const Ue=Re.rect||{};let Ct=N_+1,Nn=!0,$n=1,Gn=0;if(Re.imageName){const Le=Ot[Re.imageName];if(!Le)continue;if(Le.sdf){ft("SDF images are not supported in formatted text and will be ignored.");continue}Nn=!1,$n=Le.pixelRatio,Ct=$_/$n}const Zn=(qe||Jt)&&Re.vertical,Xn=Re.metrics.advance*Re.scale/2,Yn=Re.metrics,_i=Re.rect;if(null===_i)continue;Jt&&Le.verticalizable&&(Gn=Re.imageName?Xn-Re.metrics.width*Re.scale/2:0);const vi=qe?[Re.x+Xn,Re.y]:[0,0];let xi=[0,0],bi=[0,0],Pi=!1;qe||(Zn?(bi=[Re.x+Xn+Ln[0],Re.y+Ln[1]-Gn],Pi=!0):xi=[Re.x+Xn+Oe[0],Re.y+Oe[1]-Gn]);const lo=_i.w*Re.scale/($n*(Re.localGlyph?q_:1)),uo=_i.h*Re.scale/($n*(Re.localGlyph?q_:1));let po,fo,Io,is;if(Zn){const Le=Re.y-qn,Oe=new Is(-Xn,Xn-Le),Ue=-Math.PI/2,qe=new Is(...bi);po=new Is(-Xn+xi[0],xi[1]),po._rotateAround(Ue,Oe)._add(qe),po.x+=-Le+Xn,po.y-=(Yn.left-Ct)*Re.scale;const Ot=Re.imageName?Yn.advance*Re.scale:k_*Re.scale,Jt=String.fromCodePoint(Re.glyph);Jp(Jt)?po.x+=(1-Ct)*Re.scale:Qp(Jt)?po.x+=Ot-Yn.height*Re.scale+(-Ct-1)*Re.scale:po.x+=Re.imageName||Yn.width+2*Ct===_i.w&&Yn.height+2*Ct===_i.h?(Ot-uo)/2:(Ot-(Yn.height+2*Ct)*Re.scale)/2,fo=new Is(po.x,po.y-lo),Io=new Is(po.x+uo,po.y),is=new Is(po.x+uo,po.y-lo)}else{const Le=(Yn.left-Ct)*Re.scale-Xn+xi[0],Oe=(-Yn.top-Ct)*Re.scale+xi[1],Ue=Le+lo,qe=Oe+uo;po=new Is(Le,Oe),fo=new Is(Ue,Oe),Io=new Is(Le,qe),is=new Is(Ue,qe)}if(Jr){let Re;Re=qe?new Is(0,0):Pi?new Is(Ln[0],Ln[1]):new Is(Oe[0],Oe[1]),po._rotateAround(Jr,Re),fo._rotateAround(Jr,Re),Io._rotateAround(Jr,Re),is._rotateAround(Jr,Re)}const as=new Is(0,0),Xs=new Is(0,0);Hr.push({tl:po,tr:fo,bl:Io,br:is,texPrimary:Ue,texSecondary:void 0,writingMode:Le.writingMode,glyphOffset:vi,sectionIndex:Re.sectionIndex,isSDF:Nn,pixelOffsetTL:as,pixelOffsetBR:Xs,minFontScaleX:0,minFontScaleY:0})}}return Hr}(0,Ue,Hr,Ct,Ot,Jt,qe,Re.allowVerticalPlacement),vi=Re.textSizeData;let xi=null;"source"===vi.kind?(xi=[M_*Ct.layout.get("text-size").evaluate(Jt,{},Xn)],xi[0]>K_&&ft(`${Re.layerIds[0]}: Value for "text-size" is >= ${Y_}. Reduce your "text-size".`)):"composite"===vi.kind&&(xi=[M_*qn.compositeTextSizes[0].evaluate(Jt,{},Xn),M_*qn.compositeTextSizes[1].evaluate(Jt,{},Xn)],(xi[0]>K_||xi[1]>K_)&&ft(`${Re.layerIds[0]}: Value for "text-size" is >= ${Y_}. Reduce your "text-size".`)),Re.addSymbols(Re.text,_i,xi,Hr,Ot,Jt,Ln,Le,Oe,Jr.lineStartIndex,Jr.lineLength,Gn,Zn,Xn,Yn,!1);for(const Le of Nn)$n[Le]=Re.text.placedSymbolArray.length-1;return 4*_i.length}function hd(Re){for(const Le in Re)return Re[Le];return null}function pd(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr){let Ln=Ot.top,Nn=Ot.bottom,$n=Ot.left,Gn=Ot.right;const qn=Ot.collisionPadding;if(qn&&($n-=qn[0],Ln-=qn[1],Gn+=qn[2],Nn+=qn[3]),Hr){const Re=new Is($n,Ln),Le=new Is(Gn,Ln),Oe=new Is($n,Nn),Ue=new Is(Gn,Nn),qe=Y(Hr);let Ct=new Is(0,0);Jr&&(Ct=new Is(Jr[0],Jr[1])),Re._rotateAround(qe,Ct),Le._rotateAround(qe,Ct),Oe._rotateAround(qe,Ct),Ue._rotateAround(qe,Ct),$n=Math.min(Re.x,Le.x,Oe.x,Ue.x),Gn=Math.max(Re.x,Le.x,Oe.x,Ue.x),Ln=Math.min(Re.y,Le.y,Oe.y,Ue.y),Nn=Math.max(Re.y,Le.y,Oe.y,Ue.y)}return Re.emplaceBack(Le.x,Le.y,Le.z,Oe.x,Oe.y,$n,Ln,Gn,Nn,Jt,Ue,qe,Ct),Re.length-1}function fd(Re){Re.collisionPadding&&(Re.top-=Re.collisionPadding[1],Re.bottom+=Re.collisionPadding[3]);const Le=Re.bottom-Re.top;return Le>0?Math.max(10,Le):null}function dd(Re,Le,Oe,Ue){const qe=Re.compareText;if(Le in qe){const Re=qe[Le];for(let Le=Re.length-1;Le>=0;Le--)if(Ue.dist(Re[Le])<Oe)return!0}else qe[Le]=[];return qe[Le].push(Ue),!1}function md(Re,Le){const Oe=Re.fovAboveCenter,Ue=Re.elevation?Re.elevation.getMinElevationBelowMSL()*Le:0,qe=(Re._camera.position[2]*Re.worldSize-Ue)/Math.cos(Re._pitch),Ct=Math.sin(Oe)*qe/Math.sin(Math.max(Math.PI/2-Re._pitch-Oe,.01));let Ot=Math.sin(Re._pitch)*Ct+qe;const Jt=qe*(1/Re._horizonShift);return Re.elevation&&0!==Re.elevation.exaggeration()||(Ot*=1+Math.max(Re.zoom-17,0)),Math.min(1.01*Ot,Jt)}function yd(Re,Le){if(!Le.isReprojectedInTileSpace)return{scale:1<<Re.z,x:Re.x,y:Re.y,x2:Re.x+1,y2:Re.y+1,projection:Le};const Oe=Math.pow(2,-Re.z),Ue=Re.x*Oe,qe=(Re.x+1)*Oe,Ct=Re.y*Oe,Ot=(Re.y+1)*Oe,Jt=cl(Ue),Hr=cl(qe),Jr=hl(Ct),Ln=hl(Ot),Nn=Le.project(Jt,Jr),$n=Le.project(Hr,Jr),Gn=Le.project(Hr,Ln),qn=Le.project(Jt,Ln);let Zn=Math.min(Nn.x,$n.x,Gn.x,qn.x),Xn=Math.min(Nn.y,$n.y,Gn.y,qn.y),Yn=Math.max(Nn.x,$n.x,Gn.x,qn.x),_i=Math.max(Nn.y,$n.y,Gn.y,qn.y);const vi=Oe/16;function v(Re,Oe,Ue,qe,Ct,Ot){const Jt=(Ue+Ct)/2,Hr=(qe+Ot)/2,Jr=Le.project(cl(Jt),hl(Hr)),Ln=Math.max(0,Zn-Jr.x,Xn-Jr.y,Jr.x-Yn,Jr.y-_i);Zn=Math.min(Zn,Jr.x),Yn=Math.max(Yn,Jr.x),Xn=Math.min(Xn,Jr.y),_i=Math.max(_i,Jr.y),Ln>vi&&(v(Re,Jr,Ue,qe,Jt,Hr),v(Jr,Oe,Jt,Hr,Ct,Ot))}v(Nn,$n,Ue,Ct,qe,Ct),v($n,Gn,qe,Ct,qe,Ot),v(Gn,qn,qe,Ot,Ue,Ot),v(qn,Nn,Ue,Ot,Ue,Ct),Zn-=vi,Xn-=vi,Yn+=vi,_i+=vi;const xi=1/Math.max(Yn-Zn,_i-Xn);return{scale:xi,x:Zn*xi,y:Xn*xi,x2:Yn*xi,y2:_i*xi,projection:Le}}function gd(Re,{x:Le,y:Oe},Ue=0){return new Is(((Le-Ue)*Re.scale-Re.x)*id,(Oe*Re.scale-Re.y)*id)}const J_=Io.mat4.identity(new Float32Array(16));class bd{constructor(Re){this.spec=Re,this.name=Re.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(Re,Le){return{x:0,y:0,z:0}}unproject(Re,Le){return new rl(0,0)}projectTilePoint(Re,Le,Oe){return{x:Re,y:Le,z:0}}locationPoint(Re,Le,Oe=!0){return Re._coordinatePoint(Re.locationCoordinate(Le),Oe)}pixelsPerMeter(Re,Le){return ul(1,Re)*Le}pixelSpaceConversion(Re,Le,Oe){return 1}farthestPixelDistance(Re){return md(Re,Re.pixelsPerMeter)}pointCoordinate(Re,Le,Oe,Ue){const qe=Re.horizonLineFromTop(!1),Ct=new Is(Le,Math.max(qe,Oe));return Re.rayIntersectionCoordinate(Re.pointRayIntersection(Ct,Ue))}pointCoordinate3D(Re,Le,Oe){const Ue=new Is(Le,Oe);if(Re.elevation)return Re.elevation.pointCoordinate(Ue);{const Le=this.pointCoordinate(Re,Ue.x,Ue.y,0);return[Le.x,Le.y,Le.z]}}isPointAboveHorizon(Re,Le){if(Re.elevation&&Re.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(Re,Le.x,Le.y);const Oe=Re.horizonLineFromTop();return Le.y<Oe}createInversionMatrix(Re,Le){return J_}createTileMatrix(Re,Le,Oe){let Ue,qe,Ct;const Ot=Oe.canonical,Jt=Io.mat4.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const Hr=yd(Ot,this);Ue=1,qe=Hr.x+Oe.wrap*Hr.scale,Ct=Hr.y,Io.mat4.scale(Jt,Jt,[Ue/Hr.scale,Ue/Hr.scale,Re.pixelsPerMeter/Le])}else Ue=Le/Re.zoomScale(Ot.z),qe=(Ot.x+Math.pow(2,Ot.z)*Oe.wrap)*Ue,Ct=Ot.y*Ue;return Io.mat4.translate(Jt,Jt,[qe,Ct,0]),Io.mat4.scale(Jt,Jt,[Ue/id,Ue/id,1]),Jt}upVector(Re,Le,Oe){return[0,0,1]}upVectorScale(Re,Le,Oe){return{metersToTile:1}}}class vd extends bd{constructor(Re){super(Re),this.range=[4,7],this.center=Re.center||[-96,37.5];const[Le,Oe]=this.parallels=Re.parallels||[29.5,45.5],Ue=Math.sin(Y(Le));this.n=(Ue+Math.sin(Y(Oe)))/2,this.c=1+Ue*(2*this.n-Ue),this.r0=Math.sqrt(this.c)/this.n}project(Re,Le){const{n:Oe,c:Ue,r0:qe}=this,Ct=Y(Re-this.center[0]),Ot=Y(Le),Jt=Math.sqrt(Ue-2*Oe*Math.sin(Ot))/Oe;return{x:Jt*Math.sin(Ct*Oe),y:Jt*Math.cos(Ct*Oe)-qe,z:0}}unproject(Re,Le){const{n:Oe,c:Ue,r0:qe}=this,Ct=qe+Le;let Ot=Math.atan2(Re,Math.abs(Ct))*Math.sign(Ct);Ct*Oe<0&&(Ot-=Math.PI*Math.sign(Re)*Math.sign(Ct));const Jt=Y(this.center[0])*Oe;Ot=et(Ot,-Math.PI-Jt,Math.PI-Jt);const Hr=Q(Z(Ot/Oe)+this.center[0],-180,180),Jr=Math.asin(Q((Ue-(Re*Re+Ct*Ct)*Oe*Oe)/(2*Oe),-1,1)),Ln=Q(Z(Jr),-im,im);return new rl(Hr,Ln)}}const Q_=1.340264,iy=-.081106,sy=893e-6,ly=.003796,my=Math.sqrt(3)/2;class Id extends bd{project(Re,Le){Le=Le/180*Math.PI,Re=Re/180*Math.PI;const Oe=Math.asin(my*Math.sin(Le)),Ue=Oe*Oe,qe=Ue*Ue*Ue;return{x:.5*(Re*Math.cos(Oe)/(my*(Q_+3*iy*Ue+qe*(7*sy+9*ly*Ue)))/Math.PI+.5),y:1-.5*(Oe*(Q_+iy*Ue+qe*(sy+ly*Ue))/Math.PI+1),z:0}}unproject(Re,Le){Re=(2*Re-.5)*Math.PI;let Oe=Le=(2*(1-Le)-1)*Math.PI,Ue=Oe*Oe,qe=Ue*Ue*Ue;for(let Re,Ct,Ot,Jt=0;Jt<12&&(Ct=Oe*(Q_+iy*Ue+qe*(sy+ly*Ue))-Le,Ot=Q_+3*iy*Ue+qe*(7*sy+9*ly*Ue),Re=Ct/Ot,Oe=Q(Oe-Re,-Math.PI/3,Math.PI/3),Ue=Oe*Oe,qe=Ue*Ue*Ue,!(Math.abs(Re)<1e-12));++Jt);const Ct=my*Re*(Q_+3*iy*Ue+qe*(7*sy+9*ly*Ue))/Math.cos(Oe),Ot=Math.asin(Math.sin(Oe)/my),Jt=Q(180*Ct/Math.PI,-180,180),Hr=Q(180*Ot/Math.PI,-im,im);return new rl(Jt,Hr)}}class Pd extends bd{constructor(Re){super(Re),this.wrap=!0,this.supportsWorldCopies=!0}project(Re,Le){return{x:.5+Re/360,y:.5-Le/360,z:0}}unproject(Re,Le){const Oe=360*(Re-.5),Ue=Q(360*(.5-Le),-im,im);return new rl(Oe,Ue)}}const zy=Math.PI/2;function kd(Re){return Math.tan((zy+Re)/2)}class Td extends bd{constructor(Re){super(Re),this.center=Re.center||[0,30];const[Le,Oe]=this.parallels=Re.parallels||[30,30];let Ue=Y(Le),qe=Y(Oe);this.southernCenter=Ue+qe<0,this.southernCenter&&(Ue=-Ue,qe=-qe);const Ct=Math.cos(Ue),Ot=kd(Ue);this.n=Ue===qe?Math.sin(Ue):Math.log(Ct/Math.cos(qe))/Math.log(kd(qe)/Ot),this.f=Ct*Math.pow(kd(Ue),this.n)/this.n}project(Re,Le){Le=Y(Le),this.southernCenter&&(Le=-Le),Re=Y(Re-this.center[0]);const Oe=1e-6,{n:Ue,f:qe}=this;qe>0?Le<-zy+Oe&&(Le=-zy+Oe):Le>zy-Oe&&(Le=zy-Oe);const Ct=qe/Math.pow(kd(Le),Ue);let Ot=Ct*Math.sin(Ue*Re),Jt=qe-Ct*Math.cos(Ue*Re);return Ot=.5*(Ot/Math.PI+.5),Jt=.5*(Jt/Math.PI+.5),{x:Ot,y:this.southernCenter?Jt:1-Jt,z:0}}unproject(Re,Le){Re=(2*Re-.5)*Math.PI,this.southernCenter&&(Le=1-Le),Le=(2*(1-Le)-.5)*Math.PI;const{n:Oe,f:Ue}=this,qe=Ue-Le,Ct=Math.sign(qe),Ot=Math.sign(Oe)*Math.sqrt(Re*Re+qe*qe);let Jt=Math.atan2(Re,Math.abs(qe))*Ct;qe*Oe<0&&(Jt-=Math.PI*Math.sign(Re)*Ct);const Hr=Q(Z(Jt/Oe)+this.center[0],-180,180),Jr=Q(Z(2*Math.atan(Math.pow(Ue/Ot,1/Oe))-zy),-im,im);return new rl(Hr,this.southernCenter?-Jr:Jr)}}class Ed extends bd{constructor(Re){super(Re),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(Re,Le){return{x:ol(Re),y:ll(Le),z:0}}unproject(Re,Le){const Oe=cl(Re),Ue=hl(Le);return new rl(Oe,Ue)}}const $y=Y(im);class Vd extends bd{project(Re,Le){const Oe=(Le=Y(Le))*Le,Ue=Oe*Oe;return{x:.5*((Re=Y(Re))*(.8707-.131979*Oe+Ue*(Ue*(.003971*Oe-.001529*Ue)-.013791))/Math.PI+.5),y:1-.5*(Le*(1.007226+Oe*(.015085+Ue*(.028874*Oe-.044475-.005916*Ue)))/Math.PI+1),z:0}}unproject(Re,Le){Re=(2*Re-.5)*Math.PI;let Oe=Le=(2*(1-Le)-1)*Math.PI,Ue=25,qe=0,Ct=Oe*Oe;do{Ct=Oe*Oe;const Re=Ct*Ct;qe=(Oe*(1.007226+Ct*(.015085+Re*(.028874*Ct-.044475-.005916*Re)))-Le)/(1.007226+Ct*(.045255+Re*(.259866*Ct-.311325-.005916*11*Re))),Oe=Q(Oe-qe,-$y,$y)}while(Math.abs(qe)>1e-6&&--Ue>0);Ct=Oe*Oe;const Ot=Q(Z(Re/(.8707+Ct*(Ct*(Ct*Ct*Ct*(.003971-.001529*Ct)-.013791)-.131979))),-180,180),Jt=Z(Oe);return new rl(Ot,Jt)}}const Gy=Y(im);class Rd extends bd{project(Re,Le){Le=Y(Le),Re=Y(Re);const Oe=Math.cos(Le),Ue=2/Math.PI,qe=Math.acos(Oe*Math.cos(Re/2)),Ct=Math.sin(qe)/qe,Ot=.5*(Re*Ue+2*Oe*Math.sin(Re/2)/Ct)||0,Jt=.5*(Le+Math.sin(Le)/Ct)||0;return{x:.5*(Ot/Math.PI+.5),y:1-.5*(Jt/Math.PI+1),z:0}}unproject(Re,Le){let Oe=Re=(2*Re-.5)*Math.PI,Ue=Le=(2*(1-Le)-1)*Math.PI,qe=25;const Ct=1e-6;let Ot=0,Jt=0;do{const qe=Math.cos(Ue),Ct=Math.sin(Ue),Hr=2*Ct*qe,Jr=Ct*Ct,Ln=qe*qe,Nn=Math.cos(Oe/2),$n=Math.sin(Oe/2),Gn=2*Nn*$n,qn=$n*$n,Zn=1-Ln*Nn*Nn,Xn=Zn?1/Zn:0,Yn=Zn?Math.acos(qe*Nn)*Math.sqrt(1/Zn):0,_i=.5*(2*Yn*qe*$n+2*Oe/Math.PI)-Re,vi=.5*(Yn*Ct+Ue)-Le,xi=.5*Xn*(Ln*qn+Yn*qe*Nn*Jr)+1/Math.PI,bi=Xn*(Gn*Hr/4-Yn*Ct*$n),Pi=.125*Xn*(Hr*$n-Yn*Ct*Ln*Gn),lo=.5*Xn*(Jr*Nn+Yn*qn*qe)+.5,uo=bi*Pi-lo*xi;Ot=(vi*bi-_i*lo)/uo,Jt=(_i*Pi-vi*xi)/uo,Oe=Q(Oe-Ot,-Math.PI,Math.PI),Ue=Q(Ue-Jt,-Gy,Gy)}while((Math.abs(Ot)>Ct||Math.abs(Jt)>Ct)&&--qe>0);return new rl(Z(Oe),Z(Ue))}}class Dd extends bd{constructor(Re){super(Re),this.center=Re.center||[0,0],this.parallels=Re.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Y(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(Re,Le){const{scale:Oe,cosPhi:Ue}=this;return{x:Y(Re)*Ue*Oe+.5,y:-Math.sin(Y(Le))/Ue*Oe+.5,z:0}}unproject(Re,Le){const{scale:Oe,cosPhi:Ue}=this,qe=-(Le-.5)/Oe,Ct=Q(Z((Re-.5)/Oe)/Ue,-180,180),Ot=Math.asin(Q(qe*Ue,-1,1)),Jt=Q(Z(Ot),-im,im);return new rl(Ct,Jt)}}class Ld extends Ed{constructor(Re){super(Re),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(Re,Le,Oe){const Ue=zu(Re,Le,Oe),qe=Eu(_u(Oe));return Io.vec3.transformMat4(Ue,Ue,qe),{x:Ue[0],y:Ue[1],z:Ue[2]}}locationPoint(Re,Le){const Oe=Qo(Le.lat,Le.lng),Ue=Io.vec3.normalize([],Oe),qe=Re.elevation?Re.elevation.getAtPointOrZero(Re.locationCoordinate(Le),Re._centerAltitude):Re._centerAltitude,Ct=ul(1,0)*id*qe;Io.vec3.scaleAndAdd(Oe,Oe,Ue,Ct);const Ot=Io.mat4.identity(new Float64Array(16));return Io.mat4.multiply(Ot,Re.pixelMatrix,Re.globeMatrix),Io.vec3.transformMat4(Oe,Oe,Ot),new Is(Oe[0],Oe[1])}pixelsPerMeter(Re,Le){return ul(1,0)*Le}pixelSpaceConversion(Re,Le,Oe){const Ue=ul(1,Re)*Le,qe=ke(ul(1,45)*Le,Ue,Oe);return this.pixelsPerMeter(Re,Le)/qe}createTileMatrix(Re,Le,Oe){const Ue=Bu(_u(Oe.canonical));return Io.mat4.multiply(new Float64Array(16),Re.globeMatrix,Ue)}createInversionMatrix(Re,Le){const{center:Oe}=Re,Ue=Eu(_u(Le));return Io.mat4.rotateY(Ue,Ue,Y(Oe.lng)),Io.mat4.rotateX(Ue,Ue,Y(Oe.lat)),Io.mat4.scale(Ue,Ue,[Re._pixelsPerMercatorPixel,Re._pixelsPerMercatorPixel,1]),Float32Array.from(Ue)}pointCoordinate(Re,Le,Oe,Ue){return bu(Re,Le,Oe,!0)||new xl(0,0)}pointCoordinate3D(Re,Le,Oe){const Ue=this.pointCoordinate(Re,Le,Oe,0);return[Ue.x,Ue.y,Ue.z]}isPointAboveHorizon(Re,Le){return!bu(Re,Le.x,Le.y,!1)}farthestPixelDistance(Re){const Le=function(Re,Le){const Oe=Re.cameraToCenterDistance,Ue=Re._centerAltitude*Le,qe=Re._camera,Ct=Re._camera.forward(),Ot=Io.vec3.add([],Io.vec3.scale([],Ct,-Oe),[0,0,Ue]),Jt=Re.worldSize/(2*Math.PI),Hr=[0,0,-Jt],Jr=Re.width/Re.height,Ln=Math.tan(Re.fovAboveCenter),Nn=Io.vec3.scale([],qe.up(),Ln),$n=Io.vec3.scale([],qe.right(),Ln*Jr),Gn=Io.vec3.normalize([],Io.vec3.add([],Io.vec3.add([],Ct,Nn),$n)),qn=[];let Zn;if(new uu(Ot,Gn).closestPointOnSphere(Hr,Jt,qn)){const Le=Io.vec3.add([],qn,Hr),Oe=Io.vec3.sub([],Le,Ot);Zn=Math.cos(Re.fovAboveCenter)*Io.vec3.length(Oe)}else{const Re=Io.vec3.sub([],Ot,Hr),Le=Io.vec3.sub([],Hr,Ot);Io.vec3.normalize(Le,Le);const Oe=Io.vec3.length(Re)-Jt;Zn=Math.sqrt(Oe*(Oe+2*Jt));const Ue=Math.acos(Zn/(Jt+Oe))-Math.acos(Io.vec3.dot(Ct,Le));Zn*=Math.cos(Ue)}return 1.01*Zn}(Re,this.pixelsPerMeter(Re.center.lat,Re.worldSize)),Oe=Du(Re.zoom);if(Oe>0){const Ue=md(Re,ul(1,Re.center.lat)*Re.worldSize),qe=Re.worldSize/(2*Math.PI),Ct=Math.max(Re.width,Re.height)/Re.worldSize*Math.PI;return ke(Le,Ue+qe*(1-Math.cos(Ct)),Math.pow(Oe,10))}return Le}upVector(Re,Le,Oe){return zu(Le,Oe,Re,1)}upVectorScale(Re){return{metersToTile:gu(ku(_u(Re)))}}}function Fd(Re){const Le=Re.parallels,Oe=!!Le&&Math.abs(Le[0]+Le[1])<.01;switch(Re.name){case"mercator":return new Ed(Re);case"equirectangular":return new Pd(Re);case"naturalEarth":return new Vd(Re);case"equalEarth":return new Id(Re);case"winkelTripel":return new Rd(Re);case"albers":return Oe?new Dd(Re):new vd(Re);case"lambertConformalConic":return Oe?new Dd(Re):new Td(Re);case"globe":return new Ld(Re)}throw new Error(`Invalid projection name: ${Re.name}`)}const Wy=Fg.VectorTileFeature.types,Zy=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function jd(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr,Ln,Nn,$n){const Gn=Jt?Math.min(K_,Math.round(Jt[0])):0,qn=Jt?Math.min(K_,Math.round(Jt[1])):0;Re.emplaceBack(Le,Oe,Math.round(32*Ue),Math.round(32*qe),Ct,Ot,(Gn<<1)+(Hr?1:0),qn,16*Jr,16*Ln,256*Nn,256*$n)}function Nd(Re,Le,Oe){Re.emplaceBack(Le,Oe)}function qd(Re,Le,Oe,Ue,qe,Ct,Ot){Re.emplaceBack(Le,Oe,Ue,qe,Ct,Ot)}function $d(Re,Le,Oe,Ue,qe){Re.emplaceBack(Le,Oe,Ue,qe),Re.emplaceBack(Le,Oe,Ue,qe),Re.emplaceBack(Le,Oe,Ue,qe),Re.emplaceBack(Le,Oe,Ue,qe)}function Gd(Re){for(const Le of Re.sections)if(vs(Le.text))return!0;return!1}class Xd{constructor(Re){this.layoutVertexArray=new za,this.indexArray=new Da,this.programConfigurations=Re,this.segments=new co,this.dynamicLayoutVertexArray=new Ma,this.opacityVertexArray=new Ta,this.placedSymbolArray=new Ja,this.iconTransitioningVertexArray=new Ea,this.globeExtVertexArray=new ka,this.zOffsetVertexArray=new Oa}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length&&0===this.iconTransitioningVertexArray.length}upload(Re,Le,Oe,Ue,qe){this.isEmpty()||(Oe&&(this.layoutVertexBuffer=Re.createVertexBuffer(this.layoutVertexArray,x_.members),this.indexBuffer=Re.createIndexBuffer(this.indexArray,Le),this.dynamicLayoutVertexBuffer=Re.createVertexBuffer(this.dynamicLayoutVertexArray,w_.members,!0),this.opacityVertexBuffer=Re.createVertexBuffer(this.opacityVertexArray,Zy,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=Re.createVertexBuffer(this.iconTransitioningVertexArray,S_.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=Re.createVertexBuffer(this.globeExtVertexArray,b_.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||qe)&&(this.zOffsetVertexBuffer=Re.createVertexBuffer(this.zOffsetVertexArray,T_.members,!0)),this.opacityVertexBuffer.itemSize=1),(Oe||Ue)&&this.programConfigurations.upload(Re))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}os(Xd,"SymbolBuffers");class Yd{constructor(Re,Le,Oe){this.layoutVertexArray=new Re,this.layoutAttributes=Le,this.indexArray=new Oe,this.segments=new co,this.collisionVertexArray=new Ra,this.collisionVertexArrayExt=new Ma}upload(Re){this.layoutVertexBuffer=Re.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=Re.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=Re.createVertexBuffer(this.collisionVertexArray,E_.members,!0),this.collisionVertexBufferExt=Re.createVertexBuffer(this.collisionVertexArrayExt,C_.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}os(Yd,"CollisionBuffers");class Zd{constructor(Re){this.collisionBoxArray=Re.collisionBoxArray,this.zoom=Re.zoom,this.lut=Re.lut,this.overscaling=Re.overscaling,this.layers=Re.layers,this.layerIds=this.layers.map((Re=>Re.fqid)),this.index=Re.index,this.pixelRatio=Re.pixelRatio,this.sourceLayerIndex=Re.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Io.mat4.identity([]),this.placementViewportMatrix=Io.mat4.identity([]);const Le=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Xp(this.zoom,Le["text-size"]),this.iconSizeData=Xp(this.zoom,Le["icon-size"]);const Oe=this.layers[0].layout,Ue=Oe.get("symbol-sort-key"),qe=Oe.get("symbol-z-order");this.canOverlap=Oe.get("text-allow-overlap")||Oe.get("icon-allow-overlap")||Oe.get("text-ignore-placement")||Oe.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==qe&&void 0!==Ue.constantOr(1),this.sortFeaturesByY=("viewport-y"===qe||"auto"===qe&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=Oe.get("text-writing-mode").map((Re=>j_[Re])),this.stateDependentLayerIds=this.layers.filter((Re=>Re.isStateDependent())).map((Re=>Re.id)),this.sourceID=Re.sourceID,this.projection=Re.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=Oe.get("symbol-z-elevate"),this.activeReplacements=[],this.replacementUpdateTime=0}createArrays(){this.text=new Xd(new Fo(this.layers,{zoom:this.zoom,lut:this.lut},(Re=>Re.startsWith("text")||Re.startsWith("symbol")))),this.icon=new Xd(new Fo(this.layers,{zoom:this.zoom,lut:this.lut},(Re=>Re.startsWith("icon")||Re.startsWith("symbol")))),this.glyphOffsetArray=new eo,this.lineVertexArray=new ro,this.symbolInstances=new to}calculateGlyphDependencies(Re,Le,Oe,Ue,qe){for(let Oe=0;Oe<Re.length;Oe++){const Ct=Re.codePointAt(Oe);if(void 0===Ct)break;if(Le[Ct]=!0,Ue&&qe&&Ct<=65535){const Ue=R_[Re.charAt(Oe)];Ue&&(Le[Ue.charCodeAt(0)]=!0)}}}updateFootprints(Re,Le){}updateReplacement(Re,Le){if(Le.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=Le.updateTime;const Oe=Le.getReplacementRegionsForTile(Re.toUnwrapped(),!0);return!wh(this.activeReplacements,Oe)&&(this.activeReplacements=Oe,!0)}populate(Re,Le,Oe,Ue){const qe=this.layers[0],Ct=qe.layout,Ot="globe"===this.projection.name,Jt=Ct.get("text-font"),Hr=Ct.get("text-field"),Jr=Ct.get("icon-image"),Ln=("constant"!==Hr.value.kind||Hr.value.value instanceof Qe&&!Hr.value.value.isEmpty()||Hr.value.value.toString().length>0)&&("constant"!==Jt.value.kind||Jt.value.value.length>0),Nn="constant"!==Jr.value.kind||!!Jr.value.value||Object.keys(Jr.parameters).length>0,$n=Ct.get("symbol-sort-key");if(this.features=[],!Ln&&!Nn)return;const Gn=Le.iconDependencies,qn=Le.glyphDependencies,Zn=Le.availableImages,Xn=new Vs(this.zoom);for(const{feature:Le,id:Hr,index:Jr,sourceLayerIndex:Yn}of Re){const Re=qe._featureFilter.needGeometry,_i=Pl(Le,Re);if(!qe._featureFilter.filter(Xn,_i,Oe))continue;if(Re||(_i.geometry=Il(Le,Oe,Ue)),Ot&&1!==Le.type&&Oe.z<=5){const Re=_i.geometry,Le=.98078528056,n=(Re,Ue)=>{const qe=zu(Re.x,Re.y,Oe,1),Ct=zu(Ue.x,Ue.y,Oe,1);return Io.vec3.dot(qe,Ct)<Le};for(let Le=0;Le<Re.length;Le++)Re[Le]=_l(Re[Le],n)}let vi,xi;if(Ln){const Re=qe.getValueAndResolveTokens("text-field",_i,Oe,Zn),Le=Qe.factory(Re);Gd(Le)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===Ts()||this.hasRTLText&&Dp.isParsed())&&(vi=Hp(Le,qe,_i))}if(Nn){const Re=qe.getValueAndResolveTokens("icon-image",_i,Oe,Zn);xi=Re instanceof tr?Re:tr.fromString(Re)}if(!vi&&!xi)continue;const bi=this.sortFeaturesByKey?$n.evaluate(_i,{},Oe):void 0;if(this.features.push({id:Hr,text:vi,icon:xi,index:Jr,sourceLayerIndex:Yn,geometry:_i.geometry,properties:Le.properties,type:Wy[Le.type],sortKey:bi}),xi&&(Gn[xi.namePrimary]=!0,xi.nameSecondary&&(Gn[xi.nameSecondary]=!0)),vi){const Re=Jt.evaluate(_i,{},Oe).join(","),Le="map"===Ct.get("text-rotation-alignment")&&"point"!==Ct.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(j_.vertical)>=0;for(const Oe of vi.sections)if(Oe.image)Gn[Oe.image.namePrimary]=!0;else{const Ue=fs(vi.toString()),qe=Oe.fontStack||Re,Ct=qn[qe]=qn[qe]||{};this.calculateGlyphDependencies(Oe.text,Ct,Le,this.allowVerticalPlacement,Ue)}}}"line"===Ct.get("symbol-placement")&&(this.features=function(Re){const Le={},Oe={},Ue=[];let qe=0;function s(Le){Ue.push(Re[Le]),qe++}function a(Re,Le,qe){const Ct=Oe[Re];return delete Oe[Re],Oe[Le]=Ct,Ue[Ct].geometry[0].pop(),Ue[Ct].geometry[0]=Ue[Ct].geometry[0].concat(qe[0]),Ct}function o(Re,Oe,qe){const Ct=Le[Oe];return delete Le[Oe],Le[Re]=Ct,Ue[Ct].geometry[0].shift(),Ue[Ct].geometry[0]=qe[0].concat(Ue[Ct].geometry[0]),Ct}function l(Re,Le,Oe){const Ue=Oe?Le[0][Le[0].length-1]:Le[0][0];return`${Re}:${Ue.x}:${Ue.y}`}for(let Ct=0;Ct<Re.length;Ct++){const Ot=Re[Ct],Jt=Ot.geometry,Hr=Ot.text?Ot.text.toString():null;if(!Hr){s(Ct);continue}const Jr=l(Hr,Jt),Ln=l(Hr,Jt,!0);if(Jr in Oe&&Ln in Le&&Oe[Jr]!==Le[Ln]){const Re=o(Jr,Ln,Jt),qe=a(Jr,Ln,Ue[Re].geometry);delete Le[Jr],delete Oe[Ln],Oe[l(Hr,Ue[qe].geometry,!0)]=qe,Ue[Re].geometry=null}else Jr in Oe?a(Jr,Ln,Jt):Ln in Le?o(Jr,Ln,Jt):(s(Ct),Le[Jr]=qe-1,Oe[Ln]=qe-1)}return Ue.filter((Re=>Re.geometry))}(this.features)),this.sortFeaturesByKey&&this.features.sort(((Re,Le)=>Re.sortKey-Le.sortKey))}update(Re,Le,Oe,Ue,qe){const Ct=0!==Object.keys(Re).length;if(Ct&&!this.stateDependentLayers.length)return;const Ot=Ct?this.stateDependentLayers:this.layers;this.text.programConfigurations.updatePaintArrays(Re,Le,Ot,Oe,Ue,qe),this.icon.programConfigurations.updatePaintArrays(Re,Le,Ot,Oe,Ue,qe)}updateZOffset(){const t=(Le,Oe,Ue)=>{Re+=Oe,Re>Le.length&&Le.resize(Re);for(let qe=-Oe;qe<0;qe++)Le.emplace(qe+Re,Ue)},e=(Re,Oe,Ue)=>{Le+=Oe,Le>Re.length&&Re.resize(Le);for(let qe=-Oe;qe<0;qe++)Re.emplace(qe+Le,Ue)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let Re=0,Le=0;for(let Re=0;Re<this.symbolInstances.length;Re++){const Le=this.symbolInstances.get(Re),{numHorizontalGlyphVertices:Oe,numVerticalGlyphVertices:Ue,numIconVertices:qe}=Le,Ct=Le.zOffset,Ot=qe>0;if((Oe>0||Ue>0)&&(t(this.text.zOffsetVertexArray,Oe,Ct),t(this.text.zOffsetVertexArray,Ue,Ct)),Ot){const{placedIconSymbolIndex:Re,verticalPlacedIconSymbolIndex:Oe}=Le;Re>=0&&e(this.icon.zOffsetVertexArray,qe,Ct),Oe>=0&&e(this.icon.zOffsetVertexArray,Le.numVerticalIconVertices,Ct)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(Re){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(Re),this.iconCollisionBox.upload(Re)),this.text.upload(Re,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(Re,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=Fd(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(Re,Le){const Oe=this.lineVertexArray.length;if(void 0!==Re.segment)for(const{x:Re,y:Oe}of Le)this.lineVertexArray.emplaceBack(Re,Oe);return{lineStartIndex:Oe,lineLength:this.lineVertexArray.length-Oe}}addSymbols(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr,Ln,Nn,$n,Gn,qn,Zn){const Xn=Re.indexArray,Yn=Re.layoutVertexArray,_i=Re.globeExtVertexArray,vi=Re.segments.prepareSegment(4*Le.length,Yn,Xn,this.canOverlap?Ct.sortKey:void 0),xi=this.glyphOffsetArray.length,bi=vi.vertexLength,Pi=this.allowVerticalPlacement&&Ot===j_.vertical?Math.PI/2:0,lo=Ct.text&&Ct.text.sections;for(let Ue=0;Ue<Le.length;Ue++){const{tl:qe,tr:Ot,bl:Jr,br:Ln,texPrimary:Nn,texSecondary:xi,pixelOffsetTL:bi,pixelOffsetBR:uo,minFontScaleX:po,minFontScaleY:fo,glyphOffset:Io,isSDF:is,sectionIndex:as}=Le[Ue],Is=vi.vertexLength,Xs=Io[1];if(jd(Yn,Hr.x,Hr.y,qe.x,Xs+qe.y,Nn.x,Nn.y,Oe,is,bi.x,bi.y,po,fo),jd(Yn,Hr.x,Hr.y,Ot.x,Xs+Ot.y,Nn.x+Nn.w,Nn.y,Oe,is,uo.x,bi.y,po,fo),jd(Yn,Hr.x,Hr.y,Jr.x,Xs+Jr.y,Nn.x,Nn.y+Nn.h,Oe,is,bi.x,uo.y,po,fo),jd(Yn,Hr.x,Hr.y,Ln.x,Xs+Ln.y,Nn.x+Nn.w,Nn.y+Nn.h,Oe,is,uo.x,uo.y,po,fo),Jt){const{x:Le,y:Oe,z:Ue}=Jt.anchor,[qe,Ct,Ot]=Jt.up;qd(_i,Le,Oe,Ue,qe,Ct,Ot),qd(_i,Le,Oe,Ue,qe,Ct,Ot),qd(_i,Le,Oe,Ue,qe,Ct,Ot),qd(_i,Le,Oe,Ue,qe,Ct,Ot),$d(Re.dynamicLayoutVertexArray,Le,Oe,Ue,Pi)}else $d(Re.dynamicLayoutVertexArray,Hr.x,Hr.y,Hr.z,Pi);if(Zn){const Le=xi||Nn;Nd(Re.iconTransitioningVertexArray,Le.x,Le.y),Nd(Re.iconTransitioningVertexArray,Le.x+Le.w,Le.y),Nd(Re.iconTransitioningVertexArray,Le.x,Le.y+Le.h),Nd(Re.iconTransitioningVertexArray,Le.x+Le.w,Le.y+Le.h)}Xn.emplaceBack(Is,Is+1,Is+2),Xn.emplaceBack(Is+1,Is+2,Is+3),vi.vertexLength+=4,vi.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Io[0]),Ue!==Le.length-1&&as===Le[Ue+1].sectionIndex||Re.programConfigurations.populatePaintArrays(Yn.length,Ct,Ct.index,{},$n,Gn,qn,lo&&lo[as])}const uo=Jt?Jt.anchor:Hr;Re.placedSymbolArray.emplaceBack(uo.x,uo.y,uo.z,Hr.x,Hr.y,xi,this.glyphOffsetArray.length-xi,bi,Jr,Ln,Hr.segment,Oe?Oe[0]:0,Oe?Oe[1]:0,Ue[0],Ue[1],Ot,0,!1,0,Nn,0)}_commitLayoutVertex(Re,Le,Oe,Ue,qe,Ct,Ot){Re.emplaceBack(Le,Oe,Ue,qe,Ct,Math.round(Ot.x),Math.round(Ot.y))}_addCollisionDebugVertices(Re,Le,Oe,Ue,qe,Ct,Ot){const Jt=Oe.segments.prepareSegment(4,Oe.layoutVertexArray,Oe.indexArray),Hr=Jt.vertexLength,Jr=Ot.tileAnchorX,Ln=Ot.tileAnchorY;for(let Re=0;Re<4;Re++)Oe.collisionVertexArray.emplaceBack(0,0,0,0,0,0);this._commitDebugCollisionVertexUpdate(Oe.collisionVertexArrayExt,Le,Re.padding,Ot.zOffset),this._commitLayoutVertex(Oe.layoutVertexArray,Ue,qe,Ct,Jr,Ln,new Is(Re.x1,Re.y1)),this._commitLayoutVertex(Oe.layoutVertexArray,Ue,qe,Ct,Jr,Ln,new Is(Re.x2,Re.y1)),this._commitLayoutVertex(Oe.layoutVertexArray,Ue,qe,Ct,Jr,Ln,new Is(Re.x2,Re.y2)),this._commitLayoutVertex(Oe.layoutVertexArray,Ue,qe,Ct,Jr,Ln,new Is(Re.x1,Re.y2)),Jt.vertexLength+=4;const Nn=Oe.indexArray;Nn.emplaceBack(Hr,Hr+1),Nn.emplaceBack(Hr+1,Hr+2),Nn.emplaceBack(Hr+2,Hr+3),Nn.emplaceBack(Hr+3,Hr),Jt.primitiveLength+=4}_addTextDebugCollisionBoxes(Re,Le,Oe,Ue,qe,Ct){for(let Ot=Ue;Ot<qe;Ot++){const Ue=Oe.get(Ot),qe=this.getSymbolInstanceTextSize(Re,Ct,Le,Ot);this._addCollisionDebugVertices(Ue,qe,this.textCollisionBox,Ue.projectedAnchorX,Ue.projectedAnchorY,Ue.projectedAnchorZ,Ct)}}_addIconDebugCollisionBoxes(Re,Le,Oe,Ue,qe,Ct){for(let Ot=Ue;Ot<qe;Ot++){const Ue=Oe.get(Ot),qe=this.getSymbolInstanceIconSize(Re,Le,Ct.placedIconSymbolIndex);this._addCollisionDebugVertices(Ue,qe,this.iconCollisionBox,Ue.projectedAnchorX,Ue.projectedAnchorY,Ue.projectedAnchorZ,Ct)}}generateCollisionDebugBuffers(Re,Le){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Yd(Va,A_.members,Ea),this.iconCollisionBox=new Yd(Va,A_.members,Ea);const Oe=Zp(this.iconSizeData,Re),Ue=Zp(this.textSizeData,Re);for(let qe=0;qe<this.symbolInstances.length;qe++){const Ct=this.symbolInstances.get(qe);this._addTextDebugCollisionBoxes(Ue,Re,Le,Ct.textBoxStartIndex,Ct.textBoxEndIndex,Ct),this._addTextDebugCollisionBoxes(Ue,Re,Le,Ct.verticalTextBoxStartIndex,Ct.verticalTextBoxEndIndex,Ct),this._addIconDebugCollisionBoxes(Oe,Re,Le,Ct.iconBoxStartIndex,Ct.iconBoxEndIndex,Ct),this._addIconDebugCollisionBoxes(Oe,Re,Le,Ct.verticalIconBoxStartIndex,Ct.verticalIconBoxEndIndex,Ct)}}getSymbolInstanceTextSize(Re,Le,Oe,Ue){const qe=this.text.placedSymbolArray.get(Le.rightJustifiedTextSymbolIndex>=0?Le.rightJustifiedTextSymbolIndex:Le.centerJustifiedTextSymbolIndex>=0?Le.centerJustifiedTextSymbolIndex:Le.leftJustifiedTextSymbolIndex>=0?Le.leftJustifiedTextSymbolIndex:Le.verticalPlacedTextSymbolIndex>=0?Le.verticalPlacedTextSymbolIndex:Ue),Ct=Yp(this.textSizeData,Re,qe)/k_;return this.tilePixelRatio*Ct}getSymbolInstanceIconSize(Re,Le,Oe){const Ue=this.icon.placedSymbolArray.get(Oe),qe=Yp(this.iconSizeData,Re,Ue);return this.tilePixelRatio*qe}_commitDebugCollisionVertexUpdate(Re,Le,Oe,Ue){Re.emplaceBack(Le,-Oe,-Oe,Ue),Re.emplaceBack(Le,Oe,-Oe,Ue),Re.emplaceBack(Le,Oe,Oe,Ue),Re.emplaceBack(Le,-Oe,Oe,Ue)}_updateTextDebugCollisionBoxes(Re,Le,Oe,Ue,qe,Ct){for(let Ot=Ue;Ot<qe;Ot++){const Ue=Oe.get(Ot),qe=this.getSymbolInstanceTextSize(Re,Ct,Le,Ot);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,qe,Ue.padding,Ct.zOffset)}}_updateIconDebugCollisionBoxes(Re,Le,Oe,Ue,qe,Ct){for(let Ot=Ue;Ot<qe;Ot++){const Ue=Oe.get(Ot),qe=this.getSymbolInstanceIconSize(Re,Le,Ct.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,qe,Ue.padding,Ct.zOffset)}}updateCollisionDebugBuffers(Re,Le){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const Oe=Zp(this.iconSizeData,Re),Ue=Zp(this.textSizeData,Re);for(let qe=0;qe<this.symbolInstances.length;qe++){const Ct=this.symbolInstances.get(qe);this._updateTextDebugCollisionBoxes(Ue,Re,Le,Ct.textBoxStartIndex,Ct.textBoxEndIndex,Ct),this._updateTextDebugCollisionBoxes(Ue,Re,Le,Ct.verticalTextBoxStartIndex,Ct.verticalTextBoxEndIndex,Ct),this._updateIconDebugCollisionBoxes(Oe,Re,Le,Ct.iconBoxStartIndex,Ct.iconBoxEndIndex,Ct),this._updateIconDebugCollisionBoxes(Oe,Re,Le,Ct.verticalIconBoxStartIndex,Ct.verticalIconBoxEndIndex,Ct)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr){const Jr={};if(Le<Oe){const{x1:Oe,y1:Ue,x2:qe,y2:Ct,padding:Ot,projectedAnchorX:Jt,projectedAnchorY:Hr,projectedAnchorZ:Ln,tileAnchorX:Nn,tileAnchorY:$n,featureIndex:Gn}=Re.get(Le);Jr.textBox={x1:Oe,y1:Ue,x2:qe,y2:Ct,padding:Ot,projectedAnchorX:Jt,projectedAnchorY:Hr,projectedAnchorZ:Ln,tileAnchorX:Nn,tileAnchorY:$n},Jr.textFeatureIndex=Gn}if(Ue<qe){const{x1:Le,y1:Oe,x2:qe,y2:Ct,padding:Ot,projectedAnchorX:Jt,projectedAnchorY:Hr,projectedAnchorZ:Ln,tileAnchorX:Nn,tileAnchorY:$n,featureIndex:Gn}=Re.get(Ue);Jr.verticalTextBox={x1:Le,y1:Oe,x2:qe,y2:Ct,padding:Ot,projectedAnchorX:Jt,projectedAnchorY:Hr,projectedAnchorZ:Ln,tileAnchorX:Nn,tileAnchorY:$n},Jr.verticalTextFeatureIndex=Gn}if(Ct<Ot){const{x1:Le,y1:Oe,x2:Ue,y2:qe,padding:Ot,projectedAnchorX:Jt,projectedAnchorY:Hr,projectedAnchorZ:Ln,tileAnchorX:Nn,tileAnchorY:$n,featureIndex:Gn}=Re.get(Ct);Jr.iconBox={x1:Le,y1:Oe,x2:Ue,y2:qe,padding:Ot,projectedAnchorX:Jt,projectedAnchorY:Hr,projectedAnchorZ:Ln,tileAnchorX:Nn,tileAnchorY:$n},Jr.iconFeatureIndex=Gn}if(Jt<Hr){const{x1:Le,y1:Oe,x2:Ue,y2:qe,padding:Ct,projectedAnchorX:Ot,projectedAnchorY:Hr,projectedAnchorZ:Ln,tileAnchorX:Nn,tileAnchorY:$n,featureIndex:Gn}=Re.get(Jt);Jr.verticalIconBox={x1:Le,y1:Oe,x2:Ue,y2:qe,padding:Ct,projectedAnchorX:Ot,projectedAnchorY:Hr,projectedAnchorZ:Ln,tileAnchorX:Nn,tileAnchorY:$n},Jr.verticalIconFeatureIndex=Gn}return Jr}deserializeCollisionBoxes(Re){this.collisionArrays=[];for(let Le=0;Le<this.symbolInstances.length;Le++){const Oe=this.symbolInstances.get(Le);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(Re,Oe.textBoxStartIndex,Oe.textBoxEndIndex,Oe.verticalTextBoxStartIndex,Oe.verticalTextBoxEndIndex,Oe.iconBoxStartIndex,Oe.iconBoxEndIndex,Oe.verticalIconBoxStartIndex,Oe.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(Re,Le){const Oe=Re.placedSymbolArray.get(Le),Ue=Oe.vertexStartIndex+4*Oe.numGlyphs;for(let Le=Oe.vertexStartIndex;Le<Ue;Le+=4)Re.indexArray.emplaceBack(Le,Le+1,Le+2),Re.indexArray.emplaceBack(Le+1,Le+2,Le+3)}getSortedSymbolIndexes(Re){if(this.sortedAngle===Re&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const Le=Math.sin(Re),Oe=Math.cos(Re),Ue=[],qe=[],Ct=[];for(let Re=0;Re<this.symbolInstances.length;++Re){Ct.push(Re);const Ot=this.symbolInstances.get(Re);Ue.push(0|Math.round(Le*Ot.tileAnchorX+Oe*Ot.tileAnchorY)),qe.push(Ot.featureIndex)}return Ct.sort(((Re,Le)=>Ue[Re]-Ue[Le]||qe[Le]-qe[Re])),Ct}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let Re=0;Re<this.symbolInstances.length;++Re)this.symbolInstanceIndexesSortedZOffset.push(Re)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort(((Re,Le)=>this.symbolInstances.get(Le).zOffset-this.symbolInstances.get(Re).zOffset))}addToSortKeyRanges(Re,Le){const Oe=this.sortKeyRanges[this.sortKeyRanges.length-1];Oe&&Oe.sortKey===Le?Oe.symbolInstanceEnd=Re+1:this.sortKeyRanges.push({sortKey:Le,symbolInstanceStart:Re,symbolInstanceEnd:Re+1})}sortFeatures(Re){if(this.sortFeaturesByY&&this.sortedAngle!==Re&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(Re),this.sortedAngle=Re,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const Re of this.symbolInstanceIndexes){const Le=this.symbolInstances.get(Re);this.featureSortOrder.push(Le.featureIndex);const{rightJustifiedTextSymbolIndex:Oe,centerJustifiedTextSymbolIndex:Ue,leftJustifiedTextSymbolIndex:qe,verticalPlacedTextSymbolIndex:Ct,placedIconSymbolIndex:Ot,verticalPlacedIconSymbolIndex:Jt}=Le;Oe>=0&&this.addIndicesForPlacedSymbol(this.text,Oe),Ue>=0&&Ue!==Oe&&this.addIndicesForPlacedSymbol(this.text,Ue),qe>=0&&qe!==Ue&&qe!==Oe&&this.addIndicesForPlacedSymbol(this.text,qe),Ct>=0&&this.addIndicesForPlacedSymbol(this.text,Ct),Ot>=0&&this.addIndicesForPlacedSymbol(this.icon,Ot),Jt>=0&&this.addIndicesForPlacedSymbol(this.icon,Jt)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Xy,Yy,Ky;os(Zd,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),Zd.addDynamicAttributes=$d;class Jd{constructor(Re){this.type=Re.property.overrides?Re.property.overrides.runtimeType:eh,this.defaultValue=Re}evaluate(Re){if(Re.formattedSection){const Le=this.defaultValue.property.overrides;if(Le&&Le.hasOverride(Re.formattedSection))return Le.getOverride(Re.formattedSection)}return Re.feature&&Re.featureState?this.defaultValue.evaluate(Re.feature,Re.featureState):this.defaultValue.property.specification.default}eachChild(Re){this.defaultValue.isConstant()||Re(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}os(Jd,"FormatSectionOverride",{omit:["defaultValue"]});const Qd=()=>Ky||(Ky={layout:Xy||(Xy=new Gs({"symbol-placement":new Ns(Fp.layout_symbol["symbol-placement"]),"symbol-spacing":new Ns(Fp.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ns(Fp.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new qs(Fp.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ns(Fp.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new Ns(Fp.layout_symbol["symbol-z-elevate"]),"icon-allow-overlap":new Ns(Fp.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Ns(Fp.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ns(Fp.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ns(Fp.layout_symbol["icon-rotation-alignment"]),"icon-size":new qs(Fp.layout_symbol["icon-size"]),"icon-text-fit":new qs(Fp.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new qs(Fp.layout_symbol["icon-text-fit-padding"]),"icon-image":new qs(Fp.layout_symbol["icon-image"]),"icon-rotate":new qs(Fp.layout_symbol["icon-rotate"]),"icon-padding":new Ns(Fp.layout_symbol["icon-padding"]),"icon-keep-upright":new Ns(Fp.layout_symbol["icon-keep-upright"]),"icon-offset":new qs(Fp.layout_symbol["icon-offset"]),"icon-anchor":new qs(Fp.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ns(Fp.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ns(Fp.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ns(Fp.layout_symbol["text-rotation-alignment"]),"text-field":new qs(Fp.layout_symbol["text-field"]),"text-font":new qs(Fp.layout_symbol["text-font"]),"text-size":new qs(Fp.layout_symbol["text-size"]),"text-max-width":new qs(Fp.layout_symbol["text-max-width"]),"text-line-height":new qs(Fp.layout_symbol["text-line-height"]),"text-letter-spacing":new qs(Fp.layout_symbol["text-letter-spacing"]),"text-justify":new qs(Fp.layout_symbol["text-justify"]),"text-radial-offset":new qs(Fp.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ns(Fp.layout_symbol["text-variable-anchor"]),"text-anchor":new qs(Fp.layout_symbol["text-anchor"]),"text-max-angle":new Ns(Fp.layout_symbol["text-max-angle"]),"text-writing-mode":new Ns(Fp.layout_symbol["text-writing-mode"]),"text-rotate":new qs(Fp.layout_symbol["text-rotate"]),"text-padding":new Ns(Fp.layout_symbol["text-padding"]),"text-keep-upright":new Ns(Fp.layout_symbol["text-keep-upright"]),"text-transform":new qs(Fp.layout_symbol["text-transform"]),"text-offset":new qs(Fp.layout_symbol["text-offset"]),"text-allow-overlap":new Ns(Fp.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Ns(Fp.layout_symbol["text-ignore-placement"]),"text-optional":new Ns(Fp.layout_symbol["text-optional"]),visibility:new Ns(Fp.layout_symbol.visibility)})),paint:Yy||(Yy=new Gs({"icon-opacity":new qs(Fp.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new qs(Fp.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new qs(Fp.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new qs(Fp.paint_symbol["text-emissive-strength"]),"icon-color":new qs(Fp.paint_symbol["icon-color"]),"icon-halo-color":new qs(Fp.paint_symbol["icon-halo-color"]),"icon-halo-width":new qs(Fp.paint_symbol["icon-halo-width"]),"icon-halo-blur":new qs(Fp.paint_symbol["icon-halo-blur"]),"icon-translate":new Ns(Fp.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ns(Fp.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new qs(Fp.paint_symbol["icon-image-cross-fade"]),"text-opacity":new qs(Fp.paint_symbol["text-opacity"]),"text-occlusion-opacity":new qs(Fp.paint_symbol["text-occlusion-opacity"]),"text-color":new qs(Fp.paint_symbol["text-color"],{runtimeType:ih,getOverride:Re=>Re.textColor,hasOverride:Re=>!!Re.textColor}),"text-halo-color":new qs(Fp.paint_symbol["text-halo-color"]),"text-halo-width":new qs(Fp.paint_symbol["text-halo-width"]),"text-halo-blur":new qs(Fp.paint_symbol["text-halo-blur"]),"text-translate":new Ns(Fp.paint_symbol["text-translate"]),"text-translate-anchor":new Ns(Fp.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new Ns(Fp.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new Ns(Fp.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new Ns(Fp.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new Ns(Fp.paint_symbol["icon-color-brightness-max"]),"symbol-z-offset":new qs(Fp.paint_symbol["symbol-z-offset"]),"symbol-elevation-reference":new Ns(Fp.paint_symbol["symbol-elevation-reference"])}))},Ky);class tm extends pa{constructor(Re,Le,Oe,Ue){super(Re,Qd(),Le,Oe,Ue),this._colorAdjustmentMatrix=Io.mat4.identity([]),this.hasInitialOcclusionOpacityProperties=void 0!==Re.paint&&("icon-occlusion-opacity"in Re.paint||"text-occlusion-opacity"in Re.paint)}recalculate(Re,Le){super.recalculate(Re,Le),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const Oe=this.layout.get("text-writing-mode");if(Oe){const Re=[];for(const Le of Oe)Re.indexOf(Le)<0&&Re.push(Le);this.layout._values["text-writing-mode"]=Re}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(Re,Le,Oe,Ue){return this._saturation===Re&&this._contrast===Le&&this._brightnessMin===Oe&&this._brightnessMax===Ue||(this._colorAdjustmentMatrix=function(Re,Le,Oe,Ue){Re=St(Re),Le=At(Le);const qe=Io.mat4.create(),Ct=Re/3,Ot=1-2*Ct,Jt=[Ot,Ct,Ct,0,Ct,Ot,Ct,0,Ct,Ct,Ot,0,0,0,0,1],Hr=.5-.5*Le,Jr=Ue-Oe;return Io.mat4.multiply(qe,[Jr,0,0,0,0,Jr,0,0,0,0,Jr,0,Oe,Oe,Oe,1],[Le,0,0,0,0,Le,0,0,0,0,Le,0,Hr,Hr,Hr,1]),Io.mat4.multiply(qe,qe,Jt),qe}(Re,Le,Oe,Ue),this._saturation=Re,this._contrast=Le,this._brightnessMin=Oe,this._brightnessMax=Ue),this._colorAdjustmentMatrix}getValueAndResolveTokens(Re,Le,Oe,Ue){const qe=this.layout.get(Re).evaluate(Le,{},Oe,Ue),Ct=this._unevaluatedLayout._values[Re];return Ct.isDataDriven()||Wi(Ct.value)||!qe?qe:function(Re,Le){return Le.replace(/{([^{}]+)}/g,((Le,Oe)=>Oe in Re?String(Re[Oe]):""))}(Le.properties,qe)}createBucket(Re){return new Zd(Re)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const Re of Qd().paint.overridableProperties){if(!tm.hasPaintOverride(this.layout,Re))continue;const Le=this.paint.get(Re),Oe=new Jd(Le),Ue=new Zi(Oe,Le.property.specification,this.scope,this.options);let qe=null;qe="constant"===Le.value.kind||"source"===Le.value.kind?new Ki("source",Ue):new Ji("composite",Ue,Le.value.zoomStops,Le.value._interpolationType),this.paint._values[Re]=new Us(Le.property,qe,Le.parameters)}}_handleOverridablePaintPropertyUpdate(Re,Le,Oe){return!(!this.layout||Le.isDataDriven()||Oe.isDataDriven())&&tm.hasPaintOverride(this.layout,Re)}static hasPaintOverride(Re,Le){const Oe=Re.get("text-field"),Ue=Qd().paint.properties[Le];let qe=!1;const s=Re=>{for(const Le of Re)if(Ue.overrides&&Ue.overrides.hasOverride(Le))return void(qe=!0)};if("constant"===Oe.value.kind&&Oe.value.value instanceof Qe)s(Oe.value.value.sections);else if("source"===Oe.value.kind){const t=Re=>{qe||(Re instanceof sr&&nr(Re.value)===yh?s(Re.value.sections):Re instanceof ur?s(Re.sections):Re.eachChild(t))},Re=Oe.value;Re._styleExpression&&t(Re._styleExpression.expression)}return qe}getProgramIds(){return["symbol"]}getDefaultProgramParams(Re,Le,Oe){return{config:new Lo(this,{zoom:Le,lut:Oe}),overrideFog:!1}}}let Jy,Qy,ev,tv;var rv=ya([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);function am(Re){switch(Re){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.RGBA;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.DEPTH_COMPONENT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.DEPTH_STENCIL;case WebGL2RenderingContext.R8:case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.RED}}function om(Re){switch(Re){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.UNSIGNED_SHORT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.UNSIGNED_INT_24_8;case WebGL2RenderingContext.R8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.FLOAT}}class lm{constructor(Re,Le,Oe,Ue){this.context=Re,this.format=Oe,this.useMipmap=Ue&&Ue.useMipmap,this.texture=Re.gl.createTexture(),this.update(Le,{premultiply:Ue&&Ue.premultiply})}update(Re,Le){const Oe=Re&&Re instanceof HTMLVideoElement&&0===Re.width?Re.videoWidth:Re.width,Ue=Re&&Re instanceof HTMLVideoElement&&0===Re.height?Re.videoHeight:Re.height,{context:qe}=this,{gl:Ct}=qe,{x:Ot,y:Jt}=Le&&Le.position?Le.position:{x:0,y:0},Hr=Math.max(Ot+Oe,this.size?this.size[0]:0),Jr=Math.max(Jt+Ue,this.size?this.size[1]:0);!this.size||this.size[0]===Hr&&this.size[1]===Jr||(Ct.bindTexture(Ct.TEXTURE_2D,null),Ct.deleteTexture(this.texture),this.texture=Ct.createTexture(),this.size=null),Ct.bindTexture(Ct.TEXTURE_2D,this.texture),qe.pixelStoreUnpackFlipY.set(!1),qe.pixelStoreUnpack.set(1),qe.pixelStoreUnpackPremultiplyAlpha.set(this.format===Ct.RGBA8&&(!Le||!1!==Le.premultiply));const Ln=Re instanceof HTMLImageElement||Re instanceof HTMLCanvasElement||Re instanceof HTMLVideoElement||Re instanceof ImageData||ImageBitmap&&Re instanceof ImageBitmap;if(!this.size&&Hr>0&&Jr>0){const Re=this.useMipmap?Math.floor(Math.log2(Math.max(Hr,Jr)))+1:1;Ct.texStorage2D(Ct.TEXTURE_2D,Re,this.format,Hr,Jr),this.size=[Hr,Jr]}if(this.size)if(Ln)Ct.texSubImage2D(Ct.TEXTURE_2D,0,Ot,Jt,am(this.format),om(this.format),Re);else{const Le=Re.data;Le&&Ct.texSubImage2D(Ct.TEXTURE_2D,0,Ot,Jt,Oe,Ue,am(this.format),om(this.format),Le)}this.useMipmap&&Ct.generateMipmap(Ct.TEXTURE_2D)}bind(Re,Le,Oe=!1){const{context:Ue}=this,{gl:qe}=Ue;qe.bindTexture(qe.TEXTURE_2D,this.texture),Re!==this.minFilter&&(qe.texParameteri(qe.TEXTURE_2D,qe.TEXTURE_MAG_FILTER,Re),qe.texParameteri(qe.TEXTURE_2D,qe.TEXTURE_MIN_FILTER,this.useMipmap&&!Oe?Re===qe.NEAREST?qe.NEAREST_MIPMAP_NEAREST:qe.LINEAR_MIPMAP_LINEAR:Re),this.minFilter=Re),Le!==this.wrapS&&(qe.texParameteri(qe.TEXTURE_2D,qe.TEXTURE_WRAP_S,Le),qe.texParameteri(qe.TEXTURE_2D,qe.TEXTURE_WRAP_T,Le),this.wrapS=Le)}bindExtraParam(Re,Le,Oe,Ue){const{context:qe}=this,{gl:Ct}=qe;Ct.bindTexture(Ct.TEXTURE_2D,this.texture),Le!==this.magFilter&&(Ct.texParameteri(Ct.TEXTURE_2D,Ct.TEXTURE_MAG_FILTER,Le),this.magFilter=Le),Re!==this.minFilter&&(Ct.texParameteri(Ct.TEXTURE_2D,Ct.TEXTURE_MIN_FILTER,this.useMipmap?Re===Ct.NEAREST?Ct.NEAREST_MIPMAP_NEAREST:Ct.LINEAR_MIPMAP_LINEAR:Re),this.minFilter=Re),Oe!==this.wrapS&&(Ct.texParameteri(Ct.TEXTURE_2D,Ct.TEXTURE_WRAP_S,Oe),this.wrapS=Oe),Ue!==this.wrapT&&(Ct.texParameteri(Ct.TEXTURE_2D,Ct.TEXTURE_WRAP_T,Ue),this.wrapT=Ue)}destroy(){const{gl:Re}=this.context;Re.deleteTexture(this.texture),this.texture=null}}class um{constructor(Re,Le){this.context=Re,this.texture=Le}bind(Re,Le){const{context:Oe}=this,{gl:Ue}=Oe;Ue.bindTexture(Ue.TEXTURE_2D,this.texture),Re!==this.minFilter&&(Ue.texParameteri(Ue.TEXTURE_2D,Ue.TEXTURE_MAG_FILTER,Re),Ue.texParameteri(Ue.TEXTURE_2D,Ue.TEXTURE_MIN_FILTER,Re),this.minFilter=Re),Le!==this.wrapS&&(Ue.texParameteri(Ue.TEXTURE_2D,Ue.TEXTURE_WRAP_S,Le),Ue.texParameteri(Ue.TEXTURE_2D,Ue.TEXTURE_WRAP_T,Le),this.wrapS=Le)}}function cm(Re,Le,Oe,Ue,qe,Ct,Ot,Jt){const Hr=[Re,Le,1,Oe,Ue,1,qe,Ct,1],Jr=[Ot,Jt,1],Ln=Io.mat3.adjoint([],Hr),[Nn,$n,Gn]=Io.vec3.transformMat3(Jr,Jr,Ln);return Io.mat3.multiply(Hr,Hr,[Nn,0,0,0,$n,0,0,0,Gn])}function hm(Re,Le,Oe,Ue,qe,Ct,Ot,Jt){const Hr=function(Re,Le,Oe,Ue,qe,Ct,Ot,Jt){const Hr=cm(0,0,1,0,1,1,0,1),Jr=cm(Re,Le,Oe,Ue,qe,Ct,Ot,Jt),Ln=Io.mat3.adjoint([],Hr);return Io.mat3.multiply(Jr,Jr,Ln)}(Re,Le,Oe,Ue,qe,Ct,Ot,Jt);return[Hr[2]/Hr[8]/id,Hr[5]/Hr[8]/id]}function pm(Re){return[Re[0],Math.min(Math.max(Re[1],-im),im)]}class fm extends Me{constructor(Re,Le,Oe,Ue){super(),this.id=Re,this.dispatcher=Oe,this.coordinates=Le.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(Ue),this.options=Le,this._dirty=!1}load(Re,Le){if(this._loaded=Le||!1,this.fire(new be("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return Re&&(this.coordinates=Re),this._loaded=!0,void this._finishLoading();this._imageRequest=ce(this.map._requestManager.transformRequest(this.url,iu.Image),((Le,Oe)=>{this._imageRequest=null,this._loaded=!0,Le?this.fire(new ve(Le)):Oe&&(this.image=Oe instanceof HTMLImageElement?oc.getImageData(Oe):Oe,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,Re&&(this.coordinates=Re),this._finishLoading())}))}loaded(){return this._loaded}updateImage(Re){return Re.url?(this._imageRequest&&Re.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=Re.url,this.load(Re.coordinates,this._loaded),this):this}setTexture(Re){if(!(Re.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new um(this.map.painter.context,Re.handle),this.width=Re.dimensions[0],this.height=Re.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new be("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(Re){this.map=Re,this.load()}onRemove(Re){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof um||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(Re){if(this.coordinates=Re,this._boundsArray=void 0,this._unsupportedCoords=!1,!Re.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let Le=Re[0][1],Oe=Re[0][1];for(const Ue of Re)Ue[1]>Oe&&(Oe=Ue[1]),Ue[1]<Le&&(Le=Ue[1]);const Ue=(Oe+Le)/2;if(Ue>im?this.onNorthPole=!0:Ue<-im&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const Le=Re.map(xl.fromLngLat);this.tileID=function(Re){let Le=1/0,Oe=1/0,Ue=-1/0,qe=-1/0;for(const Ct of Re)Le=Math.min(Le,Ct.x),Oe=Math.min(Oe,Ct.y),Ue=Math.max(Ue,Ct.x),qe=Math.max(qe,Ct.y);const Ct=Math.max(Ue-Le,qe-Oe),Ot=Math.max(0,Math.floor(-Math.log(Ct)/Math.LN2)),Jt=Math.pow(2,Ot);let Hr=Math.floor((Le+Ue)/2*Jt);return Hr>1&&(Hr-=1),new tu(Ot,Hr,Math.floor((Oe+qe)/2*Jt))}(Le),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new be("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(Re){for(const Re in this.tiles){const Le=this.tiles[Re];"loaded"!==Le.state&&(Le.state="loaded",Le.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const Le=yd(new tu(0,0,0),this.map.transform.projection),Oe=[Le.projection.project(this.coordinates[0][0],this.coordinates[0][1]),Le.projection.project(this.coordinates[1][0],this.coordinates[1][1]),Le.projection.project(this.coordinates[2][0],this.coordinates[2][1]),Le.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(Re){const Le=Re[1].x-Re[0].x,Oe=Re[1].y-Re[0].y,Ue=Re[2].x-Re[1].x,qe=Re[2].y-Re[1].y,Ct=Re[3].x-Re[2].x,Ot=Re[3].y-Re[2].y,Jt=Re[0].x-Re[3].x,Hr=Re[0].y-Re[3].y,Jr=Le*qe-Ue*Oe,Ln=Ue*Ot-Ct*qe,Nn=Ct*Hr-Jt*Ot,$n=Jt*Oe-Le*Hr;return Jr>0&&Ln>0&&Nn>0&&$n>0||Jr<0&&Ln<0&&Nn<0&&$n<0}(Oe))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const Ue=yd(this.tileID,this.map.transform.projection),[qe,Ct,Ot,Jt]=this.coordinates.map((Re=>{const Le=Ue.projection.project(Re[0],Re[1]);return gd(Ue,Le)._round()}));this.perspectiveTransform=hm(qe.x,qe.y,Ct.x,Ct.y,Ot.x,Ot.y,Jt.x,Jt.y);const Hr=this._boundsArray=new va;Hr.emplaceBack(qe.x,qe.y,0,0),Hr.emplaceBack(Ct.x,Ct.y,id,0),Hr.emplaceBack(Jt.x,Jt.y,0,id),Hr.emplaceBack(Ot.x,Ot.y,id,id),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=Re.createVertexBuffer(Hr,rv.members),this.boundsSegments=co.simpleSegment(0,0,4,2);const Jr=[],Ln=[pm((Nn=this.coordinates)[0]),pm(Nn[1]),pm(Nn[2]),pm(Nn[3])];var Nn;const[$n,Gn,qn,Zn]=function(Re){let Le=Re[0][0],Oe=Le,Ue=Re[0][1],qe=Ue;for(let Ct=1;Ct<Re.length;Ct++)Re[Ct][0]<Le?Le=Re[Ct][0]:Re[Ct][0]>Oe&&(Oe=Re[Ct][0]),Re[Ct][1]<Ue?Ue=Re[Ct][1]:Re[Ct][1]>qe&&(qe=Re[Ct][1]);return[Le,Ue,Oe-Le,qe-Ue]}(Ln);{const Ue=new va,[qe,Ct,Ot,Jt]=function(Re){let Le=Re[0].x,Oe=Le,Ue=Re[0].y,qe=Ue;for(let Ct=1;Ct<Re.length;Ct++)Re[Ct].x<Le?Le=Re[Ct].x:Re[Ct].x>Oe&&(Oe=Re[Ct].x),Re[Ct].y<Ue?Ue=Re[Ct].y:Re[Ct].y>qe&&(qe=Re[Ct].y);return[Le,Ue,Oe-Le,qe-Ue]}(Oe),l=Re=>[(Re.x-qe)/Ot,(Re.y-Ct)/Jt],[Hr,Ln,Nn,Xn]=Oe.map(l),Yn=function(Re,Le,Oe,Ue,qe,Ct,Ot,Jt){const Hr=cm(0,0,1,0,1,1,0,1),Jr=cm(Re,Le,Oe,Ue,qe,Ct,Ot,Jt),Ln=Io.mat3.adjoint([],Jr);return Io.mat3.multiply(Hr,Hr,Ln)}(Hr[0],Hr[1],Ln[0],Ln[1],Nn[0],Nn[1],Xn[0],Xn[1]);this.elevatedGlobePerspectiveTransform=hm(Hr[0],Hr[1],Ln[0],Ln[1],Nn[0],Nn[1],Xn[0],Xn[1]);const b=(Re,Le)=>{Jr.push(Re.lng);const Oe=Math.round((Re.lng-$n)/qn*id),qe=Math.round((Re.lat-Gn)/Zn*id),Ct=l(Le),Ot=Io.vec3.transformMat3([],[Ct[0],Ct[1],1],Yn),Jt=Math.round(Ot[0]/Ot[2]*id),Hr=Math.round(Ot[1]/Ot[2]*id);Ue.emplaceBack(Oe,qe,Jt,Hr)},_i=Oe[3].x-Oe[0].x,vi=Oe[3].y-Oe[0].y,xi=Oe[2].x-Oe[1].x,bi=Oe[2].y-Oe[1].y;for(let Re=0;Re<65;Re++){const Ue=Re/64,qe=[Oe[0].x+Ue*_i,Oe[0].y+Ue*vi],Ct=[Oe[1].x+Ue*xi,Oe[1].y+Ue*bi],Ot=Ct[0]-qe[0],Jt=Ct[1]-qe[1];for(let Re=0;Re<65;Re++){const Oe=Re/64,Ue={x:qe[0]+Ot*Oe,y:qe[1]+Jt*Oe,z:0};b(Le.projection.unproject(Ue.x,Ue.y),Ue)}}this.elevatedGlobeVertexBuffer=Re.createVertexBuffer(Ue,rv.members)}{this.maxLongitudeTriangleSize=0;let Le=[],Oe=new Da;const n=(Re,Ue,qe)=>{Oe.emplaceBack(Re,Ue,qe);const Ct=Jr[Re],Ot=Jr[Ue],Jt=Jr[qe],Hr=Math.min(Math.min(Ct,Ot),Jt),Ln=Math.max(Math.max(Ct,Ot),Jt)-Hr;Ln>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=Ln),Le.push(Hr+Ln/2)};for(let Re=0;Re<64;Re++)for(let Le=0;Le<64;Le++){const Oe=65*Re+Le,Ue=Oe+1,qe=Oe+65,Ct=qe+1;n(Oe,qe,Ue),n(Ue,qe,Ct)}[Le,Oe]=function(Re,Le){const Oe=Array.from({length:Re.length},((Re,Le)=>Le));Oe.sort(((Le,Oe)=>Re[Le]-Re[Oe]));const Ue=[],qe=new Da;for(let Ct=0;Ct<Oe.length;Ct++){const Ot=Oe[Ct];Ue.push(Re[Ot]);const Jt=3*Ot,Hr=Jt+1;qe.emplaceBack(Le.uint16[Jt],Le.uint16[Hr],Le.uint16[Hr+1])}return[Ue,qe]}(Le,Oe),this.elevatedGlobeTrianglesCenterLongitudes=Le,this.elevatedGlobeIndexBuffer=Re.createIndexBuffer(Oe)}this.elevatedGlobeSegments=co.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,qn/id,0,Zn/id,0,0,Gn,$n,0])}prepare(){const Re=0!==Object.keys(this.tiles).length;if(this.tileID&&!Re)return;const Le=this.map.painter.context,Oe=Le.gl;!this._dirty||this.texture instanceof um||(this.texture?this.texture.update(this.image):(this.texture=new lm(Le,this.image,Oe.RGBA8),this.texture.bind(Oe.LINEAR,Oe.CLAMP_TO_EDGE)),this._dirty=!1),Re&&this._prepareData(Le)}loadTile(Re,Le){this.tileID&&this.tileID.equals(Re.tileID.canonical)?(this.tiles[String(Re.tileID.wrap)]=Re,Re.buckets={},Le(null)):(Re.state="errored",Le(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(Re){const Le=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!Le)return null;const Oe=this.elevatedGlobeTrianglesCenterLongitudes;let Ue=(qe=Re+180)+360*Math.round((Oe[0]-qe)/360);var qe;const Ct=new co,a=(Re,Oe)=>{Ct.segments.push({vertexOffset:0,primitiveOffset:Re,vertexLength:Le.segments[0].vertexLength,primitiveLength:Oe,sortKey:void 0,vaos:{}})},Ot=.51*this.maxLongitudeTriangleSize;if(Math.abs(Oe[0]-Ue)<=Ot){const Re=Mt(Oe,0,Oe.length,Ue+Ot);return Re===Oe.length||a(Re,_t(Oe,Re+1,Oe.length,Ue+360-Ot)-Re),Ct}Ue<Oe[0]&&(Ue+=360);const Jt=_t(Oe,0,Oe.length,Ue-Ot);if(Jt===Oe.length)return a(0,Oe.length),Ct;a(0,Jt-0);const Hr=Mt(Oe,Jt+1,Oe.length,Ue+Ot);return Hr!==Oe.length&&a(Hr,Oe.length-Hr),Ct}}const nv=(Math.pow(256,2)-1)/16907520;class mm extends pa{constructor(Re,Le,Oe,Ue){super(Re,{layout:ev||(ev=new Gs({visibility:new Ns(Fp.layout_raster.visibility)})),paint:tv||(tv=new Gs({"raster-opacity":new Ns(Fp.paint_raster["raster-opacity"]),"raster-color":new $s(Fp.paint_raster["raster-color"]),"raster-color-mix":new Ns(Fp.paint_raster["raster-color-mix"]),"raster-color-range":new Ns(Fp.paint_raster["raster-color-range"]),"raster-hue-rotate":new Ns(Fp.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ns(Fp.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ns(Fp.paint_raster["raster-brightness-max"]),"raster-saturation":new Ns(Fp.paint_raster["raster-saturation"]),"raster-contrast":new Ns(Fp.paint_raster["raster-contrast"]),"raster-resampling":new Ns(Fp.paint_raster["raster-resampling"]),"raster-fade-duration":new Ns(Fp.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new Ns(Fp.paint_raster["raster-emissive-strength"]),"raster-array-band":new Ns(Fp.paint_raster["raster-array-band"]),"raster-elevation":new Ns(Fp.paint_raster["raster-elevation"])}))},Le,Oe,Ue),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(Re){return!(Re&&Re._source instanceof fm&&(Re._source.onNorthPole||Re._source.onSouthPole))&&0===this.paint.get("raster-elevation")}_handleSpecialPaintPropertyUpdate(Re){"raster-color"!==Re&&"raster-color-range"!==Re||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}updateColorRamp(Re){if(!this.hasColorMap())return;if(!this._curRampRange)return;const Le=this._transitionablePaint._values["raster-color"].value.expression,[Oe,Ue]=Re||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(Oe)&&isNaN(Ue)||Oe===this._curRampRange[0]&&Ue===this._curRampRange[1]||(this.colorRamp=ac({expression:Le,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:Oe,end:Ue}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[Oe,Ue])}}let iv,ov,sv,av,lv;class wm extends pa{constructor(Re,Le,Oe,Ue){super(Re,{layout:iv||(iv=new Gs({visibility:new Ns(Fp["layout_raster-particle"].visibility)})),paint:ov||(ov=new Gs({"raster-particle-array-band":new Ns(Fp["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new Ns(Fp["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new $s(Fp["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new Ns(Fp["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new Ns(Fp["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new Ns(Fp["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new Ns(Fp["paint_raster-particle"]["raster-particle-reset-rate-factor"]),"raster-particle-elevation":new Ns(Fp["paint_raster-particle"]["raster-particle-elevation"])}))},Le,Oe,Ue),this._updateColorRamp(),this.lastInvalidatedAt=oc.now()}onRemove(Re){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return"none"!==this.visibility}isDraped(Re){return!1}_handleSpecialPaintPropertyUpdate(Re){"raster-particle-color"!==Re&&"raster-particle-max-speed"!==Re||(this._updateColorRamp(),this._invalidateAnimationState()),"raster-particle-count"===Re&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const Re=this._transitionablePaint._values["raster-particle-color"].value.expression,Le=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=ac({expression:Re,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:Le}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=oc.now()}tileCoverLift(){return this.paint.get("raster-particle-elevation")}}class _m extends pa{constructor(Re,Le){super(Re,{},Le,null),this.implementation=Re,Re.slot&&(this.slot=Re.slot)}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}isDraped(Re){return void 0!==this.implementation.renderToTile}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(Re){this.implementation.onAdd&&this.implementation.onAdd(Re,Re.painter.context.gl)}onRemove(Re){this.implementation.onRemove&&this.implementation.onRemove(Re,Re.painter.context.gl)}}function Mm(Re,Le,Oe){const Ue=[0,0,1],qe=Io.quat.identity([]);return Io.quat.rotateY(qe,qe,Oe?-Y(Re)+Math.PI:Y(Re)),Io.quat.rotateX(qe,qe,-Y(Le)),Io.vec3.transformQuat(Ue,Ue,qe),Io.vec3.normalize(Ue,Ue)}function Am(Re,Le){const Oe=Im(Re.projection,Re.zoom,Re.width,Re.height),Ue=function(Re,Le,Oe,Ue,qe){const Ct=new rl(Oe.lng-180*cv,Oe.lat),Ot=new rl(Oe.lng+180*cv,Oe.lat),Jt=Re.project(Ct.lng,Ct.lat),Hr=Re.project(Ot.lng,Ot.lat),Jr=-Math.atan2(Hr.y-Jt.y,Hr.x-Jt.x),Ln=xl.fromLngLat(Oe);Ln.y=Q(Ln.y,-1+cv,1-cv);const Nn=Ln.toLngLat(),$n=Re.project(Nn.lng,Nn.lat),Gn=xl.fromLngLat(Nn);Gn.x+=cv;const qn=Gn.toLngLat(),Zn=Re.project(qn.lng,qn.lat),Xn=km(Zn.x-$n.x,Zn.y-$n.y,Jr),Yn=xl.fromLngLat(Nn);Yn.y+=cv;const _i=Yn.toLngLat(),vi=Re.project(_i.lng,_i.lat),xi=km(vi.x-$n.x,vi.y-$n.y,Jr),bi=Math.abs(Xn.x)/Math.abs(xi.y),Pi=Io.mat4.identity([]);Io.mat4.rotateZ(Pi,Pi,-Jr*(1-(qe?0:Ue)));const lo=Io.mat4.identity([]);return Io.mat4.scale(lo,lo,[1,1-(1-bi)*Ue,1]),lo[4]=-xi.x/xi.y*Ue,Io.mat4.rotateZ(lo,lo,Jr),Io.mat4.multiply(lo,Pi,lo),lo}(Re.projection,0,Re.center,Oe,Le),qe=Sm(Re);return Io.mat4.scale(Ue,Ue,[qe,qe,1]),Ue}function Sm(Re){const Le=Re.projection,Oe=Im(Re.projection,Re.zoom,Re.width,Re.height),Ue=zm(Le,Re.center),qe=zm(Le,rl.convert(Le.center));return Math.pow(2,Ue*Oe+(1-Oe)*qe)}function Im(Re,Le,Oe,Ue,qe=1/0){const Ct=Re.range;if(!Ct)return 0;const Ot=Math.min(qe,Math.max(Oe,Ue)),Jt=Math.log(Ot/1024)/Math.LN2;return tt(Ct[0]+Jt,Ct[1]+Jt,Le)}const cv=1/4e4;function zm(Re,Le){const Oe=Q(Le.lat,-im,im),Ue=new rl(Le.lng-180*cv,Oe),qe=new rl(Le.lng+180*cv,Oe),Ct=Re.project(Ue.lng,Oe),Ot=Re.project(qe.lng,Oe),Jt=xl.fromLngLat(Ue),Hr=xl.fromLngLat(qe),Jr=Ot.x-Ct.x,Ln=Ot.y-Ct.y,Nn=Hr.x-Jt.x,$n=Hr.y-Jt.y,Gn=Math.sqrt((Nn*Nn+$n*$n)/(Jr*Jr+Ln*Ln));return Math.log(Gn)/Math.LN2}function km(Re,Le,Oe){const Ue=Math.cos(Oe),qe=Math.sin(Oe);return{x:Re*Ue-Le*qe,y:Re*qe+Le*Ue}}function Tm(Re,Le,Oe){Io.mat4.identity(Re),Io.mat4.rotateZ(Re,Re,Y(Le[2])),Io.mat4.rotateX(Re,Re,Y(Le[0])),Io.mat4.rotateY(Re,Re,Y(Le[1])),Io.mat4.scale(Re,Re,Oe),Io.mat4.multiply(Re,Re,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function Em(Re,Le,Oe,Ue,qe,Ct,Ot,Jt){const Hr=[Oe[0]-Le[0],Oe[1]-Le[1],0],Jr=[Ue[0]-Le[0],Ue[1]-Le[1],0];if(Io.vec3.length(Hr)<1e-12||Io.vec3.length(Jr)<1e-12)return Io.quat.identity(Re);const Ln=Io.vec3.cross([],Hr,Jr);Io.vec3.normalize(Ln,Ln),Io.vec3.subtract(Jr,Ue,Le),Hr[2]=(Ct-qe)*Jt,Jr[2]=(Ot-qe)*Jt;const Nn=Hr;return Io.vec3.cross(Nn,Hr,Jr),Io.vec3.normalize(Nn,Nn),Io.quat.rotationTo(Re,Ln,Nn)}function Bm(Re,Le,Oe=!1){const Ue=Du(Le.zoom),qe=function(Re,Le,Oe){const Ue=Le.worldSize,qe=[Re[12],Re[13],Re[14]],Ct=hl(qe[1]/Ue),Ot=cl(qe[0]/Ue),Jt=Io.mat4.identity([]),Hr=ul(1,Ct)*Ue,Jr=ul(1,0)*Ue*ml(Ct,Le.zoom),Ln=1/Vu(Ue);let Nn=Jr*Ln;if(Oe){const Re=Im(Le.projection,Le.zoom,Le.width,Le.height,1024);Nn=Ln*Le.projection.pixelSpaceConversion(Le.center.lat,Ue,Re)}const $n=Qo(Ct,Ot);Io.vec3.add($n,$n,Io.vec3.scale([],Io.vec3.normalize([],$n),Hr*Nn*qe[2]));const Gn=function(Re){const Le=[Re[0],Re[1],Re[2]];let Oe=[0,1,0];const Ue=Io.vec3.cross([],Oe,Le);return Io.vec3.cross(Oe,Le,Ue),0===Io.vec3.squaredLength(Oe)&&(Oe=[0,1,0],Io.vec3.cross(Ue,Le,Oe)),Io.vec3.normalize(Ue,Ue),Io.vec3.normalize(Oe,Oe),Io.vec3.normalize(Le,Le),[Ue[0],Ue[1],Ue[2],0,Oe[0],Oe[1],Oe[2],0,Le[0],Le[1],Le[2],0,Re[0],Re[1],Re[2],1]}($n);Io.mat4.scale(Jt,Jt,[Nn,Nn,Nn*Hr]),Io.mat4.translate(Jt,Jt,[-qe[0],-qe[1],-qe[2]]);const qn=Io.mat4.multiply([],Le.globeMatrix,Gn);return Io.mat4.multiply(qn,qn,Jt),Io.mat4.multiply(qn,qn,Re),qn}(Re,Le,Oe);if(Ue>0){const Oe=function(Re,Le){const Oe=Le.worldSize,Ue=ul(1,0)*Oe*ml(Le.center.lat,Le.zoom)/Vu(Oe),qe=ul(1,Le.center.lat)*Oe,Ct=Io.mat4.identity([]);return Io.mat4.rotateY(Ct,Ct,Y(Le.center.lng)),Io.mat4.rotateX(Ct,Ct,Y(Le.center.lat)),Io.mat4.translate(Ct,Ct,[0,0,pf]),Io.mat4.scale(Ct,Ct,[Ue,Ue,Ue*qe]),Io.mat4.translate(Ct,Ct,[Le.point.x-.5*Oe,Le.point.y-.5*Oe,0]),Io.mat4.multiply(Ct,Ct,Re),Io.mat4.multiply(Ct,Le.globeMatrix,Ct)}(Re,Le);return function(Re,Le,Oe){const n=(Re,Le,Oe)=>{const Ue=Io.vec3.length(Re),qe=Io.vec3.length(Le),Ct=Mu(Re,Le,Oe);return Io.vec3.scale(Ct,Ct,1/Io.vec3.length(Ct)*ke(Ue,qe,Oe))},Ue=n([Re[0],Re[1],Re[2]],[Le[0],Le[1],Le[2]],Oe),qe=n([Re[4],Re[5],Re[6]],[Le[4],Le[5],Le[6]],Oe),Ct=n([Re[8],Re[9],Re[10]],[Le[8],Le[9],Le[10]],Oe),Ot=Mu([Re[12],Re[13],Re[14]],[Le[12],Le[13],Le[14]],Oe);return[Ue[0],Ue[1],Ue[2],0,qe[0],qe[1],qe[2],0,Ct[0],Ct[1],Ct[2],0,Ot[0],Ot[1],Ot[2],1]}(qe,Oe,Ue)}return qe}function Vm(Re,Le,Oe,Ue){const qe=yu.projectAabbCorners(Ue,Oe);let Ct=Number.MAX_VALUE,Ot=-1;for(let Re=0;Re<qe.length;++Re){const Oe=qe[Re];Oe[0]=(.5*Oe[0]+.5)*Le.width,Oe[1]=(.5-.5*Oe[1])*Le.height,Oe[2]<Ct&&(Ot=Re,Ct=Oe[2])}const o=Re=>new Is(qe[Re][0],qe[Re][1]);let Jt;switch(Ot){case 0:case 6:Jt=[o(1),o(5),o(4),o(7),o(3),o(2),o(1)];break;case 1:case 7:Jt=[o(0),o(4),o(5),o(6),o(2),o(3),o(0)];break;case 3:case 5:Jt=[o(1),o(0),o(4),o(7),o(6),o(2),o(1)];break;default:Jt=[o(1),o(5),o(6),o(7),o(3),o(0),o(1)]}if(El(Re,Jt))return Ct}const uv=ya([{name:"a_pos_3f",components:3,type:"Float32"}]),hv=ya([{name:"a_color_3f",components:3,type:"Float32"}]),dv=ya([{name:"a_color_4f",components:4,type:"Float32"}]),pv=ya([{name:"a_uv_2f",components:2,type:"Float32"}]),fv=ya([{name:"a_normal_3f",components:3,type:"Float32"}]),mv=ya([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),gv=ya([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]),_v={None:0,Model:1,Symbol:2,FillExtrusion:4,All:7};class Nm{constructor(Re,Le,Oe,Ue){this.message=(Re?`${Re}: `:"")+Oe,Ue&&(this.identifier=Ue),null!=Le&&Le.__line__&&(this.line=Le.__line__)}}function qm(Re,Le){const Oe=-1===Re.indexOf("://");try{return new URL(Re,Oe&&Le?"http://example.com":void 0),!0}catch(Re){return!1}}class $m{constructor(Re,Le){this.feature=Re,this.instancedDataOffset=Le,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class Gm{constructor(){this.instancedDataArray=new Ga,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class Xm{constructor(Re){this.zoom=Re.zoom,this.canonical=Re.canonical,this.layers=Re.layers,this.layerIds=this.layers.map((Re=>Re.fqid)),this.projection=Re.projection,this.index=Re.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter((Re=>Re.isStateDependent())).map((Re=>Re.id)),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0}updateFootprints(Re,Le){}populate(Re,Le,Oe,Ue){this.tileToMeter=gl(Oe);const qe=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:Ct,id:Ot,index:Jt,sourceLayerIndex:Hr}of Re){const Re=null!=Ot?Ot:Ct.properties&&Ct.properties.hasOwnProperty("id")?Ct.properties.id:void 0,Jr=Pl(Ct,qe);if(!this.layers[0]._featureFilter.filter(new Vs(this.zoom),Jr,Oe))continue;const Ln={id:Re,sourceLayerIndex:Hr,index:Jt,geometry:qe?Jr.geometry:Il(Ct,Oe,Ue),properties:Ct.properties,type:Ct.type,patterns:{}},Nn=this.addFeature(Ln,Ln.geometry,Jr);Nn&&Le.featureIndex.insert(Ct,Ln.geometry,Jt,Hr,this.index,this.instancesPerModel[Nn].instancedDataArray.length,id/32)}this.lookup=null}update(Re,Le,Oe,Ue){for(const Le in this.instancesPerModel){const Oe=this.instancesPerModel[Le];for(const Le in Re)Oe.idToFeaturesIndex.hasOwnProperty(Le)&&(this.evaluate(Oe.features[Oe.idToFeaturesIndex[Le]],Re[Le],Oe,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let Re=!1;for(const Le in this.instancesPerModel){const Oe=this.instancesPerModel[Le];for(const Le of Oe.features){const Ue=this.layers[0],qe=Le.feature,Ct=this.canonical,Ot=Ue.paint.get("model-rotation").evaluate(qe,{},Ct),Jt=Ue.paint.get("model-scale").evaluate(qe,{},Ct),Hr=Ue.paint.get("model-translation").evaluate(qe,{},Ct);Io.vec3.exactEquals(Le.rotation,Ot)&&Io.vec3.exactEquals(Le.scale,Jt)&&Io.vec3.exactEquals(Le.translation,Hr)||(this.evaluate(Le,Le.featureStates,Oe,!0),Re=!0)}}return Re}updateReplacement(Re,Le,Oe,Ue){if(Le.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=Le.updateTime;const qe=Le.getReplacementRegionsForTile(Re.toUnwrapped(),!0);if(wh(this.activeReplacements,qe))return!1;this.activeReplacements=qe;let Ct=!1;for(const Le in this.instancesPerModel){const qe=this.instancesPerModel[Le],Ot=qe.instancedDataArray;for(const Le of qe.features){const qe=Le.instancedDataOffset,Jt=Le.instancedDataCount;for(let Le=0;Le<Jt;Le++){const Jt=16*(Le+qe);let Hr=Ot.float32[Jt+0];const Jr=Hr>id;Hr=Jr?Hr-id:Hr;const Ln=Math.floor(Hr),Nn=Ot.float32[Jt+1];let $n=!1;for(const Le of this.activeReplacements)if(!gh(Le,Oe,_v.Model,Ue)&&!(Le.min.x>Ln||Ln>Le.max.x||Le.min.y>Nn||Nn>Le.max.y)&&($n=Ph(Ih(Ln,Nn,Re.canonical,Le.footprintTileId.canonical),Le.footprint),$n))break;Ot.float32[Jt]=$n?Hr+id:Hr,Ct=Ct||$n!==Jr}}}return Ct}isEmpty(){for(const Re in this.instancesPerModel)if(0!==this.instancesPerModel[Re].instancedDataArray.length)return!1;return!0}uploadPending(){return!this.uploaded}upload(Re){if(!this.uploaded)for(const Le in this.instancesPerModel){const Oe=this.instancesPerModel[Le];Oe.instancedDataArray.length<0||0===Oe.instancedDataArray.length||(Oe.instancedDataBuffer?Oe.instancedDataBuffer.updateData(Oe.instancedDataArray):Oe.instancedDataBuffer=Re.createVertexBuffer(Oe.instancedDataArray,mv.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const Re in this.instancesPerModel){const Le=this.instancesPerModel[Re];0!==Le.instancedDataArray.length&&Le.instancedDataBuffer&&Le.instancedDataBuffer.destroy()}const Re=this.layers[0].modelManager;if(Re&&this.modelUris)for(const Le of this.modelUris)Re.removeModel(Le,"")}addFeature(Re,Le,Oe){const Ue=this.layers[0],qe=Ue.layout.get("model-id").evaluate(Oe,{},this.canonical);if(!qe)return ft(`modelId is not evaluated for layer ${Ue.id} and it is not going to get rendered.`),qe;qm(qe,!1)&&(this.modelUris.includes(qe)||this.modelUris.push(qe)),this.instancesPerModel[qe]||(this.instancesPerModel[qe]=new Gm);const Ct=this.instancesPerModel[qe],Ot=Ct.instancedDataArray,Jt=new $m(Oe,Ot.length);for(const Re of Le)for(const Le of Re){if(Le.x<0||Le.x>=id||Le.y<0||Le.y>=id)continue;const Re=(this.lookupDim-1)/id,Oe=this.lookupDim*(Le.y*Re|0)+Le.x*Re|0;if(this.lookup){if(0!==this.lookup[Oe])continue;this.lookup[Oe]=1}this.instanceCount++;const Ue=Ot.length;Ot.resize(Ue+1),Ct.instancesEvaluatedElevation.push(0),Ot.float32[16*Ue]=Le.x,Ot.float32[16*Ue+1]=Le.y}return Jt.instancedDataCount=Ct.instancedDataArray.length-Jt.instancedDataOffset,Jt.instancedDataCount>0&&(Re.id&&(Ct.idToFeaturesIndex[Re.id]=Ct.features.length),Ct.features.push(Jt),this.evaluate(Jt,{},Ct,!1)),qe}getModelUris(){return this.modelUris}evaluate(Re,Le,Oe,Ue){const qe=this.layers[0],Ct=Re.feature,Ot=this.canonical,Jt=Re.rotation=qe.paint.get("model-rotation").evaluate(Ct,Le,Ot),Hr=Re.scale=qe.paint.get("model-scale").evaluate(Ct,Le,Ot),Jr=Re.translation=qe.paint.get("model-translation").evaluate(Ct,Le,Ot),Ln=qe.paint.get("model-color").evaluate(Ct,Le,Ot);Ln.a=qe.paint.get("model-color-mix-intensity").evaluate(Ct,Le,Ot);const Nn=[];this.maxVerticalOffset<Jr[2]&&(this.maxVerticalOffset=Jr[2]),this.maxScale=Math.max(Math.max(this.maxScale,Hr[0]),Math.max(Hr[1],Hr[2])),Tm(Nn,Jt,Hr);const $n=Math.round(100*Ln.a)+Ln.b/1.05;for(let Le=0;Le<Re.instancedDataCount;++Le){const qe=Re.instancedDataOffset+Le,Ct=16*qe,Jt=Oe.instancedDataArray.float32;let Hr=0;Ue&&(Hr=Jt[Ct+6]-Oe.instancesEvaluatedElevation[qe]);const Gn=0|Jt[Ct+1];Jt[Ct]=(0|Jt[Ct])+Ln.r/1.05,Jt[Ct+1]=Gn+Ln.g/1.05,Jt[Ct+2]=$n,Jt[Ct+3]=1/(Ot.z>10?this.tileToMeter:gl(Ot,Gn)),Jt[Ct+4]=Jr[0],Jt[Ct+5]=Jr[1],Jt[Ct+6]=Jr[2]+Hr,Jt[Ct+7]=Nn[0],Jt[Ct+8]=Nn[1],Jt[Ct+9]=Nn[2],Jt[Ct+10]=Nn[4],Jt[Ct+11]=Nn[5],Jt[Ct+12]=Nn[6],Jt[Ct+13]=Nn[8],Jt[Ct+14]=Nn[9],Jt[Ct+15]=Nn[10],Oe.instancesEvaluatedElevation[qe]=Jr[2]}}}let yv,vv;os(Xm,"ModelBucket",{omit:["layers"]}),os(Gm,"PerModelAttributes"),os($m,"ModelFeature");const xv=64,bv={CoordinateSpaceTile:1,CoordinateSpaceYUp:2,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function Km(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr=!1){const Ln=Oe.zoom,Nn=Oe.project(Ue),$n=ml(Ue.lat,Ln),Gn=1/$n;Io.mat4.identity(Re),Io.mat4.translate(Re,Re,[Nn.x+Ot[0]*Gn,Nn.y+Ot[1]*Gn,Ot[2]]);let qn=1,Zn=1;const Xn=Oe.worldSize;if(Jr){if("mercator"===Oe.projection.name){let Re=0;Oe.elevation&&(Re=Oe.elevation.getAtPointOrZero(new xl(Nn.x/Xn,Nn.y/Xn),0));const Le=Io.vec4.transformMat4([],[Nn.x,Nn.y,Re,1],Oe.projMatrix)[3]/Oe.cameraToCenterDistance;qn=Le,Zn=Le*ml(Oe.center.lat,Ln)}else if("globe"===Oe.projection.name){const Le=Bm(Re,Oe),qe=Io.mat4.multiply([],Oe.projMatrix,Le),Ct=[0,0,0,1];Io.vec4.transformMat4(Ct,Ct,qe);const Ot=Ct[3]/Oe.cameraToCenterDistance,Jt=Du(Ln),Hr=Oe.projection.pixelsPerMeter(Ue.lat,Xn)*ml(Ue.lat,Ln),Jr=Oe.projection.pixelsPerMeter(Oe.center.lat,Xn)*ml(Oe.center.lat,Ln);qn=Ot/ke(Hr,dl(Oe.center.lat),Jt),Zn=Ot*$n/Hr,qn*=Jr,Zn*=Jr}}else qn=Gn;Io.mat4.scale(Re,Re,[qn,qn,Zn]);const Yn=[...Re],_i=Le.orientation,vi=[];if(Tm(vi,[_i[0]+qe[0],_i[1]+qe[1],_i[2]+qe[2]],Ct),Io.mat4.multiply(Re,Yn,vi),Jt&&Oe.elevation){let qe=0;const Ct=[];if(Hr&&Oe.elevation){qe=function(Re,Le,Oe,Ue,qe){const Ct=Le.elevation;if(!Ct)return 0;const Ot=yu.projectAabbCorners(Oe,Ue),Jt=ul(1,qe.lat)*Le.worldSize,Hr=function(Re,Le){const Oe=[0,0,1],Ue=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const qe of Ue){const Ue=Re[qe.corners[0]],Ct=Re[qe.corners[1]],Ot=Re[qe.corners[2]],Jt=[Ct[0]-Ue[0],Ct[1]-Ue[1],Le*(Ct[2]-Ue[2])],Hr=Io.vec3.cross(Jt,Jt,[Ot[0]-Ue[0],Ot[1]-Ue[1],Le*(Ot[2]-Ue[2])]);Io.vec3.normalize(Hr,Hr),qe.dotProductWithUp=Io.vec3.dot(Hr,Oe)}return Ue.sort(((Re,Le)=>Re.dotProductWithUp-Le.dotProductWithUp)),Ue[0].corners}(Ot,Jt),Jr=Ot[Hr[0]],Ln=Ot[Hr[1]],Nn=Ot[Hr[2]],$n=Ot[Hr[3]],Gn=Ct.getAtPointOrZero(new xl(Jr[0]/Le.worldSize,Jr[1]/Le.worldSize),0),qn=Ct.getAtPointOrZero(new xl(Ln[0]/Le.worldSize,Ln[1]/Le.worldSize),0),Zn=Ct.getAtPointOrZero(new xl(Nn[0]/Le.worldSize,Nn[1]/Le.worldSize),0),Xn=Ct.getAtPointOrZero(new xl($n[0]/Le.worldSize,$n[1]/Le.worldSize),0),Yn=(Gn+Xn)/2,_i=(qn+Zn)/2;return Yn>_i?qn<Zn?Em(Re,Ln,$n,Jr,qn,Xn,Gn,Jt):Em(Re,Nn,Jr,$n,Zn,Gn,Xn,Jt):Gn<Xn?Em(Re,Jr,Ln,Nn,Gn,qn,Zn,Jt):Em(Re,$n,Nn,Ln,Xn,Zn,qn,Jt),Math.max(Yn,_i)}(Ct,Oe,Le.aabb,Re,Ue);const Ot=Io.mat4.fromQuat([],Ct),Jt=Io.mat4.multiply([],Ot,vi);Io.mat4.multiply(Re,Yn,Jt)}else qe=Oe.elevation.getAtPointOrZero(new xl(Nn.x/Xn,Nn.y/Xn),0);0!==qe&&(Re[14]+=qe)}}function Jm(Re,Le,Oe=!1){Re.uploaded||(Re.gfxTexture=new lm(Le,Re.image,Oe?Le.gl.R8:Le.gl.RGBA8,{useMipmap:Re.sampler.minFilter>=Le.gl.NEAREST_MIPMAP_NEAREST}),Re.uploaded=!0,Re.image=null)}function Qm(Re,Le,Oe){Re.indexBuffer=Le.createIndexBuffer(Re.indexArray,!1,!0),Re.vertexBuffer=Le.createVertexBuffer(Re.vertexArray,uv.members,!1,!0),Re.normalArray&&(Re.normalBuffer=Le.createVertexBuffer(Re.normalArray,fv.members,!1,!0)),Re.texcoordArray&&(Re.texcoordBuffer=Le.createVertexBuffer(Re.texcoordArray,pv.members,!1,!0)),Re.colorArray&&(Re.colorBuffer=Le.createVertexBuffer(Re.colorArray,(12===Re.colorArray.bytesPerElement?hv:dv).members,!1,!0)),Re.featureArray&&(Re.pbrBuffer=Le.createVertexBuffer(Re.featureArray,gv.members,!0)),Re.segments=co.simpleSegment(0,0,Re.vertexArray.length,Re.indexArray.length);const Ue=Re.material;Ue.pbrMetallicRoughness.baseColorTexture&&Jm(Ue.pbrMetallicRoughness.baseColorTexture,Le),Ue.pbrMetallicRoughness.metallicRoughnessTexture&&Jm(Ue.pbrMetallicRoughness.metallicRoughnessTexture,Le),Ue.normalTexture&&Jm(Ue.normalTexture,Le),Ue.occlusionTexture&&Jm(Ue.occlusionTexture,Le,Oe),Ue.emissionTexture&&Jm(Ue.emissionTexture,Le)}function ty(Re,Le,Oe){if(Re.meshes)for(const Ue of Re.meshes)Qm(Ue,Le,Oe);if(Re.children)for(const Ue of Re.children)ty(Ue,Le,Oe)}function ey(Re){if(Re.meshes)for(const Le of Re.meshes)Le.indexArray.destroy(),Le.vertexArray.destroy(),Le.colorArray&&Le.colorArray.destroy(),Le.normalArray&&Le.normalArray.destroy(),Le.texcoordArray&&Le.texcoordArray.destroy(),Le.featureArray&&Le.featureArray.destroy();if(Re.children)for(const Le of Re.children)ey(Le)}function ry(Re){if(Re.meshes)for(const Oe of Re.meshes)Oe.vertexBuffer&&(Oe.vertexBuffer.destroy(),Oe.indexBuffer.destroy(),Oe.normalBuffer&&Oe.normalBuffer.destroy(),Oe.texcoordBuffer&&Oe.texcoordBuffer.destroy(),Oe.colorBuffer&&Oe.colorBuffer.destroy(),Oe.pbrBuffer&&Oe.pbrBuffer.destroy(),Oe.segments.destroy(),Oe.material&&((Le=Oe.material).pbrMetallicRoughness.baseColorTexture&&Le.pbrMetallicRoughness.baseColorTexture.gfxTexture&&Le.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),Le.pbrMetallicRoughness.metallicRoughnessTexture&&Le.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&Le.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),Le.normalTexture&&Le.normalTexture.gfxTexture&&Le.normalTexture.gfxTexture.destroy(),Le.emissionTexture&&Le.emissionTexture.gfxTexture&&Le.emissionTexture.gfxTexture.destroy(),Le.occlusionTexture&&Le.occlusionTexture.gfxTexture&&Le.occlusionTexture.gfxTexture.destroy()));var Le;if(Re.children)for(const Le of Re.children)ry(Le)}class ny{constructor(Re,Le,Oe){this._demTile=Re,this._dem=this._demTile.dem,this._scale=Le,this._offset=Oe}static create(Re,Le,Oe){const Ue=Oe||Re.findDEMTileFor(Le);if(!Ue||!Ue.dem)return;const qe=Ue.dem,Ct=Ue.tileID,Ot=1<<Le.canonical.z-Ct.canonical.z;return new ny(Ue,qe.dim/id/Ot,[(Le.canonical.x/Ot-Ct.canonical.x)*qe.dim,(Le.canonical.y/Ot-Ct.canonical.y)*qe.dim])}tileCoordToPixel(Re,Le){const Oe=Le*this._scale+this._offset[1],Ue=Math.floor(Re*this._scale+this._offset[0]),qe=Math.floor(Oe);return new Is(Ue,qe)}getElevationAt(Re,Le,Oe,Ue){const qe=Re*this._scale+this._offset[0],Ct=Le*this._scale+this._offset[1],Ot=Math.floor(qe),Jt=Math.floor(Ct),Hr=this._dem;return Ue=!!Ue,Oe?ke(ke(Hr.get(Ot,Jt,Ue),Hr.get(Ot,Jt+1,Ue),Ct-Jt),ke(Hr.get(Ot+1,Jt,Ue),Hr.get(Ot+1,Jt+1,Ue),Ct-Jt),qe-Ot):Hr.get(Ot,Jt,Ue)}getElevationAtPixel(Re,Le,Oe){return this._dem.get(Re,Le,!!Oe)}getMeterToDEM(Re){return(1<<this._demTile.tileID.canonical.z)*ul(1,Re)*this._dem.stride}}const wv=new Float32Array(262144),Tv=new Uint8Array(262144);function ay(Re){let Le=0;if(Re.meshes)for(const Oe of Re.meshes)Le=Math.max(Le,Oe.aabb.max[2]);if(Re.children)for(const Oe of Re.children)Le=Math.max(Le,ay(Oe));return Le}function oy(Re,Le,Oe){if(Re.meshes)for(const Ue of Re.meshes)Ue.aabb.min[0]!==1/0&&Oe.insert(Le,Ue.aabb.min[0],Ue.aabb.min[1],Ue.aabb.max[0],Ue.aabb.max[1]);if(Re.children)for(const Ue of Re.children)oy(Ue,Le,Oe)}const Sv=["","wall","door","roof","window","lamp","logo"];class uy{constructor(Re){this.node=Re,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.cameraCollisionOpacity=1,this.feature={type:"Point",id:Re.id,geometry:[],properties:{height:ay(Re)}},this.aabb=this._getLocalBounds()}_getLocalBounds(){if(!this.node.meshes)return new yu([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let Re=0;const Le=new yu([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const Oe of this.node.meshes)this.node.lightMeshIndex!==Re&&(Oe.transformedAabb=yu.applyTransformFast(Oe.aabb,this.node.matrix),Le.encapsulate(Oe.transformedAabb)),Re++;this.aabb=Le}return this.aabb}}class cy{constructor(Re,Le,Oe,Ue,qe,Ct){this.id=Le,this.modelTraits|=bv.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,Oe&&(this.modelTraits|=bv.HasMapboxMeshFeatures),Ue&&(this.modelTraits|=bv.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=qe,this.dirty=!0,this.needsUpload=!1,this.nodesInfo=[];for(const Le of Re)this.nodesInfo.push(new uy(Le)),oy(Le,Ct.featureIndexArray.length,Ct.grid),Ct.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,Ct.bucketLayerIDs.length-1,0)}updateFootprints(Re,Le){for(const Oe of this.getNodesInfo()){const Ue=Oe.node;Ue.footprint&&Le.push({footprint:Ue.footprint,id:Re})}}update(){console.log("Update 3D model bucket")}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(Re){if(!this.needsUpload)return;const Le=this.getNodesInfo();for(const Oe of Le){const Le=Oe.node;this.uploaded?this.updatePbrBuffer(Le):ty(Le,Re,!0)}for(const Re of Le)ey(Re.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(Re){let Le=!1;if(!Re.meshes)return Le;for(const Oe of Re.meshes)Oe.pbrBuffer&&(Oe.pbrBuffer.updateData(Oe.featureArray),Le=!0);return Le}needsReEvaluation(Re,Le,Oe){const Ue=Re.transform.projectionOptions,qe=Re.style.getBrightness(),Ct=this.brightness!==qe;return!!(!this.uploaded||this.dirty||Ue.name!==this.projection.name||hy(Oe.paint.get("model-color").value,Ct)||hy(Oe.paint.get("model-color-mix-intensity").value,Ct)||hy(Oe.paint.get("model-roughness").value,Ct)||hy(Oe.paint.get("model-emissive-strength").value,Ct)||hy(Oe.paint.get("model-height-based-emissive-strength-multiplier").value,Ct))&&(this.projection=Ue,this.brightness=qe,!0)}evaluateScale(Re,Le){if(Re.transform.zoom===this.zoom)return;this.zoom=Re.transform.zoom;const Oe=this.getNodesInfo(),Ue=this.id.canonical;for(const Re of Oe){const Oe=Re.feature;Re.evaluatedScale=Le.paint.get("model-scale").evaluate(Oe,{},Ue)}}evaluate(Re){const Le=this.getNodesInfo();for(const Oe of Le){if(!Oe.node.meshes)continue;const Le=Oe.feature,Ue=Oe.node.meshes&&Oe.node.meshes[0].featureData,qe=Oe.evaluatedColor[2],Ct=Oe.evaluatedRMEA[2],Ot=this.id.canonical;if(Oe.hasTranslucentParts=!1,Ue){for(let Ue=0;Ue<Sv.length;Ue++){const qe=Sv[Ue];qe.length&&(Le.properties.part=qe);const Ct=Re.paint.get("model-color").evaluate(Le,{},Ot).toRenderColor(null),Jt=Re.paint.get("model-color-mix-intensity").evaluate(Le,{},Ot);Oe.evaluatedColor[Ue]=[Ct.r,Ct.g,Ct.b,Jt],Oe.evaluatedRMEA[Ue][0]=Re.paint.get("model-roughness").evaluate(Le,{},Ot),Oe.evaluatedRMEA[Ue][2]=Re.paint.get("model-emissive-strength").evaluate(Le,{},Ot),Oe.evaluatedRMEA[Ue][3]=Ct.a,Oe.emissionHeightBasedParams[Ue]=Re.paint.get("model-height-based-emissive-strength-multiplier").evaluate(Le,{},Ot),!Oe.hasTranslucentParts&&Ct.a<1&&(Oe.hasTranslucentParts=!0)}delete Le.properties.part,fy(Oe,qe!==Oe.evaluatedColor[2]||Ct!==Oe.evaluatedRMEA[2],this.modelTraits)}else Oe.evaluatedRMEA[0][2]=Re.paint.get("model-emissive-strength").evaluate(Le,{},Ot);Oe.evaluatedScale=Re.paint.get("model-scale").evaluate(Le,{},Ot),this.updatePbrBuffer(Oe.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(Re,Le,Oe,Ue){const qe=Re.findDEMTileFor(Oe);if(qe&&(qe.tileID.canonical!==this.terrainTile||Le!==this.terrainExaggeration)){if(qe.dem&&qe.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=qe.tileID.overscaledZ;const Le=ny.create(Re,Oe,qe);if(!Le)return;this.modelTraits&bv.HasMapboxMeshFeatures&&this.updateDEM(Re,Le,Oe,Ue);for(const Re of this.getNodesInfo()){const Oe=Re.node;if(!Oe.footprint||!Oe.footprint.vertices||!Oe.footprint.vertices.length)continue;const Ue=Oe.footprint.vertices;let qe=Le.getElevationAt(Ue[0].x,Ue[0].y,!0,!0);for(let Re=1;Re<Ue.length;Re++)qe=Math.min(qe,Le.getElevationAt(Ue[Re].x,Ue[Re].y,!0,!0));Oe.elevation=qe}}this.terrainTile=qe.tileID.canonical,this.terrainExaggeration=Le}}updateDEM(Re,Le,Oe,Ue){let qe=Le._dem._modifiedForSources[Ue];if(void 0===qe&&(Le._dem._modifiedForSources[Ue]=[],qe=Le._dem._modifiedForSources[Ue]),qe.includes(Oe.canonical))return;const Ct=Le._dem.dim;qe.push(Oe.canonical);let Ot=!1;for(const Re of this.getNodesInfo()){const Oe=Re.node;if(!Oe.footprint||!Oe.footprint.grid)continue;const Ue=Oe.footprint.grid,qe=Le.tileCoordToPixel(Ue.min.x,Ue.min.y),Jt=Le.tileCoordToPixel(Ue.max.x,Ue.max.y),Hr=Math.min(Math.min(Ct-Jt.y,qe.x),Math.min(qe.y,Ct-Jt.x));if(Hr<0)continue;const Jr=Q(Hr,2,5);let Ln=Math.max(0,qe.x-Jr),Nn=Math.max(0,qe.y-Jr),$n=Math.min(Jt.x+Jr,Ct-1),Gn=Math.min(Jt.y+Jr,Ct-1);for(let Re=Nn;Re<=Gn;++Re)for(let Le=Ln;Le<=$n;++Le)Tv[Re*Ct+Le]=255;let qn=0,Zn=0;for(let Re=0;Re<Ue.cellsY;++Re)for(let Oe=0;Oe<Ue.cellsX;++Oe){if(!Ue.cells[Re*Ue.cellsX+Oe])continue;const qe=Le.tileCoordToPixel(Ue.min.x+Oe/Ue.xScale,Ue.min.y+Re/Ue.yScale),Ot=Le.tileCoordToPixel(Ue.min.x+(Oe+1)/Ue.xScale,Ue.min.y+(Re+1)/Ue.yScale);for(let Re=qe.y;Re<=Math.min(Ot.y+1,Ct-1);++Re)for(let Oe=qe.x;Oe<=Math.min(Ot.x+1,Ct-1);++Oe)255===Tv[Re*Ct+Oe]&&(Tv[Re*Ct+Oe]=0,qn+=Le.getElevationAtPixel(Oe,Re),Zn++)}const Xn=qn/Zn;Ln=Math.max(1,qe.x-Jr),Nn=Math.max(1,qe.y-Jr),$n=Math.min(Jt.x+Jr,Ct-2),Gn=Math.min(Jt.y+Jr,Ct-2),Ot=!0;for(let Re=Nn;Re<=Gn;++Re)for(let Oe=Ln;Oe<=$n;++Oe)0===Tv[Re*Ct+Oe]&&(wv[Re*Ct+Oe]=Le._dem.set(Oe,Re,Xn));for(let Re=1;Re<Jr;++Re){Ln=Math.max(1,qe.x-Re),Nn=Math.max(1,qe.y-Re),$n=Math.min(Jt.x+Re,Ct-2),Gn=Math.min(Jt.y+Re,Ct-2);for(let Oe=Nn;Oe<=Gn;++Oe)for(let Ue=Ln;Ue<=$n;++Ue){const qe=Oe*Ct+Ue;if(255===Tv[qe]){let Ot=0,Jt=0,Hr=-1,Ln=-1;for(let Le=-1;Le<=1;++Le)for(let qe=-1;qe<=1;++qe){const Jr=(Oe+Le)*Ct+Ue+qe;if(Tv[Jr]>=Re)continue;const Nn=wv[Jr],$n=Math.abs(Nn);$n>Jt&&(Ot=Nn,Jt=$n,Hr=qe,Ln=Le)}if(Jt>.1){const Ct=1-(Re+.5*Math.abs(Hr*Ln))/Jr;let Jt=Le._dem.get(Ue,Oe)+Ot*Ct;const Nn=Le._dem.get(Ue+Hr,Oe+Ln),$n=Le._dem.get(Ue-Hr,Oe-Ln,!0);(Jt-Nn)*(Jt-$n)>0&&(Jt=(Nn+$n)/2),wv[qe]=Le._dem.set(Ue,Oe,Jt),Tv[qe]=Re}}}}}Ot&&(Le._demTile.needsDEMTextureUpload=!0,Le._dem._timestamp=oc.now())}getNodesInfo(){return this.nodesInfo}destroy(){const Re=this.getNodesInfo();for(const Le of Re)ey(Le.node),ry(Le.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(Re,Le){if(Le.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=Le.updateTime;const Oe=Le.getReplacementRegionsForTile(Re.toUnwrapped()),Ue=this.getNodesInfo();for(let Re=0;Re<this.nodesInfo.length;Re++){const Le=Ue[Re].node;Ue[Re].hiddenByReplacement=!!Le.footprint&&!Oe.find((Re=>Re.footprint===Le.footprint))}}getHeightAtTileCoord(Re,Le){const Oe=this.getNodesInfo(),Ue=[],qe=[0,0,0],Ct=Io.mat4.identity([]);for(let Ot=0;Ot<this.nodesInfo.length;Ot++){const Jt=Oe[Ot],Hr=Jt.node.meshes[0],Jr=Hr.transformedAabb;if(Re<Jr.min[0]||Le<Jr.min[1]||Re>Jr.max[0]||Le>Jr.max[1])continue;if(!0===Jt.node.hidden)return{height:1/0,maxHeight:Jt.feature.properties.height,hidden:!1,verticalScale:Jt.evaluatedScale[2]};Io.mat4.invert(Ct,Jt.node.matrix),qe[0]=Re,qe[1]=Le,Io.vec3.transformMat4(qe,qe,Ct);const Ln=(qe[0]-Hr.aabb.min[0])/(Hr.aabb.max[0]-Hr.aabb.min[0])*xv|0,Nn=Math.min(63,(qe[1]-Hr.aabb.min[1])/(Hr.aabb.max[1]-Hr.aabb.min[1])*xv|0)*xv+Math.min(63,Ln),$n=Hr.heightmap[Nn];if(!($n<0&&Jt.node.footprint)){if(Jt.hiddenByReplacement)return;return{height:$n,maxHeight:Jt.feature.properties.height,hidden:!1,verticalScale:Jt.evaluatedScale[2]}}if(Jt.node.footprint.grid.query(new Is(Re,Le),new Is(Re,Le),Ue),Ue.length>0)return{height:void 0,maxHeight:Jt.feature.properties.height,hidden:Jt.hiddenByReplacement,verticalScale:Jt.evaluatedScale[2]}}}}function hy(Re,Le){return!Re.isLightConstant&&Le}function py(Re,Le,Oe,Ue,qe,Ct,Ot,Jt){let Hr=(61440&Le|(61440&Le)>>4)>>8,Jr=(3840&Le|(3840&Le)>>4)>>4,Ln=240&Le|(240&Le)>>4;Oe[3]>0&&(Hr=ke(Hr,255*Oe[0],Oe[3]),Jr=ke(Jr,255*Oe[1],Oe[3]),Ln=ke(Ln,255*Oe[2],Oe[3]));const Nn=Hr<<8|Jr,$n=Ln<<8|Math.floor(255*Ue[3]),Gn=function(Re){const Le=Q(Re,0,2);return Math.min(Math.round(.5*Le*255),255)}(Ue[2])<<8|15*Ue[0]<<4|15*Ue[1],qn=Q(qe[0],0,1),Zn=Q(qe[1],0,1),Xn=Q(qe[2],0,1),Yn=Q(qe[3],0,1);let _i,vi,xi,bi;if(qn!==Zn&&Ot!==Ct&&Zn!==qn){const Re=Ot-Ct;vi=1/(Re*(Zn-qn)),xi=-(Ct+Re*qn)/(Re*(Zn-qn));const Le=Q(qe[4],-1,1);bi=Math.pow(10,Le),_i=255*Xn<<8|255*Yn}else _i=65535,vi=0,xi=1,bi=1;if(Re.emplaceBack(Nn,$n,Gn,_i,vi,xi,bi),Jt){const Re=Jt.length;Jt.clear();for(let Le=0;Le<Re;Le++)Jt.emplaceBack(Nn,$n,Gn,_i,vi,xi,bi)}}function fy(Re,Le,Oe){const Ue=Re.node;let qe=0;const Ct=Oe&bv.HasMeshoptCompression;for(const Oe of Ue.meshes){if(Ue.lights&&Ue.lightMeshIndex===qe)continue;if(!Oe.featureData)continue;Oe.featureArray=new Xa,Oe.featureArray.reserve(Oe.featureData.length);let Ot=Le;for(const Le of Oe.featureData){const qe=Ct?65535&Le:Le>>16&65535,Jt=Ct?Le>>16&65535:65535&Le,Hr=(15&Jt)<8?15&Jt:0,Jr=Re.evaluatedRMEA[Hr],Ln=Re.evaluatedColor[Hr],Nn=Re.emissionHeightBasedParams[Hr];let $n;if(Ot&&2===Hr&&Ue.lights&&($n=new Xa,$n.resize(10*Ue.lights.length)),py(Oe.featureArray,qe,Ln,Jr,Nn,Oe.aabb.min[2],Oe.aabb.max[2],$n),$n&&Ot){Ot=!1;const Re=Ue.meshes[Ue.lightMeshIndex];Re.featureArray=$n,Re.featureArray._trim()}}Oe.featureArray._trim(),qe++}}function dy(Re,Le,Oe,Ue){const qe=1<<Re.z;Le.lat=hl((Ue/id+Re.y)/qe),Le.lng=cl((Oe/id+Re.x)/qe)}os(cy,"Tiled3dModelBucket",{omit:["layers"]}),os(uy,"Tiled3dModelFeature");const Ev={circle:class extends pa{constructor(Re,Le,Oe,Ue){super(Re,{layout:gm||(gm=new Gs({"circle-sort-key":new qs(Fp.layout_circle["circle-sort-key"]),visibility:new Ns(Fp.layout_circle.visibility)})),paint:ym||(ym=new Gs({"circle-radius":new qs(Fp.paint_circle["circle-radius"]),"circle-color":new qs(Fp.paint_circle["circle-color"]),"circle-blur":new qs(Fp.paint_circle["circle-blur"]),"circle-opacity":new qs(Fp.paint_circle["circle-opacity"]),"circle-translate":new Ns(Fp.paint_circle["circle-translate"]),"circle-translate-anchor":new Ns(Fp.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ns(Fp.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ns(Fp.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new qs(Fp.paint_circle["circle-stroke-width"]),"circle-stroke-color":new qs(Fp.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new qs(Fp.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new Ns(Fp.paint_circle["circle-emissive-strength"])}))},Le,Oe,Ue)}createBucket(Re){return new Tl(Re)}queryRadius(Re){const Le=Re;return Gl("circle-radius",this,Le)+Gl("circle-stroke-width",this,Le)+Xl(this.paint.get("circle-translate"))}queryIntersectsFeature(Re,Le,Oe,Ue,qe,Ct,Ot,Jt){const Hr=Zl(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),Ct.angle,Re.pixelToTileUnitsFactor),Jr=this.paint.get("circle-radius").evaluate(Le,Oe)+this.paint.get("circle-stroke-width").evaluate(Le,Oe);return $u(Re,Ue,Ct,Ot,Jt,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),Hr,Jr)}getProgramIds(){return["circle"]}getDefaultProgramParams(Re,Le,Oe){const Ue=qu(this);return{config:new Lo(this,{zoom:Le,lut:Oe}),defines:Ue,overrideFog:!1}}},heatmap:class extends pa{createBucket(Re){return new Wu(Re)}constructor(Re,Le,Oe,Ue){super(Re,{layout:eg||(eg=new Gs({visibility:new Ns(Fp.layout_heatmap.visibility)})),paint:tg||(tg=new Gs({"heatmap-radius":new qs(Fp.paint_heatmap["heatmap-radius"]),"heatmap-weight":new qs(Fp.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ns(Fp.paint_heatmap["heatmap-intensity"]),"heatmap-color":new $s(Fp.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ns(Fp.paint_heatmap["heatmap-opacity"])}))},Le,Oe,Ue),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(Re){"heatmap-color"===Re&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=ac({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(Re){return Gl("heatmap-radius",this,Re)}queryIntersectsFeature(Re,Le,Oe,Ue,qe,Ct,Ot,Jt){const Hr=this.paint.get("heatmap-radius").evaluate(Le,Oe);return $u(Re,Ue,Ct,Ot,Jt,!0,!0,new Is(0,0),Hr)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(Re,Le,Oe){return"heatmap"===Re?{config:new Lo(this,{zoom:Le,lut:Oe}),overrideFog:!1}:{}}},hillshade:class extends pa{constructor(Re,Le,Oe,Ue){super(Re,{layout:rg||(rg=new Gs({visibility:new Ns(Fp.layout_hillshade.visibility)})),paint:ng||(ng=new Gs({"hillshade-illumination-direction":new Ns(Fp.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Ns(Fp.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ns(Fp.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ns(Fp.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ns(Fp.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ns(Fp.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new Ns(Fp.paint_hillshade["hillshade-emissive-strength"])}))},Le,Oe,Ue)}shouldRedrape(){return this.hasOffscreenPass()&&"viewport"===this.paint.get("hillshade-illumination-anchor")}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(Re,Le,Oe){return{overrideFog:!1}}},fill:class extends pa{constructor(Re,Le,Oe,Ue){super(Re,{layout:ag||(ag=new Gs({"fill-sort-key":new qs(Fp.layout_fill["fill-sort-key"]),visibility:new Ns(Fp.layout_fill.visibility)})),paint:lg||(lg=new Gs({"fill-antialias":new Ns(Fp.paint_fill["fill-antialias"]),"fill-opacity":new qs(Fp.paint_fill["fill-opacity"]),"fill-color":new qs(Fp.paint_fill["fill-color"]),"fill-outline-color":new qs(Fp.paint_fill["fill-outline-color"]),"fill-translate":new Ns(Fp.paint_fill["fill-translate"]),"fill-translate-anchor":new Ns(Fp.paint_fill["fill-translate-anchor"]),"fill-pattern":new qs(Fp.paint_fill["fill-pattern"]),"fill-emissive-strength":new Ns(Fp.paint_fill["fill-emissive-strength"]),"fill-z-offset":new qs(Fp.paint_fill["fill-z-offset"])}))},Le,Oe,Ue)}getProgramIds(){const Re=this.paint.get("fill-pattern"),Le=Re&&Re.constantOr(1),Oe=[Le?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&Oe.push(Le&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),Oe}getDefaultProgramParams(Re,Le,Oe){return{config:new Lo(this,{zoom:Le,lut:Oe}),overrideFog:!1}}recalculate(Re,Le){super.recalculate(Re,Le);const Oe=this.paint._values["fill-outline-color"];"constant"===Oe.value.kind&&void 0===Oe.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(Re){return new Fc(Re)}queryRadius(){return Xl(this.paint.get("fill-translate"))}queryIntersectsFeature(Re,Le,Oe,Ue,qe,Ct){return!Re.queryGeometry.isAboveHorizon&&Vl(Yl(Re.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),Ct.angle,Re.pixelToTileUnitsFactor),Ue)}isTileClipped(){return!0}is3D(){return 0!==this.paint.get("fill-z-offset").constantOr(1)}},"fill-extrusion":class extends pa{constructor(Re,Le,Oe,Ue){super(Re,{layout:i_||(i_=new Gs({visibility:new Ns(Fp["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new Ns(Fp["layout_fill-extrusion"]["fill-extrusion-edge-radius"])})),paint:o_||(o_=new Gs({"fill-extrusion-opacity":new Ns(Fp["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new qs(Fp["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ns(Fp["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ns(Fp["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new qs(Fp["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new qs(Fp["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new qs(Fp["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ns(Fp["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Ns(Fp["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Ns(Fp["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new Ns(Fp["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new Ns(Fp["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new Ns(Fp["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new Ns(Fp["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new Ns(Fp["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new qs(Fp["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new qs(Fp["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new Ns(Fp["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new Ns(Fp["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new Ns(Fp["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new Ns(Fp["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new qs(Fp["paint_fill-extrusion"]["fill-extrusion-emissive-strength"]),"fill-extrusion-line-width":new qs(Fp["paint_fill-extrusion"]["fill-extrusion-line-width"]),"fill-extrusion-cast-shadows":new Ns(Fp["paint_fill-extrusion"]["fill-extrusion-cast-shadows"])}))},Le,Oe,Ue),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(Re){return new Zh(Re)}queryRadius(){return Xl(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}hasShadowPass(){return this.paint.get("fill-extrusion-cast-shadows")}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr){const Jr=Zl(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),Ct.angle,Re.pixelToTileUnitsFactor),Ln=this.paint.get("fill-extrusion-height").evaluate(Le,Oe),Nn=this.paint.get("fill-extrusion-base").evaluate(Le,Oe),$n=[0,0],Gn=Jt&&Ct.elevation,qn=Ct.elevation?Ct.elevation.exaggeration():1,Zn=Re.tile.getBucket(this);if(Gn&&Zn instanceof Zh){const Re=Zn.centroidVertexArray,Le=Hr+1;Le<Re.length&&($n[0]=Re.geta_centroid_pos0(Le),$n[1]=Re.geta_centroid_pos1(Le))}if(0===$n[0]&&1===$n[1])return!1;"globe"===Ct.projection.name&&(Ue=np([Ue],[new Is(0,0),new Is(id,id)],Re.tileID.canonical).map((Re=>Re.polygon)).flat());const Xn=Gn?Jt:null,[Yn,_i]=function(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr,Ln){return"globe"===Re.projection.name?function(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr,Ln){const Nn=[],$n=[],Gn=Re.projection.upVectorScale(Ln,Re.center.lat,Re.worldSize).metersToTile,qn=[0,0,0,1],Zn=[0,0,0,1],y=(Re,Le,Oe,Ue)=>{Re[0]=Le,Re[1]=Oe,Re[2]=Ue,Re[3]=1},Xn=rp();Oe>0&&(Oe+=Xn),Ue+=Xn;for(const Xn of Le){const Le=[],Yn=[];for(const Nn of Xn){const $n=Nn.x+qe.x,Xn=Nn.y+qe.y,_i=Re.projection.projectTilePoint($n,Xn,Ln),vi=Re.projection.upVector(Ln,Nn.x,Nn.y);let xi=Oe,bi=Ue;if(Ot){const Re=up($n,Xn,Oe,Ue,Ot,Jt,Hr,Jr);xi+=Re.base,bi+=Re.top}0!==Oe?y(qn,_i.x+vi[0]*Gn*xi,_i.y+vi[1]*Gn*xi,_i.z+vi[2]*Gn*xi):y(qn,_i.x,_i.y,_i.z),y(Zn,_i.x+vi[0]*Gn*bi,_i.y+vi[1]*Gn*bi,_i.z+vi[2]*Gn*bi),Io.vec3.transformMat4(qn,qn,Ct),Io.vec3.transformMat4(Zn,Zn,Ct),Le.push(new hh(qn[0],qn[1],qn[2])),Yn.push(new hh(Zn[0],Zn[1],Zn[2]))}Nn.push(Le),$n.push(Yn)}return[Nn,$n]}(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr,Ln):Ot?function(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr){const Jr=[],Ln=[],Nn=[0,0,0,1];for(const $n of Re){const Re=[],Gn=[];for(const Jr of $n){const Ln=Jr.x+Ue.x,$n=Jr.y+Ue.y,qn=up(Ln,$n,Le,Oe,Ct,Ot,Jt,Hr);Nn[0]=Ln,Nn[1]=$n,Nn[2]=qn.base,Nn[3]=1,Io.vec4.transformMat4(Nn,Nn,qe),Nn[3]=Math.max(Nn[3],1e-5);const Zn=new hh(Nn[0]/Nn[3],Nn[1]/Nn[3],Nn[2]/Nn[3]);Nn[0]=Ln,Nn[1]=$n,Nn[2]=qn.top,Nn[3]=1,Io.vec4.transformMat4(Nn,Nn,qe),Nn[3]=Math.max(Nn[3],1e-5);const Xn=new hh(Nn[0]/Nn[3],Nn[1]/Nn[3],Nn[2]/Nn[3]);Re.push(Zn),Gn.push(Xn)}Jr.push(Re),Ln.push(Gn)}return[Jr,Ln]}(Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr):function(Re,Le,Oe,Ue,qe){const Ct=[],Ot=[],Jt=qe[8]*Le,Hr=qe[9]*Le,Jr=qe[10]*Le,Ln=qe[11]*Le,Nn=qe[8]*Oe,$n=qe[9]*Oe,Gn=qe[10]*Oe,qn=qe[11]*Oe;for(const Le of Re){const Re=[],Oe=[];for(const Ct of Le){const Le=Ct.x+Ue.x,Ot=Ct.y+Ue.y,Zn=qe[0]*Le+qe[4]*Ot+qe[12],Xn=qe[1]*Le+qe[5]*Ot+qe[13],Yn=qe[2]*Le+qe[6]*Ot+qe[14],_i=qe[3]*Le+qe[7]*Ot+qe[15],vi=Zn+Jt,xi=Xn+Hr,bi=Yn+Jr,Pi=Math.max(_i+Ln,1e-5),lo=Zn+Nn,uo=Xn+$n,po=Yn+Gn,fo=Math.max(_i+qn,1e-5);Re.push(new hh(vi/Pi,xi/Pi,bi/Pi)),Oe.push(new hh(lo/fo,uo/fo,po/fo))}Ct.push(Re),Ot.push(Oe)}return[Ct,Ot]}(Le,Oe,Ue,qe,Ct)}(Ct,Ue,Nn,Ln,Jr,Ot,Xn,$n,qn,Ct.center.lat,Re.tileID.canonical),vi=Re.queryGeometry;return function(Re,Le,Oe){let Ue=1/0;Vl(Oe,Le)&&(Ue=lp(Oe,Le[0]));for(let qe=0;qe<Le.length;qe++){const Ct=Le[qe],Ot=Re[qe];for(let Re=0;Re<Ct.length-1;Re++){const Le=Ct[Re],qe=[Le,Ct[Re+1],Ot[Re+1],Ot[Re],Le];El(Oe,qe)&&(Ue=Math.min(Ue,lp(Oe,qe)))}}return Ue!==1/0&&Ue}(Yn,_i,vi.isPointQuery()?vi.screenBounds:vi.screenGeometry)}},line:class extends pa{constructor(Re,Le,Oe,Ue){const qe=Ep();super(Re,qe,Le,Oe,Ue),qe.layout&&(this.layout=new js(qe.layout)),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(Re){if("line-gradient"===Re){const Re=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=Re._styleExpression&&Re._styleExpression.expression instanceof Un,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(Re,Le){super.recalculate(Re,Le),this.paint._values["line-floorwidth"]=(()=>{if(v_)return v_;const Re=Ep();return v_=new Bp(Re.paint.properties["line-width"].specification),v_.useIntegerZoom=!0,v_})().possiblyEvaluate(this._transitioningPaint._values["line-width"].value,Re)}createBucket(Re){return new wp(Re)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(Re,Le,Oe){const Ue=zp(this);return{config:new Lo(this,{zoom:Le,lut:Oe}),defines:Ue,overrideFog:!1}}queryRadius(Re){const Le=Re,Oe=Cp(Gl("line-width",this,Le),Gl("line-gap-width",this,Le)),Ue=Gl("line-offset",this,Le);return Oe/2+Math.abs(Ue)+Xl(this.paint.get("line-translate"))}queryIntersectsFeature(Re,Le,Oe,Ue,qe,Ct){if(Re.queryGeometry.isAboveHorizon)return!1;const Ot=Yl(Re.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),Ct.angle,Re.pixelToTileUnitsFactor),Jt=Re.pixelToTileUnitsFactor/2*Cp(this.paint.get("line-width").evaluate(Le,Oe),this.paint.get("line-gap-width").evaluate(Le,Oe)),Hr=this.paint.get("line-offset").evaluate(Le,Oe);return Hr&&(Ue=function(Re,Le){const Oe=[],Ue=new Is(0,0);for(let qe=0;qe<Re.length;qe++){const Ct=Re[qe],Ot=[];for(let Re=0;Re<Ct.length;Re++){const Oe=Ct[Re],qe=Ct[Re+1],Jt=0===Re?Ue:Oe.sub(Ct[Re-1])._unit()._perp(),Hr=Re===Ct.length-1?Ue:qe.sub(Oe)._unit()._perp(),Jr=Jt._add(Hr)._unit();Jr._mult(1/(Jr.x*Hr.x+Jr.y*Hr.y)),Ot.push(Jr._mult(Le)._add(Oe))}Oe.push(Ot)}return Oe}(Ue,Hr*Re.pixelToTileUnitsFactor)),function(Re,Le,Oe){for(let Ue=0;Ue<Le.length;Ue++){const qe=Le[Ue];if(Re.length>=3)for(let Le=0;Le<qe.length;Le++)if(Ul(Re,qe[Le]))return!0;if(Cl(Re,qe,Oe))return!0}return!1}(Ot,Ue,Jt)}isTileClipped(){return!0}isDraped(Re){const Le=this.layout.get("line-z-offset");return Le.isConstant()&&!Le.constantOr(0)}},symbol:tm,background:class extends pa{constructor(Re,Le,Oe,Ue){super(Re,{layout:Jy||(Jy=new Gs({visibility:new Ns(Fp.layout_background.visibility)})),paint:Qy||(Qy=new Gs({"background-pitch-alignment":new Ns(Fp.paint_background["background-pitch-alignment"]),"background-color":new Ns(Fp.paint_background["background-color"]),"background-pattern":new Ns(Fp.paint_background["background-pattern"]),"background-opacity":new Ns(Fp.paint_background["background-opacity"]),"background-emissive-strength":new Ns(Fp.paint_background["background-emissive-strength"])}))},Le,Oe,Ue)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(Re,Le,Oe){return{overrideFog:!1}}is3D(){return"viewport"===this.paint.get("background-pitch-alignment")}},raster:mm,"raster-particle":wm,sky:class extends pa{constructor(Re,Le,Oe,Ue){super(Re,{layout:sv||(sv=new Gs({visibility:new Ns(Fp.layout_sky.visibility)})),paint:av||(av=new Gs({"sky-type":new Ns(Fp.paint_sky["sky-type"]),"sky-atmosphere-sun":new Ns(Fp.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Ns(Fp.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Ns(Fp.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Ns(Fp.paint_sky["sky-gradient-radius"]),"sky-gradient":new $s(Fp.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Ns(Fp.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Ns(Fp.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Ns(Fp.paint_sky["sky-opacity"])}))},Le,Oe,Ue),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(Re){"sky-gradient"===Re?this._updateColorRamp():"sky-atmosphere-sun"!==Re&&"sky-atmosphere-halo-color"!==Re&&"sky-atmosphere-color"!==Re&&"sky-atmosphere-sun-intensity"!==Re||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=ac({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(Re){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const Le=Re.style.light.properties.get("position");return this._lightPosition.azimuthal!==Le.azimuthal||this._lightPosition.polar!==Le.polar}return!1}getCenter(Re,Le){if("atmosphere"===this.paint.get("sky-type")){const Oe=this.paint.get("sky-atmosphere-sun"),Ue=!Oe,qe=Re.style.light,Ct=qe.properties.get("position");return Ue&&"viewport"===qe.properties.get("anchor")&&ft("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),Ue?Mm(Ct.azimuthal,90-Ct.polar,Le):Mm(Oe[0],90-Oe[1],Le)}const Oe=this.paint.get("sky-gradient-center");return Mm(Oe[0],90-Oe[1],Le)}isSky(){return!0}markSkyboxValid(Re){this._skyboxInvalidated=!1,this._lightPosition=Re.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const Re=this.paint.get("sky-type");return"atmosphere"===Re?["skyboxCapture","skybox"]:"gradient"===Re?["skyboxGradient"]:null}},slot:class extends pa{constructor(Re,Le,Oe,Ue){super(Re,{paint:lv||(lv=new Gs({}))},Le,null)}},model:class extends pa{constructor(Re,Le,Oe,Ue){super(Re,{layout:yv||(yv=new Gs({visibility:new Ns(Fp.layout_model.visibility),"model-id":new qs(Fp.layout_model["model-id"])})),paint:vv||(vv=new Gs({"model-opacity":new Ns(Fp.paint_model["model-opacity"]),"model-rotation":new qs(Fp.paint_model["model-rotation"]),"model-scale":new qs(Fp.paint_model["model-scale"]),"model-translation":new qs(Fp.paint_model["model-translation"]),"model-color":new qs(Fp.paint_model["model-color"]),"model-color-mix-intensity":new qs(Fp.paint_model["model-color-mix-intensity"]),"model-type":new Ns(Fp.paint_model["model-type"]),"model-cast-shadows":new Ns(Fp.paint_model["model-cast-shadows"]),"model-receive-shadows":new Ns(Fp.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new Ns(Fp.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new qs(Fp.paint_model["model-emissive-strength"]),"model-roughness":new qs(Fp.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new qs(Fp.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new Ns(Fp.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new Ns(Fp.paint_model["model-front-cutoff"])}))},Le,Oe,Ue),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(Re){return new Xm(Re)}getProgramIds(){return["model"]}is3D(){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(Re){return Re instanceof cy?id-1:0}queryIntersectsFeature(Re,Le,Oe,Ue,qe,Ct){if(!this.modelManager)return!1;const Ot=this.modelManager,Jt=Re.tile.getBucket(this);if(!(Jt&&Jt instanceof Xm))return!1;const Hr=Jt;for(const Oe in Hr.instancesPerModel){const Ue=Hr.instancesPerModel[Oe],qe=void 0!==Le.id?Le.id:Le.properties&&Le.properties.hasOwnProperty("id")?Le.properties.id:void 0;if(Ue.idToFeaturesIndex.hasOwnProperty(qe)){const Le=Ue.features[Ue.idToFeaturesIndex[qe]],Jt=Ot.getModel(Oe,this.scope);if(!Jt)return!1;let Jr=Io.mat4.create();const Ln=new rl(0,0),Nn=Hr.canonical;let $n=Number.MAX_VALUE;for(let Oe=0;Oe<Le.instancedDataCount;++Oe){const qe=16*(Le.instancedDataOffset+Oe),Ot=Ue.instancedDataArray.float32,Hr=[Ot[qe+4],Ot[qe+5],Ot[qe+6]];dy(Nn,Ln,Ot[qe],0|Ot[qe+1]),Km(Jr,Jt,Ct,Ln,Le.rotation,Le.scale,Hr,!1,!1,!1),"globe"===Ct.projection.name&&(Jr=Bm(Jr,Ct));const Gn=Io.mat4.multiply([],Ct.projMatrix,Jr),qn=Re.queryGeometry,Zn=Vm(qn.isPointQuery()?qn.screenBounds:qn.screenGeometry,Ct,Gn,Jt.aabb);null!=Zn&&($n=Math.min(Zn,$n))}return $n!==Number.MAX_VALUE&&$n}}return!1}_handleOverridablePaintPropertyUpdate(Re,Le,Oe){return!(!this.layout||Le.isDataDriven()||Oe.isDataDriven()||"model-color"!==Re&&"model-color-mix-intensity"!==Re&&"model-rotation"!==Re&&"model-scale"!==Re&&"model-translation"!==Re&&"model-emissive-strength"!==Re)}_isPropertyZoomDependent(Re){const Le=this._transitionablePaint._values[Re];return null!=Le&&null!=Le.value&&null!=Le.value.expression&&Le.value.expression instanceof Ji}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}queryIntersectsMatchingFeature(Re,Le,Oe,Ue){const qe=Re.tile,Ct=qe.getBucket(this);let Ot=null,Jt=Number.MAX_VALUE;if(!(Ct&&Ct instanceof cy))return{queryFeature:Ot,intersectionZ:Jt};const Hr=Ct.getNodesInfo()[Le];if(Hr.hiddenByReplacement||!Hr.node.meshes||!Oe.filter(new Vs(qe.tileID.overscaledZ),Hr.feature,qe.tileID.canonical))return{queryFeature:Ot,intersectionZ:Jt};const Jr=Hr.node,Ln=Ue.calculatePosMatrix(qe.tileID.toUnwrapped(),Ue.worldSize),Nn=Hr.evaluatedScale;let $n=0;Ue.elevation&&Jr.elevation&&($n=Jr.elevation*Ue.elevation.exaggeration()),Io.mat4.translate(Ln,Ln,[(Jr.anchor?Jr.anchor[0]:0)*(Nn[0]-1),(Jr.anchor?Jr.anchor[1]:0)*(Nn[1]-1),$n]),Io.mat4.scale(Ln,Ln,Nn),Io.mat4.multiply(Ln,Ln,Jr.matrix);const Gn=Re.queryGeometry,qn=Gn.isPointQuery()?Gn.screenBounds:Gn.screenGeometry,m=function(Re){const Le=Io.mat4.multiply([],Ln,Re.matrix),Oe=Io.mat4.multiply(Le,Ue.expandedFarZProjMatrix,Le);for(let Le=0;Le<Re.meshes.length;++Le){const qe=Re.meshes[Le];if(Le===Re.lightMeshIndex)continue;const Ct=Vm(qn,Ue,Oe,qe.aabb);null!=Ct&&(Jt=Math.min(Ct,Jt))}if(Re.children)for(const Le of Re.children)m(Le)};if(m(Jr),Jt===Number.MAX_VALUE)return{queryFeature:Ot,intersectionZ:Jt};const Zn=new rl(0,0);return dy(qe.tileID.canonical,Zn,Hr.node.anchor[0],Hr.node.anchor[1]),Ot={type:"Feature",geometry:{type:"Point",coordinates:[Zn.lng,Zn.lat]},properties:Hr.feature.properties,id:Hr.feature.id,state:{},layer:this.serialize()},{queryFeature:Ot,intersectionZ:Jt}}},clip:class extends pa{constructor(Re,Le,Oe,Ue){super(Re,{layout:dg||(dg=new Gs({"clip-layer-types":new Ns(Fp.layout_clip["clip-layer-types"]),"clip-layer-scope":new Ns(Fp.layout_clip["clip-layer-scope"])})),paint:pg||(pg=new Gs({}))},Le,Oe,Ue)}recalculate(Re,Le){super.recalculate(Re,Le)}createBucket(Re){return new Gc(Re)}isTileClipped(){return!0}is3D(){return!0}}};class yy{constructor(Re){this._callback=Re,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._callback()}),0))}remove(){this._channel=void 0,this._callback=()=>{}}}class gy{constructor(){this.tasks={},this.taskQueue=[],ot(["process"],this),this.invoker=new yy(this.process),this.nextId=0}add(Re,Le){const Oe=this.nextId++,Ue=function({type:Re,isSymbolTile:Le,zoom:Oe}){return Oe=Oe||0,"message"===Re?0:"maybePrepare"!==Re||Le?"parseTile"!==Re||Le?"parseTile"===Re&&Le?300-Oe:"maybePrepare"===Re&&Le?400-Oe:500:200-Oe:100-Oe}(Le);if(0===Ue){try{Re()}finally{}return null}return this.tasks[Oe]={fn:Re,metadata:Le,priority:Ue,id:Oe},this.taskQueue.push(Oe),this.invoker.trigger(),{cancel:()=>{delete this.tasks[Oe]}}}process(){try{if(this.taskQueue=this.taskQueue.filter((Re=>!!this.tasks[Re])),!this.taskQueue.length)return;const Re=this.pick();if(null===Re)return;const Le=this.tasks[Re];if(delete this.tasks[Re],this.taskQueue.length&&this.invoker.trigger(),!Le)return;Le.fn()}finally{}}pick(){let Re=null,Le=1/0;for(let Oe=0;Oe<this.taskQueue.length;Oe++){const Ue=this.tasks[this.taskQueue[Oe]];Ue.priority<Le&&(Le=Ue.priority,Re=Oe)}if(null===Re)return null;const Oe=this.taskQueue[Re];return this.taskQueue.splice(Re,1),Oe}remove(){this.invoker.remove()}}class xy{constructor(Re,Le,Oe){this.target=Re,this.parent=Le,this.mapId=Oe,this.callbacks={},this.cancelCallbacks={},ot(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new gy}send(Re,Le,Oe,Ue,qe=!1,Ct){const Ot=Math.round(1e18*Math.random()).toString(36).substring(0,10);Oe&&(Oe.metadata=Ct,this.callbacks[Ot]=Oe);const Jt=new Set;return this.target.postMessage({id:Ot,type:Re,hasCallback:!!Oe,targetMapId:Ue,mustQueue:qe,sourceMapId:this.mapId,data:cs(Le,Jt)},Jt),{cancel:()=>{Oe&&delete this.callbacks[Ot],this.target.postMessage({id:Ot,type:"<cancel>",targetMapId:Ue,sourceMapId:this.mapId})}}}receive(Re){const Le=Re.data,Oe=Le.id;if(Oe&&(!Le.targetMapId||this.mapId===Le.targetMapId))if("<cancel>"===Le.type){const Re=this.cancelCallbacks[Oe];delete this.cancelCallbacks[Oe],Re&&Re.cancel()}else if(Le.mustQueue||gt()){const Re=this.callbacks[Oe],Ue=this.scheduler.add((()=>this.processTask(Oe,Le)),Re&&Re.metadata||{type:"message"});Ue&&(this.cancelCallbacks[Oe]=Ue)}else this.processTask(Oe,Le)}processTask(Re,Le){if(delete this.cancelCallbacks[Re],"<response>"===Le.type){const Oe=this.callbacks[Re];delete this.callbacks[Re],Oe&&(Le.error?Oe(hs(Le.error)):Oe(null,hs(Le.data)))}else{const Oe=new Set,Ue=Le.hasCallback?(Le,Ue)=>{this.target.postMessage({id:Re,type:"<response>",sourceMapId:this.mapId,error:Le?cs(Le):null,data:cs(Ue,Oe)},Oe)}:Re=>{},qe=hs(Le.data);if(this.parent[Le.type])this.parent[Le.type](Le.sourceMapId,qe,Ue);else if(this.parent.getWorkerSource){const Re=Le.type.split(".");this.parent.getWorkerSource(Le.sourceMapId,Re[0],qe.source,qe.scope)[Re[1]](qe,Ue)}else Ue(new Error(`Could not find function ${Le.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}class by{constructor(Re,Le){this.workerPool=Re,this.actors=[],this.currentActor=0,this.id=st();const Oe=this.workerPool.acquire(this.id);for(let Re=0;Re<Oe.length;Re++){const Ue=new by.Actor(Oe[Re],Le,this.id);Ue.name=`Worker ${Re}`,this.actors.push(Ue)}this.ready=!1,this.broadcast("checkIfReady",null,(()=>{this.ready=!0}))}broadcast(Re,Le,Oe){rt(this.actors,((Oe,Ue)=>{Oe.send(Re,Le,Ue)}),Oe=Oe||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach((Re=>{Re.remove()})),this.actors=[],this.workerPool.release(this.id)}}by.Actor=xy;class vy{constructor(Re){this.size=Re,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(Re,Le){const Oe=this.toIdx(Re,Le);return{min:this.minimums[Oe],max:this.maximums[Oe]}}isLeaf(Re,Le){return this.leaves[this.toIdx(Re,Le)]}toIdx(Re,Le){return Le*this.size+Re}}function wy(Re,Le,Oe,Ue){let qe=0,Ct=Number.MAX_VALUE;for(let Ot=0;Ot<3;Ot++)if(Math.abs(Ue[Ot])<1e-15){if(Oe[Ot]<Re[Ot]||Oe[Ot]>Le[Ot])return null}else{const Jt=1/Ue[Ot];let Hr=(Re[Ot]-Oe[Ot])*Jt,Jr=(Le[Ot]-Oe[Ot])*Jt;if(Hr>Jr){const Re=Hr;Hr=Jr,Jr=Re}if(Hr>qe&&(qe=Hr),Jr<Ct&&(Ct=Jr),qe>Ct)return null}return qe}function _y(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr,Ln){const Nn=Ue-Re,$n=qe-Le,Gn=Ct-Oe,qn=Ot-Re,Zn=Jt-Le,Xn=Hr-Oe,Yn=Ln[1]*Xn-Ln[2]*Zn,_i=Ln[2]*qn-Ln[0]*Xn,vi=Ln[0]*Zn-Ln[1]*qn,xi=Nn*Yn+$n*_i+Gn*vi;if(Math.abs(xi)<1e-15)return null;const bi=1/xi,Pi=Jr[0]-Re,lo=Jr[1]-Le,uo=Jr[2]-Oe,po=(Pi*Yn+lo*_i+uo*vi)*bi;if(po<0||po>1)return null;const fo=lo*Gn-uo*$n,Io=uo*Nn-Pi*Gn,is=Pi*$n-lo*Nn,as=(Ln[0]*fo+Ln[1]*Io+Ln[2]*is)*bi;return as<0||po+as>1?null:(qn*fo+Zn*Io+Xn*is)*bi}function My(Re,Le,Oe){return(Re-Le)/(Oe-Le)}function Ay(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr){const Jr=1<<Oe,Ln=Ct-Ue,Nn=Ot-qe,$n=(Re+1)/Jr*Ln+Ue,Gn=(Le+0)/Jr*Nn+qe,qn=(Le+1)/Jr*Nn+qe;Jt[0]=(Re+0)/Jr*Ln+Ue,Jt[1]=Gn,Hr[0]=$n,Hr[1]=qn}class Sy{constructor(Re){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=Re,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const Le=function(Re){const Le=Math.ceil(Math.log2(Re.dim/8)),Oe=[];let Ue=Math.ceil(Math.pow(2,Le));const qe=1/Ue,s=(Re,Le,Oe,Ue,qe)=>{const Ct=Ue?1:0,Ot=(Re+1)*Oe-Ct,Jt=Le*Oe,Hr=(Le+1)*Oe-Ct;qe[0]=Re*Oe,qe[1]=Jt,qe[2]=Ot,qe[3]=Hr};let Ct=new vy(Ue);const Ot=[];for(let Le=0;Le<Ue*Ue;Le++){s(Le%Ue,Math.floor(Le/Ue),qe,!1,Ot);const Oe=Py(Ot[0],Ot[1],Re),Jt=Py(Ot[2],Ot[1],Re),Hr=Py(Ot[2],Ot[3],Re),Jr=Py(Ot[0],Ot[3],Re);Ct.minimums.push(Math.min(Oe,Jt,Hr,Jr)),Ct.maximums.push(Math.max(Oe,Jt,Hr,Jr)),Ct.leaves.push(1)}for(Oe.push(Ct),Ue/=2;Ue>=1;Ue/=2){const Re=Oe[Oe.length-1];Ct=new vy(Ue);for(let Le=0;Le<Ue*Ue;Le++){s(Le%Ue,Math.floor(Le/Ue),2,!0,Ot);const Oe=Re.getElevation(Ot[0],Ot[1]),qe=Re.getElevation(Ot[2],Ot[1]),Jt=Re.getElevation(Ot[2],Ot[3]),Hr=Re.getElevation(Ot[0],Ot[3]),Jr=Re.isLeaf(Ot[0],Ot[1]),Ln=Re.isLeaf(Ot[2],Ot[1]),Nn=Re.isLeaf(Ot[2],Ot[3]),$n=Re.isLeaf(Ot[0],Ot[3]),Gn=Math.min(Oe.min,qe.min,Jt.min,Hr.min),qn=Math.max(Oe.max,qe.max,Jt.max,Hr.max),Zn=Jr&&Ln&&Nn&&$n;Ct.maximums.push(qn),Ct.minimums.push(Gn),Ct.leaves.push(qn-Gn<=5&&Zn?1:0)}Oe.push(Ct)}return Oe}(this.dem),Oe=Le.length-1,Ue=Le[Oe];this._addNode(Ue.minimums[0],Ue.maximums[0],Ue.leaves[0]),this._construct(Le,0,0,Oe,0)}raycastRoot(Re,Le,Oe,Ue,qe,Ct,Ot=1){return wy([Re,Le,-100],[Oe,Ue,this.maximums[0]*Ot],qe,Ct)}raycast(Re,Le,Oe,Ue,qe,Ct,Ot=1){if(!this.nodeCount)return null;const Jt=this.raycastRoot(Re,Le,Oe,Ue,qe,Ct,Ot);if(null==Jt)return null;const Hr=[],Jr=[],Ln=[],Nn=[],$n=[{idx:0,t:Jt,nodex:0,nodey:0,depth:0}];for(;$n.length>0;){const{idx:Jt,t:Gn,nodex:qn,nodey:Zn,depth:Xn}=$n.pop();if(this.leaves[Jt]){Ay(qn,Zn,Xn,Re,Le,Oe,Ue,Ln,Nn);const Jt=1<<Xn,Hr=(qn+0)/Jt,Jr=(qn+1)/Jt,$n=(Zn+0)/Jt,Yn=(Zn+1)/Jt,_i=Py(Hr,$n,this.dem)*Ot,vi=Py(Jr,$n,this.dem)*Ot,xi=Py(Jr,Yn,this.dem)*Ot,bi=Py(Hr,Yn,this.dem)*Ot,Pi=_y(Ln[0],Ln[1],_i,Nn[0],Ln[1],vi,Nn[0],Nn[1],xi,qe,Ct),lo=_y(Nn[0],Nn[1],xi,Ln[0],Nn[1],bi,Ln[0],Ln[1],_i,qe,Ct),uo=Math.min(null!==Pi?Pi:Number.MAX_VALUE,null!==lo?lo:Number.MAX_VALUE);if(uo!==Number.MAX_VALUE)return uo;{const Re=Io.vec3.scaleAndAdd([],qe,Ct,Gn);if(Iy(_i,vi,bi,xi,My(Re[0],Ln[0],Nn[0]),My(Re[1],Ln[1],Nn[1]))>=Re[2])return Gn}continue}let Yn=0;for(let $n=0;$n<this._siblingOffset.length;$n++){Ay((qn<<1)+this._siblingOffset[$n][0],(Zn<<1)+this._siblingOffset[$n][1],Xn+1,Re,Le,Oe,Ue,Ln,Nn),Ln[2]=-100,Nn[2]=this.maximums[this.childOffsets[Jt]+$n]*Ot;const Gn=wy(Ln,Nn,qe,Ct);if(null!=Gn){const Re=Gn;Hr[$n]=Re;let Le=!1;for(let Oe=0;Oe<Yn&&!Le;Oe++)Re>=Hr[Jr[Oe]]&&(Jr.splice(Oe,0,$n),Le=!0);Le||(Jr[Yn]=$n),Yn++}}for(let Re=0;Re<Yn;Re++){const Le=Jr[Re];$n.push({idx:this.childOffsets[Jt]+Le,t:Hr[Le],nodex:(qn<<1)+this._siblingOffset[Le][0],nodey:(Zn<<1)+this._siblingOffset[Le][1],depth:Xn+1})}}return null}_addNode(Re,Le,Oe){return this.minimums.push(Re),this.maximums.push(Le),this.leaves.push(Oe),this.childOffsets.push(0),this.nodeCount++}_construct(Re,Le,Oe,Ue,qe){if(1===Re[Ue].isLeaf(Le,Oe))return;this.childOffsets[qe]||(this.childOffsets[qe]=this.nodeCount);const Ct=Ue-1,Ot=Re[Ct];let Jt=0,Hr=0;for(let Re=0;Re<this._siblingOffset.length;Re++){const Ue=2*Le+this._siblingOffset[Re][0],qe=2*Oe+this._siblingOffset[Re][1],Ct=Ot.getElevation(Ue,qe),Jr=Ot.isLeaf(Ue,qe),Ln=this._addNode(Ct.min,Ct.max,Jr);Jr&&(Jt|=1<<Re),Hr||(Hr=Ln)}for(let Ue=0;Ue<this._siblingOffset.length;Ue++)Jt&1<<Ue||this._construct(Re,2*Le+this._siblingOffset[Ue][0],2*Oe+this._siblingOffset[Ue][1],Ct,Hr+Ue)}}function Iy(Re,Le,Oe,Ue,qe,Ct){return ke(ke(Re,Oe,Ct),ke(Le,Ue,Ct),qe)}function Py(Re,Le,Oe){const Ue=Oe.dim,qe=Q(Re*Ue-.5,0,Ue-1),Ct=Q(Le*Ue-.5,0,Ue-1),Ot=Math.floor(qe),Jt=Math.floor(Ct),Hr=Math.min(Ot+1,Ue-1),Jr=Math.min(Jt+1,Ue-1);return Iy(Oe.get(Ot,Jt),Oe.get(Hr,Jt),Oe.get(Ot,Jr),Oe.get(Hr,Jr),qe-Ot,Ct-Jt)}const Cv={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function ky(Re,Le,Oe){return(256*Re*256+256*Le+Oe)/10-1e4}function Ty(Re,Le,Oe){return 256*Re+Le+Oe/256-32768}class Ey{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(Re,Le,Oe,Ue=!1){if(this.uid=Re,Le.height!==Le.width)throw new RangeError("DEM tiles must be square");if(Oe&&"mapbox"!==Oe&&"terrarium"!==Oe)return void ft(`"${Oe}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=Le.height;const qe=this.dim=Le.height-2,Ct=new Uint32Array(Le.data.buffer);if(this.pixels=new Uint8Array(Le.data.buffer),this.floatView=new Float32Array(Le.data.buffer),this.borderReady=Ue,this._modifiedForSources={},!Ue){for(let Re=0;Re<qe;Re++)Ct[this._idx(-1,Re)]=Ct[this._idx(0,Re)],Ct[this._idx(qe,Re)]=Ct[this._idx(qe-1,Re)],Ct[this._idx(Re,-1)]=Ct[this._idx(Re,0)],Ct[this._idx(Re,qe)]=Ct[this._idx(Re,qe-1)];Ct[this._idx(-1,-1)]=Ct[this._idx(0,0)],Ct[this._idx(qe,-1)]=Ct[this._idx(qe-1,0)],Ct[this._idx(-1,qe)]=Ct[this._idx(0,qe-1)],Ct[this._idx(qe,qe)]=Ct[this._idx(qe-1,qe-1)]}const Ot="terrarium"===Oe?Ty:ky;for(let Re=0;Re<Ct.length;++Re){const Le=4*Re;this.floatView[Re]=Ot(this.pixels[Le],this.pixels[Le+1],this.pixels[Le+2])}this._timestamp=oc.now()}_buildQuadTree(){this._tree=new Sy(this)}get(Re,Le,Oe=!1){Oe&&(Re=Q(Re,-1,this.dim),Le=Q(Le,-1,this.dim));const Ue=this._idx(Re,Le);return this.floatView[Ue]}set(Re,Le,Oe){const Ue=this._idx(Re,Le),qe=this.floatView[Ue];return this.floatView[Ue]=Oe,Oe-qe}static getUnpackVector(Re){return Cv[Re]}_idx(Re,Le){if(Re<-1||Re>=this.dim+1||Le<-1||Le>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(Le+1)*this.stride+(Re+1)}static pack(Re,Le){const Oe=[0,0,0,0],Ue=Ey.getUnpackVector(Le);let qe=Math.floor((Re+Ue[3])/Ue[2]);return Oe[2]=qe%256,qe=Math.floor(qe/256),Oe[1]=qe%256,qe=Math.floor(qe/256),Oe[0]=qe,Oe}getPixels(){return new sc({width:this.stride,height:this.stride},this.pixels)}backfillBorder(Re,Le,Oe){if(this.dim!==Re.dim)throw new Error("dem dimension mismatch");let Ue=Le*this.dim,qe=Le*this.dim+this.dim,Ct=Oe*this.dim,Ot=Oe*this.dim+this.dim;switch(Le){case-1:Ue=qe-1;break;case 1:qe=Ue+1}switch(Oe){case-1:Ct=Ot-1;break;case 1:Ot=Ct+1}const Jt=-Le*this.dim,Hr=-Oe*this.dim;for(let Le=Ct;Le<Ot;Le++)for(let Oe=Ue;Oe<qe;Oe++){const Ue=4*this._idx(Oe,Le),qe=4*this._idx(Oe+Jt,Le+Hr);this.pixels[Ue+0]=Re.pixels[qe+0],this.pixels[Ue+1]=Re.pixels[qe+1],this.pixels[Ue+2]=Re.pixels[qe+2],this.pixels[Ue+3]=Re.pixels[qe+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}function By(Re,Le,Oe){1===Re?Le.header_length=Oe.readFixed32():2===Re?Le.x=Oe.readVarint():3===Re?Le.y=Oe.readVarint():4===Re?Le.z=Oe.readVarint():5===Re&&Le.layers.push(function(Re,Le){return Re.readFields(Ly,{version:0,name:"",units:"",tilesize:0,buffer:0,pixel_format:0,data_index:[]},Le)}(Oe,Oe.readVarint()+Oe.pos))}function Vy(Re,Le,Oe){1===Re?(Le.delta_filter=function(Re,Le){return Re.readFields(Cy,{block_size:0},Le)}(Oe,Oe.readVarint()+Oe.pos),Le.filter="delta_filter"):2===Re?(Oe.readVarint(),Le.filter="zigzag_filter"):3===Re?(Oe.readVarint(),Le.filter="bitshuffle_filter"):4===Re&&(Oe.readVarint(),Le.filter="byteshuffle_filter")}function Cy(Re,Le,Oe){1===Re&&(Le.block_size=Oe.readVarint())}function Ry(Re,Le,Oe){1===Re?(Oe.readVarint(),Le.codec="gzip_data"):2===Re?(Oe.readVarint(),Le.codec="jpeg_image"):3===Re?(Oe.readVarint(),Le.codec="webp_image"):4===Re&&(Oe.readVarint(),Le.codec="png_image")}function Dy(Re,Le,Oe){1===Re?Le.first_byte=Oe.readFixed64():2===Re?Le.last_byte=Oe.readFixed64():3===Re?Le.filters.push(function(Re,Le){return Re.readFields(Vy,{},Le)}(Oe,Oe.readVarint()+Oe.pos)):4===Re?Le.codec=function(Re,Le){return Re.readFields(Ry,{},Le)}(Oe,Oe.readVarint()+Oe.pos):5===Re?Le.deprecated_offset=Oe.readFloat():6===Re?Le.deprecated_scale=Oe.readFloat():7===Re?Le.bands.push(Oe.readString()):8===Re?Le.offset=Oe.readDouble():9===Re&&(Le.scale=Oe.readDouble())}function Ly(Re,Le,Oe){1===Re?Le.version=Oe.readVarint():2===Re?Le.name=Oe.readString():3===Re?Le.units=Oe.readString():4===Re?Le.tilesize=Oe.readVarint():5===Re?Le.buffer=Oe.readVarint():6===Re?Le.pixel_format=Oe.readVarint():7===Re&&Le.data_index.push(function(Re,Le){return Re.readFields(Dy,{first_byte:0,last_byte:0,filters:[],codec:null,offset:0,scale:0,deprecated_offset:0,deprecated_scale:0,bands:[]},Le)}(Oe,Oe.readVarint()+Oe.pos))}function Fy(Re,Le,Oe){if(2===Re)!function(Re,Le,Oe){Re.readFields(Oy,Oe,Le)}(Oe,Oe.readVarint()+Oe.pos,Le);else if(3===Re)throw new Error("Not implemented")}function Oy(Re,Le,Oe){if(1===Re){let Re=0;const Ue=Oe.readVarint()+Oe.pos;for(;Oe.pos<Ue;)Le[Re++]=Oe.readVarint()}}os(Ey,"DEMData"),os(Sy,"DemMinMaxQuadTree",{omit:["dem"]});class Uy{constructor(Re){this.capacity=Re,this.cache=new Map}get(Re){if(!this.cache.has(Re))return;const Le=this.cache.get(Re);return this.cache.delete(Re),this.cache.set(Re,Le),Le}put(Re,Le){this.cache.has(Re)?this.cache.delete(Re):this.cache.size===this.capacity&&this.cache.delete(this.cache.keys().next().value),this.cache.set(Re,Le)}}function jy(Re,Le){if(4!==Le.length)throw new Error(`Expected data of dimension 4 but got ${Le.length}.`);let Oe=Le[3];for(let Ue=2;Ue>=1;Ue--){const qe=1===Ue?1:0,Ct=2===Ue?1:0;for(let Ue=0;Ue<Le[0];Ue++){const Ot=Le[1]*Ue;for(let Ue=qe;Ue<Le[1];Ue++){const qe=Le[2]*(Ue+Ot);for(let Ue=Ct;Ue<Le[2];Ue++){const Ct=Le[3]*(Ue+qe);for(let Ue=0;Ue<Le[3];Ue++){const Le=Ct+Ue;Re[Le]+=Re[Le-Oe]}}}}Oe*=Le[Ue]}return Re}function Ny(Re){for(let Le=0,Oe=Re.length;Le<Oe;Le++)Re[Le]=Re[Le]>>>1^-(1&Re[Le]);return Re}function qy(Re,Le){switch(Le){case"uint32":return Re;case"uint16":for(let Le=0;Le<Re.length;Le+=2){const Oe=Re[Le],Ue=Re[Le+1];Re[Le]=(240&Oe)>>4|(61440&Oe)>>8|(240&Ue)<<4|61440&Ue,Re[Le+1]=15&Oe|(3840&Oe)>>4|(15&Ue)<<8|(3840&Ue)<<4}return Re;case"uint8":for(let Le=0;Le<Re.length;Le+=4){const Oe=Re[Le],Ue=Re[Le+1],qe=Re[Le+2],Ct=Re[Le+3];Re[Le+0]=(192&Oe)>>6|(192&Ue)>>4|(192&qe)>>2|192&Ct,Re[Le+1]=(48&Oe)>>4|(48&Ue)>>2|48&qe|(48&Ct)<<2,Re[Le+2]=(12&Oe)>>2|12&Ue|(12&qe)<<2|(12&Ct)<<4,Re[Le+3]=3&Oe|(3&Ue)<<2|(3&qe)<<4|(3&Ct)<<6}return Re;default:throw new Error(`Invalid pixel format, "${Le}"`)}}var Av=Uint8Array,Iv=Uint16Array,kv=Int32Array,Mv=new Av([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Pv=new Av([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Rv=new Av([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Hy=function(Re,Le){for(var Oe=new Iv(31),Ue=0;Ue<31;++Ue)Oe[Ue]=Le+=1<<Re[Ue-1];var qe=new kv(Oe[30]);for(Ue=1;Ue<30;++Ue)for(var Ct=Oe[Ue];Ct<Oe[Ue+1];++Ct)qe[Ct]=Ct-Oe[Ue]<<5|Ue;return{b:Oe,r:qe}},Lv=Hy(Mv,2),Ov=Lv.b,zv=Lv.r;Ov[28]=258,zv[258]=28;for(var Dv=Hy(Pv,0).b,Bv=new Iv(32768),Fv=0;Fv<32768;++Fv){var Nv=(43690&Fv)>>1|(21845&Fv)<<1;Bv[Fv]=((65280&(Nv=(61680&(Nv=(52428&Nv)>>2|(13107&Nv)<<2))>>4|(3855&Nv)<<4))>>8|(255&Nv)<<8)>>1}var ig=function(Re,Le,Oe){for(var Ue=Re.length,qe=0,Ct=new Iv(Le);qe<Ue;++qe)Re[qe]&&++Ct[Re[qe]-1];var Ot,Jt=new Iv(Le);for(qe=1;qe<Le;++qe)Jt[qe]=Jt[qe-1]+Ct[qe-1]<<1;Ot=new Iv(1<<Le);var Hr=15-Le;for(qe=0;qe<Ue;++qe)if(Re[qe])for(var Jr=qe<<4|Re[qe],Ln=Le-Re[qe],Nn=Jt[Re[qe]-1]++<<Ln,$n=Nn|(1<<Ln)-1;Nn<=$n;++Nn)Ot[Bv[Nn]>>Hr]=Jr;return Ot},jv=new Av(288);for(Fv=0;Fv<144;++Fv)jv[Fv]=8;for(Fv=144;Fv<256;++Fv)jv[Fv]=9;for(Fv=256;Fv<280;++Fv)jv[Fv]=7;for(Fv=280;Fv<288;++Fv)jv[Fv]=8;var Uv=new Av(32);for(Fv=0;Fv<32;++Fv)Uv[Fv]=5;var Vv=ig(jv,9),$v=ig(Uv,5),ug=function(Re){for(var Le=Re[0],Oe=1;Oe<Re.length;++Oe)Re[Oe]>Le&&(Le=Re[Oe]);return Le},cg=function(Re,Le,Oe){var Ue=Le/8|0;return(Re[Ue]|Re[Ue+1]<<8)>>(7&Le)&Oe},hg=function(Re,Le){var Oe=Le/8|0;return(Re[Oe]|Re[Oe+1]<<8|Re[Oe+2]<<16)>>(7&Le)},Gv=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],fg=function(Re,Le,Oe){var Ue=new Error(Le||Gv[Re]);if(Ue.code=Re,Error.captureStackTrace&&Error.captureStackTrace(Ue,fg),!Oe)throw Ue;return Ue},qv=new Av(0),Hv="undefined"!=typeof TextDecoder&&new TextDecoder;try{Hv.decode(qv,{stream:!0})}catch(Re){}const Wv={gzip_data:"gzip"};class gg extends Error{constructor(Re){super(Re),this.name="MRTError"}}const Zv={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},Xv={uint32:1,uint16:2,uint8:4},Yv={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};let Kv;class _g{constructor(Re=5){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=Re}getLayer(Re){const Le=this.layers[Re];if(!Le)throw new gg(`Layer '${Re}' not found`);return Le}getHeaderLength(Re){const Le=new Uint8Array(Re),Oe=new DataView(Re);if(13!==Le[0])throw new gg("File is not a valid MRT.");return Oe.getUint32(1,!0)}parseHeader(Re){const Le=new Uint8Array(Re),Oe=this.getHeaderLength(Re);if(Le.length<Oe)throw new gg(`Expected header with length >= ${Oe} but got buffer of length ${Le.length}`);const Ue=function(Re){return Re.readFields(By,{header_length:0,x:0,y:0,z:0,layers:[]},void 0)}(new Kv(Le.subarray(0,Oe)));if(!isNaN(this.x)&&(this.x!==Ue.x||this.y!==Ue.y||this.z!==Ue.z))throw new gg(`Invalid attempt to parse header ${Ue.z}/${Ue.x}/${Ue.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=Ue.x,this.y=Ue.y,this.z=Ue.z;for(const Re of Ue.layers)this.layers[Re.name]=new Mg(Re,{cacheSize:this._cacheSize});return this}createDecodingTask(Re){const Le=[],Oe=this.getLayer(Re.layerName);for(let Ue of Re.blockIndices){const qe=Oe.dataIndex[Ue],Ct=qe.first_byte-Re.firstByte,Ot=qe.last_byte-Re.firstByte;if(Oe._blocksInProgress.has(Ue))continue;const Jt={layerName:Oe.name,firstByte:Ct,lastByte:Ot,pixelFormat:Oe.pixelFormat,blockIndex:Ue,blockShape:[qe.bands.length].concat(Oe.bandShape),buffer:Oe.buffer,codec:qe.codec.codec,filters:qe.filters.map((Re=>Re.filter))};Oe._blocksInProgress.add(Ue),Le.push(Jt)}return new Ag(Le,(()=>{Le.forEach((Re=>Oe._blocksInProgress.delete(Re.blockIndex)))}),((Re,Ue)=>{if(Le.forEach((Re=>Oe._blocksInProgress.delete(Re.blockIndex))),Re)throw Re;Ue.forEach((Re=>{this.getLayer(Re.layerName).processDecodedData(Re)}))}))}}class Mg{constructor({version:Re,name:Le,units:Oe,tilesize:Ue,pixel_format:qe,buffer:Ct,data_index:Ot},Jt){if(this.version=Re,1!==this.version)throw new gg(`Cannot parse raster layer encoded with MRT version ${Re}`);this.name=Le,this.units=Oe,this.tileSize=Ue,this.buffer=Ct,this.pixelFormat=Zv[qe],this.dataIndex=Ot,this.bandShape=[Ue+2*Ct,Ue+2*Ct,Xv[this.pixelFormat]],this._decodedBlocks=new Uy(Jt?Jt.cacheSize:5),this._blocksInProgress=new Set}get dimension(){return Xv[this.pixelFormat]}get cacheSize(){return this._decodedBlocks.capacity}getBandList(){return this.dataIndex.map((({bands:Re})=>Re)).flat()}processDecodedData(Re){const Le=Re.blockIndex.toString();this._decodedBlocks.get(Le)||this._decodedBlocks.put(Le,Re.data)}getBlockForBand(Re){let Le=0;switch(typeof Re){case"string":for(const[Oe,Ue]of this.dataIndex.entries()){for(const[qe,Ct]of Ue.bands.entries())if(Ct===Re)return{bandIndex:Le+qe,blockIndex:Oe,blockBandIndex:qe};Le+=Ue.bands.length}break;case"number":for(const[Oe,Ue]of this.dataIndex.entries()){if(Re>=Le&&Re<Le+Ue.bands.length)return{bandIndex:Re,blockIndex:Oe,blockBandIndex:Re-Le};Le+=Ue.bands.length}break;default:throw new gg(`Invalid band \`${JSON.stringify(Re)}\`. Expected string or integer.`)}throw new gg(`Band not found: ${JSON.stringify(Re)}`)}getDataRange(Re){let Le=1/0,Oe=-1/0;const Ue=[],qe=new Set;for(const Ct of Re){const{blockIndex:Re}=this.getBlockForBand(Ct);if(Re<0)throw new gg(`Invalid band: ${JSON.stringify(Ct)}`);const Ot=this.dataIndex[Re];Ue.includes(Re)||Ue.push(Re),qe.add(Re),Le=Math.min(Le,Ot.first_byte),Oe=Math.max(Oe,Ot.last_byte)}if(qe.size>this.cacheSize)throw new gg(`Number of blocks to decode (${qe.size}) exceeds cache size (${this.cacheSize}).`);return{layerName:this.name,firstByte:Le,lastByte:Oe,blockIndices:Ue}}hasBand(Re){const{blockIndex:Le}=this.getBlockForBand(Re);return Le>=0}hasDataForBand(Re){const{blockIndex:Le}=this.getBlockForBand(Re);return Le>=0&&!!this._decodedBlocks.get(Le.toString())}getBandView(Re){const{blockIndex:Le,blockBandIndex:Oe}=this.getBlockForBand(Re),Ue=this._decodedBlocks.get(Le.toString());if(!Ue)throw new gg(`Data for band ${JSON.stringify(Re)} of layer "${this.name}" not decoded.`);const qe=this.dataIndex[Le],Ct=this.bandShape.reduce(((Re,Le)=>Re*Le),1),Ot=Oe*Ct,Jt=Ue.subarray(Ot,Ot+Ct);return{data:Jt,bytes:new Uint8Array(Jt.buffer).subarray(Jt.byteOffset,Jt.byteOffset+Jt.byteLength),tileSize:this.tileSize,buffer:this.buffer,pixelFormat:this.pixelFormat,dimension:this.dimension,offset:0!==qe.offset?qe.offset:qe.deprecated_offset,scale:0!==qe.scale?qe.scale:qe.deprecated_scale}}}_g.setPbf=function(Re){Kv=Re};class Ag{constructor(Re,Le,Oe){this.tasks=Re,this._onCancel=Le,this._onComplete=Oe,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(Re,Le){this._finalized||(this._onComplete(Re,Le),this._finalized=!0)}}_g.performDecoding=function(Re,Le){const Oe=new Uint8Array(Re);return Promise.all(Le.tasks.map((Re=>{const{layerName:Le,firstByte:Ue,lastByte:qe,pixelFormat:Ct,blockShape:Ot,blockIndex:Jt,filters:Hr,codec:Jr}=Re,Ln=Oe.subarray(Ue,qe+1),Nn=new Uint32Array(Ot[0]*Ot[1]*Ot[2]);let $n;if("gzip_data"!==Jr)throw new gg(`Unhandled codec: ${Jr}`);return $n=function(Re,Le){if(!globalThis.DecompressionStream&&"gzip_data"===Le)return Promise.resolve(((Ct=function(Re){31==Re[0]&&139==Re[1]&&8==Re[2]||fg(6,"invalid gzip data");var Le=Re[3],Oe=10;4&Le&&(Oe+=2+(Re[10]|Re[11]<<8));for(var Ue=(Le>>3&1)+(Le>>4&1);Ue>0;Ue-=!Re[Oe++]);return Oe+(2&Le)}(qe=Re))+8>qe.length&&fg(6,"invalid gzip data"),function(Re,Le,Oe){var Ue=Re.length;if(!Ue||Le.f&&!Le.l)return Oe||new Av(0);var qe=!Oe,Ct=qe||2!=Le.i,Ot=Le.i;qe&&(Oe=new Av(3*Ue));var Jt,Hr,c=function(Re){var Le=Oe.length;if(Re>Le){var Ue=new Av(Math.max(2*Le,Re));Ue.set(Oe),Oe=Ue}},Jr=Le.f||0,Ln=Le.p||0,Nn=Le.b||0,$n=Le.l,Gn=Le.d,qn=Le.m,Zn=Le.n,Xn=8*Ue;do{if(!$n){Jr=cg(Re,Ln,1);var Yn=cg(Re,Ln+1,3);if(Ln+=3,!Yn){var _i=Re[(as=4+((Ln+7)/8|0))-4]|Re[as-3]<<8,vi=as+_i;if(vi>Ue){Ot&&fg(0);break}Ct&&c(Nn+_i),Oe.set(Re.subarray(as,vi),Nn),Le.b=Nn+=_i,Le.p=Ln=8*vi,Le.f=Jr;continue}if(1==Yn)$n=Vv,Gn=$v,qn=9,Zn=5;else if(2==Yn){var xi=cg(Re,Ln,31)+257,bi=cg(Re,Ln+10,15)+4,Pi=xi+cg(Re,Ln+5,31)+1;Ln+=14;for(var lo=new Av(Pi),uo=new Av(19),po=0;po<bi;++po)uo[Rv[po]]=cg(Re,Ln+3*po,7);Ln+=3*bi;var fo=ug(uo),Io=(1<<fo)-1,is=ig(uo,fo);for(po=0;po<Pi;){var as,Is=is[cg(Re,Ln,Io)];if(Ln+=15&Is,(as=Is>>4)<16)lo[po++]=as;else{var Xs=0,ta=0;for(16==as?(ta=3+cg(Re,Ln,3),Ln+=2,Xs=lo[po-1]):17==as?(ta=3+cg(Re,Ln,7),Ln+=3):18==as&&(ta=11+cg(Re,Ln,127),Ln+=7);ta--;)lo[po++]=Xs}}var ha=lo.subarray(0,xi),el=lo.subarray(xi);qn=ug(ha),Zn=ug(el),$n=ig(ha,qn),Gn=ig(el,Zn)}else fg(1);if(Ln>Xn){Ot&&fg(0);break}}Ct&&c(Nn+131072);for(var tl=(1<<qn)-1,il=(1<<Zn)-1,sl=Ln;;sl=Ln){var fl=(Xs=$n[hg(Re,Ln)&tl])>>4;if((Ln+=15&Xs)>Xn){Ot&&fg(0);break}if(Xs||fg(2),fl<256)Oe[Nn++]=fl;else{if(256==fl){sl=Ln,$n=null;break}var Al=fl-254;fl>264&&(Al=cg(Re,Ln,(1<<(Wl=Mv[po=fl-257]))-1)+Ov[po],Ln+=Wl);var Ml=Gn[hg(Re,Ln)&il],Hl=Ml>>4;if(Ml||fg(3),Ln+=15&Ml,el=Dv[Hl],Hl>3){var Wl=Pv[Hl];el+=hg(Re,Ln)&(1<<Wl)-1,Ln+=Wl}if(Ln>Xn){Ot&&fg(0);break}Ct&&c(Nn+131072);var Kl=Nn+Al;if(Nn<el){var Jl=0-el,Ql=Math.min(el,Kl);for(Jl+Nn<0&&fg(3);Nn<Ql;++Nn)Oe[Nn]=(void 0)[Jl+Nn]}for(;Nn<Kl;++Nn)Oe[Nn]=Oe[Nn-el]}}Le.l=$n,Le.p=sl,Le.b=Nn,Le.f=Jr,$n&&(Jr=1,Le.m=qn,Le.d=Gn,Le.n=Zn)}while(!Jr);return Nn!=Oe.length&&qe?(Jt=Oe,(null==(Hr=Nn)||Hr>Jt.length)&&(Hr=Jt.length),new Av(Jt.subarray(0,Hr))):Oe.subarray(0,Nn)}(qe.subarray(Ct,-8),{i:2},new Av(((Oe=qe)[(Ue=Oe.length)-4]|Oe[Ue-3]<<8|Oe[Ue-2]<<16|Oe[Ue-1]<<24)>>>0))));var Oe,Ue,qe,Ct;const Ot=Wv[Le];if(!Ot)throw new Error(`Unhandled codec: ${Le}`);const Jt=new globalThis.DecompressionStream(Ot);return new Response(new Blob([Re]).stream().pipeThrough(Jt)).arrayBuffer().then((Re=>new Uint8Array(Re)))}(Ln,Jr).then((Re=>(function(Re,Le){Re.readFields(Fy,Le)}(new Kv(Re),Nn),new Yv[Ct](Nn.buffer)))),$n.then((Re=>{for(let Le=Hr.length-1;Le>=0;Le--)switch(Hr[Le]){case"delta_filter":jy(Re,Ot);break;case"zigzag_filter":Ny(Re);break;case"bitshuffle_filter":qy(Re,Ct);break;default:throw new gg(`Unhandled filter "${Hr[Le]}"`)}return{layerName:Le,blockIndex:Jt,data:Re}})).catch((Re=>{throw Re}))})))},os(Ag,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]});var Jv={workerUrl:"",workerClass:null,workerParams:void 0};const Qv="mapboxgl_preloaded_worker_pool";class Pg{constructor(){this.active={}}acquire(Re){if(!this.workers)for(this.workers=[];this.workers.length<Pg.workerCount;)this.workers.push(null!=Jv.workerClass?new Jv.workerClass:new self.Worker(Jv.workerUrl,Jv.workerParams));return this.active[Re]=!0,this.workers.slice()}release(Re){delete this.active[Re],this.workers&&0===this.numActive()&&(this.workers.forEach((Re=>{Re.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[Qv]}numActive(){return Object.keys(this.active).length}}let cx;function kg(){return cx||(cx=new Pg),cx}Pg.workerCount=2;let mx,_x,Tx,Sx,Ex,Cx=null;function Dg(){return gt()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:_x||Al.DRACO_URL}function Lg(){if(gt()&&self.worker&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(Sx)return Sx;const Re=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if("object"!=typeof WebAssembly)throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return Sx=WebAssembly.validate(Re)?Al.MESHOPT_SIMD_URL:Al.MESHOPT_URL,Sx}const Ax={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Ix={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},kx={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function jg(Re,Le,Oe){const Ue=Oe.json.bufferViews.length,qe=Oe.buffers.length;Le.bufferView=Ue,Oe.json.bufferViews[Ue]={buffer:qe,byteLength:Re.byteLength},Oe.buffers[qe]=Re}const Mx="KHR_draco_mesh_compression";function qg(Re,Le){const Oe=Re.extensions&&Re.extensions[Mx];if(!Oe)return;const Ue=new Tx.Decoder,qe=Hg(Le,Oe.bufferView),Ct=new Tx.Mesh;if(!Ue.DecodeArrayToMesh(qe,qe.byteLength,Ct))throw new Error("Failed to decode Draco mesh");const Ot=Le.json.accessors[Re.indices],Jt=Ax[Ot.componentType],Hr=Ot.count*Jt.BYTES_PER_ELEMENT,Jr=Tx._malloc(Hr);Jt===Uint16Array?Ue.GetTrianglesUInt16Array(Ct,Hr,Jr):Ue.GetTrianglesUInt32Array(Ct,Hr,Jr),jg(Tx.memory.buffer.slice(Jr,Jr+Hr),Ot,Le),Tx._free(Jr);for(const qe of Object.keys(Oe.attributes)){const Ot=Ue.GetAttributeByUniqueId(Ct,Oe.attributes[qe]),Jt=Le.json.accessors[Re.attributes[qe]],Hr=Ix[Jt.componentType],Jr=Jt.count*kx[Jt.type]*Ax[Jt.componentType].BYTES_PER_ELEMENT,Ln=Tx._malloc(Jr);Ue.GetAttributeDataArrayForAllPoints(Ct,Ot,Tx[Hr],Jr,Ln),jg(Tx.memory.buffer.slice(Ln,Ln+Jr),Jt,Le),Tx._free(Ln)}Ue.destroy(),Ct.destroy(),delete Re.extensions[Mx]}const Px="EXT_meshopt_compression";function Gg(Re,Le){if(!Re.extensions||!Re.extensions[Px])return;const Oe=Re.extensions[Px],Ue=new Uint8Array(Le.buffers[Oe.buffer],Oe.byteOffset||0,Oe.byteLength||0),qe=new Uint8Array(Oe.count*Oe.byteStride);Ex.decodeGltfBuffer(qe,Oe.count,Oe.byteStride,Ue,Oe.mode,Oe.filter),Re.buffer=Le.buffers.length,Re.byteOffset=0,Le.buffers[Re.buffer]=qe.buffer,delete Re.extensions[Px]}const Rx=1179937895,Lx=new TextDecoder("utf8");function Zg(Re,Le){return new URL(Re,Le).href}function Wg(Re,Le,Oe,Ue){return fetch(Zg(Re.uri,Ue)).then((Re=>Re.arrayBuffer())).then((Re=>{Le.buffers[Oe]=Re}))}function Hg(Re,Le){const Oe=Re.json.bufferViews[Le];return new Uint8Array(Re.buffers[Oe.buffer],Oe.byteOffset||0,Oe.byteLength)}function Kg(Re,Le,Oe,Ue){if(Re.uri){const qe=Zg(Re.uri,Ue);return fetch(qe).then((Re=>Re.blob())).then((Re=>createImageBitmap(Re))).then((Re=>{Le.images[Oe]=Re}))}if(void 0!==Re.bufferView){const Ue=Hg(Le,Re.bufferView),qe=new Blob([Ue],{type:Re.mimeType});return createImageBitmap(qe).then((Re=>{Le.images[Oe]=Re}))}}function Jg(Re,Le=0,Oe){const Ue={json:null,images:[],buffers:[]};if(new Uint32Array(Re,Le,1)[0]===Rx){const Oe=new Uint32Array(Re,Le);let qe=2;const Ct=(Oe[qe++]>>2)-3,Ot=Oe[qe++]>>2;if(qe++,Ue.json=JSON.parse(Lx.decode(Oe.subarray(qe,qe+Ot))),qe+=Ot,qe<Ct){const Ct=Oe[qe++];qe++;const Ot=Le+(qe<<2);Ue.buffers[0]=Re.slice(Ot,Ot+Ct)}}else Ue.json=JSON.parse(Lx.decode(new Uint8Array(Re,Le)));const{buffers:qe,images:Ct,meshes:Ot,extensionsUsed:Jt,bufferViews:Hr}=Ue.json;let Jr=Promise.resolve();if(qe){const Re=[];for(let Le=0;Le<qe.length;Le++){const Ct=qe[Le];Ct.uri?Re.push(Wg(Ct,Ue,Le,Oe)):Ue.buffers[Le]||(Ue.buffers[Le]=null)}Jr=Promise.all(Re)}return Jr.then((()=>{const Re=[],Le=Jt&&Jt.includes(Mx),qe=Jt&&Jt.includes(Px);if(Le&&Re.push(function(){if(!Tx)return null!=mx?mx:(mx=function(Re){let Le,Oe=null;function n(){Le=new Uint8Array(Oe.buffer)}function i(){throw new Error("Unexpected Draco error.")}const Ue={a:{a:i,d:function(Re,Oe,Ue){return Le.copyWithin(Re,Oe,Oe+Ue)},c:function(Re){const Ue=Le.length,qe=Math.max(Re>>>0,Math.ceil(1.2*Ue)),Ct=Math.ceil((qe-Ue)/65536);try{return Oe.grow(Ct),n(),!0}catch(Re){return!1}},b:i}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(Re,Ue):Re.then((Re=>Re.arrayBuffer())).then((Re=>WebAssembly.instantiate(Re,Ue)))).then((Re=>{const{Rb:Ue,Qb:qe,P:Ct,T:Ot,X:Jt,Ja:Hr,La:Jr,Qa:Ln,Va:Nn,Wa:$n,eb:Gn,jb:qn,f:Zn,e:Xn,yb:Yn,zb:_i,Ab:vi,Bb:xi,Db:bi,Gb:Pi}=Re.instance.exports;Oe=Xn;const lo=(()=>{let Re=0,Oe=0,Ct=0,Ot=0;return Jt=>{Ct&&(Ue(Ot),Ue(Re),Oe+=Ct,Ct=Re=0),Re||(Oe+=128,Re=qe(Oe));const Hr=Jt.length+7&-8;let Jr=Re;Hr>=Oe&&(Ct=Hr,Jr=Ot=qe(Hr));for(let Re=0;Re<Jt.length;Re++)Le[Jr+Re]=Jt[Re];return Jr}})();return n(),Zn(),{memory:Xn,_free:Ue,_malloc:qe,Mesh:class{constructor(){this.ptr=Ct()}destroy(){Ot(this.ptr)}},Decoder:class{constructor(){this.ptr=Hr()}destroy(){qn(this.ptr)}DecodeArrayToMesh(Re,Le,Oe){const Ue=lo(Re),qe=Jr(this.ptr,Ue,Le,Oe.ptr);return!!Jt(qe)}GetAttributeByUniqueId(Re,Le){return{ptr:Ln(this.ptr,Re.ptr,Le)}}GetTrianglesUInt16Array(Re,Le,Oe){Nn(this.ptr,Re.ptr,Le,Oe)}GetTrianglesUInt32Array(Re,Le,Oe){$n(this.ptr,Re.ptr,Le,Oe)}GetAttributeDataArrayForAllPoints(Re,Le,Oe,Ue,qe){Gn(this.ptr,Re.ptr,Le.ptr,Oe,Ue,qe)}},DT_INT8:Yn(),DT_UINT8:_i(),DT_INT16:vi(),DT_UINT16:xi(),DT_UINT32:bi(),DT_FLOAT32:Pi()}}))}(fetch(Dg())),mx.then((Re=>{Tx=Re,mx=void 0})))}()),qe&&Re.push(function(){if(Ex)return;const Re=function(Re){let Le;const Oe=WebAssembly.instantiateStreaming(Re,{}).then((Re=>{Le=Re.instance,Le.exports.__wasm_call_ctors()})),Ue={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},qe={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:Oe,supported:!0,decodeGltfBuffer(Re,Oe,Ct,Ot,Jt,Hr){!function(Re,Le,Oe,Ue,qe,Ct,Ot){const Jt=Re.exports.sbrk,Hr=Ue+3&-4,Jr=Jt(Hr*qe),Ln=Jt(Ct.length),Nn=new Uint8Array(Re.exports.memory.buffer);Nn.set(Ct,Ln);const $n=Le(Jr,Ue,qe,Ln,Ct.length);if(0===$n&&Ot&&Ot(Jr,Hr,qe),Oe.set(Nn.subarray(Jr,Jr+Ue*qe)),Jt(Jr-Jt(0)),0!==$n)throw new Error(`Malformed buffer data: ${$n}`)}(Le,Le.exports[qe[Jt]],Re,Oe,Ct,Ot,Le.exports[Ue[Hr]])}}}(fetch(Lg()));return Re.ready.then((()=>{Ex=Re}))}()),Ct)for(let Le=0;Le<Ct.length;Le++)Re.push(Kg(Ct[Le],Ue,Le,Oe));return(Re.length?Promise.all(Re):Promise.resolve()).then((()=>{if(Le&&Ot)for(const{primitives:Re}of Ot)for(const Le of Re)qg(Le,Ue);if(qe&&Ot&&Hr)for(const Re of Hr)Gg(Re,Ue);return Ue}))}))}function Qg(Re,Le){const Oe=Re.json.bufferViews[Le.bufferView],Ue=Ax[Le.componentType];return new Ue(Re.buffers[Oe.buffer],(Le.byteOffset||0)+(Oe.byteOffset||0),Le.count*(Oe.byteStride&&Oe.byteStride!==kx[Le.type]*Ue.BYTES_PER_ELEMENT?Oe.byteStride/Ue.BYTES_PER_ELEMENT:kx[Le.type]))}function tx(Re,Le,Oe,Ue){const qe=Ax[Le.componentType],Ct=function(Re){switch(Re){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(qe),Ot=Re.json.bufferViews[Le.bufferView],Jt=Ot.byteStride?Ot.byteStride/qe.BYTES_PER_ELEMENT:kx[Le.type],Hr=Oe.float32,Jr=Hr.length/Oe.capacity;for(let Re=0,Oe=0;Re<Le.count*Jt;Re+=Jt,Oe+=Jr)for(let Le=0;Le<Jr;Le++)Hr[Oe+Le]=Ue[Re+Le]*Ct;Oe._trim()}function ex(Re,Le,Oe){const Ue=Re.indices,qe=Re.attributes,Ct={};Ct.indexArray=new Da;const Ot=Le.json.accessors[Ue],Jt=Ot.count/3;Ct.indexArray.reserve(Jt);const Hr=Qg(Le,Ot);for(let Re=0;Re<Jt;Re++)Ct.indexArray.emplaceBack(Hr[3*Re],Hr[3*Re+1],Hr[3*Re+2]);Ct.indexArray._trim(),Ct.vertexArray=new Aa;const Jr=Le.json.accessors[qe.POSITION];Ct.vertexArray.reserve(Jr.count);const Ln=Qg(Le,Jr);for(let Re=0;Re<Jr.count;Re++)Ct.vertexArray.emplaceBack(Ln[3*Re],Ln[3*Re+1],Ln[3*Re+2]);if(Ct.vertexArray._trim(),Ct.aabb=new yu(Jr.min,Jr.max),Ct.centroid=function(Re,Le){const Oe=[0,0,0],Ue=Re.length;if(Ue>0){for(let qe=0;qe<Ue;qe++){const Ue=3*Re[qe];Oe[0]+=Le[Ue],Oe[1]+=Le[Ue+1],Oe[2]+=Le[Ue+2]}Oe[0]/=Ue,Oe[1]/=Ue,Oe[2]/=Ue}return Oe}(Hr,Ln),void 0!==qe.COLOR_0){const Re=Le.json.accessors[qe.COLOR_0],Oe=kx[Re.type],Ue=Qg(Le,Re);Ct.colorArray=3===Oe?new Aa:new Ma,Ct.colorArray.resize(Re.count),tx(Le,Re,Ct.colorArray,Ue)}if(void 0!==qe.NORMAL){Ct.normalArray=new Aa;const Re=Le.json.accessors[qe.NORMAL];Ct.normalArray.resize(Re.count);const Oe=Qg(Le,Re);tx(Le,Re,Ct.normalArray,Oe)}if(void 0!==qe.TEXCOORD_0&&Oe.length>0){Ct.texcoordArray=new $a;const Re=Le.json.accessors[qe.TEXCOORD_0];Ct.texcoordArray.resize(Re.count);const Oe=Qg(Le,Re);tx(Le,Re,Ct.texcoordArray,Oe)}if(void 0!==qe._FEATURE_ID_RGBA4444){const Re=Le.json.accessors[qe._FEATURE_ID_RGBA4444];Le.json.extensionsUsed&&Le.json.extensionsUsed.includes("EXT_meshopt_compression")&&(Ct.featureData=Qg(Le,Re))}void 0!==qe._FEATURE_RGBA4444&&(Ct.featureData=new Uint32Array(Qg(Le,Le.json.accessors[qe._FEATURE_RGBA4444]).buffer));const Nn=Re.material;return Ct.material=function(Re,Le){const{emissiveFactor:Oe=[0,0,0],alphaMode:Ue="OPAQUE",alphaCutoff:qe=.5,normalTexture:Ct,occlusionTexture:Ot,emissiveTexture:Jt,doubleSided:Hr}=Re,{baseColorFactor:Jr=[1,1,1,1],metallicFactor:Ln=1,roughnessFactor:Nn=1,baseColorTexture:$n,metallicRoughnessTexture:Gn}=Re.pbrMetallicRoughness||{},qn=Ot?Le[Ot.index]:void 0;if(Ot&&Ot.extensions&&Ot.extensions.KHR_texture_transform&&qn){const Re=Ot.extensions.KHR_texture_transform;qn.offsetScale=[Re.offset[0],Re.offset[1],Re.scale[0],Re.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new Pe(...Jr),metallicFactor:Ln,roughnessFactor:Nn,baseColorTexture:$n?Le[$n.index]:void 0,metallicRoughnessTexture:Gn?Le[Gn.index]:void 0},doubleSided:Hr,emissiveFactor:Oe,alphaMode:Ue,alphaCutoff:qe,normalTexture:Ct?Le[Ct.index]:void 0,occlusionTexture:qn,emissionTexture:Jt?Le[Jt.index]:void 0,defined:void 0===Re.defined}}(void 0!==Nn?Le.json.materials[Nn]:{defined:!1},Oe),Ct}function rx(Re,Le,Oe){const{matrix:Ue,rotation:qe,translation:Ct,scale:Ot,mesh:Jt,extras:Hr,children:Jr}=Re,Ln={};if(Ln.matrix=Ue||Io.mat4.fromRotationTranslationScale([],qe||[0,0,0,1],Ct||[0,0,0],Ot||[1,1,1]),void 0!==Jt){Ln.meshes=Oe[Jt];const Re=Ln.anchor=[0,0];for(const Le of Ln.meshes){const{min:Oe,max:Ue}=Le.aabb;Re[0]+=Oe[0]+Ue[0],Re[1]+=Oe[1]+Ue[1]}Re[0]=Math.floor(Re[0]/Ln.meshes.length/2),Re[1]=Math.floor(Re[1]/Ln.meshes.length/2)}if(Hr&&(Hr.id&&(Ln.id=Hr.id),Hr.lights&&(Ln.lights=function(Re){if(!Re.length)return[];const Le=function(Re){const Le=atob(Re),Oe=new Uint8Array(Le.length);for(let Re=0;Re<Le.length;Re++)Oe[Re]=Le.codePointAt(Re);return Oe}(Re),Oe=[],Ue=Le.length/24,qe=new Uint16Array(Le.buffer),Ct=new Float32Array(Le.buffer);for(let Re=0;Re<Ue;Re++){const Le=qe[2*Re*6]/30,Ue=qe[2*Re*6+1]/30,Ot=qe[2*Re*6+10]/100,Jt=Ct[6*Re+1],Hr=Ct[6*Re+2],Jr=Ct[6*Re+3],Ln=Ct[6*Re+4],Nn=Jr-Jt,$n=Ln-Hr,Gn=Math.hypot(Nn,$n);Oe.push({pos:[Jt+.5*Nn,Hr+.5*$n,Ue],normal:[$n/Gn,-Nn/Gn,0],width:Gn,height:Le,depth:Ot,points:[Jt,Hr,Jr,Ln]})}return Oe}(Hr.lights))),Jr){const Re=[];for(const Ue of Jr)Re.push(rx(Le.json.nodes[Ue],Le,Oe));Ln.children=Re}return Ln}function nx(Re){if(0===Re.vertices.length||0===Re.indices.length)return null;const Le=new qc(Re.vertices,Re.indices,8,256),[Oe,Ue]=[Le.min.clone(),Le.max.clone()];return{vertices:Re.vertices,indices:Re.indices,grid:Le,min:Oe,max:Ue}}function ix(Re){if(!Re.extras||!Re.extras.ground)return null;const Le=Re.extras.ground;if(!Le||!Array.isArray(Le)||0===Le.length)return null;const Oe=Le[0];if(!Oe||!Array.isArray(Oe)||0===Oe.length)return null;const Ue=[];for(const Re of Oe){if(!Array.isArray(Re)||2!==Re.length)continue;const Le=Re[0],Oe=Re[1];"number"==typeof Le&&"number"==typeof Oe&&Ue.push(new Is(Le,Oe))}if(Ue.length<3)return null;Ue.length>1&&Ue[Ue.length-1].equals(Ue[0])&&Ue.pop();let qe=0;for(let Re=0;Re<Ue.length;Re++){const Le=Ue[Re],Oe=Ue[(Re+1)%Ue.length],Ct=Ue[(Re+2)%Ue.length];qe+=(Le.x-Oe.x)*(Ct.y-Oe.y)-(Ct.x-Oe.x)*(Le.y-Oe.y)}qe>0&&Ue.reverse();const Ct=uc(Ue.flatMap((Re=>[Re.x,Re.y])),[]);return 0===Ct.length?null:{vertices:Ue,indices:Ct}}function sx(Re,Le){const Oe=[],Ue=[];let qe=0;const Ct=[];for(const Ot of Re){qe=Oe.length;const Re=Ot.vertexArray.float32,Jt=Ot.indexArray.uint16;for(let Ue=0;Ue<Ot.vertexArray.length;Ue++)Ct[0]=Re[3*Ue+0],Ct[1]=Re[3*Ue+1],Ct[2]=Re[3*Ue+2],Io.vec3.transformMat4(Ct,Ct,Le),Oe.push(new Is(Ct[0],Ct[1]));for(let Re=0;Re<3*Ot.indexArray.length;Re++)Ue.push(Jt[Re]+qe)}if(Ue.length%3!=0)return null;for(let Re=0;Re<Ue.length;Re+=3){const Le=Oe[Ue[Re+0]],qe=Oe[Ue[Re+1]],Ct=Oe[Ue[Re+2]];(Le.x-qe.x)*(Ct.y-qe.y)-(Ct.x-qe.x)*(Le.y-qe.y)>0&&([Ue[Re+1],Ue[Re+2]]=[Ue[Re+2],Ue[Re+1]])}return{vertices:Oe,indices:Ue}}function ax(Re){const Le=function(Re,Le){const Oe=[],Ue=WebGL2RenderingContext;if(Re.json.textures)for(const qe of Re.json.textures){const Ct={magFilter:Ue.LINEAR,minFilter:Ue.NEAREST,wrapS:Ue.REPEAT,wrapT:Ue.REPEAT};void 0!==qe.sampler&&Object.assign(Ct,Re.json.samplers[qe.sampler]),Oe.push({image:Le[qe.source],sampler:Ct,uploaded:!1})}return Oe}(Re,Re.images),Oe=function(Re,Le){const Oe=[];for(const Ue of Re.json.meshes){const qe=[];for(const Oe of Ue.primitives)qe.push(ex(Oe,Re,Le));Oe.push(qe)}return Oe}(Re,Le),{scenes:Ue,scene:qe,nodes:Ct}=Re.json,Ot=Ue?Ue[qe||0].nodes:Ct,Jt=[];for(const Le of Ot)Jt.push(rx(Ct[Le],Re,Oe));return function(Re,Le,Oe){const Ue={},qe=new Set;for(let Ct=0;Ct<Re.length;Ct++){const Re=Oe[Le[Ct]];if(!Re.extras)continue;const Ot=Re.extras["mapbox:footprint:version"],Jt=Re.extras["mapbox:footprint:id"];(Ot||Jt)&&qe.add(Ct),"1.0.0"===Ot&&Jt&&(Ue[Jt]=Ct)}for(let Ct=0;Ct<Re.length;Ct++){if(qe.has(Ct))continue;const Ot=Re[Ct],Jt=Oe[Le[Ct]];if(!Jt.extras)continue;let Hr=null;Ot.id in Ue&&(Hr=sx(Re[Ue[Ot.id]].meshes,Ot.matrix)),Hr||(Hr=ix(Jt)),Hr&&(Ot.footprint=nx(Hr))}if(qe.size>0){const Le=Array.from(qe.values()).sort(((Re,Le)=>Re-Le));for(let Oe=Le.length-1;Oe>=0;Oe--)Re.splice(Le[Oe],1)}}(Jt,Ot,Re.json.nodes),Jt}function ox(Re){Re.heightmap=new Float32Array(4096),Re.heightmap.fill(-1);const Le=Re.vertexArray.float32,Oe=Re.aabb.min[0]-1,Ue=Re.aabb.min[1]-1,qe=xv/(Re.aabb.max[0]-Oe+2),Ct=xv/(Re.aabb.max[1]-Ue+2);for(let Ot=0;Ot<Le.length;Ot+=3){const Jt=Le[Ot+2],Hr=(Le[Ot+0]-Oe)*qe|0,Jr=(Le[Ot+1]-Ue)*Ct|0;Jt>Re.heightmap[Jr*xv+Hr]&&(Re.heightmap[Jr*xv+Hr]=Jt)}}function lx(Re,Le){const Oe={};Oe.indexArray=new Da,Oe.indexArray.reserve(4*Re.length),Oe.vertexArray=new Aa,Oe.vertexArray.reserve(10*Re.length),Oe.colorArray=new Ma,Oe.vertexArray.reserve(10*Re.length);let Ue=0;for(const qe of Re){const Re=Math.min(10,Math.max(4,1.3*qe.height))*Le,Ct=[-qe.normal[1],qe.normal[0],0],Ot=Math.min(.29,.1*qe.width/qe.depth),Jt=qe.width-2*qe.depth*Le*(Ot+.01),Hr=Io.vec3.scaleAndAdd([],qe.pos,Ct,Jt/2),Jr=Io.vec3.scaleAndAdd([],qe.pos,Ct,-Jt/2),Ln=[Hr[0],Hr[1],Hr[2]+qe.height],Nn=[Jr[0],Jr[1],Jr[2]+qe.height],$n=Io.vec3.scaleAndAdd([],qe.normal,Ct,Ot);Io.vec3.scale($n,$n,Re);const Gn=Io.vec3.scaleAndAdd([],qe.normal,Ct,-Ot);Io.vec3.scale(Gn,Gn,Re),Io.vec3.add($n,Hr,$n),Io.vec3.add(Gn,Jr,Gn),Hr[2]+=.1,Jr[2]+=.1,Oe.vertexArray.emplaceBack($n[0],$n[1],$n[2]),Oe.vertexArray.emplaceBack(Gn[0],Gn[1],Gn[2]),Oe.vertexArray.emplaceBack(Hr[0],Hr[1],Hr[2]),Oe.vertexArray.emplaceBack(Jr[0],Jr[1],Jr[2]),Oe.vertexArray.emplaceBack(Ln[0],Ln[1],Ln[2]),Oe.vertexArray.emplaceBack(Nn[0],Nn[1],Nn[2]),Oe.vertexArray.emplaceBack(Hr[0],Hr[1],Hr[2]),Oe.vertexArray.emplaceBack(Jr[0],Jr[1],Jr[2]),Oe.vertexArray.emplaceBack($n[0],$n[1],$n[2]),Oe.vertexArray.emplaceBack(Gn[0],Gn[1],Gn[2]);const qn=Jt/Re/2;Oe.colorArray.emplaceBack(-qn-Ot,-1,qn,.8),Oe.colorArray.emplaceBack(qn+Ot,-1,qn,.8),Oe.colorArray.emplaceBack(-qn,0,qn,1.3),Oe.colorArray.emplaceBack(qn,0,qn,1.3),Oe.colorArray.emplaceBack(qn+Ot,-.8,qn,.7),Oe.colorArray.emplaceBack(qn+Ot,-.8,qn,.7),Oe.colorArray.emplaceBack(0,0,qn,1.3),Oe.colorArray.emplaceBack(0,0,qn,1.3),Oe.colorArray.emplaceBack(qn+Ot,-1.2,qn,.8),Oe.colorArray.emplaceBack(qn+Ot,-1.2,qn,.8),Oe.indexArray.emplaceBack(6+Ue,4+Ue,8+Ue),Oe.indexArray.emplaceBack(7+Ue,9+Ue,5+Ue),Oe.indexArray.emplaceBack(0+Ue,1+Ue,2+Ue),Oe.indexArray.emplaceBack(1+Ue,3+Ue,2+Ue),Ue+=10}const qe={defined:!0,emissiveFactor:[0,0,0]},Ct={};return Ct.baseColorFactor=Pe.white,qe.pbrMetallicRoughness=Ct,Oe.material=qe,Oe.aabb=new yu([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),Oe}class ux{constructor(Re){this._stringToNumber={},this._numberToString=[];for(let Le=0;Le<Re.length;Le++){const Oe=Re[Le];this._stringToNumber[Oe]=Le,this._numberToString[Le]=Oe}}encode(Re){return this._stringToNumber[Re]}decode(Re){return this._numberToString[Re]}}const Ox=["id","tile","layer","source","sourceLayer","state"];class hx{constructor(Re,Le,Oe,Ue,qe){this.type="Feature",this._vectorTileFeature=Re,this._z=Le,this._x=Oe,this._y=Ue,this.properties=Re.properties,this.id=qe}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(Re){this._geometry=Re}toJSON(){const Re={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const Le of Ox)void 0!==this[Le]&&(Re[Le]=this[Le]);return Re}}class px{constructor(Re,Le){this.tileID=Re,this.x=Re.canonical.x,this.y=Re.canonical.y,this.z=Re.canonical.z,this.grid=new yp(id,16,0),this.featureIndexArray=new io,this.promoteId=Le,this.is3DTile=!1}insert(Re,Le,Oe,Ue,qe,Ct=0,Ot=0){const Jt=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(Oe,Ue,qe,Ct);const Hr=this.grid;for(let Re=0;Re<Le.length;Re++){const Oe=Le[Re],Ue=[1/0,1/0,-1/0,-1/0];for(let Re=0;Re<Oe.length;Re++){const Le=Oe[Re];Ue[0]=Math.min(Ue[0],Le.x),Ue[1]=Math.min(Ue[1],Le.y),Ue[2]=Math.max(Ue[2],Le.x),Ue[3]=Math.max(Ue[3],Le.y)}0!==Ot&&(Ue[0]-=Ot,Ue[1]-=Ot,Ue[2]+=Ot,Ue[3]+=Ot),Ue[0]<id&&Ue[1]<id&&Ue[2]>=0&&Ue[3]>=0&&Hr.insert(Jt,Ue[0],Ue[1],Ue[2],Ue[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Fg.VectorTile(new B_(this.rawTileData)).layers,this.sourceLayerCoder=new ux(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const Re in this.vtLayers)this.vtFeatures[Re]=[]}return this.vtLayers}query(Re,Le,Oe,Ue){this.loadVTLayers();const qe=Re.params||{},Ct=Hs(qe.filter),Ot=Re.tileResult,Jt=Re.transform,Hr=Ot.bufferedTilespaceBounds,Jr=this.grid.query(Hr.min.x,Hr.min.y,Hr.max.x,Hr.max.y,((Re,Le,Oe,Ue)=>jl(Ot.bufferedTilespaceGeometry,Re,Le,Oe,Ue)));Jr.sort(dx);let Ln=null;Jt.elevation&&Jr.length>0&&(Ln=ny.create(Jt.elevation,this.tileID));const Nn={};let $n;for(let Hr=0;Hr<Jr.length;Hr++){const Gn=Jr[Hr];if(Gn===$n)continue;$n=Gn;const qn=this.featureIndexArray.get(Gn);let Zn=null;if(this.is3DTile){const Re=this.bucketLayerIDs[0][0],Oe=Le[Re];if("model"!==Oe.type)continue;const{queryFeature:Ue,intersectionZ:qe}=Oe.queryIntersectsMatchingFeature(Ot,qn.featureIndex,Ct,Jt);Ue&&this.appendToResult(Nn,Re,qn.featureIndex,Ue,qe)}else this.loadMatchingFeature(Nn,qn,Ct,qe.layers,qe.availableImages,Le,Oe,Ue,((Le,Oe,Ue,qe=0)=>(Zn||(Zn=Il(Le,this.tileID.canonical,Re.tileTransform)),Oe.queryIntersectsFeature(Ot,Le,Ue,Zn,this.z,Re.transform,Re.pixelPosMatrix,Ln,qe))))}return Nn}loadMatchingFeature(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr){const{featureIndex:Jr,bucketIndex:Ln,sourceLayerIndex:Nn,layoutVertexArrayOffset:$n}=Le,Gn=this.bucketLayerIDs[Ln];if(Ue&&!function(Re,Le){for(let Oe=0;Oe<Re.length;Oe++)if(Le.indexOf(Re[Oe])>=0)return!0;return!1}(Ue,Gn))return;const qn=this.sourceLayerCoder.decode(Nn),Zn=this.vtLayers[qn].feature(Jr);if(Oe.needGeometry){const Re=Pl(Zn,!0);if(!Oe.filter(new Vs(this.tileID.overscaledZ),Re,this.tileID.canonical))return}else if(!Oe.filter(new Vs(this.tileID.overscaledZ),Zn))return;const Xn=this.getId(Zn,qn);for(let Le=0;Le<Gn.length;Le++){const Oe=Gn[Le];if(Ue&&Ue.indexOf(Oe)<0)continue;const Ln=Ct[Oe];if(!Ln)continue;let Nn={};void 0!==Xn&&Jt&&(Nn=Jt.getState(Ln.sourceLayer||"_geojsonTileLayer",Xn));const qn=!Hr||Hr(Zn,Ln,Nn,$n);if(!qn)continue;const Yn=new hx(Zn,this.z,this.x,this.y,Xn),_i=nt({},Ot[Oe]);_i.paint=fx(_i.paint,Ln.paint,Zn,Nn,qe),_i.layout=fx(_i.layout,Ln.layout,Zn,Nn,qe),Yn.layer=_i,this.appendToResult(Re,Oe,Jr,Yn,qn)}}appendToResult(Re,Le,Oe,Ue,qe){let Ct=Re[Le];void 0===Ct&&(Ct=Re[Le]=[]),Ct.push({featureIndex:Oe,feature:Ue,intersectionZ:qe})}lookupSymbolFeatures(Re,Le,Oe,Ue,qe,Ct,Ot,Jt){const Hr={};this.loadVTLayers();const Jr=Hs(qe);for(const qe of Re)this.loadMatchingFeature(Hr,{bucketIndex:Oe,sourceLayerIndex:Ue,featureIndex:qe,layoutVertexArrayOffset:0},Jr,Ct,Ot,Jt,Le);return Hr}loadFeature(Re){const{featureIndex:Le,sourceLayerIndex:Oe}=Re;this.loadVTLayers();const Ue=this.sourceLayerCoder.decode(Oe),qe=this.vtFeatures[Ue];if(qe[Le])return qe[Le];const Ct=this.vtLayers[Ue].feature(Le);return qe[Le]=Ct,Ct}hasLayer(Re){for(const Le of this.bucketLayerIDs)for(const Oe of Le)if(Re===Oe)return!0;return!1}getId(Re,Le){let Oe=Re.id;if(this.promoteId){const Ue="string"==typeof this.promoteId?this.promoteId:this.promoteId[Le];null!=Ue&&(Oe=Re.properties[Ue]),"boolean"==typeof Oe&&(Oe=Number(Oe))}return Oe}}function fx(Re,Le,Oe,Ue,qe){return ut(Re,((Re,Ct)=>{const Ot=Le instanceof js?Le.get(Ct):null;return Ot&&Ot.evaluate?Ot.evaluate(Oe,Ue,qe):Ot}))}function dx(Re,Le){return Le-Re}os(px,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const zx=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class yx{static from(Re){if(!(Re instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[Le,Oe]=new Uint8Array(Re,0,2);if(219!==Le)throw new Error("Data does not appear to be in a KDBush format.");const Ue=Oe>>4;if(1!==Ue)throw new Error(`Got v${Ue} data when expected v1.`);const qe=zx[15&Oe];if(!qe)throw new Error("Unrecognized array type.");const[Ct]=new Uint16Array(Re,2,1),[Ot]=new Uint32Array(Re,4,1);return new yx(Ot,Ct,qe,Re)}constructor(Re,Le=64,Oe=Float64Array,Ue){if(isNaN(Re)||Re<0)throw new Error(`Unpexpected numItems value: ${Re}.`);this.numItems=+Re,this.nodeSize=Math.min(Math.max(+Le,2),65535),this.ArrayType=Oe,this.IndexArrayType=Re<65536?Uint16Array:Uint32Array;const qe=zx.indexOf(this.ArrayType),Ct=2*Re*this.ArrayType.BYTES_PER_ELEMENT,Ot=Re*this.IndexArrayType.BYTES_PER_ELEMENT,Jt=(8-Ot%8)%8;if(qe<0)throw new Error(`Unexpected typed array class: ${Oe}.`);Ue&&Ue instanceof ArrayBuffer?(this.data=Ue,this.ids=new this.IndexArrayType(this.data,8,Re),this.coords=new this.ArrayType(this.data,8+Ot+Jt,2*Re),this._pos=2*Re,this._finished=!0):(this.data=new ArrayBuffer(8+Ct+Ot+Jt),this.ids=new this.IndexArrayType(this.data,8,Re),this.coords=new this.ArrayType(this.data,8+Ot+Jt,2*Re),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+qe]),new Uint16Array(this.data,2,1)[0]=Le,new Uint32Array(this.data,4,1)[0]=Re)}add(Re,Le){const Oe=this._pos>>1;return this.ids[Oe]=Oe,this.coords[this._pos++]=Re,this.coords[this._pos++]=Le,Oe}finish(){const Re=this._pos>>1;if(Re!==this.numItems)throw new Error(`Added ${Re} items when expected ${this.numItems}.`);return gx(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(Re,Le,Oe,Ue){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:qe,coords:Ct,nodeSize:Ot}=this,Jt=[0,qe.length-1,0],Hr=[];for(;Jt.length;){const Jr=Jt.pop()||0,Ln=Jt.pop()||0,Nn=Jt.pop()||0;if(Ln-Nn<=Ot){for(let Ot=Nn;Ot<=Ln;Ot++){const Jt=Ct[2*Ot],Jr=Ct[2*Ot+1];Jt>=Re&&Jt<=Oe&&Jr>=Le&&Jr<=Ue&&Hr.push(qe[Ot])}continue}const $n=Nn+Ln>>1,Gn=Ct[2*$n],qn=Ct[2*$n+1];Gn>=Re&&Gn<=Oe&&qn>=Le&&qn<=Ue&&Hr.push(qe[$n]),(0===Jr?Re<=Gn:Le<=qn)&&(Jt.push(Nn),Jt.push($n-1),Jt.push(1-Jr)),(0===Jr?Oe>=Gn:Ue>=qn)&&(Jt.push($n+1),Jt.push(Ln),Jt.push(1-Jr))}return Hr}within(Re,Le,Oe){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:Ue,coords:qe,nodeSize:Ct}=this,Ot=[0,Ue.length-1,0],Jt=[],Hr=Oe*Oe;for(;Ot.length;){const Jr=Ot.pop()||0,Ln=Ot.pop()||0,Nn=Ot.pop()||0;if(Ln-Nn<=Ct){for(let Oe=Nn;Oe<=Ln;Oe++)wx(qe[2*Oe],qe[2*Oe+1],Re,Le)<=Hr&&Jt.push(Ue[Oe]);continue}const $n=Nn+Ln>>1,Gn=qe[2*$n],qn=qe[2*$n+1];wx(Gn,qn,Re,Le)<=Hr&&Jt.push(Ue[$n]),(0===Jr?Re-Oe<=Gn:Le-Oe<=qn)&&(Ot.push(Nn),Ot.push($n-1),Ot.push(1-Jr)),(0===Jr?Re+Oe>=Gn:Le+Oe>=qn)&&(Ot.push($n+1),Ot.push(Ln),Ot.push(1-Jr))}return Jt}}function gx(Re,Le,Oe,Ue,qe,Ct){if(qe-Ue<=Oe)return;const Ot=Ue+qe>>1;xx(Re,Le,Ot,Ue,qe,Ct),gx(Re,Le,Oe,Ue,Ot-1,1-Ct),gx(Re,Le,Oe,Ot+1,qe,1-Ct)}function xx(Re,Le,Oe,Ue,qe,Ct){for(;qe>Ue;){if(qe-Ue>600){const Ot=qe-Ue+1,Jt=Oe-Ue+1,Hr=Math.log(Ot),Jr=.5*Math.exp(2*Hr/3),Ln=.5*Math.sqrt(Hr*Jr*(Ot-Jr)/Ot)*(Jt-Ot/2<0?-1:1);xx(Re,Le,Oe,Math.max(Ue,Math.floor(Oe-Jt*Jr/Ot+Ln)),Math.min(qe,Math.floor(Oe+(Ot-Jt)*Jr/Ot+Ln)),Ct)}const Ot=Le[2*Oe+Ct];let Jt=Ue,Hr=qe;for(bx(Re,Le,Ue,Oe),Le[2*qe+Ct]>Ot&&bx(Re,Le,Ue,qe);Jt<Hr;){for(bx(Re,Le,Jt,Hr),Jt++,Hr--;Le[2*Jt+Ct]<Ot;)Jt++;for(;Le[2*Hr+Ct]>Ot;)Hr--}Le[2*Ue+Ct]===Ot?bx(Re,Le,Ue,Hr):(Hr++,bx(Re,Le,Hr,qe)),Hr<=Oe&&(Ue=Hr+1),Oe<=Hr&&(qe=Hr-1)}}function bx(Re,Le,Oe,Ue){vx(Re,Oe,Ue),vx(Le,2*Oe,2*Ue),vx(Le,2*Oe+1,2*Ue+1)}function vx(Re,Le,Oe){const Ue=Re[Le];Re[Le]=Re[Oe],Re[Oe]=Ue}function wx(Re,Le,Oe,Ue){const qe=Re-Oe,Ct=Le-Ue;return qe*qe+Ct*Ct}Re.$=Ds,Re.A=class extends Nm{},Re.B=hr,Re.C=Be,Re.D=Ys,Re.E=Me,Re.F=Oi,Re.G=Di,Re.H=Fi,Re.I=Of,Re.J=Wi,Re.K=Zs,Re.L=Qi,Re.M=Hi,Re.N=Bn,Re.O=Cn,Re.P=Is,Re.Q=En,Re.R=iu,Re.S=yr,Re.T=lm,Re.U=Ju,Re.V=Nm,Re.W=Ws,Re.X=Ui,Re.Y=Li,Re.Z=function(Re){const Le=Re.value;let Oe=[];if(!Le)return Oe;const Ue=hr(Le);return"string"!==Ue?(Oe=Oe.concat([new Nm(Re.key,Le,`string expected, "${Ue}" found`)]),Oe):(qm(Le,!0)||(Oe=Oe.concat([new Nm(Re.key,Le,`invalid url "${Le}"`)])),Oe)},Re._=Fp,Re.a=function(Re){return Al.API_CDN_URL_REGEX.test(Re)},Re.a$=qa,Re.a0=Gs,Re.a1=Ns,Re.a2=class{constructor(Re){this.specification=Re}possiblyEvaluate(Re,Le){return yt(Re.expression.evaluate(Le))}interpolate(Re,Le,Oe){return{x:ke(Re.x,Le.x,Oe),y:ke(Re.y,Le.y,Oe),z:ke(Re.z,Le.z,Oe),azimuthal:ke(Re.azimuthal,Le.azimuthal,Oe),polar:ke(Re.polar,Le.polar,Oe)}}},Re.a3=Vs,Re.a4=Ji,Re.a5=xl,Re.a6=Io,Re.a7=tt,Re.a8=js,Re.a9=Du,Re.aA=ru,Re.aB=mm,Re.aC=wm,Re.aD=fm,Re.aE=function(Re,Le){const Oe=document.createElement("video");Oe.muted=!0,Oe.onloadstart=function(){Le(null,Oe)};for(let Le=0;Le<Re.length;Le++){const Ue=document.createElement("source");ae(Re[Le])||(Oe.crossOrigin="Anonymous"),Ue.src=Re[Le],Oe.appendChild(Ue)}return{cancel:()=>{}}},Re.aF=um,Re.aG=function(Re){return fetch(Re).then((Re=>Re.arrayBuffer())).then((Le=>Jg(Le,0,Re)))},Re.aH=ax,Re.aI=class{constructor(Re,Le,Oe,Ue){this.id=Re,this.position=null!=Le?new rl(Le[0],Le[1]):new rl(0,0),this.orientation=null!=Oe?Oe:[0,0,0],this.nodes=Ue,this.uploaded=!1,this.aabb=new yu([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(Re,Le){if(Io.mat4.multiply(Re.matrix,Le,Re.matrix),Re.meshes)for(const Le of Re.meshes){const Oe=yu.applyTransformFast(Le.aabb,Re.matrix);this.aabb.encapsulate(Oe)}if(Re.children)for(const Le of Re.children)this._applyTransformations(Le,Re.matrix)}computeBoundsAndApplyParent(){const Re=Io.mat4.identity([]);for(const Le of this.nodes)this._applyTransformations(Le,Re)}computeModelMatrix(Re,Le,Oe,Ue,qe,Ct,Ot=!1){Km(this.matrix,this,Re.transform,this.position,Le,Oe,Ue,qe,Ct,Ot)}upload(Re){if(!this.uploaded){for(const Le of this.nodes)ty(Le,Re);for(const Re of this.nodes)ey(Re);this.uploaded=!0}}destroy(){for(const Re of this.nodes)ry(Re)}},Re.aJ=ot,Re.aK=yd,Re.aL=cl,Re.aM=hl,Re.aN=va,Re.aO=Da,Re.aP=st,Re.aQ=Ha,Re.aR=Zd,Re.aS=function(){Dp.isLoading()||Dp.isLoaded()||"deferred"!==Ts()||Es()},Re.aT=Hs,Re.aU=Pl,Re.aV=hx,Re.aW=xt,Re.aX=wp,Re.aY=Fc,Re.aZ=Il,Re.a_=xa,Re.aa=ke,Re.ab=id,Re.ac=Te,Re.ad=class{constructor(Re){this.specification=Re}possiblyEvaluate(Re,Le){return function([Re,Le]){const Oe=yt([1,Re,Le]);return{x:Oe.x,y:Oe.y,z:Oe.z}}(Re.expression.evaluate(Le))}interpolate(Re,Le,Oe){return{x:ke(Re.x,Le.x,Oe),y:ke(Re.y,Le.y,Oe),z:ke(Re.z,Le.z,Oe)}}},Re.ae=function(Re,Le,Oe=0,Ue=!0){const qe=new Is(Oe,Oe),Ct=Re.sub(qe),Ot=Le.add(qe),Jt=[Ct,new Is(Ot.x,Ct.y),Ot,new Is(Ct.x,Ot.y)];return Ue&&Jt.push(Ct.clone()),Jt},Re.af=function(Re,Le){const Oe=[];for(let Ue=0;Ue<Re.length;Ue++){const qe=et(Ue-1,-1,Re.length-1),Ct=et(Ue+1,-1,Re.length-1),Ot=Re[Ue],Jt=Re[Ct],Hr=Re[qe].sub(Ot).unit(),Jr=Jt.sub(Ot).unit(),Ln=Jr.angleWithSep(Hr.x,Hr.y),Nn=Hr.add(Jr).unit().mult(-1*Le/Math.sin(Ln/2));Oe.push(Ot.add(Nn))}return Oe},Re.ag=gd,Re.ah=jl,Re.ai=function(Re,Le,Oe=0){return Io.vec3.fromValues(((Le.x-Oe)*Re.scale-Re.x)*id,(Le.y*Re.scale-Re.y)*id,pl(Le.z,Le.y))},Re.aj=uu,Re.ak=Sp,Re.al=function(Re){let Le=1/0,Oe=1/0,Ue=-1/0,qe=-1/0;for(const Ct of Re)Le=Math.min(Le,Ct.x),Oe=Math.min(Oe,Ct.y),Ue=Math.max(Ue,Ct.x),qe=Math.max(qe,Ct.y);return{min:new Is(Le,Oe),max:new Is(Ue,qe)}},Re.am=ol,Re.an=Ul,Re.ao=vl,Re.ap=Q,Re.aq=pf,Re.ar=function(Re,Le){const Oe={};for(let Ue=0;Ue<Le.length;Ue++){const qe=Le[Ue];qe in Re&&(Oe[qe]=Re[qe])}return Oe},Re.as=nl,Re.at=ll,Re.au=class{constructor(Re){this.entries={},this.scheduler=Re}request(Re,Le,Oe,Ue){const qe=this.entries[Re]=this.entries[Re]||{callbacks:[]};if(qe.result){const[Re,Oe]=qe.result;return this.scheduler?this.scheduler.add((()=>{Ue(Re,Oe)}),Le):Ue(Re,Oe),()=>{}}return qe.callbacks.push(Ue),qe.cancel||(qe.cancel=Oe(((Oe,Ue)=>{qe.result=[Oe,Ue];for(const Re of qe.callbacks)this.scheduler?this.scheduler.add((()=>{Re(Oe,Ue)}),Le):Re(Oe,Ue);setTimeout((()=>delete this.entries[Re]),3e3)}))),()=>{qe.result||(qe.callbacks=qe.callbacks.filter((Re=>Re!==Ue)),qe.callbacks.length||(qe.cancel(),delete this.entries[Re]))}}},Re.av=ua,Re.aw=function(Re,Le,Oe){const Ue=JSON.stringify(Re.request);return Re.data&&(this.deduped.entries[Ue]={result:[null,Re.data]}),this.deduped.request(Ue,{type:"parseTile",isSymbolTile:Re.isSymbolTile,zoom:Re.tileZoom},(Le=>{const Ue=se(Re.request,((Re,Ue,qe,Ct)=>{Re?Le(Re):Ue&&Le(null,{vectorTile:Oe?void 0:new Fg.VectorTile(new B_(Ue)),rawData:Ue,cacheControl:qe,expires:Ct})}));return()=>{Ue.cancel(),Le()}}),Le)},Re.ax=function(Re){Wc++,Wc>Nc&&(Re.getActor().send("enforceCacheSizeLimit",Oc),Wc=0)},Re.ay=Rt,Re.az=function(Re){return Re<=1?1:Math.pow(2,Math.floor(Math.log(Re)/Math.LN2))},Re.b=function(Re){return Al.API_FONTS_REGEX.test(Re)},Re.b$=function(Re){const{x:Le,y:Oe}=Re.point,{lng:Ue,lat:qe}=Re._center;return Ru(Le,Oe,Re.worldSize,Ue,qe)},Re.b0=Om,Re.b1=co,Re.b2=uc,Re.b3=rv,Re.b4=function(Re,Le){const Oe=Du(Le.zoom);if(0===Oe)return _u(Re);const Ue=Iu(Re),qe=Pu(Ue),Ct=ol(Ue.getWest())*Le.worldSize,Ot=ol(Ue.getEast())*Le.worldSize,Jt=ll(Ue.getNorth())*Le.worldSize,Hr=ll(Ue.getSouth())*Le.worldSize,Jr=[Ct,Jt,0],Ln=[Ot,Jt,0],Nn=[Ct,Hr,0],$n=[Ot,Hr,0],Gn=Io.mat4.invert([],Le.globeMatrix);return Io.vec3.transformMat4(Jr,Jr,Gn),Io.vec3.transformMat4(Ln,Ln,Gn),Io.vec3.transformMat4(Nn,Nn,Gn),Io.vec3.transformMat4($n,$n,Gn),qe[0]=Mu(qe[0],Nn,Oe),qe[1]=Mu(qe[1],$n,Oe),qe[2]=Mu(qe[2],Ln,Oe),qe[3]=Mu(qe[3],Jr,Oe),yu.fromPoints(qe)},Re.b5=Eu,Re.b6=zu,Re.b7=Mu,Re.b8=ba,Re.b9=Lm,Re.bA=et,Re.bB=Y,Re.bC=wt,Re.bD=ul,Re.bE=function(Re,Le,Oe){Re[4*Le+0]=Oe[0],Re[4*Le+1]=Oe[1],Re[4*Le+2]=Oe[2],Re[4*Le+3]=Oe[3]},Re.bF=Po,Re.bG=_o,Re.bH=Mo,Re.bI=wo,Re.bJ=vo,Re.bK=rl,Re.bL=Fd,Re.bM=eu,Re.bN=mu,Re.bO=Sm,Re.bP=tu,Re.bQ=Su,Re.bR=function(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr){if("globe"===Hr.name)return Su(Re,Le,new tu(Oe,Ue,qe),!1);const Jr=yd({z:Oe,x:Ue,y:qe},Hr);return new yu([(Ct+Jr.x/Jr.scale)*Le,Le*(Jr.y/Jr.scale),Ot],[(Ct+Jr.x2/Jr.scale)*Le,Le*(Jr.y2/Jr.scale),Jt])},Re.bS=function(Re,Le,Oe){let Ue=0;for(let Oe=0;Oe<2;++Oe){const qe=0;Re[Oe]>qe&&(Ue+=(Re[Oe]-qe)*(Re[Oe]-qe)),Le[Oe]<qe&&(Ue+=(qe-Le[Oe])*(qe-Le[Oe]))}return Ue},Re.bT=im,Re.bU=gf,Re.bV=function(Re){const Le=Io.mat4.identity(new Float64Array(16));Io.mat4.multiply(Le,Re.pixelMatrix,Re.globeMatrix);const Oe=[0,$f,0],Ue=[0,Gf,0];return Io.vec3.transformMat4(Oe,Oe,Le),Io.vec3.transformMat4(Ue,Ue,Le),[Oe[0]>0&&Oe[0]<=Re.width&&Oe[1]>0&&Oe[1]<=Re.height&&!Fu(Re,new rl(Re.center.lat,90)),Ue[0]>0&&Ue[0]<=Re.width&&Ue[1]>0&&Ue[1]<=Re.height&&!Fu(Re,new rl(Re.center.lat,-90))]},Re.bW=function(Re,Le){const{scale:Oe}=Re.tileTransform,Ue=Oe*id/(Re.tileSize*Math.pow(2,Le.zoom-Re.tileID.overscaledZ+Re.tileID.canonical.z));return Io.mat2.scale(new Float32Array(4),Le.inverseAdjustmentMatrix,[Ue,Ue])},Re.bX=Im,Re.bY=Am,Re.bZ=function(Re){const Le=Am(Re,!0);return Io.mat2.invert([],[Le[0],Le[1],Le[4],Le[5]])},Re.b_=cu,Re.ba=_g,Re.bb=B_,Re.bc=se,Re.bd=function(Re){const Le=[];for(const Oe in Re)Le.push(Re[Oe]);return Le},Re.be=function(Re,Le){const Oe=[];for(const Ue in Re)Ue in Le||Oe.push(Ue);return Oe},Re.bf=rt,Re.bg=["type","source","source-layer","minzoom","maxzoom","filter","layout"],Re.bh=$,Re.bi=function(Re,Le){const{x:Oe,y:Ue}=Re.point,qe=Ru(Oe,Ue,Re.worldSize/Re._pixelsPerMercatorPixel,0,0);return Io.mat4.multiply(qe,qe,Bu(_u(Le)))},Re.bj=Zp,Re.bk=j_,Re.bl=Yp,Re.bm=function(Re,Le,Oe,Ue,qe){const Ct=5*Le+2;Re.float32[Ct+0]=Oe,Re.float32[Ct+1]=Ue,Re.float32[Ct+2]=qe},Re.bn=$d,Re.bo=Df,Re.bp=El,Re.bq=k_,Re.br=gh,Re.bs=_v,Re.bt=Ih,Re.bu=Ph,Re.bv=ad,Re.bw=sd,Re.bx=Af,Re.by=yx,Re.bz=Pe,Re.c=zt,Re.c$=Cm,Re.c0=Z,Re.c1=nu,Re.c2=ff,Re.c3=function(Re){const Le=Math.round((Re+45+360)%360/90)%4;return ha[Le]},Re.c4=45,Re.c5=al,Re.c6=Ao,Re.c7=function(Re,Le,Oe){const Ue=Math.sqrt(Re*Re+Le*Le+Oe*Oe),qe=Ue>0?Math.acos(Oe/Ue)*ta:0;let Ct=0!==Re||0!==Le?Math.atan2(-Le,-Re)*ta+90:0;return Ct<0&&(Ct+=360),[Ue,Ct,qe]},Re.c8=gl,Re.c9=yu,Re.cA=function(Re){const Le=im-5;Re=Q(Re,-Le,Le)/Le*90;const Oe=Math.pow(Math.abs(Math.sin(Y(Re))),3);return Math.round(Oe*(jf.length-1))},Re.cB=function(Re,Le,Oe,Ue){const qe=Le.getNorth(),Ct=Le.getSouth(),Ot=Le.getWest(),Jt=Le.getEast(),Hr=1<<Re.z,Jr=Jt-Ot,Ln=qe-Ct,Nn=Jr/Ff,$n=-Ln/jf[Oe],Gn=[0,Nn,0,$n,0,0,qe,Ot,0];if(Re.z>0){const Re=180/Ue;Io.mat3.multiply(Gn,Gn,[Re/Jr+1,0,0,0,Re/Ln+1,0,-.5*Re/Nn,.5*Re/$n,1])}return Gn[2]=Hr,Gn[5]=Re.x,Gn[8]=Re.y,Gn},Re.cC=_u,Re.cD=function(Re,Le,Oe){const Ue=Io.mat4.identity(new Float64Array(16)),qe=(Le/(1<<Re)-.5)*Math.PI*2;return Io.mat4.rotateY(Ue,Oe.globeMatrix,qe),Float32Array.from(Ue)},Re.cE=class{isDataAvailableAtPoint(Re){const Le=this._source();if(this.isUsingMockSource()||!Le||Re.y<0||Re.y>1)return!1;const Oe=Le.getSource().maxzoom,Ue=1<<Oe,qe=Math.floor(Re.x),Ct=Math.floor((Re.x-qe)*Ue),Ot=Math.floor(Re.y*Ue),Jt=this.findDEMTileFor(new ru(Oe,qe,Oe,Ct,Ot));return!(!Jt||!Jt.dem)}getAtPointOrZero(Re,Le=0){return this.getAtPoint(Re,Le)||0}getAtPoint(Re,Le,Oe=!0){if(this.isUsingMockSource())return null;null==Le&&(Le=null);const Ue=this._source();if(!Ue)return Le;if(Re.y<0||Re.y>1)return Le;const qe=Ue.getSource().maxzoom,Ct=1<<qe,Ot=Math.floor(Re.x),Jt=Re.x-Ot,Hr=new ru(qe,Ot,qe,Math.floor(Jt*Ct),Math.floor(Re.y*Ct)),Jr=this.findDEMTileFor(Hr);if(!Jr||!Jr.dem)return Le;const Ln=Jr.dem,Nn=1<<Jr.tileID.canonical.z,$n=(Jt*Nn-Jr.tileID.canonical.x)*Ln.dim,Gn=(Re.y*Nn-Jr.tileID.canonical.y)*Ln.dim,qn=Math.floor($n),Zn=Math.floor(Gn);return(Oe?this.exaggeration():1)*ke(ke(Ln.get(qn,Zn),Ln.get(qn,Zn+1),Gn-Zn),ke(Ln.get(qn+1,Zn),Ln.get(qn+1,Zn+1),Gn-Zn),$n-qn)}getAtTileOffset(Re,Le,Oe){const Ue=1<<Re.canonical.z;return this.getAtPointOrZero(new xl(Re.wrap+(Re.canonical.x+Le/id)/Ue,(Re.canonical.y+Oe/id)/Ue))}getAtTileOffsetFunc(Re,Le,Oe,Ue){return qe=>{const Ct=this.getAtTileOffset(Re,qe.x,qe.y),Ot=Ue.upVector(Re.canonical,qe.x,qe.y),Jt=Ue.upVectorScale(Re.canonical,Le,Oe).metersToTile;return Io.vec3.scale(Ot,Ot,Ct*Jt),Ot}}getForTilePoints(Re,Le,Oe,Ue){if(this.isUsingMockSource())return!1;const qe=ny.create(this,Re,Ue);return!!qe&&(Le.forEach((Re=>{Re[2]=this.exaggeration()*qe.getElevationAt(Re[0],Re[1],Oe)})),!0)}getMinMaxForTile(Re){if(this.isUsingMockSource())return null;const Le=this.findDEMTileFor(Re);if(!Le||!Le.dem)return null;const Oe=Le.dem.tree,Ue=Le.tileID,qe=1<<Re.canonical.z-Ue.canonical.z;let Ct=Re.canonical.x/qe-Ue.canonical.x,Ot=Re.canonical.y/qe-Ue.canonical.y,Jt=0;for(let Le=0;Le<Re.canonical.z-Ue.canonical.z&&!Oe.leaves[Jt];Le++){Ct*=2,Ot*=2;const Re=2*Math.floor(Ot)+Math.floor(Ct);Jt=Oe.childOffsets[Jt]+Re,Ct%=1,Ot%=1}return{min:this.exaggeration()*Oe.minimums[Jt],max:this.exaggeration()*Oe.maximums[Jt]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(Re,Le,Oe){throw new Error("Pure virtual method called.")}pointCoordinate(Re){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(Re){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const Re=this.visibleDemTiles;if(0===Re.length)return null;let Le=!1,Oe=Number.MAX_VALUE,Ue=Number.MIN_VALUE;for(const qe of Re){const Re=this.getMinMaxForTile(qe.tileID);Re&&(Oe=Math.min(Oe,Re.min),Ue=Math.max(Ue,Re.max),Le=!0)}return Le?{min:Oe,max:Ue}:null}},Re.cF=sc,Re.cG=gu,Re.cH=function(Re,Le){return[Math.pow(Re[0],2.2)*Le,Math.pow(Re[1],2.2)*Le,Math.pow(Re[2],2.2)*Le]},Re.cI=Cu,Re.cJ=St,Re.cK=At,Re.cL=256,Re.cM=function(Re,Le){const Oe=[0,0,0],Ue=Eu(_u(Le.canonical));return Io.vec3.transformMat4(Oe,Oe,Ue),Io.vec3.transformMat4(Oe,Oe,Re),Oe},Re.cN=Re=>({u_camera_to_center_distance:new wo(Re),u_extrude_scale:new To(Re),u_device_pixel_ratio:new wo(Re),u_matrix:new Po(Re),u_inv_rot_matrix:new Po(Re),u_merc_center:new _o(Re),u_tile_id:new Mo(Re),u_zoom_transition:new wo(Re),u_up_dir:new Mo(Re),u_emissive_strength:new wo(Re)}),Re.cO=Re=>({u_matrix:new Po(Re),u_pixels_to_tile_units:new To(Re),u_device_pixel_ratio:new wo(Re),u_units_to_pixels:new _o(Re),u_dash_image:new vo(Re),u_gradient_image:new vo(Re),u_image_height:new wo(Re),u_texsize:new _o(Re),u_tile_units_to_pixels:new wo(Re),u_alpha_discard_threshold:new wo(Re),u_trim_offset:new _o(Re),u_trim_fade_range:new _o(Re),u_trim_color:new Ao(Re),u_emissive_strength:new wo(Re)}),Re.cP=Re=>({u_matrix:new Po(Re),u_texsize:new _o(Re),u_pixels_to_tile_units:new To(Re),u_device_pixel_ratio:new wo(Re),u_image:new vo(Re),u_units_to_pixels:new _o(Re),u_tile_units_to_pixels:new wo(Re),u_alpha_discard_threshold:new wo(Re),u_trim_offset:new _o(Re)}),Re.cQ=Ca,Re.cR=I_,Re.cS=P_,Re.cT=qu,Re.cU=(Re,Le,Oe,Ue,qe,Ct)=>{const Ot=Re.transform,Jt="globe"===Ot.projection.name;let Hr;if("map"===Ct.paint.get("circle-pitch-alignment"))if(Jt){const Re=Cu(Ot.zoom,Le.canonical)*Ot._pixelsPerMercatorPixel;Hr=Float32Array.from([Re,0,0,Re])}else Hr=Ot.calculatePixelsToTileUnitsMatrix(Oe);else Hr=new Float32Array([Ot.pixelsToGLUnits[0],0,0,Ot.pixelsToGLUnits[1]]);const Jr={u_camera_to_center_distance:Re.transform.getCameraToCenterDistance(Ot.projection),u_matrix:Re.translatePosMatrix(Le.projMatrix,Oe,Ct.paint.get("circle-translate"),Ct.paint.get("circle-translate-anchor")),u_device_pixel_ratio:oc.devicePixelRatio,u_extrude_scale:Hr,u_inv_rot_matrix:Wm,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:Ct.paint.get("circle-emissive-strength")};if(Jt){Jr.u_inv_rot_matrix=Ue,Jr.u_merc_center=qe,Jr.u_tile_id=[Le.canonical.x,Le.canonical.y,1<<Le.canonical.z],Jr.u_zoom_transition=Du(Ot.zoom);const Re=qe[0]*id,Oe=qe[1]*id;Jr.u_up_dir=Ot.projection.upVector(new tu(0,0,0),Re,Oe)}return Jr},Re.cV=zp,Re.cW=(Re,Le,Oe,Ue,qe,Ct)=>{const Ot=Re.transform;return{u_matrix:Pp(Re,Le,Oe,Ue),u_texsize:Le.imageAtlasTexture?Le.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:Ot.calculatePixelsToTileUnitsMatrix(Le),u_device_pixel_ratio:qe,u_image:0,u_tile_units_to_pixels:Ip(Le,Ot),u_units_to_pixels:[1/Ot.pixelsToGLUnits[0],1/Ot.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:Ct}},Re.cX=(Re,Le,Oe,Ue,qe,Ct,Ot)=>{const Jt=Re.transform,Hr=Jt.calculatePixelsToTileUnitsMatrix(Le);return{u_matrix:Pp(Re,Le,Oe,Ue),u_pixels_to_tile_units:Hr,u_device_pixel_ratio:Ct,u_units_to_pixels:[1/Jt.pixelsToGLUnits[0],1/Jt.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:qe,u_texsize:kp(Oe)&&Le.lineAtlasTexture?Le.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:Ip(Le,Re.transform),u_alpha_discard_threshold:0,u_trim_offset:Ot,u_trim_fade_range:Oe.paint.get("line-trim-fade-range"),u_trim_color:Oe.paint.get("line-trim-color").toRenderColor(Oe.lut).toArray01(),u_emissive_strength:Oe.paint.get("line-emissive-strength")}},Re.cY=at,Re.cZ=ac,Re.c_=rp,Re.ca=yt,Re.cb=function(Re){return[Math.pow(Re[0],1/2.2),Math.pow(Re[1],1/2.2),Math.pow(Re[2],1/2.2)]},Re.cc=function(Re){return Re({pluginStatus:Rp,pluginURL:Lp}),Op.on("pluginStateChange",Re),Re},Re.cd=by,Re.ce=kg,Re.cf=Xf,Re.cg=H_,Re.ch=ou,Re.ci=Ps,Re.cj=Ft,Re.ck=Xu,Re.cl=ht,Re.cm=function(Re){const Le=Re.indexOf(jp);return Le>=0?Re.slice(0,Le):Re},Re.cn=function(Re){return Re.indexOf(jp)>=0},Re.co=function(Re){const Le=Re.indexOf(jp);return Le>=0?Re.slice(Le+1):""},Re.cp=function(Re){const Le=[],Oe=Re.id;return void 0===Oe&&Le.push({message:`layers.${Oe}: missing required property "id"`}),void 0===Re.render&&Le.push({message:`layers.${Oe}: missing required method "render"`}),Re.renderingMode&&"2d"!==Re.renderingMode&&"3d"!==Re.renderingMode&&Le.push({message:`layers.${Oe}: property "renderingMode" must be either "2d" or "3d"`}),Le},Re.cq=function(Re,Le,Oe,Ue){return"custom"===Re.type?new _m(Re,Le):new Ev[Re.type](Re,Le,Oe,Ue)},Re.cr=ct,Re.cs=Op,Re.ct=ie,Re.cu=So,Re.cv=class extends bo{constructor(Re){super(Re),this.current=tf}set(Re,Le,Oe){if(this.fetchUniformLocation(Re,Le))for(let Re=0;Re<9;Re++)if(Oe[Re]!==this.current[Re]){this.current=Oe,this.gl.uniformMatrix3fv(this.location,!1,Oe);break}}},Re.cw=H,Re.cx=function(Re,Le,Oe){const Ue=Du(Oe.zoom),qe=Re.style.map._antialias,Ct=Le.options.extStandardDerivativesForceOff||Re.terrain&&Re.terrain.exaggeration()>0;return 0===Ue&&!qe&&!Ct},Re.cy=function(Re){const Le=Re.pixelsPerMeter,Oe=Le/ul(1,Re.center.lat),Ue=Io.mat4.identity(new Float64Array(16));return Io.mat4.translate(Ue,Ue,[Re.point.x,Re.point.y,0]),Io.mat4.scale(Ue,Ue,[Oe,Oe,Le]),Float32Array.from(Ue)},Re.cz=Iu,Re.d=function(Re){return Al.API_TILEJSON_REGEX.test(Re)},Re.d$=e,Re.d0=Zh,Re.d1=r_,Re.d2=450,Re.d3=7,Re.d4=nv,Re.d5=ya,Re.d6=Ya,Re.d7=256,Re.d8=Bu,Re.d9=Aa,Re.dA=Lu,Re.dB=function(Re){const Le=[0,0,0],Oe=Io.mat4.identity(new Float64Array(16));return Io.mat4.multiply(Oe,Re.pixelMatrix,Re.globeMatrix),Io.vec3.transformMat4(Le,Le,Oe),new Is(Le[0],Le[1])},Re.dC=function(Re,Le,Oe=!1){if(Rp===bp||Rp===Tp||Rp===Ap)throw new Error("setRTLTextPlugin cannot be called multiple times.");Lp=oc.resolveURL(Re),Rp=bp,Mp=Le,zs(),Oe||Es()},Re.dD=Ts,Re.dE=function(){kg().acquire(Qv)},Re.dF=function(){const Re=cx;Re&&(Re.isPreloaded()&&1===Re.numActive()?(Re.release(Qv),cx=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},Re.dG=Pg,Re.dH=function(Re){const Le=Gt();if(!Le)return;const Oe=Le.delete(lc);Re&&Oe.catch(Re).then((()=>Re()))},Re.dI=Jv,Re.dJ=Dg,Re.dK=function(Re){_x=oc.resolveURL(Re),Cx||(Cx=new by(kg(),new Me)),Cx.broadcast("setDracoUrl",_x)},Re.dL=Lg,Re.dM=function(Re){Sx=oc.resolveURL(Re),Cx||(Cx=new by(kg(),new Me)),Cx.broadcast("setMeshoptUrl",Sx)},Re.dN=os,Re.dO=nc,Re.dP=q_,Re.dQ=ux,Re.dR=px,Re.dS=gp,Re.dT=ut,Re.dU=Uf,Re.dV=function(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr,Ln){Re.createArrays(),Re.tilePixelRatio=id/(512*Re.overscaling),Re.compareText={},Re.iconsNeedLinear=!1;const Nn=Re.layers[0].layout,$n=Re.layers[0]._unevaluatedLayout._values,Gn={};if("composite"===Re.textSizeData.kind){const{minZoom:Le,maxZoom:Oe}=Re.textSizeData;Gn.compositeTextSizes=[$n["text-size"].possiblyEvaluate(new Vs(Le),Jt),$n["text-size"].possiblyEvaluate(new Vs(Oe),Jt)]}if("composite"===Re.iconSizeData.kind){const{minZoom:Le,maxZoom:Oe}=Re.iconSizeData;Gn.compositeIconSizes=[$n["icon-size"].possiblyEvaluate(new Vs(Le),Jt),$n["icon-size"].possiblyEvaluate(new Vs(Oe),Jt)]}Gn.layoutTextSize=$n["text-size"].possiblyEvaluate(new Vs(Hr+1),Jt),Gn.layoutIconSize=$n["icon-size"].possiblyEvaluate(new Vs(Hr+1),Jt),Gn.textMaxSize=$n["text-size"].possiblyEvaluate(new Vs(18),Jt);const qn="map"===Nn.get("text-rotation-alignment")&&"point"!==Nn.get("symbol-placement"),Zn=Nn.get("text-size");let Xn=!1;for(const Le of Re.features)if(Le.icon&&Le.icon.nameSecondary){Xn=!0;break}for(const Ct of Re.features){const Hr=Nn.get("text-font").evaluate(Ct,{},Jt).join(","),$n=Zn.evaluate(Ct,{},Jt),Yn=Gn.layoutTextSize.evaluate(Ct,{},Jt),_i=(Gn.layoutIconSize.evaluate(Ct,{},Jt),{horizontal:{},vertical:void 0}),vi=Ct.text;let xi,bi=[0,0];if(vi){const Ue=vi.toString(),Ot=Nn.get("text-letter-spacing").evaluate(Ct,{},Jt)*k_,Jr=Nn.get("text-line-height").evaluate(Ct,{},Jt)*k_,Ln=ds(Ue)?Ot:0,Gn=Nn.get("text-anchor").evaluate(Ct,{},Jt),Zn=Nn.get("text-variable-anchor");if(!Zn){const Re=Nn.get("text-radial-offset").evaluate(Ct,{},Jt);bi=Re?sd(Gn,[Re*k_,Z_]):Nn.get("text-offset").evaluate(Ct,{},Jt).map((Re=>Re*k_))}let Xn=qn?"center":Nn.get("text-justify").evaluate(Ct,{},Jt);const xi="point"===Nn.get("symbol-placement"),Pi=xi?Nn.get("text-max-width").evaluate(Ct,{},Jt)*k_:1/0,M=Ct=>{Re.allowVerticalPlacement&&fs(Ue)&&(_i.vertical=yf(vi,Le,Oe,qe,Hr,Pi,Jr,Gn,Ct,Ln,bi,j_.vertical,!0,Yn,$n))};if(!qn&&Zn){const Re="auto"===Xn?Zn.map((Re=>ad(Re))):[Xn];let Ue=!1;for(let Ct=0;Ct<Re.length;Ct++){const Ot=Re[Ct];if(!_i.horizontal[Ot])if(Ue)_i.horizontal[Ot]=_i.horizontal[0];else{const Re=yf(vi,Le,Oe,qe,Hr,Pi,Jr,"center",Ot,Ln,bi,j_.horizontal,!1,Yn,$n);Re&&(_i.horizontal[Ot]=Re,Ue=1===Re.positionedLines.length)}}M("left")}else{if("auto"===Xn&&(Xn=ad(Gn)),xi||Nn.get("text-writing-mode").indexOf("horizontal")>=0||!fs(Ue)){const Re=yf(vi,Le,Oe,qe,Hr,Pi,Jr,Gn,Xn,Ln,bi,j_.horizontal,!1,Yn,$n);Re&&(_i.horizontal[Xn]=Re)}M(xi?"left":Xn)}}let Pi=!1;if(Ct.icon&&Ct.icon.namePrimary){const Le=Ue[Ct.icon.namePrimary];Le&&(xi=If(qe[Ct.icon.namePrimary],Ct.icon.nameSecondary?qe[Ct.icon.nameSecondary]:void 0,Nn.get("icon-offset").evaluate(Ct,{},Jt),Nn.get("icon-anchor").evaluate(Ct,{},Jt)),Pi=Le.sdf,void 0===Re.sdfIcons?Re.sdfIcons=Le.sdf:Re.sdfIcons!==Le.sdf&&ft("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Le.pixelRatio!==Re.pixelRatio||0!==Nn.get("icon-rotate").constantOr(1))&&(Re.iconsNeedLinear=!0))}const lo=hd(_i.horizontal)||_i.vertical;Re.iconsInText||(Re.iconsInText=!!lo&&lo.iconsInText),(lo||xi)&&od(Re,Ct,_i,xi,Ue,Gn,Yn,0,bi,Pi,Ot,Jt,Jr,Ln,Xn)}Ct&&Re.generateCollisionDebugBuffers(Hr,Re.collisionBoxArray)},Re.dW=Fg,Re.dX=Ey,Re.dY=N,Re.dZ=uh,Re.d_=af,Re.da=Ua,Re.db=ja,Re.dc=function(Re,Le,Oe,Ue,qe){return Q((Re-Le)/(Oe-Le)*(qe-Ue)+Ue,Ue,qe)},Re.dd=Ii,Re.de=ml,Re.df=class{constructor(Re,Le,Oe,Ue){this.context=Re,this.format=Ue,this.size=Oe,this.texture=Re.gl.createTexture();const[qe,Ct,Ot]=this.size,{gl:Jt}=Re;Jt.bindTexture(Jt.TEXTURE_3D,this.texture),Re.pixelStoreUnpackFlipY.set(!1),Re.pixelStoreUnpack.set(1),Re.pixelStoreUnpackPremultiplyAlpha.set(!1),Jt.texImage3D(Jt.TEXTURE_3D,0,this.format,qe,Ct,Ot,0,am(this.format),om(this.format),Le.data)}bind(Re,Le){const{context:Oe}=this,{gl:Ue}=Oe;Ue.bindTexture(Ue.TEXTURE_3D,this.texture),Re!==this.minFilter&&(Ue.texParameteri(Ue.TEXTURE_3D,Ue.TEXTURE_MAG_FILTER,Re),Ue.texParameteri(Ue.TEXTURE_3D,Ue.TEXTURE_MIN_FILTER,Re),this.minFilter=Re),Le!==this.wrapS&&(Ue.texParameteri(Ue.TEXTURE_3D,Ue.TEXTURE_WRAP_S,Le),Ue.texParameteri(Ue.TEXTURE_3D,Ue.TEXTURE_WRAP_T,Le),this.wrapS=Le)}destroy(){const{gl:Re}=this.context;Re.deleteTexture(this.texture),this.texture=null}},Re.dg=Bm,Re.dh=[1,1,1],Re.di=ny,Re.dj=bv,Re.dk=Ea,Re.dl=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new Is(1/0,1/0),max:new Is(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(Re,Le=!1){const Oe=_h(new Is(0,0),new Is(id,id),Re),Ue=[];if(Le&&!vh(Oe,this._globalClipBounds))return Ue;for(const Le of this._activeRegions){if(Le.hiddenByOverlap)continue;if(!vh(Oe,Le))continue;const qe=Mh(Le.min,Le.max,Re);Ue.push({min:qe.min,max:qe.max,sourceId:this._sourceIds[Le.priority],footprint:Le.footprint,footprintTileId:Le.tileId,order:Le.order,clipMask:Le.clipMask,clipScope:Le.clipScope})}return Ue}setSources(Re){this._setSources(Re.map((Re=>({getSourceId:()=>Re.cache.id,getFootprints:()=>{const Le=[];for(const Oe of Re.cache.getVisibleCoordinates()){const Ue=Re.cache.getTile(Oe).buckets[Re.layer];Ue&&Ue.updateFootprints(Oe.toUnwrapped(),Le)}return Le},getOrder:()=>Re.order,getClipMask:()=>Re.clipMask,getClipScope:()=>Re.clipScope}))))}_addSource(Re){const Le=Re.getFootprints();if(0===Le.length)return;const Oe=Re.getOrder(),Ue=Re.getClipMask(),qe=Re.getClipScope();for(const Re of Le){if(!Re.footprint)continue;const Le=_h(Re.footprint.min,Re.footprint.max,Re.id);this._activeRegions.push({min:Le.min,max:Le.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:Re.id,footprint:Re.footprint,order:Oe,clipMask:Ue,clipScope:qe})}this._sourceIds.push(Re.getSourceId())}_computeReplacement(){this._activeRegions.sort(((Re,Le)=>Re.priority-Le.priority||xh(Re.min,Le.min)||xh(Re.max,Le.max)||Re.order-Le.order||Re.clipMask-Le.clipMask||function(Re,Le){const r=(Re,Le)=>Re+Le;return Re.length-Le.length||Re.reduce(r,"").localeCompare(Le.reduce(r,""))}(Re.clipScope,Le.clipScope)));let Re=this._activeRegions.length!==this._prevRegions.length;if(!Re){let Le=0;for(;!Re&&Le!==this._activeRegions.length;){const Oe=this._activeRegions[Le],Ue=this._prevRegions[Le];Re=Oe.priority!==Ue.priority||!bh(Oe,Ue)||Oe.order!==Ue.order||Oe.clipMask!==Ue.clipMask||!$(Oe.clipScope,Ue.clipScope),++Le}}if(Re){++this._updateTime;for(const Re of this._activeRegions)Re.order!==Ng&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,Re.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,Re.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,Re.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,Re.max.y));const t=Re=>{const Le=this._activeRegions;if(Re>=Le.length)return Re;const Oe=Le[Re].priority;for(;Re<Le.length&&Le[Re].priority===Oe;)++Re;return Re};if(this._sourceIds.length>1){let Re=0,Le=t(Re);for(;Re!==Le;){let Oe=Re;const Ue=Re;for(;Oe!==Le;){const Re=this._activeRegions[Oe];Re.hiddenByOverlap=!1;for(let Le=0;Le<Ue;Le++){const Oe=this._activeRegions[Le];if(!Oe.hiddenByOverlap&&Re.order===Ng&&vh(Re,Oe)&&(Re.hiddenByOverlap=Sh(Re.footprint,Re.tileId,Oe.footprint,Oe.tileId),Re.hiddenByOverlap))break}++Oe}Re=Le,Le=t(Re)}}}}_setSources(Re){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let Le=Re.length-1;Le>=0;Le--)this._addSource(Re[Le]);this._computeReplacement()}},Re.dm=class{constructor(Re){this._createGrid(Re),this._createPoles(Re)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const Re of this._poleSegments)Re.destroy();for(const Re of this._gridSegments)Re.withSkirts.destroy(),Re.withoutSkirts.destroy()}_fillGridMeshWithLods(Re,Le){const Oe=new xa,Ue=new Da,qe=[],Ct=Re+1+2,Ot=Le[0]+1,Jt=Le[0]+1+(1+Le.length),l=(Re,Le,Oe)=>{let Ue=Re===Ct-1?Re-2:0===Re?Re:Re-1;return Ue+=Oe?24575:0,[Ue,Le]};for(let Re=0;Re<Ct;++Re)Oe.emplaceBack(...l(Re,0,!0));for(let Re=0;Re<Ot;++Re)for(let Le=0;Le<Ct;++Le)Oe.emplaceBack(...l(Le,Re,(0===Le||Le===Ct-1)&&!0));for(let Re=0;Re<Le.length;++Re){const Ue=Le[Re];for(let Re=0;Re<Ct;++Re)Oe.emplaceBack(...l(Re,Ue,!0))}for(let Re=0;Re<Le.length;++Re){const Ot=Ue.length,Hr=Le[Re]+1+2,Jr=new Da;for(let Oe=0;Oe<Hr-1;Oe++){const qe=Oe===Hr-2,Ot=qe?Ct*(Jt-Le.length+Re-Oe):Ct;for(let Re=0;Re<Ct-1;Re++){const Le=Oe*Ct+Re;0===Oe||qe||0===Re||Re===Ct-2?(Jr.emplaceBack(Le+1,Le,Le+Ot),Jr.emplaceBack(Le+Ot,Le+Ot+1,Le+1)):(Ue.emplaceBack(Le+1,Le,Le+Ot),Ue.emplaceBack(Le+Ot,Le+Ot+1,Le+1))}}const Ln=co.simpleSegment(0,Ot,Oe.length,Ue.length-Ot);for(let Re=0;Re<Jr.uint16.length;Re+=3)Ue.emplaceBack(Jr.uint16[Re],Jr.uint16[Re+1],Jr.uint16[Re+2]);const Nn=co.simpleSegment(0,Ot,Oe.length,Ue.length-Ot);qe.push({withoutSkirts:Ln,withSkirts:Nn})}return{vertices:Oe,indices:Ue,segments:qe}}_createGrid(Re){const Le=this._fillGridMeshWithLods(Ff,jf);this._gridSegments=Le.segments,this._gridBuffer=Re.createVertexBuffer(Le.vertices,Om.members),this._gridIndexBuffer=Re.createIndexBuffer(Le.indices,!0)}_createPoles(Re){const Le=new Da;for(let Re=0;Re<=Ff;Re++)Le.emplaceBack(0,Re+1,Re+2);this._poleIndexBuffer=Re.createIndexBuffer(Le,!0);const Oe=new Ua,Ue=new Ua,qe=new Ua,Ct=new Ua;this._poleSegments=[];for(let Re=0,Le=0;Re<ff;Re++){const Ot=360/(1<<Re);Oe.emplaceBack(0,-pf,0,.5,0),Ue.emplaceBack(0,-pf,0,.5,1),qe.emplaceBack(0,-pf,0,.5,.5),Ct.emplaceBack(0,-pf,0,.5,.5);for(let Re=0;Re<=Ff;Re++){let Le=Re/Ff,Jt=0;const Hr=ke(0,Ot,Le),[Jr,Ln,Nn]=Jo(Um,Hm,Hr,pf);Oe.emplaceBack(Jr,Ln,Nn,Le,Jt),Ue.emplaceBack(Jr,Ln,Nn,Le,1-Jt);const $n=Y(Hr);Le=.5+.5*Math.sin($n),Jt=.5+.5*Math.cos($n),qe.emplaceBack(Jr,Ln,Nn,Le,Jt),Ct.emplaceBack(Jr,Ln,Nn,Le,1-Jt)}this._poleSegments.push(co.simpleSegment(Le,0,66,64)),Le+=66}this._poleNorthVertexBuffer=Re.createVertexBuffer(Oe,Rm,!1),this._poleSouthVertexBuffer=Re.createVertexBuffer(Ue,Rm,!1),this._texturedPoleNorthVertexBuffer=Re.createVertexBuffer(qe,Rm,!1),this._texturedPoleSouthVertexBuffer=Re.createVertexBuffer(Ct,Rm,!1)}getGridBuffers(Re,Le){return[this._gridBuffer,this._gridIndexBuffer,Le?this._gridSegments[Re].withSkirts:this._gridSegments[Re].withoutSkirts]}getPoleBuffers(Re,Le){return[Le?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,Le?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[Re]]}},Re.dn=Ng,Re.dp=K,Re.dq=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},Re.dr=el,Re.ds=yl,Re.dt=Qo,Re.du=function([Re,Le,Oe]){const Ue=Math.hypot(Re,Le,Oe),qe=Math.atan2(Re,Oe),Ct=.5*Math.PI-Math.acos(-Le/Ue);return new rl(Z(qe),Z(Ct))},Re.dv=zm,Re.dw=Yf,Re.dx=function(Re){const Le=Re.navigator?Re.navigator.userAgent:null;return!!function(Re){if(null==fl){const Le=Re.navigator?Re.navigator.userAgent:null;fl=!!Re.safari||!(!Le||!(/\b(iPad|iPhone|iPod)\b/.test(Le)||Le.match("Safari")&&!Le.match("Chrome")))}return fl}(Re)&&Le&&(Le.match("Version/15.4")||Le.match("Version/15.5")||Le.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},Re.dy=function(Re,Le){Oc=Re,Nc=Le},Re.dz=Fu,Re.e=Al,Re.e0=function(Re){let Le=0;if(new Uint32Array(Re,0,1)[0]!==Rx){const Oe=new Uint32Array(Re,0,7),[,,Ue,qe,Ct,Ot]=Oe;Le=Oe.byteLength+qe+Ct+Ot+Ct,(Ue!==Re.byteLength||Le>=Re.byteLength)&&ft("Invalid b3dm header information.")}return Jg(Re,Le)},Re.e1=function(Re,Le){const Oe=ax(Re);for(const Re of Oe){for(const Le of Re.meshes)ox(Le);Re.lights&&(Re.lightMeshIndex=Re.meshes.length,Re.meshes.push(lx(Re.lights,Le)))}return Oe},Re.e2=cy,Re.e3=xy,Re.e4=Dp,Re.e5=function(Re){Xt(),null!=Uc&&Uc.then((Le=>{Le.keys().then((Oe=>{for(let Ue=0;Ue<Oe.length-Re;Ue++)Le.delete(Oe[Ue])}))}))},Re.f=function(Re){return 0===Re.indexOf("mapbox:")},Re.g=function(Re,Le){return ie(nt(Re,{method:"GET"}),Le)},Re.h=Pt,Re.i=function(Re){return Al.API_STYLE_REGEX.test(Re)&&!zt(Re)},Re.j=function(Re){return decodeURIComponent(atob(Re).split("").map((Re=>"%"+("00"+Re.charCodeAt(0).toString(16)).slice(-2))).join(""))},Re.k=function(Re){return btoa(encodeURIComponent(Re).replace(/%([0-9A-F]{2})/g,((Re,Le)=>String.fromCharCode(Number("0x"+Le)))))},Re.l=nt,Re.m=Zc,Re.n=function(Re,Le){return ie(nt(Re,{type:"json"}),Le)},Re.o=ce,Re.p=function(Re,Le){return ie(nt(Re,{method:"POST"}),Le)},Re.q=oc,Re.r=ic,Re.s=function(Re){try{const Le=self[Re];return Le.setItem("_mapbox_test_",1),Le.removeItem("_mapbox_test_"),!0}catch(Re){return!1}},Re.t=ve,Re.u=function(){return function t(Re){return Re?(Re^Math.random()*(16>>Re/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()},Re.v=function(Re){return!!Re&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(Re)},Re.w=ft,Re.x=be,Re.y=2,Re.z=Lf})),define(["./shared"],(function(Re){function t(Re){const Le=Re?Re.url.toString():void 0;return Le?performance.getEntriesByName(Le):[]}function o(Re){if("number"==typeof Re||"boolean"==typeof Re||"string"==typeof Re||null==Re)return JSON.stringify(Re);if(Array.isArray(Re)){let Le="[";for(const Oe of Re)Le+=`${o(Oe)},`;return`${Le}]`}let Le="{";for(const Oe of Object.keys(Re).sort())Le+=`${Oe}:${o(Re[Oe])},`;return`${Le}}`}function s(Le){let Oe="";for(const Ue of Re.bg)Oe+=`/${o(Le[Ue])}`;return Oe}class i{constructor(Re){this.keyCache={},this._layers={},this._layerConfigs={},Re&&this.replace(Re)}replace(Re,Le){this._layerConfigs={},this._layers={},this.update(Re,[],Le)}update(Le,Oe,Ue){this._options=Ue;for(const Oe of Le)this._layerConfigs[Oe.id]=Oe,(this._layers[Oe.id]=Re.cq(Oe,this.scope,null,this._options)).compileFilter(Ue),this.keyCache[Oe.id]&&delete this.keyCache[Oe.id];for(const Re of Oe)delete this.keyCache[Re],delete this._layerConfigs[Re],delete this._layers[Re];this.familiesBySource={};const qe=function(Re,Le){const Oe={};for(let Ue=0;Ue<Re.length;Ue++){const qe=Le&&Le[Re[Ue].id]||s(Re[Ue]);Le&&(Le[Re[Ue].id]=qe);let Ct=Oe[qe];Ct||(Ct=Oe[qe]=[]),Ct.push(Re[Ue])}const Ue=[];for(const Re in Oe)Ue.push(Oe[Re]);return Ue}(Re.bd(this._layerConfigs),this.keyCache);for(const Re of qe){const Le=Re.map((Re=>this._layers[Re.id])),Oe=Le[0];if("none"===Oe.visibility)continue;const Ue=Oe.source||"";let qe=this.familiesBySource[Ue];qe||(qe=this.familiesBySource[Ue]={});const Ct=Oe.sourceLayer||"_geojsonTileLayer";let Ot=qe[Ct];Ot||(Ot=qe[Ct]=[]),Ot.push(Le)}}}const Le=1*Re.dP;class r{constructor(Oe){const Ue={},qe=[];for(const Re in Oe){const Ct=Oe[Re],Ot=Ue[Re]={};for(const Re in Ct.glyphs){const Oe=Ct.glyphs[+Re];if(!Oe||0===Oe.bitmap.width||0===Oe.bitmap.height)continue;const Ue=Oe.metrics.localGlyph?Le:1,Jt={x:0,y:0,w:Oe.bitmap.width+2*Ue,h:Oe.bitmap.height+2*Ue};qe.push(Jt),Ot[Re]=Jt}}const{w:Ct,h:Ot}=Re.z(qe),Jt=new Re.dO({width:Ct||1,height:Ot||1});for(const qe in Oe){const Ct=Oe[qe];for(const Oe in Ct.glyphs){const Ot=Ct.glyphs[+Oe];if(!Ot||0===Ot.bitmap.width||0===Ot.bitmap.height)continue;const Hr=Ue[qe][Oe],Jr=Ot.metrics.localGlyph?Le:1;Re.dO.copy(Ot.bitmap,Jt,{x:0,y:0},{x:Hr.x+Jr,y:Hr.y+Jr},Ot.bitmap)}}this.image=Jt,this.positions=Ue}}Re.dN(r,"GlyphAtlas");class a{constructor(Le){this.tileID=new Re.aA(Le.tileID.overscaledZ,Le.tileID.wrap,Le.tileID.canonical.z,Le.tileID.canonical.x,Le.tileID.canonical.y),this.tileZoom=Le.tileZoom,this.uid=Le.uid,this.zoom=Le.zoom,this.lut=Le.lut,this.canonical=Le.tileID.canonical,this.pixelRatio=Le.pixelRatio,this.tileSize=Le.tileSize,this.source=Le.source,this.scope=Le.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=Le.showCollisionBoxes,this.collectResourceTiming=!!Le.collectResourceTiming,this.promoteId=Le.promoteId,this.isSymbolTile=Le.isSymbolTile,this.tileTransform=Re.aK(Le.tileID.canonical,Le.projection),this.projection=Le.projection,this.brightness=Le.brightness,this.extraShadowCaster=!!Le.extraShadowCaster,this.tessellationStep=Le.tessellationStep}parse(Le,Oe,Ue,qe,Ct){this.status="parsing",this.data=Le,this.collisionBoxArray=new Re.aQ;const Ot=new Re.dQ(Object.keys(Le.layers).sort()),Jt=new Re.dR(this.tileID,this.promoteId);Jt.bucketLayerIDs=[];const Hr={},Jr=new Re.dS(256,256),Ln={featureIndex:Jt,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:Jr,availableImages:Ue,brightness:this.brightness},Nn=Oe.familiesBySource[this.source];for(const Oe in Nn){const qe=Le.layers[Oe];if(!qe)continue;let Ct=!1,Jr=!1,$n=!1;for(const Re of Nn[Oe])"symbol"===Re[0].type?Ct=!0:Jr=!0,Re[0].is3D()&&"model"!==Re[0].type&&($n=!0);if(this.extraShadowCaster&&!$n)continue;if(!0===this.isSymbolTile&&!Ct)continue;if(!1===this.isSymbolTile&&!Jr)continue;1===qe.version&&Re.w(`Vector tile source "${this.source}" layer "${Oe}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Gn=Ot.encode(Oe),qn=[];for(let Re=0;Re<qe.length;Re++){const Le=qe.feature(Re),Ue=Jt.getId(Le,Oe);qn.push({feature:Le,id:Ue,index:Re,sourceLayerIndex:Gn})}for(const Re of Nn[Oe]){const Le=Re[0];(!this.extraShadowCaster||Le.is3D()&&"model"!==Le.type)&&(void 0!==this.isSymbolTile&&"symbol"===Le.type!==this.isSymbolTile||Le.minzoom&&this.zoom<Math.floor(Le.minzoom)||Le.maxzoom&&this.zoom>=Le.maxzoom||"none"!==Le.visibility&&(l(Re,this.zoom,Ln.brightness,Ue),(Hr[Le.id]=Le.createBucket({index:Jt.bucketLayerIDs.length,layers:Re,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Gn,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep})).populate(qn,Ln,this.tileID.canonical,this.tileTransform),Jt.bucketLayerIDs.push(Re.map((Re=>Re.id)))))}}let $n,Gn,qn,Zn;Jr.trim();const Xn={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},w=()=>{if($n)return this.status="done",Ct($n);if(this.extraShadowCaster)this.status="done",Ct(null,{buckets:Re.bd(Hr).filter((Re=>!Re.isEmpty())),featureIndex:Jt,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:Ln.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(Gn&&qn&&Zn){const Le=new r(Gn),Oe=new Re.dU(qn,Zn,this.lut);for(const qe in Hr){const Ct=Hr[qe];Ct instanceof Re.aR?(l(Ct.layers,this.zoom,Ln.brightness,Ue),Re.dV(Ct,Gn,Le.positions,qn,Oe.iconPositions,this.showCollisionBoxes,Ue,this.tileID.canonical,this.tileZoom,this.projection,this.brightness)):Ct.hasPattern&&(Ct instanceof Re.aX||Ct instanceof Re.aY||Ct instanceof Re.d0)&&(l(Ct.layers,this.zoom,Ln.brightness,Ue),Ct.addFeatures(Ln,this.tileID.canonical,Oe.patternPositions,Ue,this.tileTransform,this.brightness))}this.status="done",Ct(null,{buckets:Re.bd(Hr).filter((Re=>!Re.isEmpty())),featureIndex:Jt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Le.image,lineAtlas:Jr,imageAtlas:Oe,brightness:Ln.brightness})}};if(!this.extraShadowCaster){const Le=Re.dT(Ln.glyphDependencies,(Re=>Object.keys(Re).map(Number)));Object.keys(Le).length?qe.send("getGlyphs",{uid:this.uid,stacks:Le,scope:this.scope},((Re,Le)=>{$n||($n=Re,Gn=Le,w())}),void 0,!1,Xn):Gn={};const Oe=Object.keys(Ln.iconDependencies);Oe.length?qe.send("getImages",{icons:Oe,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},((Re,Le)=>{$n||($n=Re,qn=Le,w())}),void 0,!1,Xn):qn={};const Ue=Object.keys(Ln.patternDependencies);Ue.length?qe.send("getImages",{icons:Ue,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},((Re,Le)=>{$n||($n=Re,Zn=Le,w())}),void 0,!1,Xn):Zn={}}w()}}function l(Le,Oe,Ue,qe){const Ct=new Re.a3(Oe,{brightness:Ue});for(const Re of Le)Re.recalculate(Ct,qe)}class c extends Re.E{constructor(Le,Oe,Ue,qe,Ct,Ot){super(),this.actor=Le,this.layerIndex=Oe,this.availableImages=Ue,this.loadVectorData=Ct||Re.aw,this.loading={},this.loaded={},this.deduped=new Re.au(Le.scheduler),this.isSpriteLoaded=qe,this.scheduler=Le.scheduler,this.brightness=Ot}loadTile(Le,Oe){const Ue=Le.uid,qe=Le&&Le.request,Ct=qe&&qe.collectResourceTiming,Ot=this.loading[Ue]=new a(Le);Ot.abort=this.loadVectorData(Le,((Jt,Hr)=>{const Jr=!this.loading[Ue];if(delete this.loading[Ue],Jr||Jt||!Hr)return Ot.status="done",Jr||(this.loaded[Ue]=Ot),Oe(Jt);const Ln=Hr.rawData,Nn={};Hr.expires&&(Nn.expires=Hr.expires),Hr.cacheControl&&(Nn.cacheControl=Hr.cacheControl),Ot.vectorTile=Hr.vectorTile||new Re.dW.VectorTile(new Re.bb(Ln));const f=()=>{Ot.parse(Ot.vectorTile,this.layerIndex,this.availableImages,this.actor,((Le,Ue)=>{if(Le||!Ue)return Oe(Le);const Ot={};if(Ct){const Re=t(qe);Re.length>0&&(Ot.resourceTiming=JSON.parse(JSON.stringify(Re)))}Oe(null,Re.l({rawTileData:Ln.slice(0)},Ue,Nn,Ot))}))};this.isSpriteLoaded?f():this.once("isSpriteLoaded",(()=>{this.scheduler?this.scheduler.add(f,{type:"parseTile",isSymbolTile:Le.isSymbolTile,zoom:Le.tileZoom}):f()})),this.loaded=this.loaded||{},this.loaded[Ue]=Ot}))}reloadTile(Le,Oe){const Ue=this.loaded,qe=Le.uid;if(Ue&&Ue[qe]){const Ct=Ue[qe];Ct.showCollisionBoxes=Le.showCollisionBoxes,Ct.projection=Le.projection,Ct.brightness=Le.brightness,Ct.tileTransform=Re.aK(Le.tileID.canonical,Le.projection),Ct.extraShadowCaster=Le.extraShadowCaster,Ct.lut=Le.lut;const r=(Re,Le)=>{const Ue=Ct.reloadCallback;Ue&&(delete Ct.reloadCallback,Ct.parse(Ct.vectorTile,this.layerIndex,this.availableImages,this.actor,Ue)),Oe(Re,Le)};"parsing"===Ct.status?Ct.reloadCallback=r:"done"===Ct.status&&(Ct.vectorTile?Ct.parse(Ct.vectorTile,this.layerIndex,this.availableImages,this.actor,r):r())}else Oe(null,void 0)}abortTile(Re,Le){const Oe=Re.uid,Ue=this.loading[Oe];Ue&&(Ue.abort&&Ue.abort(),delete this.loading[Oe]),Le()}removeTile(Re,Le){const Oe=this.loaded,Ue=Re.uid;Oe&&Oe[Ue]&&delete Oe[Ue],Le()}}class h{loadTile(Le,Oe){const{uid:Ue,encoding:qe,rawImageData:Ct,padding:Ot}=Le,Jt=ImageBitmap&&Ct instanceof ImageBitmap?this.getImageData(Ct,Ot):Ct;Oe(null,new Re.dX(Ue,Jt,qe,Ot<1))}getImageData(Re,Le){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Re.width,Re.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=Re.width,this.offscreenCanvas.height=Re.height,this.offscreenCanvasContext.drawImage(Re,0,0,Re.width,Re.height);const Oe=this.offscreenCanvasContext.getImageData(-Le,-Le,Re.width+2*Le,Re.height+2*Le);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),Oe}}Re.ba.setPbf(Re.bb);class u{decodeRasterArray({task:Le,buffer:Oe},Ue){Re.ba.performDecoding(Oe,Le).then((Re=>{Ue(null,Re)}),(Re=>{Ue(Re)}))}}const Oe=Re.dW.VectorTileFeature.prototype.toGeoJSON;class f{constructor(Le){this._feature=Le,this.extent=Re.ab,this.type=Le.type,this.properties=Le.tags,"id"in Le&&!isNaN(Le.id)&&(this.id=parseInt(Le.id,10))}loadGeometry(){if(1===this._feature.type){const Le=[];for(const Oe of this._feature.geometry)Le.push([new Re.P(Oe[0],Oe[1])]);return Le}{const Le=[];for(const Oe of this._feature.geometry){const Ue=[];for(const Le of Oe)Ue.push(new Re.P(Le[0],Le[1]));Le.push(Ue)}return Le}}toGeoJSON(Re,Le,Ue){return Oe.call(this,Re,Le,Ue)}}class p{constructor(Le){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=Re.ab,this.length=Le.length,this._features=Le}feature(Re){return new f(this._features[Re])}}const Ue=64/4096,qe=128;class y{constructor(){this.features=new Map}clear(){this.features.clear()}load(Re=[],Le){for(const Oe of Re){const Re=Oe.id;if(null==Re)continue;let Ue=this.features.get(Re);Ue&&this.updateCache(Ue,Le),Oe.geometry?(Ue=w(Oe),this.updateCache(Ue,Le),this.features.set(Re,Ue)):this.features.delete(Re),this.updateCache(Ue,Le)}}updateCache(Re,Le){for(const{canonical:Oe,uid:Ue}of Object.values(Le)){const{z:qe,x:Ct,y:Ot}=Oe;x(Re,Math.pow(2,qe),Ct,Ot)&&delete Le[Ue]}}getTile(Re,Le,Oe){const Ue=Math.pow(2,Re),qe=[];for(const Re of this.features.values())x(Re,Ue,Le,Oe)&&qe.push(I(Re,Ue,Le,Oe));return{features:qe}}getFeatures(){return[...this.features.values()]}}function x({minX:Re,minY:Le,maxX:Oe,maxY:qe},Ct,Ot,Jt){return Re<(Ot+1+Ue)/Ct&&Le<(Jt+1+Ue)/Ct&&Oe>(Ot-Ue)/Ct&&qe>(Jt-Ue)/Ct}function w(Re){const{id:Le,geometry:Oe,properties:Ue}=Re;if(!Oe)return;if("GeometryCollection"===Oe.type)throw new Error("GeometryCollection not supported in dynamic mode.");const{type:qe,coordinates:Ct}=Oe,Ot={id:Le,type:1,geometry:[],tags:Ue,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},Jt=Ot.geometry;if("Point"===qe)b(Ct,Jt,Ot);else if("MultiPoint"===qe)for(const Re of Ct)b(Re,Jt,Ot);else if("LineString"===qe)Ot.type=2,S(Ct,Jt,Ot);else if("MultiLineString"===qe)Ot.type=2,v(Ct,Jt,Ot);else if("Polygon"===qe)Ot.type=3,v(Ct,Jt,Ot,!0);else{if("MultiPolygon"!==qe)throw new Error("Input data is not a valid GeoJSON object.");Ot.type=3;for(const Re of Ct)v(Re,Jt,Ot,!0)}return Ot}function b([Le,Oe],Ue,qe){const Ct=Re.am(Le);let Ot=Re.at(Oe);Ot=Ot<0?0:Ot>1?1:Ot,Ue.push(Ct,Ot),qe.minX=Math.min(qe.minX,Ct),qe.minY=Math.min(qe.minY,Ot),qe.maxX=Math.max(qe.maxX,Ct),qe.maxY=Math.max(qe.maxY,Ot)}function S(Re,Le,Oe,Ue=!1,qe=!1){const Ct=[];for(const Le of Re)b(Le,Ct,Oe);Le.push(Ct),Ue&&function(Re,Le){let Oe=0;for(let Le=0,Ue=Re.length,qe=Ue-2;Le<Ue;qe=Le,Le+=2)Oe+=(Re[Le]-Re[qe])*(Re[Le+1]+Re[qe+1]);if(Oe>0===Le)for(let Le=0,Oe=Re.length;Le<Oe/2;Le+=2){const Ue=Re[Le],qe=Re[Le+1];Re[Le]=Re[Oe-2-Le],Re[Le+1]=Re[Oe-1-Le],Re[Oe-2-Le]=Ue,Re[Oe-1-Le]=qe}}(Ct,qe)}function v(Re,Le,Oe,Ue=!1){for(let qe=0;qe<Re.length;qe++)S(Re[qe],Le,Oe,Ue,0===qe)}function I(Le,Oe,Ue,qe){const{id:Ct,type:Ot,geometry:Jt,tags:Hr}=Le,Jr=[];if(1===Ot)!function(Le,Oe,Ue,qe,Ct){for(let Ot=0;Ot<Le.length;Ot+=2){const Jt=Math.round(Re.ab*(Le[Ot+0]*Oe-Ue)),Hr=Math.round(Re.ab*(Le[Ot+1]*Oe-qe));Ct.push([Jt,Hr])}}(Jt,Oe,Ue,qe,Jr);else for(const Re of Jt)M(Re,Oe,Ue,qe,Jr);return{id:Ct,type:Ot,geometry:Jr,tags:Hr}}function M(Le,Oe,Ue,Ct,Ot){const Jt=-qe,Hr=Re.ab+qe;let Jr;for(let qe=0;qe<Le.length-2;qe+=2){let Ln=Math.round(Re.ab*(Le[qe+0]*Oe-Ue)),Nn=Math.round(Re.ab*(Le[qe+1]*Oe-Ct)),$n=Math.round(Re.ab*(Le[qe+2]*Oe-Ue)),Gn=Math.round(Re.ab*(Le[qe+3]*Oe-Ct));const qn=$n-Ln,Zn=Gn-Nn;Ln<Jt&&$n<Jt||(Ln<Jt?(Nn+=Math.round(Zn*((Jt-Ln)/qn)),Ln=Jt):$n<Jt&&(Gn=Nn+Math.round(Zn*((Jt-Ln)/qn)),$n=Jt),Nn<Jt&&Gn<Jt||(Nn<Jt?(Ln+=Math.round(qn*((Jt-Nn)/Zn)),Nn=Jt):Gn<Jt&&($n=Ln+Math.round(qn*((Jt-Nn)/Zn)),Gn=Jt),Ln>=Hr&&$n>=Hr||(Ln>=Hr?(Nn+=Math.round(Zn*((Hr-Ln)/qn)),Ln=Hr):$n>=Hr&&(Gn=Nn+Math.round(Zn*((Hr-Ln)/qn)),$n=Hr),Nn>=Hr&&Gn>=Hr||(Nn>=Hr?(Ln+=Math.round(qn*((Hr-Nn)/Zn)),Nn=Hr):Gn>=Hr&&($n=Ln+Math.round(qn*((Hr-Nn)/Zn)),Gn=Hr),Jr&&Ln===Jr[Jr.length-1][0]&&Nn===Jr[Jr.length-1][1]||(Jr=[[Ln,Nn]],Ot.push(Jr)),Jr.push([$n,Gn])))))}}var Ct,Ot,Jt,Hr={exports:{}},Jr=function(){if(Jt)return Hr.exports;Jt=1;var Le=Re.d_(),Oe=function(){if(Ot)return Ct;Ot=1;var Le=Re.dY(),Oe=Re.dZ().VectorTileFeature;function s(Re,Le){this.options=Le||{},this.features=Re,this.length=Re.length}function i(Re,Le){this.id="number"==typeof Re.id?Re.id:void 0,this.type=Re.type,this.rawGeometry=1===Re.type?[Re.geometry]:Re.geometry,this.properties=Re.tags,this.extent=Le||4096}return Ct=s,s.prototype.feature=function(Re){return new i(this.features[Re],this.options.extent)},i.prototype.loadGeometry=function(){var Re=this.rawGeometry;this.geometry=[];for(var Oe=0;Oe<Re.length;Oe++){for(var Ue=Re[Oe],qe=[],Ct=0;Ct<Ue.length;Ct++)qe.push(new Le(Ue[Ct][0],Ue[Ct][1]));this.geometry.push(qe)}return this.geometry},i.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Re=this.geometry,Le=1/0,Oe=-1/0,Ue=1/0,qe=-1/0,Ct=0;Ct<Re.length;Ct++)for(var Ot=Re[Ct],Jt=0;Jt<Ot.length;Jt++){var Hr=Ot[Jt];Le=Math.min(Le,Hr.x),Oe=Math.max(Oe,Hr.x),Ue=Math.min(Ue,Hr.y),qe=Math.max(qe,Hr.y)}return[Le,Ue,Oe,qe]},i.prototype.toGeoJSON=Oe.prototype.toGeoJSON,Ct}();function s(Re){var Oe=new Le;return function(Re,Le){for(var Oe in Re.layers)Le.writeMessage(3,i,Re.layers[Oe])}(Re,Oe),Oe.finish()}function i(Re,Le){var Oe;Le.writeVarintField(15,Re.version||1),Le.writeStringField(1,Re.name||""),Le.writeVarintField(5,Re.extent||4096);var Ue={keys:[],values:[],keycache:{},valuecache:{}};for(Oe=0;Oe<Re.length;Oe++)Ue.feature=Re.feature(Oe),Le.writeMessage(2,n,Ue);var qe=Ue.keys;for(Oe=0;Oe<qe.length;Oe++)Le.writeStringField(3,qe[Oe]);var Ct=Ue.values;for(Oe=0;Oe<Ct.length;Oe++)Le.writeMessage(4,h,Ct[Oe])}function n(Re,Le){var Oe=Re.feature;void 0!==Oe.id&&Le.writeVarintField(1,Oe.id),Le.writeMessage(2,r,Re),Le.writeVarintField(3,Oe.type),Le.writeMessage(4,c,Oe)}function r(Re,Le){var Oe=Re.feature,Ue=Re.keys,qe=Re.values,Ct=Re.keycache,Ot=Re.valuecache;for(var Jt in Oe.properties){var Hr=Oe.properties[Jt],Jr=Ct[Jt];if(null!==Hr){void 0===Jr&&(Ue.push(Jt),Ct[Jt]=Jr=Ue.length-1),Le.writeVarint(Jr);var Ln=typeof Hr;"string"!==Ln&&"boolean"!==Ln&&"number"!==Ln&&(Hr=JSON.stringify(Hr));var Nn=Ln+":"+Hr,$n=Ot[Nn];void 0===$n&&(qe.push(Hr),Ot[Nn]=$n=qe.length-1),Le.writeVarint($n)}}}function a(Re,Le){return(Le<<3)+(7&Re)}function l(Re){return Re<<1^Re>>31}function c(Re,Le){for(var Oe=Re.loadGeometry(),Ue=Re.type,qe=0,Ct=0,Ot=Oe.length,Jt=0;Jt<Ot;Jt++){var Hr=Oe[Jt],Jr=1;1===Ue&&(Jr=Hr.length),Le.writeVarint(a(1,Jr));for(var Ln=3===Ue?Hr.length-1:Hr.length,Nn=0;Nn<Ln;Nn++){1===Nn&&1!==Ue&&Le.writeVarint(a(2,Ln-1));var $n=Hr[Nn].x-qe,Gn=Hr[Nn].y-Ct;Le.writeVarint(l($n)),Le.writeVarint(l(Gn)),qe+=$n,Ct+=Gn}3===Ue&&Le.writeVarint(a(7,1))}}function h(Re,Le){var Oe=typeof Re;"string"===Oe?Le.writeStringField(1,Re):"boolean"===Oe?Le.writeBooleanField(7,Re):"number"===Oe&&(Re%1!=0?Le.writeDoubleField(3,Re):Re<0?Le.writeSVarintField(6,Re):Le.writeVarintField(5,Re))}return Hr.exports=s,Hr.exports.fromVectorTileJs=s,Hr.exports.fromGeojsonVt=function(Re,Le){Le=Le||{};var Ue={};for(var qe in Re)Ue[qe]=new Oe(Re[qe].features,Le),Ue[qe].name=qe,Ue[qe].version=Le.version,Ue[qe].extent=Le.extent;return s({layers:Ue})},Hr.exports.GeoJSONWrapper=Oe,Hr.exports}(),Ln=Re.d$(Jr);const Nn={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Re=>Re},$n=Math.fround||(Gn=new Float32Array(1),Re=>(Gn[0]=+Re,Gn[0]));var Gn;const qn=3,Zn=5,Xn=6;class E{constructor(Re){this.options=Object.assign(Object.create(Nn),Re),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(Re){const{log:Le,minZoom:Oe,maxZoom:Ue}=this.options;Le&&console.time("total time");const qe=`prepare ${Re.length} points`;Le&&console.time(qe),this.points=Re;const Ct=[];for(let Le=0;Le<Re.length;Le++){const Oe=Re[Le];if(!Oe.geometry)continue;const[Ue,qe]=Oe.geometry.coordinates,Ot=$n(N(Ue)),Jt=$n(X(qe));Ct.push(Ot,Jt,1/0,Le,-1,1),this.options.reduce&&Ct.push(0)}let Ot=this.trees[Ue+1]=this._createTree(Ct);Le&&console.timeEnd(qe);for(let Re=Ue;Re>=Oe;Re--){const Oe=+Date.now();Ot=this.trees[Re]=this._createTree(this._cluster(Ot,Re)),Le&&console.log("z%d: %d clusters in %dms",Re,Ot.numItems,+Date.now()-Oe)}return Le&&console.timeEnd("total time"),this}getClusters(Re,Le){let Oe=((Re[0]+180)%360+360)%360-180;const Ue=Math.max(-90,Math.min(90,Re[1]));let qe=180===Re[2]?180:((Re[2]+180)%360+360)%360-180;const Ct=Math.max(-90,Math.min(90,Re[3]));if(Re[2]-Re[0]>=360)Oe=-180,qe=180;else if(Oe>qe){const Re=this.getClusters([Oe,Ue,180,Ct],Le),Ot=this.getClusters([-180,Ue,qe,Ct],Le);return Re.concat(Ot)}const Ot=this.trees[this._limitZoom(Le)],Jt=Ot.range(N(Oe),X(Ct),N(qe),X(Ue)),Hr=Ot.data,Jr=[];for(const Re of Jt){const Le=this.stride*Re;Jr.push(Hr[Le+Zn]>1?F(Hr,Le,this.clusterProps):this.points[Hr[Le+qn]])}return Jr}getChildren(Re){const Le=this._getOriginId(Re),Oe=this._getOriginZoom(Re),Ue="No cluster with the specified id.",qe=this.trees[Oe];if(!qe)throw new Error(Ue);const Ct=qe.data;if(Le*this.stride>=Ct.length)throw new Error(Ue);const Ot=this.options.radius/(this.options.extent*Math.pow(2,Oe-1)),Jt=qe.within(Ct[Le*this.stride],Ct[Le*this.stride+1],Ot),Hr=[];for(const Le of Jt){const Oe=Le*this.stride;Ct[Oe+4]===Re&&Hr.push(Ct[Oe+Zn]>1?F(Ct,Oe,this.clusterProps):this.points[Ct[Oe+qn]])}if(0===Hr.length)throw new Error(Ue);return Hr}getLeaves(Re,Le,Oe){const Ue=[];return this._appendLeaves(Ue,Re,Le=Le||10,Oe=Oe||0,0),Ue}getTile(Re,Le,Oe){const Ue=this.trees[this._limitZoom(Re)],qe=Math.pow(2,Re),{extent:Ct,radius:Ot}=this.options,Jt=Ot/Ct,Hr=(Oe-Jt)/qe,Jr=(Oe+1+Jt)/qe,Ln={features:[]};return this._addTileFeatures(Ue.range((Le-Jt)/qe,Hr,(Le+1+Jt)/qe,Jr),Ue.data,Le,Oe,qe,Ln),0===Le&&this._addTileFeatures(Ue.range(1-Jt/qe,Hr,1,Jr),Ue.data,qe,Oe,qe,Ln),Le===qe-1&&this._addTileFeatures(Ue.range(0,Hr,Jt/qe,Jr),Ue.data,-1,Oe,qe,Ln),Ln.features.length?Ln:null}getClusterExpansionZoom(Re){let Le=this._getOriginZoom(Re)-1;for(;Le<=this.options.maxZoom;){const Oe=this.getChildren(Re);if(Le++,1!==Oe.length)break;Re=Oe[0].properties.cluster_id}return Le}_appendLeaves(Re,Le,Oe,Ue,qe){const Ct=this.getChildren(Le);for(const Le of Ct){const Ct=Le.properties;if(Ct&&Ct.cluster?qe+Ct.point_count<=Ue?qe+=Ct.point_count:qe=this._appendLeaves(Re,Ct.cluster_id,Oe,Ue,qe):qe<Ue?qe++:Re.push(Le),Re.length===Oe)break}return qe}_createTree(Le){const Oe=new Re.by(Le.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Re=0;Re<Le.length;Re+=this.stride)Oe.add(Le[Re],Le[Re+1]);return Oe.finish(),Oe.data=Le,Oe}_addTileFeatures(Re,Le,Oe,Ue,qe,Ct){for(const Ot of Re){const Re=Ot*this.stride,Jt=Le[Re+Zn]>1;let Hr,Jr,Ln;if(Jt)Hr=Y(Le,Re,this.clusterProps),Jr=Le[Re],Ln=Le[Re+1];else{const Oe=this.points[Le[Re+qn]];Hr=Oe.properties;const[Ue,qe]=Oe.geometry.coordinates;Jr=N(Ue),Ln=X(qe)}const Nn={type:1,geometry:[[Math.round(this.options.extent*(Jr*qe-Oe)),Math.round(this.options.extent*(Ln*qe-Ue))]],tags:Hr};let $n;$n=Jt||this.options.generateId?Le[Re+qn]:this.points[Le[Re+qn]].id,void 0!==$n&&(Nn.id=$n),Ct.features.push(Nn)}}_limitZoom(Re){return Math.max(this.options.minZoom,Math.min(Math.floor(+Re),this.options.maxZoom+1))}_cluster(Re,Le){const{radius:Oe,extent:Ue,reduce:qe,minPoints:Ct}=this.options,Ot=Oe/(Ue*Math.pow(2,Le)),Jt=Re.data,Hr=[],Jr=this.stride;for(let Oe=0;Oe<Jt.length;Oe+=Jr){if(Jt[Oe+2]<=Le)continue;Jt[Oe+2]=Le;const Ue=Jt[Oe],Ln=Jt[Oe+1],Nn=Re.within(Jt[Oe],Jt[Oe+1],Ot),$n=Jt[Oe+Zn];let Gn=$n;for(const Re of Nn){const Oe=Re*Jr;Jt[Oe+2]>Le&&(Gn+=Jt[Oe+Zn])}if(Gn>$n&&Gn>=Ct){let Re,Ct=Ue*$n,Ot=Ln*$n,qn=-1;const Xn=(Oe/Jr<<5)+(Le+1)+this.points.length;for(const Ue of Nn){const Hr=Ue*Jr;if(Jt[Hr+2]<=Le)continue;Jt[Hr+2]=Le;const Ln=Jt[Hr+Zn];Ct+=Jt[Hr]*Ln,Ot+=Jt[Hr+1]*Ln,Jt[Hr+4]=Xn,qe&&(Re||(Re=this._map(Jt,Oe,!0),qn=this.clusterProps.length,this.clusterProps.push(Re)),qe(Re,this._map(Jt,Hr)))}Jt[Oe+4]=Xn,Hr.push(Ct/Gn,Ot/Gn,1/0,Xn,-1,Gn),qe&&Hr.push(qn)}else{for(let Re=0;Re<Jr;Re++)Hr.push(Jt[Oe+Re]);if(Gn>1)for(const Re of Nn){const Oe=Re*Jr;if(!(Jt[Oe+2]<=Le)){Jt[Oe+2]=Le;for(let Re=0;Re<Jr;Re++)Hr.push(Jt[Oe+Re])}}}}return Hr}_getOriginId(Re){return Re-this.points.length>>5}_getOriginZoom(Re){return(Re-this.points.length)%32}_map(Re,Le,Oe){if(Re[Le+Zn]>1){const Ue=this.clusterProps[Re[Le+Xn]];return Oe?Object.assign({},Ue):Ue}const Ue=this.points[Re[Le+qn]].properties,qe=this.options.map(Ue);return Oe&&qe===Ue?Object.assign({},qe):qe}}function F(Re,Le,Oe){return{type:"Feature",id:Re[Le+qn],properties:Y(Re,Le,Oe),geometry:{type:"Point",coordinates:[(Ue=Re[Le],360*(Ue-.5)),W(Re[Le+1])]}};var Ue}function Y(Re,Le,Oe){const Ue=Re[Le+Zn],qe=Ue>=1e4?`${Math.round(Ue/1e3)}k`:Ue>=1e3?Math.round(Ue/100)/10+"k":Ue,Ct=Re[Le+Xn],Ot=-1===Ct?{}:Object.assign({},Oe[Ct]);return Object.assign(Ot,{cluster:!0,cluster_id:Re[Le+qn],point_count:Ue,point_count_abbreviated:qe})}function N(Re){return Re/360+.5}function X(Re){const Le=Math.sin(Re*Math.PI/180),Oe=.5-.25*Math.log((1+Le)/(1-Le))/Math.PI;return Oe<0?0:Oe>1?1:Oe}function W(Re){const Le=(180-360*Re)*Math.PI/180;return 360*Math.atan(Math.exp(Le))/Math.PI-90}function G(Re,Le,Oe,Ue){let qe=Ue;const Ct=Le+(Oe-Le>>1);let Ot,Jt=Oe-Le;const Hr=Re[Le],Jr=Re[Le+1],Ln=Re[Oe],Nn=Re[Oe+1];for(let Ue=Le+3;Ue<Oe;Ue+=3){const Le=B(Re[Ue],Re[Ue+1],Hr,Jr,Ln,Nn);if(Le>qe)Ot=Ue,qe=Le;else if(Le===qe){const Re=Math.abs(Ue-Ct);Re<Jt&&(Ot=Ue,Jt=Re)}}qe>Ue&&(Ot-Le>3&&G(Re,Le,Ot,Ue),Re[Ot+2]=qe,Oe-Ot>3&&G(Re,Ot,Oe,Ue))}function B(Re,Le,Oe,Ue,qe,Ct){let Ot=qe-Oe,Jt=Ct-Ue;if(0!==Ot||0!==Jt){const Hr=((Re-Oe)*Ot+(Le-Ue)*Jt)/(Ot*Ot+Jt*Jt);Hr>1?(Oe=qe,Ue=Ct):Hr>0&&(Oe+=Ot*Hr,Ue+=Jt*Hr)}return Ot=Re-Oe,Jt=Le-Ue,Ot*Ot+Jt*Jt}function J(Re,Le,Oe,Ue){const qe={id:Re??null,type:Le,geometry:Oe,tags:Ue,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if("Point"===Le||"MultiPoint"===Le||"LineString"===Le)R(qe,Oe);else if("Polygon"===Le)R(qe,Oe[0]);else if("MultiLineString"===Le)for(const Re of Oe)R(qe,Re);else if("MultiPolygon"===Le)for(const Re of Oe)R(qe,Re[0]);return qe}function R(Re,Le){for(let Oe=0;Oe<Le.length;Oe+=3)Re.minX=Math.min(Re.minX,Le[Oe]),Re.minY=Math.min(Re.minY,Le[Oe+1]),Re.maxX=Math.max(Re.maxX,Le[Oe]),Re.maxY=Math.max(Re.maxY,Le[Oe+1])}function V(Re,Le,Oe,Ue){if(!Le.geometry)return;const qe=Le.geometry.coordinates;if(qe&&0===qe.length)return;const Ct=Le.geometry.type,Ot=Math.pow(Oe.tolerance/((1<<Oe.maxZoom)*Oe.extent),2);let Jt=[],Hr=Le.id;if(Oe.promoteId?Hr=Le.properties[Oe.promoteId]:Oe.generateId&&(Hr=Ue||0),"Point"===Ct)$(qe,Jt);else if("MultiPoint"===Ct)for(const Re of qe)$(Re,Jt);else if("LineString"===Ct)q(qe,Jt,Ot,!1);else if("MultiLineString"===Ct){if(Oe.lineMetrics){for(const Oe of qe)Jt=[],q(Oe,Jt,Ot,!1),Re.push(J(Hr,"LineString",Jt,Le.properties));return}U(qe,Jt,Ot,!1)}else if("Polygon"===Ct)U(qe,Jt,Ot,!0);else{if("MultiPolygon"!==Ct){if("GeometryCollection"===Ct){for(const qe of Le.geometry.geometries)V(Re,{id:Hr,geometry:qe,properties:Le.properties},Oe,Ue);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Re of qe){const Le=[];U(Re,Le,Ot,!0),Jt.push(Le)}}Re.push(J(Hr,Ct,Jt,Le.properties))}function $(Re,Le){Le.push(K(Re[0]),Q(Re[1]),0)}function q(Re,Le,Oe,Ue){let qe,Ct,Ot=0;for(let Oe=0;Oe<Re.length;Oe++){const Jt=K(Re[Oe][0]),Hr=Q(Re[Oe][1]);Le.push(Jt,Hr,0),Oe>0&&(Ot+=Ue?(qe*Hr-Jt*Ct)/2:Math.sqrt(Math.pow(Jt-qe,2)+Math.pow(Hr-Ct,2))),qe=Jt,Ct=Hr}const Jt=Le.length-3;Le[2]=1,G(Le,0,Jt,Oe),Le[Jt+2]=1,Le.size=Math.abs(Ot),Le.start=0,Le.end=Le.size}function U(Re,Le,Oe,Ue){for(let qe=0;qe<Re.length;qe++){const Ct=[];q(Re[qe],Ct,Oe,Ue),Le.push(Ct)}}function K(Re){return Re/360+.5}function Q(Re){const Le=Math.sin(Re*Math.PI/180),Oe=.5-.25*Math.log((1+Le)/(1-Le))/Math.PI;return Oe<0?0:Oe>1?1:Oe}function H(Re,Le,Oe,Ue,qe,Ct,Ot,Jt){if(Ue/=Le,Ct>=(Oe/=Le)&&Ot<Ue)return Re;if(Ot<Oe||Ct>=Ue)return null;const Hr=[];for(const Le of Re){const Re=Le.geometry;let Ct=Le.type;const Ot=0===qe?Le.minX:Le.minY,Jr=0===qe?Le.maxX:Le.maxY;if(Ot>=Oe&&Jr<Ue){Hr.push(Le);continue}if(Jr<Oe||Ot>=Ue)continue;let Ln=[];if("Point"===Ct||"MultiPoint"===Ct)ee(Re,Ln,Oe,Ue,qe);else if("LineString"===Ct)te(Re,Ln,Oe,Ue,qe,!1,Jt.lineMetrics);else if("MultiLineString"===Ct)se(Re,Ln,Oe,Ue,qe,!1);else if("Polygon"===Ct)se(Re,Ln,Oe,Ue,qe,!0);else if("MultiPolygon"===Ct)for(const Le of Re){const Re=[];se(Le,Re,Oe,Ue,qe,!0),Re.length&&Ln.push(Re)}if(Ln.length){if(Jt.lineMetrics&&"LineString"===Ct){for(const Re of Ln)Hr.push(J(Le.id,Ct,Re,Le.tags));continue}"LineString"!==Ct&&"MultiLineString"!==Ct||(1===Ln.length?(Ct="LineString",Ln=Ln[0]):Ct="MultiLineString"),"Point"!==Ct&&"MultiPoint"!==Ct||(Ct=3===Ln.length?"Point":"MultiPoint"),Hr.push(J(Le.id,Ct,Ln,Le.tags))}}return Hr.length?Hr:null}function ee(Re,Le,Oe,Ue,qe){for(let Ct=0;Ct<Re.length;Ct+=3){const Ot=Re[Ct+qe];Ot>=Oe&&Ot<=Ue&&ie(Le,Re[Ct],Re[Ct+1],Re[Ct+2])}}function te(Re,Le,Oe,Ue,qe,Ct,Ot){let Jt=oe(Re);const Hr=0===qe?ne:re;let Jr,Ln,Nn=Re.start;for(let $n=0;$n<Re.length-3;$n+=3){const Gn=Re[$n],qn=Re[$n+1],Zn=Re[$n+2],Xn=Re[$n+3],Yn=Re[$n+4],_i=0===qe?Gn:qn,vi=0===qe?Xn:Yn;let xi=!1;Ot&&(Jr=Math.sqrt(Math.pow(Gn-Xn,2)+Math.pow(qn-Yn,2))),_i<Oe?vi>Oe&&(Ln=Hr(Jt,Gn,qn,Xn,Yn,Oe),Ot&&(Jt.start=Nn+Jr*Ln)):_i>Ue?vi<Ue&&(Ln=Hr(Jt,Gn,qn,Xn,Yn,Ue),Ot&&(Jt.start=Nn+Jr*Ln)):ie(Jt,Gn,qn,Zn),vi<Oe&&_i>=Oe&&(Ln=Hr(Jt,Gn,qn,Xn,Yn,Oe),xi=!0),vi>Ue&&_i<=Ue&&(Ln=Hr(Jt,Gn,qn,Xn,Yn,Ue),xi=!0),!Ct&&xi&&(Ot&&(Jt.end=Nn+Jr*Ln),Le.push(Jt),Jt=oe(Re)),Ot&&(Nn+=Jr)}let $n=Re.length-3;const Gn=Re[$n],qn=Re[$n+1],Zn=0===qe?Gn:qn;Zn>=Oe&&Zn<=Ue&&ie(Jt,Gn,qn,Re[$n+2]),$n=Jt.length-3,Ct&&$n>=3&&(Jt[$n]!==Jt[0]||Jt[$n+1]!==Jt[1])&&ie(Jt,Jt[0],Jt[1],Jt[2]),Jt.length&&Le.push(Jt)}function oe(Re){const Le=[];return Le.size=Re.size,Le.start=Re.start,Le.end=Re.end,Le}function se(Re,Le,Oe,Ue,qe,Ct){for(const Ot of Re)te(Ot,Le,Oe,Ue,qe,Ct,!1)}function ie(Re,Le,Oe,Ue){Re.push(Le,Oe,Ue)}function ne(Re,Le,Oe,Ue,qe,Ct){const Ot=(Ct-Le)/(Ue-Le);return ie(Re,Ct,Oe+(qe-Oe)*Ot,1),Ot}function re(Re,Le,Oe,Ue,qe,Ct){const Ot=(Ct-Oe)/(qe-Oe);return ie(Re,Le+(Ue-Le)*Ot,Ct,1),Ot}function ae(Re,Le){const Oe=[];for(let Ue=0;Ue<Re.length;Ue++){const qe=Re[Ue],Ct=qe.type;let Ot;if("Point"===Ct||"MultiPoint"===Ct||"LineString"===Ct)Ot=le(qe.geometry,Le);else if("MultiLineString"===Ct||"Polygon"===Ct){Ot=[];for(const Re of qe.geometry)Ot.push(le(Re,Le))}else if("MultiPolygon"===Ct){Ot=[];for(const Re of qe.geometry){const Oe=[];for(const Ue of Re)Oe.push(le(Ue,Le));Ot.push(Oe)}}Oe.push(J(qe.id,Ct,Ot,qe.tags))}return Oe}function le(Re,Le){const Oe=[];Oe.size=Re.size,void 0!==Re.start&&(Oe.start=Re.start,Oe.end=Re.end);for(let Ue=0;Ue<Re.length;Ue+=3)Oe.push(Re[Ue]+Le,Re[Ue+1],Re[Ue+2]);return Oe}function ce(Re,Le){if(Re.transformed)return Re;const Oe=1<<Re.z,Ue=Re.x,qe=Re.y;for(const Ct of Re.features){const Re=Ct.geometry,Ot=Ct.type;if(Ct.geometry=[],1===Ot)for(let Ot=0;Ot<Re.length;Ot+=2)Ct.geometry.push(he(Re[Ot],Re[Ot+1],Le,Oe,Ue,qe));else for(let Ot=0;Ot<Re.length;Ot++){const Jt=[];for(let Ct=0;Ct<Re[Ot].length;Ct+=2)Jt.push(he(Re[Ot][Ct],Re[Ot][Ct+1],Le,Oe,Ue,qe));Ct.geometry.push(Jt)}}return Re.transformed=!0,Re}function he(Re,Le,Oe,Ue,qe,Ct){return[Math.round(Oe*(Re*Ue-qe)),Math.round(Oe*(Le*Ue-Ct))]}function ue(Re,Le,Oe,Ue,qe){const Ct=Le===qe.maxZoom?0:qe.tolerance/((1<<Le)*qe.extent),Ot={features:[],numPoints:0,numSimplified:0,numFeatures:Re.length,source:null,x:Oe,y:Ue,z:Le,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Le of Re)de(Ot,Le,Ct,qe);return Ot}function de(Re,Le,Oe,Ue){const qe=Le.geometry,Ct=Le.type,Ot=[];if(Re.minX=Math.min(Re.minX,Le.minX),Re.minY=Math.min(Re.minY,Le.minY),Re.maxX=Math.max(Re.maxX,Le.maxX),Re.maxY=Math.max(Re.maxY,Le.maxY),"Point"===Ct||"MultiPoint"===Ct)for(let Le=0;Le<qe.length;Le+=3)Ot.push(qe[Le],qe[Le+1]),Re.numPoints++,Re.numSimplified++;else if("LineString"===Ct)fe(Ot,qe,Re,Oe,!1,!1);else if("MultiLineString"===Ct||"Polygon"===Ct)for(let Le=0;Le<qe.length;Le++)fe(Ot,qe[Le],Re,Oe,"Polygon"===Ct,0===Le);else if("MultiPolygon"===Ct)for(let Le=0;Le<qe.length;Le++){const Ue=qe[Le];for(let Le=0;Le<Ue.length;Le++)fe(Ot,Ue[Le],Re,Oe,!0,0===Le)}if(Ot.length){let Oe=Le.tags||null;if("LineString"===Ct&&Ue.lineMetrics){Oe={};for(const Re in Le.tags)Oe[Re]=Le.tags[Re];Oe.mapbox_clip_start=qe.start/qe.size,Oe.mapbox_clip_end=qe.end/qe.size}const Jt={geometry:Ot,type:"Polygon"===Ct||"MultiPolygon"===Ct?3:"LineString"===Ct||"MultiLineString"===Ct?2:1,tags:Oe};null!==Le.id&&(Jt.id=Le.id),Re.features.push(Jt)}}function fe(Re,Le,Oe,Ue,qe,Ct){const Ot=Ue*Ue;if(Ue>0&&Le.size<(qe?Ot:Ue))return void(Oe.numPoints+=Le.length/3);const Jt=[];for(let Re=0;Re<Le.length;Re+=3)(0===Ue||Le[Re+2]>Ot)&&(Oe.numSimplified++,Jt.push(Le[Re],Le[Re+1])),Oe.numPoints++;qe&&function(Re,Le){let Oe=0;for(let Le=0,Ue=Re.length,qe=Ue-2;Le<Ue;qe=Le,Le+=2)Oe+=(Re[Le]-Re[qe])*(Re[Le+1]+Re[qe+1]);if(Oe>0===Le)for(let Le=0,Oe=Re.length;Le<Oe/2;Le+=2){const Ue=Re[Le],qe=Re[Le+1];Re[Le]=Re[Oe-2-Le],Re[Le+1]=Re[Oe-1-Le],Re[Oe-2-Le]=Ue,Re[Oe-1-Le]=qe}}(Jt,Ct),Re.push(Jt)}const Yn={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class ge{constructor(Re,Le){const Oe=(Le=this.options=function(Re,Le){for(const Oe in Le)Re[Oe]=Le[Oe];return Re}(Object.create(Yn),Le)).debug;if(Oe&&console.time("preprocess data"),Le.maxZoom<0||Le.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Le.promoteId&&Le.generateId)throw new Error("promoteId and generateId cannot be used together.");let Ue=function(Re,Le){const Oe=[];if("FeatureCollection"===Re.type)for(let Ue=0;Ue<Re.features.length;Ue++)V(Oe,Re.features[Ue],Le,Ue);else V(Oe,"Feature"===Re.type?Re:{geometry:Re},Le);return Oe}(Re,Le);this.tiles={},this.tileCoords=[],Oe&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Le.indexMaxZoom,Le.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Ue=function(Re,Le){const Oe=Le.buffer/Le.extent;let Ue=Re;const qe=H(Re,1,-1-Oe,Oe,0,-1,2,Le),Ct=H(Re,1,1-Oe,2+Oe,0,-1,2,Le);return(qe||Ct)&&(Ue=H(Re,1,-Oe,1+Oe,0,-1,2,Le)||[],qe&&(Ue=ae(qe,1).concat(Ue)),Ct&&(Ue=Ue.concat(ae(Ct,-1)))),Ue}(Ue,Le),Ue.length&&this.splitTile(Ue,0,0,0),Oe&&(Ue.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(Re,Le,Oe,Ue,qe,Ct,Ot){const Jt=[Re,Le,Oe,Ue],Hr=this.options,Jr=Hr.debug;for(;Jt.length;){Ue=Jt.pop(),Oe=Jt.pop(),Le=Jt.pop(),Re=Jt.pop();const Ln=1<<Le,Nn=me(Le,Oe,Ue);let $n=this.tiles[Nn];if(!$n&&(Jr>1&&console.time("creation"),$n=this.tiles[Nn]=ue(Re,Le,Oe,Ue,Hr),this.tileCoords.push({z:Le,x:Oe,y:Ue}),Jr)){Jr>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Le,Oe,Ue,$n.numFeatures,$n.numPoints,$n.numSimplified),console.timeEnd("creation"));const Re=`z${Le}`;this.stats[Re]=(this.stats[Re]||0)+1,this.total++}if($n.source=Re,null==qe){if(Le===Hr.indexMaxZoom||$n.numPoints<=Hr.indexMaxPoints)continue}else{if(Le===Hr.maxZoom||Le===qe)continue;if(null!=qe){const Re=qe-Le;if(Oe!==Ct>>Re||Ue!==Ot>>Re)continue}}if($n.source=null,0===Re.length)continue;Jr>1&&console.time("clipping");const Gn=.5*Hr.buffer/Hr.extent,qn=.5-Gn,Zn=.5+Gn,Xn=1+Gn;let Yn=null,_i=null,vi=null,xi=null,bi=H(Re,Ln,Oe-Gn,Oe+Zn,0,$n.minX,$n.maxX,Hr),Pi=H(Re,Ln,Oe+qn,Oe+Xn,0,$n.minX,$n.maxX,Hr);Re=null,bi&&(Yn=H(bi,Ln,Ue-Gn,Ue+Zn,1,$n.minY,$n.maxY,Hr),_i=H(bi,Ln,Ue+qn,Ue+Xn,1,$n.minY,$n.maxY,Hr),bi=null),Pi&&(vi=H(Pi,Ln,Ue-Gn,Ue+Zn,1,$n.minY,$n.maxY,Hr),xi=H(Pi,Ln,Ue+qn,Ue+Xn,1,$n.minY,$n.maxY,Hr),Pi=null),Jr>1&&console.timeEnd("clipping"),Jt.push(Yn||[],Le+1,2*Oe,2*Ue),Jt.push(_i||[],Le+1,2*Oe,2*Ue+1),Jt.push(vi||[],Le+1,2*Oe+1,2*Ue),Jt.push(xi||[],Le+1,2*Oe+1,2*Ue+1)}}getTile(Re,Le,Oe){Re=+Re,Le=+Le,Oe=+Oe;const Ue=this.options,{extent:qe,debug:Ct}=Ue;if(Re<0||Re>24)return null;const Ot=1<<Re,Jt=me(Re,Le=Le+Ot&Ot-1,Oe);if(this.tiles[Jt])return ce(this.tiles[Jt],qe);Ct>1&&console.log("drilling down to z%d-%d-%d",Re,Le,Oe);let Hr,Jr=Re,Ln=Le,Nn=Oe;for(;!Hr&&Jr>0;)Jr--,Ln>>=1,Nn>>=1,Hr=this.tiles[me(Jr,Ln,Nn)];return Hr&&Hr.source?(Ct>1&&(console.log("found parent tile z%d-%d-%d",Jr,Ln,Nn),console.time("drilling down")),this.splitTile(Hr.source,Jr,Ln,Nn,Re,Le,Oe),Ct>1&&console.timeEnd("drilling down"),this.tiles[Jt]?ce(this.tiles[Jt],qe):null):null}}function me(Re,Le,Oe){return 32*((1<<Re)*Oe+Le)+Re}function ye(Re,Le){const Oe=Re.tileID.canonical;if(!this._geoJSONIndex)return void Le(null,null);const Ue=this._geoJSONIndex.getTile(Oe.z,Oe.x,Oe.y);if(!Ue)return void Le(null,null);const qe=new p(Ue.features);let Ct=Ln(qe);0===Ct.byteOffset&&Ct.byteLength===Ct.buffer.byteLength||(Ct=new Uint8Array(Ct)),Le(null,{vectorTile:qe,rawData:Ct.buffer})}class xe extends c{constructor(Re,Le,Oe,Ue,qe,Ct){super(Re,Le,Oe,Ue,ye,Ct),qe&&(this.loadGeoJSON=qe),this._dynamicIndex=new y}loadData(Le,Oe){const Ue=Le&&Le.request,qe=Ue&&Ue.collectResourceTiming;this.loadGeoJSON(Le,((Ct,Ot)=>{if(Ct||!Ot)return Oe(Ct);if("object"!=typeof Ot)return Oe(new Error(`Input data given to '${Le.source}' is not a valid GeoJSON object.`));{try{if(Le.filter){const Oe=Re.M(Le.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===Oe.result)throw new Error(Oe.value.map((Re=>`${Re.key}: ${Re.message}`)).join(", "));Ot.features=Ot.features.filter((Re=>Oe.value.evaluate({zoom:0},Re)))}Le.dynamic?("Feature"===Ot.type&&(Ot={type:"FeatureCollection",features:[Ot]}),Le.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(Ot.features,this.loaded),Le.cluster&&(Ot.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=Le.cluster?new E(function({superclusterOptions:Le,clusterProperties:Oe}){if(!Oe||!Le)return Le;const Ue={},qe={},Ct={accumulated:null,zoom:0},Ot={properties:null},Jt=Object.keys(Oe);for(const Le of Jt){const[Ct,Ot]=Oe[Le],Jt=Re.M(Ot),Hr=Re.M("string"==typeof Ct?[Ct,["accumulated"],["get",Le]]:Ct);Ue[Le]=Jt.value,qe[Le]=Hr.value}return Le.map=Re=>{Ot.properties=Re;const Le={};for(const Re of Jt)Le[Re]=Ue[Re].evaluate(Ct,Ot);return Le},Le.reduce=(Re,Le)=>{Ot.properties=Le;for(const Le of Jt)Ct.accumulated=Re[Le],Re[Le]=qe[Le].evaluate(Ct,Ot)},Le}(Le)).load(Ot.features):Le.dynamic?this._dynamicIndex:function(Re,Le){return new ge(Re,Le)}(Ot,Le.geojsonVtOptions)}catch(Re){return Oe(Re)}const Ct={};if(qe){const Re=t(Ue);Re&&(Ct.resourceTiming={},Ct.resourceTiming[Le.source]=JSON.parse(JSON.stringify(Re)))}Oe(null,Ct)}}))}reloadTile(Re,Le){const Oe=this.loaded;return Oe&&Oe[Re.uid]?Re.partial?Le(null,void 0):super.reloadTile(Re,Le):this.loadTile(Re,Le)}loadGeoJSON(Le,Oe){if(Le.request)Re.n(Le.request,Oe);else{if("string"!=typeof Le.data)return Oe(new Error(`Input data given to '${Le.source}' is not a valid GeoJSON object.`));try{return Oe(null,JSON.parse(Le.data))}catch(Re){return Oe(new Error(`Input data given to '${Le.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(Re,Le){try{Le(null,this._geoJSONIndex.getClusterExpansionZoom(Re.clusterId))}catch(Re){Le(Re)}}getClusterChildren(Re,Le){try{Le(null,this._geoJSONIndex.getChildren(Re.clusterId))}catch(Re){Le(Re)}}getClusterLeaves(Re,Le){try{Le(null,this._geoJSONIndex.getLeaves(Re.clusterId,Re.limit,Re.offset))}catch(Re){Le(Re)}}}class we{constructor(Le,Oe){this.tileID=new Re.aA(Le.tileID.overscaledZ,Le.tileID.wrap,Le.tileID.canonical.z,Le.tileID.canonical.x,Le.tileID.canonical.y),this.tileZoom=Le.tileZoom,this.uid=Le.uid,this.zoom=Le.zoom,this.canonical=Le.tileID.canonical,this.pixelRatio=Le.pixelRatio,this.tileSize=Le.tileSize,this.source=Le.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=Le.projection,this.brightness=Oe}parse(Le,Oe,Ue,qe){this.status="parsing";const Ct=new Re.aA(Ue.tileID.overscaledZ,Ue.tileID.wrap,Ue.tileID.canonical.z,Ue.tileID.canonical.x,Ue.tileID.canonical.y),Ot={},Jt=Oe.familiesBySource[Ue.source],Hr=new Re.dR(Ct,Ue.promoteId);return Hr.bucketLayerIDs=[],Hr.is3DTile=!0,Re.e0(Le).then((Le=>{if(!Le)return qe(new Error("Could not parse tile"));const Oe=Re.e1(Le,1/Re.c8(Ue.tileID.canonical)),Jr=Le.json.extensionsUsed&&Le.json.extensionsUsed.includes("MAPBOX_mesh_features")||Le.json.asset.extras&&Le.json.asset.extras.MAPBOX_mesh_features,Ln=Le.json.extensionsUsed&&Le.json.extensionsUsed.includes("EXT_meshopt_compression"),Nn=new Re.a3(this.zoom,{brightness:this.brightness});for(const Le in Jt)for(const Ue of Jt[Le]){const Le=Ue[0];Hr.bucketLayerIDs.push(Ue.map((Re=>Re.id))),Le.recalculate(Nn,[]);const qe=new Re.e2(Oe,Ct,Jr,Ln,this.brightness,Hr);Jr||(qe.needsUpload=!0),Ot[Le.fqid]=qe,qe.evaluate(Le)}this.status="done",qe(null,{buckets:Ot,featureIndex:Hr})})).catch((Re=>qe(new Error(Re.message))))}}class be{constructor(Re,Le,Oe,Ue,qe,Ct){this.actor=Re,this.layerIndex=Le,this.brightness=Ct,this.loading={},this.loaded={}}loadTile(Le,Oe){const Ue=Le.uid,qe=this.loading[Ue]=new we(Le,this.brightness);Re.bc(Le.request,((Re,Ct)=>{const Ot=!this.loading[Ue];return delete this.loading[Ue],Ot||Re?(qe.status="done",Ot||(this.loaded[Ue]=qe),Oe(Re)):Ct&&0!==Ct.byteLength?void qe.parse(Ct,this.layerIndex,Le,((Re,Le)=>{qe.status="done",this.loaded=this.loaded||{},this.loaded[Ue]=qe,Re||!Le?Oe(Re):Oe(null,Le)})):(qe.status="done",this.loaded[Ue]=qe,Oe())}))}reloadTile(Re,Le){const Oe=this.loaded,Ue=Re.uid;if(Oe&&Oe[Ue]){const qe=Oe[Ue];qe.projection=Re.projection,qe.brightness=Re.brightness;const n=(Oe,Ue)=>{qe.reloadCallback&&(delete qe.reloadCallback,this.loadTile(Re,Le)),Le(Oe,Ue)};"parsing"===qe.status?qe.reloadCallback=n:"done"===qe.status&&this.loadTile(Re,Le)}}abortTile(Re,Le){const Oe=Re.uid;this.loading[Oe]&&delete this.loading[Oe],Le()}removeTile(Re,Le){const Oe=this.loaded,Ue=Re.uid;Oe&&Oe[Ue]&&delete Oe[Ue],Le()}}class Se{constructor(Le){this.self=Le,this.actor=new Re.e3(Le,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=Re.bL({name:"mercator"}),this.workerSourceTypes={vector:c,geojson:xe,"batched-model":be},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(Re,Le)=>{if(this.workerSourceTypes[Re])throw new Error(`Worker source with name "${Re}" already registered.`);this.workerSourceTypes[Re]=Le},this.self.registerRTLTextPlugin=Le=>{if(Re.e4.isParsed())throw new Error("RTL text plugin already registered.");Re.e4.applyArabicShaping=Le.applyArabicShaping,Re.e4.processBidirectionalText=Le.processBidirectionalText,Re.e4.processStyledBidirectionalText=Le.processStyledBidirectionalText}}clearCaches(Re,Le,Oe){delete this.layerIndexes[Re],delete this.availableImages[Re],delete this.workerSources[Re],delete this.demWorkerSources[Re],delete this.rasterArrayWorkerSource,Oe()}checkIfReady(Re,Le,Oe){Oe()}setReferrer(Re,Le){this.referrer=Le}spriteLoaded(Le,{scope:Oe,isLoaded:Ue}){if(this.isSpriteLoaded[Le]||(this.isSpriteLoaded[Le]={}),this.isSpriteLoaded[Le][Oe]=Ue,this.workerSources[Le]&&this.workerSources[Le][Oe])for(const qe in this.workerSources[Le][Oe]){const Ct=this.workerSources[Le][Oe][qe];for(const Le in Ct){const Oe=Ct[Le];Oe instanceof c&&(Oe.isSpriteLoaded=Ue,Oe.fire(new Re.x("isSpriteLoaded")))}}}setImages(Re,{scope:Le,images:Oe},Ue){if(this.availableImages[Re]||(this.availableImages[Re]={}),this.availableImages[Re][Le]=Oe,this.workerSources[Re]&&this.workerSources[Re][Le]){for(const Ue in this.workerSources[Re][Le]){const qe=this.workerSources[Re][Le][Ue];for(const Re in qe)qe[Re].availableImages=Oe}Ue()}else Ue()}setProjection(Le,Oe){this.projections[Le]=Re.bL(Oe)}setBrightness(Re,Le,Oe){this.brightness=Le,Oe()}setLayers(Re,Le,Oe){this.getLayerIndex(Re,Le.scope).replace(Le.layers,Le.options),Oe()}updateLayers(Re,Le,Oe){this.getLayerIndex(Re,Le.scope).update(Le.layers,Le.removedIds,Le.options),Oe()}loadTile(Re,Le,Oe){Le.projection=this.projections[Re]||this.defaultProjection,this.getWorkerSource(Re,Le.type,Le.source,Le.scope).loadTile(Le,Oe)}loadDEMTile(Re,Le,Oe){this.getDEMWorkerSource(Re,Le.source,Le.scope).loadTile(Le,Oe)}decodeRasterArray(Re,Le,Oe){this.getRasterArrayWorkerSource().decodeRasterArray(Le,Oe)}reloadTile(Re,Le,Oe){Le.projection=this.projections[Re]||this.defaultProjection,this.getWorkerSource(Re,Le.type,Le.source,Le.scope).reloadTile(Le,Oe)}abortTile(Re,Le,Oe){this.getWorkerSource(Re,Le.type,Le.source,Le.scope).abortTile(Le,Oe)}removeTile(Re,Le,Oe){this.getWorkerSource(Re,Le.type,Le.source,Le.scope).removeTile(Le,Oe)}removeSource(Re,Le,Oe){if(!(this.workerSources[Re]&&this.workerSources[Re][Le.scope]&&this.workerSources[Re][Le.scope][Le.type]&&this.workerSources[Re][Le.scope][Le.type][Le.source]))return;const Ue=this.workerSources[Re][Le.scope][Le.type][Le.source];delete this.workerSources[Re][Le.scope][Le.type][Le.source],void 0!==Ue.removeSource?Ue.removeSource(Le,Oe):Oe()}loadWorkerSource(Re,Le,Oe){try{this.self.importScripts(Le.url),Oe()}catch(Re){Oe(Re.toString())}}syncRTLPluginState(Le,Oe,Ue){try{Re.e4.setState(Oe);const Le=Re.e4.getPluginURL();if(Re.e4.isLoaded()&&!Re.e4.isParsed()&&null!=Le){this.self.importScripts(Le);const Oe=Re.e4.isParsed();Ue(Oe?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Le}`),Oe)}}catch(Re){Ue(Re.toString())}}setDracoUrl(Re,Le){this.dracoUrl=Le}getAvailableImages(Re,Le){this.availableImages[Re]||(this.availableImages[Re]={});let Oe=this.availableImages[Re][Le];return Oe||(Oe=[]),Oe}getLayerIndex(Re,Le){this.layerIndexes[Re]||(this.layerIndexes[Re]={});let Oe=this.layerIndexes[Re][Le];return Oe||(Oe=this.layerIndexes[Re][Le]=new i,Oe.scope=Le),Oe}getWorkerSource(Re,Le,Oe,Ue){return this.workerSources[Re]||(this.workerSources[Re]={}),this.workerSources[Re][Ue]||(this.workerSources[Re][Ue]={}),this.workerSources[Re][Ue][Le]||(this.workerSources[Re][Ue][Le]={}),this.isSpriteLoaded[Re]||(this.isSpriteLoaded[Re]={}),this.workerSources[Re][Ue][Le][Oe]||(this.workerSources[Re][Ue][Le][Oe]=new this.workerSourceTypes[Le]({send:(Le,Oe,Ue,qe,Ct,Ot)=>{this.actor.send(Le,Oe,Ue,Re,Ct,Ot)},scheduler:this.actor.scheduler},this.getLayerIndex(Re,Ue),this.getAvailableImages(Re,Ue),this.isSpriteLoaded[Re][Ue],void 0,this.brightness)),this.workerSources[Re][Ue][Le][Oe]}getDEMWorkerSource(Re,Le,Oe){return this.demWorkerSources[Re]||(this.demWorkerSources[Re]={}),this.demWorkerSources[Re][Oe]||(this.demWorkerSources[Re][Oe]={}),this.demWorkerSources[Re][Oe][Le]||(this.demWorkerSources[Re][Oe][Le]=new h),this.demWorkerSources[Re][Oe][Le]}getRasterArrayWorkerSource(){return this.rasterArrayWorkerSource||(this.rasterArrayWorkerSource=new u),this.rasterArrayWorkerSource}enforceCacheSizeLimit(Le,Oe){Re.e5(Oe)}getWorkerPerformanceMetrics(Re,Le,Oe){Oe(void 0,void 0)}}return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&(self.worker=new Se(self)),Se})),define(["./shared"],(function(Re){var Le="3.7.0";const Oe={create:"create",load:"load",fullLoad:"fullLoad"},Ue={mark(Re){performance.mark(Re)},measure(Re,Le,Oe){performance.measure(Re,Le,Oe)}};function r(Le){const Oe=Le.name.split("?")[0];return Re.a(Oe)&&Oe.includes("mapbox-gl.js")?"javascript":Re.a(Oe)&&Oe.includes("mapbox-gl.css")?"css":Re.b(Oe)?"fontRange":Re.c(Oe)?"sprite":Re.i(Oe)?"style":Re.d(Oe)?"tilejson":"other"}var qe,Ct={},Ot=function(){if(qe)return Ct;function e(Re){return!t()}function t(Re){return"not a browser"}return qe=1,Ct.supported=e,Ct.notSupportedReason=t,e.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0},Ct}();function l(Re,Le,Oe){const Ue=document.createElement(Re);return null!=Le&&(Ue.className=Le),Oe&&Oe.appendChild(Ue),Ue}function c(Re,Le,Oe){const Ue=document.createElementNS("http://www.w3.org/2000/svg",Re);for(const Re of Object.keys(Le))Ue.setAttributeNS(null,Re,String(Le[Re]));return Oe&&Oe.appendChild(Ue),Ue}const Jt="undefined"!=typeof document?document.documentElement&&document.documentElement.style:null,Hr=Jt&&void 0!==Jt.userSelect?"userSelect":"WebkitUserSelect";let Jr;function _(){Jt&&Hr&&(Jr=Jt[Hr],Jt[Hr]="none")}function p(){Jt&&Hr&&(Jt[Hr]=Jr)}function m(Re){Re.preventDefault(),Re.stopPropagation(),window.removeEventListener("click",m,!0)}function f(){window.addEventListener("click",m,!0),window.setTimeout((()=>{window.removeEventListener("click",m,!0)}),0)}function g(Re,Le){const Oe=Re.getBoundingClientRect();return y(Re,Oe,Le)}function v(Re,Le){const Oe=Re.getBoundingClientRect(),Ue=[];for(let qe=0;qe<Le.length;qe++)Ue.push(y(Re,Oe,Le[qe]));return Ue}function x(Re){return void 0!==window.InstallTrigger&&2===Re.button&&Re.ctrlKey&&window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:Re.button}function y(Le,Oe,Ue){const qe=Le.offsetWidth===Oe.width?1:Le.offsetWidth/Oe.width;return new Re.P((Ue.clientX-Oe.left)*qe,(Ue.clientY-Oe.top)*qe)}const Ln="01",Nn="NO_ACCESS_TOKEN";class T{constructor(Re,Le,Oe){this._transformRequestFn=Re,this._customAccessToken=Le,this._silenceAuthErrors=!!Oe,this._createSkuToken()}_createSkuToken(){const Re=function(){let Re="";for(let Le=0;Le<10;Le++)Re+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Ln,Re].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=Re.token,this._skuTokenExpiresAt=Re.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(Re,Le){return this._transformRequestFn&&this._transformRequestFn(Re,Le)||{url:Re}}normalizeStyleURL(Oe,Ue){if(!Re.f(Oe))return Oe;const qe=C(Oe);return qe.params.push(`sdk=js-${Le}`),qe.path=`/styles/v1${qe.path}`,this._makeAPIURL(qe,this._customAccessToken||Ue)}normalizeGlyphsURL(Le,Oe){if(!Re.f(Le))return Le;const Ue=C(Le);return Ue.path=`/fonts/v1${Ue.path}`,this._makeAPIURL(Ue,this._customAccessToken||Oe)}normalizeModelURL(Le,Oe){if(!Re.f(Le))return Le;const Ue=C(Le);return Ue.path=`/models/v1${Ue.path}`,this._makeAPIURL(Ue,this._customAccessToken||Oe)}normalizeSourceURL(Le,Oe,Ue,qe){if(!Re.f(Le))return Le;const Ct=C(Le);return Ct.path=`/v4/${Ct.authority}.json`,Ct.params.push("secure"),Ue&&Ct.params.push(`language=${Ue}`),qe&&Ct.params.push(`worldview=${qe}`),this._makeAPIURL(Ct,this._customAccessToken||Oe)}normalizeSpriteURL(Le,Oe,Ue,qe){const Ct=C(Le);return Re.f(Le)?(Ct.path=`/styles/v1${Ct.path}/sprite${Oe}${Ue}`,this._makeAPIURL(Ct,this._customAccessToken||qe)):(Ct.path+=`${Oe}${Ue}`,S(Ct))}normalizeTileURL(Le,Oe,Ue){if(this._isSkuTokenExpired()&&this._createSkuToken(),Le&&!Re.f(Le))return Le;const qe=C(Le);qe.path=qe.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${Oe||Ue&&"raster"!==qe.authority&&512===Ue?"@2x":""}${Re.m.supported?".webp":"$1"}`),"raster"===qe.authority?qe.path=`/${Re.e.RASTER_URL_PREFIX}${qe.path}`:"rasterarrays"===qe.authority?qe.path=`/${Re.e.RASTERARRAYS_URL_PREFIX}${qe.path}`:"3dtiles"===qe.authority?qe.path=`/${Re.e.TILES3D_URL_PREFIX}${qe.path}`:(qe.path=qe.path.replace(/^.+\/v4\//,"/"),qe.path=`/${Re.e.TILE_URL_VERSION}${qe.path}`);const Ct=this._customAccessToken||function(Re){for(const Le of Re){const Re=Le.match(/^access_token=(.*)$/);if(Re)return Re[1]}return null}(qe.params)||Re.e.ACCESS_TOKEN;return Re.e.REQUIRE_ACCESS_TOKEN&&Ct&&this._skuToken&&qe.params.push(`sku=${this._skuToken}`),this._makeAPIURL(qe,Ct)}canonicalizeTileURL(Le,Oe){const Ue=C(Le);if(!Ue.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!Ue.path.match(/\.[\w]+$/))return Le;let qe="mapbox://";Ue.path.match(/^\/raster\/v1\//)?qe+=`raster/${Ue.path.replace(`/${Re.e.RASTER_URL_PREFIX}/`,"")}`:Ue.path.match(/^\/rasterarrays\/v1\//)?qe+=`rasterarrays/${Ue.path.replace(`/${Re.e.RASTERARRAYS_URL_PREFIX}/`,"")}`:qe+=`tiles/${Ue.path.replace(`/${Re.e.TILE_URL_VERSION}/`,"")}`;let Ct=Ue.params;return Oe&&(Ct=Ct.filter((Re=>!Re.match(/^access_token=/)))),Ct.length&&(qe+=`?${Ct.join("&")}`),qe}canonicalizeTileset(Le,Oe){const Ue=!!Oe&&Re.f(Oe),qe=[];for(const Oe of Le.tiles||[])Re.h(Oe)?qe.push(this.canonicalizeTileURL(Oe,Ue)):qe.push(Oe);return qe}_makeAPIURL(Le,Oe){const Ue="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",qe=C(Re.e.API_URL);if(Le.protocol=qe.protocol,Le.authority=qe.authority,"http"===Le.protocol){const Re=Le.params.indexOf("secure");Re>=0&&Le.params.splice(Re,1)}if("/"!==qe.path&&(Le.path=`${qe.path}${Le.path}`),!Re.e.REQUIRE_ACCESS_TOKEN)return S(Le);if(Oe=Oe||Re.e.ACCESS_TOKEN,!this._silenceAuthErrors){if(!Oe)throw new Error(`An API access token is required to use Mapbox GL. ${Ue}`);if("s"===Oe[0])throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${Ue}`)}return Le.params=Le.params.filter((Re=>-1===Re.indexOf("access_token"))),Le.params.push(`access_token=${Oe||""}`),S(Le)}}const $n=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function C(Re){const Le=Re.match($n);if(!Le)throw new Error("Unable to parse URL object");return{protocol:Le[1],authority:Le[2],path:Le[3]||"/",params:Le[4]?Le[4].split("&"):[]}}function S(Re){const Le=Re.params.length?`?${Re.params.join("&")}`:"";return`${Re.protocol}://${Re.authority}${Re.path}${Le}`}const Gn="mapbox.eventData";function D(Le){if(!Le)return null;const Oe=Le.split(".");if(!Oe||3!==Oe.length)return null;try{return JSON.parse(Re.j(Oe[1]))}catch(Re){return null}}class R{constructor(Re){this.type=Re,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(Le){const Oe=D(Re.e.ACCESS_TOKEN);let Ue="";return Ue=Oe&&Oe.u?Re.k(Oe.u):Re.e.ACCESS_TOKEN||"",Le?`${Gn}.${Le}:${Ue}`:`${Gn}:${Ue}`}fetchEventData(){const Le=Re.s("localStorage"),Oe=this.getStorageKey(),Ue=this.getStorageKey("uuid");if(Le)try{const Re=localStorage.getItem(Oe);Re&&(this.eventData=JSON.parse(Re));const Le=localStorage.getItem(Ue);Le&&(this.anonId=Le)}catch(Le){Re.w("Unable to read from LocalStorage")}}saveEventData(){const Le=Re.s("localStorage"),Oe=this.getStorageKey(),Ue=this.getStorageKey("uuid"),qe=this.anonId;if(Le&&qe)try{localStorage.setItem(Ue,qe),Object.keys(this.eventData).length>=1&&localStorage.setItem(Oe,JSON.stringify(this.eventData))}catch(Le){Re.w("Unable to write to LocalStorage")}}processRequests(Re){}postEvent(Le,Oe,Ue,qe){if(!Re.e.EVENTS_URL)return;const Ct=C(Re.e.EVENTS_URL);Ct.params.push(`access_token=${qe||Re.e.ACCESS_TOKEN||""}`);const Ot={event:this.type,created:new Date(Le).toISOString()},Jt=Oe?Re.l(Ot,Oe):Ot,Hr={url:S(Ct),headers:{"Content-Type":"text/plain"},body:JSON.stringify([Jt])};this.pendingRequest=Re.p(Hr,(Re=>{this.pendingRequest=null,Ue(Re),this.saveEventData(),this.processRequests(qe)}))}queueRequest(Re,Le){this.queue.push(Re),this.processRequests(Le)}}const qn=new class extends R{constructor(Re){super("appUserTurnstile"),this._customAccessToken=Re}postTurnstileEvent(Le,Oe){Re.e.EVENTS_URL&&Re.e.ACCESS_TOKEN&&Array.isArray(Le)&&Le.some((Le=>Re.f(Le)||Re.h(Le)))&&this.queueRequest(Date.now(),Oe)}processRequests(Oe){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const Ue=D(Re.e.ACCESS_TOKEN),qe=Ue?Ue.u:Re.e.ACCESS_TOKEN;let Ct=qe!==this.eventData.tokenU;Re.v(this.anonId)||(this.anonId=Re.u(),Ct=!0);const Ot=this.queue.shift();if(this.eventData.lastSuccess){const Re=new Date(this.eventData.lastSuccess),Le=new Date(Ot),Oe=(Ot-this.eventData.lastSuccess)/864e5;Ct=Ct||Oe>=1||Oe<-1||Re.getDate()!==Le.getDate()}else Ct=!0;Ct?this.postEvent(Ot,{sdkIdentifier:"mapbox-gl-js",sdkVersion:Le,skuId:Ln,"enabled.telemetry":!1,userId:this.anonId},(Re=>{Re||(this.eventData.lastSuccess=Ot,this.eventData.tokenU=qe)}),Oe):this.processRequests()}},Zn=qn.postTurnstileEvent.bind(qn),Xn=new class extends R{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(Le,Oe,Ue,qe){this.skuToken=Oe,this.errorCb=qe,Re.e.EVENTS_URL&&(Ue||Re.e.ACCESS_TOKEN?this.queueRequest({id:Le,timestamp:Date.now()},Ue):this.errorCb(new Error(Nn)))}processRequests(Oe){if(this.pendingRequest||0===this.queue.length)return;const{id:Ue,timestamp:qe}=this.queue.shift();Ue&&this.success[Ue]||(this.anonId||this.fetchEventData(),Re.v(this.anonId)||(this.anonId=Re.u()),this.postEvent(qe,{sdkIdentifier:"mapbox-gl-js",sdkVersion:Le,skuId:Ln,skuToken:this.skuToken,userId:this.anonId},(Re=>{Re?this.errorCb(Re):Ue&&(this.success[Ue]=!0)}),Oe))}remove(){this.errorCb=null}},Yn=Xn.postMapLoadEvent.bind(Xn),_i=new class extends R{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(Le){let Oe=this.mapInstanceIdMap.get(Le);return Oe||(Oe=Re.u(),this.mapInstanceIdMap.set(Le,Oe)),Oe}getEventId(Re){const Le=this.eventIdPerMapInstanceMap.get(Re)||0;return this.eventIdPerMapInstanceMap.set(Re,Le+1),Le}postStyleLoadEvent(Le,Oe){const{map:Ue,style:qe,importedStyles:Ct}=Oe;if(!Re.e.EVENTS_URL||!Le&&!Re.e.ACCESS_TOKEN)return;const Ot=this.getMapInstanceId(Ue),Jt={mapInstanceId:Ot,eventId:this.getEventId(Ot),style:qe};Ct.length&&(Jt.importedStyles=Ct),this.queueRequest({timestamp:Date.now(),payload:Jt},Le)}processRequests(Re){if(this.pendingRequest||0===this.queue.length)return;const{timestamp:Le,payload:Oe}=this.queue.shift();this.postEvent(Le,Oe,(()=>{}),Re)}},vi=_i.postStyleLoadEvent.bind(_i),xi=new class extends R{constructor(){super("gljs.performance")}postPerformanceEvent(Le,Oe){Re.e.EVENTS_URL&&(Le||Re.e.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:Oe},Le)}processRequests(Ue){if(this.pendingRequest||0===this.queue.length)return;const{timestamp:qe,performanceData:Ct}=this.queue.shift(),Ot=function(Ue){const qe=performance.getEntriesByType("resource"),Ct=performance.getEntriesByType("mark"),Ot=function(Re){const Le={};if(Re)for(const Oe in Re)if("other"!==Oe)for(const Ue of Re[Oe]){const Re=`${Oe}ResolveRangeMin`,qe=`${Oe}ResolveRangeMax`,Ct=`${Oe}RequestCount`,Ot=`${Oe}RequestCachedCount`;Le[Re]=Math.min(Le[Re]||1/0,Ue.startTime),Le[qe]=Math.max(Le[qe]||-1/0,Ue.responseEnd);const n=Re=>{void 0===Le[Re]&&(Le[Re]=0),++Le[Re]};void 0!==Ue.transferSize&&0===Ue.transferSize&&n(Ot),n(Ct)}return Le}(function(Re,Le){const Oe={};if(Re)for(const Ue of Re){const Re=Le(Ue);void 0===Oe[Re]&&(Oe[Re]=[]),Oe[Re].push(Ue)}return Oe}(qe,r)),Jt=window.devicePixelRatio,Hr=navigator.connection||navigator.mozConnection||navigator.webkitConnection,Jr=Hr?Hr.effectiveType:void 0,Ln={counters:[],metadata:[],attributes:[]},d=(Re,Le,Oe)=>{null!=Oe&&Re.push({name:Le,value:Oe.toString()})};for(const Re in Ot)d(Ln.counters,Re,Ot[Re]);if(Ue.interactionRange[0]!==1/0&&Ue.interactionRange[1]!==-1/0&&(d(Ln.counters,"interactionRangeMin",Ue.interactionRange[0]),d(Ln.counters,"interactionRangeMax",Ue.interactionRange[1])),Ct)for(const Re of Object.keys(Oe)){const Le=Oe[Re],Ue=Ct.find((Re=>Re.name===Le));Ue&&d(Ln.counters,Le,Ue.startTime)}return d(Ln.counters,"visibilityHidden",Ue.visibilityHidden),d(Ln.attributes,"style",function(Le){if(Le)for(const Oe of Le){const Le=Oe.name.split("?")[0];if(Re.i(Le)){const Re=Le.split("/").slice(-2);if(2===Re.length)return`mapbox://styles/${Re[0]}/${Re[1]}`}}}(qe)),d(Ln.attributes,"terrainEnabled",Ue.terrainEnabled?"true":"false"),d(Ln.attributes,"fogEnabled",Ue.fogEnabled?"true":"false"),d(Ln.attributes,"projection",Ue.projection),d(Ln.attributes,"zoom",Ue.zoom),d(Ln.metadata,"devicePixelRatio",Jt),d(Ln.metadata,"connectionEffectiveType",Jr),d(Ln.metadata,"navigatorUserAgent",navigator.userAgent),d(Ln.metadata,"screenWidth",window.screen.width),d(Ln.metadata,"screenHeight",window.screen.height),d(Ln.metadata,"windowWidth",window.innerWidth),d(Ln.metadata,"windowHeight",window.innerHeight),d(Ln.metadata,"mapWidth",Ue.width/Jt),d(Ln.metadata,"mapHeight",Ue.height/Jt),d(Ln.metadata,"webglRenderer",Ue.renderer),d(Ln.metadata,"webglVendor",Ue.vendor),d(Ln.metadata,"sdkVersion",Le),d(Ln.metadata,"sdkIdentifier","mapbox-gl-js"),Ln}(Ct);for(const Re of Ot.metadata);for(const Re of Ot.counters);for(const Re of Ot.attributes);this.postEvent(qe,Ot,(()=>{}),Ue)}},bi=xi.postPerformanceEvent.bind(xi),Pi=new class extends R{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(Le,Oe,Ue,qe){if(!Re.e.API_URL||!Re.e.SESSION_PATH)return;const Ct=C(Re.e.API_URL+Re.e.SESSION_PATH);Ct.params.push(`sku=${Oe||""}`),Ct.params.push(`access_token=${qe||Re.e.ACCESS_TOKEN||""}`);const Ot={url:S(Ct),headers:{"Content-Type":"text/plain"}};this.pendingRequest=Re.g(Ot,(Re=>{this.pendingRequest=null,Ue(Re),this.saveEventData(),this.processRequests(qe)}))}getSessionAPI(Le,Oe,Ue,qe){this.skuToken=Oe,this.errorCb=qe,Re.e.SESSION_PATH&&Re.e.API_URL&&(Ue||Re.e.ACCESS_TOKEN?this.queueRequest({id:Le,timestamp:Date.now()},Ue):this.errorCb(new Error(Nn)))}processRequests(Re){if(this.pendingRequest||0===this.queue.length)return;const{id:Le,timestamp:Oe}=this.queue.shift();Le&&this.success[Le]||this.getSession(Oe,this.skuToken,(Re=>{Re?this.errorCb(Re):Le&&(this.success[Le]=!0)}),Re)}remove(){this.errorCb=null}},lo=Pi.getSessionAPI.bind(Pi),uo=new Set;function G(Re,Le){Le?uo.add(Re):uo.delete(Re)}class j{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages=new Set}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(Re,Le){this._updatedSourceCaches[Re]=Le,this.setDirty()}discardSourceCacheUpdate(Re){delete this._updatedSourceCaches[Re]}updateLayer(Re){const Le=Re.scope;this._updatedLayers[Le]=this._updatedLayers[Le]||new Set,this._updatedLayers[Le].add(Re.id),this.setDirty()}removeLayer(Re){const Le=Re.scope;this._removedLayers[Le]=this._removedLayers[Le]||{},this._updatedLayers[Le]=this._updatedLayers[Le]||new Set,this._removedLayers[Le][Re.id]=Re,this._updatedLayers[Le].delete(Re.id),this._updatedPaintProps.delete(Re.fqid),this.setDirty()}getRemovedLayer(Re){return this._removedLayers[Re.scope]?this._removedLayers[Re.scope][Re.id]:null}discardLayerRemoval(Re){this._removedLayers[Re.scope]&&delete this._removedLayers[Re.scope][Re.id]}getLayerUpdatesByScope(){const Re={};for(const Le in this._updatedLayers)Re[Le]=Re[Le]||{},Re[Le].updatedIds=Array.from(this._updatedLayers[Le].values());for(const Le in this._removedLayers)Re[Le]=Re[Le]||{},Re[Le].removedIds=Object.keys(this._removedLayers[Le]);return Re}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(Re){this._updatedPaintProps.add(Re.fqid),this.setDirty()}getUpdatedImages(){return Array.from(this._updatedImages.values())}updateImage(Re){this._updatedImages.add(Re),this.setDirty()}resetUpdatedImages(){this._updatedImages.clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages.clear()}}function V(Re){const{userImage:Le}=Re;return!!(Le&&Le.render&&Le.render())&&(Re.data.replace(new Uint8Array(Le.data.buffer)),!0)}class q extends Re.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.atlasImage={},this.atlasTexture={},this.dirty=!0}createScope(Le){this.images[Le]={},this.loaded[Le]=!1,this.updatedImages[Le]={},this.patterns[Le]={},this.callbackDispatchedThisFrame[Le]={},this.atlasImage[Le]=new Re.r({width:1,height:1})}isLoaded(){for(const Re in this.loaded)if(!this.loaded[Re])return!1;return!0}setLoaded(Re,Le){if(this.loaded[Le]!==Re&&(this.loaded[Le]=Re,Re)){for(const{ids:Re,callback:Oe}of this.requestors)this._notify(Re,Le,Oe);this.requestors=[]}}hasImage(Re,Le){return!!this.getImage(Re,Le)}getImage(Re,Le){return this.images[Le][Re]}addImage(Re,Le,Oe){this._validate(Re,Oe)&&(this.images[Le][Re]=Oe)}_validate(Le,Oe){let Ue=!0;return this._validateStretch(Oe.stretchX,Oe.data&&Oe.data.width)||(this.fire(new Re.t(new Error(`Image "${Le}" has invalid "stretchX" value`))),Ue=!1),this._validateStretch(Oe.stretchY,Oe.data&&Oe.data.height)||(this.fire(new Re.t(new Error(`Image "${Le}" has invalid "stretchY" value`))),Ue=!1),this._validateContent(Oe.content,Oe)||(this.fire(new Re.t(new Error(`Image "${Le}" has invalid "content" value`))),Ue=!1),Ue}_validateStretch(Re,Le){if(!Re)return!0;let Oe=0;for(const Ue of Re){if(Ue[0]<Oe||Ue[1]<Ue[0]||Le<Ue[1])return!1;Oe=Ue[1]}return!0}_validateContent(Re,Le){return!(Re&&(4!==Re.length||Re[0]<0||Le.data.width<Re[0]||Re[1]<0||Le.data.height<Re[1]||Re[2]<0||Le.data.width<Re[2]||Re[3]<0||Le.data.height<Re[3]||Re[2]<Re[0]||Re[3]<Re[1]))}updateImage(Re,Le,Oe){Oe.version=this.images[Le][Re].version+1,this.images[Le][Re]=Oe,this.updatedImages[Le][Re]=!0}removeImage(Re,Le){const Oe=this.images[Le][Re];delete this.images[Le][Re],delete this.patterns[Le][Re],Oe.userImage&&Oe.userImage.onRemove&&Oe.userImage.onRemove()}listImages(Re){return Object.keys(this.images[Re])}getImages(Re,Le,Oe){let Ue=!0;const qe=!!this.loaded[Le];if(!qe)for(const Oe of Re)this.images[Le][Oe]||(Ue=!1);qe||Ue?this._notify(Re,Le,Oe):this.requestors.push({ids:Re,scope:Le,callback:Oe})}getUpdatedImages(Re){return this.updatedImages[Re]}_notify(Le,Oe,Ue){const qe={};for(const Ue of Le){this.images[Oe][Ue]||this.fire(new Re.x("styleimagemissing",{id:Ue}));const Le=this.images[Oe][Ue];Le?qe[Ue]={data:Le.data.clone(),pixelRatio:Le.pixelRatio,sdf:Le.sdf,version:Le.version,stretchX:Le.stretchX,stretchY:Le.stretchY,content:Le.content,hasRenderCallback:Boolean(Le.userImage&&Le.userImage.render)}:Re.w(`Image "${Ue}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}Ue(null,qe)}getPixelSize(Re){const{width:Le,height:Oe}=this.atlasImage[Re];return{width:Le,height:Oe}}getPattern(Le,Oe,Ue){const qe=this.patterns[Oe][Le],Ct=this.getImage(Le,Oe);if(!Ct)return null;if(qe&&qe.position.version===Ct.version)return qe.position;if(qe)qe.position.version=Ct.version;else{const Ue={w:Ct.data.width+2*Re.y,h:Ct.data.height+2*Re.y,x:0,y:0},qe=new Re.I(Ue,Ct,Re.y);this.patterns[Oe][Le]={bin:Ue,position:qe}}return this._updatePatternAtlas(Oe,Ue),this.patterns[Oe][Le].position}bind(Le,Oe){const Ue=Le.gl;let qe=this.atlasTexture[Oe];qe?this.dirty&&(qe.update(this.atlasImage[Oe]),this.dirty=!1):(qe=new Re.T(Le,this.atlasImage[Oe],Ue.RGBA8),this.atlasTexture[Oe]=qe),qe.bind(Ue.LINEAR,Ue.CLAMP_TO_EDGE)}_updatePatternAtlas(Le,Oe){const Ue=[];for(const Re in this.patterns[Le])Ue.push(this.patterns[Le][Re].bin);const{w:qe,h:Ct}=Re.z(Ue),Ot=this.atlasImage[Le];Ot.resize({width:qe||1,height:Ct||1});for(const Ue in this.patterns[Le]){const{bin:qe,position:Ct}=this.patterns[Le][Ue];let Jt=Ct.padding;const Hr=qe.x+Jt,Jr=qe.y+Jt,Ln=this.images[Le][Ue].data,Nn=Ln.width,$n=Ln.height;Jt=Jt>1?Jt-1:Jt,Re.r.copy(Ln,Ot,{x:0,y:0},{x:Hr,y:Jr},{width:Nn,height:$n},Oe),Re.r.copy(Ln,Ot,{x:0,y:$n-Jt},{x:Hr,y:Jr-Jt},{width:Nn,height:Jt},Oe),Re.r.copy(Ln,Ot,{x:0,y:0},{x:Hr,y:Jr+$n},{width:Nn,height:Jt},Oe),Re.r.copy(Ln,Ot,{x:Nn-Jt,y:0},{x:Hr-Jt,y:Jr},{width:Jt,height:$n},Oe),Re.r.copy(Ln,Ot,{x:0,y:0},{x:Hr+Nn,y:Jr},{width:Jt,height:$n},Oe),Re.r.copy(Ln,Ot,{x:Nn-Jt,y:$n-Jt},{x:Hr-Jt,y:Jr-Jt},{width:Jt,height:Jt},Oe),Re.r.copy(Ln,Ot,{x:0,y:$n-Jt},{x:Hr+Nn,y:Jr-Jt},{width:Jt,height:Jt},Oe),Re.r.copy(Ln,Ot,{x:0,y:0},{x:Hr+Nn,y:Jr+$n},{width:Jt,height:Jt},Oe),Re.r.copy(Ln,Ot,{x:Nn-Jt,y:0},{x:Hr-Jt,y:Jr+$n},{width:Jt,height:Jt},Oe)}this.dirty=!0}beginFrame(){for(const Re in this.images)this.callbackDispatchedThisFrame[Re]={}}dispatchRenderCallbacks(Re,Le){for(const Oe of Re){if(this.callbackDispatchedThisFrame[Le][Oe])continue;this.callbackDispatchedThisFrame[Le][Oe]=!0;const Re=this.images[Le][Oe];V(Re)&&this.updateImage(Oe,Le,Re)}}}function Z(Le){const Oe=Le.key,Ue=Le.value,qe=Le.valueSpec||{},Ct=Le.objectElementValidators||{},Ot=Le.style,Jt=Le.styleSpec;let Hr=[];const Jr=Re.B(Ue);if("object"!==Jr)return[new Re.V(Oe,Ue,`object expected, ${Jr} found`)];for(const Le in Ue){const Jr=Le.split(".")[0];let Ln;Ct[Jr]?Ln=Ct[Jr]:qe[Jr]?Ln=_e:Ct["*"]?Ln=Ct["*"]:qe["*"]&&(Ln=_e),Ln?Hr=Hr.concat(Ln({key:(Oe?`${Oe}.`:Oe)+Le,value:Ue[Le],valueSpec:qe[Jr]||qe["*"],style:Ot,styleSpec:Jt,object:Ue,objectKey:Le},Ue)):Hr.push(new Re.A(Oe,Ue[Le],`unknown property "${Le}"`))}for(const Le in qe)Ct[Le]||qe[Le].required&&void 0===qe[Le].default&&void 0===Ue[Le]&&Hr.push(new Re.V(Oe,Ue,`missing required property "${Le}"`));return Hr}function H(Le){const Oe=Le.value,Ue=Le.valueSpec,qe=Le.style,Ct=Le.styleSpec,Ot=Le.key,Jt=Le.arrayElementValidator||_e;if("array"!==Re.B(Oe))return[new Re.V(Ot,Oe,`array expected, ${Re.B(Oe)} found`)];if(Ue.length&&Oe.length!==Ue.length)return[new Re.V(Ot,Oe,`array length ${Ue.length} expected, length ${Oe.length} found`)];if(Ue["min-length"]&&Oe.length<Ue["min-length"])return[new Re.V(Ot,Oe,`array length at least ${Ue["min-length"]} expected, length ${Oe.length} found`)];let Hr={type:Ue.value,values:Ue.values,minimum:Ue.minimum,maximum:Ue.maximum,function:void 0};Ct.$version<7&&(Hr.function=Ue.function),"object"===Re.B(Ue.value)&&(Hr=Ue.value);let Jr=[];for(let Re=0;Re<Oe.length;Re++)Jr=Jr.concat(Jt({array:Oe,arrayIndex:Re,value:Oe[Re],valueSpec:Hr,style:qe,styleSpec:Ct,key:`${Ot}[${Re}]`},!0));return Jr}function W(Le){const Oe=Le.key,Ue=Le.value,qe=Le.valueSpec;let Ct=Re.B(Ue);if("number"===Ct&&Ue!=Ue&&(Ct="NaN"),"number"!==Ct)return[new Re.V(Oe,Ue,`number expected, ${Ct} found`)];if("minimum"in qe){let Ct=qe.minimum;if("array"===Re.B(qe.minimum)&&(Ct=qe.minimum[Le.arrayIndex]),Ue<Ct)return[new Re.V(Oe,Ue,`${Ue} is less than the minimum value ${Ct}`)]}if("maximum"in qe){let Ct=qe.maximum;if("array"===Re.B(qe.maximum)&&(Ct=qe.maximum[Le.arrayIndex]),Ue>Ct)return[new Re.V(Oe,Ue,`${Ue} is greater than the maximum value ${Ct}`)]}return[]}function $(Le){const Oe=Le.valueSpec,Ue=Re.D(Le.value.type);let qe,Ct,Ot,Jt={};const Hr="categorical"!==Ue&&void 0===Le.value.property,Jr=!Hr,Ln="array"===Re.B(Le.value.stops)&&"array"===Re.B(Le.value.stops[0])&&"object"===Re.B(Le.value.stops[0][0]),Nn=Z({key:Le.key,value:Le.value,valueSpec:Le.styleSpec.function,style:Le.style,styleSpec:Le.styleSpec,objectElementValidators:{stops:function(Le){if("identity"===Ue)return[new Re.V(Le.key,Le.value,'identity function may not have a "stops" property')];let Oe=[];const qe=Le.value;return Oe=Oe.concat(H({key:Le.key,value:qe,valueSpec:Le.valueSpec,style:Le.style,styleSpec:Le.styleSpec,arrayElementValidator:d})),"array"===Re.B(qe)&&0===qe.length&&Oe.push(new Re.V(Le.key,qe,"array must have at least one stop")),Oe},default:function(Re){return _e({key:Re.key,value:Re.value,valueSpec:Oe,style:Re.style,styleSpec:Re.styleSpec})}}});return"identity"===Ue&&Hr&&Nn.push(new Re.V(Le.key,Le.value,'missing required property "property"')),"identity"===Ue||Le.value.stops||Nn.push(new Re.V(Le.key,Le.value,'missing required property "stops"')),"exponential"===Ue&&Le.valueSpec.expression&&!Re.F(Le.valueSpec)&&Nn.push(new Re.V(Le.key,Le.value,"exponential functions not supported")),Le.styleSpec.$version>=8&&(Jr&&!Re.G(Le.valueSpec)?Nn.push(new Re.V(Le.key,Le.value,"property functions not supported")):Hr&&!Re.H(Le.valueSpec)&&Nn.push(new Re.V(Le.key,Le.value,"zoom functions not supported"))),"categorical"!==Ue&&!Ln||void 0!==Le.value.property||Nn.push(new Re.V(Le.key,Le.value,'"property" property is required')),Nn;function d(Le){let Ue=[];const qe=Le.value,Hr=Le.key;if("array"!==Re.B(qe))return[new Re.V(Hr,qe,`array expected, ${Re.B(qe)} found`)];if(2!==qe.length)return[new Re.V(Hr,qe,`array length 2 expected, length ${qe.length} found`)];if(Ln){if("object"!==Re.B(qe[0]))return[new Re.V(Hr,qe,`object expected, ${Re.B(qe[0])} found`)];if(void 0===qe[0].zoom)return[new Re.V(Hr,qe,"object stop key must have zoom")];if(void 0===qe[0].value)return[new Re.V(Hr,qe,"object stop key must have value")];const Oe=Re.D(qe[0].zoom);if("number"!=typeof Oe)return[new Re.V(Hr,qe[0].zoom,"stop zoom values must be numbers")];if(Ot&&Ot>Oe)return[new Re.V(Hr,qe[0].zoom,"stop zoom values must appear in ascending order")];Oe!==Ot&&(Ot=Oe,Ct=void 0,Jt={}),Ue=Ue.concat(Z({key:`${Hr}[0]`,value:qe[0],valueSpec:{zoom:{}},style:Le.style,styleSpec:Le.styleSpec,objectElementValidators:{zoom:W,value:_}}))}else Ue=Ue.concat(_({key:`${Hr}[0]`,value:qe[0],valueSpec:{},style:Le.style,styleSpec:Le.styleSpec},qe));return Re.J(Re.K(qe[1]))?Ue.concat([new Re.V(`${Hr}[1]`,qe[1],"expressions are not allowed in function stops.")]):Ue.concat(_e({key:`${Hr}[1]`,value:qe[1],valueSpec:Oe,style:Le.style,styleSpec:Le.styleSpec}))}function _(Le,Ot){const Hr=Re.B(Le.value),Jr=Re.D(Le.value),Ln=null!==Le.value?Le.value:Ot;if(qe){if(Hr!==qe)return[new Re.V(Le.key,Ln,`${Hr} stop domain type must match previous stop domain type ${qe}`)]}else qe=Hr;if("number"!==Hr&&"string"!==Hr&&"boolean"!==Hr&&"number"!=typeof Jr&&"string"!=typeof Jr&&"boolean"!=typeof Jr)return[new Re.V(Le.key,Ln,"stop domain value must be a number, string, or boolean")];if("number"!==Hr&&"categorical"!==Ue){let qe=`number expected, ${Hr} found`;return Re.G(Oe)&&void 0===Ue&&(qe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Re.V(Le.key,Ln,qe)]}return"categorical"!==Ue||"number"!==Hr||"number"==typeof Jr&&isFinite(Jr)&&Math.floor(Jr)===Jr?"categorical"!==Ue&&"number"===Hr&&"number"==typeof Jr&&"number"==typeof Ct&&void 0!==Ct&&Jr<Ct?[new Re.V(Le.key,Ln,"stop domain values must appear in ascending order")]:(Ct=Jr,"categorical"===Ue&&Jr in Jt?[new Re.V(Le.key,Ln,"stop domain values must be unique")]:(Jt[Jr]=!0,[])):[new Re.V(Le.key,Ln,`integer expected, found ${String(Jr)}`)]}}function X(Le){const Oe=("property"===Le.expressionContext?Re.L:Re.M)(Re.K(Le.value),Le.valueSpec);if("error"===Oe.result)return Oe.value.map((Oe=>new Re.V(`${Le.key}${Oe.key}`,Le.value,Oe.message)));const Ue=Oe.value.expression||Oe.value._styleExpression.expression;if("property"===Le.expressionContext&&"text-font"===Le.propertyKey&&!Ue.outputDefined())return[new Re.V(Le.key,Le.value,`Invalid data expression for "${Le.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===Le.expressionContext&&"layout"===Le.propertyType&&!Re.N(Ue))return[new Re.V(Le.key,Le.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===Le.expressionContext)return Y(Ue,Le);if(Le.expressionContext&&0===Le.expressionContext.indexOf("cluster")){if(!Re.O(Ue,["zoom","feature-state"]))return[new Re.V(Le.key,Le.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===Le.expressionContext&&!Re.Q(Ue))return[new Re.V(Le.key,Le.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Y(Le,Oe){const Ue=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(Oe.valueSpec&&Oe.valueSpec.expression)for(const Re of Oe.valueSpec.expression.parameters)Ue.delete(Re);if(0===Ue.size)return[];const qe=[];return Le instanceof Re.S&&Ue.has(Le.name)?[new Re.V(Oe.key,Oe.value,`["${Le.name}"] expression is not supported in a filter for a ${Oe.object.type} layer with id: ${Oe.object.id}`)]:(Le.eachChild((Re=>{qe.push(...Y(Re,Oe))})),qe)}function K(Le){const Oe=Le.key,Ue=Le.value,qe=Le.valueSpec,Ct=[];return Array.isArray(qe.values)?-1===qe.values.indexOf(Re.D(Ue))&&Ct.push(new Re.V(Oe,Ue,`expected one of [${qe.values.join(", ")}], ${JSON.stringify(Ue)} found`)):-1===Object.keys(qe.values).indexOf(Re.D(Ue))&&Ct.push(new Re.V(Oe,Ue,`expected one of [${Object.keys(qe.values).join(", ")}], ${JSON.stringify(Ue)} found`)),Ct}function J(Le){return Re.W(Re.K(Le.value))?X(Re.C({},Le,{expressionContext:"filter",valueSpec:Le.styleSpec[`filter_${Le.layerType||"fill"}`]})):Q(Le)}function Q(Le){const Oe=Le.value,Ue=Le.key;if("array"!==Re.B(Oe))return[new Re.V(Ue,Oe,`array expected, ${Re.B(Oe)} found`)];const qe=Le.styleSpec;let Ct,Ot=[];if(Oe.length<1)return[new Re.V(Ue,Oe,"filter array must have at least 1 element")];switch(Ot=Ot.concat(K({key:`${Ue}[0]`,value:Oe[0],valueSpec:qe.filter_operator,style:Le.style,styleSpec:Le.styleSpec})),Re.D(Oe[0])){case"<":case"<=":case">":case">=":Oe.length>=2&&"$type"===Re.D(Oe[1])&&Ot.push(new Re.V(Ue,Oe,`"$type" cannot be use with operator "${Oe[0]}"`));case"==":case"!=":3!==Oe.length&&Ot.push(new Re.V(Ue,Oe,`filter array for operator "${Oe[0]}" must have 3 elements`));case"in":case"!in":Oe.length>=2&&(Ct=Re.B(Oe[1]),"string"!==Ct&&Ot.push(new Re.V(`${Ue}[1]`,Oe[1],`string expected, ${Ct} found`)));for(let Jt=2;Jt<Oe.length;Jt++)Ct=Re.B(Oe[Jt]),"$type"===Re.D(Oe[1])?Ot=Ot.concat(K({key:`${Ue}[${Jt}]`,value:Oe[Jt],valueSpec:qe.geometry_type,style:Le.style,styleSpec:Le.styleSpec})):"string"!==Ct&&"number"!==Ct&&"boolean"!==Ct&&Ot.push(new Re.V(`${Ue}[${Jt}]`,Oe[Jt],`string, number, or boolean expected, ${Ct} found`));break;case"any":case"all":case"none":for(let Re=1;Re<Oe.length;Re++)Ot=Ot.concat(Q({key:`${Ue}[${Re}]`,value:Oe[Re],style:Le.style,styleSpec:Le.styleSpec}));break;case"has":case"!has":Ct=Re.B(Oe[1]),2!==Oe.length?Ot.push(new Re.V(Ue,Oe,`filter array for "${Oe[0]}" operator must have 2 elements`)):"string"!==Ct&&Ot.push(new Re.V(`${Ue}[1]`,Oe[1],`string expected, ${Ct} found`))}return Ot}function ee(Le,Oe){const Ue=Le.key,qe=Le.style,Ct=Le.layer,Ot=Le.styleSpec,Jt=Le.value,Hr=Le.objectKey,Jr=Ot[`${Oe}_${Le.layerType}`];if(!Jr)return[];const Ln=Hr.match(/^(.*)-transition$/);if("paint"===Oe&&Ln&&Jr[Ln[1]]&&Jr[Ln[1]].transition)return _e({key:Ue,value:Jt,valueSpec:Ot.transition,style:qe,styleSpec:Ot});const Nn=Le.valueSpec||Jr[Hr];if(!Nn)return[new Re.A(Ue,Jt,`unknown property "${Hr}"`)];let $n;if("string"===Re.B(Jt)&&Re.G(Nn)&&!Nn.tokens&&($n=/^{([^}]+)}$/.exec(Jt))){const Le=`\`{ "type": "identity", "property": ${$n?JSON.stringify($n[1]):'"_"'} }\``;return[new Re.V(Ue,Jt,`"${Hr}" does not support interpolation syntax\nUse an identity property function instead: ${Le}.`)]}const Gn=[];if("symbol"===Le.layerType)"text-field"!==Hr||!qe||qe.glyphs||qe.imports||Gn.push(new Re.V(Ue,Jt,'use of "text-field" requires a style "glyphs" property')),"text-font"===Hr&&Re.X(Re.K(Jt))&&"identity"===Re.D(Jt.type)&&Gn.push(new Re.V(Ue,Jt,'"text-font" does not support identity functions'));else if("model"===Le.layerType&&"paint"===Oe&&Ct&&Ct.layout&&Ct.layout.hasOwnProperty("model-id")&&Re.G(Nn)&&(Re.Y(Nn)||Re.H(Nn))){const Le=Re.L(Re.K(Jt),Nn),Oe=Le.value.expression||Le.value._styleExpression.expression;Oe&&!Re.O(Oe,["measure-light"])&&("model-emissive-strength"===Hr&&Re.Q(Oe)&&Re.N(Oe)||Gn.push(new Re.V(Ue,Jt,`${Hr} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return Gn.concat(_e({key:Le.key,value:Jt,valueSpec:Nn,style:qe,styleSpec:Ot,expressionContext:"property",propertyType:Oe,propertyKey:Hr}))}function te(Re){return ee(Re,"paint")}function ie(Re){return ee(Re,"layout")}function oe(Le){let Oe=[];const Ue=Le.value,qe=Le.key,Ct=Le.style,Ot=Le.styleSpec;Ue.type||Ue.ref||Oe.push(new Re.V(qe,Ue,'either "type" or "ref" is required'));let Jt=Re.D(Ue.type);const Hr=Re.D(Ue.ref);if(Ue.id){const Ot=Re.D(Ue.id);for(let Jt=0;Jt<Le.arrayIndex;Jt++){const Le=Ct.layers[Jt];Re.D(Le.id)===Ot&&Oe.push(new Re.V(qe,Ue.id,`duplicate layer id "${Ue.id}", previously used at line ${Le.id.__line__}`))}}if("ref"in Ue){let Le;["type","source","source-layer","filter","layout"].forEach((Le=>{Le in Ue&&Oe.push(new Re.V(qe,Ue[Le],`"${Le}" is prohibited for ref layers`))})),Ct.layers.forEach((Oe=>{Re.D(Oe.id)===Hr&&(Le=Oe)})),Le?Le.ref?Oe.push(new Re.V(qe,Ue.ref,"ref cannot reference another ref layer")):Jt=Re.D(Le.type):"string"==typeof Hr&&Oe.push(new Re.V(qe,Ue.ref,`ref layer "${Hr}" not found`))}else if("background"!==Jt&&"sky"!==Jt&&"slot"!==Jt)if(Ue.source){const Le=Ct.sources&&Ct.sources[Ue.source],Ot=Le&&Re.D(Le.type);Le?"vector"===Ot&&"raster"===Jt?Oe.push(new Re.V(qe,Ue.source,`layer "${Ue.id}" requires a raster source`)):"raster"===Ot&&"raster"!==Jt?Oe.push(new Re.V(qe,Ue.source,`layer "${Ue.id}" requires a vector source`)):"vector"!==Ot||Ue["source-layer"]?"raster-dem"===Ot&&"hillshade"!==Jt?Oe.push(new Re.V(qe,Ue.source,"raster-dem source can only be used with layer type 'hillshade'.")):"raster-array"!==Ot||["raster","raster-particle"].includes(Jt)?"line"!==Jt||!Ue.paint||!Ue.paint["line-gradient"]&&!Ue.paint["line-trim-offset"]||"geojson"===Ot&&Le.lineMetrics?"raster-particle"===Jt&&"raster-array"!==Ot&&Oe.push(new Re.V(qe,Ue.source,`layer "${Ue.id}" requires a 'raster-array' source.`)):Oe.push(new Re.V(qe,Ue,`layer "${Ue.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):Oe.push(new Re.V(qe,Ue.source,"raster-array source can only be used with layer type 'raster'.")):Oe.push(new Re.V(qe,Ue,`layer "${Ue.id}" must specify a "source-layer"`)):Oe.push(new Re.V(qe,Ue.source,`source "${Ue.source}" not found`))}else Oe.push(new Re.V(qe,Ue,'missing required property "source"'));return Oe=Oe.concat(Z({key:qe,value:Ue,valueSpec:Ot.layer,style:Le.style,styleSpec:Le.styleSpec,objectElementValidators:{"*":()=>[],type:()=>_e({key:`${qe}.type`,value:Ue.type,valueSpec:Ot.layer.type,style:Le.style,styleSpec:Le.styleSpec,object:Ue,objectKey:"type"}),filter:Le=>J(Re.C({layerType:Jt},Le)),layout:Le=>Z({layer:Ue,key:Le.key,value:Le.value,valueSpec:{},style:Le.style,styleSpec:Le.styleSpec,objectElementValidators:{"*":Le=>ie(Re.C({layerType:Jt},Le))}}),paint:Le=>Z({layer:Ue,key:Le.key,value:Le.value,valueSpec:{},style:Le.style,styleSpec:Le.styleSpec,objectElementValidators:{"*":Le=>te(Re.C({layerType:Jt,layer:Ue},Le))}})}})),Oe}function re(Le){const Oe=Le.value,Ue=Le.key,qe=Re.B(Oe);return"string"!==qe?[new Re.V(Ue,Oe,`string expected, ${qe} found`)]:[]}const po={promoteId:function({key:Le,value:Oe}){if("string"===Re.B(Oe))return re({key:Le,value:Oe});{const Re=[];for(const Ue in Oe)Re.push(...re({key:`${Le}.${Ue}`,value:Oe[Ue]}));return Re}}};function ae(Le){const Oe=Le.value,Ue=Le.key,qe=Le.styleSpec,Ct=Le.style;if(!Oe.type)return[new Re.V(Ue,Oe,'"type" is required')];const Ot=Re.D(Oe.type);let Jt=[];switch(["vector","raster","raster-dem","raster-array"].includes(Ot)&&(Oe.url||Oe.tiles||Jt.push(new Re.A(Ue,Oe,'Either "url" or "tiles" is required.'))),Ot){case"vector":case"raster":case"raster-dem":case"raster-array":return Jt=Jt.concat(Z({key:Ue,value:Oe,valueSpec:qe[`source_${Ot.replace("-","_")}`],style:Le.style,styleSpec:qe,objectElementValidators:po})),Jt;case"geojson":if(Jt=Z({key:Ue,value:Oe,valueSpec:qe.source_geojson,style:Ct,styleSpec:qe,objectElementValidators:po}),Oe.cluster)for(const Re in Oe.clusterProperties){const[Le,qe]=Oe.clusterProperties[Re],Ct="string"==typeof Le?[Le,["accumulated"],["get",Re]]:Le;Jt.push(...X({key:`${Ue}.${Re}.map`,value:qe,expressionContext:"cluster-map"})),Jt.push(...X({key:`${Ue}.${Re}.reduce`,value:Ct,expressionContext:"cluster-reduce"}))}return Jt;case"video":return Z({key:Ue,value:Oe,valueSpec:qe.source_video,style:Ct,styleSpec:qe});case"image":return Z({key:Ue,value:Oe,valueSpec:qe.source_image,style:Ct,styleSpec:qe});case"canvas":return[new Re.V(Ue,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return K({key:`${Ue}.type`,value:Oe.type,valueSpec:{values:ne(qe)},style:Ct,styleSpec:qe})}}function ne(Re){return Re.source.reduce(((Le,Oe)=>{const Ue=Re[Oe];return"enum"===Ue.type.type&&(Le=Le.concat(Object.keys(Ue.type.values))),Le}),[])}function le(Le){const Oe=Le.value,Ue=Le.styleSpec,qe=Ue.light,Ct=Le.style;let Ot=[];const Jt=Re.B(Oe);if(void 0===Oe)return Ot;if("object"!==Jt)return Ot=Ot.concat([new Re.V("light",Oe,`object expected, ${Jt} found`)]),Ot;for(const Le in Oe){const Jt=Le.match(/^(.*)-transition$/);Ot=Ot.concat(Jt&&qe[Jt[1]]&&qe[Jt[1]].transition?_e({key:Le,value:Oe[Le],valueSpec:Ue.transition,style:Ct,styleSpec:Ue}):qe[Le]?_e({key:Le,value:Oe[Le],valueSpec:qe[Le],style:Ct,styleSpec:Ue}):[new Re.V(Le,Oe[Le],`unknown property "${Le}"`)])}return Ot}function ce(Le){const Oe=Le.value;let Ue=[];if(!Oe)return Ue;const qe=Re.B(Oe);if("object"!==qe)return Ue=Ue.concat([new Re.V("light-3d",Oe,`object expected, ${qe} found`)]),Ue;const Ct=Le.styleSpec,Ot=Ct["light-3d"],Jt=Le.key,Hr=Le.style,Jr=Le.style.lights;for(const Le of["type","id"])if(!(Le in Oe))return Ue=Ue.concat([new Re.V("light-3d",Oe,`missing property ${Le} on light`)]),Ue;if(Oe.type&&Jr)for(let qe=0;qe<Le.arrayIndex;qe++){const Le=Re.D(Oe.type),Ct=Jr[qe];Re.D(Ct.type)===Le&&Ue.push(new Re.V(Jt,Oe.id,`duplicate light type "${Oe.type}", previously defined at line ${Ct.id.__line__}`))}const Ln=`properties_light_${Oe.type}`;if(!(Ln in Ct))return Ue=Ue.concat([new Re.V("light-3d",Oe,`Invalid light type ${Oe.type}`)]),Ue;const Nn=Ct[Ln];for(const qe in Oe)if("properties"===qe){const Ot=Oe[qe],Jt=Re.B(Ot);if("object"!==Jt)return Ue=Ue.concat([new Re.V("properties",Ot,`object expected, ${Jt} found`)]),Ue;for(const Oe in Ot)Ue=Ue.concat(Nn[Oe]?_e({key:Oe,value:Ot[Oe],valueSpec:Nn[Oe],style:Hr,styleSpec:Ct}):[new Re.A(Le.key,Ot[Oe],`unknown property "${Oe}"`)])}else{const Le=qe.match(/^(.*)-transition$/);Ue=Ue.concat(Le&&Ot[Le[1]]&&Ot[Le[1]].transition?_e({key:qe,value:Oe[qe],valueSpec:Ct.transition,style:Hr,styleSpec:Ct}):Ot[qe]?_e({key:qe,value:Oe[qe],valueSpec:Ot[qe],style:Hr,styleSpec:Ct}):[new Re.A(qe,Oe[qe],`unknown property "${qe}"`)])}return Ue}function he(Le){const Oe=Le.value,Ue=Le.key,qe=Le.style,Ct=Le.styleSpec,Ot=Ct.terrain;let Jt=[];const Hr=Re.B(Oe);if(void 0===Oe)return Jt;if("null"===Hr)return Jt;if("object"!==Hr)return Jt=Jt.concat([new Re.V("terrain",Oe,`object expected, ${Hr} found`)]),Jt;for(const Le in Oe){const Ue=Le.match(/^(.*)-transition$/);Jt=Jt.concat(Ue&&Ot[Ue[1]]&&Ot[Ue[1]].transition?_e({key:Le,value:Oe[Le],valueSpec:Ct.transition,style:qe,styleSpec:Ct}):Ot[Le]?_e({key:Le,value:Oe[Le],valueSpec:Ot[Le],style:qe,styleSpec:Ct}):[new Re.A(Le,Oe[Le],`unknown property "${Le}"`)])}if(Oe.source){const Le=qe.sources&&qe.sources[Oe.source],Ct=Le&&Re.D(Le.type);Le?"raster-dem"!==Ct&&Jt.push(new Re.V(Ue,Oe.source,`terrain cannot be used with a source of type ${String(Ct)}, it only be used with a "raster-dem" source type`)):Jt.push(new Re.V(Ue,Oe.source,`source "${Oe.source}" not found`))}else Jt.push(new Re.V(Ue,Oe,'terrain is missing required property "source"'));return Jt}function ue(Le){const Oe=Le.value,Ue=Le.style,qe=Le.styleSpec,Ct=qe.fog;let Ot=[];const Jt=Re.B(Oe);if(void 0===Oe)return Ot;if("object"!==Jt)return Ot=Ot.concat([new Re.V("fog",Oe,`object expected, ${Jt} found`)]),Ot;for(const Le in Oe){const Jt=Le.match(/^(.*)-transition$/);Ot=Ot.concat(Jt&&Ct[Jt[1]]&&Ct[Jt[1]].transition?_e({key:Le,value:Oe[Le],valueSpec:qe.transition,style:Ue,styleSpec:qe}):Ct[Le]?_e({key:Le,value:Oe[Le],valueSpec:Ct[Le],style:Ue,styleSpec:qe}):[new Re.A(Le,Oe[Le],`unknown property "${Le}"`)])}return Ot}const fo={"*":()=>[],array:H,boolean:function(Le){const Oe=Le.value,Ue=Le.key,qe=Re.B(Oe);return"boolean"!==qe?[new Re.V(Ue,Oe,`boolean expected, ${qe} found`)]:[]},number:W,color:function(Le){const Oe=Le.key,Ue=Le.value,qe=Re.B(Ue);return"string"!==qe?[new Re.V(Oe,Ue,`color expected, ${qe} found`)]:null===Re.U.parseCSSColor(Ue)?[new Re.V(Oe,Ue,`color expected, "${Ue}" found`)]:[]},enum:K,filter:J,function:$,layer:oe,object:Z,source:ae,model:Re.Z,light:le,"light-3d":ce,terrain:he,fog:ue,string:re,formatted:function(Re){return 0===re(Re).length?[]:X(Re)},resolvedImage:function(Re){return 0===re(Re).length?[]:X(Re)},projection:function(Le){const Oe=Le.value,Ue=Le.styleSpec,qe=Ue.projection,Ct=Le.style;let Ot=[];const Jt=Re.B(Oe);if("object"===Jt)for(const Re in Oe)Ot=Ot.concat(_e({key:Re,value:Oe[Re],valueSpec:qe[Re],style:Ct,styleSpec:Ue}));else"string"!==Jt&&(Ot=Ot.concat([new Re.V("projection",Oe,`object or string expected, ${Jt} found`)]));return Ot},import:function(Le){const{value:Oe,styleSpec:Ue}=Le,{data:qe,...Ct}=Oe;Object.defineProperty(Ct,"__line__",{value:Oe.__line__,enumerable:!1});let Ot=Z(Re.C({},Le,{value:Ct,valueSpec:Ue.import}));return""===Re.D(Ct.id)&&Ot.push(new Re.V(`${Le.key}.id`,Ct,"import id can't be an empty string")),qe&&(Ot=Ot.concat(me(qe,Ue,{key:`${Le.key}.data`}))),Ot}};function _e(Le,Oe=!1){const Ue=Le.value,qe=Le.valueSpec,Ct=Le.styleSpec;if(qe.expression&&Re.X(Re.D(Ue)))return $(Le);if(qe.expression&&Re.J(Re.K(Ue)))return X(Le);if(qe.type&&fo[qe.type]){const Ue=fo[qe.type](Le);return!0===Oe&&Ue.length>0&&"array"===Re.B(Le.value)?X(Le):Ue}return Z(Re.C({},Le,{valueSpec:qe.type?Ct[qe.type]:qe}))}function pe(Le){const Oe=Le.value,Ue=Le.key,qe=re(Le);return qe.length||(-1===Oe.indexOf("{fontstack}")&&qe.push(new Re.V(Ue,Oe,'"glyphs" url must include a "{fontstack}" token')),-1===Oe.indexOf("{range}")&&qe.push(new Re.V(Ue,Oe,'"glyphs" url must include a "{range}" token'))),qe}function me(Le,Oe=Re._,Ue={}){return _e({key:Ue.key||"",value:Le,valueSpec:Oe.$root,styleSpec:Oe,style:Le,objectElementValidators:{glyphs:pe,"*":()=>[]}})}function fe(Le,Oe=Re._){return Ie(me(Le,Oe))}const ge=Re=>Ie(ae(Re)),ve=Re=>Ie(le(Re)),xe=Re=>Ie(ce(Re)),ye=Re=>Ie(he(Re)),be=Re=>Ie(ue(Re)),we=Re=>Ie(oe(Re)),Te=Re=>Ie(J(Re)),Ee=Re=>Ie(te(Re)),Ce=Re=>Ie(ie(Re)),Se=Le=>Ie(Re.Z(Le));function Ie(Re){return Re.slice().sort(((Re,Le)=>Re.line&&Le.line?Re.line-Le.line:0))}function De(Le,Oe){let Ue=!1;if(Oe&&Oe.length)for(const qe of Oe)qe instanceof Re.A?Re.w(qe.message):(Le.fire(new Re.t(new Error(qe.message))),Ue=!0);return Ue}let Io;class Ae extends Re.E{constructor(Le,Oe="flat"){super(),this._transitionable=new Re.$(Io||(Io=new Re.a0({anchor:new Re.a1(Re._.light.anchor),position:new Re.a2(Re._.light.position),color:new Re.a1(Re._.light.color),intensity:new Re.a1(Re._.light.intensity)}))),this.setLight(Le,Oe),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(Re,Le,Oe={}){this._validate(ve,Re,Oe)||(this._transitionable.setTransitionOrValue(Re),this.id=Le)}updateTransitions(Re){this._transitioning=this._transitionable.transitioned(Re,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(Re){this.properties=this._transitioning.possiblyEvaluate(Re)}_validate(Le,Oe,Ue){return(!Ue||!1!==Ue.validate)&&De(this,Le.call(fe,Re.l({value:Oe,style:{glyphs:!0,sprite:!0},styleSpec:Re._})))}}const is=new Re.a0({source:new Re.a1(Re._.terrain.source),exaggeration:new Re.a1(Re._.terrain.exaggeration)});let as=class extends Re.E{constructor(Le,Oe,Ue,qe){super(),this.scope=Ue,this._transitionable=new Re.$(is,Ue,qe),this._transitionable.setTransitionOrValue(Le,qe),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=Oe}get(){return this._transitionable.serialize()}set(Re,Le){this._transitionable.setTransitionOrValue(Re,Le)}updateTransitions(Re){this._transitioning=this._transitionable.transitioned(Re,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(Re){this.properties=this._transitioning.possiblyEvaluate(Re)}getExaggeration(Le){return this._transitioning.possiblyEvaluate(new Re.a3(Le)).get("exaggeration")}isZoomDependent(){const Le=this._transitionable._values.exaggeration;return null!=Le&&null!=Le.value&&null!=Le.value.expression&&Le.value.expression instanceof Re.a4}};const Is=45,Xs=65,ta=.05;function Fe(Le,Oe,Ue,qe){const Ct=Re.a7(Is,Xs,Ue),[Ot,Jt]=ke(Le,qe);let Hr=1-Math.min(1,Math.exp((Oe-Ot)/(Jt-Ot)*-6));return Hr*=Hr*Hr,Hr=Math.min(1,1.00747*Hr),Hr*Ct*Le.alpha}function ke(Re,Le){const Oe=.5/Math.tan(.5*Le);return[Re.range[0]+Oe,Re.range[1]+Oe]}function Be(Le,Oe,Ue,qe,Ct){const Ot=Re.a6.vec3.transformMat4([],[Oe,Ue,qe],Ct.mercatorFogMatrix);return Fe(Le,Re.a6.vec3.length(Ot),Ct.pitch,Ct._fov)}function Ne(Le,Oe,Ue,qe,Ct,Ot,Jt){const Hr=[[Ue,qe,0],[Ct,qe,0],[Ct,Ot,0],[Ue,Ot,0]];let Jr=Number.MAX_VALUE,Ln=-Number.MAX_VALUE;for(const Le of Hr){const Ue=Re.a6.vec3.transformMat4([],Le,Oe),qe=Re.a6.vec3.length(Ue);Jr=Math.min(Jr,qe),Ln=Math.max(Ln,qe)}return[Fe(Le,Jr,Jt.pitch,Jt._fov),Fe(Le,Ln,Jt.pitch,Jt._fov)]}const ha=new Re.a0({range:new Re.a1(Re._.fog.range),color:new Re.a1(Re._.fog.color),"high-color":new Re.a1(Re._.fog["high-color"]),"space-color":new Re.a1(Re._.fog["space-color"]),"horizon-blend":new Re.a1(Re._.fog["horizon-blend"]),"star-intensity":new Re.a1(Re._.fog["star-intensity"]),"vertical-range":new Re.a1(Re._.fog["vertical-range"])});class Ge extends Re.E{constructor(Le,Oe,Ue,qe){super(),this._transitionable=new Re.$(ha,Ue,new Map(qe)),this.set(Le,qe),this._transitioning=this._transitionable.untransitioned(),this._transform=Oe,this.properties=new Re.a8(ha),this.scope=Ue}get state(){const Le=this._transform,Oe="globe"===Le.projection.name,Ue=Re.a9(Le.zoom),qe=this.properties.get("range"),Ct=[.5,3];return{range:Oe?[Re.aa(Ct[0],qe[0],Ue),Re.aa(Ct[1],qe[1],Ue)]:qe,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(Le,Oe,Ue={}){if(this._validate(be,Le,Ue))return;const qe=Re.l({},Le);for(const Le of Object.keys(Re._.fog))void 0===qe[Le]&&(qe[Le]=Re._.fog[Le].default);this._options=qe,this._transitionable.setTransitionOrValue(this._options,Oe)}getOpacity(Le){if(!this._transform.projection.supportsFog)return 0;const Oe=this.properties&&this.properties.get("color")||1;return("globe"===this._transform.projection.name?1:Re.a7(Is,Xs,Le))*Oe.a}getOpacityAtLatLng(Le,Oe){return this._transform.projection.supportsFog?function(Le,Oe,Ue){const qe=Re.a5.fromLngLat(Oe),Ct=Ue.elevation?Ue.elevation.getAtPointOrZero(qe):0;return Be(Le,qe.x,qe.y,Ct,Ue)}(this.state,Le,Oe):0}getOpacityForTile(Le){if(!this._transform.projection.supportsFog)return[1,1];const Oe=this._transform.calculateFogTileMatrix(Le.toUnwrapped());return Ne(this.state,Oe,0,0,Re.ab,Re.ab,this._transform)}getOpacityForBounds(Re,Le,Oe,Ue,qe){return this._transform.projection.supportsFog?Ne(this.state,Re,Le,Oe,Ue,qe,this._transform):[1,1]}getFovAdjustedRange(Re){return this._transform.projection.supportsFog?ke(this.state,Re):[0,1]}isVisibleOnFrustum(Le){if(!this._transform.projection.supportsFog)return!1;const Oe=[4,5,6,7];for(const Ue of Oe){const Oe=Le.points[Ue];let qe;if(Oe[2]>=0)qe=Oe;else{const Ct=Le.points[Ue-4];qe=Re.ac(Ct,Oe,Ct[2]/(Ct[2]-Oe[2]))}if(Be(this.state,qe[0],qe[1],0,this._transform)>=ta)return!0}return!1}updateConfig(Re){this._transitionable.setTransitionOrValue(this._options,new Map(Re))}updateTransitions(Re){this._transitioning=this._transitionable.transitioned(Re,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(Re){this.properties=this._transitioning.possiblyEvaluate(Re)}_validate(Le,Oe,Ue){return(!Ue||!1!==Ue.validate)&&De(this,Le.call(fe,Re.l({value:Oe,style:{glyphs:!0,sprite:!0},styleSpec:Re._})))}}class je extends Re.E{constructor(Le,Oe,Ue,qe){super(),this.scope=Ue,this._options=Le,this.properties=new Re.a8(Oe),this._transitionable=new Re.$(Oe,Ue,new Map(qe)),this._transitionable.setTransitionOrValue(Le.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(Re){this._transitionable.setTransitionOrValue(this._options.properties,new Map(Re))}updateTransitions(Re){this._transitioning=this._transitionable.transitioned(Re,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(Re){this.properties=this._transitioning.possiblyEvaluate(Re)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(Re,Le){this._options=Re,this._transitionable.setTransitionOrValue(Re.properties,Le)}shadowsEnabled(){return!!this.properties&&!0===this.properties.get("cast-shadows")}}let el,tl;class Ze{constructor(Re,Le,Oe,Ue){this.screenBounds=Re,this.cameraPoint=Le,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=Oe,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,Ue)}static createFromScreenPoints(Le,Oe){let Ue,qe;if(Le instanceof Re.P||"number"==typeof Le[0]){const Ct=Re.P.convert(Le);Ue=[Ct],qe=Oe.isPointAboveHorizon(Ct)}else{const Ct=Re.P.convert(Le[0]),Ot=Re.P.convert(Le[1]);Ue=[Ct,Ot],qe=Re.ae(Ct,Ot).every((Re=>Oe.isPointAboveHorizon(Re)))}return new Ze(Ue,Oe.getCameraPoint(),qe,Oe)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(Le){return Re.ae(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],Le)}bufferedCameraGeometry(Le){const Oe=this.screenBounds[0],Ue=1===this.screenBounds.length?this.screenBounds[0].add(new Re.P(1,1)):this.screenBounds[1],qe=Re.ae(Oe,Ue,0,!1);return this.cameraPoint.y>Ue.y&&(this.cameraPoint.x>Oe.x&&this.cameraPoint.x<Ue.x?qe.splice(3,0,this.cameraPoint):this.cameraPoint.x>=Ue.x?qe[2]=this.cameraPoint:this.cameraPoint.x<=Oe.x&&(qe[3]=this.cameraPoint)),Re.af(qe,Le)}bufferedCameraGeometryGlobe(Le){const Oe=this.screenBounds[0],Ue=1===this.screenBounds.length?this.screenBounds[0].add(new Re.P(1,1)):this.screenBounds[1],qe=Re.ae(Oe,Ue,Le),Ct=this.cameraPoint.clone();switch(3*((Ct.y>Oe.y)+(Ct.y>Ue.y))+((Ct.x>Oe.x)+(Ct.x>Ue.x))){case 0:qe[0]=Ct,qe[4]=Ct.clone();break;case 1:qe.splice(1,0,Ct);break;case 2:qe[1]=Ct;break;case 3:qe.splice(4,0,Ct);break;case 5:qe.splice(2,0,Ct);break;case 6:qe[3]=Ct;break;case 7:qe.splice(3,0,Ct);break;case 8:qe[2]=Ct}return qe}containsTile(Le,Oe,Ue,qe=0){const Ct=Le.queryPadding/Oe._pixelsPerMercatorPixel+1,Ot=Ue?this._bufferedCameraMercator(Ct,Oe):this._bufferedScreenMercator(Ct,Oe);let Jt=Le.tileID.wrap+(Ot.unwrapped?qe:0);const Hr=Ot.polygon.map((Oe=>Re.ag(Le.tileTransform,Oe,Jt)));if(!Re.ah(Hr,0,0,Re.ab,Re.ab))return;Jt=Le.tileID.wrap+(this.screenGeometryMercator.unwrapped?qe:0);const Jr=this.screenGeometryMercator.polygon.map((Oe=>Re.ai(Le.tileTransform,Oe,Jt))),Ln=Jr.map((Le=>new Re.P(Le[0],Le[1]))),Nn=Oe.getFreeCameraOptions().position||new Re.a5(0,0,0),$n=Re.ai(Le.tileTransform,Nn,Jt),Gn=Jr.map((Le=>{const Oe=Re.a6.vec3.sub(Le,Le,$n);return Re.a6.vec3.normalize(Oe,Oe),new Re.aj($n,Oe)})),qn=Re.ak(Le,1,Oe.zoom)*Oe._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:Ln,tilespaceRays:Gn,bufferedTilespaceGeometry:Hr,bufferedTilespaceBounds:(Zn=Re.al(Hr),Zn.min.x=Re.ap(Zn.min.x,0,Re.ab),Zn.min.y=Re.ap(Zn.min.y,0,Re.ab),Zn.max.x=Re.ap(Zn.max.x,0,Re.ab),Zn.max.y=Re.ap(Zn.max.y,0,Re.ab),Zn),tile:Le,tileID:Le.tileID,pixelToTileUnitsFactor:qn};var Zn}_bufferedScreenMercator(Re,Le){const Oe=$e(Re);if(this._screenRaycastCache[Oe])return this._screenRaycastCache[Oe];{let Ue;return Ue="globe"===Le.projection.name?this._projectAndResample(this.bufferedScreenGeometry(Re),Le):{polygon:this.bufferedScreenGeometry(Re).map((Re=>Le.pointCoordinate3D(Re))),unwrapped:!0},this._screenRaycastCache[Oe]=Ue,Ue}}_bufferedCameraMercator(Re,Le){const Oe=$e(Re);if(this._cameraRaycastCache[Oe])return this._cameraRaycastCache[Oe];{let Ue;return Ue="globe"===Le.projection.name?this._projectAndResample(this.bufferedCameraGeometryGlobe(Re),Le):{polygon:this.bufferedCameraGeometry(Re).map((Re=>Le.pointCoordinate3D(Re))),unwrapped:!0},this._cameraRaycastCache[Oe]=Ue,Ue}}_projectAndResample(Le,Oe){const Ue=function(Le,Oe){const Ue=Re.a6.mat4.multiply([],Oe.pixelMatrix,Oe.globeMatrix),qe=[0,-Re.aq,0,1],Ct=[0,Re.aq,0,1],Ot=[0,0,0,1];Re.a6.vec4.transformMat4(qe,qe,Ue),Re.a6.vec4.transformMat4(Ct,Ct,Ue),Re.a6.vec4.transformMat4(Ot,Ot,Ue);const Jt=new Re.P(qe[0]/qe[3],qe[1]/qe[3]),Hr=new Re.P(Ct[0]/Ct[3],Ct[1]/Ct[3]),Jr=Re.an(Le,Jt)&&qe[3]<Ot[3],Ln=Re.an(Le,Hr)&&Ct[3]<Ot[3];if(!Jr&&!Ln)return null;const Nn=function(Re,Le,Oe){for(let Ue=1;Ue<Re.length;Ue++){const qe=We(Le.pointCoordinate3D(Re[Ue-1]).x),Ct=We(Le.pointCoordinate3D(Re[Ue]).x);if(Oe<0){if(qe<Ct)return{idx:Ue,t:-qe/(Ct-1-qe)}}else if(Ct<qe)return{idx:Ue,t:(1-qe)/(Ct+1-qe)}}return null}(Le,Oe,Jr?-1:1);if(!Nn)return null;const{idx:$n,t:Gn}=Nn;let qn=$n>1?He(Le.slice(0,$n),Oe):[],Zn=$n<Le.length?He(Le.slice($n),Oe):[];qn=qn.map((Le=>new Re.P(We(Le.x),Le.y))),Zn=Zn.map((Le=>new Re.P(We(Le.x),Le.y)));const Xn=[...qn];0===Xn.length&&Xn.push(Zn[Zn.length-1]);const Yn=Re.aa(Xn[Xn.length-1].y,(0===Zn.length?qn[0]:Zn[0]).y,Gn);let _i;return _i=Jr?[new Re.P(0,Yn),new Re.P(0,0),new Re.P(1,0),new Re.P(1,Yn)]:[new Re.P(1,Yn),new Re.P(1,1),new Re.P(0,1),new Re.P(0,Yn)],Xn.push(..._i),0===Zn.length?Xn.push(qn[0]):Xn.push(...Zn),{polygon:Xn.map((Le=>new Re.a5(Le.x,Le.y))),unwrapped:!1}}(Le,Oe);if(Ue)return Ue;const qe=function(Le,Oe){let Ue=!1,qe=-1/0,Ct=0;for(let Re=0;Re<Le.length-1;Re++)Le[Re].x>qe&&(qe=Le[Re].x,Ct=Re);for(let Re=0;Re<Le.length-1;Re++){const Oe=(Ct+Re)%(Le.length-1),qe=Le[Oe],Ot=Le[Oe+1];Math.abs(qe.x-Ot.x)>.5&&(qe.x<Ot.x?(qe.x+=1,0===Oe&&(Le[Le.length-1].x+=1)):(Ot.x+=1,Oe+1===Le.length-1&&(Le[0].x+=1)),Ue=!0)}const Ot=Re.am(Oe.center.lng);return Ue&&Ot<Math.abs(Ot-1)&&Le.forEach((Re=>{Re.x-=1})),{polygon:Le,unwrapped:Ue}}(He(Le,Oe).map((Le=>new Re.P(We(Le.x),Le.y))),Oe);return{polygon:qe.polygon.map((Le=>new Re.a5(Le.x,Le.y))),unwrapped:qe.unwrapped}}}function He(Le,Oe){return Re.ao(Le,(Re=>{const Le=Oe.pointCoordinate3D(Re);Re.x=Le.x,Re.y=Le.y}),1/256)}function We(Re){return Re<0?1+Re%1:Re%1}function $e(Re){return 100*Re|0}function Xe(Le,Oe,Ue,qe,Ct){const a=function(Ue,qe){if(Ue)return Ct(Ue);if(qe){if(Le.url&&qe.tiles&&Le.tiles&&delete Le.tiles,qe.variants){if(!Array.isArray(qe.variants))return Ct(new Error("variants must be an array"));for(const Le of qe.variants){if(null==Le||"object"!=typeof Le||Le.constructor!==Object)return Ct(new Error("variant must be an object"));if(!Array.isArray(Le.capabilities))return Ct(new Error("capabilities must be an array"));if(1===Le.capabilities.length&&"meshopt"===Le.capabilities[0]){qe=Re.l(qe,Le);break}}}const Ue=Re.ar(Re.l(qe,Le),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);qe.vector_layers&&(Ue.vectorLayers=qe.vector_layers,Ue.vectorLayerIds=Ue.vectorLayers.map((Re=>Re.id))),qe.raster_layers&&(Ue.rasterLayers=qe.raster_layers,Ue.rasterLayerIds=Ue.rasterLayers.map((Re=>Re.id))),Ue.tiles=Oe.canonicalizeTileset(Ue,Le.url),Ct(null,Ue)}},Ot=function(Re,Le,Oe){if(!Re)return null;if(!Le&&!Oe)return Re;Oe=Oe||Re.worldview_default;const Ue=Object.values(Re.language||{});if(0===Ue.length)return null;const qe=Object.values(Re.worldview||{});if(0===qe.length)return null;const Ct=Ue.every((Re=>Re===Le)),Ot=qe.every((Re=>Re===Oe));return Ct&&Ot?Re:Le in(Re.language_options||{})||Oe in(Re.worldview_options||{})?null:Re.language_options&&Re.worldview_options?Re:null}(Le.data,Ue,qe);return Ot?Re.q.frame((()=>a(null,Ot))):Le.url?Re.n(Oe.transformRequest(Oe.normalizeSourceURL(Le.url,null,Ue,qe),Re.R.Source),a):Re.q.frame((()=>{const{data:Re,...Oe}=Le;a(null,Oe)}))}class Ye{constructor(Le,Oe,Ue){this.bounds=Re.as.convert(this.validateBounds(Le)),this.minzoom=Oe||0,this.maxzoom=Ue||24}validateBounds(Re){return Array.isArray(Re)&&4===Re.length?[Math.max(-180,Re[0]),Math.max(-90,Re[1]),Math.min(180,Re[2]),Math.min(90,Re[3])]:[-180,-90,180,90]}contains(Le){const Oe=Math.pow(2,Le.z),Ue=Math.floor(Re.am(this.bounds.getWest())*Oe),qe=Math.floor(Re.at(this.bounds.getNorth())*Oe),Ct=Math.ceil(Re.am(this.bounds.getEast())*Oe),Ot=Math.ceil(Re.at(this.bounds.getSouth())*Oe);return Le.x>=Ue&&Le.x<Ct&&Le.y>=qe&&Le.y<Ot}}class Ke extends Re.E{constructor(Le,Oe,Ue,qe){if(super(),this.id=Le,this.dispatcher=Ue,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,Re.l(this,Re.ar(Oe,["url","scheme","tileSize","promoteId"])),this._options=Re.l({type:"vector"},Oe),this._collectResourceTiming=!!Oe.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(qe),this._tileWorkers={},this._deduped=new Re.au}load(Le){this._loaded=!1,this.fire(new Re.x("dataloading",{dataType:"source"}));const Oe=Array.isArray(this.map._language)?this.map._language.join():this.map._language,Ue=this.map._worldview;this._tileJSONRequest=Xe(this._options,this.map._requestManager,Oe,Ue,((qe,Ct)=>{this._tileJSONRequest=null,this._loaded=!0,qe?(Oe&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${Oe}`),Ue&&2!==Ue.length&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${Ue}`),this.fire(new Re.t(qe))):Ct&&(Re.l(this,Ct),Ct.bounds&&(this.tileBounds=new Ye(Ct.bounds,this.minzoom,this.maxzoom)),Zn(Ct.tiles,this.map._requestManager._customAccessToken),this.fire(new Re.x("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new Re.x("data",{dataType:"source",sourceDataType:"content"}))),Le&&Le(qe)}))}loaded(){return this._loaded}hasTile(Re){return!this.tileBounds||this.tileBounds.contains(Re.canonical)}onAdd(Re){this.map=Re,this.load()}reload(){this.cancelTileJSONRequest();const Le=Re.av(this.id,this.scope);this.load((()=>this.map.style.clearSource(Le)))}setTiles(Re){return this._options.tiles=Re,this.reload(),this}setUrl(Re){return this.url=Re,this._options.url=Re,this.reload(),this}onRemove(Re){this.cancelTileJSONRequest()}serialize(){return Re.l({},this._options)}loadTile(Le,Oe){const Ue=this.map._requestManager.normalizeTileURL(Le.tileID.canonical.url(this.tiles,this.scheme)),qe=this.map._requestManager.transformRequest(Ue,Re.R.Tile),Ct=this.map.style?this.map.style.getLut(this.scope):null,Ot={request:qe,data:void 0,uid:Le.uid,tileID:Le.tileID,tileZoom:Le.tileZoom,zoom:Le.tileID.overscaledZ,lut:Ct?{image:Ct.image.clone()}:null,tileSize:this.tileSize*Le.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:Re.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:Le.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:Le.isExtraShadowCaster,tessellationStep:this.map._tessellationStep};if(Ot.request.collectResourceTiming=this._collectResourceTiming,Le.actor&&"expired"!==Le.state)"loading"===Le.state?Le.reloadCallback=Oe:Le.request=Le.actor.send("reloadTile",Ot,n.bind(this));else if(Le.actor=this._tileWorkers[Ue]=this._tileWorkers[Ue]||this.dispatcher.getActor(),this.dispatcher.ready)Le.request=Le.actor.send("loadTile",Ot,n.bind(this),void 0,!0);else{const Oe=Re.aw.call({deduped:this._deduped},Ot,((Re,Oe)=>{Re||!Oe?n.call(this,Re):(Ot.data={cacheControl:Oe.cacheControl,expires:Oe.expires,rawData:Oe.rawData.slice(0)},Le.actor&&Le.actor.send("loadTile",Ot,n.bind(this),void 0,!0))}),!0);Le.request={cancel:Oe}}function n(Ue,qe){return delete Le.request,Le.aborted?Oe(null):Ue&&404!==Ue.status?Oe(Ue):(qe&&qe.resourceTiming&&(Le.resourceTiming=qe.resourceTiming),this.map._refreshExpiredTiles&&qe&&Le.setExpiryData(qe),Le.loadVectorData(qe,this.map.painter),Re.ax(this.dispatcher),Oe(null),void(Le.reloadCallback&&(this.loadTile(Le,Le.reloadCallback),Le.reloadCallback=null)))}}abortTile(Re){Re.request&&(Re.request.cancel(),delete Re.request),Re.actor&&Re.actor.send("abortTile",{uid:Re.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(Re,Le){Re.actor&&Re.actor.send("removeTile",{uid:Re.uid,type:this.type,source:this.id,scope:this.scope}),Re.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Je extends Re.E{constructor(Le,Oe,Ue,qe){super(),this.id=Le,this.dispatcher=Ue,this.setEventedParent(qe),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=Re.l({type:"raster"},Oe),Re.l(this,Re.ar(Oe,["url","scheme","tileSize"]))}load(Le){this._loaded=!1,this.fire(new Re.x("dataloading",{dataType:"source"})),this._tileJSONRequest=Xe(this._options,this.map._requestManager,null,null,((Oe,Ue)=>{this._tileJSONRequest=null,this._loaded=!0,Oe?this.fire(new Re.t(Oe)):Ue&&(Re.l(this,Ue),Ue.bounds&&(this.tileBounds=new Ye(Ue.bounds,this.minzoom,this.maxzoom)),Zn(Ue.tiles),this.fire(new Re.x("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new Re.x("data",{dataType:"source",sourceDataType:"content"}))),Le&&Le(Oe)}))}loaded(){return this._loaded}onAdd(Re){this.map=Re,this.load()}reload(){this.cancelTileJSONRequest();const Le=Re.av(this.id,this.scope);this.load((()=>this.map.style.clearSource(Le)))}setTiles(Re){return this._options.tiles=Re,this.reload(),this}setUrl(Re){return this.url=Re,this._options.url=Re,this.reload(),this}onRemove(Re){this.cancelTileJSONRequest()}serialize(){return Re.l({},this._options)}hasTile(Re){return!this.tileBounds||this.tileBounds.contains(Re.canonical)}loadTile(Le,Oe){const Ue=Re.q.devicePixelRatio>=2,qe=this.map._requestManager.normalizeTileURL(Le.tileID.canonical.url(this.tiles,this.scheme),Ue,this.tileSize);Le.request=Re.o(this.map._requestManager.transformRequest(qe,Re.R.Tile),((Ue,qe,Ct,Ot)=>(delete Le.request,Le.aborted?(Le.state="unloaded",Oe(null)):Ue?(Le.state="errored",Oe(Ue)):qe?(this.map._refreshExpiredTiles&&Le.setExpiryData({cacheControl:Ct,expires:Ot}),Le.setTexture(qe,this.map.painter),Le.state="loaded",Re.ax(this.dispatcher),void Oe(null)):Oe(null))))}abortTile(Re,Le){Re.request&&(Re.request.cancel(),delete Re.request),Le&&Le()}unloadTile(Le,Oe){Le.texture&&Le.texture instanceof Re.T?(Le.destroy(!0),Le.texture&&Le.texture instanceof Re.T&&this.map.painter.saveTileTexture(Le.texture)):Le.destroy(),Oe&&Oe()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Qe extends Je{constructor(Le,Oe,Ue,qe){super(Le,Oe,Ue,qe),this.type="raster-array",this.maxzoom=22,this._options=Re.l({type:"raster-array"},Oe)}triggerRepaint(Re){const Le=this.map.painter._terrain,Oe=this.map.style.getSourceCache(this.id);Le&&Le.enabled&&Oe&&Le._clearRenderCacheForTile(Oe.id,Re.tileID),this.map.triggerRepaint()}loadTile(Le,Oe){const Ue=this.map._requestManager.normalizeTileURL(Le.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),qe=this.map._requestManager.transformRequest(Ue,Re.R.Tile);Le.requestParams=qe,Le.actor||(Le.actor=this.dispatcher.getActor()),Le.request=Le.fetchHeader(void 0,((Re,Ue,qe,Ct)=>{if(delete Le.request,Le.aborted)return Le.state="unloaded",Oe(null);if(Re){if(20===Re.code)return;return Le.state="errored",Oe(Re)}this.map._refreshExpiredTiles&&Le.setExpiryData({cacheControl:qe,expires:Ct}),Le.state="empty",Oe(null)}))}unloadTile(Le,Oe){const Ue=Le.texture;Ue&&Ue instanceof Re.T?(Le.destroy(!0),this.map.painter.saveTileTexture(Ue)):(Le.destroy(),Le.flushQueues(),Le._isHeaderLoaded=!1,delete Le._mrt,delete Le.textureDescriptor),Le.fbo&&(Le.fbo.destroy(),delete Le.fbo),delete Le.request,delete Le.requestParams,delete Le.neighboringTiles,Le.state="unloaded"}prepareTile(Le,Oe,Ue){Le._isHeaderLoaded&&("empty"!==Le.state&&(Le.state="reloading"),Le.fetchBand(Oe,Ue,((Oe,Ue)=>{if(Oe)return Le.state="errored",this.fire(new Re.t(Oe)),void this.triggerRepaint(Le);Ue&&(Le.setTexture(Ue,this.map.painter),Le.state="loaded",this.triggerRepaint(Le))})))}getInitialBand(Re){if(!this.rasterLayers)return 0;const Le=this.rasterLayers.find((({id:Le})=>Le===Re)),Oe=Le&&Le.fields,Ue=Oe&&Oe.bands&&Oe.bands;return Ue?Ue[0]:0}getTextureDescriptor(Le,Oe,Ue){if(!Le)return;const qe=Oe.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!qe)return;let Ct=null;Oe instanceof Re.aB?Ct=Oe.paint.get("raster-array-band"):Oe instanceof Re.aC&&(Ct=Oe.paint.get("raster-particle-array-band"));const Ot=Ct||this.getInitialBand(qe);if(null!=Ot)if(Le.textureDescriptor){if(!Le.updateNeeded(qe,Ot)||Ue)return Object.assign({},Le.textureDescriptor,{texture:Le.texture})}else this.prepareTile(Le,qe,Ot)}}const il={vector:Ke,raster:Je,"raster-dem":class extends Je{constructor(Le,Oe,Ue,qe){super(Le,Oe,Ue,qe),this.type="raster-dem",this.maxzoom=22,this._options=Re.l({type:"raster-dem"},Oe),this.encoding=Oe.encoding||"mapbox"}loadTile(Le,Oe){const Ue=this.map._requestManager.normalizeTileURL(Le.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function r(Re,Ue){Re&&(Le.state="errored",Oe(Re)),Ue&&(Le.dem=Ue,Le.dem.onDeserialize(),Le.needsHillshadePrepare=!0,Le.needsDEMTextureUpload=!0,Le.state="loaded",Oe(null))}Le.request=Re.o(this.map._requestManager.transformRequest(Ue,Re.R.Tile),function(Ue,qe,Ct,Ot){if(delete Le.request,Le.aborted)Le.state="unloaded",Oe(null);else if(Ue)Le.state="errored",Oe(Ue);else if(qe){this.map._refreshExpiredTiles&&Le.setExpiryData({cacheControl:Ct,expires:Ot});const Oe=ImageBitmap&&qe instanceof ImageBitmap&&Re.ay(),Ue=1-(qe.width-Re.az(qe.width))/2;Ue<1||Le.neighboringTiles||(Le.neighboringTiles=this._getNeighboringTiles(Le.tileID));const Jt=Oe?qe:Re.q.getImageData(qe,Ue),Hr={uid:Le.uid,coord:Le.tileID,source:this.id,scope:this.scope,rawImageData:Jt,encoding:this.encoding,padding:Ue};Le.actor&&"expired"!==Le.state||(Le.actor=this.dispatcher.getActor(),Le.actor.send("loadDEMTile",Hr,r.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(Le){const Oe=Le.canonical,Ue=Math.pow(2,Oe.z),qe=(Oe.x-1+Ue)%Ue,Ct=0===Oe.x?Le.wrap-1:Le.wrap,Ot=(Oe.x+1+Ue)%Ue,Jt=Oe.x+1===Ue?Le.wrap+1:Le.wrap,Hr={};return Hr[new Re.aA(Le.overscaledZ,Ct,Oe.z,qe,Oe.y).key]={backfilled:!1},Hr[new Re.aA(Le.overscaledZ,Jt,Oe.z,Ot,Oe.y).key]={backfilled:!1},Oe.y>0&&(Hr[new Re.aA(Le.overscaledZ,Ct,Oe.z,qe,Oe.y-1).key]={backfilled:!1},Hr[new Re.aA(Le.overscaledZ,Le.wrap,Oe.z,Oe.x,Oe.y-1).key]={backfilled:!1},Hr[new Re.aA(Le.overscaledZ,Jt,Oe.z,Ot,Oe.y-1).key]={backfilled:!1}),Oe.y+1<Ue&&(Hr[new Re.aA(Le.overscaledZ,Ct,Oe.z,qe,Oe.y+1).key]={backfilled:!1},Hr[new Re.aA(Le.overscaledZ,Le.wrap,Oe.z,Oe.x,Oe.y+1).key]={backfilled:!1},Hr[new Re.aA(Le.overscaledZ,Jt,Oe.z,Ot,Oe.y+1).key]={backfilled:!1}),Hr}},"raster-array":Qe,geojson:class extends Re.E{constructor(Le,Oe,Ue,qe){super(),this.id=Le,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=Ue.getActor(),this.setEventedParent(qe),this._data=Oe.data,this._options=Re.l({},Oe),this._collectResourceTiming=Oe.collectResourceTiming,void 0!==Oe.maxzoom&&(this.maxzoom=Oe.maxzoom),void 0!==Oe.minzoom&&(this.minzoom=Oe.minzoom),Oe.type&&(this.type=Oe.type),Oe.attribution&&(this.attribution=Oe.attribution),this.promoteId=Oe.promoteId;const Ct=Re.ab/this.tileSize;this.workerOptions=Re.l({source:this.id,scope:this.scope,cluster:Oe.cluster||!1,geojsonVtOptions:{buffer:(void 0!==Oe.buffer?Oe.buffer:128)*Ct,tolerance:(void 0!==Oe.tolerance?Oe.tolerance:.375)*Ct,extent:Re.ab,maxZoom:this.maxzoom,lineMetrics:Oe.lineMetrics||!1,generateId:Oe.generateId||!1},superclusterOptions:{maxZoom:void 0!==Oe.clusterMaxZoom?Oe.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,Oe.clusterMinPoints||2),extent:Re.ab,radius:(void 0!==Oe.clusterRadius?Oe.clusterRadius:50)*Ct,log:!1,generateId:Oe.generateId||!1},clusterProperties:Oe.clusterProperties,filter:Oe.filter,dynamic:Oe.dynamic},Oe.workerOptions)}onAdd(Re){this.map=Re,this.setData(this._data)}setData(Re){return this._data=Re,this._updateWorkerData(),this}updateData(Le){if(!this._options.dynamic)return this.fire(new Re.t(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")));if("string"!=typeof Le&&("Feature"===Le.type&&(Le={type:"FeatureCollection",features:[Le]}),"FeatureCollection"!==Le.type))return this.fire(new Re.t(new Error("Data to update should be a feature or a feature collection.")));if(this._coalesce&&"string"!=typeof Le&&"string"!=typeof this._data&&"FeatureCollection"===this._data.type){const Re=new Map;for(const Le of this._data.features)Re.set(Le.id,Le);for(const Oe of Le.features)Re.set(Oe.id,Oe);this._data.features=[...Re.values()]}else this._data=Le;return this._updateWorkerData(!0),this}getClusterExpansionZoom(Re,Le){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:Re,source:this.id,scope:this.scope},Le),this}getClusterChildren(Re,Le){return this.actor.send("geojson.getClusterChildren",{clusterId:Re,source:this.id,scope:this.scope},Le),this}getClusterLeaves(Re,Le,Oe,Ue){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:Re,limit:Le,offset:Oe},Ue),this}_updateWorkerData(Le=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new Re.x("dataloading",{dataType:"source"})),this._loaded=!1;const Oe=Re.l({append:Le},this.workerOptions);Oe.scope=this.scope;const Ue=this._data;"string"==typeof Ue?(Oe.request=this.map._requestManager.transformRequest(Re.q.resolveURL(Ue),Re.R.Source),Oe.request.collectResourceTiming=this._collectResourceTiming):Oe.data=JSON.stringify(Ue),this._pendingLoad=this.actor.send(`${this.type}.loadData`,Oe,((Oe,Ue)=>{if(this._loaded=!0,this._pendingLoad=null,Oe)this.fire(new Re.t(Oe));else{const Oe={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&Ue&&Ue.resourceTiming&&Ue.resourceTiming[this.id]&&(Oe.resourceTiming=Ue.resourceTiming[this.id]),Le&&(this._partialReload=!0),this.fire(new Re.x("data",Oe)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(Le),this._coalesce=!1)}))}loaded(){return this._loaded}loadTile(Le,Oe){const Ue=Le.actor?"reloadTile":"loadTile";Le.actor=this.actor;const qe=this.map.style?this.map.style.getLut(this.scope):null,Ct=this._partialReload,Ot={type:this.type,uid:Le.uid,tileID:Le.tileID,tileZoom:Le.tileZoom,zoom:Le.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:qe?{image:qe.image.clone()}:null,scope:this.scope,pixelRatio:Re.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,partial:Ct};Le.request=this.actor.send(Ue,Ot,((Re,qe)=>Ct&&!qe?(Le.state="loaded",Oe(null)):(delete Le.request,Le.destroy(),Le.aborted?Oe(null):Re?Oe(Re):(Le.loadVectorData(qe,this.map.painter,"reloadTile"===Ue),Oe(null)))),void 0,"loadTile"===Ue)}abortTile(Re){Re.request&&(Re.request.cancel(),delete Re.request),Re.aborted=!0}unloadTile(Re,Le){this.actor.send("removeTile",{uid:Re.uid,type:this.type,source:this.id,scope:this.scope}),Re.destroy()}onRemove(Re){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return Re.l({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Re.aD{constructor(Re,Le,Oe,Ue){super(Re,Le,Oe,Ue),this.roundZoom=!0,this.type="video",this.options=Le}load(){this._loaded=!1;const Le=this.options;this.urls=[];for(const Oe of Le.urls)this.urls.push(this.map._requestManager.transformRequest(Oe,Re.R.Source).url);Re.aE(this.urls,((Le,Oe)=>{this._loaded=!0,Le?this.fire(new Re.t(Le)):Oe&&(this.video=Oe,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading())}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(Le){if(this.video){const Oe=this.video.seekable;Le<Oe.start(0)||Le>Oe.end(0)?this.fire(new Re.t(new Re.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${Oe.start(0)} and ${Oe.end(0)}-second mark.`))):this.video.currentTime=Le}}getVideo(){return this.video}onAdd(Re){this.map||(this.map=Re,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const Le=this.map.painter.context,Oe=Le.gl;this.texture?this.video.paused||(this.texture.bind(Oe.LINEAR,Oe.CLAMP_TO_EDGE),Oe.texSubImage2D(Oe.TEXTURE_2D,0,0,0,Oe.RGBA,Oe.UNSIGNED_BYTE,this.video)):(this.texture=new Re.T(Le,this.video,Oe.RGBA8),this.texture.bind(Oe.LINEAR,Oe.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(Le)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Re.aD,model:class extends Re.E{constructor(Re,Le,Oe,Ue){super(),this.id=Re,this.type="model",this.models=[],this._loaded=!1,this._options=Le}load(){const Le=[];for(const Oe in this._options.models){const Ue=this._options.models[Oe],qe=Re.aG(this.map._requestManager.transformRequest(Ue.uri,Re.R.Model).url).then((Le=>{if(!Le)return;const qe=Re.aH(Le),Ct=new Re.aI(Oe,Ue.position,Ue.orientation,qe);Ct.computeBoundsAndApplyParent(),this.models.push(Ct)})).catch((Le=>{this.fire(new Re.t(new Error(`Could not load model ${Oe} from ${Ue.uri}: ${Le.message}`)))}));Le.push(qe)}return Promise.allSettled(Le).then((()=>{this._loaded=!0,this.fire(new Re.x("data",{dataType:"source",sourceDataType:"metadata"}))})).catch((Le=>{this.fire(new Re.t(new Error(`Could not load models: ${Le.message}`)))}))}onAdd(Re){this.map=Re,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(Re,Le){}serialize(){return{type:"model"}}},"batched-model":class extends Re.E{constructor(Re,Le,Oe,Ue){super(),this.type="batched-model",this.id=Re,this.tileSize=512,this._options=Le,this.tiles=this._options.tiles,this.maxzoom=Le.maxzoom||19,this.minzoom=Le.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=Oe,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(Ue)}onAdd(Re){this.map=Re,this.load()}load(Le){this._loaded=!1,this.fire(new Re.x("dataloading",{dataType:"source"}));const Oe=Array.isArray(this.map._language)?this.map._language.join():this.map._language,Ue=this.map._worldview;this._tileJSONRequest=Xe(this._options,this.map._requestManager,Oe,Ue,((qe,Ct)=>{this._tileJSONRequest=null,this._loaded=!0,qe?(Oe&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${Oe}`),Ue&&2!==Ue.length&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${Ue}`),this.fire(new Re.t(qe))):Ct&&(Re.l(this,Ct),Ct.bounds&&(this.tileBounds=new Ye(Ct.bounds,this.minzoom,this.maxzoom)),Zn(Ct.tiles,this.map._requestManager._customAccessToken),this.fire(new Re.x("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new Re.x("data",{dataType:"source",sourceDataType:"content"}))),Le&&Le(qe)}))}hasTransition(){return!1}hasTile(Re){return!this.tileBounds||this.tileBounds.contains(Re.canonical)}loaded(){return this._loaded}loadTile(Le,Oe){const Ue=this.map._requestManager.normalizeTileURL(Le.tileID.canonical.url(this.tiles,this.scheme)),qe={request:this.map._requestManager.transformRequest(Ue,Re.R.Tile),data:void 0,uid:Le.uid,tileID:Le.tileID,tileZoom:Le.tileZoom,zoom:Le.tileID.overscaledZ,tileSize:this.tileSize*Le.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:Le.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0};if(Le.actor&&"expired"!==Le.state)if("loading"===Le.state)Le.reloadCallback=Oe;else{if(Le.buckets){const Re=Object.values(Le.buckets);for(const Le of Re)Le.dirty=!0;return void(Le.state="loaded")}Le.request=Le.actor.send("reloadTile",qe,s.bind(this))}else Le.actor=this.dispatcher.getActor(),Le.request=Le.actor.send("loadTile",qe,s.bind(this),void 0,!0);function s(Re,Ue){return Le.aborted?Oe(null):Re&&404!==Re.status?Oe(Re):(Ue&&(Ue.resourceTiming&&(Le.resourceTiming=Ue.resourceTiming),this.map._refreshExpiredTiles&&Le.setExpiryData(Ue),Le.buckets={...Le.buckets,...Ue.buckets},Ue.featureIndex&&(Le.latestFeatureIndex=Ue.featureIndex)),Le.state="loaded",void Oe(null))}}serialize(){return Re.l({},this._options)}},canvas:class extends Re.aD{constructor(Le,Oe,Ue,qe){super(Le,Oe,Ue,qe),Oe.coordinates?Array.isArray(Oe.coordinates)&&4===Oe.coordinates.length&&!Oe.coordinates.some((Re=>!Array.isArray(Re)||2!==Re.length||Re.some((Re=>"number"!=typeof Re))))||this.fire(new Re.t(new Re.V(`sources.${Le}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new Re.t(new Re.V(`sources.${Le}`,null,'missing required property "coordinates"'))),Oe.animate&&"boolean"!=typeof Oe.animate&&this.fire(new Re.t(new Re.V(`sources.${Le}`,null,'optional "animate" property must be a boolean value'))),Oe.canvas?"string"==typeof Oe.canvas||Oe.canvas instanceof HTMLCanvasElement||this.fire(new Re.t(new Re.V(`sources.${Le}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new Re.t(new Re.V(`sources.${Le}`,null,'missing required property "canvas"'))),this.options=Oe,this.animate=void 0===Oe.animate||Oe.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new Re.t(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(Re){this.map=Re,this.load(),this.canvas&&this.animate&&this.play()}onRemove(Re){this.pause()}prepare(){let Le=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,Le=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,Le=!0),this._hasInvalidDimensions())return;if(0===Object.keys(this.tiles).length)return;const Oe=this.map.painter.context;this.texture?!Le&&!this._playing||this.texture instanceof Re.aF||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new Re.T(Oe,this.canvas,Oe.gl.RGBA8,{premultiply:!0}),this._prepareData(Oe)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const Re of[this.canvas.width,this.canvas.height])if(isNaN(Re)||Re<=0)return!0;return!1}},custom:class extends Re.E{constructor(Le,Oe,Ue,qe){super(),this.id=Le,this.type="custom",this._dataType="raster",this._dispatcher=Ue,this._implementation=Oe,this.setEventedParent(qe),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new Re.t(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new Re.t(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Ye(this._implementation.bounds,this.minzoom,this.maxzoom)),Oe.update=this._update.bind(this),Oe.clearTiles=this._clearTiles.bind(this),Oe.coveringTiles=this._coveringTiles.bind(this),Re.l(this,Re.ar(Oe,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return Re.ar(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new Re.x("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new Re.x("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(Le){this.map=Le,this._loaded=!1,this.fire(new Re.x("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(Le),this.load()}onRemove(Re){this._implementation.onRemove&&this._implementation.onRemove(Re)}hasTile(Re){if(this._implementation.hasTile){const{x:Le,y:Oe,z:Ue}=Re.canonical;return this._implementation.hasTile({x:Le,y:Oe,z:Ue})}return!this.tileBounds||this.tileBounds.contains(Re.canonical)}loadTile(Re,Le){const{x:Oe,y:Ue,z:qe}=Re.tileID.canonical,Ct=new AbortController;Re.request=Promise.resolve(this._implementation.loadTile({x:Oe,y:Ue,z:qe},{signal:Ct.signal})).then(function(Oe){return delete Re.request,Re.aborted?(Re.state="unloaded",Le(null)):void 0===Oe?(Re.state="errored",Le(null)):null===Oe?(this.loadTileData(Re,{width:this.tileSize,height:this.tileSize,data:null}),Re.state="loaded",Le(null)):function(Re){return Re instanceof ImageData||Re instanceof HTMLCanvasElement||Re instanceof ImageBitmap||Re instanceof HTMLImageElement}(Oe)?(this.loadTileData(Re,Oe),Re.state="loaded",void Le(null)):(Re.state="errored",Le(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}.bind(this)).catch((Oe=>{20!==Oe.code&&(Re.state="errored",Le(Oe))})),Re.request.cancel=()=>Ct.abort()}loadTileData(Re,Le){Re.setTexture(Le,this.map.painter)}unloadTile(Le,Oe){if(Le.texture&&Le.texture instanceof Re.T?(Le.destroy(!0),Le.texture&&Le.texture instanceof Re.T&&this.map.painter.saveTileTexture(Le.texture)):Le.destroy(),this._implementation.unloadTile){const{x:Re,y:Oe,z:Ue}=Le.tileID.canonical;this._implementation.unloadTile({x:Re,y:Oe,z:Ue})}Oe&&Oe()}abortTile(Re,Le){Re.request&&Re.request.cancel&&(Re.request.cancel(),delete Re.request),Le&&Le()}hasTransition(){return!1}_coveringTiles(){return this.map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map((Re=>({x:Re.canonical.x,y:Re.canonical.y,z:Re.canonical.z})))}_clearTiles(){const Le=Re.av(this.id,this.scope);this.map.style.clearSource(Le)}_update(){this.fire(new Re.x("data",{dataType:"source",sourceDataType:"content"}))}}},tt=function(Le,Oe,Ue,qe){const Ct=new il[Oe.type](Le,Oe,Ue,qe);if(Ct.id!==Le)throw new Error(`Expected Source id to be ${Le} instead of ${Ct.id}`);return Re.aJ(["load","abort","unload","serialize","prepare"],Ct),Ct};function it(Le,Oe){const Ue=Re.a6.mat4.identity([]);return Re.a6.mat4.scale(Ue,Ue,[.5*Le.width,.5*-Le.height,1]),Re.a6.mat4.translate(Ue,Ue,[1,-1,0]),Re.a6.mat4.multiply(Ue,Ue,Le.calculateProjMatrix(Oe.toUnwrapped())),Float32Array.from(Ue)}function ot(Re,Le,Oe,Ue,qe,Ct,Ot,Jt=!1){const Hr=Re.tilesIn(Ue,Ot,Jt);Hr.sort(st);const Jr=[];for(const Ue of Hr)Jr.push({wrappedTileID:Ue.tile.tileID.wrapped().key,queryResults:Ue.tile.queryRenderedFeatures(Le,Oe,Re._state,Ue,qe,Ct,it(Re.transform,Ue.tile.tileID),Jt)});const Ln=function(Re){const Le={},Oe={};for(const Ue of Re){const Re=Ue.queryResults,qe=Ue.wrappedTileID,Ct=Oe[qe]=Oe[qe]||{};for(const Oe in Re){const Ue=Re[Oe],qe=Ct[Oe]=Ct[Oe]||{},Ot=Le[Oe]=Le[Oe]||[];for(const Re of Ue)qe[Re.featureIndex]||(qe[Re.featureIndex]=!0,Ot.push(Re))}}return Le}(Jr);for(const Le in Ln)Ln[Le].forEach((Le=>{const Oe=Le.feature,Ue=Oe.layer;Ue&&"background"!==Ue.type&&"sky"!==Ue.type&&"slot"!==Ue.type&&(Oe.source=Ue.source,Ue["source-layer"]&&(Oe.sourceLayer=Ue["source-layer"]),Oe.state=void 0!==Oe.id?Re.getFeatureState(Ue["source-layer"],Oe.id):{})}));return Ln}function rt(Re,Le){const Oe=Re.getRenderableIds().map((Le=>Re.getTileByID(Le))),Ue=[],qe={};for(let Re=0;Re<Oe.length;Re++){const Ct=Oe[Re],Ot=Ct.tileID.canonical.key;qe[Ot]||(qe[Ot]=!0,Ct.querySourceFeatures(Ue,Le))}return Ue}function st(Re,Le){const Oe=Re.tileID,Ue=Le.tileID;return Oe.overscaledZ-Ue.overscaledZ||Oe.canonical.y-Ue.canonical.y||Oe.wrap-Ue.wrap||Oe.canonical.x-Ue.canonical.x}const sl=32,fl=33,Al=new Uint16Array(8184);for(let Re=0;Re<2046;Re++){let Le=Re+2,Oe=0,Ue=0,qe=0,Ct=0,Ot=0,Jt=0;for(1&Le?qe=Ct=Ot=sl:Oe=Ue=Jt=sl;(Le>>=1)>1;){const Re=Oe+qe>>1,Hr=Ue+Ct>>1;1&Le?(qe=Oe,Ct=Ue,Oe=Ot,Ue=Jt):(Oe=qe,Ue=Ct,qe=Ot,Ct=Jt),Ot=Re,Jt=Hr}const Hr=4*Re;Al[Hr+0]=Oe,Al[Hr+1]=Ue,Al[Hr+2]=qe,Al[Hr+3]=Ct}const Ml=new Uint16Array(2178),Hl=new Uint8Array(1089),Wl=new Uint16Array(1089);function dt(Re){return 0===Re?-.03125:32===Re?.03125:0}const Kl={type:2,extent:Re.ab,loadGeometry:()=>[[new Re.P(0,0),new Re.P(Re.ab+1,0),new Re.P(Re.ab+1,Re.ab+1),new Re.P(0,Re.ab+1),new Re.P(0,0)]]};class pt{constructor(Le,Oe,Ue,qe,Ct){this.tileID=Le,this.uid=Re.aP(),this.uses=0,this.tileSize=Oe,this.tileZoom=Ue,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=Ct,qe&&qe.style&&(this._lastUpdatedBrightness=qe.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",qe&&qe.transform&&(this.projection=qe.transform.projection)}registerFadeDuration(Le){const Oe=Le+this.timeAdded;Oe<Re.q.now()||this.fadeEndTime&&Oe<this.fadeEndTime||(this.fadeEndTime=Oe)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}get tileTransform(){return this._tileTransform||(this._tileTransform=Re.aK(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(Le,Oe,Ue){if(this.unloadVectorData(),this.state="loaded",Le){Le.featureIndex&&(this.latestFeatureIndex=Le.featureIndex,Le.rawTileData?(this.latestRawTileData=Le.rawTileData,this.latestFeatureIndex.rawTileData=Le.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=Le.collisionBoxArray,this.buckets=function(Re,Le){const Oe={};if(!Le)return Oe;for(const Ue of Re){const Re=Ue.layerIds.map((Re=>Le.getLayer(Re))).filter(Boolean);if(0!==Re.length){Ue.layers=Re,Ue.stateDependentLayerIds&&(Ue.stateDependentLayers=Ue.stateDependentLayerIds.map((Le=>Re.filter((Re=>Re.id===Le))[0])));for(const Le of Re)Oe[Le.fqid]=Ue}}return Oe}(Le.buckets,Oe.style),this.hasSymbolBuckets=!1;for(const Le in this.buckets){const Oe=this.buckets[Le];if(Oe instanceof Re.aR){if(this.hasSymbolBuckets=!0,!Ue)break;Oe.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const Le in this.buckets){const Oe=this.buckets[Le];if(Oe instanceof Re.aR&&Oe.hasRTLText){this.hasRTLText=!0,Re.aS();break}}this.queryPadding=0;for(const Re in this.buckets){const Le=this.buckets[Re],Ue=Oe.style.getOwnLayer(Re);if(!Ue)continue;const qe=Ue.queryRadius(Le);this.queryPadding=Math.max(this.queryPadding,qe)}Le.imageAtlas&&(this.imageAtlas=Le.imageAtlas),Le.glyphAtlasImage&&(this.glyphAtlasImage=Le.glyphAtlasImage),Le.lineAtlas&&(this.lineAtlas=Le.lineAtlas),this._lastUpdatedBrightness=Le.brightness}else this.collisionBoxArray=new Re.aQ}unloadVectorData(){if(this.hasData()){for(const Re in this.buckets)this.buckets[Re].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(Re){return this.buckets[Re.fqid]}upload(Le){for(const Re in this.buckets){const Oe=this.buckets[Re];Oe.uploadPending()&&Oe.upload(Le)}const Oe=Le.gl,Ue=this.imageAtlas;if(Ue&&!Ue.uploaded){const qe=!!Object.keys(Ue.patternPositions).length;this.imageAtlasTexture=new Re.T(Le,Ue.image,Oe.RGBA8,{useMipmap:qe}),this.imageAtlas.uploaded=!0}this.glyphAtlasImage&&(this.glyphAtlasTexture=new Re.T(Le,this.glyphAtlasImage,Oe.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new Re.T(Le,this.lineAtlas.image,Oe.R8),this.lineAtlas.uploaded=!0)}prepare(Re,Le,Oe){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(Re,this.imageAtlasTexture,Oe),!Le||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const Ue=Le.style.getBrightness();(this._lastUpdatedBrightness||Ue)&&(this._lastUpdatedBrightness&&Ue&&Math.abs(this._lastUpdatedBrightness-Ue)<.001||(this._lastUpdatedBrightness=Ue,this.updateBuckets(Le)))}queryRenderedFeatures(Re,Le,Oe,Ue,qe,Ct,Ot,Jt){return this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)?this.latestFeatureIndex.query({tileResult:Ue,pixelPosMatrix:Ot,transform:Ct,params:qe,tileTransform:this.tileTransform},Re,Le,Oe):{}}querySourceFeatures(Le,Oe){const Ue=this.latestFeatureIndex;if(!Ue||!Ue.rawTileData)return;const qe=Ue.loadVTLayers(),Ct=Oe?Oe.sourceLayer:"",Ot=qe._geojsonTileLayer||qe[Ct];if(!Ot)return;const Jt=Re.aT(Oe&&Oe.filter),{z:Hr,x:Jr,y:Ln}=this.tileID.canonical,Nn={z:Hr,x:Jr,y:Ln};for(let Oe=0;Oe<Ot.length;Oe++){const qe=Ot.feature(Oe);if(Jt.needGeometry){const Le=Re.aU(qe,!0);if(!Jt.filter(new Re.a3(this.tileID.overscaledZ),Le,this.tileID.canonical))continue}else if(!Jt.filter(new Re.a3(this.tileID.overscaledZ),qe))continue;const $n=Ue.getId(qe,Ct),Gn=new Re.aV(qe,Hr,Jr,Ln,$n);Gn.tile=Nn,Le.push(Gn)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(Le){const Oe=this.expirationTime;if(Le.cacheControl){const Oe=Re.aW(Le.cacheControl);Oe["max-age"]&&(this.expirationTime=Date.now()+1e3*Oe["max-age"])}else Le.expires&&(this.expirationTime=new Date(Le.expires).getTime());if(this.expirationTime){const Re=Date.now();let Le=!1;if(this.expirationTime>Re)Le=!1;else if(Oe)if(this.expirationTime<Oe)Le=!0;else{const Ue=this.expirationTime-Oe;Ue?this.expirationTime=Re+Math.max(Ue,3e4):Le=!0}else Le=!0;Le?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(Re,Le){this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(Re).length&&Le&&this.updateBuckets(Le)}updateBuckets(Le){if(!this.latestFeatureIndex)return;const Oe=this.latestFeatureIndex.loadVTLayers(),Ue=Le.style.listImages(),qe=Le.style.getBrightness();for(const Ct in this.buckets){if(!Le.style.hasLayer(Ct))continue;const Ot=this.buckets[Ct],Jt=Ot.layers[0].sourceLayer||"_geojsonTileLayer",Hr=Oe[Jt],Jr=Le.style.getOwnSourceCache(Ot.layers[0].source);let Ln={};Jr&&(Ln=Jr._state.getState(Jt,void 0)),Ot.update(Ln,Hr,Ue,this.imageAtlas&&this.imageAtlas.patternPositions||{},qe),(Ot instanceof Re.aX||Ot instanceof Re.aY)&&Le._terrain&&Le._terrain.enabled&&Jr&&Ot.programConfigurations.needsUpload&&Le._terrain._clearRenderCacheForTile(Jr.id,this.tileID);const Nn=Le&&Le.style&&Le.style.getOwnLayer(Ct);Nn&&(this.queryPadding=Math.max(this.queryPadding,Nn.queryRadius(Ot)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Re.q.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(Le){this.symbolFadeHoldUntil=Re.q.now()+Le}setTexture(Le,Oe){const Ue=Oe.context,qe=Ue.gl;this.texture=this.texture||Oe.getTileTexture(Le.width),this.texture&&this.texture instanceof Re.T?this.texture.update(Le):(this.texture=new Re.T(Ue,Le,qe.RGBA8,{useMipmap:!0}),this.texture.bind(qe.LINEAR,qe.CLAMP_TO_EDGE))}setDependencies(Re,Le){const Oe={};for(const Re of Le)Oe[Re]=!0;this.dependencies[Re]=Oe}hasDependency(Re,Le){for(const Oe of Re){const Re=this.dependencies[Oe];if(Re)for(const Oe of Le)if(Re[Oe])return!0}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(Le,Oe){if(!Oe||"mercator"===Oe.name||this._tileDebugBuffer)return;const Ue=Re.aZ(Kl,this.tileID.canonical,this.tileTransform)[0],qe=new Re.a_,Ct=new Re.a$;for(let Re=0;Re<Ue.length;Re++){const{x:Le,y:Oe}=Ue[Re];qe.emplaceBack(Le,Oe),Ct.emplaceBack(Re)}Ct.emplaceBack(0),this._tileDebugIndexBuffer=Le.createIndexBuffer(Ct),this._tileDebugBuffer=Le.createVertexBuffer(qe,Re.b0.members),this._tileDebugSegments=Re.b1.simpleSegment(0,0,qe.length,Ct.length)}_makeTileBoundsBuffers(Le,Oe){if(this._tileBoundsBuffer||!Oe||"mercator"===Oe.name)return;const Ue=Re.aZ(Kl,this.tileID.canonical,this.tileTransform)[0];let qe,Ct;if(this.isRaster){const Le=function(Le,Oe){const Ue=Re.aK(Le,Oe),qe=Math.pow(2,Le.z);for(let Ct=0;Ct<fl;Ct++)for(let Ot=0;Ot<fl;Ot++){const Jt=Re.aL((Le.x+(Ot+dt(Ot))/sl)/qe),Hr=Re.aM((Le.y+(Ct+dt(Ct))/sl)/qe),Jr=Oe.project(Jt,Hr),Ln=Ct*fl+Ot;Ml[2*Ln+0]=Math.round((Jr.x*Ue.scale-Ue.x)*Re.ab),Ml[2*Ln+1]=Math.round((Jr.y*Ue.scale-Ue.y)*Re.ab)}Hl.fill(0),Wl.fill(0);for(let Re=2045;Re>=0;Re--){const Le=4*Re,Oe=Al[Le+0],Ue=Al[Le+1],qe=Al[Le+2],Ct=Al[Le+3],Ot=Oe+qe>>1,Jt=Ue+Ct>>1,Hr=Ot+Jt-Ue,Jr=Jt+Oe-Ot,Ln=Ue*fl+Oe,Nn=Ct*fl+qe,$n=Jt*fl+Ot,Gn=Math.hypot((Ml[2*Ln+0]+Ml[2*Nn+0])/2-Ml[2*$n+0],(Ml[2*Ln+1]+Ml[2*Nn+1])/2-Ml[2*$n+1])>=16;Hl[$n]=Hl[$n]||(Gn?1:0),Re<1022&&(Hl[$n]=Hl[$n]||Hl[(Ue+Jr>>1)*fl+(Oe+Hr>>1)]||Hl[(Ct+Jr>>1)*fl+(qe+Hr>>1)])}const Ct=new Re.aN,Ot=new Re.aO;let Jt=0;function l(Le,Oe){const Ue=Oe*fl+Le;return 0===Wl[Ue]&&(Ct.emplaceBack(Ml[2*Ue+0],Ml[2*Ue+1],Le*Re.ab/sl,Oe*Re.ab/sl),Wl[Ue]=++Jt),Wl[Ue]-1}function c(Re,Le,Oe,Ue,qe,Ct){const Jt=Re+Oe>>1,Hr=Le+Ue>>1;if(Math.abs(Re-qe)+Math.abs(Le-Ct)>1&&Hl[Hr*fl+Jt])c(qe,Ct,Re,Le,Jt,Hr),c(Oe,Ue,qe,Ct,Jt,Hr);else{const Jt=l(Re,Le),Hr=l(Oe,Ue),Jr=l(qe,Ct);Ot.emplaceBack(Jt,Hr,Jr)}}return c(0,0,sl,sl,sl,0),c(sl,sl,0,0,0,sl),{vertices:Ct,indices:Ot}}(this.tileID.canonical,Oe);qe=Le.vertices,Ct=Le.indices}else{qe=new Re.aN,Ct=new Re.aO;for(const{x:Re,y:Le}of Ue)qe.emplaceBack(Re,Le,0,0);const Le=Re.b2(qe.int16,void 0,4);for(let Re=0;Re<Le.length;Re+=3)Ct.emplaceBack(Le[Re],Le[Re+1],Le[Re+2])}this._tileBoundsBuffer=Le.createVertexBuffer(qe,Re.b3.members),this._tileBoundsIndexBuffer=Le.createIndexBuffer(Ct),this._tileBoundsSegments=Re.b1.simpleSegment(0,0,qe.length,Ct.length)}_makeGlobeTileDebugBuffers(Le,Oe){const Ue=Oe.projection;if(!Ue||"globe"!==Ue.name||Oe.freezeTileCoverage)return;const qe=this.tileID.canonical,Ct=Re.b4(qe,Oe),Ot=Re.b5(Ct),Jt=Re.a9(Oe.zoom);let Hr;Jt>0&&(Hr=Re.a6.mat4.invert(new Float64Array(16),Oe.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(Le,qe,Oe,Ot,Hr,Jt),this._makeGlobeTileDebugTextBuffer(Le,qe,Oe,Ot,Hr,Jt)}_globePoint(Le,Oe,Ue,qe,Ct,Ot,Jt){let Hr=Re.b6(Le,Oe,Ue);if(Ot){const Ct=1<<Ue.z,Jr=Re.am(qe.center.lng),Ln=Re.at(qe.center.lat),Nn=(Ue.x+.5)/Ct-Jr;let $n=0;Nn>.5?$n=-1:Nn<-.5&&($n=1);let Gn=(Le/Re.ab+Ue.x)/Ct+$n,qn=(Oe/Re.ab+Ue.y)/Ct;Gn=(Gn-Jr)*qe._pixelsPerMercatorPixel+Jr,qn=(qn-Ln)*qe._pixelsPerMercatorPixel+Ln;const Zn=[Gn*qe.worldSize,qn*qe.worldSize,0];Re.a6.vec3.transformMat4(Zn,Zn,Ot),Hr=Re.b7(Hr,Zn,Jt)}return Re.a6.vec3.transformMat4(Hr,Hr,Ct)}_makeGlobeTileDebugBorderBuffer(Le,Oe,Ue,qe,Ct,Ot){const Jt=new Re.a_,Hr=new Re.a$,Jr=new Re.b8,h=(Re,Le,Ln,Nn,$n)=>{const Gn=(Ln-Re)/($n-1),qn=(Nn-Le)/($n-1),Zn=Jt.length;for(let Ln=0;Ln<$n;Ln++){const Nn=Re+Ln*Gn,$n=Le+Ln*qn;Jt.emplaceBack(Nn,$n);const Xn=this._globePoint(Nn,$n,Oe,Ue,qe,Ct,Ot);Jr.emplaceBack(Xn[0],Xn[1],Xn[2]),Hr.emplaceBack(Zn+Ln)}},Ln=Re.ab;h(0,0,Ln,0,16),h(Ln,0,Ln,Ln,16),h(Ln,Ln,0,Ln,16),h(0,Ln,0,0,16),this._tileDebugIndexBuffer=Le.createIndexBuffer(Hr),this._tileDebugBuffer=Le.createVertexBuffer(Jt,Re.b0.members),this._globeTileDebugBorderBuffer=Le.createVertexBuffer(Jr,Re.b9.members),this._tileDebugSegments=Re.b1.simpleSegment(0,0,Jt.length,Hr.length)}_makeGlobeTileDebugTextBuffer(Le,Oe,Ue,qe,Ct,Ot){const Jt=Re.ab/4,Hr=new Re.a_,Jr=new Re.aO,Ln=new Re.b8,Nn=25;Jr.reserve(32),Hr.reserve(Nn),Ln.reserve(Nn);const d=(Re,Le)=>Nn*Re+Le;for(let Re=0;Re<Nn;Re++){const Le=Re*Jt;for(let Re=0;Re<Nn;Re++){const Jr=Re*Jt;Hr.emplaceBack(Jr,Le);const Nn=this._globePoint(Jr,Le,Oe,Ue,qe,Ct,Ot);Ln.emplaceBack(Nn[0],Nn[1],Nn[2])}}for(let Re=0;Re<4;Re++)for(let Le=0;Le<4;Le++){const Oe=d(Re,Le),Ue=d(Re,Le+1),qe=d(Re+1,Le),Ct=d(Re+1,Le+1);Jr.emplaceBack(Oe,Ue,qe),Jr.emplaceBack(qe,Ue,Ct)}this._tileDebugTextIndexBuffer=Le.createIndexBuffer(Jr),this._tileDebugTextBuffer=Le.createVertexBuffer(Hr,Re.b0.members),this._globeTileDebugTextBuffer=Le.createVertexBuffer(Ln,Re.b9.members),this._tileDebugTextSegments=Re.b1.simpleSegment(0,0,Nn,32)}destroy(Le=!1){for(const Re in this.buckets)this.buckets[Re].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!Le&&this.texture&&this.texture instanceof Re.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}Re.ba.setPbf(Re.bb);class mt extends pt{constructor(Re,Le,Oe,Ue,qe){super(Re,Le,Oe,Ue,qe),this._workQueue=[],this._fetchQueue=[],this._isHeaderLoaded=!1}setTexture(Le,Oe){const Ue=Oe.context,qe=Ue.gl;this.texture=this.texture||Oe.getTileTexture(Le.width),this.texture&&this.texture instanceof Re.T?this.texture.update(Le,{premultiply:!1}):this.texture=new Re.T(Ue,Le,qe.RGBA8,{premultiply:!1})}flushQueues(){for(;this._workQueue.length;)this._workQueue.pop()();for(;this._fetchQueue.length;)this._fetchQueue.pop()()}fetchHeader(Le=16384,Oe){const Ue=this._mrt=new Re.ba(30),qe=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(Le-1)}});return this.entireBuffer=null,this.request=Re.bc(qe,((Re,qe,Ct,Ot)=>{if(Re)Oe(Re);else try{const Re=Ue.getHeaderLength(qe);if(Re>Le)return void(this.request=this.fetchHeader(Re,Oe));Ue.parseHeader(qe),this._isHeaderLoaded=!0;let Jt=0;for(const Re of Object.values(Ue.layers))Jt=Math.max(Jt,Re.dataIndex[Re.dataIndex.length-1].last_byte);qe.byteLength>=Jt&&(this.entireBuffer=qe),Oe(null,this.entireBuffer||qe,Ct,Ot)}catch(Re){Oe(Re)}})),this.request}fetchBand(Le,Oe,Ue){const qe=this._mrt;if(!this._isHeaderLoaded||!qe)return void Ue(new Error("Tile header is not ready"));const Ct=this.actor;if(!Ct)return void Ue(new Error("Can't fetch tile band without an actor"));let Ot;const n=(Re,qe)=>{Ot.complete(Re,qe),Re?Ue(Re):(this.updateTextureDescriptor(Le,Oe),Ue(null,this.textureDescriptor&&this.textureDescriptor.img))},l=(Re,Le)=>{if(Re)return Ue(Re);const Oe=Ct.send("decodeRasterArray",{buffer:Le,task:Ot},n,void 0,!0);this._workQueue.push((()=>{Oe&&Oe.cancel(),Ot.cancel()}))},Jt=qe.getLayer(Le);if(!Jt)return void Ue(new Error(`Unknown sourceLayer "${Le}"`));if(Jt.hasDataForBand(Oe))return this.updateTextureDescriptor(Le,Oe),void Ue(null,this.textureDescriptor?this.textureDescriptor.img:null);const Hr=Jt.getDataRange([Oe]);if(Ot=qe.createDecodingTask(Hr),!Ot||Ot.tasks.length)if(this.flushQueues(),this.entireBuffer)l(null,this.entireBuffer.slice(Hr.firstByte,Hr.lastByte+1));else{const Le=Object.assign({},this.requestParams,{headers:{Range:`bytes=${Hr.firstByte}-${Hr.lastByte}`}}),Oe=Re.bc(Le,l);this._fetchQueue.push((()=>{Oe.cancel(),Ot.cancel()}))}else Ue(null)}updateNeeded(Re,Le){return(!this.textureDescriptor||this.textureDescriptor.band!==Le||this.textureDescriptor.layer!==Re)&&"errored"!==this.state}updateTextureDescriptor(Le,Oe){if(!this._mrt)return;const Ue=this._mrt.getLayer(Le);if(!Ue||!Ue.hasBand(Oe)||!Ue.hasDataForBand(Oe))return;const{bytes:qe,tileSize:Ct,buffer:Ot,offset:Jt,scale:Hr}=Ue.getBandView(Oe),Jr=Ct+2*Ot,Ln={data:qe,width:Jr,height:Jr},Nn=this.texture;Nn&&Nn instanceof Re.T&&Nn.update(Ln,{premultiply:!1}),this.textureDescriptor={layer:Le,band:Oe,img:Ln,buffer:Ot,offset:Jt,tileSize:Ct,format:Ue.pixelFormat,mix:[Hr,256*Hr,65536*Hr,16777216*Hr]}}}class ft{constructor(Re,Le){this.max=Re,this.onRemove=Le,this.reset()}reset(){for(const Re in this.data)for(const Le of this.data[Re])Le.timeout&&clearTimeout(Le.timeout),this.onRemove(Le.value);return this.data={},this.order=[],this}add(Re,Le,Oe){const Ue=Re.wrapped().key;void 0===this.data[Ue]&&(this.data[Ue]=[]);const qe={value:Le,timeout:void 0};if(void 0!==Oe&&(qe.timeout=setTimeout((()=>{this.remove(Re,qe)}),Oe)),this.data[Ue].push(qe),this.order.push(Ue),this.order.length>this.max){const Re=this._getAndRemoveByKey(this.order[0]);Re&&this.onRemove(Re)}return this}has(Re){return Re.wrapped().key in this.data}getAndRemove(Re){return this.has(Re)?this._getAndRemoveByKey(Re.wrapped().key):null}_getAndRemoveByKey(Re){const Le=this.data[Re].shift();return Le.timeout&&clearTimeout(Le.timeout),0===this.data[Re].length&&delete this.data[Re],this.order.splice(this.order.indexOf(Re),1),Le.value}getByKey(Re){const Le=this.data[Re];return Le?Le[0].value:null}get(Re){return this.has(Re)?this.data[Re.wrapped().key][0].value:null}remove(Re,Le){if(!this.has(Re))return this;const Oe=Re.wrapped().key,Ue=void 0===Le?0:this.data[Oe].indexOf(Le),qe=this.data[Oe][Ue];return this.data[Oe].splice(Ue,1),qe.timeout&&clearTimeout(qe.timeout),0===this.data[Oe].length&&delete this.data[Oe],this.onRemove(qe.value),this.order.splice(this.order.indexOf(Oe),1),this}setMaxSize(Re){for(this.max=Re;this.order.length>this.max;){const Re=this._getAndRemoveByKey(this.order[0]);Re&&this.onRemove(Re)}return this}filter(Re){const Le=[];for(const Oe in this.data)for(const Ue of this.data[Oe])Re(Ue.value)||Le.push(Ue);for(const Re of Le)this.remove(Re.value.tileID,Re)}}class gt{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(Le,Oe,Ue){const qe=String(Oe);if(this.stateChanges[Le]=this.stateChanges[Le]||{},this.stateChanges[Le][qe]=this.stateChanges[Le][qe]||{},Re.l(this.stateChanges[Le][qe],Ue),null===this.deletedStates[Le]){this.deletedStates[Le]={};for(const Re in this.state[Le])Re!==qe&&(this.deletedStates[Le][Re]=null)}else if(this.deletedStates[Le]&&null===this.deletedStates[Le][qe]){this.deletedStates[Le][qe]={};for(const Re in this.state[Le][qe])Ue[Re]||(this.deletedStates[Le][qe][Re]=null)}else for(const Re in Ue)this.deletedStates[Le]&&this.deletedStates[Le][qe]&&null===this.deletedStates[Le][qe][Re]&&delete this.deletedStates[Le][qe][Re]}removeFeatureState(Re,Le,Oe){if(null===this.deletedStates[Re])return;const Ue=String(Le);if(this.deletedStates[Re]=this.deletedStates[Re]||{},Oe&&void 0!==Le)null!==this.deletedStates[Re][Ue]&&(this.deletedStates[Re][Ue]=this.deletedStates[Re][Ue]||{},this.deletedStates[Re][Ue][Oe]=null);else if(void 0!==Le)if(this.stateChanges[Re]&&this.stateChanges[Re][Ue])for(Oe in this.deletedStates[Re][Ue]={},this.stateChanges[Re][Ue])this.deletedStates[Re][Ue][Oe]=null;else this.deletedStates[Re][Ue]=null;else this.deletedStates[Re]=null}getState(Le,Oe){const Ue=this.state[Le]||{},qe=this.stateChanges[Le]||{},Ct=this.deletedStates[Le];if(null===Ct)return{};if(void 0!==Oe){const Le=String(Oe),Ot=Re.l({},Ue[Le],qe[Le]);if(Ct){const Re=Ct[Oe];if(null===Re)return{};for(const Le in Re)delete Ot[Le]}return Ot}const Ot=Re.l({},Ue,qe);if(Ct)for(const Re in Ct)delete Ot[Re];return Ot}initializeTileState(Re,Le){Re.setFeatureState(this.state,Le)}coalesceChanges(Le,Oe){const Ue={};for(const Le in this.stateChanges){this.state[Le]=this.state[Le]||{};const Oe={};for(const Ue in this.stateChanges[Le])this.state[Le][Ue]||(this.state[Le][Ue]={}),Re.l(this.state[Le][Ue],this.stateChanges[Le][Ue]),Oe[Ue]=this.state[Le][Ue];Ue[Le]=Oe}for(const Le in this.deletedStates){this.state[Le]=this.state[Le]||{};const Oe={};if(null===this.deletedStates[Le])for(const Re in this.state[Le])Oe[Re]={},this.state[Le][Re]={};else for(const Re in this.deletedStates[Le]){if(null===this.deletedStates[Le][Re])this.state[Le][Re]={};else if(this.state[Le][Re])for(const Oe of Object.keys(this.deletedStates[Le][Re]))delete this.state[Le][Re][Oe];Oe[Re]=this.state[Le][Re]}Ue[Le]=Ue[Le]||{},Re.l(Ue[Le],Oe)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(Ue).length)for(const Re in Le)Le[Re].setFeatureState(Ue,Oe)}}class vt extends Re.E{constructor(Re,Le,Oe){super(),this.id=Re,this._onlySymbols=Oe,Le.on("data",(Re=>{"source"===Re.dataType&&"metadata"===Re.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===Re.dataType&&"content"===Re.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))})),Le.on("error",(()=>{this._sourceErrored=!0})),this._source=Le,this._tiles={},this._cache=new ft(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=Le.minTileCacheSize,this._maxTileCacheSize=Le.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new gt,this._isRaster="raster"===this._source.type||"raster-dem"===this._source.type||"raster-array"===this._source.type||"custom"===this._source.type&&"raster"===this._source._dataType}onAdd(Re){this.map=Re,this._minTileCacheSize=void 0===this._minTileCacheSize&&Re?Re._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=void 0===this._maxTileCacheSize&&Re?Re._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;for(const Re in this._tiles){const Le=this._tiles[Re];if("loaded"!==Le.state&&"errored"!==Le.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const Re=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,Re&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(Re,Le){return Re.isSymbolTile=this._onlySymbols,Re.isExtraShadowCaster=this._shadowCasterTiles[Re.tileID.key],this._source.loadTile(Re,Le)}_unloadTile(Re){if(this._source.unloadTile)return this._source.unloadTile(Re)}_abortTile(Re){if(this._source.abortTile)return this._source.abortTile(Re)}serialize(){return this._source.serialize()}prepare(Re){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const Le in this._tiles){const Oe=this._tiles[Le];Oe.upload(Re),Oe.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return Re.bd(this._tiles).map((Re=>Re.tileID)).sort(xt).map((Re=>Re.key))}getRenderableIds(Le,Oe){const Ue=[];for(const Re in this._tiles)this._isIdRenderable(+Re,Le,Oe)&&Ue.push(this._tiles[Re]);return Le?Ue.sort(((Le,Oe)=>{const Ue=Le.tileID,qe=Oe.tileID,Ct=new Re.P(Ue.canonical.x,Ue.canonical.y)._rotate(this.transform.angle),Ot=new Re.P(qe.canonical.x,qe.canonical.y)._rotate(this.transform.angle);return Ue.overscaledZ-qe.overscaledZ||Ot.y-Ct.y||Ot.x-Ct.x})).map((Re=>Re.tileID.key)):Ue.map((Re=>Re.tileID)).sort(xt).map((Re=>Re.key))}hasRenderableParent(Re){const Le=this.findLoadedParent(Re,0);return!!Le&&this._isIdRenderable(Le.tileID.key)}_isIdRenderable(Re,Le,Oe){return this._tiles[Re]&&this._tiles[Re].hasData()&&!this._coveredTiles[Re]&&(Le||!this._tiles[Re].holdingForFade())&&(Oe||!this._shadowCasterTiles[Re])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const Re in this._tiles)"errored"!==this._tiles[Re].state&&this._reloadTile(+Re,"reloading")}}_reloadTile(Re,Le){const Oe=this._tiles[Re];Oe&&("loading"!==Oe.state&&(Oe.state=Le),this._loadTile(Oe,this._tileLoaded.bind(this,Oe,Re,Le)))}_tileLoaded(Le,Oe,Ue,qe){if(qe)if(Le.state="errored",404!==qe.status)this._source.fire(new Re.t(qe,{tile:Le}));else{if(this._source.fire(new Re.x("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id,tile:Le})),!(Le.tileID.key in this._loadedParentTiles))return;if("raster-dem"===this._source.type&&this.usedForTerrain&&this.map.painter.terrain){const Re=this.map.painter.terrain;this.update(this.transform,Re.getScaledDemTileSize(),!0),Re.resetTileLookupCache(this.id)}else this.update(this.transform)}else Le.timeAdded=Re.q.now(),"expired"===Ue&&(Le.refreshedUponExpiration=!0),this._setTileReloadTimer(Oe,Le),"raster-dem"===this._source.type&&Le.dem&&this._backfillDEM(Le),this._state.initializeTileState(Le,this.map?this.map.painter:null),this._source.fire(new Re.x("data",{dataType:"source",tile:Le,coord:Le.tileID,sourceCacheId:this.id}))}_backfillDEM(Re){const Le=this.getRenderableIds();for(let Oe=0;Oe<Le.length;Oe++){const Ue=Le[Oe];if(Re.neighboringTiles&&Re.neighboringTiles[Ue]){const Le=this.getTileByID(Ue);i(Re,Le),i(Le,Re)}}function i(Re,Le){if(!Re.dem||Re.dem.borderReady)return;Re.needsHillshadePrepare=!0,Re.needsDEMTextureUpload=!0;let Oe=Le.tileID.canonical.x-Re.tileID.canonical.x;const Ue=Le.tileID.canonical.y-Re.tileID.canonical.y,qe=Math.pow(2,Re.tileID.canonical.z),Ct=Le.tileID.key;0===Oe&&0===Ue||Math.abs(Ue)>1||(Math.abs(Oe)>1&&(1===Math.abs(Oe+qe)?Oe+=qe:1===Math.abs(Oe-qe)&&(Oe-=qe)),Le.dem&&Re.dem&&(Re.dem.backfillBorder(Le.dem,Oe,Ue),Re.neighboringTiles&&Re.neighboringTiles[Ct]&&(Re.neighboringTiles[Ct].backfilled=!0)))}}getTile(Re){return this.getTileByID(Re.key)}getTileByID(Re){return this._tiles[Re]}_retainLoadedChildren(Re,Le,Oe,Ue){for(const qe in this._tiles){let Ct=this._tiles[qe];if(Ue[qe]||!Ct.hasData()||Ct.tileID.overscaledZ<=Le||Ct.tileID.overscaledZ>Oe)continue;let Ot=Ct.tileID;for(;Ct&&Ct.tileID.overscaledZ>Le+1;){const Re=Ct.tileID.scaledTo(Ct.tileID.overscaledZ-1);Ct=this._tiles[Re.key],Ct&&Ct.hasData()&&(Ot=Re)}let Jt=Ot;for(;Jt.overscaledZ>Le;)if(Jt=Jt.scaledTo(Jt.overscaledZ-1),Re[Jt.key]){Ue[Ot.key]=Ot;break}}}findLoadedParent(Re,Le){if(Re.key in this._loadedParentTiles){const Oe=this._loadedParentTiles[Re.key];return Oe&&Oe.tileID.overscaledZ>=Le?Oe:null}for(let Oe=Re.overscaledZ-1;Oe>=Le;Oe--){const Le=Re.scaledTo(Oe),Ue=this._getLoadedTile(Le);if(Ue)return Ue}}_getLoadedTile(Re){const Le=this._tiles[Re.key];return Le&&Le.hasData()?Le:this._cache.getByKey(this._source.reparseOverscaled?Re.wrapped().key:Re.canonical.key)}updateCacheSize(Re,Le){Le=Le||this._source.tileSize;const Oe=Math.ceil(Re.width/Le)+1,Ue=Math.ceil(Re.height/Le)+1,qe=Math.floor(Oe*Ue*5),Ct="number"==typeof this._minTileCacheSize?Math.max(this._minTileCacheSize,qe):qe,Ot="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,Ct):Ct;this._cache.setMaxSize(Ot)}handleWrapJump(Re){const Le=Math.round((Re-(void 0===this._prevLng?Re:this._prevLng))/360);if(this._prevLng=Re,Le){const Re={};for(const Oe in this._tiles){const Ue=this._tiles[Oe];Ue.tileID=Ue.tileID.unwrapTo(Ue.tileID.wrap+Le),Re[Ue.tileID.key]=Ue}this._tiles=Re;for(const Re in this._timers)clearTimeout(this._timers[Re]),delete this._timers[Re];for(const Re in this._tiles)this._setTileReloadTimer(+Re,this._tiles[Re])}}update(Le,Oe,Ue,qe){if(this.transform=Le,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage)return;if(this.usedForTerrain&&!Ue)return;this.updateCacheSize(Le,Oe),"globe"!==this.transform.projection.name&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={};const Ct="batched-model"===this._source.type;let Ot;if(this.used||this.usedForTerrain){if(this._source.tileID)Ot=Le.getVisibleUnwrappedCoordinates(this._source.tileID).map((Le=>new Re.aA(Le.canonical.z,Le.wrap,Le.canonical.z,Le.canonical.x,Le.canonical.y)));else if(0!==this.tileCoverLift){const qe=Le.clone();qe.tileCoverLift=this.tileCoverLift,Ot=qe.coveringTiles({tileSize:Oe||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!Ue,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:Ct}),this._source.minzoom<=1&&"globe"===Le.projection.name&&(Ot.push(new Re.aA(1,0,1,0,0)),Ot.push(new Re.aA(1,0,1,1,0)),Ot.push(new Re.aA(1,0,1,0,1)),Ot.push(new Re.aA(1,0,1,1,1)))}else if(Ot=Le.coveringTiles({tileSize:Oe||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!Ue,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:Ct}),this._source.hasTile){const Re=this._source.hasTile.bind(this._source);Ot=Ot.filter((Le=>Re(Le)))}}else Ot=[];if(Ot.length>0&&this.castsShadows&&qe&&"globe"!==this.transform.projection.name&&!this.usedForTerrain&&!yt(this._source.type)){const Re=Le.coveringZoomLevel({tileSize:Oe||this._source.tileSize,roundZoom:this._source.roundZoom&&!Ue}),Jt=Math.min(Re,this._source.maxzoom);if(Ct){const Re=Le.extendTileCover(Ot,Jt);for(const Le of Re)Ot.push(Le)}else{const Re=Le.extendTileCover(Ot,Jt,qe);for(const Le of Re)this._shadowCasterTiles[Le.key]=!0,Ot.push(Le)}}const Jt=this._updateRetainedTiles(Ot);if(yt(this._source.type)&&0!==Ot.length){const Le={},Oe={},Ue=Object.keys(Jt);for(const qe of Ue){const Ue=Jt[qe],Ct=this._tiles[qe];if(!Ct||Ct.fadeEndTime&&Ct.fadeEndTime<=Re.q.now())continue;const Ot=this.findLoadedParent(Ue,Math.max(Ue.overscaledZ-vt.maxOverzooming,this._source.minzoom));Ot&&(this._addTile(Ot.tileID),Le[Ot.tileID.key]=Ot.tileID),Oe[qe]=Ue}const qe=Ot[Ot.length-1].overscaledZ;for(const Re in this._tiles){const Le=this._tiles[Re];if(Jt[Re]||!Le.hasData())continue;let Ue=Le.tileID;for(;Ue.overscaledZ>qe;){Ue=Ue.scaledTo(Ue.overscaledZ-1);const qe=this._tiles[Ue.key];if(qe&&qe.hasData()&&Oe[Ue.key]){Jt[Re]=Le.tileID;break}}}for(const Re in Le)Jt[Re]||(this._coveredTiles[Re]=!0,Jt[Re]=Le[Re])}for(const Re in Jt)this._tiles[Re].clearFadeHold();const Hr=Re.be(this._tiles,Jt);for(const Re of Hr){const Le=this._tiles[Re];Le.hasSymbolBuckets&&!Le.holdingForFade()?Le.setHoldDuration(this.map._fadeDuration):Le.hasSymbolBuckets&&!Le.symbolFadeFinished()||this._removeTile(+Re)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const Re in this._tiles)this._tiles[Re].holdingForFade()&&this._removeTile(+Re)}_updateRetainedTiles(Re){const Le={};if(0===Re.length)return Le;const Oe={},Ue=Re.reduce(((Re,Le)=>Math.min(Re,Le.overscaledZ)),1/0),qe=Re[0].overscaledZ,Ct=Math.max(qe-vt.maxOverzooming,this._source.minzoom),Ot=Math.max(qe+vt.maxUnderzooming,this._source.minzoom),Jt={};for(const Oe of Re){const Re=this._addTile(Oe);Le[Oe.key]=Oe,Re.hasData()||Ue<this._source.maxzoom&&(Jt[Oe.key]=Oe)}this._retainLoadedChildren(Jt,Ue,Ot,Le);for(const Ue of Re){let Re=this._tiles[Ue.key];if(Re.hasData())continue;if(Ue.canonical.z>=this._source.maxzoom){const Re=Ue.children(this._source.maxzoom)[0],Oe=this.getTile(Re);if(Oe&&Oe.hasData()){Le[Re.key]=Re;continue}}else{const Re=Ue.children(this._source.maxzoom);if(Le[Re[0].key]&&Le[Re[1].key]&&Le[Re[2].key]&&Le[Re[3].key])continue}let qe=Re.wasRequested();for(let Ot=Ue.overscaledZ-1;Ot>=Ct;--Ot){const Ct=Ue.scaledTo(Ot);if(Oe[Ct.key])break;if(Oe[Ct.key]=!0,Re=this.getTile(Ct),!Re&&qe&&(Re=this._addTile(Ct)),Re&&(Le[Ct.key]=Ct,qe=Re.wasRequested(),Re.hasData()))break}}return Le}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const Re in this._tiles){const Le=[];let Oe,Ue=this._tiles[Re].tileID;for(;Ue.overscaledZ>0;){if(Ue.key in this._loadedParentTiles){Oe=this._loadedParentTiles[Ue.key];break}Le.push(Ue.key);const Re=Ue.scaledTo(Ue.overscaledZ-1);if(Oe=this._getLoadedTile(Re),Oe)break;Ue=Re}for(const Re of Le)this._loadedParentTiles[Re]=Oe}}_addTile(Le){let Oe=this._tiles[Le.key];if(Oe)return!0!==Oe.isExtraShadowCaster||!!this._shadowCasterTiles[Le.key]||this._reloadTile(Le.key,"reloading"),Oe;Oe=this._cache.getAndRemove(Le),Oe&&(this._setTileReloadTimer(Le.key,Oe),Oe.tileID=Le,this._state.initializeTileState(Oe,this.map?this.map.painter:null),this._cacheTimers[Le.key]&&(clearTimeout(this._cacheTimers[Le.key]),delete this._cacheTimers[Le.key],this._setTileReloadTimer(Le.key,Oe)));const Ue=Boolean(Oe);if(!Ue){const Re=this.map?this.map.painter:null,Ue=this._source.tileSize*Le.overscaleFactor();Oe="raster-array"===this._source.type?new mt(Le,Ue,this.transform.tileZoom,Re,this._isRaster):new pt(Le,Ue,this.transform.tileZoom,Re,this._isRaster),this._loadTile(Oe,this._tileLoaded.bind(this,Oe,Le.key,Oe.state))}return Oe?(Oe.uses++,this._tiles[Le.key]=Oe,Ue||this._source.fire(new Re.x("dataloading",{tile:Oe,coord:Oe.tileID,dataType:"source"})),Oe):null}_setTileReloadTimer(Re,Le){Re in this._timers&&(clearTimeout(this._timers[Re]),delete this._timers[Re]);const Oe=Le.getExpiryTimeout();Oe&&(this._timers[Re]=setTimeout((()=>{this._reloadTile(Re,"expired"),delete this._timers[Re]}),Oe))}_removeTile(Re){const Le=this._tiles[Re];Le&&(Le.uses--,delete this._tiles[Re],this._timers[Re]&&(clearTimeout(this._timers[Re]),delete this._timers[Re]),Le.uses>0||(Le.hasData()&&"reloading"!==Le.state||"empty"===Le.state?this._cache.add(Le.tileID,Le,Le.getExpiryTimeout()):(Le.aborted=!0,this._abortTile(Le),this._unloadTile(Le))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const Re in this._tiles)this._removeTile(+Re);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(Le,Oe,Ue){const qe=[],Ct=this.transform;if(!Ct)return qe;const Ot="globe"===Ct.projection.name,Jt=Re.am(Ct.center.lng);for(const Hr in this._tiles){const Jr=this._tiles[Hr];if(Ue&&Jr.clearQueryDebugViz(),Jr.holdingForFade())continue;let Ln;if(Ot){const Le=Jr.tileID.canonical;if(0===Le.z){const Oe=[Math.abs(Re.ap(Jt,...bt(Le,-1))-Jt),Math.abs(Re.ap(Jt,...bt(Le,1))-Jt)];Ln=[0,2*Oe.indexOf(Math.min(...Oe))-1]}else{const Oe=[Math.abs(Re.ap(Jt,...bt(Le,-1))-Jt),Math.abs(Re.ap(Jt,...bt(Le,0))-Jt),Math.abs(Re.ap(Jt,...bt(Le,1))-Jt)];Ln=[Oe.indexOf(Math.min(...Oe))-1]}}else Ln=[0];for(const Re of Ln){const Ue=Le.containsTile(Jr,Ct,Oe,Re);Ue&&qe.push(Ue)}}return qe}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(Re){return this._getRenderableCoordinates(Re)}_getRenderableCoordinates(Re,Le){const Oe=this.getRenderableIds(Re,Le).map((Re=>this._tiles[Re].tileID)),Ue="globe"===this.transform.projection.name;for(const Re of Oe)Re.projMatrix=this.transform.calculateProjMatrix(Re.toUnwrapped()),Re.expandedProjMatrix=Ue?this.transform.calculateProjMatrix(Re.toUnwrapped(),!1,!0):Re.projMatrix;return Oe}sortCoordinatesByDistance(Re){const Le=Re.slice(),Oe=this.transform._camera.position,Ue=this.transform._camera.forward(),qe={};for(const Re of Le){const Le=1/(1<<Re.canonical.z);qe[Re.key]=((Re.canonical.x+.5)*Le+Re.wrap-Oe[0])*Ue[0]+((Re.canonical.y+.5)*Le-Oe[1])*Ue[1]-Oe[2]*Ue[2]}return Le.sort(((Re,Le)=>qe[Re.key]-qe[Le.key])),Le}hasTransition(){if(this._source.hasTransition())return!0;if(yt(this._source.type))for(const Le in this._tiles){const Oe=this._tiles[Le];if(void 0!==Oe.fadeEndTime&&Oe.fadeEndTime>=Re.q.now())return!0}return!1}setFeatureState(Re,Le,Oe){this._state.updateState(Re=Re||"_geojsonTileLayer",Le,Oe)}removeFeatureState(Re,Le,Oe){this._state.removeFeatureState(Re=Re||"_geojsonTileLayer",Le,Oe)}getFeatureState(Re,Le){return this._state.getState(Re=Re||"_geojsonTileLayer",Le)}setDependencies(Re,Le,Oe){const Ue=this._tiles[Re];Ue&&Ue.setDependencies(Le,Oe)}reloadTilesForDependencies(Re,Le){for(const Oe in this._tiles)this._tiles[Oe].hasDependency(Re,Le)&&this._reloadTile(+Oe,"reloading");this._cache.filter((Oe=>!Oe.hasDependency(Re,Le)))}_preloadTiles(Le,Oe){if(!this._sourceLoaded){const e=()=>{this._sourceLoaded&&(this._source.off("data",e),this._preloadTiles(Le,Oe))};return void this._source.on("data",e)}const Ue=new Map,qe=Array.isArray(Le)?Le:[Le],Ct=this.map.painter.terrain,Ot=this.usedForTerrain&&Ct?Ct.getScaledDemTileSize():this._source.tileSize;for(const Re of qe){const Le=Re.coveringTiles({tileSize:Ot,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const Re of Le)Ue.set(Re.key,Re);this.usedForTerrain&&Re.updateElevation(!1)}const Jt=Array.from(Ue.values());Re.bf(Jt,((Re,Le)=>{const Oe=new pt(Re,this._source.tileSize*Re.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(Oe,(Re=>{"raster-dem"===this._source.type&&Oe.dem&&this._backfillDEM(Oe),Le(Re,Oe)}))}),Oe)}}function xt(Re,Le){const Oe=Math.abs(2*Re.wrap)-+(Re.wrap<0),Ue=Math.abs(2*Le.wrap)-+(Le.wrap<0);return Re.overscaledZ-Le.overscaledZ||Ue-Oe||Le.canonical.y-Re.canonical.y||Le.canonical.x-Re.canonical.x}function yt(Re){return"raster"===Re||"image"===Re||"video"===Re||"custom"===Re}function bt(Re,Le){const Oe=1<<Re.z;return[Re.x/Oe+Le,(Re.x+1)/Oe+Le]}vt.maxOverzooming=10,vt.maxUnderzooming=3;class wt{constructor(Re){this.style=Re,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const Re=!1,Le=!1;for(const Oe in this.style._mergedLayers){const Ue=this.style._mergedLayers[Oe];if("fill-extrusion"===Ue.type)this.layers.push({layer:Ue,visible:Re,visibilityChanged:Le});else if("model"===Ue.type){const Oe=this.style.getLayerSource(Ue);Oe&&"batched-model"===Oe.type&&this.layers.push({layer:Ue,visible:Re,visibilityChanged:Le})}}}onNewFrame(Re){this.layersGotHidden=!1;for(const Le of this.layers){const Oe=Le.layer;let Ue=!1;"fill-extrusion"===Oe.type?Ue=!Oe.isHidden(Re)&&Oe.paint.get("fill-extrusion-opacity")>0:"model"===Oe.type&&(Ue=!Oe.isHidden(Re)&&Oe.paint.get("model-opacity")>0),this.layersGotHidden=this.layersGotHidden||!Ue&&Le.visible,Le.visible=Ue}}updateZOffset(Re,Le){this.currentBuildingBuckets=[];for(const Re of this.layers){const Oe=Re.layer,Ue=this.style.getLayerSourceCache(Oe);let qe=1;"fill-extrusion"===Oe.type&&(qe=Re.visible?Oe.paint.get("fill-extrusion-vertical-scale"):0);let Ct=Ue?Ue.getTile(Le):null;if(!Ct&&Ue&&Le.canonical.z>Ue.getSource().minzoom){let Re=Le.scaledTo(Math.min(Ue.getSource().maxzoom,Le.overscaledZ-1));for(;Re.overscaledZ>=Ue.getSource().minzoom&&(Ct=Ue.getTile(Re),!Ct&&0!==Re.overscaledZ);)Re=Re.scaledTo(Re.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:Ct?Ct.getBucket(Oe):null,tileID:Ct?Ct.tileID:Le,verticalScale:qe})}Re.hasAnyZOffset=!1;let Oe=!1;for(let Ue=0;Ue<Re.symbolInstances.length;Ue++){const qe=Re.symbolInstances.get(Ue),Ct=qe.zOffset,Ot=this._getHeightAtTileOffset(Le,qe.tileAnchorX,qe.tileAnchorY);qe.zOffset=Ot!==Number.NEGATIVE_INFINITY?Ot:Ct,Oe||Ct===qe.zOffset||(Oe=!0),Re.hasAnyZOffset||0===qe.zOffset||(Re.hasAnyZOffset=!0)}Oe&&(Re.zOffsetBuffersNeedUpload=!0,Re.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(Le,Oe,Ue,qe){let Ct=Oe,Ot=Ue;if(Le.canonical.z!==qe.canonical.z){const Jt=qe.canonical,Hr=1/(1<<Le.canonical.z-Jt.z);Ct=(Oe+Le.canonical.x*Re.ab)*Hr-Jt.x*Re.ab|0,Ot=(Ue+Le.canonical.y*Re.ab)*Hr-Jt.y*Re.ab|0}return{tileX:Ct,tileY:Ot}}_getHeightAtTileOffset(Re,Le,Oe){let Ue,qe;for(let Ct=0;Ct<this.layers.length;++Ct){if("fill-extrusion"!==this.layers[Ct].layer.type)continue;const{bucket:Ot,tileID:Jt,verticalScale:Hr}=this.currentBuildingBuckets[Ct];if(!Ot)continue;const{tileX:Jr,tileY:Ln}=this._mapCoordToOverlappingTile(Re,Le,Oe,Jt),Nn=Ot.getHeightAtTileCoord(Jr,Ln);Nn&&void 0!==Nn.height&&(Nn.hidden?Ue=Nn.height:qe=Math.max(Nn.height*Hr,qe||0))}if(void 0!==qe)return qe;for(let qe=0;qe<this.layers.length;++qe){const Ct=this.layers[qe];if("model"!==Ct.layer.type||!Ct.visible)continue;const{bucket:Ot,tileID:Jt}=this.currentBuildingBuckets[qe];if(!Ot)continue;const{tileX:Hr,tileY:Jr}=this._mapCoordToOverlappingTile(Re,Le,Oe,Jt),Ln=Ot.getHeightAtTileCoord(Hr,Jr);if(Ln&&!Ln.hidden)return void 0===Ln.height&&void 0!==Ue?Math.min(Ln.maxHeight,Ue)*Ln.verticalScale:Ln.height?Ln.height*Ln.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function Tt(Le,Oe){const Ue={};for(const Re in Le)"ref"!==Re&&(Ue[Re]=Le[Re]);return Re.bg.forEach((Re=>{Re in Oe&&(Ue[Re]=Oe[Re])})),Ue}function Et(Re){Re=Re.slice();const Le=Object.create(null);for(let Oe=0;Oe<Re.length;Oe++)Le[Re[Oe].id]=Re[Oe];for(let Oe=0;Oe<Re.length;Oe++)"ref"in Re[Oe]&&(Re[Oe]=Tt(Re[Oe],Le[Re[Oe].ref]));return Re}const Jl={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport"};function St(Re,Le,Oe){Oe.push({command:Jl.addSource,args:[Re,Le[Re]]})}function It(Re,Le,Oe){Le.push({command:Jl.removeSource,args:[Re]}),Oe[Re]=!0}function Dt(Re,Le,Oe,Ue){It(Re,Oe,Ue),St(Re,Le,Oe)}function Rt(Le,Oe,Ue){let qe;for(qe in Le[Ue])if(Le[Ue].hasOwnProperty(qe)&&"data"!==qe&&!Re.bh(Le[Ue][qe],Oe[Ue][qe]))return!1;for(qe in Oe[Ue])if(Oe[Ue].hasOwnProperty(qe)&&"data"!==qe&&!Re.bh(Le[Ue][qe],Oe[Ue][qe]))return!1;return!0}function At(Le,Oe,Ue,qe,Ct,Ot){let Jt;for(Jt in Oe=Oe||{},Le=Le||{})Le.hasOwnProperty(Jt)&&(Re.bh(Le[Jt],Oe[Jt])||Ue.push({command:Ot,args:[qe,Jt,Oe[Jt],Ct]}));for(Jt in Oe)Oe.hasOwnProperty(Jt)&&!Le.hasOwnProperty(Jt)&&(Re.bh(Le[Jt],Oe[Jt])||Ue.push({command:Ot,args:[qe,Jt,Oe[Jt],Ct]}))}function Lt(Re){return Re.id}function Pt(Re,Le){return Re[Le.id]=Le,Re}class Mt{constructor(Re,Le){this.reset(Re,Le)}reset(Re,Le){this.points=Re||[],this._distances=[0];for(let Re=1;Re<this.points.length;Re++)this._distances[Re]=this._distances[Re-1]+this.points[Re].dist(this.points[Re-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(Le||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(Le){if(1===this.points.length)return this.points[0];Le=Re.ap(Le,0,1);let Oe=1,Ue=this._distances[Oe];const qe=Le*this.paddedLength+this.padding;for(;Ue<qe&&Oe<this._distances.length;)Ue=this._distances[++Oe];const Ct=Oe-1,Ot=this._distances[Ct],Jt=Ue-Ot,Hr=Jt>0?(qe-Ot)/Jt:0;return this.points[Ct].mult(1-Hr).add(this.points[Oe].mult(Hr))}}class zt{constructor(Re,Le,Oe){const Ue=this.boxCells=[],qe=this.circleCells=[];this.xCellCount=Math.ceil(Re/Oe),this.yCellCount=Math.ceil(Le/Oe);for(let Re=0;Re<this.xCellCount*this.yCellCount;Re++)Ue.push([]),qe.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=Re,this.height=Le,this.xScale=this.xCellCount/Re,this.yScale=this.yCellCount/Le,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(Re,Le,Oe,Ue,qe){this._forEachCell(Le,Oe,Ue,qe,this._insertBoxCell,this.boxUid++),this.boxKeys.push(Re),this.bboxes.push(Le),this.bboxes.push(Oe),this.bboxes.push(Ue),this.bboxes.push(qe)}insertCircle(Re,Le,Oe,Ue){this._forEachCell(Le-Ue,Oe-Ue,Le+Ue,Oe+Ue,this._insertCircleCell,this.circleUid++),this.circleKeys.push(Re),this.circles.push(Le),this.circles.push(Oe),this.circles.push(Ue)}_insertBoxCell(Re,Le,Oe,Ue,qe,Ct){this.boxCells[qe].push(Ct)}_insertCircleCell(Re,Le,Oe,Ue,qe,Ct){this.circleCells[qe].push(Ct)}_query(Re,Le,Oe,Ue,qe,Ct){if(Oe<0||Re>this.width||Ue<0||Le>this.height)return!qe&&[];const Ot=[];if(Re<=0&&Le<=0&&this.width<=Oe&&this.height<=Ue){if(qe)return!0;for(let Re=0;Re<this.boxKeys.length;Re++)Ot.push({key:this.boxKeys[Re],x1:this.bboxes[4*Re],y1:this.bboxes[4*Re+1],x2:this.bboxes[4*Re+2],y2:this.bboxes[4*Re+3]});for(let Re=0;Re<this.circleKeys.length;Re++){const Le=this.circles[3*Re],Oe=this.circles[3*Re+1],Ue=this.circles[3*Re+2];Ot.push({key:this.circleKeys[Re],x1:Le-Ue,y1:Oe-Ue,x2:Le+Ue,y2:Oe+Ue})}return Ct?Ot.filter(Ct):Ot}return this._forEachCell(Re,Le,Oe,Ue,this._queryCell,Ot,{hitTest:qe,seenUids:{box:{},circle:{}}},Ct),qe?Ot.length>0:Ot}_queryCircle(Re,Le,Oe,Ue,qe){const Ct=Re-Oe,Ot=Re+Oe,Jt=Le-Oe,Hr=Le+Oe;if(Ot<0||Ct>this.width||Hr<0||Jt>this.height)return!Ue&&[];const Jr=[];return this._forEachCell(Ct,Jt,Ot,Hr,this._queryCellCircle,Jr,{hitTest:Ue,circle:{x:Re,y:Le,radius:Oe},seenUids:{box:{},circle:{}}},qe),Ue?Jr.length>0:Jr}query(Re,Le,Oe,Ue,qe){return this._query(Re,Le,Oe,Ue,!1,qe)}hitTest(Re,Le,Oe,Ue,qe){return this._query(Re,Le,Oe,Ue,!0,qe)}hitTestCircle(Re,Le,Oe,Ue){return this._queryCircle(Re,Le,Oe,!0,Ue)}_queryCell(Re,Le,Oe,Ue,qe,Ct,Ot,Jt){const Hr=Ot.seenUids,Jr=this.boxCells[qe];if(null!==Jr){const qe=this.bboxes;for(const Ln of Jr)if(!Hr.box[Ln]){Hr.box[Ln]=!0;const Jr=4*Ln;if(Re<=qe[Jr+2]&&Le<=qe[Jr+3]&&Oe>=qe[Jr+0]&&Ue>=qe[Jr+1]&&(!Jt||Jt(this.boxKeys[Ln]))){if(Ot.hitTest)return Ct.push(!0),!0;Ct.push({key:this.boxKeys[Ln],x1:qe[Jr],y1:qe[Jr+1],x2:qe[Jr+2],y2:qe[Jr+3]})}}}const Ln=this.circleCells[qe];if(null!==Ln){const qe=this.circles;for(const Jr of Ln)if(!Hr.circle[Jr]){Hr.circle[Jr]=!0;const Ln=3*Jr;if(this._circleAndRectCollide(qe[Ln],qe[Ln+1],qe[Ln+2],Re,Le,Oe,Ue)&&(!Jt||Jt(this.circleKeys[Jr]))){if(Ot.hitTest)return Ct.push(!0),!0;{const Re=qe[Ln],Le=qe[Ln+1],Oe=qe[Ln+2];Ct.push({key:this.circleKeys[Jr],x1:Re-Oe,y1:Le-Oe,x2:Re+Oe,y2:Le+Oe})}}}}}_queryCellCircle(Re,Le,Oe,Ue,qe,Ct,Ot,Jt){const Hr=Ot.circle,Jr=Ot.seenUids,Ln=this.boxCells[qe];if(null!==Ln){const Re=this.bboxes;for(const Le of Ln)if(!Jr.box[Le]){Jr.box[Le]=!0;const Oe=4*Le;if(this._circleAndRectCollide(Hr.x,Hr.y,Hr.radius,Re[Oe+0],Re[Oe+1],Re[Oe+2],Re[Oe+3])&&(!Jt||Jt(this.boxKeys[Le])))return Ct.push(!0),!0}}const Nn=this.circleCells[qe];if(null!==Nn){const Re=this.circles;for(const Le of Nn)if(!Jr.circle[Le]){Jr.circle[Le]=!0;const Oe=3*Le;if(this._circlesCollide(Re[Oe],Re[Oe+1],Re[Oe+2],Hr.x,Hr.y,Hr.radius)&&(!Jt||Jt(this.circleKeys[Le])))return Ct.push(!0),!0}}}_forEachCell(Re,Le,Oe,Ue,qe,Ct,Ot,Jt){const Hr=this._convertToXCellCoord(Re),Jr=this._convertToYCellCoord(Le),Ln=this._convertToXCellCoord(Oe),Nn=this._convertToYCellCoord(Ue);for(let $n=Hr;$n<=Ln;$n++)for(let Hr=Jr;Hr<=Nn;Hr++)if(qe.call(this,Re,Le,Oe,Ue,this.xCellCount*Hr+$n,Ct,Ot,Jt))return}_convertToXCellCoord(Re){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(Re*this.xScale)))}_convertToYCellCoord(Re){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(Re*this.yScale)))}_circlesCollide(Re,Le,Oe,Ue,qe,Ct){const Ot=Ue-Re,Jt=qe-Le,Hr=Oe+Ct;return Hr*Hr>Ot*Ot+Jt*Jt}_circleAndRectCollide(Re,Le,Oe,Ue,qe,Ct,Ot){const Jt=(Ct-Ue)/2,Hr=Math.abs(Re-(Ue+Jt));if(Hr>Jt+Oe)return!1;const Jr=(Ot-qe)/2,Ln=Math.abs(Le-(qe+Jr));if(Ln>Jr+Oe)return!1;if(Hr<=Jt||Ln<=Jr)return!0;const Nn=Hr-Jt,$n=Ln-Jr;return Nn*Nn+$n*$n<=Oe*Oe}}const Ql={unknown:0,flipRequired:1,flipNotRequired:2},oc=Math.tan(85*Math.PI/180);function kt(Le,Oe,Ue,qe,Ct,Ot,Jt){const Hr=Re.a6.mat4.create();if(Ue)if("globe"===Ot.name){const Le=Re.bi(Ct,Oe);Re.a6.mat4.multiply(Hr,Hr,Le)}else{const Le=Re.a6.mat2.invert([],Jt);Hr[0]=Le[0],Hr[1]=Le[1],Hr[4]=Le[2],Hr[5]=Le[3],qe||Re.a6.mat4.rotateZ(Hr,Hr,Ct.angle)}else Re.a6.mat4.multiply(Hr,Ct.labelPlaneMatrix,Le);return Hr}function Bt(Re,Le,Oe,Ue,qe,Ct,Ot){const Jt=kt(Re,Le,Oe,Ue,qe,Ct,Ot);return"globe"===Ct.name&&Oe||(Jt[2]=Jt[6]=Jt[10]=Jt[14]=0),Jt}function Nt(Le,Oe,Ue,qe,Ct,Ot,Jt){if(Ue){if("globe"===Ot.name){const Hr=kt(Le,Oe,Ue,qe,Ct,Ot,Jt);return Re.a6.mat4.invert(Hr,Hr),Re.a6.mat4.multiply(Hr,Le,Hr),Hr}{const Oe=Re.a6.mat4.clone(Le),Ue=Re.a6.mat4.identity([]);return Ue[0]=Jt[0],Ue[1]=Jt[1],Ue[4]=Jt[2],Ue[5]=Jt[3],Re.a6.mat4.multiply(Oe,Oe,Ue),qe||Re.a6.mat4.rotateZ(Oe,Oe,-Ct.angle),Oe}}return Ct.glCoordMatrix}function Ut(Le,Oe,Ue,qe){const Ct=[Le,Oe,Ue,1];Ue?Re.a6.vec4.transformMat4(Ct,Ct,qe):Kt(Ct,Ct,qe);const Ot=Ct[3];return Ct[0]/=Ot,Ct[1]/=Ot,Ct[2]/=Ot,Ct}function Gt(Re,Le){return Math.min(.5+Re/Le*.5,1.5)}function jt(Re,Le){const Oe=Re[0]/Re[3],Ue=Re[1]/Re[3];return Oe>=-Le[0]&&Oe<=Le[0]&&Ue>=-Le[1]&&Ue<=Le[1]}function Vt(Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr,Ln){const Nn=Ue.transform,$n=qe?Le.textSizeData:Le.iconSizeData,Gn=Re.bj($n,Ue.transform.zoom),qn="globe"===Nn.projection.name,Zn=[256/Ue.width*2+1,256/Ue.height*2+1],Xn=qe?Le.text.dynamicLayoutVertexArray:Le.icon.dynamicLayoutVertexArray;Xn.clear();let Yn=null;qn&&(Yn=qe?Le.text.globeExtVertexArray:Le.icon.globeExtVertexArray);const _i=Le.lineVertexArray,vi=qe?Le.text.placedSymbolArray:Le.icon.placedSymbolArray,xi=Ue.transform.width/Ue.transform.height;let bi,Pi=!1;for(let qe=0;qe<vi.length;qe++){const qn=vi.get(qe),{numGlyphs:lo,writingMode:uo}=qn;if(uo!==Re.bk.vertical||Pi||bi===Re.bk.horizontal||(Pi=!0),bi=uo,(qn.hidden||uo===Re.bk.vertical)&&!Pi){Yt(lo,Xn);continue}Pi=!1;const po=new Re.P(qn.tileAnchorX,qn.tileAnchorY);let{x:fo,y:Io,z:is}=Nn.projection.projectTilePoint(po.x,po.y,Ln.canonical);if(Jr){const[Re,Le,Oe]=Jr(po);fo+=Re,Io+=Le,is+=Oe}const as=[fo,Io,is,1];if(Re.a6.vec4.transformMat4(as,as,Oe),!jt(as,Zn)){Yt(lo,Xn);continue}const Is=as[3],Xs=Gt(Ue.transform.getCameraToCenterDistance(Nn.projection),Is),ta=Re.bl($n,Gn,qn),ha=Jt?ta/Xs:ta*Xs,el=Ut(fo,Io,is,Ct);if(el[3]<=0){Yt(lo,Xn);continue}let tl={};const il=Jt?null:Jr,sl=Ht(qn,ha,!1,Hr,Oe,Ct,Ot,Le.glyphOffsetArray,_i,Xn,Yn,el,po,tl,xi,il,Nn.projection,Ln,Jt);Pi=sl.useVertical,il&&sl.needsFlipping&&(tl={}),(sl.notEnoughRoom||Pi||sl.needsFlipping&&Ht(qn,ha,!0,Hr,Oe,Ct,Ot,Le.glyphOffsetArray,_i,Xn,Yn,el,po,tl,xi,il,Nn.projection,Ln,Jt).notEnoughRoom)&&Yt(lo,Xn)}qe?(Le.text.dynamicLayoutVertexBuffer.updateData(Xn),Yn&&Le.text.globeExtVertexBuffer&&Le.text.globeExtVertexBuffer.updateData(Yn)):(Le.icon.dynamicLayoutVertexBuffer.updateData(Xn),Yn&&Le.icon.globeExtVertexBuffer&&Le.icon.globeExtVertexBuffer.updateData(Yn))}function qt(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr,Ln,Nn,$n,Gn,qn,Zn){const{lineStartIndex:Xn,glyphStartIndex:Yn,segment:_i}=Jt,vi=Yn+Jt.numGlyphs,xi=Xn+Jt.lineLength,bi=Le.getoffsetX(Yn),Pi=Le.getoffsetX(vi-1),lo=Xt(Re*bi,Oe,Ue,qe,Ct,Ot,_i,Xn,xi,Hr,Jr,Ln,Nn,$n,!0,Gn,qn,Zn);if(!lo)return null;const uo=Xt(Re*Pi,Oe,Ue,qe,Ct,Ot,_i,Xn,xi,Hr,Jr,Ln,Nn,$n,!0,Gn,qn,Zn);return uo?{first:lo,last:uo}:null}function Zt(Le,Oe,Ue,qe){return Le===Re.bk.horizontal&&Math.abs(qe)>Math.abs(Ue)?{useVertical:!0}:Le===Re.bk.vertical?qe>0?{needsFlipping:!0}:null:Oe!==Ql.unknown&&function(Re,Le){return 0===Re||Math.abs(Le/Re)>oc}(Ue,qe)?Oe===Ql.flipRequired?{needsFlipping:!0}:null:Ue<0?{needsFlipping:!0}:null}function Ht(Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr,Ln,Nn,$n,Gn,qn,Zn,Xn,Yn,_i,vi){const xi=Oe/24,bi=Le.lineOffsetX*xi,Pi=Le.lineOffsetY*xi,{lineStartIndex:lo,glyphStartIndex:uo,numGlyphs:po,segment:fo,writingMode:Io,flipState:is}=Le,as=lo+Le.lineLength,A=Le=>{if(Nn){const[Oe,Ue,qe]=Le.up,Ct=Ln.length;Re.bm(Nn,Ct+0,Oe,Ue,qe),Re.bm(Nn,Ct+1,Oe,Ue,qe),Re.bm(Nn,Ct+2,Oe,Ue,qe),Re.bm(Nn,Ct+3,Oe,Ue,qe)}const[Oe,Ue,qe]=Le.point;Re.bn(Ln,Oe,Ue,qe,Le.angle)};if(po>1){const Re=qt(xi,Hr,bi,Pi,Ue,$n,Gn,Le,Jr,Ot,qn,Xn,!1,Yn,_i,vi);if(!Re)return{notEnoughRoom:!0};if(qe&&!Ue){let[Oe,Ue,qe]=Re.first.point,[Ct,Ot,Hr]=Re.last.point;[Oe,Ue]=Ut(Oe,Ue,qe,Jt),[Ct,Ot]=Ut(Ct,Ot,Hr,Jt);const Jr=Zt(Io,is,(Ct-Oe)*Zn,Ot-Ue);if(Le.flipState=Jr&&Jr.needsFlipping?Ql.flipRequired:Ql.flipNotRequired,Jr)return Jr}A(Re.first);for(let Re=uo+1;Re<uo+po-1;Re++){const Le=Xt(xi*Hr.getoffsetX(Re),bi,Pi,Ue,$n,Gn,fo,lo,as,Jr,Ot,qn,Xn,!1,!1,Yn,_i,vi);if(!Le)return Ln.length-=4*(Re-uo),{notEnoughRoom:!0};A(Le)}A(Re.last)}else{if(qe&&!Ue){const Oe=Ut(Gn.x,Gn.y,0,Ct),Ue=lo+fo+1,qe=new Re.P(Jr.getx(Ue),Jr.gety(Ue)),Ot=Ut(qe.x,qe.y,0,Ct),Jt=Ot[3]>0?Ot:$t(Gn,qe,Oe,1,Ct,void 0,Yn,_i.canonical),Hr=Zt(Io,is,(Jt[0]-Oe[0])*Zn,Jt[1]-Oe[1]);if(Le.flipState=Hr&&Hr.needsFlipping?Ql.flipRequired:Ql.flipNotRequired,Hr)return Hr}const Oe=Xt(xi*Hr.getoffsetX(uo),bi,Pi,Ue,$n,Gn,fo,lo,as,Jr,Ot,qn,Xn,!1,!1,Yn,_i,vi);if(!Oe)return{notEnoughRoom:!0};A(Oe)}return{}}function Wt(Re,Le,Oe,Ue,qe){const{x:Ct,y:Ot,z:Jt}=Ue.projectTilePoint(Re.x,Re.y,Le);if(!qe)return Ut(Ct,Ot,Jt,Oe);const[Hr,Jr,Ln]=qe(Re);return Ut(Ct+Hr,Ot+Jr,Jt+Ln,Oe)}function $t(Le,Oe,Ue,qe,Ct,Ot,Jt,Hr){const Jr=Wt(Le.sub(Oe)._unit()._add(Le),Hr,Ct,Jt,Ot);return Re.a6.vec3.sub(Jr,Ue,Jr),Re.a6.vec3.normalize(Jr,Jr),Re.a6.vec3.scaleAndAdd(Jr,Ue,Jr,qe)}function Xt(Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr,Ln,Nn,$n,Gn,qn,Zn,Xn,Yn,_i){const vi=qe?Le-Oe:Le+Oe;let xi=vi>0?1:-1,bi=0;qe&&(xi*=-1,bi=Math.PI),xi<0&&(bi+=Math.PI);let Pi=Hr+Jt+(xi>0?0:1)|0,lo=Ct,uo=Ct,po=0,fo=0;const Io=Math.abs(vi),is=[],as=[];let Is=Ot,Xs=Is;const P=()=>$t(Xs,Is,uo,Io-po+1,Nn,Gn,Xn,Yn.canonical);for(;po+fo<=Io;){if(Pi+=xi,Pi<Hr||Pi>=Jr)return null;if(uo=lo,Xs=Is,is.push(uo),qn&&as.push(Xs),Is=new Re.P(Ln.getx(Pi),Ln.gety(Pi)),lo=$n[Pi],!lo){const Re=Wt(Is,Yn.canonical,Nn,Xn,Gn);lo=Re[3]>0?$n[Pi]=Re:P()}po+=fo,fo=Re.a6.vec3.distance(uo,lo)}Zn&&Gn&&($n[Pi]&&(lo=P(),fo=Re.a6.vec3.distance(uo,lo)),$n[Pi]=lo);const ta=(Io-po)/fo,ha=Is.sub(Xs)._mult(ta)._add(Xs),el=Re.a6.vec3.sub([],lo,uo),tl=Re.a6.vec3.scaleAndAdd([],uo,el,ta);let il=[0,0,1],sl=el[0],fl=el[1];if(_i&&(il=Xn.upVector(Yn.canonical,ha.x,ha.y),0!==il[0]||0!==il[1]||1!==il[2])){const Le=[il[2],0,-il[0]],Oe=Re.a6.vec3.cross([],il,Le);Re.a6.vec3.normalize(Le,Le),Re.a6.vec3.normalize(Oe,Oe),sl=Re.a6.vec3.dot(el,Le),fl=Re.a6.vec3.dot(el,Oe)}if(Ue){const Le=Re.a6.vec3.cross([],il,el);Re.a6.vec3.normalize(Le,Le),Re.a6.vec3.scaleAndAdd(tl,tl,Le,Ue*xi)}const Al=bi+Math.atan2(fl,sl);return is.push(tl),qn&&as.push(ha),{point:tl,angle:Al,path:is,tilePath:as,up:il}}function Yt(Re,Le){const Oe=Le.length,Ue=Oe+4*Re;Le.resize(Ue),Le.float32.fill(-1/0,4*Oe,4*Ue)}function Kt(Re,Le,Oe){const Ue=Le[0],qe=Le[1];return Re[0]=Oe[0]*Ue+Oe[4]*qe+Oe[12],Re[1]=Oe[1]*Ue+Oe[5]*qe+Oe[13],Re[3]=Oe[3]*Ue+Oe[7]*qe+Oe[15],Re}const lc=100;class Qt{constructor(Re,Le,Oe=new zt(Re.width+200,Re.height+200,25),Ue=new zt(Re.width+200,Re.height+200,25)){this.transform=Re,this.grid=Oe,this.ignoredGrid=Ue,this.pitchfactor=Math.cos(Re._pitch)*Re.cameraToCenterDistance,this.screenRightBoundary=Re.width+lc,this.screenBottomBoundary=Re.height+lc,this.gridRightBoundary=Re.width+200,this.gridBottomBoundary=Re.height+200,this.fogState=Le}placeCollisionBox(Re,Le,Oe,Ue,qe,Ct,Ot,Jt){let Hr=Oe.projectedAnchorX,Jr=Oe.projectedAnchorY,Ln=Oe.projectedAnchorZ;const Nn=Oe.elevation,$n=Oe.tileID,Gn=Re.getProjection();if(Nn&&$n){const[Re,Le,Ue]=Gn.upVector($n.canonical,Oe.tileAnchorX,Oe.tileAnchorY),qe=Gn.upVectorScale($n.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;Hr+=Re*Nn*qe,Jr+=Le*Nn*qe,Ln+=Ue*Nn*qe}const qn=this.projectAndGetPerspectiveRatio(Ot,Hr,Jr,Ln,Oe.tileID,"globe"===Gn.name||!!Nn||this.transform.pitch>0,Gn),Zn=Ct*qn.perspectiveRatio,Xn=(Oe.x1*Le+Ue.x-Oe.padding)*Zn+qn.point.x,Yn=(Oe.y1*Le+Ue.y-Oe.padding)*Zn+qn.point.y,_i=(Oe.x2*Le+Ue.x+Oe.padding)*Zn+qn.point.x,vi=(Oe.y2*Le+Ue.y+Oe.padding)*Zn+qn.point.y,xi=qn.perspectiveRatio<=.55||qn.occluded;return!this.isInsideGrid(Xn,Yn,_i,vi)||!qe&&this.grid.hitTest(Xn,Yn,_i,vi,Jt)||xi?{box:[],offscreen:!1,occluded:qn.occluded}:{box:[Xn,Yn,_i,vi],offscreen:this.isOffscreen(Xn,Yn,_i,vi),occluded:!1}}placeCollisionCircles(Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr,Ln,Nn,$n,Gn,qn,Zn){const Xn=[],Yn=this.transform.elevation,_i=Le.getProjection(),vi=Yn?Yn.getAtTileOffsetFunc(Zn,this.transform.center.lat,this.transform.worldSize,_i):null,xi=new Re.P(Ue.tileAnchorX,Ue.tileAnchorY);let{x:bi,y:Pi,z:lo}=_i.projectTilePoint(xi.x,xi.y,Zn.canonical);if(vi){const[Re,Le,Oe]=vi(xi);bi+=Re,Pi+=Le,lo+=Oe}const uo="globe"===_i.name,po=this.projectAndGetPerspectiveRatio(Jt,bi,Pi,lo,Zn,uo||!!Yn||this.transform.pitch>0,_i),{perspectiveRatio:fo}=po,Io=(Nn?Ot/fo:Ot*fo)/Re.bq,is=Ut(bi,Pi,lo,Hr),as=po.signedDistanceFromCamera>0?qt(Io,Ct,Ue.lineOffsetX*Io,Ue.lineOffsetY*Io,!1,is,xi,Ue,qe,Hr,{},Yn&&!Nn?vi:null,Nn&&!!Yn,_i,Zn,Nn):null;let Is=!1,Xs=!1,ta=!0;if(as&&!po.occluded){const Le=.5*Gn*fo+qn,Ue=new Re.P(-100,-100),qe=new Re.P(this.screenRightBoundary,this.screenBottomBoundary),Ct=new Mt,{first:Ot,last:Jt}=as,Hr=Ot.path.length;let Nn=[];for(let Re=Hr-1;Re>=1;Re--)Nn.push(Ot.path[Re]);for(let Re=1;Re<Jt.path.length;Re++)Nn.push(Jt.path[Re]);const Zn=2.5*Le;Jr&&(Nn=Nn.map((([Re,Le,Oe],Ue)=>(vi&&!uo&&(Oe=vi(Ue<Hr-1?Ot.tilePath[Hr-1-Ue]:Jt.tilePath[Ue-Hr+2])[2]),Ut(Re,Le,Oe,Jr)))),Nn.some((Re=>Re[3]<=0))&&(Nn=[]));let Yn=[];if(Nn.length>0){let Le=1/0,Oe=-1/0,Ct=1/0,Ot=-1/0;for(const Re of Nn)Le=Math.min(Le,Re[0]),Ct=Math.min(Ct,Re[1]),Oe=Math.max(Oe,Re[0]),Ot=Math.max(Ot,Re[1]);Oe>=Ue.x&&Le<=qe.x&&Ot>=Ue.y&&Ct<=qe.y&&(Yn=[Nn.map((Le=>new Re.P(Le[0],Le[1])))],(Le<Ue.x||Oe>qe.x||Ct<Ue.y||Ot>qe.y)&&(Yn=Re.bo(Yn,Ue.x,Ue.y,qe.x,qe.y)))}for(const Re of Yn){Ct.reset(Re,.25*Le);let Ue=0;Ue=Ct.length<=.5*Le?1:Math.ceil(Ct.paddedLength/Zn)+1;for(let Re=0;Re<Ue;Re++){const qe=Re/Math.max(Ue-1,1),Ot=Ct.lerp(qe),Jt=Ot.x+lc,Hr=Ot.y+lc;Xn.push(Jt,Hr,Le,0);const Jr=Jt-Le,Nn=Hr-Le,Gn=Jt+Le,qn=Hr+Le;if(ta=ta&&this.isOffscreen(Jr,Nn,Gn,qn),Xs=Xs||this.isInsideGrid(Jr,Nn,Gn,qn),!Oe&&this.grid.hitTestCircle(Jt,Hr,Le,$n)&&(Is=!0,!Ln))return{circles:[],offscreen:!1,collisionDetected:Is,occluded:!1}}}}return{circles:!Ln&&Is||!Xs?[]:Xn,offscreen:ta,collisionDetected:Is,occluded:po.occluded}}queryRenderedSymbols(Le){if(0===Le.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const Oe=[];let Ue=1/0,qe=1/0,Ct=-1/0,Ot=-1/0;for(const Jt of Le){const Le=new Re.P(Jt.x+lc,Jt.y+lc);Ue=Math.min(Ue,Le.x),qe=Math.min(qe,Le.y),Ct=Math.max(Ct,Le.x),Ot=Math.max(Ot,Le.y),Oe.push(Le)}const Jt=this.grid.query(Ue,qe,Ct,Ot).concat(this.ignoredGrid.query(Ue,qe,Ct,Ot)),Hr={},Jr={};for(const Le of Jt){const Ue=Le.key;if(void 0===Hr[Ue.bucketInstanceId]&&(Hr[Ue.bucketInstanceId]={}),Hr[Ue.bucketInstanceId][Ue.featureIndex])continue;const qe=[new Re.P(Le.x1,Le.y1),new Re.P(Le.x2,Le.y1),new Re.P(Le.x2,Le.y2),new Re.P(Le.x1,Le.y2)];Re.bp(Oe,qe)&&(Hr[Ue.bucketInstanceId][Ue.featureIndex]=!0,void 0===Jr[Ue.bucketInstanceId]&&(Jr[Ue.bucketInstanceId]=[]),Jr[Ue.bucketInstanceId].push(Ue.featureIndex))}return Jr}insertCollisionBox(Re,Le,Oe,Ue,qe){(Le?this.ignoredGrid:this.grid).insert({bucketInstanceId:Oe,featureIndex:Ue,collisionGroupID:qe},Re[0],Re[1],Re[2],Re[3])}insertCollisionCircles(Re,Le,Oe,Ue,qe){const Ct=Le?this.ignoredGrid:this.grid,Ot={bucketInstanceId:Oe,featureIndex:Ue,collisionGroupID:qe};for(let Le=0;Le<Re.length;Le+=4)Ct.insertCircle(Ot,Re[Le],Re[Le+1],Re[Le+2])}projectAndGetPerspectiveRatio(Le,Oe,Ue,qe,Ct,Ot,Jt){const Hr=[Oe,Ue,qe,1];let Jr=!1;if(qe||this.transform.pitch>0){if(Re.a6.vec4.transformMat4(Hr,Hr,Le),this.fogState&&Ct&&"globe"!==Jt.name){const Le=function(Le,Oe,Ue,qe,Ct,Ot){const Jt=Ot.calculateFogTileMatrix(Ct),Hr=[Oe,Ue,qe];return Re.a6.vec3.transformMat4(Hr,Hr,Jt),Fe(Le,Re.a6.vec3.length(Hr),Ot.pitch,Ot._fov)}(this.fogState,Oe,Ue,qe,Ct.toUnwrapped(),this.transform);Jr=Le>.9}}else Kt(Hr,Hr,Le);const Ln=Hr[3];return{point:new Re.P((Hr[0]/Ln+1)/2*this.transform.width+lc,(-Hr[1]/Ln+1)/2*this.transform.height+lc),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(Jt)/Ln*.5,1.5),signedDistanceFromCamera:Ln,occluded:Ot&&Hr[2]>Ln||Jr}}isOffscreen(Re,Le,Oe,Ue){return Oe<lc||Re>=this.screenRightBoundary||Ue<lc||Le>this.screenBottomBoundary}isInsideGrid(Re,Le,Oe,Ue){return Oe>=0&&Re<this.gridRightBoundary&&Ue>=0&&Le<this.gridBottomBoundary}getViewportMatrix(){const Le=Re.a6.mat4.identity([]);return Re.a6.mat4.translate(Le,Le,[-100,-100,0]),Le}}function ei(Le,Oe,Ue){const qe=Oe.createTileMatrix(Le,Le.worldSize,Ue.toUnwrapped());return Re.a6.mat4.multiply(new Float32Array(16),Le.projMatrix,qe)}function ti(Re,Le,Oe){if(Le.projection.name===Oe.projection.name)return Re.projMatrix;const Ue=Oe.clone();return Ue.setProjection(Le.projection),ei(Ue,Le.getProjection(),Re)}function ii(Re,Le,Oe){return Le.name===Oe.projection.name?Re.projMatrix:ei(Oe,Le,Re)}class oi{constructor(Re,Le,Oe,Ue){this.opacity=Re?Math.max(0,Math.min(1,Re.opacity+(Re.placed?Le:-Le))):Ue&&Oe?1:0,this.placed=Oe}isHidden(){return 0===this.opacity&&!this.placed}}class ri{constructor(Re,Le,Oe,Ue,qe,Ct=!1){this.text=new oi(Re?Re.text:null,Le,Oe,qe),this.icon=new oi(Re?Re.icon:null,Le,Ue,qe),this.clipped=Ct}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class si{constructor(Re,Le,Oe,Ue=!1){this.text=Re,this.icon=Le,this.skipFade=Oe,this.clipped=Ue}}class ai{constructor(){this.invProjMatrix=Re.a6.mat4.create(),this.viewportMatrix=Re.a6.mat4.create(),this.circles=[]}}class ni{constructor(Re,Le,Oe,Ue,qe){this.bucketInstanceId=Re,this.featureIndex=Le,this.sourceLayerIndex=Oe,this.bucketIndex=Ue,this.tileID=qe}}class li{constructor(Re){this.crossSourceCollisions=Re,this.maxGroupID=0,this.collisionGroups={}}get(Re){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[Re]){const Le=++this.maxGroupID;this.collisionGroups[Re]={ID:Le,predicate:Re=>Re.collisionGroupID===Le}}return this.collisionGroups[Re]}}function ci(Le,Oe,Ue,qe,Ct){const{horizontalAlign:Ot,verticalAlign:Jt}=Re.bx(Le),Hr=-(Ot-.5)*Oe,Jr=-(Jt-.5)*Ue,Ln=Re.bw(Le,qe);return new Re.P(Hr+Ln[0]*Ct,Jr+Ln[1]*Ct)}function hi(Le,Oe,Ue,qe,Ct){const Ot=new Re.P(Le,Oe);return Ue&&Ot._rotate(qe?Ct:-Ct),Ot}class ui{constructor(Re,Le,Oe,Ue,qe,Ct){this.transform=Re.clone(),this.projection=Re.projection.name,this.collisionIndex=new Qt(this.transform,qe),this.buildingIndex=Ct,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=Le,this.retainedQueryData={},this.collisionGroups=new li(Oe),this.collisionCircleArrays={},this.prevPlacement=Ue,Ue&&(Ue.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(Le,Oe,Ue,qe){const Ct=Ue.getBucket(Oe),Ot=Ue.latestFeatureIndex;if(!Ct||!Ot||Oe.fqid!==Ct.layerIds[0])return;const Jt=Ct.layers[0].layout,Hr=Ct.layers[0].paint,Jr=Ue.collisionBoxArray,Ln=Math.pow(2,this.transform.zoom-Ue.tileID.overscaledZ),Nn=Ue.tileSize/Re.ab,$n=Ue.tileID.toUnwrapped();this.transform.setProjection(Ct.projection);const Gn=(qn=Ue.tileID,Zn=Ct.getProjection(),Xn=this.transform,Zn.name===this.projection?Xn.calculateProjMatrix(qn.toUnwrapped()):ei(Xn,Zn,qn));var qn,Zn,Xn;const Yn="map"===Jt.get("text-pitch-alignment"),_i="map"===Jt.get("text-rotation-alignment");Oe.compileFilter();const vi=Oe.dynamicFilter(),xi=Oe.dynamicFilterNeedsFeature(),bi=this.transform.calculatePixelsToTileUnitsMatrix(Ue),Pi=Bt(Gn,Ue.tileID.canonical,Yn,_i,this.transform,Ct.getProjection(),bi);let lo=null;if(Yn){const Le=Nt(Gn,Ue.tileID.canonical,Yn,_i,this.transform,Ct.getProjection(),bi);lo=Re.a6.mat4.multiply([],this.transform.labelPlaneMatrix,Le)}let uo=null;vi&&Ue.latestFeatureIndex&&(uo={unwrappedTileID:$n,dynamicFilter:vi,dynamicFilterNeedsFeature:xi}),this.retainedQueryData[Ct.bucketInstanceId]=new ni(Ct.bucketInstanceId,Ot,Ct.sourceLayerIndex,Ct.index,Ue.tileID);const po={bucket:Ct,layout:Jt,paint:Hr,posMatrix:Gn,textLabelPlaneMatrix:Pi,labelToScreenMatrix:lo,clippingData:uo,scale:Ln,textPixelRatio:Nn,holdingForFade:Ue.holdingForFade(),collisionBoxArray:Jr,partiallyEvaluatedTextSize:Re.bj(Ct.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:Re.bj(Ct.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(Ct.sourceID),latestFeatureIndex:Ue.latestFeatureIndex};if(qe)for(const Re of Ct.sortKeyRanges){const{sortKey:Oe,symbolInstanceStart:Ue,symbolInstanceEnd:qe}=Re;Le.push({sortKey:Oe,symbolInstanceStart:Ue,symbolInstanceEnd:qe,parameters:po})}else Le.push({symbolInstanceStart:0,symbolInstanceEnd:Ct.symbolInstances.length,parameters:po})}attemptAnchorPlacement(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr,Ln,Nn,$n,Gn,qn,Zn,Xn,Yn){const{textOffset0:_i,textOffset1:vi,crossTileID:xi}=Nn,bi=[_i,vi],Pi=ci(Re,Oe,Ue,bi,qe),lo=this.collisionIndex.placeCollisionBox(Gn,qe,Le,hi(Pi.x,Pi.y,Ct,Ot,this.transform.angle),Ln,Jt,Hr,Jr.predicate);if(Zn){const Re=Gn.getSymbolInstanceIconSize(Yn,this.transform.zoom,Nn.placedIconSymbolIndex);if(0===this.collisionIndex.placeCollisionBox(Gn,Re,Zn,hi(Pi.x,Pi.y,Ct,Ot,this.transform.angle),Ln,Jt,Hr,Jr.predicate).box.length)return}if(lo.box.length>0){let Le;return this.prevPlacement&&this.prevPlacement.variableOffsets[xi]&&this.prevPlacement.placements[xi]&&this.prevPlacement.placements[xi].text&&(Le=this.prevPlacement.variableOffsets[xi].anchor),this.variableOffsets[xi]={textOffset:bi,width:Oe,height:Ue,anchor:Re,textScale:qe,prevAnchor:Le},this.markUsedJustification(Gn,Re,Nn,qn),Gn.allowVerticalPlacement&&(this.markUsedOrientation(Gn,qn,Nn),this.placedOrientations[xi]=qn),{shift:Pi,placedGlyphBoxes:lo}}}placeLayerBucketPart(Le,Oe,Ue,qe){const{bucket:Ct,layout:Ot,paint:Jt,posMatrix:Hr,textLabelPlaneMatrix:Jr,labelToScreenMatrix:Ln,clippingData:Nn,textPixelRatio:$n,holdingForFade:Gn,collisionBoxArray:qn,partiallyEvaluatedTextSize:Zn,partiallyEvaluatedIconSize:Xn,collisionGroup:Yn,latestFeatureIndex:_i}=Le.parameters,vi=Ot.get("text-optional"),xi=Ot.get("icon-optional"),bi=Ot.get("text-allow-overlap"),Pi=Ot.get("icon-allow-overlap"),lo="map"===Ot.get("text-rotation-alignment"),uo="map"===Ot.get("text-pitch-alignment"),po=Ot.get("symbol-z-elevate"),fo=Jt.get("symbol-z-offset"),Io="sea"===Jt.get("symbol-elevation-reference");this.transform.setProjection(Ct.projection);let is=bi&&(Pi||!Ct.hasIconData()||xi),as=Pi&&(bi||!Ct.hasTextData()||vi);const Is=!fo.isConstant();!Ct.collisionArrays&&qn&&Ct.deserializeCollisionBoxes(qn),Ue&&qe&&Ct.updateCollisionDebugBuffers(this.transform.zoom,qn);const L=(Le,qe,Jt)=>{const{crossTileID:qn,numVerticalGlyphVertices:po}=Le;let Xs=null;if(Nn&&Nn.dynamicFilterNeedsFeature||Is){const Re=this.retainedQueryData[Ct.bucketInstanceId];Xs=_i.loadFeature({featureIndex:Le.featureIndex,bucketIndex:Re.bucketIndex,sourceLayerIndex:Re.sourceLayerIndex,layoutVertexArrayOffset:0})}if(Nn&&!(0,Nn.dynamicFilter)({zoom:this.transform.zoom,pitch:this.transform.pitch},Xs,this.retainedQueryData[Ct.bucketInstanceId].tileID.canonical,new Re.P(Le.tileAnchorX,Le.tileAnchorY),this.transform.calculateDistanceTileData(Nn.unwrappedTileID)))return this.placements[qn]=new si(!1,!1,!1,!0),void Oe.add(qn);const ta=fo.evaluate(Xs,{});if(Oe.has(qn))return;if(Gn)return void(this.placements[qn]=new si(!1,!1,!1));let ha=!1,el=!1,tl=!0,il=!1,sl=!1,fl=null,Al={box:null,offscreen:null,occluded:null},Ml={box:null,offscreen:null,occluded:null},Hl=null,Wl=null,Kl=null,Jl=0,Ql=0,oc=0;Jt.textFeatureIndex?Jl=Jt.textFeatureIndex:Le.useRuntimeCollisionCircles&&(Jl=Le.featureIndex),Jt.verticalTextFeatureIndex&&(Ql=Jt.verticalTextFeatureIndex);const W=Re=>{Re.tileID=this.retainedQueryData[Ct.bucketInstanceId].tileID;const Oe=this.transform.elevation;Re.elevation=Io?ta:ta+(Oe?Oe.getAtTileOffset(Re.tileID,Re.tileAnchorX,Re.tileAnchorY):0),Re.elevation+=Le.zOffset},lc=Jt.textBox;if(lc){W(lc);const i=Oe=>{let Ue=Re.bk.horizontal;if(Ct.allowVerticalPlacement&&!Oe&&this.prevPlacement){const Re=this.prevPlacement.placedOrientations[qn];Re&&(this.placedOrientations[qn]=Re,Ue=Re,this.markUsedOrientation(Ct,Ue,Le))}return Ue},o=(Le,Oe)=>{if(Ct.allowVerticalPlacement&&po>0&&Jt.verticalTextBox){for(const Ue of Ct.writingModes)if(Ue===Re.bk.vertical?(Al=Oe(),Ml=Al):Al=Le(),Al&&Al.box&&Al.box.length)break}else Al=Le()};if(Ot.get("text-variable-anchor")){let Oe=Ot.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[qn]){const Re=this.prevPlacement.variableOffsets[qn];Oe.indexOf(Re.anchor)>0&&(Oe=Oe.filter((Le=>Le!==Re.anchor)),Oe.unshift(Re.anchor))}const h=(Re,Ue,Ot)=>{const Jt=Ct.getSymbolInstanceTextSize(Zn,Le,this.transform.zoom,qe),Jr=(Re.x2-Re.x1)*Jt+2*Re.padding,Ln=(Re.y2-Re.y1)*Jt+2*Re.padding,Nn=Le.hasIconTextFit&&!Pi?Ue:null;Nn&&W(Nn);let Gn={box:[],offscreen:!1,occluded:!1};const qn=bi?2*Oe.length:Oe.length;for(let Ue=0;Ue<qn;++Ue){const qn=this.attemptAnchorPlacement(Oe[Ue%Oe.length],Re,Jr,Ln,Jt,lo,uo,$n,Hr,Yn,Ue>=Oe.length,Le,qe,Ct,Ot,Nn,Zn,Xn);if(qn&&(Gn=qn.placedGlyphBoxes,Gn&&Gn.box&&Gn.box.length)){ha=!0,fl=qn.shift;break}}return Gn};o((()=>h(lc,Jt.iconBox,Re.bk.horizontal)),(()=>{const Le=Jt.verticalTextBox;return Le&&W(Le),Ct.allowVerticalPlacement&&!(Al&&Al.box&&Al.box.length)&&po>0&&Le?h(Le,Jt.verticalIconBox,Re.bk.vertical):{box:null,offscreen:null,occluded:null}})),Al&&(ha=Al.box,tl=Al.offscreen,il=Al.occluded);const Ue=i(!(!Al||!Al.box));if(!ha&&this.prevPlacement){const Re=this.prevPlacement.variableOffsets[qn];Re&&(this.variableOffsets[qn]=Re,this.markUsedJustification(Ct,Re.anchor,Le,Ue))}}else{const a=(Oe,Ue)=>{const Ot=Ct.getSymbolInstanceTextSize(Zn,Le,this.transform.zoom,qe),Jt=this.collisionIndex.placeCollisionBox(Ct,Ot,Oe,new Re.P(0,0),bi,$n,Hr,Yn.predicate);return Jt&&Jt.box&&Jt.box.length&&(this.markUsedOrientation(Ct,Ue,Le),this.placedOrientations[qn]=Ue),Jt};o((()=>a(lc,Re.bk.horizontal)),(()=>{const Le=Jt.verticalTextBox;return Ct.allowVerticalPlacement&&po>0&&Le?(W(Le),a(Le,Re.bk.vertical)):{box:null,offscreen:null,occluded:null}})),i(!!(Al&&Al.box&&Al.box.length))}}if(Hl=Al,ha=Hl&&Hl.box&&Hl.box.length>0,tl=Hl&&Hl.offscreen,il=Hl&&Hl.occluded,Le.useRuntimeCollisionCircles){const Oe=Ct.text.placedSymbolArray.get(Le.centerJustifiedTextSymbolIndex>=0?Le.centerJustifiedTextSymbolIndex:Le.verticalPlacedTextSymbolIndex),qe=Re.bl(Ct.textSizeData,Zn,Oe),Jt=Ot.get("text-padding");Wl=this.collisionIndex.placeCollisionCircles(Ct,bi,Oe,Ct.lineVertexArray,Ct.glyphOffsetArray,qe,Hr,Jr,Ln,Ue,uo,Yn.predicate,Le.collisionCircleDiameter*qe/Re.bq,Jt,this.retainedQueryData[Ct.bucketInstanceId].tileID),ha=bi||Wl.circles.length>0&&!Wl.collisionDetected,tl=tl&&Wl.offscreen,il=Wl.occluded}if(Jt.iconFeatureIndex&&(oc=Jt.iconFeatureIndex),Jt.iconBox){const i=Oe=>{W(Oe);const Ue=Le.hasIconTextFit&&fl?hi(fl.x,fl.y,lo,uo,this.transform.angle):new Re.P(0,0),qe=Ct.getSymbolInstanceIconSize(Xn,this.transform.zoom,Le.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(Ct,qe,Oe,Ue,Pi,$n,Hr,Yn.predicate)};Ml&&Ml.box&&Ml.box.length&&Jt.verticalIconBox?(Kl=i(Jt.verticalIconBox),el=Kl.box.length>0):(Kl=i(Jt.iconBox),el=Kl.box.length>0),tl=tl&&Kl.offscreen,sl=Kl.occluded}const Oc=vi||0===Le.numHorizontalGlyphVertices&&0===po,Nc=xi||0===Le.numIconVertices;if(Oc||Nc?Nc?Oc||(el=el&&ha):ha=el&&ha:el=ha=el&&ha,ha&&Hl&&Hl.box&&this.collisionIndex.insertCollisionBox(Hl.box,Ot.get("text-ignore-placement"),Ct.bucketInstanceId,Ml&&Ml.box&&Ql?Ql:Jl,Yn.ID),el&&Kl&&this.collisionIndex.insertCollisionBox(Kl.box,Ot.get("icon-ignore-placement"),Ct.bucketInstanceId,oc,Yn.ID),Wl&&(ha&&this.collisionIndex.insertCollisionCircles(Wl.circles,Ot.get("text-ignore-placement"),Ct.bucketInstanceId,Jl,Yn.ID),Ue)){const Re=Ct.bucketInstanceId;let Le=this.collisionCircleArrays[Re];void 0===Le&&(Le=this.collisionCircleArrays[Re]=new ai);for(let Re=0;Re<Wl.circles.length;Re+=4)Le.circles.push(Wl.circles[Re+0]),Le.circles.push(Wl.circles[Re+1]),Le.circles.push(Wl.circles[Re+2]),Le.circles.push(Wl.collisionDetected?1:0)}const jc="globe"!==Ct.projection.name;is=is&&(jc||!il),as=as&&(jc||!sl),this.placements[qn]=new si(ha||is,el||as,tl||Ct.justReloaded),Oe.add(qn)};if(po&&this.buildingIndex&&(this.buildingIndex.updateZOffset(Ct,this.retainedQueryData[Ct.bucketInstanceId].tileID),Ct.updateZOffset()),Ct.sortFeaturesByY){const Le=Ct.getSortedSymbolIndexes(this.transform.angle);for(let Re=Le.length-1;Re>=0;--Re){const Oe=Le[Re];L(Ct.symbolInstances.get(Oe),Oe,Ct.collisionArrays[Oe])}Ct.hasAnyZOffset&&Re.w(`${Ct.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(Ct.hasAnyZOffset){const Re=Ct.getSortedIndexesByZOffset();for(let Le=0;Le<Re.length;++Le){const Oe=Re[Le];L(Ct.symbolInstances.get(Oe),Oe,Ct.collisionArrays[Oe])}}else for(let Re=Le.symbolInstanceStart;Re<Le.symbolInstanceEnd;Re++)L(Ct.symbolInstances.get(Re),Re,Ct.collisionArrays[Re]);if(Ue&&Ct.bucketInstanceId in this.collisionCircleArrays){const Le=this.collisionCircleArrays[Ct.bucketInstanceId];Re.a6.mat4.invert(Le.invProjMatrix,Hr),Le.viewportMatrix=this.collisionIndex.getViewportMatrix()}Ct.justReloaded=!1}markUsedJustification(Le,Oe,Ue,qe){const{leftJustifiedTextSymbolIndex:Ct,centerJustifiedTextSymbolIndex:Ot,rightJustifiedTextSymbolIndex:Jt,verticalPlacedTextSymbolIndex:Hr,crossTileID:Jr}=Ue,Ln=Re.bv(Oe),Nn=qe===Re.bk.vertical?Hr:"left"===Ln?Ct:"center"===Ln?Ot:"right"===Ln?Jt:-1;Ct>=0&&(Le.text.placedSymbolArray.get(Ct).crossTileID=Nn>=0&&Ct!==Nn?0:Jr),Ot>=0&&(Le.text.placedSymbolArray.get(Ot).crossTileID=Nn>=0&&Ot!==Nn?0:Jr),Jt>=0&&(Le.text.placedSymbolArray.get(Jt).crossTileID=Nn>=0&&Jt!==Nn?0:Jr),Hr>=0&&(Le.text.placedSymbolArray.get(Hr).crossTileID=Nn>=0&&Hr!==Nn?0:Jr)}markUsedOrientation(Le,Oe,Ue){const qe=Oe===Re.bk.horizontal||Oe===Re.bk.horizontalOnly?Oe:0,Ct=Oe===Re.bk.vertical?Oe:0,{leftJustifiedTextSymbolIndex:Ot,centerJustifiedTextSymbolIndex:Jt,rightJustifiedTextSymbolIndex:Hr,verticalPlacedTextSymbolIndex:Jr}=Ue,Ln=Le.text.placedSymbolArray;Ot>=0&&(Ln.get(Ot).placedOrientation=qe),Jt>=0&&(Ln.get(Jt).placedOrientation=qe),Hr>=0&&(Ln.get(Hr).placedOrientation=qe),Jr>=0&&(Ln.get(Jr).placedOrientation=Ct)}commit(Re){this.commitTime=Re,this.zoomAtLastRecencyCheck=this.transform.zoom;const Le=this.prevPlacement;let Oe=!1;this.prevZoomAdjustment=Le?Le.zoomAdjustment(this.transform.zoom):0;const Ue=Le?Le.symbolFadeChange(Re):1,qe=Le?Le.opacities:{},Ct=Le?Le.variableOffsets:{},Ot=Le?Le.placedOrientations:{};for(const Re in this.placements){const Le=this.placements[Re],Ct=qe[Re];Ct?(this.opacities[Re]=new ri(Ct,Ue,Le.text,Le.icon,null,Le.clipped),Oe=Oe||Le.text!==Ct.text.placed||Le.icon!==Ct.icon.placed):(this.opacities[Re]=new ri(null,Ue,Le.text,Le.icon,Le.skipFade,Le.clipped),Oe=Oe||Le.text||Le.icon)}for(const Re in qe){const Le=qe[Re];if(!this.opacities[Re]){const qe=new ri(Le,Ue,!1,!1);qe.isHidden()||(this.opacities[Re]=qe,Oe=Oe||Le.text.placed||Le.icon.placed)}}for(const Re in Ct)this.variableOffsets[Re]||!this.opacities[Re]||this.opacities[Re].isHidden()||(this.variableOffsets[Re]=Ct[Re]);for(const Re in Ot)this.placedOrientations[Re]||!this.opacities[Re]||this.opacities[Re].isHidden()||(this.placedOrientations[Re]=Ot[Re]);Oe?this.lastPlacementChangeTime=Re:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=Le?Le.lastPlacementChangeTime:Re)}updateLayerOpacities(Re,Le,Oe,Ue){const qe=new Set;for(const Ct of Le){const Le=Ct.getBucket(Re);Le&&Ct.latestFeatureIndex&&Re.fqid===Le.layerIds[0]&&(this.updateBucketOpacities(Le,qe,Ct,Ct.collisionBoxArray,Oe,Ue,Ct.tileID,Re.scope),Le.layers[0].layout.get("symbol-z-elevate")&&this.buildingIndex&&(this.buildingIndex.updateZOffset(Le,Ct.tileID),Le.updateZOffset()))}}updateBucketOpacities(Le,Oe,Ue,qe,Ct,Ot,Jt,Hr){Le.hasTextData()&&Le.text.opacityVertexArray.clear(),Le.hasIconData()&&Le.icon.opacityVertexArray.clear(),Le.hasIconCollisionBoxData()&&Le.iconCollisionBox.collisionVertexArray.clear(),Le.hasTextCollisionBoxData()&&Le.textCollisionBox.collisionVertexArray.clear();const Jr=Le.layers[0].layout,Ln=Le.layers[0].paint,Nn=!!Le.layers[0].dynamicFilter(),$n=new ri(null,0,!1,!1,!0),Gn=Jr.get("text-allow-overlap"),qn=Jr.get("icon-allow-overlap"),Zn=Jr.get("text-variable-anchor"),Xn="map"===Jr.get("text-rotation-alignment"),Yn="map"===Jr.get("text-pitch-alignment"),_i=Ln.get("symbol-z-offset"),vi="sea"===Ln.get("symbol-elevation-reference"),xi=!_i.isConstant(),bi=new ri(null,0,Gn&&(qn||!Le.hasIconData()||Jr.get("icon-optional")),qn&&(Gn||!Le.hasTextData()||Jr.get("text-optional")),!0);!Le.collisionArrays&&qe&&(Le.hasIconCollisionBoxData()||Le.hasTextCollisionBoxData())&&Le.deserializeCollisionBoxes(qe);const w=(Re,Le,Oe)=>{for(let Ue=0;Ue<Le/4;Ue++)Re.opacityVertexArray.emplaceBack(Oe)};let Pi=0;Ot&&Le.updateReplacement(Jt,Ot);for(let qe=0;qe<Le.symbolInstances.length;qe++){const Jr=Le.symbolInstances.get(qe),{numHorizontalGlyphVertices:Ln,numVerticalGlyphVertices:Gn,crossTileID:qn,numIconVertices:lo,tileAnchorX:uo,tileAnchorY:po}=Jr;let fo=null;if(Jr&&xi){const Re=this.retainedQueryData[Le.bucketInstanceId];fo=Ue.latestFeatureIndex.loadFeature({featureIndex:Jr.featureIndex,bucketIndex:Re.bucketIndex,sourceLayerIndex:Re.sourceLayerIndex,layoutVertexArrayOffset:0})}const Io=_i.evaluate(fo,{}),is=Oe.has(qn);let as=this.opacities[qn];is?as=$n:as||(as=bi,this.opacities[qn]=as),Oe.add(qn);const Is=Ln>0||Gn>0,Xs=lo>0,ta=this.placedOrientations[qn],ha=ta===Re.bk.vertical,el=ta===Re.bk.horizontal||ta===Re.bk.horizontalOnly;!Is&&!Xs||as.isHidden()||Pi++;let tl=!1;if((Is||Xs)&&Ot)for(const Oe of Le.activeReplacements){if(Re.br(Oe,Ct,Re.bs.Symbol,Hr))continue;if(Oe.min.x>uo||uo>Oe.max.x||Oe.min.y>po||po>Oe.max.y)continue;const Le=Re.bt(uo,po,Jt.canonical,Oe.footprintTileId.canonical);if(tl=Re.bu(Le,Oe.footprint),tl)break}if(Is){const Re=tl?Xc:yi(as.text);w(Le.text,Ln,ha?Xc:Re),w(Le.text,Gn,el?Xc:Re);const Oe=as.text.isHidden(),{leftJustifiedTextSymbolIndex:Ue,centerJustifiedTextSymbolIndex:qe,rightJustifiedTextSymbolIndex:Ct,verticalPlacedTextSymbolIndex:Ot}=Jr,Jt=Le.text.placedSymbolArray,Hr=Oe||ha?1:0;Ue>=0&&(Jt.get(Ue).hidden=Hr),qe>=0&&(Jt.get(qe).hidden=Hr),Ct>=0&&(Jt.get(Ct).hidden=Hr),Ot>=0&&(Jt.get(Ot).hidden=Oe||el?1:0);const Nn=this.variableOffsets[qn];Nn&&this.markUsedJustification(Le,Nn.anchor,Jr,ta);const $n=this.placedOrientations[qn];$n&&(this.markUsedJustification(Le,"left",Jr,$n),this.markUsedOrientation(Le,$n,Jr))}if(Xs){const Re=tl?Xc:yi(as.icon),{placedIconSymbolIndex:Oe,verticalPlacedIconSymbolIndex:Ue}=Jr,qe=Le.icon.placedSymbolArray,Ct=as.icon.isHidden()?1:0;Oe>=0&&(w(Le.icon,lo,ha?Xc:Re),qe.get(Oe).hidden=Ct),Ue>=0&&(w(Le.icon,Jr.numVerticalIconVertices,el?Xc:Re),qe.get(Ue).hidden=Ct)}if(Le.hasIconCollisionBoxData()||Le.hasTextCollisionBoxData()){const Oe=Le.collisionArrays[qe];if(Oe){let Ue=new Re.P(0,0),qe=!0;if(Oe.textBox||Oe.verticalTextBox){if(Zn){const Re=this.variableOffsets[qn];Re?(Ue=ci(Re.anchor,Re.width,Re.height,Re.textOffset,Re.textScale),Xn&&Ue._rotate(Yn?this.transform.angle:-this.transform.angle)):qe=!1}Nn&&(qe=!as.clipped),Oe.textBox&&di(Le.textCollisionBox.collisionVertexArray,as.text.placed,!qe||ha,Io,vi,Ue.x,Ue.y),Oe.verticalTextBox&&di(Le.textCollisionBox.collisionVertexArray,as.text.placed,!qe||el,Io,vi,Ue.x,Ue.y)}const Ct=qe&&Boolean(!el&&Oe.verticalIconBox);Oe.iconBox&&di(Le.iconCollisionBox.collisionVertexArray,as.icon.placed,Ct,Io,vi,Jr.hasIconTextFit?Ue.x:0,Jr.hasIconTextFit?Ue.y:0),Oe.verticalIconBox&&di(Le.iconCollisionBox.collisionVertexArray,as.icon.placed,!Ct,Io,vi,Jr.hasIconTextFit?Ue.x:0,Jr.hasIconTextFit?Ue.y:0)}}}if(Le.fullyClipped=0===Pi,Le.sortFeatures(this.transform.angle),this.retainedQueryData[Le.bucketInstanceId]&&(this.retainedQueryData[Le.bucketInstanceId].featureSortOrder=Le.featureSortOrder),Le.hasTextData()&&Le.text.opacityVertexBuffer&&Le.text.opacityVertexBuffer.updateData(Le.text.opacityVertexArray),Le.hasIconData()&&Le.icon.opacityVertexBuffer&&Le.icon.opacityVertexBuffer.updateData(Le.icon.opacityVertexArray),Le.hasIconCollisionBoxData()&&Le.iconCollisionBox.collisionVertexBuffer&&Le.iconCollisionBox.collisionVertexBuffer.updateData(Le.iconCollisionBox.collisionVertexArray),Le.hasTextCollisionBoxData()&&Le.textCollisionBox.collisionVertexBuffer&&Le.textCollisionBox.collisionVertexBuffer.updateData(Le.textCollisionBox.collisionVertexArray),Le.bucketInstanceId in this.collisionCircleArrays){const Re=this.collisionCircleArrays[Le.bucketInstanceId];Le.placementInvProjMatrix=Re.invProjMatrix,Le.placementViewportMatrix=Re.viewportMatrix,Le.collisionCircleArray=Re.circles,delete this.collisionCircleArrays[Le.bucketInstanceId]}}symbolFadeChange(Re){return 0===this.fadeDuration?1:(Re-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(Re){return Math.max(0,(this.transform.zoom-Re)/1.5)}hasTransitions(Re){return this.stale||Re-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(Re,Le){const Oe=this.zoomAtLastRecencyCheck===Le?1-this.zoomAdjustment(Le):1;return this.zoomAtLastRecencyCheck=Le,this.commitTime+this.fadeDuration*Oe>Re}setStale(){this.stale=!0}}function di(Re,Le,Oe,Ue,qe,Ct,Ot){Re.emplaceBack(Le?1:0,Oe?1:0,Ct||0,Ot||0,Ue,qe?1:0),Re.emplaceBack(Le?1:0,Oe?1:0,Ct||0,Ot||0,Ue,qe?1:0),Re.emplaceBack(Le?1:0,Oe?1:0,Ct||0,Ot||0,Ue,qe?1:0),Re.emplaceBack(Le?1:0,Oe?1:0,Ct||0,Ot||0,Ue,qe?1:0)}const Oc=Math.pow(2,25),Nc=Math.pow(2,24),jc=Math.pow(2,17),Uc=Math.pow(2,16),Hc=Math.pow(2,9),Wc=Math.pow(2,8),Zc=Math.pow(2,1);function yi(Re){if(0===Re.opacity&&!Re.placed)return 0;if(1===Re.opacity&&Re.placed)return 4294967295;const Le=Re.placed?1:0,Oe=Math.floor(127*Re.opacity);return Oe*Oc+Le*Nc+Oe*jc+Le*Uc+Oe*Hc+Le*Wc+Oe*Zc+Le}const Xc=0;class wi{constructor(Re){this._sortAcrossTiles="viewport-y"!==Re.layout.get("symbol-z-order")&&void 0!==Re.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(Re,Le,Oe,Ue,qe){const Ct=this._bucketParts;for(;this._currentTileIndex<Re.length;)if(Le.getBucketParts(Ct,Ue,Re[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,qe())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,Ct.sort(((Re,Le)=>Re.sortKey-Le.sortKey)));this._currentPartIndex<Ct.length;){const Re=Ct[this._currentPartIndex];if(Le.placeLayerBucketPart(Re,this._seenCrossTileIDs,Oe,0===Re.symbolInstanceStart),this._currentPartIndex++,qe())return!0}return!1}}class Ti{constructor(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr){this.placement=new ui(Re,qe,Ct,Ot,Jt,Hr),this._currentPlacementIndex=Le.length-1,this._forceFullPlacement=Oe,this._showCollisionBoxes=Ue,this._done=!1}isDone(){return this._done}continuePlacement(Le,Oe,Ue,qe){const Ct=Re.q.now(),a=()=>{const Le=Re.q.now()-Ct;return!this._forceFullPlacement&&Le>2};for(;this._currentPlacementIndex>=0;){const Ct=Oe[Le[this._currentPlacementIndex]],Ot=this.placement.collisionIndex.transform.zoom;if("symbol"===Ct.type&&(!Ct.minzoom||Ct.minzoom<=Ot)&&(!Ct.maxzoom||Ct.maxzoom>Ot)){const Le=Ct,Oe=Le.layout.get("symbol-z-elevate"),Ot=void 0!==Le.layout.get("symbol-sort-key").constantOr(1),Jt=Le.layout.get("symbol-z-order"),Hr="viewport-y"===Jt||"auto"===Jt&&!("viewport-y"!==Jt&&Ot),Jr=Le.layout.get("text-allow-overlap")||Le.layout.get("icon-allow-overlap")||Le.layout.get("text-ignore-placement")||Le.layout.get("icon-ignore-placement"),Ln=Hr&&Jr,Nn=this._inProgressLayer=this._inProgressLayer||new wi(Le),$n=Re.av(Ct.source,Ct.scope);if(Nn.continuePlacement(Oe||Ln?qe[$n]:Ue[$n],this.placement,this._showCollisionBoxes,Ct,a))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(Re){return this.placement.commit(Re),this.placement}}const Yc=512/Re.ab/2;class Ci{constructor(Le,Oe,Ue){this.tileID=Le,this.bucketInstanceId=Ue,this.index=new Re.by(Oe.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const qe=Le.canonical.x*Re.ab,Ct=Le.canonical.y*Re.ab;for(let Re=0;Re<Oe.length;Re++){const{key:Le,crossTileID:Ue,tileAnchorX:Ot,tileAnchorY:Jt}=Oe.get(Re),Hr=Math.floor((qe+Ot)*Yc),Jr=Math.floor((Ct+Jt)*Yc);this.index.add(Hr,Jr),this.keys.push(Le),this.crossTileIDs.push(Ue)}this.index.finish()}findMatches(Le,Oe,Ue){const qe=this.tileID.canonical.z<Oe.canonical.z?1:Math.pow(2,this.tileID.canonical.z-Oe.canonical.z),Ct=Yc/Math.pow(2,Oe.canonical.z-this.tileID.canonical.z),Ot=Oe.canonical.x*Re.ab,Jt=Oe.canonical.y*Re.ab;for(let Re=0;Re<Le.length;Re++){const Oe=Le.get(Re);if(Oe.crossTileID)continue;const{key:Hr,tileAnchorX:Jr,tileAnchorY:Ln}=Oe,Nn=Math.floor((Ot+Jr)*Ct),$n=Math.floor((Jt+Ln)*Ct),Gn=this.index.range(Nn-qe,$n-qe,Nn+qe,$n+qe);for(const Re of Gn){const Le=this.crossTileIDs[Re];if(this.keys[Re]===Hr&&!Ue.has(Le)){Ue.add(Le),Oe.crossTileID=Le;break}}}}}class Si{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Ii{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(Re){const Le=Math.round((Re-this.lng)/360);if(0!==Le)for(const Re in this.indexes){const Oe=this.indexes[Re],Ue={};for(const Re in Oe){const qe=Oe[Re];qe.tileID=qe.tileID.unwrapTo(qe.tileID.wrap+Le),Ue[qe.tileID.key]=qe}this.indexes[Re]=Ue}this.lng=Re}addBucket(Re,Le,Oe){if(this.indexes[Re.overscaledZ]&&this.indexes[Re.overscaledZ][Re.key]){if(this.indexes[Re.overscaledZ][Re.key].bucketInstanceId===Le.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(Re.overscaledZ,this.indexes[Re.overscaledZ][Re.key])}for(let Re=0;Re<Le.symbolInstances.length;Re++)Le.symbolInstances.get(Re).crossTileID=0;this.usedCrossTileIDs[Re.overscaledZ]||(this.usedCrossTileIDs[Re.overscaledZ]=new Set);const Ue=this.usedCrossTileIDs[Re.overscaledZ];for(const Oe in this.indexes){const qe=this.indexes[Oe];if(Number(Oe)>Re.overscaledZ)for(const Oe in qe){const Ct=qe[Oe];Ct.tileID.isChildOf(Re)&&Ct.findMatches(Le.symbolInstances,Re,Ue)}else{const Ct=qe[Re.scaledTo(Number(Oe)).key];Ct&&Ct.findMatches(Le.symbolInstances,Re,Ue)}}for(let Re=0;Re<Le.symbolInstances.length;Re++){const qe=Le.symbolInstances.get(Re);qe.crossTileID||(qe.crossTileID=Oe.generate(),Ue.add(qe.crossTileID))}return void 0===this.indexes[Re.overscaledZ]&&(this.indexes[Re.overscaledZ]={}),this.indexes[Re.overscaledZ][Re.key]=new Ci(Re,Le.symbolInstances,Le.bucketInstanceId),!0}removeBucketCrossTileIDs(Re,Le){for(const Oe of Le.crossTileIDs)this.usedCrossTileIDs[Re].delete(Oe)}removeStaleBuckets(Re){let Le=!1;for(const Oe in this.indexes){const Ue=this.indexes[Oe];for(const qe in Ue)Re[Ue[qe].bucketInstanceId]||(this.removeBucketCrossTileIDs(Oe,Ue[qe]),delete Ue[qe],Le=!0)}return Le}}class Di{constructor(){this.layerIndexes={},this.crossTileIDs=new Si,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(Re,Le,Oe,Ue){let qe=this.layerIndexes[Re.fqid];void 0===qe&&(qe=this.layerIndexes[Re.fqid]=new Ii);let Ct=!1;const Ot={};"globe"!==Ue.name&&qe.handleWrapJump(Oe);for(const Oe of Le){const Le=Oe.getBucket(Re);Le&&Re.fqid===Le.layerIds[0]&&(Le.bucketInstanceId||(Le.bucketInstanceId=++this.maxBucketInstanceId),qe.addBucket(Oe.tileID,Le,this.crossTileIDs)&&(Ct=!0),Ot[Le.bucketInstanceId]=!0)}return qe.removeStaleBuckets(Ot)&&(Ct=!0),Ct}pruneUnusedLayers(Re){const Le={};Re.forEach((Re=>{Le[Re]=!0}));for(const Re in this.layerIndexes)Le[Re]||delete this.layerIndexes[Re]}}const Kc=771;class Ai{constructor(Re,Le,Oe,Ue){this.blendFunction=Re,this.blendColor=Le,this.mask=Oe,this.blendEquation=Ue}}Ai.Replace=[1,0,1,0],Ai.disabled=new Ai(Ai.Replace,Re.bz.transparent,[!1,!1,!1,!1]),Ai.unblended=new Ai(Ai.Replace,Re.bz.transparent,[!0,!0,!0,!0]),Ai.alphaBlended=new Ai([1,Kc,1,Kc],Re.bz.transparent,[!0,!0,!0,!0]),Ai.alphaBlendedNonPremultiplied=new Ai([770,Kc,770,Kc],Re.bz.transparent,[!0,!0,!0,!0]),Ai.multiply=new Ai([774,0,774,0],Re.bz.transparent,[!0,!0,!0,!0]);class Li{constructor(Re,Le,Oe){this.func=Re,this.mask=Le,this.range=Oe}}Li.ReadOnly=!1,Li.ReadWrite=!0,Li.disabled=new Li(519,Li.ReadOnly,[0,1]);const Jc=7680;class Mi{constructor(Re,Le,Oe,Ue,qe,Ct){this.test=Re,this.ref=Le,this.mask=Oe,this.fail=Ue,this.depthFail=qe,this.pass=Ct}}Mi.disabled=new Mi({func:519,mask:0},0,0,Jc,Jc,Jc);const Qc=1029,iu=2305;class Fi{constructor(Re,Le,Oe){this.enable=Re,this.mode=Le,this.frontFace=Oe}}function ki(Le,Oe){const Ue=Re.bC(Le,3);Re.a6.mat4.fromQuat(Le,Oe),Re.bE(Le,3,Ue)}function Bi(Le,Oe){const Ue=Re.a6.quat.identity([]);return Re.a6.quat.rotateZ(Ue,Ue,-Oe),Re.a6.quat.rotateX(Ue,Ue,-Le),Ue}function Ni(Le,Oe){const Ue=[Le[0],Le[1],0],qe=[Oe[0],Oe[1],0];if(Re.a6.vec3.length(Ue)>=1e-15){const Le=Re.a6.vec3.normalize([],Ue);Re.a6.vec3.scale(qe,Le,Re.a6.vec3.dot(qe,Le)),Oe[0]=qe[0],Oe[1]=qe[1]}const Ct=Re.a6.vec3.cross([],Oe,Le);if(Re.a6.vec3.len(Ct)<1e-15)return null;const Ot=Math.atan2(-Ct[1],Ct[0]);return Bi(Math.atan2(Math.sqrt(Le[0]*Le[0]+Le[1]*Le[1]),-Le[2]),Ot)}Fi.disabled=new Fi(!1,Qc,iu),Fi.backCCW=new Fi(!0,Qc,iu),Fi.backCW=new Fi(!0,Qc,2304),Fi.frontCW=new Fi(!0,1028,2304),Fi.frontCCW=new Fi(!0,1028,iu);class Ui{constructor(Re,Le){this.position=Re,this.orientation=Le}get position(){return this._position}set position(Le){if(Le){const Oe=Le instanceof Re.a5?Le:new Re.a5(Le[0],Le[1],Le[2]);this._renderWorldCopies&&(Oe.x=Re.bA(Oe.x,0,1)),this._position=Oe}else this._position=null}lookAtPoint(Le,Oe){if(this.orientation=null,!this.position)return;const Ue=this.position,qe=this._elevation?this._elevation.getAtPointOrZero(Re.a5.fromLngLat(Le)):0,Ct=Re.a5.fromLngLat(Le,qe),Ot=[Ct.x-Ue.x,Ct.y-Ue.y,Ct.z-Ue.z];Oe||(Oe=[0,0,1]),Oe[2]=Math.abs(Oe[2]),this.orientation=Ni(Ot,Oe)}setPitchBearing(Le,Oe){this.orientation=Bi(Re.bB(Le),Re.bB(-Oe))}}class Gi{constructor(Le,Oe){this._transform=Re.a6.mat4.identity([]),this.orientation=Oe,this.position=Le}get mercatorPosition(){const Le=this.position;return new Re.a5(Le[0],Le[1],Le[2])}get position(){const Le=Re.bC(this._transform,3);return[Le[0],Le[1],Le[2]]}set position(Le){var Oe;Le&&Re.bE(this._transform,3,[(Oe=Le)[0],Oe[1],Oe[2],1])}get orientation(){return this._orientation}set orientation(Le){this._orientation=Le||Re.a6.quat.identity([]),Le&&ki(this._transform,this._orientation)}getPitchBearing(){const Re=this.forward(),Le=this.right();return{bearing:Math.atan2(-Le[1],Le[0]),pitch:Math.atan2(Math.sqrt(Re[0]*Re[0]+Re[1]*Re[1]),-Re[2])}}setPitchBearing(Re,Le){this._orientation=Bi(Re,Le),ki(this._transform,this._orientation)}forward(){const Le=Re.bC(this._transform,2);return[-Le[0],-Le[1],-Le[2]]}up(){const Le=Re.bC(this._transform,1);return[-Le[0],-Le[1],-Le[2]]}right(){const Le=Re.bC(this._transform,0);return[Le[0],Le[1],Le[2]]}getCameraToWorld(Le,Oe){const Ue=new Float64Array(16);return Re.a6.mat4.invert(Ue,this.getWorldToCamera(Le,Oe)),Ue}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(Le,Oe,Ue){const qe=this.position;Re.a6.vec3.scale(qe,qe,-Le);const Ct=new Float64Array(16);return Re.a6.mat4.fromScaling(Ct,[Ue,Ue,Ue]),Re.a6.mat4.translate(Ct,Ct,qe),Ct[10]*=Oe,Ct}getWorldToCamera(Le,Oe){const Ue=new Float64Array(16),qe=new Float64Array(4),Ct=this.position;return Re.a6.quat.conjugate(qe,this._orientation),Re.a6.vec3.scale(Ct,Ct,-Le),Re.a6.mat4.fromQuat(Ue,qe),Re.a6.mat4.translate(Ue,Ue,Ct),Ue[1]*=-1,Ue[5]*=-1,Ue[9]*=-1,Ue[13]*=-1,Ue[8]*=Oe,Ue[9]*=Oe,Ue[10]*=Oe,Ue[11]*=Oe,Ue}getCameraToClipPerspective(Le,Oe,Ue,qe){const Ct=new Float64Array(16);return Re.a6.mat4.perspective(Ct,Le,Oe,Ue,qe),Ct}getCameraToClipOrthographic(Le,Oe,Ue,qe,Ct,Ot){const Jt=new Float64Array(16);return Re.a6.mat4.ortho(Jt,Le,Oe,Ue,qe,Ct,Ot),Jt}getDistanceToElevation(Le,Oe=!1){const Ue=0===Le?0:Re.bD(Le,Oe?Re.aM(this.position[1]):this.position[1]),qe=this.forward();return(Ue-this.position[2])/qe[2]}clone(){return new Gi([...this.position],[...this.orientation])}}const ou={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11};class Vi{constructor(Re=0,Le=0,Oe=0,Ue=0){if(isNaN(Re)||Re<0||isNaN(Le)||Le<0||isNaN(Oe)||Oe<0||isNaN(Ue)||Ue<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=Re,this.bottom=Le,this.left=Oe,this.right=Ue}interpolate(Le,Oe,Ue){return null!=Oe.top&&null!=Le.top&&(this.top=Re.aa(Le.top,Oe.top,Ue)),null!=Oe.bottom&&null!=Le.bottom&&(this.bottom=Re.aa(Le.bottom,Oe.bottom,Ue)),null!=Oe.left&&null!=Le.left&&(this.left=Re.aa(Le.left,Oe.left,Ue)),null!=Oe.right&&null!=Le.right&&(this.right=Re.aa(Le.right,Oe.right,Ue)),this}getCenter(Le,Oe){const Ue=Re.ap((this.left+Le-this.right)/2,0,Le),qe=Re.ap((this.top+Oe-this.bottom)/2,0,Oe);return new Re.P(Ue,qe)}equals(Re){return this.top===Re.top&&this.bottom===Re.bottom&&this.left===Re.left&&this.right===Re.right}clone(){return new Vi(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const qi=(Re,Le,Oe)=>(1-Oe)*Re+Oe*Le,Zi=Re=>Re*Re*Re*Re*Re;class Hi{constructor(Le,Oe,Ue,qe,Ct,Ot,Jt){this.tileSize=512,this._renderWorldCopies=void 0===Ct||Ct,this._minZoom=Le||0,this._maxZoom=Oe||22,this._minPitch=Ue??0,this._maxPitch=qe??60,this.setProjection(Ot),this.setMaxBounds(Jt),this.width=0,this.height=0,this._center=new Re.bK(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Vi,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new Gi,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1}clone(){const Re=new Hi(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return Re._elevation=this._elevation,Re._centerAltitude=this._centerAltitude,Re._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,Re.tileSize=this.tileSize,Re.mercatorFromTransition=this.mercatorFromTransition,Re.width=this.width,Re.height=this.height,Re.cameraElevationReference=this.cameraElevationReference,Re._center=this._center,Re._setZoom(this.zoom),Re._seaLevelZoom=this._seaLevelZoom,Re.angle=this.angle,Re._fov=this._fov,Re._pitch=this._pitch,Re._nearZ=this._nearZ,Re._farZ=this._farZ,Re._averageElevation=this._averageElevation,Re._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,Re._unmodified=this._unmodified,Re._edgeInsets=this._edgeInsets.clone(),Re._camera=this._camera.clone(),Re._calcMatrices(),Re.freezeTileCoverage=this.freezeTileCoverage,Re.frustumCorners=this.frustumCorners,Re}get isOrthographic(){return"globe"!==this.projection.name&&this._orthographicProjectionAtLowPitch&&this.pitch<15}get elevation(){return this._elevation}set elevation(Re){this._elevation!==Re&&(this._elevation=Re,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return"globe"!==this.projection.name&&!this.isOrthographic}updateElevation(Re,Le=!1){const Oe=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(null==this._seaLevelZoom||Oe)&&this._updateCameraOnTerrain(),(Re||Oe)&&this._constrainCamera(Le),this._calcMatrices()}getProjection(){return Re.ar(this.projection,["name","center","parallels"])}setProjection(Le){this.projectionOptions=Le||{name:"mercator"};const Oe=this.projection?this.getProjection():void 0;this.projection=Re.bL(this.projectionOptions);const Ue=this.getProjection(),qe=!Re.bh(Oe,Ue);return qe&&this._calcMatrices(),this.mercatorFromTransition=!1,qe}setOrthographicProjectionAtLowPitch(Re){return this._orthographicProjectionAtLowPitch!==Re&&(this._orthographicProjectionAtLowPitch=Re,this._calcMatrices(),!0)}setMercatorFromTransition(){const Le=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=Re.bL({name:"mercator"});const Oe=Le!==this.projection.name;return Oe&&this._calcMatrices(),Oe}get minZoom(){return this._minZoom}set minZoom(Re){this._minZoom!==Re&&(this._minZoom=Re,this.zoom=Math.max(this.zoom,Re))}get maxZoom(){return this._maxZoom}set maxZoom(Re){this._maxZoom!==Re&&(this._maxZoom=Re,this.zoom=Math.min(this.zoom,Re))}get minPitch(){return this._minPitch}set minPitch(Re){this._minPitch!==Re&&(this._minPitch=Re,this.pitch=Math.max(this.pitch,Re))}get maxPitch(){return this._maxPitch}set maxPitch(Re){this._maxPitch!==Re&&(this._maxPitch=Re,this.pitch=Math.min(this.pitch,Re))}get renderWorldCopies(){return this._renderWorldCopies&&!0===this.projection.supportsWorldCopies}set renderWorldCopies(Re){void 0===Re?Re=!0:null===Re&&(Re=!1),this._renderWorldCopies=Re}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const Re=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(Re))}get cameraWorldSize(){const Re=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(Re))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return Re.bD(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new Re.P(this.width,this.height)}get bearing(){return Re.bA(this.rotation,-180,180)}set bearing(Re){this.rotation=Re}get rotation(){return-this.angle/Math.PI*180}set rotation(Le){const Oe=-Le*Math.PI/180;this.angle!==Oe&&(this._unmodified=!1,this.angle=Oe,this._calcMatrices(),this.rotationMatrix=Re.a6.mat2.create(),Re.a6.mat2.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(Le){const Oe=Re.ap(Le,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==Oe&&(this._unmodified=!1,this._pitch=Oe,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const Re=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/Re)}set fov(Le){Le=Math.max(.01,Math.min(60,Le)),this._fov!==Le&&(this._unmodified=!1,this._fov=Re.bB(Le),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(Re){this._averageElevation=Re,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(Re){const Le=Math.min(Math.max(Re,this.minZoom),this.maxZoom);this._zoom!==Le&&(this._unmodified=!1,this._setZoom(Le),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(Re){this._zoom=Re,this.scale=this.zoomScale(Re),this.tileZoom=Math.floor(Re),this.zoomFraction=Re-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(Re){this._tileCoverLift!==Re&&(this._tileCoverLift=Re)}_updateCameraOnTerrain(){const Re=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,Le=this.elevation&&Re===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||Re===Number.NEGATIVE_INFINITY&&(!Le||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const Oe=this._elevation;Le||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&Oe.exaggeration()&&this._centerAltitudeValidForExaggeration!==Oe.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*Oe.exaggeration(),this._centerAltitudeValidForExaggeration=Oe.exaggeration()):(this._centerAltitude=Re||0,this._centerAltitudeValidForExaggeration=Oe.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){void 0!==this._centerAltitudeValidForExaggeration&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const Le=this._elevation,Oe=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],Ue=this.horizonLineFromTop();let qe=0,Ct=0;for(let Ot=0;Ot<Oe.length;Ot++){const Jt=new Re.P(Oe[Ot][0]*this.width,Ue+Oe[Ot][1]*(this.height-Ue)),Hr=Le.pointCoordinate(Jt);if(!Hr)continue;const Jr=1/Math.hypot(Hr[0]-this._camera.position[0],Hr[1]-this._camera.position[1]);qe+=Hr[3]*Jr,Ct+=Jr}return 0===Ct?NaN:qe/Ct}get center(){return this._center}set center(Re){Re.lat===this._center.lat&&Re.lng===this._center.lng||(this._unmodified=!1,this._center=Re,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._seaLevelZoom||!this._elevation)return;const Re=this._seaLevelZoom,Le=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),Oe=this.pixelsPerMeter/this.worldSize*Le,Ue=this._mercatorZfromZoom(Re),qe=this._mercatorZfromZoom(this._maxZoom),Ct=Math.max(Ue-Oe,qe);this._setZoom(this._zoomFromMercatorZ(Ct))}get padding(){return this._edgeInsets.toJSON()}set padding(Re){this._edgeInsets.equals(Re)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,Re,1),this._calcMatrices())}computeZoomRelativeTo(Le){const Oe=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,Le.toAltitude()));let Ue;Ue=Le.z<this._camera.position[2]?[Oe.x,Oe.y,Oe.z]:[Le.x,Le.y,Le.z];const qe=Re.a6.vec3.length(Re.a6.vec3.sub([],this._camera.position,Ue));return Re.ap(this._zoomFromMercatorZ(qe),this._minZoom,this._maxZoom)}setFreeCameraOptions(Le){if(!this.height)return;if(!Le.position&&!Le.orientation)return;this._updateCameraState();let Oe=!1;if(Le.orientation&&!Re.a6.quat.exactEquals(Le.orientation,this._camera.orientation)&&(Oe=this._setCameraOrientation(Le.orientation)),Le.position){const Ue=[Le.position.x,Le.position.y,Le.position.z];Re.a6.vec3.exactEquals(Ue,this._camera.position)||(this._setCameraPosition(Ue),Oe=!0)}Oe&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const Le=this._camera.position,Oe=new Ui;return Oe.position=new Re.a5(Le[0],Le[1],Le[2]),Oe.orientation=this._camera.orientation,Oe._elevation=this.elevation,Oe._renderWorldCopies=this.renderWorldCopies,Oe}_setCameraOrientation(Le){if(!Re.a6.quat.length(Le))return!1;Re.a6.quat.normalize(Le,Le);const Oe=Re.a6.vec3.transformQuat([],[0,0,-1],Le),Ue=Re.a6.vec3.transformQuat([],[0,-1,0],Le);if(Ue[2]<0)return!1;const qe=Ni(Oe,Ue);return!!qe&&(this._camera.orientation=qe,!0)}_setCameraPosition(Le){const Oe=this.zoomScale(this.minZoom)*this.tileSize,Ue=this.zoomScale(this.maxZoom)*this.tileSize,qe=this.cameraToCenterDistance;Le[2]=Re.ap(Le[2],qe/Ue,qe/Oe),this._camera.position=Le}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(Re){return this._edgeInsets.equals(Re)}interpolatePadding(Re,Le,Oe){this._unmodified=!1,this._edgeInsets.interpolate(Re,Le,Oe),this._constrain(),this._calcMatrices()}coveringZoomLevel(Re){const Le=(Re.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/Re.tileSize));return Math.max(0,Le)}getVisibleUnwrappedCoordinates(Le){const Oe=[new Re.bM(0,Le)];if(this.renderWorldCopies){const Ue=this.pointCoordinate(new Re.P(0,0)),qe=this.pointCoordinate(new Re.P(this.width,0)),Ct=this.pointCoordinate(new Re.P(this.width,this.height)),Ot=this.pointCoordinate(new Re.P(0,this.height)),Jt=Math.floor(Math.min(Ue.x,qe.x,Ct.x,Ot.x)),Hr=Math.floor(Math.max(Ue.x,qe.x,Ct.x,Ot.x)),Jr=1;for(let Ue=Jt-Jr;Ue<=Hr+Jr;Ue++)0!==Ue&&Oe.push(new Re.bM(Ue,Le))}return Oe}isLODDisabled(Re){return(!Re||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCover(Le,Oe,Ue){let qe=[];const Ct=void 0!==Ue,Ot=!Ct;if(Ot&&this.zoom<Oe)return qe;if(Ct&&0===Ue[0]&&0===Ue[1])return qe;const Jt=new Set,l=(Le,Oe,Ue,Ct,Ot)=>{const Hr=Re.c1(Oe,Le,Ue,Ct,Ot);Jt.has(Hr)||(qe.push(new Re.aA(Le,Oe,Ue,Ct,Ot)),Jt.add(Hr))};for(let Re=0;Re<Le.length;Re++){const qe=Le[Re];if(Ot&&qe.canonical.z!==Oe)continue;const Jt=qe.canonical,Hr=qe.overscaledZ,Jr=qe.wrap,Ln=1<<Jt.z,Nn=Jt.x+1<Ln,$n=Jt.x>0,Gn=Jt.y+1<Ln,qn=Jt.y>0,Zn=qe.wrap-($n?0:1),Xn=qe.wrap+(Nn?0:1),Yn=$n?Jt.x-1:Ln-1,_i=Nn?Jt.x+1:0;if(Ct)Ue[0]<0?(l(Hr,Xn,Jt.z,_i,Jt.y),Ue[1]<0&&Gn&&(l(Hr,Jr,Jt.z,Jt.x,Jt.y+1),l(Hr,Xn,Jt.z,_i,Jt.y+1)),Ue[1]>0&&qn&&(l(Hr,Jr,Jt.z,Jt.x,Jt.y-1),l(Hr,Xn,Jt.z,_i,Jt.y-1))):Ue[0]>0?(l(Hr,Zn,Jt.z,Yn,Jt.y),Ue[1]<0&&Gn&&(l(Hr,Jr,Jt.z,Jt.x,Jt.y+1),l(Hr,Zn,Jt.z,Yn,Jt.y+1)),Ue[1]>0&&qn&&(l(Hr,Jr,Jt.z,Jt.x,Jt.y-1),l(Hr,Zn,Jt.z,Yn,Jt.y-1))):Ue[1]<0&&Gn?l(Hr,Jr,Jt.z,Jt.x,Jt.y+1):qn&&l(Hr,Jr,Jt.z,Jt.x,Jt.y-1);else{const Re=qe.visibleQuadrants;1&Re&&(l(Hr,Zn,Jt.z,Yn,Jt.y),qn&&(l(Hr,Jr,Jt.z,Jt.x,Jt.y-1),l(Hr,Zn,Jt.z,Yn,Jt.y-1))),2&Re&&(l(Hr,Xn,Jt.z,_i,Jt.y),qn&&(l(Hr,Jr,Jt.z,Jt.x,Jt.y-1),l(Hr,Xn,Jt.z,_i,Jt.y-1))),4&Re&&(l(Hr,Zn,Jt.z,Yn,Jt.y),Gn&&(l(Hr,Jr,Jt.z,Jt.x,Jt.y+1),l(Hr,Zn,Jt.z,Yn,Jt.y+1))),8&Re&&(l(Hr,Xn,Jt.z,_i,Jt.y),Gn&&(l(Hr,Jr,Jt.z,Jt.x,Jt.y+1),l(Hr,Xn,Jt.z,_i,Jt.y+1)))}}const Hr=[];for(const Re of qe)qe.some((Le=>Re.isChildOf(Le)))||Hr.push(Re);if(qe=Hr.filter((Re=>!Le.some((Le=>!!(Re.overscaledZ<Oe&&Le.isChildOf(Re))||Re.equals(Le)||Re.isChildOf(Le))))),Ot){const Re=1<<Oe,Le="globe"===this.projection.name?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),Ue=[Re*Le.x,Re*Le.y],Ct=4,Ot=Ct*Ct;qe=qe.filter((Re=>{const Le=Re.canonical.x+.5-Ue[0],Oe=Re.canonical.y+.5-Ue[1];return Le*Le+Oe*Oe<Ot}))}return qe}coveringTiles(Le){let Oe=this.coveringZoomLevel(Le);const Ue=Oe,qe=this.elevation&&this.elevation.exaggeration(),Ct=qe&&!Le.isTerrainDEM,Ot="mercator"===this.projection.name;if(void 0!==Le.minzoom&&Oe<Le.minzoom)return[];void 0!==Le.maxzoom&&Oe>Le.maxzoom&&(Oe=Le.maxzoom);const Jt=this.locationCoordinate(this.center),Hr=this.center.lat,Jr=1<<Oe,Ln=[Jr*Jt.x,Jr*Jt.y,0],Nn="globe"===this.projection.name,$n=!Nn,Gn=Re.bN.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,Oe,$n),qn=Nn?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),Zn=Jr*Re.bD(1,this.center.lat),Xn=this._camera.position[2]/Re.bD(1,this.center.lat),Yn=[Jr*qn.x,Jr*qn.y,Xn*($n?1:Zn)],_i=Nn||qe,vi=this.cameraToCenterDistance/Le.tileSize*(Le.roundZoom?1:.502),xi=this.isLODDisabled(!0)?Oe:0;let bi;if(this._elevation&&Le.isTerrainDEM)bi=1e4*this._elevation.exaggeration();else if(this._elevation){const Re=this._elevation.getMinMaxForVisibleTiles();bi=Re?Re.max:this._centerAltitude}else bi=this._centerAltitude;const Pi=Le.isTerrainDEM?-bi:this._elevation?this._elevation.getMinElevationBelowMSL():0,lo=this.projection.isReprojectedInTileSpace?Re.bO(this):1,E=Le=>{const Oe=1/4e4,Ue=new Re.a5(Le.x+Oe,Le.y,Le.z),qe=new Re.a5(Le.x,Le.y+Oe,Le.z),Ct=Le.toLngLat(),Ot=Ue.toLngLat(),Jt=qe.toLngLat(),Hr=this.locationCoordinate(Ct),Jr=this.locationCoordinate(Ot),Ln=this.locationCoordinate(Jt),Nn=Math.hypot(Jr.x-Hr.x,Jr.y-Hr.y),$n=Math.hypot(Ln.x-Hr.x,Ln.y-Hr.y);return Math.sqrt(Nn*$n)*lo/Oe},C=Le=>{const Oe=bi,Ue=Pi;return{aabb:Re.bR(this,Jr,0,0,0,Le,Ue,Oe,this.projection),zoom:0,x:0,y:0,minZ:Ue,maxZ:Oe,wrap:Le,fullyVisible:!1}},uo=[];let po=[];const fo=Oe,Io=Le.reparseOverscaled?Ue:Oe,is=(Xn-this._centerAltitude)*Zn,L=Re=>{if(!this._elevation||!Re.tileID||!Ot)return;const Le=this._elevation.getMinMaxForTile(Re.tileID),Oe=Re.aabb;Le?(Oe.min[2]=Le.min,Oe.max[2]=Le.max,Oe.center[2]=(Oe.min[2]+Oe.max[2])/2):(Re.shouldSplit=M(Re),Re.shouldSplit||(Oe.min[2]=Oe.max[2]=Oe.center[2]=this._centerAltitude))},P=(Re,Le)=>{if(.707*Le<Re)return 1;const Oe=Le/Re;return Oe/(1.4144271570014144+(Math.pow(1.1,Oe-1.4144271570014144+1)-1)/(1.1-1)-1)},M=Le=>{if(Le.zoom<xi)return!0;if(Le.zoom===fo)return!1;if(null!=Le.shouldSplit)return Le.shouldSplit;const Oe=Le.aabb.distanceX(Yn),qe=Le.aabb.distanceY(Yn);let Jt=is,Jr=1;if(Nn){Jt=Le.aabb.distanceZ(Yn);const Oe=Math.pow(2,Le.zoom),Ue=Re.aM((Le.y+1)/Oe),qe=Re.aM(Le.y/Oe),Ct=Math.min(Math.max(Hr,Ue),qe),Ot=Re.c5(Ct)/Re.c5(Hr);if(Jr=Ct===Hr?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Ot/this._mercatorScaleRatio),this.zoom<=Re.c2&&Le.zoom===fo-1&&Ot>=.9)return!0}else if(Ct&&(Jt=Le.aabb.distanceZ(Yn)*Zn),this.projection.isReprojectedInTileSpace&&Ue<=5){const Oe=Math.pow(2,Le.zoom),Ue=E(new Re.a5((Le.x+.5)/Oe,(Le.y+.5)/Oe));Jr=Ue>.85?1:Ue}if(!Ot){const Re=Math.sqrt(Oe*Oe+qe*qe+Jt*Jt);let Ue=(1<<fo-Le.zoom)*vi*Jr;return Ue*=P(Math.max(Jt,is),Re),Re<Ue}let $n=Number.MAX_VALUE,Gn=0;const qn=Le.aabb.getCorners(),Xn=[];for(const Le of qn){Re.a6.vec3.sub(Xn,Le,Yn),Nn||(Ct?Xn[2]*=Zn:Xn[2]=is);const Oe=Re.a6.vec3.dot(Xn,this._camera.forward());Oe<$n&&($n=Oe,Gn=Math.abs(Xn[2]))}let _i=(1<<fo-Le.zoom)*vi*Jr;if(_i*=P(Math.max(Gn,is),$n),$n<_i)return!0;const bi=Le.aabb.closestPoint(Ln);return bi[0]===Ln[0]&&bi[1]===Ln[1]};if(this.renderWorldCopies)for(let Re=1;Re<=3;Re++)uo.push(C(-Re)),uo.push(C(Re));for(uo.push(C(0));uo.length>0;){const Ue=uo.pop(),qe=Ue.x,Jt=Ue.y;let Hr=Ue.fullyVisible;const d=()=>"globe"===this.projection.name&&(0===Ue.y||Ue.y===(1<<Ue.zoom)-1);if(!Hr){let Le=_i?Ue.aabb.intersects(Gn):Ue.aabb.intersectsFlat(Gn);if(0===Le&&d()){const Oe=new Re.bP(Ue.zoom,qe,Jt);Le=Re.bQ(this,Jr,Oe,!0).intersects(Gn)}if(0===Le)continue;Hr=2===Le}if(Ue.zoom!==fo&&M(Ue))for(let Le=0;Le<4;Le++){const Oe=(qe<<1)+Le%2,Ln=(Jt<<1)+(Le>>1),$n={aabb:Ot?Ue.aabb.quadrant(Le):Re.bR(this,Jr,Ue.zoom+1,Oe,Ln,Ue.wrap,Ue.minZ,Ue.maxZ,this.projection),zoom:Ue.zoom+1,x:Oe,y:Ln,wrap:Ue.wrap,fullyVisible:Hr,tileID:void 0,shouldSplit:void 0,minZ:Ue.minZ,maxZ:Ue.maxZ};Ct&&!Nn&&($n.tileID=new Re.aA(Ue.zoom+1===fo?Io:Ue.zoom+1,Ue.wrap,Ue.zoom+1,Oe,Ln),L($n)),uo.push($n)}else{const Ct=Ue.zoom===fo?Io:Ue.zoom;if(Le.minzoom&&Le.minzoom>Ct)continue;let Ot=0;if(!Hr){let Oe=_i?Ue.aabb.intersectsPrecise(Gn):Ue.aabb.intersectsPreciseFlat(Gn);if(0===Oe&&d()){const Le=new Re.bP(Ue.zoom,qe,Jt);Oe=Re.bQ(this,Jr,Le,!0).intersectsPrecise(Gn)}if(0===Oe)continue;if(Le.calculateQuadrantVisibility)if(Gn.containsPoint(Ue.aabb.center))Ot=15;else for(let Re=0;Re<4;Re++)0!==Ue.aabb.quadrant(Re).intersects(Gn)&&(Ot|=1<<Re)}const Nn=Ln[0]-(.5+qe+(Ue.wrap<<Ue.zoom))*(1<<Oe-Ue.zoom),$n=Ln[1]-.5-Jt,qn=Ue.tileID?Ue.tileID:new Re.aA(Ct,Ue.wrap,Ue.zoom,qe,Jt);Le.calculateQuadrantVisibility&&(qn.visibleQuadrants=Ot),po.push({tileID:qn,distanceSq:Nn*Nn+$n*$n})}}if(this.fogCullDistSq){const Oe=this.fogCullDistSq,Ue=this.horizonLineFromTop();po=po.filter((qe=>{const Ct=[0,0,0,1],Ot=[Re.ab,Re.ab,0,1],Jt=this.calculateFogTileMatrix(qe.tileID.toUnwrapped());Re.a6.vec4.transformMat4(Ct,Ct,Jt),Re.a6.vec4.transformMat4(Ot,Ot,Jt);const Hr=Re.a6.vec4.min([],Ct,Ot),Jr=Re.a6.vec4.max([],Ct,Ot),Ln=Re.bS(Hr,Jr);if(0===Ln)return!0;let Nn=!1;const $n=this._elevation;if($n&&Ln>Oe&&0!==Ue){const Oe=this.calculateProjMatrix(qe.tileID.toUnwrapped());let Ct;Le.isTerrainDEM||(Ct=$n.getMinMaxForTile(qe.tileID)),Ct||(Ct={min:Pi,max:bi});const Ot=Re.c3(this.rotation),Jt=[Ot[0]*Re.ab,Ot[1]*Re.ab,Ct.max];Re.a6.vec3.transformMat4(Jt,Jt,Oe),Nn=(1-Jt[1])*this.height*.5<Ue}return Ln<Oe||Nn}))}return po.sort(((Re,Le)=>Re.distanceSq-Le.distanceSq)).map((Re=>Re.tileID))}resize(Re,Le){this.width=Re,this.height=Le,this.pixelsToGLUnits=[2/Re,-2/Le],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(Re){return Math.pow(2,Re)}scaleZoom(Re){return Math.log(Re)/Math.LN2}project(Le){const Oe=Re.ap(Le.lat,-Re.bT,Re.bT),Ue=this.projection.project(Le.lng,Oe);return new Re.P(Ue.x*this.worldSize,Ue.y*this.worldSize)}unproject(Re){return this.projection.unproject(Re.x/this.worldSize,Re.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/Re.bD(1,this.center.lat)/this.worldSize}setLocationAtPoint(Le,Oe){let Ue,qe;const Ct=this.centerPoint;if("globe"===this.projection.name){const Re=this.worldSize;Ue=(Oe.x-Ct.x)/Re,qe=(Oe.y-Ct.y)/Re}else{const Re=this.pointCoordinate(Oe),Le=this.pointCoordinate(Ct);Ue=Re.x-Le.x,qe=Re.y-Le.y}const Ot=this.locationCoordinate(Le);this.setLocation(new Re.a5(Ot.x-Ue,Ot.y-qe))}setLocation(Re){this.center=this.coordinateLocation(Re),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(Re){return this.projection.locationPoint(this,Re)}locationPoint3D(Re){return this.projection.locationPoint(this,Re,!0)}pointLocation(Re){return this.coordinateLocation(this.pointCoordinate(Re))}pointLocation3D(Re){return this.coordinateLocation(this.pointCoordinate3D(Re))}locationCoordinate(Le,Oe){const Ue=Oe?Re.bD(Oe,Le.lat):void 0,qe=this.projection.project(Le.lng,Le.lat);return new Re.a5(qe.x,qe.y,Ue)}coordinateLocation(Re){return this.projection.unproject(Re.x,Re.y)}pointRayIntersection(Le,Oe){const Ue=null!=Oe?Oe:this._centerAltitude,qe=[Le.x,Le.y,0,1],Ct=[Le.x,Le.y,1,1];Re.a6.vec4.transformMat4(qe,qe,this.pixelMatrixInverse),Re.a6.vec4.transformMat4(Ct,Ct,this.pixelMatrixInverse);const Ot=Ct[3];Re.a6.vec4.scale(qe,qe,1/qe[3]),Re.a6.vec4.scale(Ct,Ct,1/Ot);const Jt=qe[2],Hr=Ct[2];return{p0:qe,p1:Ct,t:Jt===Hr?0:(Ue-Jt)/(Hr-Jt)}}screenPointToMercatorRay(Le){const Oe=[Le.x,Le.y,0,1],Ue=[Le.x,Le.y,1,1];return Re.a6.vec4.transformMat4(Oe,Oe,this.pixelMatrixInverse),Re.a6.vec4.transformMat4(Ue,Ue,this.pixelMatrixInverse),Re.a6.vec4.scale(Oe,Oe,1/Oe[3]),Re.a6.vec4.scale(Ue,Ue,1/Ue[3]),Oe[2]=Re.bD(Oe[2],this._center.lat)*this.worldSize,Ue[2]=Re.bD(Ue[2],this._center.lat)*this.worldSize,Re.a6.vec4.scale(Oe,Oe,1/this.worldSize),Re.a6.vec4.scale(Ue,Ue,1/this.worldSize),new Re.aj([Oe[0],Oe[1],Oe[2]],Re.a6.vec3.normalize([],Re.a6.vec3.sub([],Ue,Oe)))}rayIntersectionCoordinate(Le){const{p0:Oe,p1:Ue,t:qe}=Le,Ct=Re.bD(Oe[2],this._center.lat),Ot=Re.bD(Ue[2],this._center.lat);return new Re.a5(Re.aa(Oe[0],Ue[0],qe)/this.worldSize,Re.aa(Oe[1],Ue[1],qe)/this.worldSize,Re.aa(Ct,Ot,qe))}pointCoordinate(Re,Le=this._centerAltitude){return this.projection.pointCoordinate(this,Re.x,Re.y,Le)}pointCoordinate3D(Le){if(!this.elevation)return this.pointCoordinate(Le);let Oe=this.projection.pointCoordinate3D(this,Le.x,Le.y);if(Oe)return new Re.a5(Oe[0],Oe[1],Oe[2]);let Ue=0,qe=this.horizonLineFromTop();if(Le.y>qe)return this.pointCoordinate(Le);const Ct=.02*qe,Ot=Le.clone();for(let Le=0;Le<10&&qe-Ue>Ct;Le++){Ot.y=Re.aa(Ue,qe,.66);const Le=this.projection.pointCoordinate3D(this,Ot.x,Ot.y);Le?(qe=Ot.y,Oe=Le):Ue=Ot.y}return Oe?new Re.a5(Oe[0],Oe[1],Oe[2]):this.pointCoordinate(Le)}isPointAboveHorizon(Re){return this.projection.isPointAboveHorizon(this,Re)}isPointOnSurface(Le){if(Le.y<0||Le.y>this.height||Le.x<0||Le.x>this.width)return!1;if(this.elevation||this.zoom>=Re.bU)return!this.isPointAboveHorizon(Le);const Oe=this.pointCoordinate(Le);return Oe.y>=0&&Oe.y<=1}_coordinatePoint(Le,Oe){const Ue=Oe&&this.elevation?this.elevation.getAtPointOrZero(Le,this._centerAltitude):this._centerAltitude,qe=[Le.x*this.worldSize,Le.y*this.worldSize,Ue+Le.toAltitude(),1];return Re.a6.vec4.transformMat4(qe,qe,this.pixelMatrix),qe[3]>0?new Re.P(qe[0]/qe[3],qe[1]/qe[3]):new Re.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:Le,left:Oe}=this._edgeInsets,Ue=this.height-this._edgeInsets.bottom,qe=this.width-this._edgeInsets.right,Ct=this.pointLocation3D(new Re.P(Oe,Le)),Ot=this.pointLocation3D(new Re.P(qe,Le)),Jt=this.pointLocation3D(new Re.P(qe,Ue)),Hr=this.pointLocation3D(new Re.P(Oe,Ue));let Jr=Math.min(Ct.lng,Ot.lng,Jt.lng,Hr.lng),Ln=Math.max(Ct.lng,Ot.lng,Jt.lng,Hr.lng),Nn=Math.min(Ct.lat,Ot.lat,Jt.lat,Hr.lat),$n=Math.max(Ct.lat,Ot.lat,Jt.lat,Hr.lat);const Gn=Math.pow(2,-this.zoom)/16*270,qn="globe"===this.projection.name?1:4,m=(Le,Oe,Ue,qe,Ct)=>{const Ot=(Le+Ue)/2,Jt=(Oe+qe)/2,Hr=new Re.P(Ot,Jt),{lng:Zn,lat:Xn}=this.pointLocation3D(Hr),Yn=Math.max(0,Jr-Zn,Nn-Xn,Zn-Ln,Xn-$n);Jr=Math.min(Jr,Zn),Ln=Math.max(Ln,Zn),Nn=Math.min(Nn,Xn),$n=Math.max($n,Xn),(Ct<qn||Yn>Gn)&&(m(Le,Oe,Ot,Jt,Ct+1),m(Ot,Jt,Ue,qe,Ct+1))};if(m(Oe,Le,qe,Le,1),m(qe,Le,qe,Ue,1),m(qe,Ue,Oe,Ue,1),m(Oe,Ue,Oe,Le,1),"globe"===this.projection.name){const[Le,Oe]=Re.bV(this);Le?($n=90,Ln=180,Jr=-180):Oe&&(Nn=-90,Ln=180,Jr=-180)}return new Re.as(new Re.bK(Jr,Nn),new Re.bK(Ln,$n))}_getBoundsRectangular(Le,Oe){const{top:Ue,left:qe}=this._edgeInsets,Ct=this.height-this._edgeInsets.bottom,Ot=this.width-this._edgeInsets.right,Jt=new Re.P(qe,Ue),Hr=new Re.P(Ot,Ue),Jr=new Re.P(Ot,Ct),Ln=new Re.P(qe,Ct);let Nn=this.pointCoordinate(Jt,Le),$n=this.pointCoordinate(Hr,Le);const Gn=this.pointCoordinate(Jr,Oe),qn=this.pointCoordinate(Ln,Oe),m=(Re,Le)=>(Le.y-Re.y)/(Le.x-Re.x);return Nn.y>1&&$n.y>=0?Nn=new Re.a5((1-qn.y)/m(qn,Nn)+qn.x,1):Nn.y<0&&$n.y<=1&&(Nn=new Re.a5(-qn.y/m(qn,Nn)+qn.x,0)),$n.y>1&&Nn.y>=0?$n=new Re.a5((1-Gn.y)/m(Gn,$n)+Gn.x,1):$n.y<0&&Nn.y<=1&&($n=new Re.a5(-Gn.y/m(Gn,$n)+Gn.x,0)),(new Re.as).extend(this.coordinateLocation(Nn)).extend(this.coordinateLocation($n)).extend(this.coordinateLocation(qn)).extend(this.coordinateLocation(Gn))}_getBoundsRectangularTerrain(){const Re=this.elevation;if(!Re.visibleDemTiles.length||Re.isUsingMockSource())return this._getBoundsRectangular(0,0);const Le=Re.visibleDemTiles.reduce(((Re,Le)=>{if(Le.dem){const Oe=Le.dem.tree;Re.min=Math.min(Re.min,Oe.minimums[0]),Re.max=Math.max(Re.max,Oe.maximums[0])}return Re}),{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(Le.min*Re.exaggeration(),Le.max*Re.exaggeration())}getBounds(){return"mercator"===this.projection.name||"equirectangular"===this.projection.name?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(Re=!0){const Le=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,Oe=this.height/2-Le*(1-this._horizonShift);return Re?Math.max(0,Oe):Oe}getMaxBounds(){return this.maxBounds}setMaxBounds(Le){this.maxBounds=Le,this.minLat=-Re.bT,this.maxLat=Re.bT,this.minLng=-180,this.maxLng=180,Le&&(this.minLat=Le.getSouth(),this.maxLat=Le.getNorth(),this.minLng=Le.getWest(),this.maxLng=Le.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=Re.am(this.minLng)*this.tileSize,this.worldMaxX=Re.am(this.maxLng)*this.tileSize,this.worldMinY=Re.at(this.maxLat)*this.tileSize,this.worldMaxY=Re.at(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(Re,Le){return this.projection.createTileMatrix(this,Le,Re)}calculateDistanceTileData(Le){const Oe=Le.key,Ue=this._distanceTileDataCache;if(Ue[Oe])return Ue[Oe];const qe=Le.canonical,Ct=1/this.height,Ot=this.cameraWorldSize,Jt=Ot/this.zoomScale(qe.z),Hr=(qe.x+Math.pow(2,qe.z)*Le.wrap)*Jt,Jr=qe.y*Jt,Ln=this.point;Ln.x*=Ot/this.worldSize,Ln.y*=Ot/this.worldSize;const Nn=this.angle,$n=Math.sin(-Nn),Gn=-Math.cos(-Nn);return Ue[Oe]={bearing:[$n,Gn],center:[(Ln.x-Hr)*Ct,(Ln.y-Jr)*Ct],scale:Jt/Re.ab*Ct},Ue[Oe]}calculateFogTileMatrix(Le){const Oe=Le.key,Ue=this._fogTileMatrixCache;if(Ue[Oe])return Ue[Oe];const qe=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,Le);return Re.a6.mat4.multiply(qe,this.worldToFogMatrix,qe),Ue[Oe]=new Float32Array(qe),Ue[Oe]}calculateProjMatrix(Le,Oe=!1,Ue=!1){const qe=Le.key;let Ct;if(Ct=Ue?this._expandedProjMatrixCache:Oe?this._alignedProjMatrixCache:this._projMatrixCache,Ct[qe])return Ct[qe];const Ot=this.calculatePosMatrix(Le,this.worldSize);let Jt;return Jt=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:Ue?this.expandedFarZProjMatrix:Oe?this.alignedProjMatrix:this.projMatrix,Re.a6.mat4.multiply(Ot,Jt,Ot),Ct[qe]=new Float32Array(Ot),Ct[qe]}calculatePixelsToTileUnitsMatrix(Le){const Oe=Le.tileID.key,Ue=this._pixelsToTileUnitsCache;if(Ue[Oe])return Ue[Oe];const qe=Re.bW(Le,this);return Ue[Oe]=qe,Ue[Oe]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if("globe"===this.projection.name){const Le=1/this.worldSize,Oe=Re.a6.mat4.fromScaling([],[Le,Le,Le]);return Re.a6.mat4.multiply(Oe,Oe,this.globeMatrix),Oe}}recenterOnTerrain(){if(!this._elevation||"globe"===this.projection.name)return;const Le=this._elevation;this._updateCameraState();const Oe=Re.bD(1,this._center.lat)*this.worldSize,Ue=this._computeCameraPosition(Oe),qe=this._camera.forward(),Ct=Re.bD(1,this._center.lat);Ue[2]/=Ct,qe[2]/=Ct,Re.a6.vec3.normalize(qe,qe);const Ot=Le.raycast(Ue,qe,Le.exaggeration());if(Ot){const Le=Re.a6.vec3.scaleAndAdd([],Ue,qe,Ot),Oe=new Re.a5(Le[0],Le[1],Re.bD(Le[2],Re.aM(Le[1]))),Jt=(Oe.z+Re.a6.vec3.length([Oe.x-Ue[0],Oe.y-Ue[1],Oe.z-Ue[2]*Ct]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(Jt),this._centerAltitude=Oe.toAltitude(),this._center=this.coordinateLocation(Oe),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(Le=!1){if(!this._elevation)return;const Oe=this._elevation,Ue=Re.bD(1,this._center.lat)*this.worldSize,qe=this._computeCameraPosition(Ue),Ct=Oe.getAtPointOrZero(new Re.a5(...qe)),Ot=this.pixelsPerMeter/this.worldSize*Ct,Jt=this._minimumHeightOverTerrain(),Hr=qe[2]-Ot;if(Hr<=Jt)if(Hr<0||Le){const Le=this.locationCoordinate(this._center,this._centerAltitude),Oe=[qe[0],qe[1],Le.z-qe[2]],Ue=Re.a6.vec3.length(Oe);Oe[2]-=(Jt-Hr)/this._pixelsPerMercatorPixel;const Ct=Re.a6.vec3.length(Oe);if(0===Ct)return;Re.a6.vec3.scale(Oe,Oe,Ue/Ct*this._pixelsPerMercatorPixel),this._camera.position=[qe[0],qe[1],Le.z*this._pixelsPerMercatorPixel-Oe[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const Le="globe"===this.projection.name||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||Le){const Oe=this.center;return Oe.lat=Re.ap(Oe.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!Le)&&(Oe.lng=Re.ap(Oe.lng,this.minLng,this.maxLng)),this.center=Oe,void(this._constraining=!1)}const Oe=this._unmodified,{x:Ue,y:qe}=this.point;let Ct=0,Ot=Ue,Jt=qe;const Hr=this.width/2,Jr=this.height/2,Ln=this.worldMinY*this.scale,Nn=this.worldMaxY*this.scale;if(qe-Jr<Ln&&(Jt=Ln+Jr),qe+Jr>Nn&&(Jt=Nn-Jr),Nn-Ln<this.height&&(Ct=Math.max(Ct,this.height/(Nn-Ln)),Jt=(Nn+Ln)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const Re=this.worldMinX*this.scale,Le=this.worldMaxX*this.scale,Oe=this.worldSize/2-(Re+Le)/2;Ot=(Ue+Oe+this.worldSize)%this.worldSize-Oe,Ot-Hr<Re&&(Ot=Re+Hr),Ot+Hr>Le&&(Ot=Le-Hr),Le-Re<this.width&&(Ct=Math.max(Ct,this.width/(Le-Re)),Ot=(Le+Re)/2)}Ot===Ue&&Jt===qe||(this.center=this.unproject(new Re.P(Ot,Jt))),Ct&&(this.zoom+=this.scaleZoom(Ct)),this._constrainCamera(),this._unmodified=Oe,this._constraining=!1}_minZoomForBounds(){let Re=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(Re=Math.max(Re,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),Re}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const Le=this.centerOffset,Oe="globe"===this.projection.name,Ue=this.pixelsPerMeter;"globe"===this.projection.name&&(this._mercatorScaleRatio=Re.bD(1,this.center.lat)/Re.bD(1,Re.c4));const qe=Re.bX(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,qe),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const Ct="meters"===this.projection.zAxisUnit?Ue:1,Ot=this._camera.getWorldToCamera(this.worldSize,Ct);let Jt;const Hr=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(Hr[8]=2*-Le.x/this.width,Hr[9]=2*Le.y/this.height,this.isOrthographic){let Re=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),Oe=Re*this.aspect,Ue=-Oe,qe=-Re;Oe-=Le.x,Ue-=Le.x,Re+=Le.y,qe+=Le.y,Jt=this._camera.getCameraToClipOrthographic(Ue,Oe,qe,Re,this._nearZ,this._farZ),((Re,Le,Oe,Ue)=>{for(let qe=0;qe<16;qe++)Re[qe]=qi(Le[qe],Oe[qe],Ue)})(Jt,Jt,Hr,Zi(this.pitch>=15?1:this.pitch/15))}else Jt=Hr;const Jr=Re.a6.mat4.mul([],Hr,Ot);let Ln=Re.a6.mat4.mul([],Jt,Ot);if(this.projection.isReprojectedInTileSpace){const Le=this.locationCoordinate(this.center),Oe=Re.a6.mat4.identity([]);Re.a6.mat4.translate(Oe,Oe,[Le.x*this.worldSize,Le.y*this.worldSize,0]),Re.a6.mat4.multiply(Oe,Oe,Re.bY(this)),Re.a6.mat4.translate(Oe,Oe,[-Le.x*this.worldSize,-Le.y*this.worldSize,0]),Re.a6.mat4.multiply(Ln,Ln,Oe),Re.a6.mat4.multiply(Jr,Jr,Oe),this.inverseAdjustmentMatrix=Re.bZ(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=Re.a6.mat4.scale([],Ln,[this.worldSize,this.worldSize,this.worldSize/Ct,1]),this.projMatrix=Ln,this.invProjMatrix=Re.a6.mat4.invert(new Float64Array(16),this.projMatrix),Oe){const Oe=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);Oe[8]=2*-Le.x/this.width,Oe[9]=2*Le.y/this.height,this.expandedFarZProjMatrix=Re.a6.mat4.mul([],Oe,Ot)}else this.expandedFarZProjMatrix=this.projMatrix;const Nn=Re.a6.mat4.invert([],Jt);this.frustumCorners=Re.b_.fromInvProjectionMatrix(Nn,this.horizonLineFromTop(),this.height),this.cameraFrustum=Re.bN.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!Oe);const $n=new Float32Array(16);Re.a6.mat4.identity($n),Re.a6.mat4.scale($n,$n,[1,-1,1]),Re.a6.mat4.rotateX($n,$n,this._pitch),Re.a6.mat4.rotateZ($n,$n,this.angle);const Gn=Re.a6.mat4.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=Re.a6.mat4.clone(Gn);const qn=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;Gn[8]=2*-Le.x/this.width,Gn[9]=2*(Le.y+qn)/this.height,this.skyboxMatrix=Re.a6.mat4.multiply($n,Gn,$n);const Zn=this.point,Xn=Zn.x,Yn=Zn.y,_i=this.width%2/2,vi=this.height%2/2,xi=Math.cos(this.angle),bi=Math.sin(this.angle),Pi=Xn-Math.round(Xn)+xi*_i+bi*vi,lo=Yn-Math.round(Yn)+xi*vi+bi*_i,uo=new Float64Array(Ln);if(Re.a6.mat4.translate(uo,uo,[Pi>.5?Pi-1:Pi,lo>.5?lo-1:lo,0]),this.alignedProjMatrix=uo,Ln=Re.a6.mat4.create(),Re.a6.mat4.scale(Ln,Ln,[this.width/2,-this.height/2,1]),Re.a6.mat4.translate(Ln,Ln,[1,-1,0]),this.labelPlaneMatrix=Ln,Ln=Re.a6.mat4.create(),Re.a6.mat4.scale(Ln,Ln,[1,-1,1]),Re.a6.mat4.translate(Ln,Ln,[-1,-1,0]),Re.a6.mat4.scale(Ln,Ln,[2/this.width,2/this.height,1]),this.glCoordMatrix=Ln,this.pixelMatrix=Re.a6.mat4.multiply(new Float64Array(16),this.labelPlaneMatrix,Jr),this._calcFogMatrices(),this._distanceTileDataCache={},Ln=Re.a6.mat4.invert(new Float64Array(16),this.pixelMatrix),!Ln)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=Ln,"globe"===this.projection.name||this.mercatorFromTransition){this.globeMatrix=Re.b$(this);const Le=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=Re.a6.vec3.transformMat4(Le,Le,Ot),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=Ln;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const Le=this.cameraWorldSizeForFog,Oe=this.cameraPixelsPerMeter,Ue=this._camera.position,qe=1/this.height/this._pixelsPerMercatorPixel,Ct=[Le,Le,Oe];Re.a6.vec3.scale(Ct,Ct,qe),Re.a6.vec3.scale(Ue,Ue,-1),Re.a6.vec3.multiply(Ue,Ue,Ct);const Ot=Re.a6.mat4.create();Re.a6.mat4.translate(Ot,Ot,Ue),Re.a6.mat4.scale(Ot,Ot,Ct),this.mercatorFogMatrix=Ot,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(Le,Oe,qe)}_computeCameraPosition(Re){const Le=(Re=Re||this.pixelsPerMeter)/this.pixelsPerMeter,Oe=this._camera.forward(),Ue=this.point,qe=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*Le-Re/this.worldSize*this._centerAltitude;return[Ue.x/this.worldSize-Oe[0]*qe,Ue.y/this.worldSize-Oe[1]*qe,Re/this.worldSize*this._centerAltitude-Oe[2]*qe]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(Le){const Oe=this._maxCameraBoundsDistance()*Math.cos(this._pitch),Ue=this._camera.position[2],qe=Le[2];let Ct=1;this.projection.wrap&&(this.center=this.center.wrap()),qe>0&&(Ct=Math.min((Oe-Ue)/qe,1)),this._camera.position=Re.a6.vec3.scaleAndAdd([],this._camera.position,Le,Ct),this._updateStateFromCamera()}_updateStateFromCamera(){const Le=this._camera.position,Oe=this._camera.forward(),{pitch:Ue,bearing:qe}=this._camera.getPitchBearing(),Ct=Re.bD(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,Ot=this._mercatorZfromZoom(this._maxZoom)*Math.cos(Re.bB(this._maxPitch)),Jt=Math.max((Le[2]-Ct)/Math.cos(Ue),Ot),Hr=this._zoomFromMercatorZ(Jt);Re.a6.vec3.scaleAndAdd(Le,Le,Oe,Jt),this._pitch=Re.ap(Ue,Re.bB(this.minPitch),Re.bB(this.maxPitch)),this.angle=Re.bA(qe,-Math.PI,Math.PI),this._setZoom(Re.ap(Hr,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new Re.a5(Le[0],Le[1],Le[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(Re){return Math.pow(2,Re)*this.tileSize}_mercatorZfromZoom(Re){return this.cameraToCenterDistance/this._worldSizeFromZoom(Re)}_minimumHeightOverTerrain(){const Re=Math.min(null!=this._seaLevelZoom?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(Re)}_zoomFromMercatorZ(Re){return this.scaleZoom(this.cameraToCenterDistance/(Re*this.tileSize))}zoomFromMercatorZAdjusted(Le){let Oe=0,Ue=Re.bU,qe=0,Ct=1/0;for(;Ue-Oe>1e-6&&Ue>Oe;){const Re=Oe+.5*(Ue-Oe),Ot=this.tileSize*Math.pow(2,Re),Jt=this.getCameraToCenterDistance(this.projection,Re,Ot),Hr=this.scaleZoom(Jt/(Le*this.tileSize)),Jr=Math.abs(Re-Hr);Jr<Ct&&(Ct=Jr,qe=Re),Re<Hr?Oe=Re:Ue=Re}return qe}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(Re.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(Le,Oe){const Ue=Math.min(Le.x,Oe.x),qe=Math.max(Le.x,Oe.x),Ct=Math.min(Le.y,Oe.y),Ot=Math.max(Le.y,Oe.y);if(Ct<this.horizonLineFromTop(!1))return!0;if("mercator"!==this.projection.name)return!1;const Jt=[new Re.P(Ue,Ct),new Re.P(qe,Ot),new Re.P(Ue,Ot),new Re.P(qe,Ct)],Hr=this.renderWorldCopies?-3:0,Jr=this.renderWorldCopies?4:1;for(const Re of Jt){const Le=this.pointRayIntersection(Re);if(Le.t<0)return!0;const Oe=this.rayIntersectionCoordinate(Le);if(Oe.x<Hr||Oe.y<0||Oe.x>Jr||Oe.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+Re.c0(this.fovAboveCenter)>88||this.anyCornerOffEdge(new Re.P(0,0),new Re.P(this.width,this.height))}zoomDeltaToMovement(Le,Oe){const Ue=Re.a6.vec3.length(Re.a6.vec3.sub([],this._camera.position,Le)),qe=this._zoomFromMercatorZ(Ue)+Oe;return Ue-this._mercatorZfromZoom(qe)}getCameraPoint(){if("globe"===this.projection.name){const Le=function([Le,Oe,Ue],qe){const Ct=[Le,Oe,Ue,1];Re.a6.vec4.transformMat4(Ct,Ct,qe);const Ot=Ct[3]=Math.max(Ct[3],1e-6);return Ct[0]/=Ot,Ct[1]/=Ot,Ct[2]/=Ot,Ct}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new Re.P(Le[0],Le[1])}{const Le=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new Re.P(0,Le))}}getCameraToCenterDistance(Le,Oe=this.zoom,Ue=this.worldSize){const qe=Re.bX(Le,Oe,this.width,this.height,1024),Ct=Le.pixelSpaceConversion(this.center.lat,Ue,qe);let Ot=.5/Math.tan(.5*this._fov)*this.height*Ct;return this.isOrthographic&&(Ot=qi(1,Ot,Zi(this.pitch>=15?1:this.pitch/15))),Ot}getWorldToCameraMatrix(){const Le=this._camera.getWorldToCamera(this.worldSize,"meters"===this.projection.zAxisUnit?this.pixelsPerMeter:1);return"globe"===this.projection.name&&Re.a6.mat4.multiply(Le,Le,this.globeMatrix),Le}getFrustum(Le){return Re.bN.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,Le,"meters"===this.projection.zAxisUnit)}}const Wi=(Le,Oe)=>{if(Oe>0&&Le.terrain&&Re.w("Cutoff is currently disabled on terrain"),Oe<=0||Le.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const Ue=Le.transform,qe=Math.max(Math.abs(Ue._zoom-(Le.minCutoffZoom-1)),1),Ct=Ue.isLODDisabled(!1)?Re.a7(60,45,Ue.pitch):Re.a7(30,15,Ue.pitch),Ot=Ue._farZ-Ue._nearZ,Jt=Oe*Ue.height,Hr=((1-(Jr=Ct))*Ue.cameraToCenterDistance+Jr*(Ue._farZ+Jt))*qe;var Jr;return{shouldRenderCutoff:Ct<1,uniformValues:{u_cutoff_params:[Ue._nearZ,Ue._farZ,(Hr-Ue._nearZ)/Ot,(Hr-Jt-Ue._nearZ)/Ot]}}},su={cascadeCount:2,normalOffset:3,shadowMapResolution:2048};class Xi{constructor(Re,Le){this.aabb=Re,this.lastCascade=Le}}class Yi{add(Re,Le){const Oe=this.receivers[Re.key];void 0!==Oe?(Oe.aabb.min[0]=Math.min(Oe.aabb.min[0],Le.min[0]),Oe.aabb.min[1]=Math.min(Oe.aabb.min[1],Le.min[1]),Oe.aabb.min[2]=Math.min(Oe.aabb.min[2],Le.min[2]),Oe.aabb.max[0]=Math.max(Oe.aabb.max[0],Le.max[0]),Oe.aabb.max[1]=Math.max(Oe.aabb.max[1],Le.max[1]),Oe.aabb.max[2]=Math.max(Oe.aabb.max[2],Le.max[2])):this.receivers[Re.key]=new Xi(Le,null)}clear(){this.receivers={}}get(Re){return this.receivers[Re.key]}computeRequiredCascades(Le,Oe,Ue){const qe=Re.c9.fromPoints(Le.points);let Ct=0;for(const Le in this.receivers){const Ot=this.receivers[Le];if(!Ot)continue;if(!qe.intersectsAabb(Ot.aabb))continue;Ot.aabb.min=qe.closestPoint(Ot.aabb.min),Ot.aabb.max=qe.closestPoint(Ot.aabb.max);const Jt=Ot.aabb.getCorners();for(let Le=0;Le<Ue.length;Le++){let qe=!0;for(const Ct of Jt){const Ot=[Ct[0]*Oe,Ct[1]*Oe,Ct[2]];if(Re.a6.vec3.transformMat4(Ot,Ot,Ue[Le].matrix),Ot[0]<-1||Ot[0]>1||Ot[1]<-1||Ot[1]>1){qe=!1;break}}if(Ot.lastCascade=Le,Ct=Math.max(Ct,Le),qe)break}}return Ct+1}}class Ki{constructor(Re){this.painter=Re,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new Yi,this._depthMode=new Li(Re.context.gl.LEQUAL,Li.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,Re.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},(()=>{this.painter.style.map.triggerRepaint()})),Re.tp.registerParameter(su,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),Re.tp.registerParameter(su,["Shadows"],"normalOffset",{min:0,max:10,step:.05}),Re.tp.registerParameter(su,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),Re.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const Re of this._cascades)Re.texture.destroy(),Re.framebuffer.destroy();this._cascades=[]}updateShadowParameters(Le,Oe){const Ue=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!Oe||!Oe.properties)return;const qe=Oe.properties.get("shadow-intensity");if(!Oe.shadowsEnabled()||qe<=0)return;if(this._shadowLayerCount=Ue.style.order.reduce(((Re,Oe)=>{const qe=Ue.style._mergedLayers[Oe];return Re+(qe.hasShadowPass()&&!qe.isHidden(Le.zoom)?1:0)}),0),this._enabled=this._shadowLayerCount>0,!this.enabled)return;const Ct=Ue.context,Ot=su.shadowMapResolution,Jt=su.shadowMapResolution;if(0===this._cascades.length||su.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let Le=0;Le<su.cascadeCount;++Le){const Le=Ue._shadowMapDebug,Oe=Ct.gl,qe=Ct.createFramebuffer(Ot,Jt,Le,"texture"),Hr=new Re.T(Ct,{width:Ot,height:Jt,data:null},Oe.DEPTH_COMPONENT16);if(qe.depthAttachment.set(Hr.texture),Le){const Le=new Re.T(Ct,{width:Ot,height:Jt,data:null},Oe.RGBA8);qe.colorAttachment.set(Le.texture)}this._cascades.push({framebuffer:qe,texture:Hr,matrix:[],far:0,boundingSphereRadius:0,frustum:new Re.bN,scale:0})}}this.shadowDirection=Qi(Oe);let Hr=0;if(Le.elevation){const Re=Le.elevation,Oe=[1e4,-1e4];Re.visibleDemTiles.filter((Re=>Re.dem)).forEach((Re=>{const Le=Re.dem.tree;Oe[0]=Math.min(Oe[0],Le.minimums[0]),Oe[1]=Math.max(Oe[1],Le.maximums[0])})),1e4!==Oe[0]&&(Hr=(Oe[1]-Oe[0])*Re.exaggeration())}const Jr=1.5*Le.cameraToCenterDistance,Ln=3*Jr,Nn=new Float64Array(16);for(let Oe=0;Oe<this._cascades.length;++Oe){const Ue=this._cascades[Oe];let qe=Le.height/50,Ct=1;1===su.cascadeCount?Ct=Ln:0===Oe?Ct=Jr:(qe=Jr,Ct=Ln);const[Ot,Jt]=to(Le,this.shadowDirection,qe,Ct,su.shadowMapResolution,Hr);Ue.scale=Le.scale,Ue.matrix=Ot,Ue.boundingSphereRadius=Jt,Re.a6.mat4.invert(Nn,Ue.matrix),Ue.frustum=Re.bN.fromInvProjectionMatrix(Nn,1,0,!0),Ue.far=Ct}const $n=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[$n].far,this._cascades[$n].far],this._uniformValues.u_shadow_intensity=qe,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/su.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=su.shadowMapResolution,this._uniformValues.u_shadowmap_0=ou.ShadowMap0,this._uniformValues.u_shadowmap_1=ou.ShadowMap0+1,this._groundShadowTiles=Ue.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const Gn=Ue.transform.elevation;for(const Re of this._groundShadowTiles){let Le={min:0,max:0};if(Gn){const Oe=Gn.getMinMaxForTile(Re);Oe&&(Le=Oe)}this.addShadowReceiver(Re.toUnwrapped(),Le.min,Le.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(Re){this._enabled=Re}drawShadowPass(Le,Oe){if(!this.enabled)return;const Ue=this.painter,qe=Ue.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(Ue.transform.getFrustum(0),Ue.transform.worldSize,this._cascades),qe.viewport.set([0,0,su.shadowMapResolution,su.shadowMapResolution]);for(let Ct=0;Ct<this._numCascadesToRender;++Ct){Ue.currentShadowCascade=Ct,qe.bindFramebuffer.set(this._cascades[Ct].framebuffer.framebuffer),qe.clear({color:Re.bz.white,depth:1});for(const Re of Le.order){const qe=Le._mergedLayers[Re];if(!qe.hasShadowPass()||qe.isHidden(Ue.transform.zoom))continue;const Ct=Le.getLayerSourceCache(qe),Ot=Ct?Oe[Ct.id]:void 0;("model"===qe.type||Ot&&Ot.length)&&Ue.renderLayer(Ue,Ct,qe,Ot)}}Ue.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const Re=this.painter,Le=Re.style,Oe=Re.context,Ue=Le.directionalLight,qe=Le.ambientLight;if(!Ue||!qe)return;const Ct=[],Ot=Wi(Re,Re.longestCutoffRange);Ot.shouldRenderCutoff&&Ct.push("RENDER_CUTOFF");const Jt=eo(Le,Ue,qe),Hr=new Li(Oe.gl.LEQUAL,Li.ReadOnly,Re.depthRangeFor3D);for(const Le of this._groundShadowTiles){const Ue=Le.toUnwrapped(),qe=Re.isTileAffectedByFog(Le),Jr=Re.getOrCreateProgram("groundShadow",{defines:Ct,overrideFog:qe});this.setupShadows(Ue,Jr),Re.uploadCommonUniforms(Oe,Jr,Ue,null,Ot);const Ln={u_matrix:Re.transform.calculateProjMatrix(Ue),u_ground_shadow_factor:Jt};Jr.draw(Re,Oe.gl.TRIANGLES,Hr,Mi.disabled,Ai.multiply,Fi.disabled,Ln,"ground_shadow",Re.tileExtentBuffer,Re.quadTriangleIndexBuffer,Re.tileExtentSegments,{},Re.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?Ai.unblended:Ai.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(Le){const Oe=this.painter.transform,Ue=Oe.calculatePosMatrix(Le,Oe.worldSize);return Re.a6.mat4.multiply(Ue,this._cascades[this.painter.currentShadowCascade].matrix,Ue),Float32Array.from(Ue)}calculateShadowPassMatrixFromMatrix(Le){return Re.a6.mat4.multiply(Le,this._cascades[this.painter.currentShadowCascade].matrix,Le),Float32Array.from(Le)}setupShadows(Le,Oe,Ue,qe=0){if(!this.enabled)return;const Ct=this.painter.transform,Ot=this.painter.context,Jt=Ot.gl,Hr=this._uniformValues,Jr=new Float64Array(16),Ln=Ct.calculatePosMatrix(Le,Ct.worldSize);for(let Le=0;Le<this._cascades.length;Le++)Re.a6.mat4.multiply(Jr,this._cascades[Le].matrix,Ln),Hr[0===Le?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(Jr),Ot.activeTexture.set(Jt.TEXTURE0+ou.ShadowMap0+Le),this._cascades[Le].texture.bind(Jt.NEAREST,Jt.CLAMP_TO_EDGE);if(this.useNormalOffset=!!Ue,this.useNormalOffset){const Oe=Re.c8(Le.canonical),Ot=2/Ct.tileSize*Re.ab/su.shadowMapResolution,Jt=Ot*this._cascades[0].boundingSphereRadius,Jr=Ot*this._cascades[this._cascades.length-1].boundingSphereRadius,Ln=("vector-tile"===Ue?1:3)/Math.pow(2,qe-Le.canonical.z-(1-Ct.zoom+Math.floor(Ct.zoom)));Hr.u_shadow_normal_offset=[Oe,Jt*Ln,Jr*Ln],Hr.u_shadow_bias=[6e-5,.0012,.012]}else Hr.u_shadow_bias=[36e-5,.0012,.012];Oe.setShadowUniformValues(Ot,Hr)}setupShadowsFromMatrix(Le,Oe,Ue=!1){if(!this.enabled)return;const qe=this.painter.context,Ct=qe.gl,Ot=this._uniformValues,Jt=new Float64Array(16);for(let Oe=0;Oe<su.cascadeCount;Oe++)Re.a6.mat4.multiply(Jt,this._cascades[Oe].matrix,Le),Ot[0===Oe?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(Jt),qe.activeTexture.set(Ct.TEXTURE0+ou.ShadowMap0+Oe),this._cascades[Oe].texture.bind(Ct.NEAREST,Ct.CLAMP_TO_EDGE);if(this.useNormalOffset=Ue,Ue){const Re=su.normalOffset;Ot.u_shadow_normal_offset=[1,Re,Re],Ot.u_shadow_bias=[6e-5,.0012,.012]}else Ot.u_shadow_bias=[36e-5,.0012,.012];Oe.setShadowUniformValues(qe,Ot)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(Le,Oe,Ue,qe){if(qe[2]>=0)return{};const Ct=function(Le,Oe,Ue){const qe=Ue/(1<<Le.canonical.z);return new Re.c9([Le.canonical.x*qe+Le.wrap*Ue,Le.canonical.y*qe+Le.wrap*Ue,0],[(Le.canonical.x+1)*qe+Le.wrap*Ue,(Le.canonical.y+1)*qe+Le.wrap*Ue,Oe])}(Le,Oe,Ue).getCorners(),Ot=Oe/-qe[2];qe[0]<0?(Re.a6.vec3.add(Ct[0],Ct[0],[qe[0]*Ot,0,0]),Re.a6.vec3.add(Ct[3],Ct[3],[qe[0]*Ot,0,0])):qe[0]>0&&(Re.a6.vec3.add(Ct[1],Ct[1],[qe[0]*Ot,0,0]),Re.a6.vec3.add(Ct[2],Ct[2],[qe[0]*Ot,0,0])),qe[1]<0?(Re.a6.vec3.add(Ct[0],Ct[0],[0,qe[1]*Ot,0]),Re.a6.vec3.add(Ct[1],Ct[1],[0,qe[1]*Ot,0])):qe[1]>0&&(Re.a6.vec3.add(Ct[2],Ct[2],[0,qe[1]*Ot,0]),Re.a6.vec3.add(Ct[3],Ct[3],[0,qe[1]*Ot,0]));const Jt={};return Jt.vertices=Ct,Jt.planes=[Ji(Ct[1],Ct[0],Ct[4]),Ji(Ct[2],Ct[1],Ct[5]),Ji(Ct[3],Ct[2],Ct[6]),Ji(Ct[0],Ct[3],Ct[7])],Jt}addShadowReceiver(Le,Oe,Ue){this._receivers.add(Le,Re.c9.fromTileIdAndHeight(Le,Oe,Ue))}getMaxCascadeForTile(Re){const Le=this._receivers.get(Re);return Le&&Le.lastCascade?Le.lastCascade:0}}function Ji(Le,Oe,Ue){const qe=Re.a6.vec3.sub([],Ue,Oe),Ct=Re.a6.vec3.sub([],Le,Oe),Ot=Re.a6.vec3.cross([],qe,Ct),Jt=Re.a6.vec3.length(Ot);return 0===Jt?[0,0,1,0]:(Re.a6.vec3.scale(Ot,Ot,1/Jt),[Ot[0],Ot[1],Ot[2],-Re.a6.vec3.dot(Ot,Oe)])}function Qi(Le){const Oe=Le.properties.get("direction"),Ue=Re.c7(Oe.x,Oe.y,Oe.z);Ue[2]=Re.ap(Ue[2],0,75);const qe=Re.ca([Ue[0],Ue[1],Ue[2]]);return Re.a6.vec3.fromValues(qe.x,qe.y,qe.z)}function eo(Le,Oe,Ue){const qe=Oe.properties.get("color"),Ct=Oe.properties.get("intensity"),Ot=Oe.properties.get("direction"),Jt=[Ot.x,Ot.y,Ot.z],Hr=Ue.properties.get("color"),Jr=Ue.properties.get("intensity"),Ln=Math.max(Re.a6.vec3.dot([0,0,1],Jt),0),Nn=[0,0,0];Re.a6.vec3.scale(Nn,Hr.toRenderColor(Le.getLut(Oe.scope)).toArray01Linear().slice(0,3),Jr);const $n=[0,0,0];return Re.a6.vec3.scale($n,qe.toRenderColor(Le.getLut(Ue.scope)).toArray01Linear().slice(0,3),Ln*Ct),Re.cb([Nn[0]>0?Nn[0]/(Nn[0]+$n[0]):0,Nn[1]>0?Nn[1]/(Nn[1]+$n[1]):0,Nn[2]>0?Nn[2]/(Nn[2]+$n[2]):0])}function to(Le,Oe,Ue,qe,Ct,Ot){const Jt=Le.zoom,Hr=Le.scale,Jr=Le.worldSize,Ln=1/Jr,Nn=Le.aspect,$n=Math.sqrt(1+Nn*Nn)*Math.tan(.5*Le.fovX),Gn=$n*$n,qn=qe-Ue,Zn=qe+Ue;let Xn,Yn;Gn>qn/Zn?(Xn=qe,Yn=qe*$n):(Xn=.5*Zn*(1+Gn),Yn=.5*Math.sqrt(qn*qn+2*(qe*qe+Ue*Ue)*Gn+Zn*Zn*Gn*Gn));const _i=Le.projection.pixelsPerMeter(Le.center.lat,Jr),vi=Le._camera.getCameraToWorldMercator(),xi=[0,0,-Xn*Ln];Re.a6.vec3.transformMat4(xi,xi,vi);let bi=Yn*Ln;const Pi=Le._edgeInsets;if(!(0===Pi.left&&0===Pi.top&&0===Pi.right&&0===Pi.bottom||Pi.left===Pi.right&&Pi.top===Pi.bottom)){const Oe=Le._camera.getWorldToCamera(Le.worldSize,"meters"===Le.projection.zAxisUnit?_i:1),Ct=Le._camera.getCameraToClipPerspective(Le._fov,Le.width/Le.height,Ue,qe);Ct[8]=2*-Le.centerOffset.x/Le.width,Ct[9]=2*Le.centerOffset.y/Le.height;const Ot=new Float64Array(16);Re.a6.mat4.mul(Ot,Ct,Oe);const Ln=new Float64Array(16);Re.a6.mat4.invert(Ln,Ot);const Nn=Re.bN.fromInvProjectionMatrix(Ln,Jr,Jt,!0);for(const Oe of Nn.points){const Ue=((lo=Oe)[0]/=Hr,lo[1]/=Hr,lo[2]=Re.bD(lo[2],Le._center.lat),lo);bi=Math.max(bi,Re.a6.vec3.len(Re.a6.vec3.subtract([],xi,Ue)))}}var lo;bi*=Ct/(Ct-1);const uo=Math.acos(Oe[2]),po=Math.atan2(-Oe[0],-Oe[1]),fo=new Gi;fo.position=xi,fo.setPitchBearing(uo,po);const Io=fo.getWorldToCamera(Jr,_i),is=bi*Jr,as=Math.min(Le._mercatorZfromZoom(17)*Jr*-2,-2*is),Is=fo.getCameraToClipOrthographic(-is,is,-is,is,as,(is+Ot*_i)/Oe[2]),Xs=new Float64Array(16);Re.a6.mat4.multiply(Xs,Is,Io);const ta=Re.a6.vec3.fromValues(Math.floor(1e6*xi[0])/1e6*Jr,Math.floor(1e6*xi[1])/1e6*Jr,0),ha=.5*Ct,el=[0,0,0];Re.a6.vec3.transformMat4(el,ta,Xs),Re.a6.vec3.scale(el,el,ha);const tl=[Math.floor(el[0]),Math.floor(el[1]),Math.floor(el[2])],il=[0,0,0];Re.a6.vec3.sub(il,el,tl),Re.a6.vec3.scale(il,il,-1/ha);const sl=new Float64Array(16);return Re.a6.mat4.identity(sl),Re.a6.mat4.translate(sl,sl,il),Re.a6.mat4.multiply(Xs,sl,Xs),[Xs,is]}class io extends Re.E{constructor(Re){super(),this.requestManager=Re,this.models={"":{}},this.numModelsLoading={}}loadModel(Le,Oe){return Re.aG(this.requestManager.transformRequest(Oe,Re.R.Model).url).then((Oe=>{if(!Oe)return;const Ue=Re.aH(Oe),qe=new Re.aI(Le,void 0,void 0,Ue);return qe.computeBoundsAndApplyParent(),qe})).catch((Ue=>{if(Ue&&404===Ue.status)return null;this.fire(new Re.t(new Error(`Could not load model ${Le} from ${Oe}: ${Ue.message}`)))}))}load(Le,Oe){this.models[Oe]||(this.models[Oe]={});const Ue=Object.keys(Le);this.numModelsLoading[Oe]=(this.numModelsLoading[Oe]||0)+Ue.length;const qe=[];for(const Re of Ue)qe.push(this.loadModel(Re,Le[Re]));Promise.allSettled(qe).then((Le=>{for(let Re=0;Re<Le.length;Re++){const{status:qe,value:Ct}=Le[Re];"fulfilled"===qe&&Ct&&(this.models[Oe][Ue[Re]]={model:Ct,numReferences:1})}this.numModelsLoading[Oe]-=Ue.length,this.fire(new Re.x("data",{dataType:"style"}))})).catch((Le=>{this.fire(new Re.t(new Error(`Could not load models: ${Le.message}`)))}))}isLoaded(){for(const Re in this.numModelsLoading)if(this.numModelsLoading[Re]>0)return!1;return!0}hasModel(Re,Le){return!!this.getModel(Re,Le)}getModel(Re,Le){return this.models[Le]||(this.models[Le]={}),this.models[Le][Re]?this.models[Le][Re].model:void 0}addModel(Re,Le,Oe){this.models[Oe]||(this.models[Oe]={}),this.hasModel(Re,Oe)&&this.models[Oe][Re].numReferences++,this.load({[Re]:this.requestManager.normalizeModelURL(Le)},Oe)}addModels(Re,Le){this.models[Le]||(this.models[Le]={});const Oe={};for(const Ue in Re)this.models[Le][Ue]={},Oe[Ue]=this.requestManager.normalizeModelURL(Re[Ue]);this.load(Oe,Le)}addModelsFromBucket(Re,Le){this.models[Le]||(this.models[Le]={});const Oe={};for(const Ue of Re)this.hasModel(Ue,Le)?this.models[Le][Ue].numReferences++:Oe[Ue]=this.requestManager.normalizeModelURL(Ue);this.load(Oe,Le)}removeModel(Re,Le){if(this.models[Le]&&this.models[Le][Re]&&(this.models[Le][Re].numReferences--,0===this.models[Le][Re].numReferences)){const Oe=this.models[Le][Re].model;delete this.models[Le][Re],Oe.destroy()}}listModels(Re){return this.models[Re]||(this.models[Re]={}),Object.keys(this.models[Re])}upload(Re,Le){this.models[Le]||(this.models[Le]={});for(const Oe in this.models[Le])this.models[Le][Oe].model&&this.models[Le][Oe].model.upload(Re.context)}}const au=new Re.a0({data:new Re.a1(Re._.colorTheme.data)}),ro=(Re,Le)=>De(Re,Le&&Le.filter((Re=>"source.canvas"!==Re.identifier))),lu=Re.ar(Jl,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection","setCamera","addImport","removeImport","updateImport"]),xu=Re.ar(Jl,["setCenter","setZoom","setBearing","setPitch"]),Tu={version:8,layers:[],sources:{}},Ou={duration:300,delay:0};class co extends Re.E{constructor(Le,Oe={}){super(),this.map=Le,this.scope=Oe.scope||"",this.globalId=null,this.fragments=[],this.importDepth=Oe.importDepth||0,this.importsCache=Oe.importsCache||new Map,this.resolvedImports=Oe.resolvedImports||new Set,this.transition=Re.l({},Ou),this._buildingIndex=new wt(this),this.crossTileSymbolIndex=new Di,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._clipLayerPresent=!1,this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=Oe.styleChanges||new j,this.dispatcher=Oe.dispatcher?Oe.dispatcher:new Re.cd(Re.ce(),this),Oe.imageManager?this.imageManager=Oe.imageManager:(this.imageManager=new q,this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=Oe.glyphManager?Oe.glyphManager:new Re.cf(Le._requestManager,Oe.localFontFamily?Re.cg.all:Oe.localIdeographFontFamily?Re.cg.ideographs:Re.cg.none,Oe.localFontFamily||Oe.localIdeographFontFamily),Oe.modelManager?this.modelManager=Oe.modelManager:(this.modelManager=new io(Le._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this._styleColorTheme={lut:null,lutLoading:!1,lutLoadingCorrelationID:0,colorTheme:null},this._styleColorThemeForScope={},this.options=Oe.configOptions?Oe.configOptions:new Map,this._configDependentLayers=Oe.configDependentLayers?Oe.configDependentLayers:new Set,this._config=Oe.config,this._initialConfig=Oe.initialConfig,this.dispatcher.broadcast("setReferrer",Re.ch());const Ue=this;this._rtlTextPluginCallback=co.registerForPluginStateChange((Le=>{Ue.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:Le.pluginStatus,pluginURL:Le.pluginURL},((Le,Oe)=>{if(Re.ci(Le),Oe&&Oe.every((Re=>Re)))for(const Re in Ue._sourceCaches){const Le=Ue._sourceCaches[Re],Oe=Le.getSource().type;"vector"!==Oe&&"geojson"!==Oe||Le.reload()}}))})),this.on("data",(Re=>{if("source"!==Re.dataType||"metadata"!==Re.sourceDataType)return;const Le=this.getOwnSource(Re.sourceId);if(Le&&Le.vectorLayerIds)for(const Re in this._layers){const Oe=this._layers[Re];Oe.source===Le.id&&this._validateLayer(Oe)}}))}load(Re){return Re?("string"==typeof Re?this.loadURL(Re):this.loadJSON(Re),this):this}_getGlobalId(Le){if(!Le)return null;if("string"==typeof Le){if(Re.f(Le))return Le;const Oe=Re.cj(Le);if(!Oe.startsWith("http"))try{return new URL(Oe,location.href).toString()}catch(Re){return Oe}return Oe}return`json://${Re.ck(JSON.stringify(Le))}`}_diffStyle(Le,Oe,Ue){this.globalId=this._getGlobalId(Le);const r=(Re,Le)=>{try{Le(null,this.setState(Re,Ue))}catch(Re){Le(Re,!1)}};if("string"==typeof Le){const Ue=this.map._requestManager.normalizeStyleURL(Le),qe=this.map._requestManager.transformRequest(Ue,Re.R.Style);Re.n(qe,((Le,Ue)=>{Le?this.fire(new Re.t(Le)):Ue&&r(Ue,Oe)}))}else"object"==typeof Le&&r(Le,Oe)}loadURL(Le,Oe={}){this.fire(new Re.x("dataloading",{dataType:"style"}));const Ue="boolean"==typeof Oe.validate?Oe.validate:!Re.f(Le);this.globalId=this._getGlobalId(Le),Le=this.map._requestManager.normalizeStyleURL(Le,Oe.accessToken),this.resolvedImports.add(Le);const qe=this.importsCache.get(Le);if(qe)return this._load(qe,Ue);const Ct=this.map._requestManager.transformRequest(Le,Re.R.Style);this._request=Re.n(Ct,((Oe,qe)=>{if(this._request=null,Oe)this.fire(new Re.t(Oe));else if(qe)return this.importsCache.set(Le,qe),this._load(qe,Ue)}))}loadJSON(Le,Oe={}){this.fire(new Re.x("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(Le),this._request=Re.q.frame((()=>{this._request=null,this._load(Le,!1!==Oe.validate)}))}loadEmpty(){this.fire(new Re.x("dataloading",{dataType:"style"})),this._load(Tu,!1)}_loadImports(Le,Oe,Ue){if(this.importDepth>=4)return Re.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const qe=[];for(const Re of Le){const Le=this._createFragmentStyle(Re),Ct=new Promise((Re=>{Le.once("style.import.load",Re),Le.once("error",Re)})).then((()=>this.mergeAll()));if(qe.push(Ct),this.resolvedImports.has(Re.url)){Le.loadEmpty();continue}const Ot=Re.data||this.importsCache.get(Re.url);Ot?(Le.loadJSON(Ot,{validate:Oe}),this._isInternalStyle(Ot)&&(Le.globalId=null)):Re.url?Le.loadURL(Re.url,{validate:Oe}):Le.loadEmpty();const Jt={style:Le,id:Re.id,config:Re.config};if(Ue){const Re=this.fragments.findIndex((({id:Re})=>Re===Ue));this.fragments=this.fragments.slice(0,Re).concat(Jt).concat(this.fragments.slice(Re))}else this.fragments.push(Jt)}return Promise.allSettled(qe)}getImportGlobalIds(Re=this,Le=new Set){for(const Oe of Re.fragments)Oe.style.globalId&&Le.add(Oe.style.globalId),this.getImportGlobalIds(Oe.style,Le);return[...Le.values()]}_createFragmentStyle(Le){const Oe=this.scope?Re.av(Le.id,this.scope):Le.id;let Ue;const qe=this._initialConfig&&this._initialConfig[Oe];(Le.config||qe)&&(Ue=Re.l({},Le.config,qe));const Ct=new co(this.map,{scope:Oe,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:Ue,configOptions:this.options,configDependentLayers:this._configDependentLayers});return Ct.setEventedParent(this.map,{style:Ct}),Ct}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.map._precompilePrograms&&this.isRootStyle()}_isInternalStyle(Re){return this.isRootStyle()&&(Re.fragment||!!Re.schema&&!1!==Re.fragment)}_load(Le,Oe){const Ue=Le.schema;if(this._isInternalStyle(Le)){const Ue=Re.l({},Tu,{imports:[{id:"basemap",data:Le,url:""}]});return void this._load(Ue,Oe)}if(this.updateConfig(this._config,Ue),Oe&&ro(this,fe(Le)))return;this._loaded=!0,this.stylesheet=Re.cl(Le);const r=()=>{for(const Re in Le.sources)this.addSource(Re,Le.sources[Re],{validate:!1,isInitialLoad:!0});Le.sprite?this._loadSprite(Le.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.glyphManager.setURL(Le.glyphs,this.scope);const Ue=Et(this.stylesheet.layers);if(this._order=Ue.map((Re=>Re.id)),this.stylesheet.light&&Re.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(1===this.stylesheet.lights.length&&"flat"===this.stylesheet.lights[0].type){const Re=this.stylesheet.lights[0];this.light=new Ae(Re.properties,Re.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new Ae(this.stylesheet.light)),this._layers={},this._serializedLayers={};for(const Le of Ue){const Oe=Re.cq(Le,this.scope,this._styleColorTheme.lut,this.options);0!==Oe.configDependencies.size&&this._configDependentLayers.add(Oe.fqid),Oe.setEventedParent(this,{layer:{id:Oe.id}}),this._layers[Oe.id]=Oe,this._serializedLayers[Oe.id]=Oe.serialize();const Ue=this.getOwnLayerSourceCache(Oe),qe=!!this.directionalLight&&this.directionalLight.shadowsEnabled();Ue&&Oe.canCastShadows()&&qe&&(Ue.castsShadows=!0)}this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const qe=this.stylesheet.terrain;qe&&(this.checkCanvasFingerprintNoise(),this.disableElevatedTerrain||this.terrainSetForDrapingOnly()||this._createTerrain(qe,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new Re.x("data",{dataType:"style"}));const Ct=this.isRootStyle();Le.imports?this._loadImports(Le.imports,Oe).then((()=>{this._reloadImports(),this.fire(new Re.x(Ct?"style.load":"style.import.load"))})):(this._reloadImports(),this.fire(new Re.x(Ct?"style.load":"style.import.load")))},qe=this.stylesheet["color-theme"];if(this._styleColorTheme.colorTheme=qe,qe){const Le=this._evaluateColorThemeData(qe);this._loadColorTheme(Le).then((()=>{r()})).catch((Le=>{Re.w(`Couldn't load color theme from the stylesheet: ${Le}`),r()}))}else this._styleColorTheme.lut=null,r()}isRootStyle(){return 0===this.importDepth}mergeAll(){let Le,Oe,Ue,qe,Ct,Ot,Jt,Hr;const Jr={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle((Re=>{if(Re.stylesheet){if(null!=Re.light&&(Le=Re.light),Re.stylesheet.lights)for(const Le of Re.stylesheet.lights)"ambient"===Le.type&&null!=Re.ambientLight&&(Oe=Re.ambientLight),"directional"===Le.type&&null!=Re.directionalLight&&(Ue=Re.directionalLight);qe=this._prioritizeTerrain(qe,Re.terrain,Re.stylesheet.terrain),Re.stylesheet.fog&&null!=Re.fog&&(Ct=Re.fog),null!=Re.stylesheet.camera&&(Hr=Re.stylesheet.camera),null!=Re.stylesheet.projection&&(Ot=Re.stylesheet.projection),null!=Re.stylesheet.transition&&(Jt=Re.stylesheet.transition),Jr[Re.scope]=Re._styleColorTheme}})),this.light=Le,this.ambientLight=Oe,this.directionalLight=Ue,this.fog=Ct,this._styleColorThemeForScope=Jr,null===qe?delete this.terrain:this.terrain=qe,this.camera=Hr||{"camera-projection":"perspective"},this.projection=Ot||{name:"mercator"},this.transition=Re.l({},Ou,Jt),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(Re){const t=Le=>{for(const Re of Le.fragments)t(Re.style);Re(Le)};t(this)}_prioritizeTerrain(Re,Le,Oe){const Ue=Re&&0===Re.drapeRenderMode;return null===Oe?Le&&0===Le.drapeRenderMode?Le:Ue?Re:null:null!=Le&&(!Re||Ue||Le&&1===Le.drapeRenderMode)?Le:Re}mergeTerrain(){let Re;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle((Le=>{Re=this._prioritizeTerrain(Re,Le.terrain,Le.stylesheet.terrain)})),null===Re?delete this.terrain:this.terrain=Re}mergeProjection(){let Re;this.forEachFragmentStyle((Le=>{null!=Le.stylesheet.projection&&(Re=Le.stylesheet.projection)})),this.projection=Re||{name:"mercator"}}mergeSources(){const Le={},Oe={},Ue={};this.forEachFragmentStyle((qe=>{for(const Oe in qe._sourceCaches){const Ue=Re.av(Oe,qe.scope);Le[Ue]=qe._sourceCaches[Oe]}for(const Le in qe._otherSourceCaches){const Ue=Re.av(Le,qe.scope);Oe[Ue]=qe._otherSourceCaches[Le]}for(const Le in qe._symbolSourceCaches){const Oe=Re.av(Le,qe.scope);Ue[Oe]=qe._symbolSourceCaches[Le]}})),this._mergedSourceCaches=Le,this._mergedOtherSourceCaches=Oe,this._mergedSymbolSourceCaches=Ue}mergeLayers(){const Le={},Oe=[],Ue={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle((Ue=>{for(const qe of Ue._order){const Ct=Ue._layers[qe];if("slot"===Ct.type){const Oe=Re.cm(qe);if(Le[Oe])continue;Le[Oe]=[]}Ct.slot&&Le[Ct.slot]?Le[Ct.slot].push(Ct):Oe.push(Ct)}})),this._mergedOrder=[];const r=(Oe=[])=>{for(const qe of Oe)if("slot"===qe.type){const Oe=Re.cm(qe.id);Le[Oe]&&r(Le[Oe]),this._mergedSlots.push(Oe)}else{const Le=Re.av(qe.id,qe.scope);this._mergedOrder.push(Le),Ue[Le]=qe,qe.is3D()&&(this._has3DLayers=!0),"circle"===qe.type&&(this._hasCircleLayers=!0),"symbol"===qe.type&&(this._hasSymbolLayers=!0),"clip"===qe.type&&(this._clipLayerPresent=!0)}};r(Oe),this._mergedOrder.sort(((Re,Le)=>{const Oe=Ue[Re],qe=Ue[Le];return Oe.hasInitialOcclusionOpacityProperties?qe.is3D()?1:0:Oe.is3D()&&qe.hasInitialOcclusionOpacityProperties?-1:0})),this._mergedLayers=Ue,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&0===this.terrain.drapeRenderMode}getCamera(){return this.stylesheet.camera}setCamera(Le){return this.stylesheet.camera=Re.l({},this.stylesheet.camera,Le),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(Le){return Le.data?function(Le,Oe,Ue){const qe=Re.l({},Oe);for(const Le of Object.keys(Re._.colorTheme))void 0===qe[Le]&&(qe[Le]=Re._.colorTheme[Le].default);const Ct=new Re.$(au,Le,new Map(Ue));return Ct.setTransitionOrValue(qe,Ue),Ct.untransitioned().possiblyEvaluate(new Re.a3(0))}(this.scope,Le,this.options).get("data"):null}_loadColorTheme(Le){this._styleColorTheme.lutLoading=!0,this._styleColorTheme.lutLoadingCorrelationID+=1;const Oe=this._styleColorTheme.lutLoadingCorrelationID;return new Promise(((Ue,qe)=>{const Ct="data:image/png;base64,";if(!Le||0===Le.length)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void Ue();let Ot=Le;Ot.startsWith(Ct)||(Ot=Ct+Ot);const Jt="mapbox-reserved-lut",Hr=new Image;Hr.src=Ot,Hr.onerror=()=>{this._styleColorTheme.lutLoading=!1,qe(new Error("Failed to load image data"))},Hr.onload=()=>{if(this._styleColorTheme.lutLoadingCorrelationID!==Oe)return void Ue();this._styleColorTheme.lutLoading=!1;const{width:Ct,height:Ot,data:Jr}=Re.q.getImageData(Hr);if(Ot>32)return void qe(new Error("The height of the image must be less than or equal to 32 pixels."));if(Ct!==Ot*Ot)return void qe(new Error("The width of the image must be equal to the height squared."));this.getImage(Jt)&&this.removeImage(Jt),this.addImage(Jt,{data:new Re.r({width:Ct,height:Ot},Jr),pixelRatio:1,sdf:!1,version:0});const Ln=this.imageManager.getImage(Jt,this.scope);Ln?(this._styleColorTheme.lut={image:Ln.data,data:Le},Ue()):qe(new Error("Missing LUT image."))}}))}getLut(Re){const Le=this._styleColorThemeForScope[Re];return Le?Le.lut:null}setProjection(Re){Re?this.stylesheet.projection=Re:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(Le){this._spriteRequest=function(Le,Oe,Ue){let qe,Ct,Ot;const Jt=Re.q.devicePixelRatio>1?"@2x":"";let Hr=Re.n(Oe.transformRequest(Oe.normalizeSpriteURL(Le,Jt,".json"),Re.R.SpriteJSON),((Re,Le)=>{Hr=null,Ot||(Ot=Re,qe=Le,h())})),Jr=Re.o(Oe.transformRequest(Oe.normalizeSpriteURL(Le,Jt,".png"),Re.R.SpriteImage),((Re,Le)=>{Jr=null,Ot||(Ot=Re,Ct=Le,h())}));function h(){if(Ot)Ue(Ot);else if(qe&&Ct){const Le=Re.q.getImageData(Ct),Oe={};for(const Ue in qe){const{width:Ct,height:Ot,x:Jt,y:Hr,sdf:Jr,pixelRatio:Ln,stretchX:Nn,stretchY:$n,content:Gn}=qe[Ue],qn=new Re.r({width:Ct,height:Ot});Re.r.copy(Le,qn,{x:Jt,y:Hr},{x:0,y:0},{width:Ct,height:Ot},null),Oe[Ue]={data:qn,pixelRatio:Ln,sdf:Jr,stretchX:Nn,stretchY:$n,content:Gn}}Ue(null,Oe)}}return{cancel(){Hr&&(Hr.cancel(),Hr=null),Jr&&(Jr.cancel(),Jr=null)}}}(Le,this.map._requestManager,((Le,Oe)=>{if(this._spriteRequest=null,Le)this.fire(new Re.t(Le));else if(Oe)for(const Re in Oe)this.imageManager.addImage(Re,this.scope,Oe[Re]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new Re.x("data",{dataType:"style"}))}))}_validateLayer(Le){const Oe=this.getOwnSource(Le.source);if(!Oe)return;const Ue=Le.sourceLayer;Ue&&("geojson"===Oe.type||Oe.vectorLayerIds&&-1===Oe.vectorLayerIds.indexOf(Ue))&&this.fire(new Re.t(new Error(`Source layer "${Ue}" does not exist on source "${Oe.id}" as specified by style layer "${Le.id}"`)))}loaded(){if(!this._loaded)return!1;if(Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const Re in this._sourceCaches)if(!this._sourceCaches[Re].loaded())return!1;if(!this.imageManager.isLoaded())return!1;if(!this.modelManager.isLoaded())return!1;if(this._styleColorTheme.lutLoading)return!1;for(const{style:Re}of this.fragments)if(!Re.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map(((Re,Le)=>{const Oe=this.fragments[Le];return Oe&&Oe.style&&(Re.data=Oe.style.serialize()),Re}))}_serializeSources(){const Re={};for(const Le in this._sourceCaches){const Oe=this._sourceCaches[Le].getSource();Re[Oe.id]||(Re[Oe.id]=Oe.serialize())}return Re}_serializeLayers(Re){const Le=[];for(const Oe of Re){const Re=this._layers[Oe];Re&&"custom"!==Re.type&&Le.push(Re.serialize())}return Le}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasTransitions(){if(this.hasLightTransitions())return!0;if(this.hasFogTransition())return!0;for(const Re in this._sourceCaches)if(this._sourceCaches[Re].hasTransition())return!0;for(const Re in this._layers)if(this._layers[Re].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}isLayerDraped(Re){return!!this.terrain&&Re.isDraped(this.getLayerSourceCache(Re))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(Le){const Oe=this.getOwnLayer(Le);if(Oe)return Oe;this.fire(new Re.t(new Error(`The layer '${Le}' does not exist in the map's style.`)))}_checkSource(Le){const Oe=this.getOwnSource(Le);if(Oe)return Oe;this.fire(new Re.t(new Error(`The source '${Le}' does not exist in the map's style.`)))}precompilePrograms(Re,Le){const Oe=this.map.painter;if(Oe)for(let Ue=Re.minzoom||0;Ue<(Re.maxzoom||25.5);Ue++){const Ue=Re.getProgramIds();if(Ue)for(const qe of Ue){const Ue=Re.getDefaultProgramParams(qe,Le.zoom,this._styleColorTheme.lut);Ue&&(Oe.style=this,this.fog&&(Oe._fogVisible=!0,Ue.overrideFog=!0,Oe.getOrCreateProgram(qe,Ue)),Oe._fogVisible=!1,Ue.overrideFog=!1,Oe.getOrCreateProgram(qe,Ue),(this.stylesheet.terrain||this.stylesheet.projection&&"globe"===this.stylesheet.projection.name)&&(Ue.overrideRtt=!0,Oe.getOrCreateProgram(qe,Ue)))}}}update(Le){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(Le),this.directionalLight&&this.directionalLight.recalculate(Le);const Oe=this.calculateLightsBrightness();Le.brightness=Oe||0,Oe!==this._brightness&&(this._brightness=Oe,this.dispatcher.broadcast("setBrightness",Oe));const Ue=this._changes.isDirty();let qe=!1;if(this._changes.isDirty()){const Re=this._changes.getLayerUpdatesByScope();for(const Le in Re){const{updatedIds:Oe,removedIds:Ue}=Re[Le];(Oe||Ue)&&(this._updateWorkerLayers(Le,Oe,Ue),qe=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(Le),this.light&&this.light.updateTransitions(Le),this.ambientLight&&this.ambientLight.updateTransitions(Le),this.directionalLight&&this.directionalLight.updateTransitions(Le),this.fog&&this.fog.updateTransitions(Le),this._changes.reset()}const Ct={};for(const Re in this._mergedSourceCaches){const Le=this._mergedSourceCaches[Re];Ct[Re]=Le.used,Le.used=!1,Le.tileCoverLift=0}for(const Re of this._mergedOrder){const Oe=this._mergedLayers[Re];if(Oe.recalculate(Le,this._availableImages),!Oe.isHidden(Le.zoom)){const Re=this.getLayerSourceCache(Oe);Re&&(Re.used=!0,Re.tileCoverLift=Math.max(Re.tileCoverLift,Oe.tileCoverLift()))}!this._precompileDone&&this._shouldPrecompile&&("requestIdleCallback"in window?requestIdleCallback((()=>{this.precompilePrograms(Oe,Le)})):this.precompilePrograms(Oe,Le))}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&qe&&this.mergeLayers();for(const Le in Ct){const Oe=this._mergedSourceCaches[Le];Ct[Le]!==Oe.used&&Oe.getSource().fire(new Re.x("data",{sourceDataType:"visibility",dataType:"source",sourceId:Oe.getSource().id}))}this.light&&this.light.recalculate(Le),this.terrain&&this.terrain.recalculate(Le),this.fog&&this.fog.recalculate(Le),this.z=Le.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),Ue&&this.fire(new Re.x("data",{dataType:"style"}))}_updateTilesForChangedImages(){const Re=this._changes.getUpdatedImages();if(Re.length){for(const Le in this._sourceCaches)this._sourceCaches[Le].reloadTilesForDependencies(["icons","patterns"],Re);this._changes.resetUpdatedImages()}}_updateWorkerLayers(Re,Le,Oe){const Ue=this.getFragmentStyle(Re);Ue&&this.dispatcher.broadcast("updateLayers",{layers:Le?Ue._serializeLayers(Le):[],scope:Re,removedIds:Oe||[],options:Ue.options})}setState(Le,Oe){if(this._checkLoaded(),ro(this,fe(Le)))return!1;(Le=Re.cl(Le)).layers=Et(Le.layers);const Ue=function(Le,Oe){if(!Le)return[{command:Jl.setStyle,args:[Oe]}];let Ue=[];try{if(!Re.bh(Le.version,Oe.version))return[{command:Jl.setStyle,args:[Oe]}];if(Re.bh(Le.center,Oe.center)||Ue.push({command:Jl.setCenter,args:[Oe.center]}),Re.bh(Le.zoom,Oe.zoom)||Ue.push({command:Jl.setZoom,args:[Oe.zoom]}),Re.bh(Le.bearing,Oe.bearing)||Ue.push({command:Jl.setBearing,args:[Oe.bearing]}),Re.bh(Le.pitch,Oe.pitch)||Ue.push({command:Jl.setPitch,args:[Oe.pitch]}),Re.bh(Le.sprite,Oe.sprite)||Ue.push({command:Jl.setSprite,args:[Oe.sprite]}),Re.bh(Le.glyphs,Oe.glyphs)||Ue.push({command:Jl.setGlyphs,args:[Oe.glyphs]}),Re.bh(Le.imports,Oe.imports)||function(Le=[],Oe=[],Ue){Oe=Oe||[];const qe=(Le=Le||[]).map(Lt),Ct=Oe.map(Lt),Ot=Le.reduce(Pt,{}),Jt=Oe.reduce(Pt,{}),Hr=qe.slice();let Jr,Ln,Nn,$n;for(Jr=0,Ln=0;Jr<qe.length;Jr++)Nn=qe[Jr],Jt.hasOwnProperty(Nn)?Ln++:(Ue.push({command:Jl.removeImport,args:[Nn]}),Hr.splice(Hr.indexOf(Nn,Ln),1));for(Jr=0,Ln=0;Jr<Ct.length;Jr++)Nn=Ct[Ct.length-1-Jr],Hr[Hr.length-1-Jr]!==Nn&&(Ot.hasOwnProperty(Nn)?(Ue.push({command:Jl.removeImport,args:[Nn]}),Hr.splice(Hr.lastIndexOf(Nn,Hr.length-Ln),1)):Ln++,$n=Hr[Hr.length-Jr],Ue.push({command:Jl.addImport,args:[Jt[Nn],$n]}),Hr.splice(Hr.length-Jr,0,Nn));for(const Le of Oe){const Oe=Ot[Le.id];Oe&&!Re.bh(Oe,Le)&&Ue.push({command:Jl.updateImport,args:[Le.id,Le]})}}(Le.imports,Oe.imports,Ue),Re.bh(Le.transition,Oe.transition)||Ue.push({command:Jl.setTransition,args:[Oe.transition]}),Re.bh(Le.light,Oe.light)||Ue.push({command:Jl.setLight,args:[Oe.light]}),Re.bh(Le.fog,Oe.fog)||Ue.push({command:Jl.setFog,args:[Oe.fog]}),Re.bh(Le.projection,Oe.projection)||Ue.push({command:Jl.setProjection,args:[Oe.projection]}),Re.bh(Le.lights,Oe.lights)||Ue.push({command:Jl.setLights,args:[Oe.lights]}),Re.bh(Le.camera,Oe.camera)||Ue.push({command:Jl.setCamera,args:[Oe.camera]}),!Re.bh(Le["color-theme"],Oe["color-theme"]))return[{command:Jl.setStyle,args:[Oe]}];const qe={},Ct=[];!function(Le,Oe,Ue,qe){let Ct;for(Ct in Oe=Oe||{},Le=Le||{})Le.hasOwnProperty(Ct)&&(Oe.hasOwnProperty(Ct)||It(Ct,Ue,qe));for(Ct in Oe){if(!Oe.hasOwnProperty(Ct))continue;const Ot=Oe[Ct];Le.hasOwnProperty(Ct)?Re.bh(Le[Ct],Ot)||("geojson"===Le[Ct].type&&"geojson"===Ot.type&&Rt(Le,Oe,Ct)?Ue.push({command:Jl.setGeoJSONSourceData,args:[Ct,Ot.data]}):Dt(Ct,Oe,Ue,qe)):St(Ct,Oe,Ue)}}(Le.sources,Oe.sources,Ct,qe);const Ot=[];Le.layers&&Le.layers.forEach((Re=>{Re.source&&qe[Re.source]?Ue.push({command:Jl.removeLayer,args:[Re.id]}):Ot.push(Re)}));let Jt=Le.terrain;Jt&&qe[Jt.source]&&(Ue.push({command:Jl.setTerrain,args:[void 0]}),Jt=void 0),Ue=Ue.concat(Ct),Re.bh(Jt,Oe.terrain)||Ue.push({command:Jl.setTerrain,args:[Oe.terrain]}),function(Le,Oe,Ue){Oe=Oe||[];const qe=(Le=Le||[]).map(Lt),Ct=Oe.map(Lt),Ot=Le.reduce(Pt,{}),Jt=Oe.reduce(Pt,{}),Hr=qe.slice(),Jr=Object.create(null);let Ln,Nn,$n,Gn,qn,Zn,Xn;for(Ln=0,Nn=0;Ln<qe.length;Ln++)$n=qe[Ln],Jt.hasOwnProperty($n)?Nn++:(Ue.push({command:Jl.removeLayer,args:[$n]}),Hr.splice(Hr.indexOf($n,Nn),1));for(Ln=0,Nn=0;Ln<Ct.length;Ln++)$n=Ct[Ct.length-1-Ln],Hr[Hr.length-1-Ln]!==$n&&(Ot.hasOwnProperty($n)?(Ue.push({command:Jl.removeLayer,args:[$n]}),Hr.splice(Hr.lastIndexOf($n,Hr.length-Nn),1)):Nn++,Zn=Hr[Hr.length-Ln],Ue.push({command:Jl.addLayer,args:[Jt[$n],Zn]}),Hr.splice(Hr.length-Ln,0,$n),Jr[$n]=!0);for(Ln=0;Ln<Ct.length;Ln++)if($n=Ct[Ln],Gn=Ot[$n],qn=Jt[$n],!Jr[$n]&&!Re.bh(Gn,qn))if(Re.bh(Gn.source,qn.source)&&Re.bh(Gn["source-layer"],qn["source-layer"])&&Re.bh(Gn.type,qn.type)){for(Xn in At(Gn.layout,qn.layout,Ue,$n,null,Jl.setLayoutProperty),At(Gn.paint,qn.paint,Ue,$n,null,Jl.setPaintProperty),Re.bh(Gn.slot,qn.slot)||Ue.push({command:Jl.setSlot,args:[$n,qn.slot]}),Re.bh(Gn.filter,qn.filter)||Ue.push({command:Jl.setFilter,args:[$n,qn.filter]}),Re.bh(Gn.minzoom,qn.minzoom)&&Re.bh(Gn.maxzoom,qn.maxzoom)||Ue.push({command:Jl.setLayerZoomRange,args:[$n,qn.minzoom,qn.maxzoom]}),Gn)Gn.hasOwnProperty(Xn)&&"layout"!==Xn&&"paint"!==Xn&&"filter"!==Xn&&"metadata"!==Xn&&"minzoom"!==Xn&&"maxzoom"!==Xn&&"slot"!==Xn&&(0===Xn.indexOf("paint.")?At(Gn[Xn],qn[Xn],Ue,$n,Xn.slice(6),Jl.setPaintProperty):Re.bh(Gn[Xn],qn[Xn])||Ue.push({command:Jl.setLayerProperty,args:[$n,Xn,qn[Xn]]}));for(Xn in qn)qn.hasOwnProperty(Xn)&&!Gn.hasOwnProperty(Xn)&&"layout"!==Xn&&"paint"!==Xn&&"filter"!==Xn&&"metadata"!==Xn&&"minzoom"!==Xn&&"maxzoom"!==Xn&&"slot"!==Xn&&(0===Xn.indexOf("paint.")?At(Gn[Xn],qn[Xn],Ue,$n,Xn.slice(6),Jl.setPaintProperty):Re.bh(Gn[Xn],qn[Xn])||Ue.push({command:Jl.setLayerProperty,args:[$n,Xn,qn[Xn]]}))}else Ue.push({command:Jl.removeLayer,args:[$n]}),Zn=Hr[Hr.lastIndexOf($n)+1],Ue.push({command:Jl.addLayer,args:[qn,Zn]})}(Ot,Oe.layers,Ue)}catch(Re){console.warn("Unable to compute style diff:",Re),Ue=[{command:Jl.setStyle,args:[Oe]}]}return Ue}(this.serialize(),Le).filter((Re=>!(Re.command in xu)));if(0===Ue.length)return!1;const qe=Ue.filter((Re=>!(Re.command in lu)));if(qe.length>0)throw new Error(`Unimplemented: ${qe.map((Re=>Re.command)).join(", ")}.`);const Ct=[];return Ue.forEach((Re=>{Ct.push(this[Re.command].apply(this,Re.args))})),Oe&&Promise.all(Ct).then(Oe),this.stylesheet=Le,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}addImage(Le,Oe){return this.getImage(Le)?this.fire(new Re.t(new Error("An image with this name already exists."))):(this.imageManager.addImage(Le,this.scope,Oe),this._afterImageUpdated(Le),this)}updateImage(Re,Le){this.imageManager.updateImage(Re,this.scope,Le)}getImage(Re){return this.imageManager.getImage(Re,this.scope)}removeImage(Le){return this.getImage(Le)?(this.imageManager.removeImage(Le,this.scope),this._afterImageUpdated(Le),this):this.fire(new Re.t(new Error("No image with this name exists.")))}_afterImageUpdated(Le){this._availableImages=this.imageManager.listImages(this.scope),this._changes.updateImage(Le),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.fire(new Re.x("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(Re,Le,Oe={}){return this._checkLoaded(),this._validate(Se,`models.${Re}`,Le,null,Oe)||(this.modelManager.addModel(Re,Le,this.scope),this._changes.setDirty()),this}hasModel(Re){return this.modelManager.hasModel(Re,this.scope)}removeModel(Le){return this.hasModel(Le)?(this.modelManager.removeModel(Le,this.scope),this):this.fire(new Re.t(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(Le,Oe,Ue={}){if(this._checkLoaded(),void 0!==this.getOwnSource(Le))throw new Error(`There is already a source with ID "${Le}".`);if(!Oe.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(Oe).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(Oe.type)>=0&&this._validate(ge,`sources.${Le}`,Oe,null,Ue))return;this.map&&this.map._collectResourceTiming&&(Oe.collectResourceTiming=!0);const qe=tt(Le,Oe,this.dispatcher,this);qe.scope=this.scope,qe.setEventedParent(this,(()=>({isSourceLoaded:this._isSourceCacheLoaded(qe.id),source:qe.serialize(),sourceId:qe.id})));const s=Le=>{const Oe=(Le?"symbol:":"other:")+qe.id,Ue=Re.av(Oe,this.scope),Ct=this._sourceCaches[Oe]=new vt(Ue,qe,Le);(Le?this._symbolSourceCaches:this._otherSourceCaches)[qe.id]=Ct,Ct.onAdd(this.map)};s(!1),"vector"!==Oe.type&&"geojson"!==Oe.type||s(!0),qe.onAdd&&qe.onAdd(this.map),Ue.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(Le){this._checkLoaded();const Oe=this.getOwnSource(Le);if(!Oe)throw new Error("There is no source with this ID");for(const Oe in this._layers)if(this._layers[Oe].source===Le)return this.fire(new Re.t(new Error(`Source "${Le}" cannot be removed while layer "${Oe}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===Le)return this.fire(new Re.t(new Error(`Source "${Le}" cannot be removed while terrain is using it.`)));const Ue=this.getOwnSourceCaches(Le);for(const Le of Ue){const Oe=Re.cm(Le.id);delete this._sourceCaches[Oe],this._changes.discardSourceCacheUpdate(Le.id),Le.fire(new Re.x("data",{sourceDataType:"metadata",dataType:"source",sourceId:Le.getSource().id})),Le.setEventedParent(null),Le.clearTiles()}return delete this._otherSourceCaches[Le],delete this._symbolSourceCaches[Le],this.mergeSources(),Oe.setEventedParent(null),Oe.onRemove&&Oe.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(Re,Le){this._checkLoaded(),this.getOwnSource(Re).setData(Le),this._changes.setDirty()}getOwnSource(Re){const Le=this.getOwnSourceCache(Re);return Le&&Le.getSource()}getOwnSources(){const Re=[];for(const Le in this._otherSourceCaches){const Oe=this.getOwnSourceCache(Le);Oe&&Re.push(Oe.getSource())}return Re}areTilesLoaded(){const Re=this._mergedSourceCaches;for(const Le in Re){const Oe=Re[Le]._tiles;for(const Re in Oe){const Le=Oe[Re];if("loaded"!==Le.state&&"errored"!==Le.state)return!1}}return!0}setLights(Le){if(this._checkLoaded(),!Le)return delete this.ambientLight,void delete this.directionalLight;const Oe=this._getTransitionParameters();for(const Ue of Le){if(this._validate(xe,"lights",Ue))return;switch(Ue.type){case"ambient":if(this.ambientLight){const Re=this.ambientLight;Re.set(Ue),Re.updateTransitions(Oe)}else this.ambientLight=new je(Ue,el||(el=new Re.a0({color:new Re.a1(Re._.properties_light_ambient.color),intensity:new Re.a1(Re._.properties_light_ambient.intensity)})),this.scope,this.options);break;case"directional":if(this.directionalLight){const Re=this.directionalLight;Re.set(Ue),Re.updateTransitions(Oe)}else this.directionalLight=new je(Ue,tl||(tl=new Re.a0({direction:new Re.ad(Re._.properties_light_directional.direction),color:new Re.a1(Re._.properties_light_directional.color),intensity:new Re.a1(Re._.properties_light_directional.intensity),"cast-shadows":new Re.a1(Re._.properties_light_directional["cast-shadows"]),"shadow-intensity":new Re.a1(Re._.properties_light_directional["shadow-intensity"])})),this.scope,this.options)}}const Ue=new Re.a3(this.z||0,Oe);this.ambientLight&&this.ambientLight.recalculate(Ue),this.directionalLight&&this.directionalLight.recalculate(Ue),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const Le=this.directionalLight,Oe=this.ambientLight;if(!Le||!Oe)return;const o=Re=>.2126*(Re[0]<=.03928?Re[0]/12.92:Math.pow((Re[0]+.055)/1.055,2.4))+.7152*(Re[1]<=.03928?Re[1]/12.92:Math.pow((Re[1]+.055)/1.055,2.4))+.0722*(Re[2]<=.03928?Re[2]/12.92:Math.pow((Re[2]+.055)/1.055,2.4)),Ue=Le.properties.get("color").toRenderColor(null).toArray01(),qe=Le.properties.get("intensity"),Ct=Le.properties.get("direction"),Ot=1-Re.c7(Ct.x,Ct.y,Ct.z)[2]/90,Jt=o(Ue)*qe*Ot,Hr=Oe.properties.get("color").toRenderColor(null).toArray01(),Jr=Oe.properties.get("intensity");return(Jt+o(Hr)*Jr)/2}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const Re=[];return this.directionalLight&&Re.push(this.directionalLight.get()),this.ambientLight&&Re.push(this.ambientLight.get()),Re}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(Le){if(!Le)return this;if(Re.cn(Le)){const Oe=Re.co(Le),Ue=this.fragments.find((({id:Re})=>Re===Oe));if(!Ue)throw new Error(`Style import not found: ${Le}`);const qe=Re.cm(Le);return Ue.style.getFragmentStyle(qe)}{const Re=this.fragments.find((({id:Re})=>Re===Le));if(!Re)throw new Error(`Style import not found: ${Le}`);return Re.style}}getConfigProperty(Le,Oe){const Ue=this.getFragmentStyle(Le);if(!Ue)return null;const qe=Re.av(Oe,Ue.scope),Ct=Ue.options.get(qe),Ot=Ct?Ct.value||Ct.default:null;return Ot?Ot.serialize():null}setConfigProperty(Le,Oe,Ue){const qe=this.getFragmentStyle(Le);if(!qe)return;const Ct=qe.stylesheet.schema;if(!Ct||!Ct[Oe])return;const Ot=Re.M(Ue);if("success"!==Ot.result)return void ro(this,Ot.value);const Jt=Ot.value.expression,Hr=Re.av(Oe,qe.scope),Jr=qe.options.get(Hr);if(!Jr)return;let Ln;const{minValue:Nn,maxValue:$n,stepValue:Gn,type:qn,values:Zn}=Ct[Oe],Xn=Re.M(Ct[Oe].default);"success"===Xn.result&&(Ln=Xn.value.expression),Ln?(this.options.set(Hr,{...Jr,value:Jt,default:Ln,minValue:Nn,maxValue:$n,stepValue:Gn,type:qn,values:Zn}),this.updateConfigDependencies(Oe)):this.fire(new Re.t(new Error(`No schema defined for the config option "${Oe}" in the "${Le}" fragment.`)))}getConfig(Le){const Oe=this.getFragmentStyle(Le);if(!Oe)return null;const Ue=Oe.stylesheet.schema;if(!Ue)return null;const qe={};for(const Le in Ue){const Ue=Re.av(Le,Oe.scope),Ct=Oe.options.get(Ue),Ot=Ct?Ct.value||Ct.default:null;qe[Le]=Ot?Ot.serialize():null}return qe}setConfig(Re,Le){const Oe=this.getFragmentStyle(Re);Oe&&(Oe.updateConfig(Le,Oe.stylesheet.schema),this.updateConfigDependencies())}getSchema(Re){const Le=this.getFragmentStyle(Re);return Le?Le.stylesheet.schema:null}setSchema(Re,Le){const Oe=this.getFragmentStyle(Re);Oe&&(Oe.stylesheet.schema=Le,Oe.updateConfig(Oe._config,Le),this.updateConfigDependencies())}updateConfig(Le,Oe){if(this._config=Le,Le||Oe)if(Oe)for(const Ue in Oe){let qe,Ct;const Ot=Re.M(Oe[Ue].default);if("success"===Ot.result&&(qe=Ot.value.expression),Le&&void 0!==Le[Ue]){const Oe=Re.M(Le[Ue]);"success"===Oe.result&&(Ct=Oe.value.expression)}const{minValue:Jt,maxValue:Hr,stepValue:Jr,type:Ln,values:Nn}=Oe[Ue];if(qe){const Le=Re.av(Ue,this.scope);this.options.set(Le,{default:qe,value:Ct,minValue:Jt,maxValue:Hr,stepValue:Jr,type:Ln,values:Nn})}else this.fire(new Re.t(new Error(`No schema defined for config option "${Ue}".`)))}else this.fire(new Re.t(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(Re){for(const Le of this._configDependentLayers){const Oe=this.getLayer(Le);if(Oe){if(Re&&!Oe.configDependencies.has(Re))continue;Oe.possiblyEvaluateVisibility(),this._updateLayer(Oe)}}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.forEachFragmentStyle((Re=>{if(Re._styleColorTheme.colorTheme){const Le=Re._evaluateColorThemeData(Re._styleColorTheme.colorTheme);(!Re._styleColorTheme.lut&&""!==Le||Re._styleColorTheme.lut&&Le!==Re._styleColorTheme.lut.data)&&Re.setColorTheme(Re._styleColorTheme.colorTheme)}})),this._changes.setDirty()}addLayer(Le,Oe,Ue={}){this._checkLoaded();const qe=Le.id;if(this._layers[qe])return void this.fire(new Re.t(new Error(`Layer with id "${qe}" already exists on this map`)));let Ct;if("custom"===Le.type){if(ro(this,Re.cp(Le)))return;Ct=Re.cq(Le,this.scope,this._styleColorTheme.lut,this.options)}else{if("object"==typeof Le.source&&(this.addSource(qe,Le.source),Le=Re.cl(Le),Le=Re.l(Le,{source:qe})),this._validate(we,`layers.${qe}`,Le,{arrayIndex:-1},Ue))return;Ct=Re.cq(Le,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(Ct),Ct.setEventedParent(this,{layer:{id:qe}}),this._serializedLayers[Ct.id]=Ct.serialize()}0!==Ct.configDependencies.size&&this._configDependentLayers.add(Ct.fqid);let Ot=this._order.length;if(Oe){const Le=this._order.indexOf(Oe);if(-1===Le)return void this.fire(new Re.t(new Error(`Layer with id "${Oe}" does not exist on this map.`)));Ct.slot===this._layers[Oe].slot?Ot=Le:Re.w(`Layer with id "${Oe}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(Ot,0,qe),this._layerOrderChanged=!0,this._layers[qe]=Ct;const Jt=this.getOwnLayerSourceCache(Ct),Hr=!!this.directionalLight&&this.directionalLight.shadowsEnabled();Jt&&Ct.canCastShadows()&&Hr&&(Jt.castsShadows=!0);const Jr=this._changes.getRemovedLayer(Ct);if(Jr&&Ct.source&&Jt&&"custom"!==Ct.type){this._changes.discardLayerRemoval(Ct);const Le=Re.av(Ct.source,Ct.scope);Jr.type!==Ct.type?this._changes.updateSourceCache(Le,"clear"):(this._changes.updateSourceCache(Le,"reload"),Jt.pause())}this._updateLayer(Ct),Ct.onAdd&&Ct.onAdd(this.map),Ct.scope=this.scope,this.mergeLayers()}moveLayer(Le,Oe){this._checkLoaded();const Ue=this._checkLayer(Le);if(!Ue)return;if(Le===Oe)return;const qe=this._order.indexOf(Le);this._order.splice(qe,1);let Ct=this._order.length;if(Oe){const Le=this._order.indexOf(Oe);if(-1===Le)return void this.fire(new Re.t(new Error(`Layer with id "${Oe}" does not exist on this map.`)));Ue.slot===this._layers[Oe].slot?Ct=Le:Re.w(`Layer with id "${Oe}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(Ct,0,Le),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(Re){this._checkLoaded();const Le=this._checkLayer(Re);if(!Le)return;Le.setEventedParent(null);const Oe=this._order.indexOf(Re);this._order.splice(Oe,1),delete this._layers[Re],delete this._serializedLayers[Re],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(Le.fqid),this._changes.removeLayer(Le);const Ue=this.getOwnLayerSourceCache(Le);if(Ue&&Ue.castsShadows){let Re=!1;for(const Oe in this._layers)if(this._layers[Oe].source===Le.source&&this._layers[Oe].canCastShadows()){Re=!0;break}Ue.castsShadows=Re}Le.onRemove&&Le.onRemove(this.map),this.mergeLayers()}getOwnLayer(Re){return this._layers[Re]}hasLayer(Re){return Re in this._mergedLayers}hasLayerType(Re){for(const Le in this._layers)if(this._layers[Le].type===Re)return!0;return!1}setLayerZoomRange(Re,Le,Oe){this._checkLoaded();const Ue=this._checkLayer(Re);Ue&&(Ue.minzoom===Le&&Ue.maxzoom===Oe||(null!=Le&&(Ue.minzoom=Le),null!=Oe&&(Ue.maxzoom=Oe),this._updateLayer(Ue)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(Re,Le){this._checkLoaded();const Oe=this._checkLayer(Re);Oe&&Oe.slot!==Le&&(Oe.slot=Le,this._updateLayer(Oe))}setFilter(Le,Oe,Ue={}){this._checkLoaded();const qe=this._checkLayer(Le);if(qe&&!Re.bh(qe.filter,Oe))return null==Oe?(qe.filter=void 0,void this._updateLayer(qe)):void(this._validate(Te,`layers.${qe.id}.filter`,Oe,{layerType:qe.type},Ue)||(qe.filter=Re.cl(Oe),this._updateLayer(qe)))}getFilter(Le){const Oe=this._checkLayer(Le);if(Oe)return Re.cl(Oe.filter)}setLayoutProperty(Le,Oe,Ue,qe={}){this._checkLoaded();const Ct=this._checkLayer(Le);if(Ct&&!Re.bh(Ct.getLayoutProperty(Oe),Ue)){if(null!=Ue&&(!qe||!1!==qe.validate)&&ro(Ct,Ce.call(fe,{key:`layers.${Le}.layout.${Oe}`,layerType:Ct.type,objectKey:Oe,value:Ue,styleSpec:Re._,style:{glyphs:!0,sprite:!0}})))return;Ct.setLayoutProperty(Oe,Ue),0!==Ct.configDependencies.size&&this._configDependentLayers.add(Ct.fqid),this._updateLayer(Ct)}}getLayoutProperty(Re,Le){const Oe=this._checkLayer(Re);if(Oe)return Oe.getLayoutProperty(Le)}setPaintProperty(Le,Oe,Ue,qe={}){this._checkLoaded();const Ct=this._checkLayer(Le);if(!Ct)return;if(Re.bh(Ct.getPaintProperty(Oe),Ue))return;if(null!=Ue&&(!qe||!1!==qe.validate)&&ro(Ct,Ee.call(fe,{key:`layers.${Le}.paint.${Oe}`,layerType:Ct.type,objectKey:Oe,value:Ue,styleSpec:Re._})))return;const Ot=Ct.setPaintProperty(Oe,Ue);0!==Ct.configDependencies.size&&this._configDependentLayers.add(Ct.fqid),Ot&&this._updateLayer(Ct),this._changes.updatePaintProperties(Ct)}getPaintProperty(Re,Le){const Oe=this._checkLayer(Re);if(Oe)return Oe.getPaintProperty(Le)}setFeatureState(Le,Oe){this._checkLoaded();const Ue=Le.source,qe=Le.sourceLayer,Ct=this._checkSource(Ue);if(!Ct)return;const Ot=Ct.type;if("geojson"===Ot&&qe)return void this.fire(new Re.t(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===Ot&&!qe)return void this.fire(new Re.t(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===Le.id&&this.fire(new Re.t(new Error("The feature id parameter must be provided.")));const Jt=this.getOwnSourceCaches(Ue);for(const Re of Jt)Re.setFeatureState(qe,Le.id,Oe)}removeFeatureState(Le,Oe){this._checkLoaded();const Ue=Le.source,qe=this._checkSource(Ue);if(!qe)return;const Ct=qe.type,Ot="vector"===Ct?Le.sourceLayer:void 0;if("vector"===Ct&&!Ot)return void this.fire(new Re.t(new Error("The sourceLayer parameter must be provided for vector source types.")));if(Oe&&"string"!=typeof Le.id&&"number"!=typeof Le.id)return void this.fire(new Re.t(new Error("A feature id is required to remove its specific state property.")));const Jt=this.getOwnSourceCaches(Ue);for(const Re of Jt)Re.removeFeatureState(Ot,Le.id,Oe)}getFeatureState(Le){this._checkLoaded();const Oe=Le.source,Ue=Le.sourceLayer,qe=this._checkSource(Oe);if(qe){if("vector"!==qe.type||Ue)return void 0===Le.id&&this.fire(new Re.t(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(Oe)[0].getFeatureState(Ue,Le.id);this.fire(new Re.t(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(Le){return this.stylesheet.transition=Re.l({},this.stylesheet.transition,Le),this.transition=this.stylesheet.transition,this}getTransition(){return Re.l({},this.stylesheet.transition)}serialize(){this._checkLoaded();const Le=this.getTerrain(),Oe=Le&&this.terrain&&this.terrain.scope===this.scope?Le:this.stylesheet.terrain;return Re.cr({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:Oe,fog:this.stylesheet.fog,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},(Re=>void 0!==Re))}_updateLayer(Le){this._changes.updateLayer(Le);const Oe=this.getLayerSourceCache(Le),Ue=Re.av(Le.source,Le.scope),qe=this._changes.getUpdatedSourceCaches();Le.source&&!qe[Ue]&&Oe&&"raster"!==Oe.getSource().type&&(this._changes.updateSourceCache(Ue,"reload"),Oe.pause()),Le.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(Re){const t=Re=>this._mergedLayers[Re].is3D(),Le=this.order,Oe={},Ue=[];for(let qe=Le.length-1;qe>=0;qe--){const Ct=Le[qe];if(t(Ct)){Oe[Ct]=qe;for(const Le of Re){const Re=Le[Ct];if(Re)for(const Le of Re)Ue.push(Le)}}}Ue.sort(((Re,Le)=>Le.intersectionZ-Re.intersectionZ));const qe=[];for(let Ct=Le.length-1;Ct>=0;Ct--){const Ot=Le[Ct];if(t(Ot))for(let Re=Ue.length-1;Re>=0;Re--){const Le=Ue[Re].feature;if(Le.layer&&Oe[Le.layer.id]<Ct)break;qe.push(Le),Ue.pop()}else for(const Le of Re){const Re=Le[Ot];if(Re)for(const Le of Re)qe.push(Le.feature)}}return qe}queryRenderedFeatures(Le,Oe,Ue){Oe&&Oe.filter&&this._validate(Te,"queryRenderedFeatures.filter",Oe.filter,null,Oe),Oe.scope=this.scope,Oe.availableImages=this._availableImages,Oe.serializedLayers=this._serializedLayers;const qe={};if(Oe&&Oe.layers){if(!Array.isArray(Oe.layers))return this.fire(new Re.t(new Error("parameters.layers must be an Array."))),[];for(const Le of Oe.layers){const Oe=this._mergedLayers[Le];if(!Oe)return this.fire(new Re.t(new Error(`The layer '${Le}' does not exist in the map's style and cannot be queried for features.`))),[];qe[Oe.source]=!0}}const Ct=[],Ot=Oe.serializedLayers||{},Jt=Oe&&Oe.layers?Oe.layers.some((Re=>{const Le=this.getLayer(Re);return Le&&Le.is3D()})):this.has3DLayers(),Hr=Ze.createFromScreenPoints(Le,Ue);for(const Re in this._mergedSourceCaches){const Le=this._mergedSourceCaches[Re].getSource();if(!Le||Le.scope!==Oe.scope)continue;const Jr=this._mergedSourceCaches[Re].getSource().id;Oe.layers&&!qe[Jr]||Ct.push(ot(this._mergedSourceCaches[Re],this._mergedLayers,Ot,Hr,Oe,Ue,Jt,!!this.map._showQueryGeometry))}return this.placement&&Ct.push(function(Re,Le,Oe,Ue,qe,Ct,Ot){const Jt={},Hr=Ct.queryRenderedSymbols(Ue),Jr=[];for(const Re of Object.keys(Hr).map(Number))Jr.push(Ot[Re]);Jr.sort(st);for(const Oe of Jr){const Ue=Oe.featureIndex.lookupSymbolFeatures(Hr[Oe.bucketInstanceId],Le,Oe.bucketIndex,Oe.sourceLayerIndex,qe.filter,qe.layers,qe.availableImages,Re);for(const Re in Ue){const Le=Jt[Re]=Jt[Re]||[],qe=Ue[Re];qe.sort(((Re,Le)=>{const Ue=Oe.featureSortOrder;if(Ue){const Oe=Ue.indexOf(Re.featureIndex);return Ue.indexOf(Le.featureIndex)-Oe}return Le.featureIndex-Re.featureIndex}));for(const Re of qe)Le.push(Re)}}for(const Le in Jt)Jt[Le].forEach((Ue=>{const qe=Ue.feature,Ct=Oe(Re[Le]);if(!Ct)return;const Ot=Ct.getFeatureState(qe.layer["source-layer"],qe.id);qe.source=qe.layer.source,qe.layer["source-layer"]&&(qe.sourceLayer=qe.layer["source-layer"]),qe.state=Ot}));return Jt}(this._mergedLayers,Ot,this.getLayerSourceCache.bind(this),Hr.screenGeometry,Oe,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(Ct)}querySourceFeatures(Re,Le){Le&&Le.filter&&this._validate(Te,"querySourceFeatures.filter",Le.filter,null,Le);const Oe=this.getOwnSourceCaches(Re);let Ue=[];for(const Re of Oe)Ue=Ue.concat(rt(Re,Le));return Ue}addSourceType(Re,Le,Oe){return co.getSourceType(Re)?Oe(new Error(`A source type called "${Re}" already exists.`)):(co.setSourceType(Re,Le),Le.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:Re,url:Le.workerSourceURL},Oe):Oe(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(Le,Oe,Ue={}){this._checkLoaded();const qe=this.light.getLight();let Ct=!1;for(const Oe in Le)if(!Re.bh(Le[Oe],qe[Oe])){Ct=!0;break}if(!Ct)return;const Ot=this._getTransitionParameters();this.light.setLight(Le,Oe,Ue),this.light.updateTransitions(Ot)}getTerrain(){return this.terrain&&1===this.terrain.drapeRenderMode?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){void 0===this.disableElevatedTerrain&&(this.disableElevatedTerrain=Re.q.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&Re.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(Le,Oe=1){if(this._checkLoaded(),!Le)return this.terrainSetForDrapingOnly()||(delete this.terrain,this.map.transform.projection.requiresDraping&&this.setTerrainForDraping()),0===Oe&&delete this.terrain,null===Le?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let Ue=Le;const qe=null==Le.source;if(1===Oe){if(this.disableElevatedTerrain)return;if("object"==typeof Ue.source){const Le="terrain-dem-src";this.addSource(Le,Ue.source),Ue=Re.cl(Ue),Ue=Re.l(Ue,{source:Le})}const Le=Re.l({},Ue),Oe={};if(this.terrain&&qe){Le.source=this.terrain.get().source;const Re=this.terrain?this.getFragmentStyle(this.terrain.scope):null;Re&&(Oe.style=Re.serialize())}if(this._validate(ye,"terrain",Le,Oe))return}if(!this.terrain||this.terrain.scope!==this.scope&&!qe||this.terrain&&Oe!==this.terrain.drapeRenderMode){if(!Ue)return;this._createTerrain(Ue,Oe),this.fire(new Re.x("data",{dataType:"style"}))}else{const Oe=this.terrain,qe=Oe.get();for(const Le of Object.keys(Re._.terrain))!Ue.hasOwnProperty(Le)&&Re._.terrain[Le].default&&(Ue[Le]=Re._.terrain[Le].default);for(const Ue in Le)if(!Re.bh(Le[Ue],qe[Ue])){Oe.set(Le,this.options),this.stylesheet.terrain=Le;const Ue=this._getTransitionParameters({duration:0});Oe.updateTransitions(Ue),this.fire(new Re.x("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(Re){const Le=this.fog=new Ge(Re,this.map.transform,this.scope,this.options);this.stylesheet.fog=Le.get();const Oe=this._getTransitionParameters({duration:0});Le.updateTransitions(Oe)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask((()=>{for(const Re of this.map._markers)Re._evaluateOpacity()}))}getFog(){return this.fog?this.fog.get():null}setFog(Le){if(this._checkLoaded(),!Le)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const Oe=this.fog;if(!Re.bh(Oe.get(),Le)){Oe.set(Le,this.options),this.stylesheet.fog=Oe.get();const Re=this._getTransitionParameters({duration:0});Oe.updateTransitions(Re)}}else this._createFog(Le);this._markersNeedUpdate=!0}setColorTheme(Le){this._checkLoaded();const i=()=>{for(const Re in this._layers)this._layers[Re].lut=this._styleColorTheme.lut;for(const Re in this._sourceCaches)this._sourceCaches[Re].clearTiles()};if(this._styleColorTheme.colorTheme=Le,!Le)return this._styleColorTheme.lut=null,void i();const Oe=this._evaluateColorThemeData(Le);this._loadColorTheme(Oe).then((()=>{this.fire(new Re.x("colorthemeset")),i()})).catch((Le=>{Re.w(`Couldn't set color theme: ${Le}`)}))}_getTransitionParameters(Le){return{now:Re.q.now(),transition:Re.l(this.transition,Le)}}updateDrapeFirstLayers(){if(!this.terrain)return;const Re=[],Le=[];for(const Oe of this._mergedOrder)this.isLayerDraped(this._mergedLayers[Oe])?Re.push(Oe):Le.push(Oe);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...Re),this._drapedFirstOrder.push(...Le)}_createTerrain(Re,Le){const Oe=this.terrain=new as(Re,Le,this.scope,this.options);1===Le&&(this.stylesheet.terrain=Re),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const Ue=this._getTransitionParameters({duration:0});Oe.updateTransitions(Ue)}_force3DLayerUpdate(){for(const Re in this._layers){const Le=this._layers[Re];"fill-extrusion"===Le.type&&this._updateLayer(Le)}}_forceSymbolLayerUpdate(){for(const Re in this._layers){const Le=this._layers[Re];"symbol"===Le.type&&this._updateLayer(Le)}}_validate(Le,Oe,Ue,qe,Ct={}){if(Ct&&!1===Ct.validate)return!1;const Ot=Re.l({},this.serialize());return ro(this,Le.call(fe,Re.l({key:Oe,style:Ot,value:Ue,styleSpec:Re._},qe)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),Re.cs.off("pluginStateChange",this._rtlTextPluginCallback);for(const Re in this._mergedLayers)this._mergedLayers[Re].setEventedParent(null);for(const Re in this._mergedSourceCaches)this._mergedSourceCaches[Re].clearTiles(),this._mergedSourceCaches[Re].setEventedParent(null);this.setEventedParent(null),delete this.fog,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(Re){const Le=this.getSourceCaches(Re);for(const Re of Le)Re.clearTiles()}clearSources(){for(const Re in this._mergedSourceCaches)this._mergedSourceCaches[Re].clearTiles()}reloadSource(Re){const Le=this.getSourceCaches(Re);for(const Re of Le)Re.resume(),Re.reload()}reloadSources(){for(const Re of this.getSources())Re.reload&&Re.reload()}updateSources(Re){let Le;this.directionalLight&&(Le=Qi(this.directionalLight));for(const Oe in this._mergedSourceCaches)this._mergedSourceCaches[Oe].update(Re,void 0,void 0,Le)}_generateCollisionBoxes(){for(const Re in this._sourceCaches){const Le=this._sourceCaches[Re];Le.resume(),Le.reload()}}_updatePlacement(Le,Oe,Ue,qe,Ct,Ot,Jt=!1){let Hr=!1,Jr=!1;const Ln={},Nn={};for(const Le of this._mergedOrder){const Ue=this._mergedLayers[Le];if("symbol"!==Ue.type)continue;const qe=Re.av(Ue.source,Ue.scope);let Ct=Ln[qe];if(!Ct){const Re=this.getLayerSourceCache(Ue);if(!Re)continue;const Le=Re.getRenderableIds(!0).map((Le=>Re.getTileByID(Le)));Nn[qe]=Le.slice(),Ct=Ln[qe]=Le.sort(((Re,Le)=>Le.tileID.overscaledZ-Re.tileID.overscaledZ||(Re.tileID.isLessThan(Le.tileID)?-1:1)))}const Ot=this.crossTileSymbolIndex.addLayer(Ue,Ct,Oe.center.lng,Oe.projection);Hr=Hr||Ot}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),Jt=Jt||this._layerOrderChanged||0===qe,this._layerOrderChanged&&this.fire(new Re.x("neworder")),(Jt||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(Re.q.now(),Oe.zoom))&&(this.pauseablePlacement=new Ti(Oe,this._mergedOrder,Jt,Ue,qe,Ct,this.placement,this.fog&&Oe.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,Ln,Nn),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(Re.q.now()),Jr=!0),Hr&&this.pauseablePlacement.placement.setStale()),Jr||Hr){this._buildingIndex.onNewFrame(Oe.zoom);for(let Le=0;Le<this._mergedOrder.length;Le++){const Oe=this._mergedLayers[this._mergedOrder[Le]];if("symbol"!==Oe.type)continue;const Ue=this.isLayerClipped(Oe);this.placement.updateLayerOpacities(Oe,Ln[Re.av(Oe.source,Oe.scope)],Le,Ue?Ot:null)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(Re.q.now())}}_releaseSymbolFadeTiles(){for(const Re in this._sourceCaches)this._sourceCaches[Re].releaseSymbolFadeTiles()}addImport(Le,Oe){this._checkLoaded();const Ue=this.stylesheet.imports=this.stylesheet.imports||[];if(-1!==Ue.findIndex((({id:Re})=>Re===Le.id)))return void this.fire(new Re.t(new Error(`Import with id '${Le.id}' already exists in the map's style.`)));if(!Oe)return Ue.push(Le),this._loadImports([Le],!0);const qe=Ue.findIndex((({id:Re})=>Re===Oe));return-1===qe&&this.fire(new Re.t(new Error(`Import with id "${Oe}" does not exist on this map.`))),this.stylesheet.imports=Ue.slice(0,qe).concat(Le).concat(Ue.slice(qe)),this._loadImports([Le],!0,Oe)}updateImport(Le,Oe){this._checkLoaded();const Ue=this.stylesheet.imports||[],qe=this.getImportIndex(Le);return-1===qe?this:"string"==typeof Oe?(this.setImportUrl(Le,Oe),this):(Oe.url&&Oe.url!==Ue[qe].url&&this.setImportUrl(Le,Oe.url),Re.bh(Oe.config,Ue[qe].config)||this.setImportConfig(Le,Oe.config),Re.bh(Oe.data,Ue[qe].data)||this.setImportData(Le,Oe.data),this)}moveImport(Re,Le){this._checkLoaded();let Oe=this.stylesheet.imports||[];const Ue=this.getImportIndex(Re);if(-1===Ue)return this;const qe=this.getImportIndex(Le);if(-1===qe)return this;const Ct=Oe[Ue],Ot=this.fragments[Ue];return Oe=Oe.filter((({id:Le})=>Le!==Re)),this.fragments=this.fragments.filter((({id:Le})=>Le!==Re)),this.stylesheet.imports=Oe.slice(0,qe).concat(Ct).concat(Oe.slice(qe)),this.fragments=this.fragments.slice(0,qe).concat(Ot).concat(this.fragments.slice(qe)),this.mergeLayers(),this}setImportUrl(Re,Le){this._checkLoaded();const Oe=this.stylesheet.imports||[],Ue=this.getImportIndex(Re);if(-1===Ue)return this;Oe[Ue].url=Le;const qe=this.fragments[Ue];return qe.style=this._createFragmentStyle(Oe[Ue]),qe.style.on("style.import.load",(()=>this.mergeAll())),qe.style.loadURL(Le),this}setImportData(Re,Le){this._checkLoaded();const Oe=this.getImportIndex(Re),Ue=this.stylesheet.imports||[];return-1===Oe?this:Le?(this.fragments[Oe].style.setState(Le),this._reloadImports(),this):(delete Ue[Oe].data,this.setImportUrl(Re,Ue[Oe].url))}setImportConfig(Re,Le){this._checkLoaded();const Oe=this.getImportIndex(Re),Ue=this.stylesheet.imports||[];if(-1===Oe)return this;Le?Ue[Oe].config=Le:delete Ue[Oe].config;const qe=this.fragments[Oe],Ct=qe.style.stylesheet&&qe.style.stylesheet.schema;return qe.config=Le,qe.style.updateConfig(Le,Ct),this.updateConfigDependencies(),this}removeImport(Re){this._checkLoaded();const Le=this.stylesheet.imports||[],Oe=this.getImportIndex(Re);-1!==Oe&&(Le.splice(Oe,1),this.fragments[Oe].style._remove(),this.fragments.splice(Oe,1),this._reloadImports())}getImportIndex(Le){const Oe=(this.stylesheet.imports||[]).findIndex((Re=>Re.id===Le));return-1===Oe&&this.fire(new Re.t(new Error(`Import '${Le}' does not exist in the map's style and cannot be updated.`))),Oe}getLayer(Re){return this._mergedLayers[Re]}getSources(){const Re=[];for(const Le in this._mergedOtherSourceCaches){const Oe=this._mergedOtherSourceCaches[Le];Oe&&Re.push(Oe.getSource())}return Re}getSource(Re,Le){const Oe=this.getSourceCache(Re,Le);return Oe&&Oe.getSource()}getLayerSource(Re){const Le=this.getLayerSourceCache(Re);return Le&&Le.getSource()}getSourceCache(Le,Oe){const Ue=Re.av(Le,Oe);return this._mergedOtherSourceCaches[Ue]}getLayerSourceCache(Le){const Oe=Re.av(Le.source,Le.scope);return"symbol"===Le.type?this._mergedSymbolSourceCaches[Oe]:this._mergedOtherSourceCaches[Oe]}getSourceCaches(Re){if(null==Re)return Object.values(this._mergedSourceCaches);const Le=[];return this._mergedOtherSourceCaches[Re]&&Le.push(this._mergedOtherSourceCaches[Re]),this._mergedSymbolSourceCaches[Re]&&Le.push(this._mergedSymbolSourceCaches[Re]),Le}updateSourceCaches(){const Re=this._changes.getUpdatedSourceCaches();for(const Le in Re){const Oe=Re[Le];"reload"===Oe?this.reloadSource(Le):"clear"===Oe&&this.clearSource(Le)}}updateLayers(Re){const Le=this._changes.getUpdatedPaintProperties();for(const Oe of Le){const Le=this.getLayer(Oe);Le&&Le.updateTransitions(Re)}}getImages(Re,Le,Oe){this.imageManager.getImages(Le.icons,Le.scope,Oe),this._updateTilesForChangedImages();const o=Re=>{Re&&Re.setDependencies(Le.tileID.key,Le.type,Le.icons)};o(this._otherSourceCaches[Le.source]),o(this._symbolSourceCaches[Le.source])}getGlyphs(Re,Le,Oe){this.glyphManager.getGlyphs(Le.stacks,Le.scope,Oe)}getResource(Le,Oe,Ue){return Re.ct(Oe,Ue)}getOwnSourceCache(Re){return this._otherSourceCaches[Re]}getOwnLayerSourceCache(Re){return"symbol"===Re.type?this._symbolSourceCaches[Re.source]:this._otherSourceCaches[Re.source]}getOwnSourceCaches(Re){const Le=[];return this._otherSourceCaches[Re]&&Le.push(this._otherSourceCaches[Re]),this._symbolSourceCaches[Re]&&Le.push(this._symbolSourceCaches[Re]),Le}_isSourceCacheLoaded(Le){const Oe=this.getOwnSourceCaches(Le);return 0===Oe.length?(this.fire(new Re.t(new Error(`There is no source with ID '${Le}'`))),!1):Oe.every((Re=>Re.loaded()))}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(Re,Le){if(!this._clipLayerPresent&&"fill-extrusion"!==Re.type)return!1;const Oe="fill-extrusion"===Re.type&&"building"===Re.sourceLayer;if(Re.is3D()){if(Oe||Le&&"batched-model"===Le.type)return!0;if("model"===Re.type)return!0}else if("symbol"===Re.type)return!0;return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach((Re=>{Re.style._remove()})),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}co.getSourceType=function(Re){return il[Re]},co.setSourceType=function(Re,Le){il[Re]=Le},co.registerForPluginStateChange=Re.cc;var Nu="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#ifdef RENDER_CUTOFF\nfloat cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}\n#endif",ju="\nout vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}\n#ifdef INDICATOR_CUTOUT\nuniform vec2 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;\n#endif\nvec4 applyCutout(vec4 color) {\n#ifdef INDICATOR_CUTOUT\nfloat holeMinOpacity=u_indicator_cutout_params.x;float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);\n#else\nreturn color;\n#endif\n}\n#ifdef DEBUG_WIREFRAME\n#define HANDLE_WIREFRAME_DEBUG \\\nglFragColor=vec4(0.7,0.0,0.0,0.7); \\\ngl_FragDepth=gl_FragCoord.z-0.0001;\n#else\n#define HANDLE_WIREFRAME_DEBUG\n#endif\n#ifdef RENDER_CUTOFF\nuniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;\n#endif\nvec4 textureLodCustom(sampler2D image,highp vec2 pos,highp vec2 lod_coord) {highp vec2 size=vec2(textureSize(image,0));highp vec2 dx=dFdx(lod_coord.xy*size);highp vec2 dy=dFdy(lod_coord.xy*size);highp float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));highp float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}",Uu="\n#define EXTENT 8192.0\n#define RAD_TO_DEG 180.0/PI\n#define DEG_TO_RAD PI/180.0\n#define GLOBE_RADIUS EXTENT/PI/2.0\nfloat wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {\n#ifndef PROJECTED_POS_ON_VIEWPORT\nfloat tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;\n#else\nreturn vec3(0.0);\n#endif\n}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const vec2 units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (units_to_pixels*pos+offset)/pattern_size;}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {return get_pattern_pos(pixel_coord_upper,pixel_coord_lower,pattern_size,vec2(tile_units_to_pixels),pos);}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}\n#ifdef RENDER_CUTOFF\nuniform vec4 u_cutoff_params;out float v_cutoff_opacity;\n#endif\nconst vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)\n{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}",Hu="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",Xu="\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}\n#else\nvec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif\n#ifdef TERRAIN\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nfloat nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nreturn currentElevation(apos);}\n#endif\nvec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }\n#endif\n#ifdef DEPTH_OCCLUSION\nuniform highp sampler2D u_depth;uniform highp vec2 u_depth_size_inv;uniform highp vec2 u_depth_range_unpack;uniform highp float u_occluder_half_size;uniform highp float u_occlusion_depth_offset;\n#ifdef DEPTH_D24\nfloat unpack_depth(float depth) {return depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}vec4 unpack_depth4(vec4 depth) {return depth*u_depth_range_unpack.x+vec4(u_depth_range_unpack.y);}\n#else\nhighp float unpack_depth_rgba(vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}\n#endif\nbool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;\n#ifdef DEPTH_D24\nfloat depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5).r);\n#else\nfloat depth=unpack_depth_rgba(texture(u_depth,(coord.xy+1.0)*0.5));\n#endif\nreturn coord.z+u_occlusion_depth_offset > depth;}highp vec4 getCornerDepths(vec2 coord) {highp vec3 df=vec3(u_occluder_half_size*u_depth_size_inv,0.0);highp vec2 uv=0.5*coord.xy+0.5;\n#ifdef DEPTH_D24\nhighp vec4 depth=vec4(\ntexture(u_depth,uv-df.xz).r,texture(u_depth,uv+df.xz).r,texture(u_depth,uv-df.zy).r,texture(u_depth,uv+df.zy).r\n);depth=unpack_depth4(depth);\n#else\nhighp vec4 depth=vec4(\nunpack_depth_rgba(texture(u_depth,uv-df.xz)),unpack_depth_rgba(texture(u_depth,uv+df.xz)),unpack_depth_rgba(texture(u_depth,uv-df.zy)),unpack_depth_rgba(texture(u_depth,uv+df.zy))\n);\n#endif\nreturn depth;}highp float occlusionFadeMultiSample(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec2 uv=0.5*coord.xy+0.5;int NX=3;int NY=4;highp vec2 df=u_occluder_half_size*u_depth_size_inv;highp vec2 oneStep=2.0*u_occluder_half_size*u_depth_size_inv/vec2(NX-1,NY-1);highp float res=0.0;for (int y=0; y < NY;++y) {for (int x=0; x < NX;++x) {\n#ifdef DEPTH_D24\nhighp float depth=unpack_depth(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)).r);\n#else\nhighp float depth=unpack_depth_rgba(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)));\n#endif\nres+=1.0-clamp(300.0*(coord.z+u_occlusion_depth_offset-depth),0.0,1.0);}}res=clamp(2.0*res/float(NX*NY)-0.5,0.0,1.0);return res;}highp float occlusionFade(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec4 depth=getCornerDepths(coord.xy);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z+u_occlusion_depth_offset)-depth),0.0,1.0));}\n#else\nbool isOccluded(vec4 frag) { return false; }highp float occlusionFade(vec4 frag) { return 1.0; }highp float occlusionFadeMultiSample(vec4 frag) { return 1.0; }\n#endif//DEPTH_OCCLUSION",Yu="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",Ku="highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}\n#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {\n#ifdef FOG_DITHERING\nvec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);\n#else\nreturn color;\n#endif\n}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif",Ju="#ifdef RASTER_ARRAY\nuniform sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)\n);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)\n);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}\n#endif",Qu="#ifdef RASTER_ARRAY\nuniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec2 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=u_data_offset+vec2(dot(t.rg,u_data_scale),dot(t.ba,u_data_scale));velocity.y=-velocity.y;velocity/=max(u_max_speed,length(velocity));return velocity;}\n#endif\nuniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}",eh="#ifdef RENDER_SHADOWS\nuniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {vec3 transformed_normal=vec3(-normal.xy,normal.z);float NDotL=dot(normalize(transformed_normal),u_shadow_direction);float dotScale=min(1.0-NDotL,1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}\n#endif//RENDER_SHADOWS",th="#ifdef RENDER_SHADOWS\n#ifdef DEPTH_TEXTURE\nuniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;\n#else\nuniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;\n#endif\nuniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;\n#ifdef DEPTH_TEXTURE\nshadow_depth=texture(u_shadowmap_1,uv).r;\n#else\nshadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;\n#endif\nreturn step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;\n#ifdef DEPTH_TEXTURE\nshadow_depth=texture(u_shadowmap_0,uv).r;\n#else\nshadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;\n#endif\nreturn step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;\n#ifdef NATIVE\nhighp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));\n#else\nhighp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(\nshadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)\n);\n#endif\nvec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return mix(lerpx.x,lerpx.y,f.y);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {\n#ifdef SHADOWS_SINGLE_CASCADE\nlight_view_pos0.xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);\n#else\nlight_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth));\n#endif\n}highp float calculate_shadow_bias(float NDotL) {\n#ifdef NORMAL_OFFSET\nreturn 0.5*u_shadow_bias.x;\n#else\nreturn 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));\n#endif\n}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_opacity(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,float shadow_opacity) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias)*shadow_opacity;return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}\n#endif";const rh=[];Do(Nu,rh),Do(Uu,rh),Do(ju,rh);const nh={"_prelude_fog.vertex.glsl":Yu,"_prelude_terrain.vertex.glsl":Xu,"_prelude_shadow.vertex.glsl":eh,"_prelude_fog.fragment.glsl":Ku,"_prelude_shadow.fragment.glsl":th,"_prelude_lighting.glsl":"\n#ifdef LIGHTING_3D_MODE\nuniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}\n#endif//LIGHTING_3D_MODE","_prelude_raster_array.glsl":Ju,"_prelude_raster_particle.glsl":Qu},ih={};Ro("",Xu),Ro(Ku,Yu),Ro(th,eh),Ro(Ju,""),Ro(Qu,"");const sh=Ro(ju,Uu),ah=Nu;var ch={background:Ro('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform vec4 u_color;uniform float u_opacity;\n#ifdef LIGHTING_3D_MODE\nin vec4 v_color;\n#endif\nvoid main() {vec4 out_color;\n#ifdef LIGHTING_3D_MODE\nout_color=v_color;\n#else\nout_color=u_color;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_lighting.glsl"\nin vec2 a_pos;uniform mat4 u_matrix;\n#ifdef LIGHTING_3D_MODE\nuniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),backgroundPattern:Ro('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in highp vec2 v_pos;void main() {highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec2 u_pattern_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_pattern_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),circle:Ro('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nin vec3 v_data;in float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nuniform float u_emissive_strength;void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float blur_positive=blur < 0.0 ? 0.0 : 1.0;lowp float antialiasblur=v_data.z;float extrude_length=length(extrude)+antialiasblur*(1.0-blur_positive);float antialiased_blur=-max(abs(blur),antialiasblur);float opacity_t=smoothstep((1.0-blur_positive)*antialiased_blur,blur_positive*antialiased_blur,extrude_length-1.0)-smoothstep(0.0,antialiasblur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\nglFragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\n}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\n#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nout vec3 v_data;out float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\n#ifdef PROJECTION_GLOBE_VIEW\nreturn u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );\n#else\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#endif\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);\n#else \nsurface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);\n#endif\nvec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nocclusion_world_center=world_center;occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}'),clippingMask:Ro("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Ro('#include "_prelude_fog.fragment.glsl"\nuniform highp float u_intensity;in vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\nif (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_terrain.vertex.glsl"\n#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nout vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#else\npos=vec3(tilePos+extrude,elevation(tilePos));\n#endif\ngl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}'),heatmapTexture:Ro("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(0.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}","in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Ro("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",'#include "_prelude_terrain.vertex.glsl"\nin vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in vec2 a_elevation_from_sea;in float a_size_scale;in vec2 a_padding;in float a_auto_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {float feature_elevation=a_elevation_from_sea.x+a_auto_z_offset;float terrain_elevation=(a_elevation_from_sea.y==1.0 ? 0.0 : elevation(a_anchor_pos));vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(feature_elevation+terrain_elevation),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}'),collisionCircle:Ro("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}","in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Ro("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",'#include "_prelude_terrain.vertex.glsl"\nin vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;\n#endif\nout vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\ngl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);\n#else\ngl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);\n#endif\n}'),fill:Ro('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nuniform float u_emissive_strength;void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nin vec2 a_pos;\n#ifdef ELEVATED_ROADS\nin float a_road_z_offset;\n#endif\nuniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp float z_offset\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp float z_offset\n#ifdef ELEVATED_ROADS\nz_offset+=a_road_z_offset;\n#endif\nfloat hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),fillOutline:Ro('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nin highp vec2 v_pos;uniform float u_emissive_strength;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nin vec2 a_pos;\n#ifdef ELEVATED_ROADS\nin float a_road_z_offset;\n#endif\nuniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp float z_offset\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp float z_offset\n#ifdef ELEVATED_ROADS\nz_offset+=a_road_z_offset;\n#endif\nfloat hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),fillOutlinePattern:Ro('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;in highp vec2 v_pos;in highp vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;\n#ifdef ELEVATED_ROADS\nin float a_road_z_offset;\n#endif\nout highp vec2 v_pos;out highp vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\n#pragma mapbox: define highp float z_offset\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\n#pragma mapbox: initialize highp float z_offset\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;\n#ifdef ELEVATED_ROADS\nz_offset+=a_road_z_offset;\n#endif\nfloat hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),fillPattern:Ro('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform vec2 u_texsize;uniform sampler2D u_image;in highp vec2 v_pos;uniform float u_emissive_strength;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;\n#ifdef ELEVATED_ROADS\nin float a_road_z_offset;\n#endif\nout highp vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\n#pragma mapbox: define highp float z_offset\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\n#pragma mapbox: initialize highp float z_offset\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;\n#ifdef ELEVATED_ROADS\nz_offset+=a_road_z_offset;\n#endif\nfloat hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),fillExtrusion:Ro('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_shadow.fragment.glsl"\n#include "_prelude_lighting.glsl"\nin vec4 v_color;in vec4 v_flat;\n#ifdef RENDER_SHADOWS\nin highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;\n#endif\nuniform lowp float u_opacity;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;in vec2 v_ao;\n#endif\n#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)\nin vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)\nin highp vec3 v_normal;\n#endif\nuniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;\n#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)\nin float v_flood_radius;in float v_has_floodlight;\n#endif\nin float v_height;\n#pragma mapbox: define highp float emissive_strength\nvoid main() {\n#pragma mapbox: initialize highp float emissive_strength\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)\nvec3 normal=normalize(v_normal);\n#endif\nfloat z;vec4 color=v_color;\n#ifdef ZERO_ROOF_RADIUS\nz=float(normal.z > 0.00001);\n#ifdef LIGHTING_3D_MODE\nnormal=mix(normal,vec3(0.0,0.0,1.0),z);\n#else\ncolor=mix(v_color,v_roof_color,z);\n#endif\n#endif\nfloat h=max(0.0,v_height);float ao_shade=1.0;\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;\n#ifdef ZERO_ROOF_RADIUS\nconcave*=(1.0-z);\n#endif\nfloat x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);\n#ifdef LIGHTING_3D_MODE\n#ifdef FLOOD_LIGHT\ncolor.rgb*=mix(ao_shade,1.0,v_has_floodlight);\n#else\ncolor.rgb*=ao_shade;\n#endif\n#else\ncolor.rgb*=ao_shade;\n#endif\n#endif\n#ifdef LIGHTING_3D_MODE\nfloat flood_radiance=0.0;\n#ifdef FLOOD_LIGHT\nflood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;\n#endif\n#ifdef RENDER_SHADOWS\n#ifdef FLOOD_LIGHT\nfloat ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);\n#else\nfloat shadowed_lighting_factor;\n#ifdef RENDER_CUTOFF\nshadowed_lighting_factor=shadowed_light_factor_normal_opacity(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}\n#else\nshadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);\n#endif\ncolor.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);\n#endif\n#else\ncolor.rgb=apply_lighting(color.rgb,normal);\n#ifdef FLOOD_LIGHT\ncolor.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);\n#endif\n#endif\ncolor.rgb=mix(color.rgb,v_flat.rgb,emissive_strength);color*=u_opacity;\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));\n#endif\n#ifdef INDICATOR_CUTOUT\ncolor=applyCutout(color);\n#endif\nglFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\n#include "_prelude_shadow.vertex.glsl"\n#include "_prelude_lighting.glsl"\nuniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;uniform float u_width_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;\n#ifdef RENDER_WALL_MODE\nin vec3 a_join_normal_inside;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nuniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;\n#endif\n#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)\nout vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)\nout highp vec3 v_normal;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;out vec2 v_ao;\n#endif\n#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)\nout float v_flood_radius;out float v_has_floodlight;\n#endif\nout float v_height;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define highp float flood_light_wall_radius\n#pragma mapbox: define highp float line_width\n#pragma mapbox: define highp float emissive_strength\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize highp float flood_light_wall_radius\n#pragma mapbox: initialize highp float line_width\n#pragma mapbox: initialize highp float emissive_strength\nbase*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)\nv_normal=normal;\n#endif\nbase=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);\n#else\nh=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat cutoff=1.0;vec3 scaled_pos=pos;\n#ifdef RENDER_CUTOFF\nvec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=cutoff_opacity(u_cutoff_params,ground.z);if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;v_cutoff_opacity=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);\n#endif\nfloat hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff==0.0 && centroid_pos.x !=0.0) || (color.a==0.0));\n#ifdef RENDER_WALL_MODE\nvec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);scaled_pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;scaled_pos.xy-=a_join_normal_inside.z*wall_offset*0.5;\n#endif\ngl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;\n#ifdef RENDER_SHADOWS\nvec3 shd_pos0=pos;vec3 shd_pos1=pos;\n#ifdef NORMAL_OFFSET\nvec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();\n#endif\nv_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);\n#endif\nfloat NdotL=0.0;float colorvalue=0.0;\n#ifndef LIGHTING_3D_MODE\ncolorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#endif\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\n#ifdef FLOOD_LIGHT\nfloat is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;\n#endif\nv_color=vec4(color.rgb,1.0);v_flat=vec4(linearProduct(color.rgb,vec3(calculate_NdotL(normal))),1.0);\n#else\nv_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;\n#endif\n#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)\nfloat roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}'),fillExtrusionDepth:Ro("in highp float v_depth;void main() {\n#ifndef DEPTH_TEXTURE\nglFragColor=pack_depth(v_depth);\n#endif\n}",'#include "_prelude_terrain.vertex.glsl"\nuniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_width_scale;uniform float u_vertical_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;\n#ifdef RENDER_WALL_MODE\nin vec3 a_join_normal_inside;\n#endif\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp float line_width\n#pragma mapbox: define highp vec4 color\nout highp float v_depth;void main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp float line_width\n#pragma mapbox: initialize highp vec4 color\nbase*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nvec3 pos;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base);pos=vec3(pos_nx.xy,h);\n#else\npos=vec3(pos_nx.xy,t > 0.0 ? height : base);\n#endif\n#ifdef RENDER_WALL_MODE\nvec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;pos.xy-=a_join_normal_inside.z*wall_offset*0.5;\n#endif\nfloat hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}'),fillExtrusionPattern:Ro('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform vec2 u_texsize;uniform sampler2D u_image;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;in vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nin vec3 v_normal;\n#endif\nin highp vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define mediump vec4 pattern\n#pragma mapbox: define highp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize highp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;\n#else\nout_color=out_color*v_lighting;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\n#ifdef INDICATOR_CUTOUT\nout_color=applyCutout(out_color);\n#endif\nglFragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\n#include "_prelude_lighting.glsl"\nuniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_width_scale;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;\n#ifdef RENDER_WALL_MODE\nin vec3 a_join_normal_inside;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nout highp vec2 v_pos;out vec4 v_lighting;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;out vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nout vec3 v_normal;\n#endif\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define mediump vec4 pattern\n#pragma mapbox: define highp float pixel_ratio\n#pragma mapbox: define highp float line_width\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize highp float pixel_ratio\n#pragma mapbox: initialize highp float line_width\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=z;vec3 p;float c_ele;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);\n#else\np=vec3(pos_nx.xy,z);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\n#ifdef RENDER_WALL_MODE\nvec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);p.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;p.xy-=a_join_normal_inside.z*wall_offset*0.5;\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\nNdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_normal=normal;\n#else\nv_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#endif \n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}'),groundShadow:Ro('#include "_prelude_shadow.fragment.glsl"\nprecision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;\n#ifdef FOG\nin float v_fog_opacity;\n#endif\nvoid main() {float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);\n#ifdef RENDER_CUTOFF\nshadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));\n#endif\n#ifdef FOG\nshadow=mix(shadow,vec3(1.0),v_fog_opacity);\n#endif\n#ifdef INDICATOR_CUTOUT\nshadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0)).r);\n#endif\nglFragColor=vec4(shadow,1.0);}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;\n#ifdef FOG\nout float v_fog_opacity;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);\n#endif\n}'),fillExtrusionGroundEffect:Ro("uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;\n#ifdef SDF_SUBPASS\nin highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}\n#ifdef FOG\nin highp float v_fog;\n#endif\n#endif\nvoid main() {\n#ifdef CLEAR_SUBPASS\nvec4 color=vec4(1.0);\n#ifdef CLEAR_FROM_TEXTURE\ncolor=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));\n#endif\nglFragColor=color;\n#else\n#ifdef SDF_SUBPASS\nhighp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;\n#ifdef FOG\nfog=v_fog;\n#endif\n#ifdef RENDER_CUTOFF\nfog*=v_cutoff_opacity;\n#endif\nglFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));\n#else\nvec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);\n#ifdef OVERDRAW_INSPECTOR\ncolor=vec4(1.0);\n#endif\nglFragColor=color;\n#endif\nHANDLE_WIREFRAME_DEBUG;\n#endif\n}",'#include "_prelude_fog.vertex.glsl"\nin highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;\n#ifdef SDF_SUBPASS\nout highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;\n#ifdef FOG\nout highp float v_fog;\n#endif\n#endif\nuniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp float u_dynamic_offset;uniform highp vec2 u_ao;\n#pragma mapbox: define highp float flood_light_ground_radius\nconst float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {\n#pragma mapbox: initialize highp float flood_light_ground_radius\nvec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(u_dynamic_offset,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;\n#ifdef SDF_SUBPASS\nv_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);\n#ifdef FOG\nv_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);\n#endif\n#endif\nfloat hidden_by_landmark=0.0;\n#ifdef HAS_CENTROID\nhidden_by_landmark=a_hidden_by_landmark;\n#endif\nfloat isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));\n#ifdef RENDER_CUTOFF\nv_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);\n#endif\n}'),hillshadePrepare:Ro("precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}","uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Ro('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef LIGHTING_3D_MODE\nglFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);\n#endif\n#ifdef FOG\nglFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),line:Ro('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;in vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;\n#endif\nfloat luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float border_width\n#pragma mapbox: define lowp vec4 border_color\nfloat linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float border_width\n#pragma mapbox: initialize lowp vec4 border_color\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\nhighp vec4 out_color;\n#ifdef RENDER_LINE_GRADIENT\nout_color=texture(u_gradient_image,v_uv.xy);\n#else\nout_color=color;\n#endif\nfloat trim_alpha=1.0;\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=out_color.a;}\n#endif\nif (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}\n#ifdef RENDER_LINE_BORDER\nfloat edgeBlur=(border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color.rgb=mix(border_color.rgb*border_color.a*trim_alpha,out_color.rgb,smoothAlpha);}}\n#endif\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nout_color*=(alpha*opacity);\n#ifdef INDICATOR_CUTOUT\nout_color=applyCutout(out_color);\n#endif\nglFragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\n#define EXTRUDE_SCALE 0.015873016\nin vec2 a_pos_normal;in vec4 a_data;\n#if defined(ELEVATED) || defined(ELEVATED_ROADS)\nin float a_z_offset;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nin highp vec4 a_packed;\n#endif\n#ifdef RENDER_LINE_DASH\nin float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float border_width\n#pragma mapbox: define lowp vec4 border_color\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float border_width\n#pragma mapbox: initialize lowp vec4 border_color\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);\n#ifdef ELEVATED_ROADS\ngl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset+0.01*step(0.01,a_z_offset),1.0)+projected_extrude;\n#else\n#ifdef ELEVATED\nvec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 halfCellProgress=normal.yx*32.0;float ele0=elevation(pos);float ele_line=max(ele0,max(elevation(pos+halfCellProgress),elevation(pos-halfCellProgress)));float ele1=elevation(pos+offsetTile);float ele2=elevation(pos-offsetTile);float ele_max=max(ele_line,0.5*(ele1+ele2));float ele=ele_max-ele0+ele1+a_z_offset ;gl_Position=u_matrix*vec4(pos+offsetTile,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*0.1*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);\n#else\ngl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);\n#endif\n#endif\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];\n#ifdef RENDER_LINE_GRADIENT\nhighp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);\n#else\nv_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\n#endif\n#ifdef RENDER_LINE_DASH\nfloat scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}'),linePattern:Ro('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform highp float u_device_pixel_ratio;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;\n#ifdef RENDER_LINE_TRIM_OFFSET\nin highp vec4 v_uv;\n#endif\n#ifdef LINE_JOIN_NONE\nin vec2 v_pattern_data;\n#endif\n#pragma mapbox: define mediump vec4 pattern\n#pragma mapbox: define mediump float pixel_ratio\n#pragma mapbox: define mediump float blur\n#pragma mapbox: define mediump float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize mediump float pixel_ratio\n#pragma mapbox: initialize mediump float blur\n#pragma mapbox: initialize mediump float opacity\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;highp float x=mod(pattern_x,1.0);highp float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;highp vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));highp vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {color=vec4(0,0,0,0);}}\n#endif\n#ifdef LINE_JOIN_NONE\nfloat pattern_len=pattern_size/aspect;float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}\n#endif\n#ifdef LIGHTING_3D_MODE\ncolor=apply_lighting_ground(color);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ncolor*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}\n#ifdef INDICATOR_CUTOUT\ncolor=applyCutout(color);\n#endif\nglFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\n#define scale 0.015873016\nin vec2 a_pos_normal;in vec4 a_data;\n#if defined(ELEVATED) || defined(ELEVATED_ROADS)\nin float a_z_offset;\n#endif\n#ifdef RENDER_LINE_TRIM_OFFSET\nin highp vec4 a_packed;\n#endif\nin highp float a_linesofar;\n#ifdef LINE_JOIN_NONE\nin highp vec3 a_pattern_data;out vec2 v_pattern_data;\n#endif\nuniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;\n#ifdef RENDER_LINE_TRIM_OFFSET\nout highp vec4 v_uv;\n#endif\n#pragma mapbox: define mediump float blur\n#pragma mapbox: define mediump float opacity\n#pragma mapbox: define mediump float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define mediump float floorwidth\n#pragma mapbox: define mediump vec4 pattern\n#pragma mapbox: define mediump float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize mediump float blur\n#pragma mapbox: initialize mediump float opacity\n#pragma mapbox: initialize mediump float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize mediump float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize mediump float pixel_ratio\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);\n#ifdef ELEVATED_ROADS\ngl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset+0.01*step(0.01,a_z_offset),1.0)+projected_extrude;\n#else\n#ifdef ELEVATED\nvec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 halfCellProgress=normal.yx*32.0;float ele0=elevation(pos);float ele_line=max(ele0,max(elevation(pos+halfCellProgress),elevation(pos-halfCellProgress)));float ele1=elevation(pos+offsetTile);float ele2=elevation(pos-offsetTile);float ele_max=max(ele_line,0.5*(ele1+ele2));float ele=ele_max-ele0+ele1+a_z_offset ;gl_Position=u_matrix*vec4(pos+offsetTile,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*0.1*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);\n#else\ngl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);\n#endif\n#endif\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#ifdef RENDER_LINE_TRIM_OFFSET\nfloat a_uv_x=a_packed[0];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef LINE_JOIN_NONE\nv_width=floorwidth+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}'),raster:Ro('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\n#include "_prelude_raster_array.glsl"\nuniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;\n#ifdef PROJECTION_GLOBE_VIEW\nin float v_split_fade;\n#endif\nuniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;\n#ifndef RASTER_ARRAY\nuniform sampler2D u_image0;uniform sampler2D u_image1;\n#endif\n#ifdef RASTER_COLOR\nuniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;\n#endif\nvoid main() {vec4 color0,color1,color;vec2 value;\n#ifdef RASTER_COLOR\n#ifdef RASTER_ARRAY\n#ifdef RASTER_ARRAY_LINEAR\nvalue=mix(\nraTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t\n);\n#else\nvalue=mix(\nraTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t\n);\n#endif\nif (value.y > 0.0) value.x/=value.y;\n#else\ncolor=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);\n#endif\ncolor=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;\n#else\ncolor0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);\n#endif\ncolor.a*=u_opacity;\n#ifdef GLOBE_POLES\ncolor.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);\n#endif\nvec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;\n#endif\n#ifdef FOG\nhighp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));\n#endif\nglFragColor=vec4(out_color*color.a,color.a);\n#ifdef PROJECTION_GLOBE_VIEW\nglFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));\n#endif\n#ifdef RENDER_CUTOFF\nglFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);\n#endif\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;\n#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8\n#ifdef GLOBE_POLES\nin vec3 a_globe_pos;in vec2 a_uv;\n#else\nin vec2 a_pos;in vec2 a_texture_pos;\n#endif\nout vec2 v_pos0;out vec2 v_pos1;out float v_depth;\n#ifdef PROJECTION_GLOBE_VIEW\nout float v_split_fade;\n#endif\nvoid main() {vec2 uv;\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);\n#endif\n#else\nfloat w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    \nv_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n#else\ngl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n#endif\n#endif\nv_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;\n#ifdef RENDER_CUTOFF\nv_depth=gl_Position.z;\n#endif\n}'),rasterParticle:Ro('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;\n#endif\n#ifdef FOG\nhighp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));\n#endif\nglFragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;\n#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8\nin vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n#else\nuv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n#endif\nv_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}'),rasterParticleDraw:Ro("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",'#include "_prelude_raster_particle.glsl"\nin float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(\nmod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-1.0,0,1);v_particle_speed=length(velocity);}gl_PointSize=1.0;}'),rasterParticleTexture:Ro("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:Ro('#include "_prelude_raster_particle.glsl"\nuniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;vec2 linearstep(vec2 edge0,vec2 edge1,vec2 x) {return  clamp((x-edge0)/(edge1-edge0),vec2(0),vec2(1));}const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp vec2 persist_rate=pow(\nlinearstep(vec2(-u_particle_pos_offset),vec2(0),pos)*linearstep(vec2(1.0+u_particle_pos_offset),vec2(1),pos),vec2(4)\n);highp vec2 per_frame_persist=pow(persist_rate,abs(dp)/u_particle_pos_offset);highp float drop_rate=1.0-per_frame_persist.x*per_frame_persist.y;drop_rate=any(greaterThanEqual(abs(pos-0.5),vec2(0.5+u_particle_pos_offset))) ? 1.0 : drop_rate;highp float drop=step(1.0-drop_rate-u_reset_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}',"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbol:Ro('#include "_prelude_lighting.glsl"\n#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;\n#ifdef ICON_TRANSITION\nuniform float u_icon_transition;\n#endif\n#ifdef COLOR_ADJUSTMENT\nuniform mat4 u_color_adj_mat;\n#endif\nin vec2 v_tex_a;\n#ifdef ICON_TRANSITION\nin vec2 v_tex_b;\n#endif\nin float v_draw_halo;in vec3 v_gamma_scale_size_fade_opacity;\n#ifdef RENDER_TEXT_AND_SYMBOL\nin float is_sdf;in vec2 v_tex_a_icon;\n#endif\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n#pragma mapbox: define lowp float emissive_strength\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\n#pragma mapbox: initialize lowp float emissive_strength\nvec4 out_color;float fade_opacity=v_gamma_scale_size_fade_opacity[2];\n#ifdef RENDER_TEXT_AND_SYMBOL\nif (is_sdf==ICON) {vec2 tex_icon=v_tex_a_icon;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nreturn;}\n#endif\n#ifdef RENDER_SDF\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_gamma_scale_size_fade_opacity.x;float size=v_gamma_scale_size_fade_opacity.y;float fontScale=u_is_text ? size/24.0 : size;out_color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {out_color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,v_tex_a).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);out_color*=alpha;\n#else\n#ifdef ICON_TRANSITION\nvec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);\n#else\nout_color=texture(u_texture,v_tex_a);\n#endif\n#ifdef COLOR_ADJUSTMENT\nout_color=u_color_adj_mat*out_color;\n#endif\n#endif\nout_color*=opacity*fade_opacity;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,emissive_strength);\n#endif\nglFragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_terrain.vertex.glsl"\nin vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;\n#ifdef Z_OFFSET\nin float a_auto_z_offset;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_globe_anchor;in vec3 a_globe_normal;\n#endif\n#ifdef ICON_TRANSITION\nin vec2 a_texb;\n#endif\n#ifdef OCCLUSION_QUERIES\nin float a_occlusion_query_opacity;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_elevation_from_sea;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nout vec2 v_tex_a;\n#ifdef ICON_TRANSITION\nout vec2 v_tex_b;\n#endif\nout float v_draw_halo;out vec3 v_gamma_scale_size_fade_opacity;\n#ifdef RENDER_TEXT_AND_SYMBOL\nout float is_sdf;out vec2 v_tex_a_icon;\n#endif\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n#pragma mapbox: define lowp float emissive_strength\n#pragma mapbox: define lowp float occlusion_opacity\n#pragma mapbox: define lowp float z_offset\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\n#pragma mapbox: initialize lowp float emissive_strength\n#pragma mapbox: initialize lowp float occlusion_opacity\n#pragma mapbox: initialize lowp float z_offset\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=u_elevation_from_sea ? z_offset : z_offset+elevation(tile_anchor);\n#ifdef Z_OFFSET\ne+=a_auto_z_offset;\n#endif\nvec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;\n#else\noffsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;\n#endif\nvec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\n#ifdef Z_OFFSET\nz+=u_pitch_with_map ? a_auto_z_offset+(u_elevation_from_sea ? z_offset : z_offset) : 0.0;\n#else\nz+=u_pitch_with_map ? (u_elevation_from_sea ? z_offset : z_offset) : 0.0;\n#endif\nfloat occlusion_fade=globe_occlusion_fade;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;\n#ifdef DEPTH_OCCLUSION\nfloat depth_occlusion=occlusionFadeMultiSample(projected_point);float depth_occlusion_multplier=mix(occlusion_opacity,1.0,depth_occlusion);out_fade_opacity*=depth_occlusion_multplier;\n#endif\n#ifdef OCCLUSION_QUERIES\nfloat occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;\n#endif\nfloat alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);\n#endif\nfloat gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_gamma_scale_size_fade_opacity=vec3(gamma_scale,size,out_fade_opacity);v_tex_a=a_tex/u_texsize;\n#ifdef RENDER_TEXT_AND_SYMBOL\nis_sdf=a_size[0]-2.0*a_size_min;v_tex_a_icon=a_tex/u_texsize_icon;\n#endif\n#ifdef ICON_TRANSITION\nv_tex_b=a_texb/u_texsize;\n#endif\n}'),terrainRaster:Ro('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_shadow.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform sampler2D u_image0;in vec2 v_pos0;\n#ifdef FOG\nin float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nin vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;\n#endif\nuniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;\n#ifdef LIGHTING_3D_MODE\nconst vec3 normal=vec3(0.0,0.0,1.0);\n#ifdef RENDER_SHADOWS\nfloat cutoffOpacity=1.0;\n#ifdef RENDER_CUTOFF\ncutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);\n#endif\n#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS\nvec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;\n#else\nfloat lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));\n#endif\n#else\nfloat lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);\n#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS\ncolor.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;\n#endif\n#endif\n#else\ncolor=image_color;\n#endif\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#else\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\n#endif\nglFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\nuniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;\n#ifdef FOG\nout float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;\n#endif\nvoid main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\nv_fog_pos=fog_position(decodedPos);\n#else\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);\n#endif\n}'),terrainDepth:Ro("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",'#include "_prelude_terrain.vertex.glsl"\nuniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}'),skybox:Ro('#include "_prelude_fog.fragment.glsl"\nin lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\n}',Hu),skyboxGradient:Ro('#include "_prelude_fog.fragment.glsl"\nin highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);glFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\n}',Hu),skyboxCapture:Ro("\nin highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}","in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Ro('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;\n#ifndef FOG\nuniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;\n#endif\nvoid main() {vec4 color;\n#ifdef CUSTOM_ANTIALIASING\nvec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);\n#ifdef LIGHTING_3D_MODE\n#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS\nraster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(raster.rgb*antialias,antialias);\n#else\nraster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);\n#endif\n#else\ncolor=vec4(raster.rgb*antialias,raster.a*antialias);\n#endif\n#else\ncolor=texture(u_image0,v_pos0);\n#ifdef LIGHTING_3D_MODE\n#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS\ncolor=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;\n#else\ncolor=apply_lighting_ground(color);\n#endif\n#endif\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ncolor*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\nuniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;\n#ifdef GLOBE_POLES\nin vec3 a_globe_pos;in vec2 a_uv;\n#else\nin vec2 a_pos;\n#endif\nout vec2 v_pos0;void main() {\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;vec2 uv=a_uv;\n#else\nfloat tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);\n#endif\nv_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;\n#ifdef GLOBE_POLES\nvec3 up_vector=globe_derived_up_vector;\n#else\nvec3 up_vector=elevationVector(tile_pos);\n#endif\nfloat height=elevation(tile_pos);globe_pos+=up_vector*height;\n#ifndef GLOBE_POLES\nglobe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;\n#endif\n#ifdef GLOBE_POLES\nvec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);\n#else\nvec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);\n#endif\ngl_Position=u_proj_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n}'),globeAtmosphere:Ro('#include "_prelude_fog.fragment.glsl"\nuniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;\n#ifdef PROJECTION_GLOBE_VIEW\nglobe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {\n#ifdef ALPHA_PASS\nglFragColor=vec4(0,0,0,0);return;\n#else\n#ifdef NATIVE\nglFragColor=vec4(1,1,1,1);\n#else\nglFragColor=vec4(0,0,0,1);\n#endif\nreturn;\n#endif\n}\n#endif\nhighp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?\n0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;\n#ifdef PROJECTION_GLOBE_VIEW\nhighp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?\nPI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);\n#else\nhorizon_angle=horizon_angle_mercator;\n#endif\nhorizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;\n#ifdef ALPHA_PASS\nfloat a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);\n#else\nvec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;\n#ifndef NATIVE\nc=dither(c,gl_FragCoord.xy+u_temporal_offset);\n#endif\nglFragColor=vec4(c*t,t);\n#endif\n}',"in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(\nmix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}"),model:Ro('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_shadow.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;\n#ifdef RENDER_SHADOWS\nin highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;\n#endif\n#ifdef OCCLUSION_TEXTURE_TRANSFORM\nuniform vec4 u_occlusionTextureTransform;\n#endif\n#pragma mapbox: define-attribute highp vec3 normal_3f\n#pragma mapbox: define-attribute highp vec3 color_3f\n#pragma mapbox: define-attribute highp vec4 color_4f\n#pragma mapbox: define-attribute highp vec2 uv_2f\n#pragma mapbox: initialize-attribute highp vec3 normal_3f\n#pragma mapbox: initialize-attribute highp vec3 color_3f\n#pragma mapbox: initialize-attribute highp vec4 color_4f\n#pragma mapbox: initialize-attribute highp vec2 uv_2f\n#ifdef HAS_ATTRIBUTE_a_pbr\nin lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;\n#endif\n#ifdef HAS_TEXTURE_u_baseColorTexture\nuniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;\n#endif\n#ifdef HAS_TEXTURE_u_metallicRoughnessTexture\nuniform sampler2D u_metallicRoughnessTexture;\n#endif\n#ifdef HAS_TEXTURE_u_occlusionTexture\nuniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;\n#endif\n#ifdef HAS_TEXTURE_u_normalTexture\nuniform sampler2D u_normalTexture;\n#endif\n#ifdef HAS_TEXTURE_u_emissionTexture\nuniform sampler2D u_emissionTexture;\n#endif\n#ifdef APPLY_LUT_ON_GPU\nuniform highp sampler3D u_lutTexture;\n#endif\n#ifdef TERRAIN_FRAGMENT_OCCLUSION\nin highp float v_depth;uniform highp sampler2D u_depthTexture;uniform highp vec2 u_inv_depth_size;uniform highp vec2 u_depth_range_unpack;\n#ifdef DEPTH_D24\nhighp float unpack_depth(highp float depth) {return  depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}\n#else\nhighp float unpack_depth_rgba(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}\n#endif\nbool isOccluded() {highp vec2 coord=gl_FragCoord.xy*u_inv_depth_size;\n#ifdef DEPTH_D24\nhighp float depth=unpack_depth(texture(u_depthTexture,coord).r);\n#else\nhighp float depth=unpack_depth_rgba(texture(u_depthTexture,coord));\n#endif\nreturn v_depth > depth+0.0005;}\n#endif\n#define saturate(_x) clamp(_x,0.,1.)\nvec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)\n{\n#ifdef LIGHTING_3D_MODE\nvec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;\n#ifdef RENDER_SHADOWS\nlighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);\n#else\nlighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));\n#endif\nreturn apply_lighting(albedo,transformed_normal,lighting_factor);\n#else\nvec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;\n#endif\n}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;\n#ifdef HAS_ATTRIBUTE_a_color_3f\nalbedo*=vec4(color_3f,1.0);\n#endif\n#ifdef HAS_ATTRIBUTE_a_pbr\n#else\n#ifdef HAS_ATTRIBUTE_a_color_4f\nalbedo*=color_4f;\n#endif\n#endif\n#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)\nvec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}\n#ifdef UNPREMULT_TEXTURE_IN_SHADER\nif(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;\n#endif\nif(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}\n#endif\nvec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);\n#ifdef APPLY_LUT_ON_GPU\ncolor=applyLUT(u_lutTexture,color);\n#endif\nreturn color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {\n#ifdef HAS_TEXTURE_u_normalTexture\nhighp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;\n#else\nreturn mat3(1.0);\n#endif\n}highp vec3 getNormal(){highp vec3 n;\n#ifdef HAS_ATTRIBUTE_a_normal_3f\nn=normalize(normal_3f);\n#else\nhighp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;\n#endif\n#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)\nvec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);\n#endif\nreturn n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;\n#ifdef HAS_ATTRIBUTE_a_pbr\nmat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;\n#endif\n#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) \nvec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;\n#endif\nconst float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)\n{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)\n{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)\n{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)\n{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)\n{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)\n{\n#ifdef LIGHTING_3D_MODE\nreturn mat.diffuseColor;\n#else\nreturn mat.diffuseColor/PI;\n#endif\n}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)\n{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)\n{vec3 env_light=vec3(0.65,0.65,0.65);\n#ifdef LIGHTING_3D_MODE\nfloat ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;\n#endif\nvec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)\n{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;\n#ifdef RENDER_SHADOWS\nlighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);\n#else\nlighting_factor=NdotL;\n#endif\nvec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;\n#if !defined(LIGHTING_3D_MODE)\nconst vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);\n#endif\ncolor*=intensityFactor;return color;}void main() {\n#ifdef TERRAIN_FRAGMENT_OCCLUSION\nif (isOccluded()) {discard;}\n#endif\nvec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;\n#ifdef LIGHTING_3D_MODE\nlightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;\n#endif\nvec4 finalColor;\n#ifdef DIFFUSE_SHADED\nvec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);\n#ifdef HAS_TEXTURE_u_occlusionTexture\nfloat ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;\n#endif\nfinalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;\n#else\nMaterial mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;\n#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)\n#ifdef OCCLUSION_TEXTURE_TRANSFORM\nvec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;\n#else\nvec2 uv=uv_2f;\n#endif\nao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;\n#endif\nvec4 emissive=u_emissiveFactor;\n#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)\nemissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);\n#endif\n#ifdef APPLY_LUT_ON_GPU\nfloat emissiveFactorLength=max(length(u_emissiveFactor.rgb),0.001);emissive.rgb=sRGBToLinear(applyLUT(u_lutTexture,linearTosRGB(emissive.rgb/emissiveFactorLength).rbg))*emissiveFactorLength;\n#endif\ncolor+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;\n#ifdef HAS_ATTRIBUTE_a_pbr\nfloat resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;\n#ifdef APPLY_LUT_ON_GPU\ncolor_mix=applyLUT(u_lutTexture,color_mix);\n#endif\ncolor=mix(color,color_mix,min(1.0,resEmission));\n#ifdef HAS_ATTRIBUTE_a_color_4f\nfloat distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);\n#endif\n#endif\nvec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);\n#endif\n#ifdef FOG\nfinalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));\n#endif\n#ifdef RENDER_CUTOFF\nfinalColor*=v_cutoff_opacity;\n#endif\n#ifdef INDICATOR_CUTOUT\nfinalColor=applyCutout(finalColor);\n#endif\nglFragColor=finalColor;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_shadow.vertex.glsl"\nin vec3 a_pos_3f;\n#pragma mapbox: define-attribute highp vec3 normal_3f\n#pragma mapbox: define-attribute highp vec2 uv_2f\n#pragma mapbox: define-attribute highp vec3 color_3f\n#pragma mapbox: define-attribute highp vec4 color_4f\n#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr\n#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength\nuniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;\n#ifdef INSTANCED_ARRAYS\nin vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;\n#else\nuniform highp mat4 u_normal_matrix;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;\n#endif\nout vec4 v_position_height;out lowp vec4 v_color_mix;\n#ifdef TERRAIN_FRAGMENT_OCCLUSION\nout highp float v_depth;\n#endif\n#ifdef HAS_ATTRIBUTE_a_pbr\nout lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;\n#endif\nvec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {\n#pragma mapbox: initialize-attribute highp vec3 normal_3f\n#pragma mapbox: initialize-attribute highp vec2 uv_2f\n#pragma mapbox: initialize-attribute highp vec3 color_3f\n#pragma mapbox: initialize-attribute highp vec4 color_4f\n#pragma mapbox: initialize-attribute-custom highp vec4 pbr\n#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength\nhighp mat4 normal_matrix;\n#ifdef INSTANCED_ARRAYS\nnormal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);\n#else\nnormal_matrix=u_normal_matrix;\n#endif\nvec3 local_pos;mat3 rs;\n#ifdef MODEL_POSITION_ON_GPU\nvec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;\n#else\nlocal_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);\n#endif\nv_position_height.w=a_pos_3f.z;\n#ifdef HAS_ATTRIBUTE_a_pbr\nvec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(local_pos);\n#endif\n#ifdef RENDER_CUTOFF\nv_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);\n#endif\n#ifdef TERRAIN_FRAGMENT_OCCLUSION\nv_depth=gl_Position.z/gl_Position.w;\n#endif\n#ifdef HAS_ATTRIBUTE_a_normal_3f\n#ifdef MODEL_POSITION_ON_GPU\nfloat x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);\n#else\nnormal_3f=vec3(normal_matrix*vec4(normal_3f,0));\n#endif\n#endif\n#ifdef HAS_ATTRIBUTE_a_pbr\n#ifdef HAS_ATTRIBUTE_a_color_4f\nv_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);\n#ifdef NORMAL_OFFSET\n#ifdef HAS_ATTRIBUTE_a_normal_3f\n#ifdef MODEL_POSITION_ON_GPU\nvec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();\n#else\nvec3 offset=shadow_normal_offset_model(normal_3f);shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();\n#endif\n#endif\n#endif\nv_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;\n#endif\n}'),modelDepth:Ro("in highp float v_depth;void main() {\n#ifndef DEPTH_TEXTURE\nglFragColor=pack_depth(v_depth);\n#endif\n}","in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;\n#ifdef MODEL_POSITION_ON_GPU\n#ifdef INSTANCED_ARRAYS\nin vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;\n#else\nuniform highp mat4 u_instance;\n#endif\nuniform highp mat4 u_node_matrix;\n#endif\nvoid main() {\n#ifdef MODEL_POSITION_ON_GPU\nhighp mat4 instance;\n#ifdef INSTANCED_ARRAYS\ninstance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);\n#else\ninstance=u_instance;\n#endif\nvec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);\n#else\ngl_Position=u_matrix*vec4(a_pos_3f,1);\n#endif\nv_depth=gl_Position.z/gl_Position.w;}"),stars:Ro("in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)\n{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}","\nin vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}"),occlusion:Ro("uniform vec4 u_color;void main() {glFragColor=u_color;}",'#include "_prelude_terrain.vertex.glsl"\nin highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;\n#ifdef TERRAIN\nfloat e=elevation(world_pos.xy);world_pos.z+=e;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}')};function Do(Re,Le){const Oe=Re.replace(/\s*\/\/[^\n]*\n/g,"\n").split("\n");for(let Re of Oe)if(Re=Re.trim(),"#"===Re[0]&&Re.includes("if")&&!Re.includes("endif")){Re=Re.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const Oe=Re.split(" ");for(const Re of Oe)Le.includes(Re)||Le.push(Re)}}function Ro(Re,Le){const Oe=/#include\s+"([^"]+)"/g,Ue=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let qe=Le.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);qe&&(qe=qe.map((Re=>{const Le=Re.split(" ");return Le[Le.length-1]})),qe=[...new Set(qe)]);const Ct={},Ot=[],Jt=[];if(Re=Re.replace(Oe,((Re,Le)=>(Jt.push(Le),""))),(Le=Le.replace(Oe,((Re,Le)=>(Ot.push(Le),"")))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let Hr=[...rh];Do(Re,Hr),Do(Le,Hr);for(const Re of[...Ot,...Jt])nh[Re]||console.error(`Undefined include: ${Re}`),ih[Re]||(ih[Re]=[],Do(nh[Re],ih[Re])),Hr=[...Hr,...ih[Re]];return{fragmentSource:Re=Re.replace(Ue,((Re,Le,Oe,Ue,qe)=>(Ct[qe]=!0,"define"===Le?`\n#ifndef HAS_UNIFORM_u_${qe}\nin ${Oe} ${Ue} ${qe};\n#else\nuniform ${Oe} ${Ue} u_${qe};\n#endif\n`:"initialize"===Le?`\n#ifdef HAS_UNIFORM_u_${qe}\n    ${Oe} ${Ue} ${qe} = u_${qe};\n#endif\n`:"define-attribute"===Le?`\n#ifdef HAS_ATTRIBUTE_a_${qe}\n    in ${Oe} ${Ue} ${qe};\n#endif\n`:"initialize-attribute"===Le?"":void 0))),vertexSource:Le=Le.replace(Ue,((Re,Le,Oe,Ue,qe)=>{const Ot="float"===Ue?"vec2":Ue,Jt=qe.match(/color/)?"color":Ot;return"define-attribute-vertex-shader-only"===Le?`\n#ifdef HAS_ATTRIBUTE_a_${qe}\nin ${Oe} ${Ue} a_${qe};\n#endif\n`:Ct[qe]?"define"===Le?`\n#ifndef HAS_UNIFORM_u_${qe}\nuniform lowp float u_${qe}_t;\nin ${Oe} ${Ot} a_${qe};\nout ${Oe} ${Ue} ${qe};\n#else\nuniform ${Oe} ${Ue} u_${qe};\n#endif\n`:"initialize"===Le?"vec4"===Jt?`\n#ifndef HAS_UNIFORM_u_${qe}\n    ${qe} = a_${qe};\n#else\n    ${Oe} ${Ue} ${qe} = u_${qe};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${qe}\n    ${qe} = unpack_mix_${Jt}(a_${qe}, u_${qe}_t);\n#else\n    ${Oe} ${Ue} ${qe} = u_${qe};\n#endif\n`:"define-attribute"===Le?`\n#ifdef HAS_ATTRIBUTE_a_${qe}\n    in ${Oe} ${Ue} a_${qe};\n    out ${Oe} ${Ue} ${qe};\n#endif\n`:"initialize-attribute"===Le?`\n#ifdef HAS_ATTRIBUTE_a_${qe}\n    ${qe} = a_${qe};\n#endif\n`:void 0:"define"===Le?`\n#ifndef HAS_UNIFORM_u_${qe}\nuniform lowp float u_${qe}_t;\nin ${Oe} ${Ot} a_${qe};\n#else\nuniform ${Oe} ${Ue} u_${qe};\n#endif\n`:"define-instanced"===Le?"mat4"===Jt?`\n#ifdef INSTANCED_ARRAYS\nin vec4 a_${qe}0;\nin vec4 a_${qe}1;\nin vec4 a_${qe}2;\nin vec4 a_${qe}3;\n#else\nuniform ${Oe} ${Ue} u_${qe};\n#endif\n`:`\n#ifdef INSTANCED_ARRAYS\nin ${Oe} ${Ot} a_${qe};\n#else\nuniform ${Oe} ${Ue} u_${qe};\n#endif\n`:"initialize-attribute-custom"===Le?`\n#ifdef HAS_ATTRIBUTE_a_${qe}\n    ${Oe} ${Ue} ${qe} = a_${qe};\n#endif\n`:"vec4"===Jt?`\n#ifndef HAS_UNIFORM_u_${qe}\n    ${Oe} ${Ue} ${qe} = a_${qe};\n#else\n    ${Oe} ${Ue} ${qe} = u_${qe};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${qe}\n    ${Oe} ${Ue} ${qe} = unpack_mix_${Jt}(a_${qe}, u_${qe}_t);\n#else\n    ${Oe} ${Ue} ${qe} = u_${qe};\n#endif\n`})),staticAttributes:qe,usedDefines:Hr,vertexIncludes:Ot,fragmentIncludes:Jt}}class Ao{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(Re,Le,Oe,Ue,qe,Ct,Ot,Jt){this.context=Re;let Hr=this.boundPaintVertexBuffers.length!==Ue.length;for(let Re=0;!Hr&&Re<Ue.length;Re++)this.boundPaintVertexBuffers[Re]!==Ue[Re]&&(Hr=!0);let Jr=this.boundDynamicVertexBuffers.length!==Ot.length;for(let Re=0;!Jr&&Re<Ot.length;Re++)this.boundDynamicVertexBuffers[Re]!==Ot[Re]&&(Jr=!0);if(!this.vao||this.boundProgram!==Le||this.boundLayoutVertexBuffer!==Oe||Hr||Jr||this.boundIndexBuffer!==qe||this.boundVertexOffset!==Ct)this.freshBind(Le,Oe,Ue,qe,Ct,Ot,Jt);else{Re.bindVertexArrayOES.set(this.vao);for(const Oe of Ot)Oe&&(Oe.bind(),Jt&&Oe.instanceCount&&Oe.setVertexAttribDivisor(Re.gl,Le,Jt));qe&&qe.dynamicDraw&&qe.bind()}}freshBind(Re,Le,Oe,Ue,qe,Ct,Ot){const Jt=Re.numAttributes,Hr=this.context,Jr=Hr.gl;this.vao&&this.destroy(),this.vao=Hr.gl.createVertexArray(),Hr.bindVertexArrayOES.set(this.vao),this.boundProgram=Re,this.boundLayoutVertexBuffer=Le,this.boundPaintVertexBuffers=Oe,this.boundIndexBuffer=Ue,this.boundVertexOffset=qe,this.boundDynamicVertexBuffers=Ct,Le.enableAttributes(Jr,Re),Le.bind(),Le.setVertexAttribPointers(Jr,Re,qe);for(const Le of Oe)Le.enableAttributes(Jr,Re),Le.bind(),Le.setVertexAttribPointers(Jr,Re,qe);for(const Le of Ct)Le&&(Le.enableAttributes(Jr,Re),Le.bind(),Le.setVertexAttribPointers(Jr,Re,qe),Ot&&Le.instanceCount&&Le.setVertexAttribDivisor(Jr,Re,Ot));Ue&&Ue.bind(),Hr.currentNumAttributes=Jt}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function Lo(Le,Oe){const Ue=Math.pow(2,Oe.canonical.z),qe=Oe.canonical.y;return[new Re.a5(0,qe/Ue).toLngLat().lat,new Re.a5(0,(qe+1)/Ue).toLngLat().lat]}function Po(Le,Oe,Ue,qe,Ct,Ot,Jt){const Hr=Le.context,Jr=Hr.gl,Ln=Ue.hillshadeFBO;if(!Ln)return;Le.prepareDrawTile();const Nn=Le.isTileAffectedByFog(Oe),$n=Le.getOrCreateProgram("hillshade",{overrideFog:Nn});Hr.activeTexture.set(Jr.TEXTURE0),Jr.bindTexture(Jr.TEXTURE_2D,Ln.colorAttachment.get());const Gn=((Le,Oe,Ue,qe)=>{const Ct=Ue.paint.get("hillshade-shadow-color"),Ot=Ue.paint.get("hillshade-highlight-color"),Jt=Ue.paint.get("hillshade-accent-color"),Hr=Ue.paint.get("hillshade-emissive-strength");let Jr=Re.bB(Ue.paint.get("hillshade-illumination-direction"));if("viewport"===Ue.paint.get("hillshade-illumination-anchor"))Jr-=Le.transform.angle;else if(Le.style&&Le.style.enable3dLights()&&Le.style.directionalLight){const Oe=Le.style.directionalLight.properties.get("direction"),Ue=Re.c7(Oe.x,Oe.y,Oe.z);Jr=Re.bB(Ue[1])}const Ln=!Le.options.moving;return{u_matrix:qe||Le.transform.calculateProjMatrix(Oe.tileID.toUnwrapped(),Ln),u_image:0,u_latrange:Lo(0,Oe.tileID),u_light:[Ue.paint.get("hillshade-exaggeration"),Jr],u_shadow:Ct.toRenderColor(Ue.lut),u_highlight:Ot.toRenderColor(Ue.lut),u_emissive_strength:Hr,u_accent:Jt.toRenderColor(Ue.lut)}})(Le,Ue,qe,Le.terrain?Oe.projMatrix:null);Le.uploadCommonUniforms(Hr,$n,Oe.toUnwrapped());const{tileBoundsBuffer:qn,tileBoundsIndexBuffer:Zn,tileBoundsSegments:Xn}=Le.getTileBoundsBuffers(Ue);$n.draw(Le,Jr.TRIANGLES,Ct,Ot,Jt,Fi.disabled,Gn,qe.id,qn,Zn,Xn)}function Mo(Le,Oe,Ue){if(!Oe.needsDEMTextureUpload)return;const qe=Le.context,Ct=qe.gl;qe.pixelStoreUnpackPremultiplyAlpha.set(!1),Oe.demTexture=Oe.demTexture||Le.getTileTexture(Ue.stride);const Ot=Ue.getPixels();Oe.demTexture?Oe.demTexture.update(Ot,{premultiply:!1}):Oe.demTexture=new Re.T(qe,Ot,Ct.R32F,{premultiply:!1}),Oe.needsDEMTextureUpload=!1}function zo(Le,Oe,Ue){const qe=Le.context,Ct=qe.gl;if(!Oe.dem)return;const Ot=Oe.dem;if(qe.activeTexture.set(Ct.TEXTURE1),Mo(Le,Oe,Ot),!Oe.demTexture)return;Oe.demTexture.bind(Ct.NEAREST,Ct.CLAMP_TO_EDGE);const Jt=Ot.dim;qe.activeTexture.set(Ct.TEXTURE0);let Hr=Oe.hillshadeFBO;if(!Hr){const Le=new Re.T(qe,{width:Jt,height:Jt,data:null},Ct.RGBA8);Le.bind(Ct.LINEAR,Ct.CLAMP_TO_EDGE),Hr=Oe.hillshadeFBO=qe.createFramebuffer(Jt,Jt,!0,"renderbuffer"),Hr.colorAttachment.set(Le.texture)}qe.bindFramebuffer.set(Hr.framebuffer),qe.viewport.set([0,0,Jt,Jt]);const{tileBoundsBuffer:Jr,tileBoundsIndexBuffer:Ln,tileBoundsSegments:Nn}=Le.getMercatorTileBoundsBuffers(),$n=[];Le.linearFloatFilteringSupported()&&$n.push("TERRAIN_DEM_FLOAT_FORMAT"),Le.getOrCreateProgram("hillshadePrepare",{defines:$n}).draw(Le,Ct.TRIANGLES,Li.disabled,Mi.disabled,Ai.unblended,Fi.disabled,((Le,Oe)=>{const Ue=Oe.stride,qe=Re.a6.mat4.create();return Re.a6.mat4.ortho(qe,0,Re.ab,-Re.ab,0,0,1),Re.a6.mat4.translate(qe,qe,[0,-Re.ab,0]),{u_matrix:qe,u_image:1,u_dimension:[Ue,Ue],u_zoom:Le.overscaledZ}})(Oe.tileID,Ot),Ue.id,Jr,Ln,Nn),Oe.needsHillshadePrepare=!1}class Oo{constructor(Re){this.gl=Re.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(Re){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Fo extends Oo{getDefault(){return Re.bz.transparent}set(Re){const Le=this.current;(Re.r!==Le.r||Re.g!==Le.g||Re.b!==Le.b||Re.a!==Le.a||this.dirty)&&(this.gl.clearColor(Re.r,Re.g,Re.b,Re.a),this.current=Re,this.dirty=!1)}}class ko extends Oo{getDefault(){return 1}set(Re){(Re!==this.current||this.dirty)&&(this.gl.clearDepth(Re),this.current=Re,this.dirty=!1)}}class Bo extends Oo{getDefault(){return 0}set(Re){(Re!==this.current||this.dirty)&&(this.gl.clearStencil(Re),this.current=Re,this.dirty=!1)}}class No extends Oo{getDefault(){return[!0,!0,!0,!0]}set(Re){const Le=this.current;(Re[0]!==Le[0]||Re[1]!==Le[1]||Re[2]!==Le[2]||Re[3]!==Le[3]||this.dirty)&&(this.gl.colorMask(Re[0],Re[1],Re[2],Re[3]),this.current=Re,this.dirty=!1)}}class Uo extends Oo{getDefault(){return!0}set(Re){(Re!==this.current||this.dirty)&&(this.gl.depthMask(Re),this.current=Re,this.dirty=!1)}}class Go extends Oo{getDefault(){return 255}set(Re){(Re!==this.current||this.dirty)&&(this.gl.stencilMask(Re),this.current=Re,this.dirty=!1)}}class jo extends Oo{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(Re){const Le=this.current;(Re.func!==Le.func||Re.ref!==Le.ref||Re.mask!==Le.mask||this.dirty)&&(this.gl.stencilFunc(Re.func,Re.ref,Re.mask),this.current=Re,this.dirty=!1)}}class Vo extends Oo{getDefault(){const Re=this.gl;return[Re.KEEP,Re.KEEP,Re.KEEP]}set(Re){const Le=this.current;(Re[0]!==Le[0]||Re[1]!==Le[1]||Re[2]!==Le[2]||this.dirty)&&(this.gl.stencilOp(Re[0],Re[1],Re[2]),this.current=Re,this.dirty=!1)}}class qo extends Oo{getDefault(){return!1}set(Re){if(Re===this.current&&!this.dirty)return;const Le=this.gl;Re?Le.enable(Le.STENCIL_TEST):Le.disable(Le.STENCIL_TEST),this.current=Re,this.dirty=!1}}class Zo extends Oo{getDefault(){return[0,1]}set(Re){const Le=this.current;(Re[0]!==Le[0]||Re[1]!==Le[1]||this.dirty)&&(this.gl.depthRange(Re[0],Re[1]),this.current=Re,this.dirty=!1)}}class Ho extends Oo{getDefault(){return!1}set(Re){if(Re===this.current&&!this.dirty)return;const Le=this.gl;Re?Le.enable(Le.DEPTH_TEST):Le.disable(Le.DEPTH_TEST),this.current=Re,this.dirty=!1}}class Wo extends Oo{getDefault(){return this.gl.LESS}set(Re){(Re!==this.current||this.dirty)&&(this.gl.depthFunc(Re),this.current=Re,this.dirty=!1)}}class $o extends Oo{getDefault(){return!1}set(Re){if(Re===this.current&&!this.dirty)return;const Le=this.gl;Re?Le.enable(Le.BLEND):Le.disable(Le.BLEND),this.current=Re,this.dirty=!1}}class Xo extends Oo{getDefault(){const Re=this.gl;return[Re.ONE,Re.ZERO,Re.ONE,Re.ZERO]}set(Re){const Le=this.current;(Re[0]!==Le[0]||Re[1]!==Le[1]||Re[2]!==Le[2]||Re[3]!==Le[3]||this.dirty)&&(this.gl.blendFuncSeparate(Re[0],Re[1],Re[2],Re[3]),this.current=Re,this.dirty=!1)}}class Yo extends Oo{getDefault(){return Re.bz.transparent}set(Re){const Le=this.current;(Re.r!==Le.r||Re.g!==Le.g||Re.b!==Le.b||Re.a!==Le.a||this.dirty)&&(this.gl.blendColor(Re.r,Re.g,Re.b,Re.a),this.current=Re,this.dirty=!1)}}class Ko extends Oo{getDefault(){return this.gl.FUNC_ADD}set(Re){(Re!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(Re,Re),this.current=Re,this.dirty=!1)}}class Jo extends Oo{getDefault(){return!1}set(Re){if(Re===this.current&&!this.dirty)return;const Le=this.gl;Re?Le.enable(Le.CULL_FACE):Le.disable(Le.CULL_FACE),this.current=Re,this.dirty=!1}}class Qo extends Oo{getDefault(){return this.gl.BACK}set(Re){(Re!==this.current||this.dirty)&&(this.gl.cullFace(Re),this.current=Re,this.dirty=!1)}}class er extends Oo{getDefault(){return this.gl.CCW}set(Re){(Re!==this.current||this.dirty)&&(this.gl.frontFace(Re),this.current=Re,this.dirty=!1)}}let yh=class extends Oo{getDefault(){return null}set(Re){(Re!==this.current||this.dirty)&&(this.gl.useProgram(Re),this.current=Re,this.dirty=!1)}};class ir extends Oo{getDefault(){return this.gl.TEXTURE0}set(Re){(Re!==this.current||this.dirty)&&(this.gl.activeTexture(Re),this.current=Re,this.dirty=!1)}}class or extends Oo{getDefault(){const Re=this.gl;return[0,0,Re.drawingBufferWidth,Re.drawingBufferHeight]}set(Re){const Le=this.current;(Re[0]!==Le[0]||Re[1]!==Le[1]||Re[2]!==Le[2]||Re[3]!==Le[3]||this.dirty)&&(this.gl.viewport(Re[0],Re[1],Re[2],Re[3]),this.current=Re,this.dirty=!1)}}class rr extends Oo{getDefault(){return null}set(Re){if(Re===this.current&&!this.dirty)return;const Le=this.gl;Le.bindFramebuffer(Le.FRAMEBUFFER,Re),this.current=Re,this.dirty=!1}}class sr extends Oo{getDefault(){return null}set(Re){if(Re===this.current&&!this.dirty)return;const Le=this.gl;Le.bindRenderbuffer(Le.RENDERBUFFER,Re),this.current=Re,this.dirty=!1}}class ar extends Oo{getDefault(){return null}set(Re){if(Re===this.current&&!this.dirty)return;const Le=this.gl;Le.bindTexture(Le.TEXTURE_2D,Re),this.current=Re,this.dirty=!1}}class nr extends Oo{getDefault(){return null}set(Re){if(Re===this.current&&!this.dirty)return;const Le=this.gl;Le.bindBuffer(Le.ARRAY_BUFFER,Re),this.current=Re,this.dirty=!1}}class lr extends Oo{getDefault(){return null}set(Re){const Le=this.gl;Le.bindBuffer(Le.ELEMENT_ARRAY_BUFFER,Re),this.current=Re,this.dirty=!1}}class cr extends Oo{getDefault(){return null}set(Re){this.gl&&(Re!==this.current||this.dirty)&&(this.gl.bindVertexArray(Re),this.current=Re,this.dirty=!1)}}class hr extends Oo{getDefault(){return 4}set(Re){if(Re===this.current&&!this.dirty)return;const Le=this.gl;Le.pixelStorei(Le.UNPACK_ALIGNMENT,Re),this.current=Re,this.dirty=!1}}class ur extends Oo{getDefault(){return!1}set(Re){if(Re===this.current&&!this.dirty)return;const Le=this.gl;Le.pixelStorei(Le.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Re),this.current=Re,this.dirty=!1}}class dr extends Oo{getDefault(){return!1}set(Re){if(Re===this.current&&!this.dirty)return;const Le=this.gl;Le.pixelStorei(Le.UNPACK_FLIP_Y_WEBGL,Re),this.current=Re,this.dirty=!1}}class _r extends Oo{constructor(Re,Le){super(Re),this.context=Re,this.parent=Le}getDefault(){return null}}class pr extends _r{setDirty(){this.dirty=!0}set(Re){if(Re===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const Le=this.gl;Le.framebufferTexture2D(Le.FRAMEBUFFER,Le.COLOR_ATTACHMENT0,Le.TEXTURE_2D,Re,0),this.current=Re,this.dirty=!1}}class mr extends _r{attachment(){return this.gl.DEPTH_ATTACHMENT}set(Re){if(Re===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const Le=this.gl;Le.framebufferRenderbuffer(Le.FRAMEBUFFER,this.attachment(),Le.RENDERBUFFER,Re),this.current=Re,this.dirty=!1}}class fr extends _r{attachment(){return this.gl.DEPTH_ATTACHMENT}set(Re){if(Re===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const Le=this.gl;Le.framebufferTexture2D(Le.FRAMEBUFFER,this.attachment(),Le.TEXTURE_2D,Re,0),this.current=Re,this.dirty=!1}}class gr extends mr{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}const vr=(Re,Le,Oe)=>({u_matrix:Re,u_image0:0,u_skirt_height:Le,u_ground_shadow_factor:Oe}),xr=(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr,Ln,Nn,$n,Gn,qn,Zn)=>({u_proj_matrix:Float32Array.from(Re),u_globe_matrix:Le,u_normalize_matrix:Float32Array.from(Ue),u_merc_matrix:Oe,u_zoom_transition:qe,u_merc_center:Ct,u_image0:0,u_frustum_tl:Ot,u_frustum_tr:Jt,u_frustum_br:Hr,u_frustum_bl:Jr,u_globe_pos:Ln,u_globe_radius:Nn,u_viewport:$n,u_grid_matrix:Zn?Float32Array.from(Zn):new Float32Array(9),u_skirt_height:Gn,u_far_z_cutoff:qn});function yr(Re,Le){return null!=Re&&null!=Le&&!(!Re.hasData()||!Le.hasData())&&null!=Re.demTexture&&null!=Le.demTexture&&Re.tileID.key!==Le.tileID.key}const Th=new class{constructor(){this.operations={}}newMorphing(Re,Le,Oe,Ue,qe){if(Re in this.operations){const Le=this.operations[Re];Le.to.tileID.key!==Oe.tileID.key&&(Le.queued=Oe)}else this.operations[Re]={startTime:Ue,phase:0,duration:qe,from:Le,to:Oe,queued:null}}getMorphValuesForProxy(Re){if(!(Re in this.operations))return null;const Le=this.operations[Re];return{from:Le.from,to:Le.to,phase:Le.phase}}update(Re){for(const Le in this.operations){const Oe=this.operations[Le];for(Oe.phase=(Re-Oe.startTime)/Oe.duration;Oe.phase>=1||!this._validOp(Oe);)if(!this._nextOp(Oe,Re)){delete this.operations[Le];break}}}_nextOp(Re,Le){return!!Re.queued&&(Re.from=Re.to,Re.to=Re.queued,Re.queued=null,Re.phase=0,Re.startTime=Le,!0)}_validOp(Re){return Re.from.hasData()&&Re.to.hasData()}},Eh={0:null,1:"TERRAIN_VERTEX_MORPHING"};function Tr(Re,Le,Oe){if(0===Le)return 0;const Ue=Le<1&&514===Oe?.25/Le:1;return 6*Math.pow(1.5,22-Re)*Math.max(Le,1)*Ue}function Er(Re,Le){const Oe=1<<Re.z;return!Le&&(0===Re.x||Re.x===Oe-1)||0===Re.y||Re.y===Oe-1}const Cr=Re=>({u_matrix:Re});function Sr(Le,Oe,Ue,qe,Ct){if(Ct>0){const Ot=Re.q.now(),Jt=(Ot-Le.timeAdded)/Ct,Hr=Oe?(Ot-Oe.timeAdded)/Ct:-1,Jr=Ue.getSource(),Ln=qe.coveringZoomLevel({tileSize:Jr.tileSize,roundZoom:Jr.roundZoom}),Nn=!Oe||Math.abs(Oe.tileID.overscaledZ-Ln)>Math.abs(Le.tileID.overscaledZ-Ln),$n=Nn&&Le.refreshedUponExpiration?1:Re.ap(Nn?Jt:1-Hr,0,1);return Le.refreshedUponExpiration&&Jt>=1&&(Le.refreshedUponExpiration=!1),Oe?{opacity:1,mix:1-$n}:{opacity:$n,mix:0}}return{opacity:1,mix:0}}class Ir extends vt{constructor(Le){const Oe={type:"raster-dem",maxzoom:Le.transform.maxZoom},Ue=new Re.cd(Re.ce(),null),qe=tt("mock-dem",Oe,Ue,Le.style);super("mock-dem",qe,!1),qe.setEventedParent(this),this._sourceLoaded=!0}_loadTile(Re,Le){Re.state="loaded",Le(null)}}class Dr extends vt{constructor(Le){const Oe=tt("proxy",{type:"geojson",maxzoom:Le.transform.maxZoom},new Re.cd(Re.ce(),null),Le.style);super("proxy",Oe,!1),Oe.setEventedParent(this),this.map=this.getSource().map=Le,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(Re,Le,Oe){if(Re.freezeTileCoverage)return;this.transform=Re;const Ue=Re.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce(((Le,Oe)=>{if(Le[Oe.key]="",!this._tiles[Oe.key]){const Le=new pt(Oe,this._source.tileSize*Oe.overscaleFactor(),Re.tileZoom);Le.state="loaded",this._tiles[Oe.key]=Le}return Le}),{});for(const Re in this._tiles)Re in Ue||(this.freeFBO(Re),this._tiles[Re].unloadVectorData(),delete this._tiles[Re])}freeFBO(Re){const Le=this.proxyCachedFBO[Re];if(void 0!==Le){const Oe=Object.values(Le);this.renderCachePool.push(...Oe),delete this.proxyCachedFBO[Re]}}deallocRenderCache(){this.renderCache.forEach((Re=>Re.fb.destroy())),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Rr extends Re.aA{constructor(Re,Le,Oe){super(Re.overscaledZ,Re.wrap,Re.canonical.z,Re.canonical.x,Re.canonical.y),this.proxyTileKey=Le,this.projMatrix=Oe}}class Ar extends Re.cE{constructor(Le,Oe){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},Le.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},(()=>{this._style.map.triggerRepaint()})),Le.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},(()=>{this._style.map.triggerRepaint()})),Le.tp.registerButton(["Terrain"],"Invalidate Render Cache",(()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()})),this.painter=Le,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[Ue,qe,Ct]=function(){const Le=new Re.a_,Oe=new Re.aO,Ue=131;Le.reserve(17161),Oe.reserve(33800);const qe=Re.ab/128,Ct=Re.ab+qe/2,Ot=Ct+qe;for(let Oe=-qe;Oe<Ot;Oe+=qe)for(let Ue=-qe;Ue<Ot;Ue+=qe){const qe=Ue<0||Ue>Ct||Oe<0||Oe>Ct?24575:0,Ot=Re.ap(Math.round(Ue),0,Re.ab),Jt=Re.ap(Math.round(Oe),0,Re.ab);Le.emplaceBack(Ot+qe,Jt)}const l=(Re,Le)=>{const qe=Le*Ue+Re;Oe.emplaceBack(qe+1,qe,qe+Ue),Oe.emplaceBack(qe+Ue,qe+Ue+1,qe+1)};for(let Re=1;Re<129;Re++)for(let Le=1;Le<129;Le++)l(Le,Re);return[0,129].forEach((Re=>{for(let Le=0;Le<130;Le++)l(Le,Re),l(Re,Le)})),[Le,Oe,32768]}(),Ot=Le.context;this.gridBuffer=Ot.createVertexBuffer(Ue,Re.b0.members),this.gridIndexBuffer=Ot.createIndexBuffer(qe),this.gridSegments=Re.b1.simpleSegment(0,0,Ue.length,qe.length),this.gridNoSkirtSegments=Re.b1.simpleSegment(0,0,Ue.length,Ct),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Dr(Oe.map),this.orthoMatrix=Re.a6.mat4.create(),Re.a6.mat4.ortho(this.orthoMatrix,"globe"===this.painter.transform.projection.name?.015:0,Re.ab,0,Re.ab,0,1);const Jt=Ot.gl;this._overlapStencilMode=new Mi({func:Jt.GEQUAL,mask:255},0,255,Jt.KEEP,Jt.KEEP,Jt.REPLACE),this._previousZoom=Le.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=Oe,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Ir(Oe.map),this._pendingGroundEffectLayers=[]}set style(Re){Re.on("data",this._onStyleDataEvent.bind(this)),this._style=Re,this._style.map.on("moveend",(()=>{this._clearLineLayersFromRenderCache()}))}update(Le,Oe,Ue){if(Le&&Le.terrain){this._style!==Le&&(this.style=Le,this._evaluationZoom=void 0);const qe=Le.terrain.properties,Ct=0===Le.terrain.drapeRenderMode,Ot=Le.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=Re.q.now();const Jt=Le.terrain&&Le.terrain.scope,Hr=qe.get("source"),Jr=Ct?this._mockSourceCache:Le.getSourceCache(Hr,Jt);if(!Jr)return void Re.w(`Couldn't find terrain source "${Hr}".`);if(this.sourceCache=Jr,this._exaggeration=Ot?this.calculateExaggeration(Oe):qe.get("exaggeration"),!Oe.projection.requiresDraping&&Ot&&0===this._exaggeration)return void this._disable();this.enabled=!0;const h=()=>{this.sourceCache.used&&Re.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const Le=this.getScaledDemTileSize();this.sourceCache.update(Oe,Le,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,h(),this._initializing=!0),h(),Oe.updateElevation(!0,Ue),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(Oe),this._emptyDEMTextureDirty=!0,this._previousZoom=Oe.zoom}else this._disable()}calculateExaggeration(Le){const Oe=this._previousCameraAltitude,Ue=Le.getFreeCameraOptions().position.z/Le.pixelsPerMeter*Le.worldSize;this._previousCameraAltitude=Ue;const qe=null!=Oe?Ue-Oe:Number.MAX_VALUE;if(Math.abs(qe)<2)return this._exaggeration;const Ct=Le.zoom,Ot=this._style.terrain;if(!this._previousUpdateTimestamp)return Ot.getExaggeration(Ct);let Jt=Ct-this._previousZoom;const Hr=this._previousUpdateTimestamp;let Jr=Ct;null!=this._evaluationZoom&&(Jr=this._evaluationZoom,Math.abs(Ct-Jr)>.5&&(Jt=.5*(Ct-Jr+Jt)),Jt*qe<0&&(Jr+=Jt)),this._evaluationZoom=Jr;const Ln=Ot.getExaggeration(Jr),Nn=Ln===Ot.getExaggeration(Math.max(0,Jr-.1));if(Nn&&Math.abs(Ln-this._exaggeration)<.01)return Ln;let $n=Math.min(.1,.00375*(this._updateTimestamp-Hr));return(Nn||Ln<.1||Math.abs(Jt)<1e-4)&&($n=Math.min(.2,4*$n)),Re.aa(this._exaggeration,Ln,$n)}resetTileLookupCache(Re){this._findCoveringTileCache[Re]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(Re){Re.coord&&"source"===Re.dataType?this._clearRenderCacheForTile(Re.sourceCacheId,Re.coord):"style"===Re.dataType&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const Re in this._style._mergedSourceCaches)this._style._mergedSourceCaches[Re].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach((Re=>Re.fb.destroy())),this.pool=[],this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const Re=2*this.proxySourceCache.getSource().tileSize;return[Re,Re]}set useVertexMorphing(Re){this._useVertexMorphing=Re}updateTileBinding(Le){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const Oe=this.proxySourceCache,Ue=this.painter.transform;this._initializing&&(this._initializing=0===Ue._centerAltitude&&-1===this.getAtPointOrZero(Re.a5.fromLngLat(Ue.center),-1),this._emptyDEMTextureDirty=!this._initializing);const qe=this.proxyCoords=Oe.getIds().map((Re=>{const Le=Oe.getTileByID(Re).tileID;return Le.projMatrix=Ue.calculateProjMatrix(Le.toUnwrapped()),Le}));!function(Le,Oe){const Ue=Oe.transform.pointCoordinate(Oe.transform.getCameraPoint()),qe=new Re.P(Ue.x,Ue.y);Le.sort(((Le,Oe)=>{if(Oe.overscaledZ-Le.overscaledZ)return Oe.overscaledZ-Le.overscaledZ;const Ue=new Re.P(Le.canonical.x+(1<<Le.canonical.z)*Le.wrap,Le.canonical.y),Ct=new Re.P(Oe.canonical.x+(1<<Oe.canonical.z)*Oe.wrap,Oe.canonical.y),Ot=qe.mult(1<<Le.canonical.z);return Ot.x-=.5,Ot.y-=.5,Ot.distSqr(Ue)-Ot.distSqr(Ct)}))}(qe,this.painter);const Ct=this.proxyToSource||{};this.proxyToSource={},qe.forEach((Re=>{this.proxyToSource[Re.key]={}})),this.terrainTileForTile={};const Ot=this._style._mergedSourceCaches;for(const Re in Ot){const Oe=Ot[Re];if(!Oe.used)continue;if(Oe!==this.sourceCache&&this.resetTileLookupCache(Oe.id),this._setupProxiedCoordsForOrtho(Oe,Le[Re],Ct),Oe.usedForTerrain)continue;const Ue=Le[Re];Oe.getSource().reparseOverscaled&&this._assignTerrainTiles(Ue)}this.proxiedCoords[Oe.id]=qe.map((Re=>new Rr(Re,Re.key,this.orthoMatrix))),this._assignTerrainTiles(qe),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(Ct),this.renderingToTexture=!1;const Jt={};this._visibleDemTiles=[];for(const Re of this.proxyCoords){const Le=this.terrainTileForTile[Re.key];if(!Le)continue;const Oe=Le.tileID.key;Oe in Jt||(this._visibleDemTiles.push(Le),Jt[Oe]=Oe)}}_assignTerrainTiles(Re){this._initializing||Re.forEach((Re=>{if(this.terrainTileForTile[Re.key])return;const Le=this._findTileCoveringTileID(Re,this.sourceCache);Le&&(this.terrainTileForTile[Re.key]=Le)}))}_prepareDEMTextures(){const Re=this.painter.context,Le=Re.gl;for(const Oe in this.terrainTileForTile){const Ue=this.terrainTileForTile[Oe],qe=Ue.dem;!qe||Ue.demTexture&&!Ue.needsDEMTextureUpload||(Re.activeTexture.set(Le.TEXTURE1),Mo(this.painter,Ue,qe))}}_prepareDemTileUniforms(Re,Le,Oe,Ue){if(!Le||null==Le.demTexture)return!1;const qe=Re.tileID.canonical,Ct=Math.pow(2,Le.tileID.canonical.z-qe.z),Ot=Ue||"";return Oe[`u_dem_tl${Ot}`]=[qe.x*Ct%1,qe.y*Ct%1],Oe[`u_dem_scale${Ot}`]=Ct,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let Re=0;const Le=this._visibleDemTiles.reduce(((Le,Oe)=>{if(!Oe.dem)return Le;const Ue=Oe.dem.tree.minimums[0];return Ue>0&&Re++,Le+Ue}),0);return Re?Le/Re:0}_updateEmptyDEMTexture(){const Le=this.painter.context,Oe=Le.gl;Le.activeTexture.set(Oe.TEXTURE2);const Ue=this._getLoadedAreaMinimum(),qe=new Re.cF({width:1,height:1},new Float32Array([Ue]));this._emptyDEMTextureDirty=!1;let Ct=this._emptyDEMTexture;return Ct?Ct.update(qe,{premultiply:!1}):Ct=this._emptyDEMTexture=new Re.T(Le,qe,Oe.R32F,{premultiply:!1}),Ct}setupElevationDraw(Le,Oe,Ue){const qe=this.painter.context,Ct=qe.gl,Ot={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0};Ot.u_exaggeration=this.exaggeration();let Jt=null,Hr=null,Jr=1;if(Ue&&Ue.morphing&&this._useVertexMorphing){const Re=Ue.morphing.srcDemTile,Oe=Ue.morphing.dstDemTile;Jr=Ue.morphing.phase,Re&&Oe&&(this._prepareDemTileUniforms(Le,Re,Ot,"_prev")&&(Hr=Re),this._prepareDemTileUniforms(Le,Oe,Ot)&&(Jt=Oe))}const h=Re=>Re&&Re.demTexture&&this.painter.linearFloatFilteringSupported()?Ct.LINEAR:Ct.NEAREST;let Ln=null;var Nn;if(this.enabled?Hr&&Jt?(Ln=Jt.demTexture,qe.activeTexture.set(Ct.TEXTURE4),Hr.demTexture.bind(h(Hr),Ct.CLAMP_TO_EDGE),Ot.u_dem_lerp=Jr):(Jt=this.terrainTileForTile[Le.tileID.key],Ln=this._prepareDemTileUniforms(Le,Jt,Ot)?Jt.demTexture:this.emptyDEMTexture):Ln=this.emptyDEMTexture,qe.activeTexture.set(Ct.TEXTURE2),Ln&&(Ot.u_dem_size=1===(Nn=Ln).size[0]?1:Nn.size[0]-2,Ln.bind(h(Jt),Ct.CLAMP_TO_EDGE)),this.painter.setupDepthForOcclusion(Ue&&Ue.useDepthForOcclusion,Oe,Ot),Ue&&Ue.useMeterToDem&&Jt){const Le=(1<<Jt.tileID.canonical.z)*Re.bD(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;Ot.u_meter_to_dem=Le}if(Ue&&Ue.labelPlaneMatrixInv&&(Ot.u_label_plane_matrix_inv=Ue.labelPlaneMatrixInv),Oe.setTerrainUniformValues(qe,Ot),"globe"===this.painter.transform.projection.name){const Re=this.globeUniformValues(this.painter.transform,Le.tileID.canonical,Ue&&Ue.useDenormalizedUpVectorScale);Oe.setGlobeUniformValues(qe,Re)}}globeUniformValues(Le,Oe,Ue){const qe=Le.projection;return{u_tile_tl_up:qe.upVector(Oe,0,0),u_tile_tr_up:qe.upVector(Oe,Re.ab,0),u_tile_br_up:qe.upVector(Oe,Re.ab,Re.ab),u_tile_bl_up:qe.upVector(Oe,0,Re.ab),u_tile_up_scale:Ue?Re.cG(1):qe.upVectorScale(Oe,Le.center.lat,Le.worldSize).metersToTile}}renderToBackBuffer(Le){const Oe=this.painter,Ue=this.painter.context;0!==Le.length&&(Ue.bindFramebuffer.set(null),Ue.viewport.set([0,0,Oe.width,Oe.height]),Oe.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(Le,Oe,Ue,qe,Ct){if("globe"===Le.transform.projection.name)!function(Le,Oe,Ue,qe,Ct){const Ot=Le.context,Jt=Ot.gl;let Hr,Jr;const Ln=Le.transform,Nn=Re.cx(Le,Ot,Ln),d=(Re,Oe)=>{if(Jr===Oe)return;const Ue=[Eh[Oe],"PROJECTION_GLOBE_VIEW"];Nn&&Ue.push("CUSTOM_ANTIALIASING");const qe=Le.isTileAffectedByFog(Re);Hr=Le.getOrCreateProgram("globeRaster",{defines:Ue,overrideFog:qe}),Jr=Oe},$n=Le.colorModeForRenderPass(),Gn=new Li(Jt.LEQUAL,Li.ReadWrite,Le.depthRangeFor3D);Th.update(Ct);const qn=Re.cy(Ln),Zn=[Re.am(Ln.center.lng),Re.at(Ln.center.lat)],Xn=Le.globeSharedBuffers,Yn=[Ln.width*Re.q.devicePixelRatio,Ln.height*Re.q.devicePixelRatio],_i=Float32Array.from(Ln.globeMatrix),vi={useDenormalizedUpVectorScale:!0};{const Ln=Le.transform,Nn=Tr(Ln.zoom,Oe.exaggeration(),Oe.sourceCache._source.tileSize);Jr=-1;const xi=Jt.TRIANGLES;for(const Jr of qe){const qe=Ue.getTile(Jr),bi=Mi.disabled,Pi=Oe.prevTerrainTileForTile[Jr.key],lo=Oe.terrainTileForTile[Jr.key];yr(Pi,lo)&&Th.newMorphing(Jr.key,Pi,lo,Ct,250),Ot.activeTexture.set(Jt.TEXTURE0),qe.texture&&qe.texture.bind(Jt.LINEAR,Jt.CLAMP_TO_EDGE);const uo=Th.getMorphValuesForProxy(Jr.key),po=uo?1:0;uo&&Re.C(vi,{morphing:{srcDemTile:uo.from,dstDemTile:uo.to,phase:Re.cw(uo.phase)}});const fo=Re.cz(Jr.canonical),Io=Re.cA(fo.getCenter().lat),is=Re.cB(Jr.canonical,fo,Io,Ln.worldSize/Ln._pixelsPerMercatorPixel),as=Re.b5(Re.cC(Jr.canonical)),Is=xr(Ln.expandedFarZProjMatrix,_i,qn,as,Re.a9(Ln.zoom),Zn,Ln.frustumCorners.TL,Ln.frustumCorners.TR,Ln.frustumCorners.BR,Ln.frustumCorners.BL,Ln.globeCenterInViewSpace,Ln.globeRadius,Yn,Nn,Ln._farZ,is);if(d(Jr,po),Hr&&(Oe.setupElevationDraw(qe,Hr,vi),Le.uploadCommonUniforms(Ot,Hr,Jr.toUnwrapped()),Xn)){const[Re,Oe,Ue]=Xn.getGridBuffers(Io,0!==Nn);Hr.draw(Le,xi,Gn,bi,$n,Fi.backCCW,Is,"globe_raster",Re,Oe,Ue)}}}if(Xn&&(Le.renderDefaultNorthPole||Le.renderDefaultSouthPole)){const Ct=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Nn&&Ct.push("CUSTOM_ANTIALIASING"),Hr=Le.getOrCreateProgram("globeRaster",{defines:Ct});for(const Ct of qe){const{x:qe,y:Jr,z:Nn}=Ct.canonical,qn=0===Jr,_i=Jr===(1<<Nn)-1,[xi,bi,Pi,lo]=Xn.getPoleBuffers(Nn,!1);if(lo&&(qn||_i)){const Jr=Ue.getTile(Ct);Ot.activeTexture.set(Jt.TEXTURE0),Jr.texture&&Jr.texture.bind(Jt.LINEAR,Jt.CLAMP_TO_EDGE);let Xn=Re.cD(Nn,qe,Ln);const uo=Re.b5(Re.cC(Ct.canonical)),C=(Re,Oe)=>Re.draw(Le,Jt.TRIANGLES,Gn,Mi.disabled,$n,Fi.disabled,xr(Ln.expandedFarZProjMatrix,Xn,Xn,uo,0,Zn,Ln.frustumCorners.TL,Ln.frustumCorners.TR,Ln.frustumCorners.BR,Ln.frustumCorners.BL,Ln.globeCenterInViewSpace,Ln.globeRadius,Yn,0,Ln._farZ),"globe_pole_raster",Oe,Pi,lo);Oe.setupElevationDraw(Jr,Hr,vi),Le.uploadCommonUniforms(Ot,Hr,Ct.toUnwrapped()),qn&&Le.renderDefaultNorthPole&&C(Hr,xi),_i&&Le.renderDefaultSouthPole&&(Xn=Re.a6.mat4.scale(Re.a6.mat4.create(),Xn,[1,-1,1]),C(Hr,bi))}}}}(Le,Oe,Ue,qe,Ct);else{const Ot=Le.context,Jt=Ot.gl;let Hr,Jr;const Ln=Le.shadowRenderer,Nn=Wi(Le,Le.longestCutoffRange),d=Re=>{if(Jr===Re)return;const Oe=[];Oe.push(Eh[Re]),Nn.shouldRenderCutoff&&Oe.push("RENDER_CUTOFF"),Hr=Le.getOrCreateProgram("terrainRaster",{defines:Oe}),Jr=Re},$n=Le.colorModeForRenderPass(),Gn=new Li(Jt.LEQUAL,Li.ReadWrite,Le.depthRangeFor3D);Th.update(Ct);const qn=Le.transform,Zn=Tr(qn.zoom,Oe.exaggeration(),Oe.sourceCache._source.tileSize);let Xn=[0,0,0];if(Ln){const Re=Le.style.directionalLight,Oe=Le.style.ambientLight;Re&&Oe&&(Xn=eo(Le.style,Re,Oe))}{Jr=-1;const Yn=Jt.TRIANGLES,[_i,vi]=[Oe.gridIndexBuffer,Oe.gridSegments];for(const Jr of qe){const qe=Ue.getTile(Jr),xi=Mi.disabled,bi=Oe.prevTerrainTileForTile[Jr.key],Pi=Oe.terrainTileForTile[Jr.key];yr(bi,Pi)&&Th.newMorphing(Jr.key,bi,Pi,Ct,250),Ot.activeTexture.set(Jt.TEXTURE0),qe.texture&&qe.texture.bind(Jt.LINEAR,Jt.CLAMP_TO_EDGE);const lo=Th.getMorphValuesForProxy(Jr.key),uo=lo?1:0;let po;lo&&(po={morphing:{srcDemTile:lo.from,dstDemTile:lo.to,phase:Re.cw(lo.phase)}});const fo=vr(Jr.projMatrix,Er(Jr.canonical,qn.renderWorldCopies)?Zn/10:Zn,Xn);if(d(uo),!Hr)continue;Oe.setupElevationDraw(qe,Hr,po);const Io=Jr.toUnwrapped();Ln&&Ln.setupShadows(Io,Hr),Le.uploadCommonUniforms(Ot,Hr,Io,null,Nn),Hr.draw(Le,Yn,Gn,xi,$n,Fi.backCCW,fo,"terrain_raster",Oe.gridBuffer,_i,vi)}}}}(Oe,this,this.proxySourceCache,Le,this._updateTimestamp),this.renderingToTexture=!0,Oe.gpuTimingDeferredRenderEnd(),Le.splice(0,Le.length))}renderBatch(Le){if(0===this._drapedRenderBatches.length)return Le+1;this.renderingToTexture=!0;const Oe=this.painter,Ue=this.painter.context,qe=this.proxySourceCache,Ct=this.proxiedCoords[qe.id],Ot=this._drapedRenderBatches.shift(),Jt=Oe.style.order,Hr=[];let Jr=0;for(const Ln of Ct){const Ct=qe.getTileByID(Ln.proxyTileKey),Nn=qe.proxyCachedFBO[Ln.key]?qe.proxyCachedFBO[Ln.key][Le]:void 0,$n=void 0!==Nn?qe.renderCache[Nn]:this.pool[Jr++],Gn=void 0!==Nn;if(Ct.texture=$n.tex,Gn&&!$n.dirty){Hr.push(Ct.tileID);continue}let qn;Ue.bindFramebuffer.set($n.fb.framebuffer),this.renderedToTile=!1,$n.dirty&&(Ue.clear({color:Re.bz.transparent,stencil:0}),$n.dirty=!1);for(let Re=Ot.start;Re<=Ot.end;++Re){const Le=Oe.style._mergedLayers[Jt[Re]];if(Le.isHidden(Oe.transform.zoom))continue;const qe=Oe.style.getLayerSourceCache(Le),Ct=qe?this.proxyToSource[Ln.key][qe.id]:[Ln];if(!Ct)continue;const Ot=Ct;Ue.viewport.set([0,0,$n.fb.width,$n.fb.height]),qn!==(qe?qe.id:null)&&(this._setupStencil($n,Ct,Le,qe),qn=qe?qe.id:null),Oe.renderLayer(Oe,qe,Le,Ot)}if(0===this._drapedRenderBatches.length)for(const Re of this._pendingGroundEffectLayers){const Le=Oe.style._mergedLayers[Jt[Re]];if(Le.isHidden(Oe.transform.zoom))continue;const qe=Oe.style.getLayerSourceCache(Le),Ct=qe?this.proxyToSource[Ln.key][qe.id]:[Ln];if(!Ct)continue;const Ot=Ct;Ue.viewport.set([0,0,$n.fb.width,$n.fb.height]),qn!==(qe?qe.id:null)&&(this._setupStencil($n,Ct,Le,qe),qn=qe?qe.id:null),Oe.renderLayer(Oe,qe,Le,Ot)}this.renderedToTile?($n.dirty=!0,Hr.push(Ct.tileID)):Gn||--Jr,5===Jr&&(Jr=0,this.renderToBackBuffer(Hr))}return this.renderToBackBuffer(Hr),this.renderingToTexture=!1,Ue.bindFramebuffer.set(null),Ue.viewport.set([0,0,Oe.width,Oe.height]),Ot.end+1}postRender(){}isLayerOrderingCorrect(Re){const Le=Re.order.length;let Oe=-1,Ue=Le;for(let qe=0;qe<Le;++qe)this._style.isLayerDraped(Re._mergedLayers[Re.order[qe]])?Oe=Math.max(Oe,qe):Ue=Math.min(Ue,qe);return Ue>Oe}getMinElevationBelowMSL(){let Re=0;return this._visibleDemTiles.filter((Re=>Re.dem)).forEach((Le=>{Re=Math.min(Re,Le.dem.tree.minimums[0])})),0===Re?Re:(Re-30)*this._exaggeration}raycast(Re,Le,Oe){if(!this._visibleDemTiles)return null;const Ue=this._visibleDemTiles.filter((Re=>Re.dem)).map((Ue=>{const qe=Ue.tileID,Ct=1<<qe.overscaledZ,{x:Ot,y:Jt}=qe.canonical,Hr=Ot/Ct,Jr=(Ot+1)/Ct,Ln=Jt/Ct,Nn=(Jt+1)/Ct;return{minx:Hr,miny:Ln,maxx:Jr,maxy:Nn,t:Ue.dem.tree.raycastRoot(Hr,Ln,Jr,Nn,Re,Le,Oe),tile:Ue}}));Ue.sort(((Re,Le)=>(null!==Re.t?Re.t:Number.MAX_VALUE)-(null!==Le.t?Le.t:Number.MAX_VALUE)));for(const qe of Ue){if(null==qe.t)return null;const Ue=qe.tile.dem.tree.raycast(qe.minx,qe.miny,qe.maxx,qe.maxy,Re,Le,Oe);if(null!=Ue)return Ue}return null}_createFBO(){const Le=this.painter.context,Oe=Le.gl,Ue=this.drapeBufferSize;Le.activeTexture.set(Oe.TEXTURE0);const qe=new Re.T(Le,{width:Ue[0],height:Ue[1],data:null},Oe.RGBA8);qe.bind(Oe.LINEAR,Oe.CLAMP_TO_EDGE);const Ct=Le.createFramebuffer(Ue[0],Ue[1],!0,null);return Ct.colorAttachment.set(qe.texture),Ct.depthAttachment=new gr(Le,Ct.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=Le.createRenderbuffer(Le.gl.DEPTH_STENCIL,Ue[0],Ue[1]),this._stencilRef=0,Ct.depthAttachment.set(this._sharedDepthStencil),Le.clear({stencil:0})):Ct.depthAttachment.set(this._sharedDepthStencil),Le.extTextureFilterAnisotropic&&Oe.texParameterf(Oe.TEXTURE_2D,Le.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Le.extTextureFilterAnisotropicMax),{fb:Ct,tex:qe,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache)return!0;if(this._style.hasLightTransitions())return!0;for(const Re in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[Re].hasTransition())return!0;return this._style.order.some((Re=>{const Le=this._style._mergedLayers[Re],Oe=Le.isHidden(this.painter.transform.zoom);return"hillshade"===Le.type||"custom"===Le.type?!Oe&&Le.shouldRedrape():!Oe&&Le.hasTransition()}))}_clearLineLayersFromRenderCache(){let Le=!1;for(const Re of this._style.getSources())if(Re instanceof Ke){Le=!0;break}if(!Le)return;const Oe={};for(let Le=0;Le<this._style.order.length;++Le){const Ue=this._style._mergedLayers[this._style.order[Le]],qe=this._style.getLayerSourceCache(Ue);if(qe&&!Oe[qe.id]&&!Ue.isHidden(this.painter.transform.zoom)&&"line"===Ue.type&&Ue.widthExpression()instanceof Re.a4){Oe[qe.id]=!0;for(const Re of this.proxyCoords){const Le=this.proxyToSource[Re.key][qe.id];if(Le)for(const Re of Le)this._clearRenderCacheForTile(qe.id,Re)}}}}_clearRasterLayersFromRenderCache(){let Re=!1;for(const Le in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[Le]._source instanceof Je){Re=!0;break}if(!Re)return;const Le={};for(let Re=0;Re<this._style.order.length;++Re){const Oe=this._style._mergedLayers[this._style.order[Re]],Ue=this._style.getLayerSourceCache(Oe);if(!Ue||Le[Ue.id])continue;if(Oe.isHidden(this.painter.transform.zoom)||"raster"!==Oe.type)continue;const qe=Oe.paint.get("raster-fade-duration");for(const Re of this.proxyCoords){const Le=this.proxyToSource[Re.key][Ue.id];if(Le)for(const Re of Le){const Le=Sr(Ue.getTile(Re),Ue.findLoadedParent(Re,0),Ue,this.painter.transform,qe);(1!==Le.opacity||0!==Le.mix)&&this._clearRenderCacheForTile(Ue.id,Re)}}}}_setupDrapedRenderBatches(){const Le=this._style.order,Oe=Le.length;if(0===Oe)return;const Ue=[];this._pendingGroundEffectLayers=[];let qe,Ct=0,Ot=this._style._mergedLayers[Le[Ct]];for(;!this._style.isLayerDraped(Ot)&&Ot.isHidden(this.painter.transform.zoom)&&++Ct<Oe;)Ot=this._style._mergedLayers[Le[Ct]];for(;Ct<Oe;++Ct){const Re=this._style._mergedLayers[Le[Ct]];Re.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(Re)?void 0===qe&&(qe=Ct):("fill-extrusion"===Re.type&&this._pendingGroundEffectLayers.push(Ct),void 0!==qe&&(Ue.push({start:qe,end:Ct-1}),qe=void 0)))}if(void 0!==qe&&Ue.push({start:qe,end:Ct-1}),0!==Ue.length){const Le=Ue[Ue.length-1];this._pendingGroundEffectLayers.every((Re=>Re>Le.end))||Re.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=Ue}_setupRenderCache(Re){const Le=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,Le.renderCache.length>Le.renderCachePool.length){const Re=Object.values(Le.proxyCachedFBO);Le.proxyCachedFBO={};for(let Oe=0;Oe<Re.length;++Oe){const Ue=Object.values(Re[Oe]);Le.renderCachePool.push(...Ue)}}return}this._clearRasterLayersFromRenderCache();const Oe=this.proxyCoords,Ue=this._tilesDirty;for(let qe=Oe.length-1;qe>=0;qe--){const Ct=Oe[qe];if(Le.getTileByID(Ct.key),void 0!==Le.proxyCachedFBO[Ct.key]){const Oe=Re[Ct.key],qe=this.proxyToSource[Ct.key];let Ot=0;for(const Re in qe){const Le=qe[Re],Ct=Oe[Re];if(!Ct||Ct.length!==Le.length||Le.some(((Le,Oe)=>Le!==Ct[Oe]||Ue[Re]&&Ue[Re].hasOwnProperty(Le.key)))){Ot=-1;break}++Ot}for(const Re in Le.proxyCachedFBO[Ct.key])Le.renderCache[Le.proxyCachedFBO[Ct.key][Re]].dirty=Ot<0||Ot!==Object.values(Oe).length}}const qe=[...this._drapedRenderBatches];qe.sort(((Re,Le)=>Le.end-Le.start-(Re.end-Re.start)));for(const Re of qe)for(const Ue of Oe){if(Le.proxyCachedFBO[Ue.key])continue;let Oe=Le.renderCachePool.pop();void 0===Oe&&Le.renderCache.length<50&&(Oe=Le.renderCache.length,Le.renderCache.push(this._createFBO())),void 0!==Oe&&(Le.proxyCachedFBO[Ue.key]={},Le.proxyCachedFBO[Ue.key][Re.start]=Oe,Le.renderCache[Oe].dirty=!0)}this._tilesDirty={}}_setupStencil(Re,Le,Oe,Ue){if(!Ue||!this._sourceTilesOverlap[Ue.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const qe=this.painter.context,Ct=qe.gl;if(Le.length<=1)return void(this._overlapStencilType=!1);let Ot;if(Oe.isTileClipped())Ot=Le.length,this._overlapStencilMode.test={func:Ct.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(Le[0].overscaledZ>Le[Le.length-1].overscaledZ))return void(this._overlapStencilType=!1);Ot=1,this._overlapStencilMode.test={func:Ct.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+Ot>255&&(qe.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=Ot,this._overlapStencilMode.ref=this._stencilRef,Oe.isTileClipped()&&this._renderTileClippingMasks(Le,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return"Clip"===this._overlapStencilType||"Mask"===this._overlapStencilType}stencilModeForRTTOverlap(Re){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[Re.key]),this._overlapStencilMode):Mi.disabled}_renderTileClippingMasks(Re,Le){const Oe=this.painter,Ue=this.painter.context,qe=Ue.gl;Oe._tileClippingMaskIDs={},Ue.setColorMode(Ai.disabled),Ue.setDepthMode(Li.disabled);const Ct=Oe.getOrCreateProgram("clippingMask");for(const Ue of Re){const Re=Oe._tileClippingMaskIDs[Ue.key]=--Le;Ct.draw(Oe,qe.TRIANGLES,Li.disabled,new Mi({func:qe.ALWAYS,mask:0},Re,255,qe.KEEP,qe.KEEP,qe.REPLACE),Ai.disabled,Fi.disabled,Cr(Ue.projMatrix),"$clipping",Oe.tileExtentBuffer,Oe.quadTriangleIndexBuffer,Oe.tileExtentSegments)}}pointCoordinate(Le){const Oe=this.painter.transform;if(Le.x<0||Le.x>Oe.width||Le.y<0||Le.y>Oe.height)return null;const Ue=[Le.x,Le.y,1,1];Re.a6.vec4.transformMat4(Ue,Ue,Oe.pixelMatrixInverse),Re.a6.vec4.scale(Ue,Ue,1/Ue[3]),Ue[0]/=Oe.worldSize,Ue[1]/=Oe.worldSize;const qe=Oe._camera.position,Ct=Re.bD(1,Oe.center.lat),Ot=[qe[0],qe[1],qe[2]/Ct,0],Jt=Re.a6.vec3.subtract([],Ue.slice(0,3),Ot);Re.a6.vec3.normalize(Jt,Jt);const Hr=this.raycast(Ot,Jt,this._exaggeration);return null!==Hr&&Hr?(Re.a6.vec3.scaleAndAdd(Ot,Ot,Jt,Hr),Ot[3]=Ot[2],Ot[2]*=Ct,Ot):null}_setupProxiedCoordsForOrtho(Le,Oe,Ue){if(Le.getSource()instanceof Re.aD)return this._setupProxiedCoordsForImageSource(Le,Oe,Ue);this._findCoveringTileCache[Le.id]=this._findCoveringTileCache[Le.id]||{};const qe=this.proxiedCoords[Le.id]=[],Ct=this.proxyCoords;for(let Re=0;Re<Ct.length;Re++){const Oe=Ct[Re],Ot=this._findTileCoveringTileID(Oe,Le);if(Ot){const Re=this._createProxiedId(Oe,Ot,Ue[Oe.key]&&Ue[Oe.key][Le.id]);qe.push(Re),this.proxyToSource[Oe.key][Le.id]=[Re]}}let Ot=!1;const Jt=new Set;for(let Re=0;Re<Oe.length;Re++){const Ct=Le.getTile(Oe[Re]);if(!Ct||!Ct.hasData())continue;const Hr=this._findTileCoveringTileID(Ct.tileID,this.proxySourceCache);if(Hr&&Hr.tileID.canonical.z!==Ct.tileID.canonical.z){const Re=this.proxyToSource[Hr.tileID.key][Le.id],Oe=this._createProxiedId(Hr.tileID,Ct,Ue[Hr.tileID.key]&&Ue[Hr.tileID.key][Le.id]);Re?Re.splice(Re.length-1,0,Oe):this.proxyToSource[Hr.tileID.key][Le.id]=[Oe];const Jr=this.proxyToSource[Hr.tileID.key][Le.id];Jt.has(Jr)||Jt.add(Jr),qe.push(Oe),Ot=!0}}if(this._sourceTilesOverlap[Le.id]=Ot,Ot&&this._debugParams.sortTilesHiZFirst)for(const Re of Jt)Re.sort(((Re,Le)=>Le.overscaledZ-Re.overscaledZ))}_setupProxiedCoordsForImageSource(Le,Oe,Ue){if(!Le.getSource().loaded())return;const qe=this.proxiedCoords[Le.id]=[],Ct=this.proxyCoords,Ot=Le.getSource(),Jt=Ot.tileID;if(!Jt)return;const Hr=new Re.P(Jt.x,Jt.y)._div(1<<Jt.z),Jr=Ot.coordinates.map(Re.a5.fromLngLat).reduce(((Re,Le)=>(Re.min.x=Math.min(Re.min.x,Le.x-Hr.x),Re.min.y=Math.min(Re.min.y,Le.y-Hr.y),Re.max.x=Math.max(Re.max.x,Le.x-Hr.x),Re.max.y=Math.max(Re.max.y,Le.y-Hr.y),Re)),{min:new Re.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new Re.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),h=(Le,Oe)=>{const Ue=Le.wrap+Le.canonical.x/(1<<Le.canonical.z),qe=Le.canonical.y/(1<<Le.canonical.z),Ct=Re.ab/(1<<Le.canonical.z),Ot=Oe.wrap+Oe.canonical.x/(1<<Oe.canonical.z),Jt=Oe.canonical.y/(1<<Oe.canonical.z);return Ue+Ct<Ot+Jr.min.x||Ue>Ot+Jr.max.x||qe+Ct<Jt+Jr.min.y||qe>Jt+Jr.max.y};for(let Re=0;Re<Ct.length;Re++){const Ot=Ct[Re];for(let Re=0;Re<Oe.length;Re++){const Ct=Le.getTile(Oe[Re]);if(!Ct||!Ct.hasData())continue;if(h(Ot,Ct.tileID))continue;const Jt=this._createProxiedId(Ot,Ct,Ue[Ot.key]&&Ue[Ot.key][Le.id]),Hr=this.proxyToSource[Ot.key][Le.id];Hr?Hr.push(Jt):this.proxyToSource[Ot.key][Le.id]=[Jt],qe.push(Jt)}}}_createProxiedId(Le,Oe,Ue){let qe=this.orthoMatrix;if(Ue){const Re=Ue.find((Re=>Re.key===Oe.tileID.key));if(Re)return Re}if(Oe.tileID.key!==Le.key){const Ue=Le.canonical.z-Oe.tileID.canonical.z;let Ct,Ot,Jt;qe=Re.a6.mat4.create();const Hr=Oe.tileID.wrap-Le.wrap<<Le.overscaledZ;Ue>0?(Ct=Re.ab>>Ue,Ot=Ct*((Oe.tileID.canonical.x<<Ue)-Le.canonical.x+Hr),Jt=Ct*((Oe.tileID.canonical.y<<Ue)-Le.canonical.y)):(Ct=Re.ab<<-Ue,Ot=Re.ab*(Oe.tileID.canonical.x-(Le.canonical.x+Hr<<-Ue)),Jt=Re.ab*(Oe.tileID.canonical.y-(Le.canonical.y<<-Ue))),Re.a6.mat4.ortho(qe,0,Ct,0,Ct,0,1),Re.a6.mat4.translate(qe,qe,[Ot,Jt,0])}return new Rr(Oe.tileID,Le.key,qe)}_findTileCoveringTileID(Le,Oe){let Ue=Oe.getTile(Le);if(Ue&&Ue.hasData())return Ue;const qe=this._findCoveringTileCache[Oe.id],Ct=qe[Le.key];if(Ue=Ct?Oe.getTileByID(Ct):null,Ue&&Ue.hasData()||null===Ct)return Ue;let Ot=Ue?Ue.tileID:Le,Jt=Ot.overscaledZ;const Hr=Oe.getSource().minzoom,Jr=[];if(!Ct){const qe=Oe.getSource().maxzoom;if(Le.canonical.z>=qe){const Ue=Le.canonical.z-qe;Oe.getSource().reparseOverscaled?(Jt=Math.max(Le.canonical.z+2,Oe.transform.tileZoom),Ot=new Re.aA(Jt,Le.wrap,qe,Le.canonical.x>>Ue,Le.canonical.y>>Ue)):0!==Ue&&(Jt=qe,Ot=new Re.aA(Jt,Le.wrap,qe,Le.canonical.x>>Ue,Le.canonical.y>>Ue))}Ot.key!==Le.key&&(Jr.push(Ot.key),Ue=Oe.getTile(Ot))}const h=Re=>{Jr.forEach((Le=>{qe[Le]=Re})),Jr.length=0};for(Jt-=1;Jt>=Hr&&(!Ue||!Ue.hasData());Jt--){Ue&&h(Ue.tileID.key);const Re=Ot.calculateScaledKey(Jt);if(Ue=Oe.getTileByID(Re),Ue&&Ue.hasData())break;const Le=qe[Re];if(null===Le)break;void 0===Le?Jr.push(Re):Ue=Oe.getTileByID(Le)}return h(Ue?Ue.tileID.key:null),Ue&&Ue.hasData()?Ue:null}findDEMTileFor(Re){return this.enabled?this._findTileCoveringTileID(Re,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(Re,Le){let Oe=this._tilesDirty[Re];Oe||(Oe=this._tilesDirty[Re]={}),Oe[Le.key]=!0}}function Lr(Le,Oe,Ue){const qe=function(Le,Oe,Ue){const qe=Re.a6.vec3.dot(Oe,Le),Ct=Re.a6.vec3.dot(Ue,[.2126,.7152,.0722]),a=(Re,Le,Oe)=>(1-Oe)*Re+Oe*Le,Ot=a(1-.3*Math.min(Ct,1),1,Math.min(qe+1,1));return a(.92,1,Math.asin(Re.ap(Oe[2],-1,1))/Math.PI+.5)*Ot}(Le,[0,0,1],Oe),Ct=[0,0,0];Re.a6.vec3.scale(Ct,Ue.slice(0,3),qe);const Ot=[0,0,0];Re.a6.vec3.scale(Ot,Oe.slice(0,3),Le[2]);const Jt=[0,0,0];return Re.a6.vec3.add(Jt,Ct,Ot),Re.cb(Jt)}const Ch=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],Rh=["stars","fillExtrusion","fillExtrusionGroundEffect","model","symbol"];class zr{static cacheKey(Re,Le,Oe,Ue){let qe=`${Le}${Ue?Ue.cacheKey:""}`;for(const Le of Oe)Re.usedDefines.includes(Le)&&(qe+=`/${Le}`);return qe}constructor(Le,Oe,Ue,qe,Ct,Ot){const Jt=Le.gl;this.program=Jt.createProgram(),this.configuration=qe,this.name=Oe,this.fixedDefines=[...Ot];const Hr=qe?qe.getBinderAttributes():[],Jr=(Ue.staticAttributes||[]).concat(Hr);let Ln=qe?qe.defines():[];Ln=Ln.concat(Ot.map((Re=>`#define ${Re}`)));const Nn="#version 300 es\n";let $n=Nn+Ln.concat("precision mediump float;",ah,sh.fragmentSource).join("\n");for(const Re of Ue.fragmentIncludes)$n+=`\n${nh[Re]}`;$n+=`\n${Ue.fragmentSource}`;let Gn=Nn+Ln.concat("precision highp float;",ah,sh.vertexSource).join("\n");for(const Re of Ue.vertexIncludes)Gn+=`\n${nh[Re]}`;Gn+=`\n${Ue.vertexSource}`;const qn=Jt.createShader(Jt.FRAGMENT_SHADER);if(Jt.isContextLost())return void(this.failedToCreate=!0);Jt.shaderSource(qn,$n),Jt.compileShader(qn),Jt.attachShader(this.program,qn);const Zn=Jt.createShader(Jt.VERTEX_SHADER);if(Jt.isContextLost())this.failedToCreate=!0;else{Jt.shaderSource(Zn,Gn),Jt.compileShader(Zn),Jt.attachShader(this.program,Zn),this.attributes={},this.numAttributes=Jr.length;for(let Re=0;Re<this.numAttributes;Re++)if(Jr[Re]){const Le=Jr[Re].startsWith("a_")?Jr[Re]:`a_${Jr[Re]}`;Jt.bindAttribLocation(this.program,Re,Le),this.attributes[Le]=Re}Jt.linkProgram(this.program),Jt.deleteShader(Zn),Jt.deleteShader(qn),this.fixedUniforms=Ct(Le),this.binderUniforms=qe?qe.getUniforms(Le):[],(Ot.includes("TERRAIN")||-1!==Oe.indexOf("symbol")||-1!==Oe.indexOf("circle"))&&(this.terrainUniforms=(Le=>({u_dem:new Re.bJ(Le),u_dem_prev:new Re.bJ(Le),u_dem_tl:new Re.bG(Le),u_dem_scale:new Re.bI(Le),u_dem_tl_prev:new Re.bG(Le),u_dem_scale_prev:new Re.bI(Le),u_dem_size:new Re.bI(Le),u_dem_lerp:new Re.bI(Le),u_exaggeration:new Re.bI(Le),u_depth:new Re.bJ(Le),u_depth_size_inv:new Re.bG(Le),u_depth_range_unpack:new Re.bG(Le),u_occluder_half_size:new Re.bI(Le),u_occlusion_depth_offset:new Re.bI(Le),u_meter_to_dem:new Re.bI(Le),u_label_plane_matrix_inv:new Re.bF(Le)}))(Le)),Ot.includes("GLOBE")&&(this.globeUniforms=(Le=>({u_tile_tl_up:new Re.bH(Le),u_tile_tr_up:new Re.bH(Le),u_tile_br_up:new Re.bH(Le),u_tile_bl_up:new Re.bH(Le),u_tile_up_scale:new Re.bI(Le)}))(Le)),Ot.includes("FOG")&&(this.fogUniforms=(Le=>({u_fog_matrix:new Re.bF(Le),u_fog_range:new Re.bG(Le),u_fog_color:new Re.c6(Le),u_fog_horizon_blend:new Re.bI(Le),u_fog_vertical_limit:new Re.bG(Le),u_fog_temporal_offset:new Re.bI(Le),u_frustum_tl:new Re.bH(Le),u_frustum_tr:new Re.bH(Le),u_frustum_br:new Re.bH(Le),u_frustum_bl:new Re.bH(Le),u_globe_pos:new Re.bH(Le),u_globe_radius:new Re.bI(Le),u_globe_transition:new Re.bI(Le),u_is_globe:new Re.bJ(Le),u_viewport:new Re.bG(Le)}))(Le)),Ot.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(Le=>({u_cutoff_params:new Re.c6(Le)}))(Le)),Ot.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(Le=>({u_lighting_ambient_color:new Re.bH(Le),u_lighting_directional_dir:new Re.bH(Le),u_lighting_directional_color:new Re.bH(Le),u_ground_radiance:new Re.bH(Le)}))(Le)),Ot.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(Le=>({u_light_matrix_0:new Re.bF(Le),u_light_matrix_1:new Re.bF(Le),u_fade_range:new Re.bG(Le),u_shadow_normal_offset:new Re.bH(Le),u_shadow_intensity:new Re.bI(Le),u_shadow_texel_size:new Re.bI(Le),u_shadow_map_resolution:new Re.bI(Le),u_shadow_direction:new Re.bH(Le),u_shadow_bias:new Re.bH(Le),u_shadowmap_0:new Re.bJ(Le),u_shadowmap_1:new Re.bJ(Le)}))(Le))}}setTerrainUniformValues(Re,Le){if(!this.terrainUniforms)return;const Oe=this.terrainUniforms;if(!this.failedToCreate){Re.program.set(this.program);for(const Re in Le)Oe[Re]&&Oe[Re].set(this.program,Re,Le[Re])}}setGlobeUniformValues(Re,Le){if(!this.globeUniforms)return;const Oe=this.globeUniforms;if(!this.failedToCreate){Re.program.set(this.program);for(const Re in Le)Oe[Re]&&Oe[Re].set(this.program,Re,Le[Re])}}setFogUniformValues(Re,Le){if(!this.fogUniforms)return;const Oe=this.fogUniforms;if(!this.failedToCreate){Re.program.set(this.program);for(const Re in Le)Oe[Re].set(this.program,Re,Le[Re])}}setCutoffUniformValues(Re,Le){if(!this.cutoffUniforms)return;const Oe=this.cutoffUniforms;if(!this.failedToCreate){Re.program.set(this.program);for(const Re in Le)Oe[Re].set(this.program,Re,Le[Re])}}setLightsUniformValues(Re,Le){if(!this.lightsUniforms)return;const Oe=this.lightsUniforms;if(!this.failedToCreate){Re.program.set(this.program);for(const Re in Le)Oe[Re].set(this.program,Re,Le[Re])}}setShadowUniformValues(Re,Le){if(this.failedToCreate||!this.shadowUniforms)return;const Oe=this.shadowUniforms;Re.program.set(this.program);for(const Re in Le)Oe[Re].set(this.program,Re,Le[Re])}_drawDebugWireframe(Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr,Ln){const Nn=Le.options.wireframe;if(!1===Nn.terrain&&!1===Nn.layers2D&&!1===Nn.layers3D)return;const $n=Le.context;if(!(()=>!(!Nn.terrain||"terrainRaster"!==this.name&&"globeRaster"!==this.name)||!(!Nn.layers2D||Le._terrain&&Le._terrain.renderingToTexture||!Ch.includes(this.name))||!(!Nn.layers3D||!Rh.includes(this.name)))())return;const Gn=$n.gl,qn=Le.wireframeDebugCache.getLinesFromTrianglesBuffer(Le.frameCounter,Ct,$n);if(!qn)return;const Zn=[...this.fixedDefines];Zn.push("DEBUG_WIREFRAME");const Xn=Le.getOrCreateProgram(this.name,{config:this.configuration,defines:Zn});$n.program.set(Xn.program);const g=(Re,Le,Oe)=>{if(Le[Re]&&Oe[Re])for(const Ue in Le[Re])Oe[Re][Ue]&&Oe[Re][Ue].set(Oe.program,Ue,Le[Re][Ue].current)};Jr&&Jr.setUniforms(Xn.program,$n,Xn.binderUniforms,Jt,{zoom:Hr}),g("fixedUniforms",this,Xn),g("terrainUniforms",this,Xn),g("globeUniforms",this,Xn),g("fogUniforms",this,Xn),g("lightsUniforms",this,Xn),g("shadowUniforms",this,Xn),qn.bind(),$n.setColorMode(new Ai([Gn.ONE,Gn.ONE_MINUS_SRC_ALPHA,Gn.ZERO,Gn.ONE],Re.bz.transparent,[!0,!0,!0,!1])),$n.setDepthMode(new Li(Oe.func===Gn.LESS?Gn.LEQUAL:Oe.func,Li.ReadOnly,Oe.range)),$n.setStencilMode(Mi.disabled);const Yn=3*Ot.primitiveLength*2,_i=3*Ot.primitiveOffset*2*2;Ln&&Ln>1?Gn.drawElementsInstanced(Gn.LINES,Yn,Gn.UNSIGNED_SHORT,_i,Ln):Gn.drawElements(Gn.LINES,Yn,Gn.UNSIGNED_SHORT,_i),Ct.bind(),$n.program.set(this.program),$n.setDepthMode(Oe),$n.setStencilMode(Ue),$n.setColorMode(qe)}draw(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr,Ln,Nn,$n,Gn,qn,Zn){const Xn=Re.context,Yn=Xn.gl;if(this.failedToCreate)return;Xn.program.set(this.program),Xn.setDepthMode(Oe),Xn.setStencilMode(Ue),Xn.setColorMode(qe),Xn.setCullFace(Ct);for(const Re of Object.keys(this.fixedUniforms))this.fixedUniforms[Re].set(this.program,Re,Ot[Re]);Gn&&Gn.setUniforms(this.program,Xn,this.binderUniforms,Nn,{zoom:$n});const _i={[Yn.POINTS]:1,[Yn.LINES]:2,[Yn.TRIANGLES]:3,[Yn.LINE_STRIP]:1}[Le],vi=Zn&&Zn>0?1:void 0;for(const Ct of Ln.get()){const Ot=Ct.vaos||(Ct.vaos={});(Ot[Jt]||(Ot[Jt]=new Ao)).bind(Xn,this,Hr,Gn?Gn.getPaintVertexBuffers():[],Jr,Ct.vertexOffset,qn||[],vi),Zn&&Zn>1?Yn.drawElementsInstanced(Le,Ct.primitiveLength*_i,Yn.UNSIGNED_SHORT,Ct.primitiveOffset*_i*2,Zn):Jr?Yn.drawElements(Le,Ct.primitiveLength*_i,Yn.UNSIGNED_SHORT,Ct.primitiveOffset*_i*2):Yn.drawArrays(Le,Ct.vertexOffset,Ct.vertexLength),Le===Yn.TRIANGLES&&Jr&&this._drawDebugWireframe(Re,Oe,Ue,qe,Jr,Ct,Nn,$n,Gn,Zn)}}}function Or(Le,Oe){const Ue=Math.pow(2,Oe.tileID.overscaledZ),qe=Oe.tileSize*Math.pow(2,Le.transform.tileZoom)/Ue,Ct=qe*(Oe.tileID.canonical.x+Oe.tileID.wrap*Ue),Ot=qe*Oe.tileID.canonical.y;return{u_image:0,u_texsize:Oe.imageAtlasTexture?Oe.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/Re.ak(Oe,1,Le.transform.tileZoom),u_pixel_coord_upper:[Ct>>16,Ot>>16],u_pixel_coord_lower:[65535&Ct,65535&Ot]}}const zh=Re.a6.mat4.create(),kr=(Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr,Ln,Nn,$n,Gn,qn,Zn,Xn)=>{const Yn=Oe.style.light,_i=Yn.properties.get("position"),vi=[_i.x,_i.y,_i.z],xi=Re.a6.mat3.create();"viewport"===Yn.properties.get("anchor")&&(Re.a6.mat3.fromRotation(xi,-Oe.transform.angle),Re.a6.vec3.transformMat3(vi,vi,xi));const bi=Yn.properties.get("color"),Pi=Oe.transform,lo={u_matrix:Le,u_lightpos:vi,u_lightintensity:Yn.properties.get("intensity"),u_lightcolor:[bi.r,bi.g,bi.b],u_vertical_gradient:+Ue,u_opacity:qe,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:zh,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:Ct,u_edge_radius:Ot,u_width_scale:Jt,u_flood_light_color:Gn,u_vertical_scale:qn,u_flood_light_intensity:Zn,u_ground_shadow_factor:Xn};return"globe"===Pi.projection.name&&(lo.u_tile_id=[Hr.canonical.x,Hr.canonical.y,1<<Hr.canonical.z],lo.u_zoom_transition=Ln,lo.u_inv_rot_matrix=$n,lo.u_merc_center=Nn,lo.u_up_dir=Pi.projection.upVector(new Re.bP(0,0,0),Nn[0]*Re.ab,Nn[1]*Re.ab),lo.u_height_lift=Jr),lo},Br=(Re,Le,Oe,Ue)=>({u_matrix:Re,u_edge_radius:Le,u_width_scale:Oe,u_vertical_scale:Ue}),Nr=(Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr,Ln,Nn,$n,Gn,qn,Zn)=>{const Xn=kr(Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Ln,Nn,$n,Gn,qn,Zn,1,[0,0,0]),Yn={u_height_factor:-Math.pow(2,Hr.overscaledZ)/Jr.tileSize/8};return Re.l(Xn,Or(Oe,Jr),Yn)},Ur=(Re,Le)=>({u_matrix:Re,u_emissive_strength:Le}),Gr=(Le,Oe,Ue,qe)=>Re.l(Ur(Le,Oe),Or(Ue,qe)),jr=(Re,Le,Oe)=>({u_matrix:Re,u_world:Oe,u_emissive_strength:Le}),Vr=(Le,Oe,Ue,qe,Ct)=>Re.l(Gr(Le,Oe,Ue,qe),{u_world:Ct}),qr=(Le,Oe,Ue,qe)=>{const Ct=Re.ab/Ue.tileSize;return{u_matrix:Le,u_camera_to_center_distance:Oe.getCameraToCenterDistance(qe),u_extrude_scale:[Oe.pixelsToGLUnits[0]/Ct,Oe.pixelsToGLUnits[1]/Ct]}},Zr=(Re,Le,Oe=1)=>({u_matrix:Re,u_color:Le.toRenderColor(null),u_overlay:0,u_overlay_scale:Oe}),Dh=Re.a6.mat4.create(),Wr=(Le,Oe,Ue,qe,Ct,Ot,Jt)=>{const Hr=Le.transform,Jr="globe"===Hr.projection.name,Ln=Jr?Re.cI(Hr.zoom,Oe.canonical)*Hr._pixelsPerMercatorPixel:Re.ak(Ue,1,Ot),Nn={u_matrix:Oe.projMatrix,u_extrude_scale:Ln,u_intensity:Jt,u_inv_rot_matrix:Dh,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(Jr){Nn.u_inv_rot_matrix=qe,Nn.u_merc_center=Ct,Nn.u_tile_id=[Oe.canonical.x,Oe.canonical.y,1<<Oe.canonical.z],Nn.u_zoom_transition=Re.a9(Hr.zoom);const Le=Ct[0]*Re.ab,Ue=Ct[1]*Re.ab;Nn.u_up_dir=Hr.projection.upVector(new Re.bP(0,0,0),Le,Ue)}return Nn};function $r(Re,[Le,Oe,Ue,qe],[Ct,Ot]){if(Ct===Ot)return[0,0,0,0];const Jt=255*(Re-1)/(Re*(Ot-Ct));return[Le*Jt,Oe*Jt,Ue*Jt,qe*Jt]}function Xr(Re,Le,[Oe,Ue]){return Oe===Ue?0:.5/Re+(Le-Oe)*(Re-1)/(Re*(Ue-Oe))}const Yr=(Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr,Ln,Nn,$n,Gn,qn,Zn,Xn,Yn,_i,vi,xi,bi)=>({u_matrix:Le,u_normalize_matrix:Oe,u_globe_matrix:Ue,u_merc_matrix:qe,u_grid_matrix:Ct,u_tl_parent:Ot,u_scale_parent:Ln,u_fade_t:Nn.mix,u_opacity:Nn.opacity*$n.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:$n.paint.get("raster-brightness-min"),u_brightness_high:$n.paint.get("raster-brightness-max"),u_saturation_factor:Re.cJ($n.paint.get("raster-saturation")),u_contrast_factor:Re.cK($n.paint.get("raster-contrast")),u_spin_weights:Kr($n.paint.get("raster-hue-rotate")),u_perspective_transform:Gn,u_raster_elevation:qn,u_zoom_transition:Jt,u_merc_center:Hr,u_cutoff_params:Jr,u_colorization_mix:$r(Re.cL,Xn,_i),u_colorization_offset:Xr(Re.cL,Yn,_i),u_color_ramp:Zn,u_texture_offset:[xi/(vi+2*xi),vi/(vi+2*xi)],u_texture_res:[vi+2*xi,vi+2*xi],u_emissive_strength:bi});function Kr(Re){Re*=Math.PI/180;const Le=Math.sin(Re),Oe=Math.cos(Re);return[(2*Oe+1)/3,(-Math.sqrt(3)*Le-Oe+1)/3,(Math.sqrt(3)*Le-Oe+1)/3]}const Bh=.05,Qr=(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr,Ln,Nn)=>({u_matrix:Re,u_normalize_matrix:Le,u_globe_matrix:Oe,u_merc_matrix:Ue,u_grid_matrix:qe,u_tl_parent:Ct,u_scale_parent:Jr,u_fade_t:Ln.mix,u_opacity:Ln.opacity,u_image0:0,u_image1:1,u_raster_elevation:Nn,u_zoom_transition:Ot,u_merc_center:Jt,u_cutoff_params:Hr}),es=(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr)=>({u_particle_texture:Re,u_particle_texture_side_len:Le,u_tile_offset:Oe,u_velocity:Ue,u_color_ramp:Ct,u_velocity_res:qe,u_max_speed:Ot,u_uv_offset:Jt,u_data_scale:[255*Hr[0],255*Hr[1]],u_data_offset:Jr,u_particle_pos_scale:1.1,u_particle_pos_offset:[Bh,Bh]}),ts=(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr)=>({u_particle_texture:Re,u_particle_texture_side_len:Le,u_velocity:Oe,u_velocity_res:Ue,u_max_speed:qe,u_speed_factor:Ct,u_reset_rate:Ot,u_rand_seed:Math.random(),u_uv_offset:Jt,u_data_scale:[255*Hr[0],255*Hr[1]],u_data_offset:Jr,u_particle_pos_scale:1.1,u_particle_pos_offset:[Bh,Bh]}),Vh=Re.a6.mat4.create(),os=(Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr,Ln,Nn,$n,Gn,qn,Zn,Xn,Yn,_i,vi,xi,bi)=>{const Pi=Ct.transform,lo={u_is_size_zoom_constant:+("constant"===Le||"source"===Le),u_is_size_feature_constant:+("constant"===Le||"camera"===Le),u_size_t:Oe?Oe.uSizeT:0,u_size:Oe?Oe.uSize:0,u_camera_to_center_distance:Pi.getCameraToCenterDistance(vi),u_rotate_symbol:+Ue,u_aspect_ratio:Pi.width/Pi.height,u_fade_change:Ct.options.fadeDuration?Ct.symbolFadeChange:1,u_matrix:Ot,u_label_plane_matrix:Jt,u_coord_matrix:Hr,u_is_text:+Ln,u_elevation_from_sea:Jr?1:0,u_pitch_with_map:+qe,u_texsize:Nn,u_texsize_icon:$n,u_texture:0,u_texture_icon:1,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Vh,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Vh,u_up_vector:[0,-1,0],u_color_adj_mat:xi,u_icon_transition:bi||0,u_gamma_scale:qe?Ct.transform.getCameraToCenterDistance(vi)*Math.cos(Ct.terrain?0:Ct.transform._pitch):1,u_device_pixel_ratio:Re.q.devicePixelRatio,u_is_halo:+Gn};return"globe"===vi.name&&(lo.u_tile_id=[qn.canonical.x,qn.canonical.y,1<<qn.canonical.z],lo.u_zoom_transition=Zn,lo.u_inv_rot_matrix=Yn,lo.u_merc_center=Xn,lo.u_camera_forward=Pi._camera.forward(),lo.u_ecef_origin=Re.cM(Pi.globeMatrix,qn.toUnwrapped()),lo.u_tile_matrix=Float32Array.from(Pi.globeMatrix),lo.u_up_vector=_i),lo},rs=(Re,Le,Oe,Ue)=>({u_matrix:Re,u_emissive_strength:Le,u_opacity:Oe,u_color:Ue}),ss=(Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr)=>Re.l(function(Le,Oe,Ue,qe,Ct,Ot){const{width:Jt,height:Hr}=qe.imageManager.getPixelSize(Oe),Jr=Math.pow(2,Ot.tileID.overscaledZ),Ln=Ot.tileSize*Math.pow(2,qe.transform.tileZoom)/Jr,Nn=Ln*(Ot.tileID.canonical.x+Ot.tileID.wrap*Jr),$n=Ln*Ot.tileID.canonical.y;return{u_image:0,u_pattern_tl:Ue.tl,u_pattern_br:Ue.br,u_texsize:[Jt,Hr],u_pattern_size:Ue.displaySize,u_pattern_units_to_pixels:Ct?[qe.transform.width,-1*qe.transform.height]:[1/Re.ak(Ot,1,qe.transform.tileZoom),1/Re.ak(Ot,1,qe.transform.tileZoom)],u_pixel_coord_upper:[Nn>>16,$n>>16],u_pixel_coord_lower:[65535&Nn,65535&$n]}}(0,Ot,Jt,qe,Hr,Jr),{u_matrix:Le,u_emissive_strength:Oe,u_opacity:Ue}),Gh=new Float32Array(Re.a6.mat4.identity([])),ns=(Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr,Ln,Nn,$n,Gn,qn=[0,0,0],Zn)=>{const Xn=Ct.style.light,Yn=Xn.properties.get("position"),_i=[-Yn.x,-Yn.y,Yn.z],vi=Re.a6.mat3.create();"viewport"===Xn.properties.get("anchor")&&(Re.a6.mat3.fromRotation(vi,-Ct.transform.angle),Re.a6.vec3.transformMat3(_i,_i,vi));const xi="MASK"===Nn.alphaMode,bi=Xn.properties.get("color").toRenderColor(null),Pi=Gn.paint.get("model-ambient-occlusion-intensity"),lo=Gn.paint.get("model-color").constantOr(Re.bz.white).toRenderColor(null),uo=Gn.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:Le,u_lighting_matrix:Oe,u_normal_matrix:Ue,u_node_matrix:qe||Gh,u_lightpos:_i,u_lightintensity:Xn.properties.get("intensity"),u_lightcolor:[bi.r,bi.g,bi.b],u_camera_pos:qn,u_opacity:Ot,u_baseTextureIsAlpha:0,u_alphaMask:+xi,u_alphaCutoff:Nn.alphaCutoff,u_baseColorFactor:[Jt.r,Jt.g,Jt.b,Jt.a],u_emissiveFactor:[Hr[0],Hr[1],Hr[2],1],u_metallicFactor:Jr,u_roughnessFactor:Ln,u_baseColorTexture:ou.BaseColor,u_metallicRoughnessTexture:ou.MetallicRoughness,u_normalTexture:ou.Normal,u_occlusionTexture:ou.Occlusion,u_emissionTexture:ou.Emission,u_lutTexture:ou.LUT,u_color_mix:[lo.r,lo.g,lo.b,uo],u_aoIntensity:Pi,u_emissive_strength:$n,u_occlusionTextureTransform:Zn||[0,0,0,0]}},ls=(Re,Le=Gh,Oe=Gh)=>({u_matrix:Re,u_instance:Le,u_node_matrix:Oe}),nd={fillExtrusion:Le=>({u_matrix:new Re.bF(Le),u_lightpos:new Re.bH(Le),u_lightintensity:new Re.bI(Le),u_lightcolor:new Re.bH(Le),u_vertical_gradient:new Re.bI(Le),u_opacity:new Re.bI(Le),u_edge_radius:new Re.bI(Le),u_width_scale:new Re.bI(Le),u_ao:new Re.bG(Le),u_tile_id:new Re.bH(Le),u_zoom_transition:new Re.bI(Le),u_inv_rot_matrix:new Re.bF(Le),u_merc_center:new Re.bG(Le),u_up_dir:new Re.bH(Le),u_height_lift:new Re.bI(Le),u_flood_light_color:new Re.bH(Le),u_vertical_scale:new Re.bI(Le),u_flood_light_intensity:new Re.bI(Le),u_ground_shadow_factor:new Re.bH(Le)}),fillExtrusionDepth:Le=>({u_matrix:new Re.bF(Le),u_edge_radius:new Re.bI(Le),u_width_scale:new Re.bI(Le),u_vertical_scale:new Re.bI(Le)}),fillExtrusionPattern:Le=>({u_matrix:new Re.bF(Le),u_lightpos:new Re.bH(Le),u_lightintensity:new Re.bI(Le),u_lightcolor:new Re.bH(Le),u_vertical_gradient:new Re.bI(Le),u_height_factor:new Re.bI(Le),u_edge_radius:new Re.bI(Le),u_width_scale:new Re.bI(Le),u_ao:new Re.bG(Le),u_tile_id:new Re.bH(Le),u_zoom_transition:new Re.bI(Le),u_inv_rot_matrix:new Re.bF(Le),u_merc_center:new Re.bG(Le),u_up_dir:new Re.bH(Le),u_height_lift:new Re.bI(Le),u_image:new Re.bJ(Le),u_texsize:new Re.bG(Le),u_pixel_coord_upper:new Re.bG(Le),u_pixel_coord_lower:new Re.bG(Le),u_tile_units_to_pixels:new Re.bI(Le),u_opacity:new Re.bI(Le)}),fillExtrusionGroundEffect:Le=>({u_matrix:new Re.bF(Le),u_opacity:new Re.bI(Le),u_ao_pass:new Re.bI(Le),u_meter_to_tile:new Re.bI(Le),u_ao:new Re.bG(Le),u_flood_light_intensity:new Re.bI(Le),u_flood_light_color:new Re.bH(Le),u_attenuation:new Re.bI(Le),u_edge_radius:new Re.bI(Le),u_fb:new Re.bJ(Le),u_fb_size:new Re.bI(Le),u_dynamic_offset:new Re.bI(Le)}),fill:Le=>({u_matrix:new Re.bF(Le),u_emissive_strength:new Re.bI(Le)}),fillPattern:Le=>({u_matrix:new Re.bF(Le),u_emissive_strength:new Re.bI(Le),u_image:new Re.bJ(Le),u_texsize:new Re.bG(Le),u_pixel_coord_upper:new Re.bG(Le),u_pixel_coord_lower:new Re.bG(Le),u_tile_units_to_pixels:new Re.bI(Le)}),fillOutline:Le=>({u_matrix:new Re.bF(Le),u_emissive_strength:new Re.bI(Le),u_world:new Re.bG(Le)}),fillOutlinePattern:Le=>({u_matrix:new Re.bF(Le),u_emissive_strength:new Re.bI(Le),u_world:new Re.bG(Le),u_image:new Re.bJ(Le),u_texsize:new Re.bG(Le),u_pixel_coord_upper:new Re.bG(Le),u_pixel_coord_lower:new Re.bG(Le),u_tile_units_to_pixels:new Re.bI(Le)}),circle:Re.cN,collisionBox:Le=>({u_matrix:new Re.bF(Le),u_camera_to_center_distance:new Re.bI(Le),u_extrude_scale:new Re.bG(Le)}),collisionCircle:Le=>({u_matrix:new Re.bF(Le),u_inv_matrix:new Re.bF(Le),u_camera_to_center_distance:new Re.bI(Le),u_viewport_size:new Re.bG(Le)}),debug:Le=>({u_color:new Re.cu(Le),u_matrix:new Re.bF(Le),u_overlay:new Re.bJ(Le),u_overlay_scale:new Re.bI(Le)}),clippingMask:Le=>({u_matrix:new Re.bF(Le)}),heatmap:Le=>({u_extrude_scale:new Re.bI(Le),u_intensity:new Re.bI(Le),u_matrix:new Re.bF(Le),u_inv_rot_matrix:new Re.bF(Le),u_merc_center:new Re.bG(Le),u_tile_id:new Re.bH(Le),u_zoom_transition:new Re.bI(Le),u_up_dir:new Re.bH(Le)}),heatmapTexture:Le=>({u_image:new Re.bJ(Le),u_color_ramp:new Re.bJ(Le),u_opacity:new Re.bI(Le)}),hillshade:Le=>({u_matrix:new Re.bF(Le),u_image:new Re.bJ(Le),u_latrange:new Re.bG(Le),u_light:new Re.bG(Le),u_shadow:new Re.cu(Le),u_highlight:new Re.cu(Le),u_emissive_strength:new Re.bI(Le),u_accent:new Re.cu(Le)}),hillshadePrepare:Le=>({u_matrix:new Re.bF(Le),u_image:new Re.bJ(Le),u_dimension:new Re.bG(Le),u_zoom:new Re.bI(Le)}),line:Re.cO,linePattern:Re.cP,raster:Le=>({u_matrix:new Re.bF(Le),u_normalize_matrix:new Re.bF(Le),u_globe_matrix:new Re.bF(Le),u_merc_matrix:new Re.bF(Le),u_grid_matrix:new Re.cv(Le),u_tl_parent:new Re.bG(Le),u_scale_parent:new Re.bI(Le),u_fade_t:new Re.bI(Le),u_opacity:new Re.bI(Le),u_image0:new Re.bJ(Le),u_image1:new Re.bJ(Le),u_brightness_low:new Re.bI(Le),u_brightness_high:new Re.bI(Le),u_saturation_factor:new Re.bI(Le),u_contrast_factor:new Re.bI(Le),u_spin_weights:new Re.bH(Le),u_perspective_transform:new Re.bG(Le),u_raster_elevation:new Re.bI(Le),u_zoom_transition:new Re.bI(Le),u_merc_center:new Re.bG(Le),u_cutoff_params:new Re.c6(Le),u_colorization_mix:new Re.c6(Le),u_colorization_offset:new Re.bI(Le),u_color_ramp:new Re.bJ(Le),u_texture_offset:new Re.bG(Le),u_texture_res:new Re.bG(Le),u_emissive_strength:new Re.bI(Le)}),rasterParticle:Le=>({u_matrix:new Re.bF(Le),u_normalize_matrix:new Re.bF(Le),u_globe_matrix:new Re.bF(Le),u_merc_matrix:new Re.bF(Le),u_grid_matrix:new Re.cv(Le),u_tl_parent:new Re.bG(Le),u_scale_parent:new Re.bI(Le),u_fade_t:new Re.bI(Le),u_opacity:new Re.bI(Le),u_image0:new Re.bJ(Le),u_image1:new Re.bJ(Le),u_raster_elevation:new Re.bI(Le),u_zoom_transition:new Re.bI(Le),u_merc_center:new Re.bG(Le),u_cutoff_params:new Re.c6(Le)}),rasterParticleTexture:Le=>({u_texture:new Re.bJ(Le),u_opacity:new Re.bI(Le)}),rasterParticleDraw:Le=>({u_particle_texture:new Re.bJ(Le),u_particle_texture_side_len:new Re.bI(Le),u_tile_offset:new Re.bG(Le),u_velocity:new Re.bJ(Le),u_color_ramp:new Re.bJ(Le),u_velocity_res:new Re.bG(Le),u_max_speed:new Re.bI(Le),u_uv_offset:new Re.bG(Le),u_data_scale:new Re.bG(Le),u_data_offset:new Re.bI(Le),u_particle_pos_scale:new Re.bI(Le),u_particle_pos_offset:new Re.bG(Le)}),rasterParticleUpdate:Le=>({u_particle_texture:new Re.bJ(Le),u_particle_texture_side_len:new Re.bI(Le),u_velocity:new Re.bJ(Le),u_velocity_res:new Re.bG(Le),u_max_speed:new Re.bI(Le),u_speed_factor:new Re.bI(Le),u_reset_rate:new Re.bI(Le),u_rand_seed:new Re.bI(Le),u_uv_offset:new Re.bG(Le),u_data_scale:new Re.bG(Le),u_data_offset:new Re.bI(Le),u_particle_pos_scale:new Re.bI(Le),u_particle_pos_offset:new Re.bG(Le)}),symbol:Le=>({u_is_size_zoom_constant:new Re.bJ(Le),u_is_size_feature_constant:new Re.bJ(Le),u_size_t:new Re.bI(Le),u_size:new Re.bI(Le),u_camera_to_center_distance:new Re.bI(Le),u_rotate_symbol:new Re.bJ(Le),u_aspect_ratio:new Re.bI(Le),u_fade_change:new Re.bI(Le),u_matrix:new Re.bF(Le),u_label_plane_matrix:new Re.bF(Le),u_coord_matrix:new Re.bF(Le),u_is_text:new Re.bJ(Le),u_elevation_from_sea:new Re.bJ(Le),u_pitch_with_map:new Re.bJ(Le),u_texsize:new Re.bG(Le),u_texsize_icon:new Re.bG(Le),u_texture:new Re.bJ(Le),u_texture_icon:new Re.bJ(Le),u_gamma_scale:new Re.bI(Le),u_device_pixel_ratio:new Re.bI(Le),u_tile_id:new Re.bH(Le),u_zoom_transition:new Re.bI(Le),u_inv_rot_matrix:new Re.bF(Le),u_merc_center:new Re.bG(Le),u_camera_forward:new Re.bH(Le),u_tile_matrix:new Re.bF(Le),u_up_vector:new Re.bH(Le),u_ecef_origin:new Re.bH(Le),u_is_halo:new Re.bJ(Le),u_icon_transition:new Re.bI(Le),u_color_adj_mat:new Re.bF(Le)}),background:Le=>({u_matrix:new Re.bF(Le),u_emissive_strength:new Re.bI(Le),u_opacity:new Re.bI(Le),u_color:new Re.cu(Le)}),backgroundPattern:Le=>({u_matrix:new Re.bF(Le),u_emissive_strength:new Re.bI(Le),u_opacity:new Re.bI(Le),u_image:new Re.bJ(Le),u_pattern_tl:new Re.bG(Le),u_pattern_br:new Re.bG(Le),u_texsize:new Re.bG(Le),u_pattern_size:new Re.bG(Le),u_pixel_coord_upper:new Re.bG(Le),u_pixel_coord_lower:new Re.bG(Le),u_pattern_units_to_pixels:new Re.bG(Le)}),terrainRaster:Le=>({u_matrix:new Re.bF(Le),u_image0:new Re.bJ(Le),u_skirt_height:new Re.bI(Le),u_ground_shadow_factor:new Re.bH(Le)}),skybox:Le=>({u_matrix:new Re.bF(Le),u_sun_direction:new Re.bH(Le),u_cubemap:new Re.bJ(Le),u_opacity:new Re.bI(Le),u_temporal_offset:new Re.bI(Le)}),skyboxGradient:Le=>({u_matrix:new Re.bF(Le),u_color_ramp:new Re.bJ(Le),u_center_direction:new Re.bH(Le),u_radius:new Re.bI(Le),u_opacity:new Re.bI(Le),u_temporal_offset:new Re.bI(Le)}),skyboxCapture:Le=>({u_matrix_3f:new Re.cv(Le),u_sun_direction:new Re.bH(Le),u_sun_intensity:new Re.bI(Le),u_color_tint_r:new Re.c6(Le),u_color_tint_m:new Re.c6(Le),u_luminance:new Re.bI(Le)}),globeRaster:Le=>({u_proj_matrix:new Re.bF(Le),u_globe_matrix:new Re.bF(Le),u_normalize_matrix:new Re.bF(Le),u_merc_matrix:new Re.bF(Le),u_zoom_transition:new Re.bI(Le),u_merc_center:new Re.bG(Le),u_image0:new Re.bJ(Le),u_grid_matrix:new Re.cv(Le),u_skirt_height:new Re.bI(Le),u_far_z_cutoff:new Re.bI(Le),u_frustum_tl:new Re.bH(Le),u_frustum_tr:new Re.bH(Le),u_frustum_br:new Re.bH(Le),u_frustum_bl:new Re.bH(Le),u_globe_pos:new Re.bH(Le),u_globe_radius:new Re.bI(Le),u_viewport:new Re.bG(Le)}),globeAtmosphere:Le=>({u_frustum_tl:new Re.bH(Le),u_frustum_tr:new Re.bH(Le),u_frustum_br:new Re.bH(Le),u_frustum_bl:new Re.bH(Le),u_horizon:new Re.bI(Le),u_transition:new Re.bI(Le),u_fadeout_range:new Re.bI(Le),u_color:new Re.c6(Le),u_high_color:new Re.c6(Le),u_space_color:new Re.c6(Le),u_temporal_offset:new Re.bI(Le),u_horizon_angle:new Re.bI(Le)}),model:Le=>({u_matrix:new Re.bF(Le),u_lighting_matrix:new Re.bF(Le),u_normal_matrix:new Re.bF(Le),u_node_matrix:new Re.bF(Le),u_lightpos:new Re.bH(Le),u_lightintensity:new Re.bI(Le),u_lightcolor:new Re.bH(Le),u_camera_pos:new Re.bH(Le),u_opacity:new Re.bI(Le),u_baseColorFactor:new Re.c6(Le),u_emissiveFactor:new Re.c6(Le),u_metallicFactor:new Re.bI(Le),u_roughnessFactor:new Re.bI(Le),u_baseTextureIsAlpha:new Re.bJ(Le),u_alphaMask:new Re.bJ(Le),u_alphaCutoff:new Re.bI(Le),u_baseColorTexture:new Re.bJ(Le),u_metallicRoughnessTexture:new Re.bJ(Le),u_normalTexture:new Re.bJ(Le),u_occlusionTexture:new Re.bJ(Le),u_emissionTexture:new Re.bJ(Le),u_lutTexture:new Re.bJ(Le),u_color_mix:new Re.c6(Le),u_aoIntensity:new Re.bI(Le),u_emissive_strength:new Re.bI(Le),u_occlusionTextureTransform:new Re.c6(Le)}),modelDepth:Le=>({u_matrix:new Re.bF(Le),u_instance:new Re.bF(Le),u_node_matrix:new Re.bF(Le)}),groundShadow:Le=>({u_matrix:new Re.bF(Le),u_ground_shadow_factor:new Re.bH(Le)}),stars:Le=>({u_matrix:new Re.bF(Le),u_up:new Re.bH(Le),u_right:new Re.bH(Le),u_intensity_multiplier:new Re.bI(Le)}),occlusion:Le=>({u_matrix:new Re.bF(Le),u_anchorPos:new Re.bH(Le),u_screenSizePx:new Re.bG(Le),u_occluderSizePx:new Re.bG(Le),u_color:new Re.c6(Le)})};class hs{constructor(Re,Le,Oe,Ue){this.id=hs.uniqueIdxCounter,hs.uniqueIdxCounter++,this.context=Re;const qe=Re.gl;this.buffer=qe.createBuffer(),this.dynamicDraw=Boolean(Oe),this.context.unbindVAO(),Re.bindElementBuffer.set(this.buffer),qe.bufferData(qe.ELEMENT_ARRAY_BUFFER,Le.arrayBuffer,this.dynamicDraw?qe.DYNAMIC_DRAW:qe.STATIC_DRAW),this.dynamicDraw||Ue||Le.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(Re){this.id=hs.uniqueIdxCounter,hs.uniqueIdxCounter++;const Le=this.context.gl;this.context.unbindVAO(),this.bind(),Le.bufferSubData(Le.ELEMENT_ARRAY_BUFFER,0,Re.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}hs.uniqueIdxCounter=0;const id={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class ds{constructor(Re,Le,Oe,Ue,qe,Ct){this.length=Le.length,this.attributes=Oe,this.itemSize=Le.bytesPerElement,this.dynamicDraw=Ue,this.instanceCount=Ct,this.context=Re;const Ot=Re.gl;this.buffer=Ot.createBuffer(),Re.bindVertexBuffer.set(this.buffer),Ot.bufferData(Ot.ARRAY_BUFFER,Le.arrayBuffer,this.dynamicDraw?Ot.DYNAMIC_DRAW:Ot.STATIC_DRAW),this.dynamicDraw||qe||Le.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(Re){const Le=this.context.gl;this.bind(),Le.bufferSubData(Le.ARRAY_BUFFER,0,Re.arrayBuffer)}enableAttributes(Re,Le){for(let Oe=0;Oe<this.attributes.length;Oe++){const Ue=Le.attributes[this.attributes[Oe].name];void 0!==Ue&&Re.enableVertexAttribArray(Ue)}}setVertexAttribPointers(Re,Le,Oe){for(let Ue=0;Ue<this.attributes.length;Ue++){const qe=this.attributes[Ue],Ct=Le.attributes[qe.name];void 0!==Ct&&Re.vertexAttribPointer(Ct,qe.components,Re[id[qe.type]],!1,this.itemSize,qe.offset+this.itemSize*(Oe||0))}}setVertexAttribDivisor(Re,Le,Oe){for(let Ue=0;Ue<this.attributes.length;Ue++){const qe=Le.attributes[this.attributes[Ue].name];void 0!==qe&&this.instanceCount&&this.instanceCount>0&&Re.vertexAttribDivisor(qe,Oe)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class _s{constructor(Re,Le,Oe,Ue,qe){this.context=Re,this.width=Le,this.height=Oe;const Ct=this.framebuffer=Re.gl.createFramebuffer();Ue&&(this.colorAttachment=new pr(Re,Ct)),qe&&(this.depthAttachmentType=qe,this.depthAttachment="renderbuffer"===qe?new mr(Re,Ct):new fr(Re,Ct))}destroy(){const Re=this.context.gl;if(this.colorAttachment){const Le=this.colorAttachment.get();Le&&Re.deleteTexture(Le)}if(this.depthAttachment&&this.depthAttachmentType)if("renderbuffer"===this.depthAttachmentType){const Le=this.depthAttachment.get();Le&&Re.deleteRenderbuffer(Le)}else{const Le=this.depthAttachment.get();Le&&Re.deleteTexture(Le)}Re.deleteFramebuffer(this.framebuffer)}}class ps{constructor(Re,Le){this.gl=Re,this.clearColor=new Fo(this),this.clearDepth=new ko(this),this.clearStencil=new Bo(this),this.colorMask=new No(this),this.depthMask=new Uo(this),this.stencilMask=new Go(this),this.stencilFunc=new jo(this),this.stencilOp=new Vo(this),this.stencilTest=new qo(this),this.depthRange=new Zo(this),this.depthTest=new Ho(this),this.depthFunc=new Wo(this),this.blend=new $o(this),this.blendFunc=new Xo(this),this.blendColor=new Yo(this),this.blendEquation=new Ko(this),this.cullFace=new Jo(this),this.cullFaceSide=new Qo(this),this.frontFace=new er(this),this.program=new yh(this),this.activeTexture=new ir(this),this.viewport=new or(this),this.bindFramebuffer=new rr(this),this.bindRenderbuffer=new sr(this),this.bindTexture=new ar(this),this.bindVertexBuffer=new nr(this),this.bindElementBuffer=new lr(this),this.bindVertexArrayOES=new cr(this),this.pixelStoreUnpack=new hr(this),this.pixelStoreUnpackPremultiplyAlpha=new ur(this),this.pixelStoreUnpackFlipY=new dr(this),this.options=Le?{...Le}:{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=Re.getExtension("EXT_texture_filter_anisotropic")||Re.getExtension("MOZ_EXT_texture_filter_anisotropic")||Re.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=Re.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=Re.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=Re.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=Re.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=Re.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=Re.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=Re.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=Re.getParameter(Re.MAX_TEXTURE_SIZE),this.maxPointSize=Re.getParameter(Re.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(Re,Le,Oe){return new hs(this,Re,Le,Oe)}createVertexBuffer(Re,Le,Oe,Ue,qe){return new ds(this,Re,Le,Oe,Ue,qe)}createRenderbuffer(Re,Le,Oe){const Ue=this.gl,qe=Ue.createRenderbuffer();return this.bindRenderbuffer.set(qe),Ue.renderbufferStorage(Ue.RENDERBUFFER,Re,Le,Oe),this.bindRenderbuffer.set(null),qe}createFramebuffer(Re,Le,Oe,Ue){return new _s(this,Re,Le,Oe,Ue)}clear({color:Re,depth:Le,stencil:Oe,colorMask:Ue}){const qe=this.gl;let Ct=0;Re&&(Ct|=qe.COLOR_BUFFER_BIT,this.clearColor.set(Re),this.colorMask.set(Ue||[!0,!0,!0,!0])),void 0!==Le&&(Ct|=qe.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(Le),this.depthMask.set(!0)),void 0!==Oe&&(Ct|=qe.STENCIL_BUFFER_BIT,this.clearStencil.set(Oe),this.stencilMask.set(255)),qe.clear(Ct)}setCullFace(Re){!1===Re.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(Re.mode),this.frontFace.set(Re.frontFace))}setDepthMode(Re){Re.func!==this.gl.ALWAYS||Re.mask?(this.depthTest.set(!0),this.depthFunc.set(Re.func),this.depthMask.set(Re.mask),this.depthRange.set(Re.range)):this.depthTest.set(!1)}setStencilMode(Re){Re.test.func!==this.gl.ALWAYS||Re.mask?(this.stencilTest.set(!0),this.stencilMask.set(Re.mask),this.stencilOp.set([Re.fail,Re.depthFail,Re.pass]),this.stencilFunc.set({func:Re.test.func,ref:Re.ref,mask:Re.test.mask})):this.stencilTest.set(!1)}setColorMode(Le){Re.bh(Le.blendFunction,Ai.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(Le.blendFunction),this.blendColor.set(Le.blendColor),Le.blendEquation?this.blendEquation.set(Le.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(Le.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}let ld;function fs(Le,Oe,Ue,qe,Ct,Ot,Jt){const Hr=Le.context,Jr=Hr.gl,Ln=Le.transform,Nn=Le.getOrCreateProgram("collisionBox"),$n=[];let Gn=0,qn=0;for(let Hr=0;Hr<qe.length;Hr++){const Zn=qe[Hr],Xn=Oe.getTile(Zn),Yn=Xn.getBucket(Ue);if(!Yn)continue;const _i=ti(Zn,Yn,Ln);let vi=_i;0===Ct[0]&&0===Ct[1]||(vi=Le.translatePosMatrix(_i,Xn,Ct,Ot));const xi=Jt?Yn.textCollisionBox:Yn.iconCollisionBox,bi=Yn.collisionCircleArray;if(bi.length>0){const Le=Re.a6.mat4.create(),Oe=vi;Re.a6.mat4.mul(Le,Yn.placementInvProjMatrix,Ln.glCoordMatrix),Re.a6.mat4.mul(Le,Le,Yn.placementViewportMatrix),$n.push({circleArray:bi,circleOffset:qn,transform:Oe,invTransform:Le,projection:Yn.getProjection()}),Gn+=bi.length/4,qn=Gn}xi&&(Le.terrain&&Le.terrain.setupElevationDraw(Xn,Nn),Nn.draw(Le,Jr.LINES,Li.disabled,Mi.disabled,Le.colorModeForRenderPass(),Fi.disabled,qr(vi,Ln,Xn,Yn.getProjection()),Ue.id,xi.layoutVertexBuffer,xi.indexBuffer,xi.segments,null,Ln.zoom,null,[xi.collisionVertexBuffer,xi.collisionVertexBufferExt]))}if(!Jt||!$n.length)return;const Zn=Le.getOrCreateProgram("collisionCircle"),Xn=new Re.cQ;Xn.resize(4*Gn),Xn._trim();let Yn=0;for(const Re of $n)for(let Le=0;Le<Re.circleArray.length/4;Le++){const Oe=4*Le,Ue=Re.circleArray[Oe+0],qe=Re.circleArray[Oe+1],Ct=Re.circleArray[Oe+2],Ot=Re.circleArray[Oe+3];Xn.emplace(Yn++,Ue,qe,Ct,Ot,0),Xn.emplace(Yn++,Ue,qe,Ct,Ot,1),Xn.emplace(Yn++,Ue,qe,Ct,Ot,2),Xn.emplace(Yn++,Ue,qe,Ct,Ot,3)}(!ld||ld.length<2*Gn)&&(ld=function(Le){const Oe=2*Le,Ue=new Re.aO;Ue.resize(Oe),Ue._trim();for(let Re=0;Re<Oe;Re++){const Le=6*Re;Ue.uint16[Le+0]=4*Re+0,Ue.uint16[Le+1]=4*Re+1,Ue.uint16[Le+2]=4*Re+2,Ue.uint16[Le+3]=4*Re+2,Ue.uint16[Le+4]=4*Re+3,Ue.uint16[Le+5]=4*Re+0}return Ue}(Gn));const _i=Hr.createIndexBuffer(ld,!0),vi=Hr.createVertexBuffer(Xn,Re.cR.members,!0);for(const Oe of $n){const qe={u_matrix:Oe.transform,u_inv_matrix:Oe.invTransform,u_camera_to_center_distance:(xi=Ln).getCameraToCenterDistance(Oe.projection),u_viewport_size:[xi.width,xi.height]};Zn.draw(Le,Jr.TRIANGLES,Li.disabled,Mi.disabled,Le.colorModeForRenderPass(),Fi.disabled,qe,Ue.id,vi,_i,Re.b1.simpleSegment(0,2*Oe.circleOffset,Oe.circleArray.length,Oe.circleArray.length/2),null,Ln.zoom)}var xi;vi.destroy(),_i.destroy()}const ud=Re.a6.mat4.create();function vs(Le){const Oe=Le._camera.getWorldToCamera(Le.worldSize,1),Ue=Re.a6.mat4.multiply([],Oe,Le.globeMatrix);Re.a6.mat4.invert(Ue,Ue);const qe=[0,0,0],Ct=[0,1,0,0];return Re.a6.vec4.transformMat4(Ct,Ct,Ue),qe[0]=Ct[0],qe[1]=Ct[1],qe[2]=Ct[2],Re.a6.vec3.normalize(qe,qe),qe}function xs({width:Le,height:Oe,anchor:Ue,textOffset:qe,textScale:Ct},Ot){const{horizontalAlign:Jt,verticalAlign:Hr}=Re.bx(Ue),Jr=-(Jt-.5)*Le,Ln=-(Hr-.5)*Oe,Nn=Re.bw(Ue,qe);return new Re.P((Jr/Ct+Nn[0])*Ot,(Ln/Ct+Nn[1])*Ot)}function ys(Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr,Ln,Nn){const $n=Le.text.placedSymbolArray,Gn=Le.text.dynamicLayoutVertexArray,qn=Le.icon.dynamicLayoutVertexArray,Zn={},Xn=Le.getProjection(),Yn=ii(Hr,Xn,Ot),_i=Ot.elevation,vi=Xn.upVectorScale(Hr.canonical,Ot.center.lat,Ot.worldSize).metersToTile;Gn.clear();for(let qn=0;qn<$n.length;qn++){const xi=$n.get(qn),{tileAnchorX:bi,tileAnchorY:Pi,numGlyphs:lo}=xi,uo=xi.hidden||!xi.crossTileID||Le.allowVerticalPlacement&&!xi.placedOrientation?null:qe[xi.crossTileID];if(uo){let qe=0,$n=0,qn=0;if(_i){const Re=_i?_i.getAtTileOffset(Hr,bi,Pi):0,[Le,Oe,Ue]=Xn.upVector(Hr.canonical,bi,Pi);qe=Re*Le*vi,$n=Re*Oe*vi,qn=Re*Ue*vi}let[po,fo,Io,is]=Ut(xi.projectedAnchorX+qe,xi.projectedAnchorY+$n,xi.projectedAnchorZ+qn,Ue?Yn:Jt);const as=Gt(Ot.getCameraToCenterDistance(Xn),is);let Is=Ct.evaluateSizeForFeature(Le.textSizeData,Ln,xi)*as/Re.bq;Ue&&(Is*=Le.tilePixelRatio/Jr);const Xs=xs(uo,Is);Ue?(({x:po,y:fo,z:Io}=Xn.projectTilePoint(bi+Xs.x,Pi+Xs.y,Hr.canonical)),[po,fo,Io]=Ut(po+qe,fo+$n,Io+qn,Jt)):(Oe&&Xs._rotate(-Ot.angle),po+=Xs.x,fo+=Xs.y,Io=0);const ta=Le.allowVerticalPlacement&&xi.placedOrientation===Re.bk.vertical?Math.PI/2:0;for(let Le=0;Le<lo;Le++)Re.bn(Gn,po,fo,Io,ta);Nn&&xi.associatedIconIndex>=0&&(Zn[xi.associatedIconIndex]={x:po,y:fo,z:Io,angle:ta})}else Yt(lo,Gn)}if(Nn){qn.clear();const Oe=Le.icon.placedSymbolArray;for(let Le=0;Le<Oe.length;Le++){const Ue=Oe.get(Le),{numGlyphs:qe}=Ue,Ct=Zn[Le];if(Ue.hidden||!Ct)Yt(qe,qn);else{const{x:Le,y:Oe,z:Ue,angle:Ot}=Ct;for(let Ct=0;Ct<qe;Ct++)Re.bn(qn,Le,Oe,Ue,Ot)}}Le.icon.dynamicLayoutVertexBuffer.updateData(qn)}Le.text.dynamicLayoutVertexBuffer.updateData(Gn)}function bs(Le,Oe,Ue,qe,Ct,Ot,Jt={}){const Hr=Ue.paint.get("icon-translate"),Jr=Ue.paint.get("text-translate"),Ln=Ue.paint.get("icon-translate-anchor"),Nn=Ue.paint.get("text-translate-anchor"),$n=Ue.layout.get("icon-rotation-alignment"),Gn=Ue.layout.get("text-rotation-alignment"),qn=Ue.layout.get("icon-pitch-alignment"),Zn=Ue.layout.get("text-pitch-alignment"),Xn=Ue.layout.get("icon-keep-upright"),Yn=Ue.layout.get("text-keep-upright"),_i=Ue.paint.get("icon-color-saturation"),vi=Ue.paint.get("icon-color-contrast"),xi=Ue.paint.get("icon-color-brightness-min"),bi=Ue.paint.get("icon-color-brightness-max"),Pi="sea"===Ue.paint.get("symbol-elevation-reference"),lo=Ue.paint.get("text-occlusion-opacity").constantOr(0),uo=Le.context,po=uo.gl,fo=Le.transform,Io="map"===$n,is="map"===Gn,as="map"===qn,Is="map"===Zn,Xs=void 0!==Ue.layout.get("symbol-sort-key").constantOr(1);let ta=!1;const ha=Le.depthModeForSublayer(0,Li.ReadOnly),el=[Re.am(fo.center.lng),Re.at(fo.center.lat)],tl=Ue.layout.get("text-variable-anchor"),il="globe"===fo.projection.name,sl=[],fl=[0,-1,0];for(const Ct of qe){const qe=Oe.getTile(Ct),Ot=qe.getBucket(Ue);if(!Ot)continue;if("mercator"===Ot.projection.name&&il)continue;if(Ot.fullyClipped)continue;const $n="globe"===Ot.projection.name,Gn=$n?Re.a9(fo.zoom):0,qn=ii(Ct,Ot.getProjection(),fo),Zn=fo.calculatePixelsToTileUnitsMatrix(qe),uo=tl&&Ot.hasTextData(),ha=Ot.hasIconTextFit()&&uo&&Ot.hasIconData(),Al=Ot.getProjection().createInversionMatrix(fo,Ct.canonical),U=Re=>{fo.depthOcclusionForSymbolsAndCircles&&(Ue.hasInitialOcclusionOpacityProperties||Le.terrain)&&(Re.push("DEPTH_D24"),Re.push("DEPTH_OCCLUSION"))},G=()=>{const Oe=Io&&"point"!==Ue.layout.get("symbol-placement"),Jt=[];U(Jt);const Jr=Oe||ha,Nn=Ue.paint.get("icon-image-cross-fade").constantOr(0);Le.terrainRenderModeElevated()&&as&&Jt.push("PITCH_WITH_MAP_TERRAIN"),$n&&(Jt.push("PROJECTION_GLOBE_VIEW"),Jr&&Jt.push("PROJECTED_POS_ON_VIEWPORT")),Nn>0&&Jt.push("ICON_TRANSITION"),Ot.icon.zOffsetVertexBuffer&&Jt.push("Z_OFFSET"),0===_i&&0===vi&&0===xi&&1===bi||Jt.push("COLOR_ADJUSTMENT"),Ot.sdfIcons&&Jt.push("RENDER_SDF");const Yn=Ot.icon.programConfigurations.get(Ue.id),lo=Le.getOrCreateProgram("symbol",{config:Yn,defines:Jt}),uo=qe.imageAtlasTexture?qe.imageAtlasTexture.size:[0,0],is=Ot.iconSizeData,Is=Re.bj(is,fo.zoom),Xs=as||0!==fo.pitch,ta=kt(qn,qe.tileID.canonical,as,Io,fo,Ot.getProjection(),Zn),tl=Nt(qn,qe.tileID.canonical,as,Io,fo,Ot.getProjection(),Zn),sl=Le.translatePosMatrix(tl,qe,Hr,Ln,!0),Ml=Le.translatePosMatrix(qn,qe,Hr,Ln),Hl=Jr?ud:ta,Wl=Io&&!as&&!Oe;let Kl=fl;!il&&!fo.mercatorFromTransition||Io||(Kl=vs(fo));const Jl=$n?Kl:fl,Ql=Ue.getColorAdjustmentMatrix(_i,vi,xi,bi),oc=os(is.kind,Is,Wl,as,Le,Ml,Hl,sl,Pi,!1,uo,[0,0],!0,Ct,Gn,el,Al,Jl,Ot.getProjection(),Ql,Nn),lc=qe.imageAtlasTexture?qe.imageAtlasTexture:null,Oc=1!==Ue.layout.get("icon-size").constantOr(0)||Ot.iconsNeedLinear,Nc=Ot.sdfIcons||Le.options.rotating||Le.options.zooming||Oc||Xs?po.LINEAR:po.NEAREST,jc=Ot.sdfIcons&&0!==Ue.paint.get("icon-halo-width").constantOr(1),Uc=Le.terrain&&as&&Oe?Re.a6.mat4.invert(Re.a6.mat4.create(),ta):ud;if(Oe&&Ot.icon){const Re=fo.elevation,Oe=Re?Re.getAtTileOffsetFunc(Ct,fo.center.lat,fo.worldSize,Ot.getProjection()):null,Ue=Bt(qn,qe.tileID.canonical,as,Io,fo,Ot.getProjection(),Zn);Vt(Ot,qn,Le,!1,Ue,tl,as,Xn,Oe,Ct)}return{program:lo,buffers:Ot.icon,uniformValues:oc,atlasTexture:lc,atlasTextureIcon:null,atlasInterpolation:Nc,atlasInterpolationIcon:null,isSDF:Ot.sdfIcons,hasHalo:jc,tile:qe,labelPlaneMatrixInv:Uc}},j=()=>{const Oe=is&&"point"!==Ue.layout.get("symbol-placement"),Jt=[],Hr=Oe||tl||ha;Le.terrainRenderModeElevated()&&Is&&Jt.push("PITCH_WITH_MAP_TERRAIN"),$n&&(Jt.push("PROJECTION_GLOBE_VIEW"),Hr&&Jt.push("PROJECTED_POS_ON_VIEWPORT")),Ot.text.zOffsetVertexBuffer&&Jt.push("Z_OFFSET"),Ot.iconsInText&&Jt.push("RENDER_TEXT_AND_SYMBOL"),Jt.push("RENDER_SDF"),U(Jt);const Ln=Ot.text.programConfigurations.get(Ue.id),Xn=Le.getOrCreateProgram("symbol",{config:Ln,defines:Jt});let _i,vi=[0,0],xi=null;const bi=Ot.textSizeData;Ot.iconsInText&&(vi=qe.imageAtlasTexture?qe.imageAtlasTexture.size:[0,0],xi=qe.imageAtlasTexture?qe.imageAtlasTexture:null,_i=Is||0!==fo.pitch||Le.options.rotating||Le.options.zooming||"composite"===bi.kind||"camera"===bi.kind?po.LINEAR:po.NEAREST);const uo=qe.glyphAtlasTexture?qe.glyphAtlasTexture.size:[0,0],Io=Re.bj(bi,fo.zoom),as=kt(qn,qe.tileID.canonical,Is,is,fo,Ot.getProjection(),Zn),Xs=Nt(qn,qe.tileID.canonical,Is,is,fo,Ot.getProjection(),Zn),ta=Le.translatePosMatrix(Xs,qe,Jr,Nn,!0),sl=Le.translatePosMatrix(qn,qe,Jr,Nn),Ml=Hr?ud:as,Hl=is&&!Is&&!Oe;let Wl=fl;!il&&!fo.mercatorFromTransition||is||(Wl=vs(fo));const Kl=os(bi.kind,Io,Hl,Is,Le,sl,Ml,ta,Pi,!0,uo,vi,!0,Ct,Gn,el,Al,$n?Wl:fl,Ot.getProjection(),lo),Jl=qe.glyphAtlasTexture?qe.glyphAtlasTexture:null,Ql=po.LINEAR,oc=0!==Ue.paint.get("text-halo-width").constantOr(1),lc=Le.terrain&&Is&&Oe?Re.a6.mat4.invert(Re.a6.mat4.create(),as):ud;if(Oe&&Ot.text){const Re=fo.elevation,Oe=Re?Re.getAtTileOffsetFunc(Ct,fo.center.lat,fo.worldSize,Ot.getProjection()):null,Ue=Bt(qn,qe.tileID.canonical,Is,is,fo,Ot.getProjection(),Zn);Vt(Ot,qn,Le,!0,Ue,Xs,Is,Yn,Oe,Ct)}return{program:Xn,buffers:Ot.text,uniformValues:Kl,atlasTexture:Jl,atlasTextureIcon:xi,atlasInterpolation:Ql,atlasInterpolationIcon:_i,isSDF:!0,hasHalo:oc,tile:qe,labelPlaneMatrixInv:lc}},Ml=Ot.icon.segments.get().length,Hl=Ot.text.segments.get().length,Wl=Ml&&!Jt.onlyText?G():null,Kl=Hl&&!Jt.onlyIcons?j():null,Jl=Ue.paint.get("icon-opacity").constantOr(1),Ql=Ue.paint.get("text-opacity").constantOr(1);if(Xs&&Ot.canOverlap){ta=!0;const Le=Jl&&!Jt.onlyText?Ot.icon.segments.get():[],Oe=Ql&&!Jt.onlyIcons?Ot.text.segments.get():[];for(const Oe of Le)sl.push({segments:new Re.b1([Oe]),sortKey:Oe.sortKey,state:Wl});for(const Le of Oe)sl.push({segments:new Re.b1([Le]),sortKey:Le.sortKey,state:Kl})}else Jt.onlyText||sl.push({segments:Jl?Ot.icon.segments:new Re.b1([]),sortKey:0,state:Wl}),Jt.onlyIcons||sl.push({segments:Ql?Ot.text.segments:new Re.b1([]),sortKey:0,state:Kl})}ta&&sl.sort(((Re,Le)=>Re.sortKey-Le.sortKey));for(const Re of sl){const Oe=Re.state;if(Oe)if(Le.terrain?Le.terrain.setupElevationDraw(Oe.tile,Oe.program,{useDepthForOcclusion:fo.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:Oe.labelPlaneMatrixInv}):Le.setupDepthForOcclusion(fo.depthOcclusionForSymbolsAndCircles,Oe.program),uo.activeTexture.set(po.TEXTURE0),Oe.atlasTexture&&Oe.atlasTexture.bind(Oe.atlasInterpolation,po.CLAMP_TO_EDGE,!0),Oe.atlasTextureIcon&&(uo.activeTexture.set(po.TEXTURE1),Oe.atlasTextureIcon&&Oe.atlasTextureIcon.bind(Oe.atlasInterpolationIcon,po.CLAMP_TO_EDGE,!0)),Le.uploadCommonLightUniforms(Le.context,Oe.program),Oe.hasHalo){const qe=Oe.uniformValues;qe.u_is_halo=1,ws(Oe.buffers,Re.segments,Ue,Le,Oe.program,ha,Ct,Ot,qe,2),qe.u_is_halo=0}else{if(Oe.isSDF){const qe=Oe.uniformValues;Oe.hasHalo&&(qe.u_is_halo=1,ws(Oe.buffers,Re.segments,Ue,Le,Oe.program,ha,Ct,Ot,qe,1)),qe.u_is_halo=0}ws(Oe.buffers,Re.segments,Ue,Le,Oe.program,ha,Ct,Ot,Oe.uniformValues,1)}}}function ws(Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr){const Ln=[Re.dynamicLayoutVertexBuffer,Re.opacityVertexBuffer,Re.iconTransitioningVertexBuffer,Re.globeExtVertexBuffer,Re.zOffsetVertexBuffer];qe.draw(Ue,Ue.context.gl.TRIANGLES,Ct,Ot,Jt,Fi.disabled,Hr,Oe.id,Re.layoutVertexBuffer,Re.indexBuffer,Le,Oe.paint,Ue.transform.zoom,Re.programConfigurations.get(Oe.id),Ln,Jr)}function Ts(Re,Le,Oe,Ue,qe,Ct,Ot){const Jt=Re.context.gl,Hr=Oe.paint.get("fill-pattern"),Jr=Oe.is3D(),Ln=Jr?Re.stencilModeFor3D():Mi.disabled,Nn=Hr&&Hr.constantOr(1);let $n,Gn,qn,Zn,Xn;Ot?(Gn=Nn&&!Oe.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",$n=Jt.LINES):(Gn=Nn?"fillPattern":"fill",$n=Jt.TRIANGLES);for(const Yn of Ue){const Ue=Le.getTile(Yn);if(Nn&&!Ue.patternsLoaded())continue;const _i=Ue.getBucket(Oe);if(!_i)continue;Re.prepareDrawTile();const vi=_i.programConfigurations.get(Oe.id),xi=Re.isTileAffectedByFog(Yn),bi=Re.getOrCreateProgram(Gn,{config:vi,overrideFog:xi});Nn&&(Re.context.activeTexture.set(Jt.TEXTURE0),Ue.imageAtlasTexture&&Ue.imageAtlasTexture.bind(Jt.LINEAR,Jt.CLAMP_TO_EDGE),vi.updatePaintBuffers());const Pi=Hr.constantOr(null);if(Pi&&Ue.imageAtlas){const Re=Ue.imageAtlas.patternPositions[Pi.toString()];Re&&vi.setConstantPatternPositions(Re)}const lo=Re.translatePosMatrix(Yn.projMatrix,Ue,Oe.paint.get("fill-translate"),Oe.paint.get("fill-translate-anchor")),uo=Oe.paint.get("fill-emissive-strength");if(Ot){Zn=_i.indexBuffer2,Xn=_i.segments2;const Le=Re.terrain&&Re.terrain.renderingToTexture?Re.terrain.drapeBufferSize:[Jt.drawingBufferWidth,Jt.drawingBufferHeight];qn="fillOutlinePattern"===Gn&&Nn?Vr(lo,uo,Re,Ue,Le):jr(lo,uo,Le)}else Zn=_i.indexBuffer,Xn=_i.segments,qn=Nn?Gr(lo,uo,Re,Ue):Ur(lo,uo);Re.uploadCommonUniforms(Re.context,bi,Yn.toUnwrapped()),bi.draw(Re,$n,qe,Jr?Ln:Re.stencilModeForClipping(Yn),Ct,Fi.disabled,qn,Oe.id,_i.layoutVertexBuffer,Zn,Xn,Oe.paint,Re.transform.zoom,vi,void 0)}}function Es(Le,Oe,Ue,qe,Ct,Ot,Jt,Hr){Ue.resetLayerRenderingStats(Le);const Jr=Le.context,Ln=Jr.gl,Nn=Le.transform,$n=Ue.paint.get("fill-extrusion-pattern"),Gn=$n.constantOr(1),qn=Ue.paint.get("fill-extrusion-opacity"),Zn=Le.style.enable3dLights(),Xn=Ue.paint.get(Zn&&!Gn?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),Yn=[Ue.paint.get("fill-extrusion-ambient-occlusion-intensity"),Xn],_i=Ue.layout.get("fill-extrusion-edge-radius"),vi=_i>0&&!Ue.paint.get("fill-extrusion-rounded-roof"),xi=vi?0:_i,bi="globe"===Nn.projection.name?Re.c_():0,Pi="globe"===Nn.projection.name,lo=Pi?Re.a9(Nn.zoom):0,uo=[Re.am(Nn.center.lng),Re.at(Nn.center.lat)],po=Ue.paint.get("fill-extrusion-flood-light-color").toRenderColor(Ue.lut).toArray01().slice(0,3),fo=Ue.paint.get("fill-extrusion-flood-light-intensity"),Io=Ue.paint.get("fill-extrusion-vertical-scale"),is=0!==Ue.paint.get("fill-extrusion-line-width").constantOr(1),as=Wi(Le,Ue.paint.get("fill-extrusion-cutoff-fade-range")),Is=[];let Xs;Pi&&Is.push("PROJECTION_GLOBE_VIEW"),Yn[0]>0&&Is.push("FAUX_AO"),vi&&Is.push("ZERO_ROOF_RADIUS"),Hr&&Is.push("HAS_CENTROID"),fo>0&&Is.push("FLOOD_LIGHT"),as.shouldRenderCutoff&&Is.push("RENDER_CUTOFF"),is&&Is.push("RENDER_WALL_MODE");const ta="shadow"===Le.renderPass,ha=Le.shadowRenderer,el=ta&&!!ha;Le.shadowRenderer&&(Le.shadowRenderer.useNormalOffset=!0);let tl=[0,0,0];if(ha){const Re=Le.style.directionalLight,Oe=Le.style.ambientLight;Re&&Oe&&(tl=eo(Le.style,Re,Oe)),Xs=Is.concat(["SHADOWS_SINGLE_CASCADE"])}const il=el?"fillExtrusionDepth":Gn?"fillExtrusionPattern":"fillExtrusion",sl=Ue.getLayerRenderingStats();for(const Re of qe){const qe=Oe.getTile(Re),Zn=qe.getBucket(Ue);if(!Zn||Zn.projection.name!==Nn.projection.name)continue;let Xn=!1;ha&&(Xn=0===ha.getMaxCascadeForTile(Re.toUnwrapped()));const _i=Le.isTileAffectedByFog(Re),vi=Zn.programConfigurations.get(Ue.id),el=Le.getOrCreateProgram(il,{config:vi,defines:Xn?Xs:Is,overrideFog:_i});if(Le.terrain&&Le.terrain.setupElevationDraw(qe,el,{useMeterToDem:!0}),!Zn.centroidVertexBuffer){const Re=el.attributes.a_centroid_pos;void 0!==Re&&Ln.vertexAttrib2f(Re,0,0)}!ta&&ha&&ha.setupShadows(qe.tileID.toUnwrapped(),el,"vector-tile",qe.tileID.overscaledZ),Gn&&(Le.context.activeTexture.set(Ln.TEXTURE0),qe.imageAtlasTexture&&qe.imageAtlasTexture.bind(Ln.LINEAR,Ln.CLAMP_TO_EDGE),vi.updatePaintBuffers());const fl=$n.constantOr(null);if(fl&&qe.imageAtlas){const Re=qe.imageAtlas.patternPositions[fl.toString()];Re&&vi.setConstantPatternPositions(Re)}const Al=Ue.paint.get("fill-extrusion-vertical-gradient"),Ml=1/Zn.tileToMeter;let Hl;if(ta&&ha){if(As(qe.tileID,Zn,Le))continue;const Re=ha.calculateShadowPassMatrixFromTile(qe.tileID.toUnwrapped());Hl=Br(Re,xi,Ml,Io)}else{const Oe=Le.translatePosMatrix(Re.expandedProjMatrix,qe,Ue.paint.get("fill-extrusion-translate"),Ue.paint.get("fill-extrusion-translate-anchor")),Ct=Nn.projection.createInversionMatrix(Nn,Re.canonical);Hl=Gn?Nr(Oe,Le,Al,qn,Yn,xi,Ml,Re,qe,bi,lo,uo,Ct,po,Io):kr(Oe,Le,Al,qn,Yn,xi,Ml,Re,bi,lo,uo,Ct,po,Io,fo,tl)}Le.uploadCommonUniforms(Jr,el,Re.toUnwrapped(),null,as);let Wl=Zn.segments;if("mercator"===Nn.projection.name&&!ta&&(Wl=Zn.getVisibleSegments(qe.tileID,Le.terrain,Le.transform.getFrustum(0)),!Wl.get().length))continue;if(sl)if(ta)for(const Re of Wl.get())sl.numRenderedVerticesInShadowPass+=Re.primitiveLength;else for(const Re of Wl.get())sl.numRenderedVerticesInTransparentPass+=Re.primitiveLength;const Kl=[];(Le.terrain||Hr)&&Kl.push(Zn.centroidVertexBuffer),Pi&&Kl.push(Zn.layoutVertexExtBuffer),is&&Kl.push(Zn.wallVertexBuffer),el.draw(Le,Jr.gl.TRIANGLES,Ct,Ot,Jt,Fi.backCCW,Hl,Ue.id,Zn.layoutVertexBuffer,Zn.indexBuffer,Wl,Ue.paint,Le.transform.zoom,vi,Kl)}Le.shadowRenderer&&(Le.shadowRenderer.useNormalOffset=!1)}function Cs(Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr,Ln,Nn,$n,Gn,qn,Zn,Xn,Yn,_i,vi){const xi=Le.context,bi=xi.gl,Pi=Le.transform,lo=Le.transform.zoom,uo=[],po=Wi(Le,Ue.paint.get("fill-extrusion-cutoff-fade-range"));"clear"===Ln?(uo.push("CLEAR_SUBPASS"),vi&&(uo.push("CLEAR_FROM_TEXTURE"),xi.activeTexture.set(bi.TEXTURE0),vi.bind(bi.LINEAR,bi.CLAMP_TO_EDGE))):"sdf"===Ln&&uo.push("SDF_SUBPASS"),Yn&&uo.push("HAS_CENTROID"),po.shouldRenderCutoff&&uo.push("RENDER_CUTOFF");const fo=Ue.layout.get("fill-extrusion-edge-radius"),I=(Re,Oe,qe,Ln,_i)=>{const bi=Oe.programConfigurations.get(Ue.id),Pi=Le.isTileAffectedByFog(Re),Io=Le.getOrCreateProgram("fillExtrusionGroundEffect",{config:bi,defines:uo,overrideFog:Pi}),is=((Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr,Ln)=>({u_matrix:Le,u_opacity:Oe,u_ao_pass:Ue?1:0,u_meter_to_tile:qe,u_ao:Ct,u_flood_light_intensity:Ot,u_flood_light_color:Jt,u_attenuation:Hr,u_edge_radius:Jr,u_fb:0,u_fb_size:Ln,u_dynamic_offset:1}))(0,Ln,Nn,Jr,_i,[$n,Gn*_i],qn,Zn,Xn,lo>=17?0:fo*_i,vi?vi.size[0]:0),as=[];Yn&&as.push(Oe.hiddenByLandmarkVertexBuffer),Le.uploadCommonUniforms(xi,Io,Re.toUnwrapped(),null,po),Io.draw(Le,xi.gl.TRIANGLES,Ct,Ot,Jt,Hr,is,Ue.id,Oe.vertexBuffer,Oe.indexBuffer,qe,Ue.paint,lo,bi,as)};for(const Ct of qe){const qe=Oe.getTile(Ct),Ot=qe.getBucket(Ue);if(!Ot||Ot.projection.name!==Pi.projection.name||!Ot.groundEffect||Ot.groundEffect&&!Ot.groundEffect.hasData())continue;const Jt=Ot.groundEffect,Hr=1/Ot.tileToMeter;{const Re=Le.translatePosMatrix(Ct.projMatrix,qe,Ue.paint.get("fill-extrusion-translate"),Ue.paint.get("fill-extrusion-translate-anchor")),Oe=Jt.getDefaultSegment();I(Ct,Jt,Oe,Re,Hr)}if(_i)for(let Ot=0;Ot<4;Ot++){const Jt=Re.c$[Ot](Ct),Jr=Oe.getTile(Jt);if(!Jr)continue;const Ln=Jr.getBucket(Ue);if(!Ln||Ln.projection.name!==Pi.projection.name||!Ln.groundEffect||Ln.groundEffect&&!Ln.groundEffect.hasData())continue;const Nn=Ln.groundEffect;let $n,Gn;0===Ot?($n=[-Re.ab,0,0],Gn=1):1===Ot?($n=[Re.ab,0,0],Gn=0):2===Ot?($n=[0,-Re.ab,0],Gn=3):($n=[0,Re.ab,0],Gn=2);const qn=Nn.regionSegments[Gn];if(!qn)continue;const Zn=new Float32Array(16);Re.a6.mat4.translate(Zn,Ct.projMatrix,$n),I(Ct,Nn,qn,Le.translatePosMatrix(Zn,qe,Ue.paint.get("fill-extrusion-translate"),Ue.paint.get("fill-extrusion-translate-anchor")),Hr)}}}function Ss(Le,Oe,Ue,qe,Ct,Ot,Jt){0===qe.centroidVertexArray.length&&qe.createCentroidsBuffer();const Hr=Ot?Ot.findDEMTileFor(Ue):null;if(!(Hr&&Hr.dem||Jt))return;const c=Le=>new Re.P(Math.ceil((Le+Re.d2)*Re.d3),0),h=Re=>{const Le=Oe.getSource().minzoom,o=Re=>{const Le=Oe.getTileByID(Re);if(Le&&Le.hasData())return Le.getBucket(Ct)},Ue=[0,-1,1];for(const Oe of Ue){if(Re.overscaledZ+Oe<Le)continue;const Ue=o(Re.calculateScaledKey(Re.overscaledZ+Oe));if(Ue)return Ue}},Jr=[0,0,0],d=(Le,Oe)=>(Jr[0]=Math.min(Le.min.y,Oe.min.y),Jr[1]=Math.max(Le.max.y,Oe.max.y),Jr[2]=Re.ab-Oe.min.x>Le.max.x?Oe.min.x-Re.ab:Le.max.x,Jr),_=(Le,Oe)=>(Jr[0]=Math.min(Le.min.x,Oe.min.x),Jr[1]=Math.max(Le.max.x,Oe.max.x),Jr[2]=Re.ab-Oe.min.y>Le.max.y?Oe.min.y-Re.ab:Le.max.y,Jr),Ln=[(Re,Le)=>d(Re,Le),(Re,Le)=>d(Le,Re),(Re,Le)=>_(Re,Le),(Re,Le)=>_(Le,Re)],m=(Le,Oe,qe,Ct,Jt,Jr,Ln)=>{if(!Ot)return 0;const Nn=[[Jr?qe:Le,Jr?Le:qe,0],[Jr?qe:Oe,Jr?Oe:qe,0]],$n=Ln<0?Re.ab+Ln:Ln,Gn=[Jr?$n:(Le+Oe)/2,Jr?(Le+Oe)/2:$n,0];return 0===qe&&Ln<0||0!==qe&&Ln>0?Ot.getForTilePoints(Jt,[Gn],!0,Ct):Nn.push(Gn),Ot.getForTilePoints(Ue,Nn,!0,Hr),Math.max(Nn[0][2],Nn[1][2],Gn[2])/Ot.exaggeration()};for(let Le=0;Le<4;Le++){const Oe=qe.borderFeatureIndices[Le];if(0===Oe.length)continue;const Ct=Re.c$[Le](Ue),Hr=h(Ct);if(!(Hr&&Hr instanceof Re.d0))continue;if(qe.borderDoneWithNeighborZ[Le]===Hr.canonical.z)continue;0===Hr.centroidVertexArray.length&&Hr.createCentroidsBuffer();const Jr=Ot?Ot.findDEMTileFor(Ct):null;if(!(Jr&&Jr.dem||Jt))continue;const Gn=(Le<2?1:5)-Le,qn=Hr.borderDoneWithNeighborZ[Gn]!==qe.canonical.z,Zn=Hr.borderFeatureIndices[Gn];let Xn=0;if(qe.canonical.z!==Hr.canonical.z){for(const Re of Oe)qe.showCentroid(qe.featuresOnBorder[Re]);if(qn)for(const Re of Zn)Hr.showCentroid(Hr.featuresOnBorder[Re]);qe.borderDoneWithNeighborZ[Le]=Hr.canonical.z,Hr.borderDoneWithNeighborZ[Gn]=qe.canonical.z}for(const Ue of Oe){const Oe=qe.featuresOnBorder[Ue],Ot=qe.centroidData[Oe.centroidDataIndex],qn=Oe.borders[Le];let Yn;for(;Xn<Zn.length;){Yn=Hr.featuresOnBorder[Zn[Xn]];const Re=Yn.borders[Gn];if(Re[1]>qn[0]+3||Re[0]>qn[0]-3)break;Hr.showCentroid(Yn),Xn++}if(Yn&&Xn<Zn.length){const Ue=Xn;let _i=0;for(;!(Yn.borders[Gn][0]>qn[1]-3)&&(_i++,++Xn!==Zn.length);)Yn=Hr.featuresOnBorder[Zn[Xn]];Yn=Hr.featuresOnBorder[Zn[Ue]];let vi=!1;if(_i>=1){const Re=Yn.borders[Gn];Math.abs(qn[0]-Re[0])<3&&Math.abs(qn[1]-Re[1])<3&&(_i=1,vi=!0,Xn=Ue+1)}else if(0===_i){qe.showCentroid(Oe);continue}const xi=Hr.centroidData[Yn.centroidDataIndex];Jt&&vi&&(((Nn=Ot).flags|($n=xi).flags)&Re.d1?(Nn.flags|=Re.d1,$n.flags|=Re.d1):(Nn.flags&=~Re.d1,$n.flags&=~Re.d1));const bi=Oe.intersectsCount()>1||Yn.intersectsCount()>1;if(_i>1)Xn=Ue,Ot.centroidXY=xi.centroidXY=new Re.P(0,0);else if(Jr&&Jr.dem&&!bi){const Oe=Ln[Le](Ot,xi),Ue=Le%2?Re.ab-1:0,qe=m(Oe[0],Math.min(Re.ab-1,Oe[1]),Ue,Jr,Ct,Le<2,Oe[2]);Ot.centroidXY=xi.centroidXY=c(qe)}else bi?Ot.centroidXY=xi.centroidXY=new Re.P(0,0):(Ot.centroidXY=qe.encodeBorderCentroid(Oe),xi.centroidXY=Hr.encodeBorderCentroid(Yn));qe.writeCentroidToBuffer(Ot),Hr.writeCentroidToBuffer(xi)}else qe.showCentroid(Oe)}qe.borderDoneWithNeighborZ[Le]=Hr.canonical.z,Hr.borderDoneWithNeighborZ[Gn]=qe.canonical.z}var Nn,$n;(qe.needsCentroidUpdate||!qe.centroidVertexBuffer&&0!==qe.centroidVertexArray.length)&&qe.uploadCentroid(Le)}const _d=[1,0,0],xd=[0,1,0],wd=[0,0,1];function As(Le,Oe,Ue){const qe=Ue.transform,Ct=Ue.shadowRenderer;if(!Ct)return!0;const Ot=Le.toUnwrapped(),Jt=qe.tileSize*Ct._cascades[Ue.currentShadowCascade].scale;let Hr=Oe.maxHeight;if(qe.elevation){const Re=qe.elevation.getMinMaxForTile(Le);Re&&(Hr+=Re.max)}const Jr=[...Ct.shadowDirection];Jr[2]=-Jr[2];const Ln=Ct.computeSimplifiedTileShadowVolume(Ot,Hr,Jt,Jr);if(!Ln)return!1;const Nn=[_d,xd,wd,Jr,[Jr[0],0,Jr[2]],[0,Jr[1],Jr[2]]],$n="globe"===qe.projection.name,Gn=qe.scaleZoom(Jt),qn=Re.bN.fromInvProjectionMatrix(qe.invProjMatrix,qe.worldSize,Gn,!$n),Zn=Ct.getCurrentCascadeFrustum();return 0===qn.intersectsPrecise(Ln.vertices,Ln.planes,Nn)||0===Zn.intersectsPrecise(Ln.vertices,Ln.planes,Nn)}function Ls(Le){return[Le[0]*Re.d4,Le[1]*Re.d4,Le[2]*Re.d4,0]}function Ps(Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr){const Ln=qe.getSource(),Nn=Ue.globeSharedBuffers;if(!Nn)return;let $n,Gn,qn;if(Oe&&($n=qe.getTile(Oe)),Ln instanceof Re.aD?(Gn=Ln.texture,qn=Re.cD(0,0,Ue.transform)):$n&&Oe&&(Gn=$n.texture,qn=Re.cD(Oe.canonical.z,Oe.canonical.x,Ue.transform)),!Gn||!qn)return;Le||(qn=Re.a6.mat4.scale(Re.a6.mat4.create(),qn,[1,-1,1]));const Zn=Ue.context,Xn=Zn.gl,Yn="nearest"===Ct.paint.get("raster-resampling")?Xn.NEAREST:Xn.LINEAR,_i=Ue.colorModeForDrapableLayerRenderPass(Ot),vi=Jt.defines;vi.push("GLOBE_POLES");const xi=new Li(Xn.LEQUAL,Li.ReadWrite,Ue.depthRangeFor3D),bi=Float32Array.from(Ue.transform.expandedFarZProjMatrix),Pi=Float32Array.from(Re.b5(Re.cC(new Re.bP(0,0,0))));Ue.terrain&&Ue.terrain.prepareDrawTile(),Zn.activeTexture.set(Xn.TEXTURE0),Gn.bind(Yn,Xn.CLAMP_TO_EDGE),Zn.activeTexture.set(Xn.TEXTURE1),Gn.bind(Yn,Xn.CLAMP_TO_EDGE),Gn.useMipmap&&Zn.extTextureFilterAnisotropic&&Ue.transform.pitch>20&&Xn.texParameterf(Xn.TEXTURE_2D,Zn.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Zn.extTextureFilterAnisotropicMax);const[lo,uo,po,fo]=Oe?Nn.getPoleBuffers(Oe.canonical.z,!1):Nn.getPoleBuffers(0,!0),Io=Ct.paint.get("raster-elevation");let is;Le?(is=lo,Ue.renderDefaultNorthPole=0!==Io):(is=uo,Ue.renderDefaultSouthPole=0!==Io);const as=Ls(Jt.mix),Is=((Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr,Ln,Nn,$n)=>Yr(Re,Le,Oe,new Float32Array(16),new Float32Array(9),[0,0],Ue,[0,0],[0,0,0,0],1,{opacity:1,mix:0},Ct,[0,0]||[0,0],Jt,2,Jr,Ln,Nn,1,0,$n))(bi,Pi,qn,Re.a9(Ue.transform.zoom),0,Ct,0,Io,0,as,Jt.offset,Jt.range,Ot),Xs=Ue.getOrCreateProgram("raster",{defines:vi});Ue.uploadCommonUniforms(Zn,Xs,null),Xs.draw(Ue,Xn.TRIANGLES,xi,Jr,_i,Hr,Is,Ct.id,is,po,fo)}function Ms(Re){const Le=Re._nearZ,Oe=Re.projection.farthestPixelDistance(Re),Ue=Oe-Le,qe=.2*Re.height,Ct=Le+qe;return[Le,Oe,(Ct-qe-Le)/Ue,(Ct-Le)/Ue]}function zs(Re,Le,Oe,Ue){if(Re)return Le instanceof Qe&&Re instanceof mt?Le.getTextureDescriptor(Re,Oe,!0):{texture:Re.texture,mix:Ls(Ue.mix),offset:Ue.offset,buffer:0,tileSize:1}}var Sd=Re.d5([{name:"a_index",type:"Int16",components:1}]);class Fs{constructor(Le,Oe,Ue,qe){const Ct={width:Ue[0],height:Ue[1],data:null},Ot=Le.gl;this.targetColorTexture=new Re.T(Le,Ct,Ot.RGBA8,{useMipmap:!1}),this.backgroundColorTexture=new Re.T(Le,Ct,Ot.RGBA8,{useMipmap:!1}),this.context=Le,this.updateParticleTexture(Oe,qe),this.lastInvalidatedAt=0}updateParticleTexture(Le,Oe){if(this.particleTextureDimension===Oe.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const Ue=this.context.gl,qe=Oe.width*Oe.height;this.particleTexture0=new Re.T(this.context,Oe,Ue.RGBA8,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new Re.T(this.context,Oe,Ue.RGBA8,{premultiply:!1,useMipmap:!1});const Ct=new Re.d6;Ct.reserve(qe);for(let Re=0;Re<qe;Re++)Ct.emplaceBack(Re);this.particleIndexBuffer=this.context.createVertexBuffer(Ct,Sd.members,!0),this.particleSegment=Re.b1.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=Oe.width}update(Le){return!(this.lastInvalidatedAt<Le&&(this.lastInvalidatedAt=Re.q.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}function ks(Le,Oe,Ue){if(!Le)return null;const qe=Oe.getTextureDescriptor(Le,Ue,!0);if(!qe)return null;let{texture:Ct,mix:Ot,offset:Jt,tileSize:Hr,buffer:Jr,format:Ln}=qe;if(!Ct||!Ln)return null;let Nn=!1;return"uint32"===Ln&&(Nn=!0,Ot[3]=0,Ot=$r(Re.d7,Ot,[0,Ue.paint.get("raster-particle-max-speed")]),Jt=Xr(Re.d7,Jt,[0,Ue.paint.get("raster-particle-max-speed")])),{texture:Ct,textureOffset:[Jr/(Hr+2*Jr),Hr/(Hr+2*Jr)],tileSize:Hr,scalarData:Nn,scale:Ot,offset:Jt,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[Ln]]}}function Bs(Re){const Le=Re._nearZ,Oe=Re.projection.farthestPixelDistance(Re),Ue=Oe-Le,qe=.2*Re.height,Ct=Le+qe;return[Le,Oe,(Ct-qe-Le)/Ue,(Ct-Le)/Ue]}const Cd=new Re.bz(1,0,0,1),Ad=new Re.bz(0,1,0,1),Md=new Re.bz(0,0,1,1),Od=new Re.bz(1,0,1,1),zd=new Re.bz(0,1,1,1);function qs(Le,Oe,Ue,qe,Ct,Ot,Jt){const Hr=Le.context,Jr=Le.transform,Ln=Hr.gl,Nn="globe"===Jr.projection.name,$n=Nn?["PROJECTION_GLOBE_VIEW"]:[];let Gn=Re.a6.mat4.clone(Ue.projMatrix);if(Nn&&Re.a9(Jr.zoom)>0){const Le=Re.b4(Ue.canonical,Jr),Oe=Re.d8(Le);Gn=Re.a6.mat4.multiply(new Float32Array(16),Jr.globeMatrix,Oe),Re.a6.mat4.multiply(Gn,Jr.projMatrix,Gn)}const qn=Re.a6.mat4.create();qn[12]+=2*Ct/(Re.q.devicePixelRatio*Jr.width),qn[13]+=2*Ot/(Re.q.devicePixelRatio*Jr.height),Re.a6.mat4.multiply(Gn,qn,Gn);const Zn=Le.getOrCreateProgram("debug",{defines:$n}),Xn=Oe.getTileByID(Ue.key);Le.terrain&&Le.terrain.setupElevationDraw(Xn,Zn);const Yn=Li.disabled,_i=Mi.disabled,vi=Le.colorModeForRenderPass(),xi="$debug";Hr.activeTexture.set(Ln.TEXTURE0),Le.emptyTexture.bind(Ln.LINEAR,Ln.CLAMP_TO_EDGE),Nn?Xn._makeGlobeTileDebugBuffers(Le.context,Jr):Xn._makeDebugTileBoundsBuffers(Le.context,Jr.projection);const bi=Xn._tileDebugBuffer||Le.debugBuffer,Pi=Xn._tileDebugIndexBuffer||Le.debugIndexBuffer,lo=Xn._tileDebugSegments||Le.debugSegments;if(Zn.draw(Le,Ln.LINE_STRIP,Yn,_i,vi,Fi.disabled,Zr(Gn,qe),xi,bi,Pi,lo,null,null,null,[Xn._globeTileDebugBorderBuffer]),Jt){const Re=Xn.latestRawTileData,Oe=Math.floor((Re&&Re.byteLength||0)/1024);let qe=Ue.canonical.toString();Ue.overscaledZ!==Ue.canonical.z&&(qe+=` => ${Ue.overscaledZ}`),qe+=` ${Xn.state}`,qe+=` ${Oe}kb`,function(Re,Le){Re.initDebugOverlayCanvas();const Oe=Re.debugOverlayCanvas,Ue=Re.context.gl,qe=Re.debugOverlayCanvas.getContext("2d");qe.clearRect(0,0,Oe.width,Oe.height),qe.shadowColor="white",qe.shadowBlur=2,qe.lineWidth=1.5,qe.strokeStyle="white",qe.textBaseline="top",qe.font="bold 36px Open Sans, sans-serif",qe.fillText(Le,5,5),qe.strokeText(Le,5,5),Re.debugOverlayTexture.update(Oe),Re.debugOverlayTexture.bind(Ue.LINEAR,Ue.CLAMP_TO_EDGE)}(Le,qe)}const uo=Oe.getTile(Ue).tileSize,po=512/Math.min(uo,512)*(Ue.overscaledZ/Jr.zoom)*.5,fo=Xn._tileDebugTextBuffer||Le.debugBuffer,Io=Xn._tileDebugTextIndexBuffer||Le.quadTriangleIndexBuffer,is=Xn._tileDebugTextSegments||Le.debugSegments;Zn.draw(Le,Ln.TRIANGLES,Yn,_i,Ai.alphaBlended,Fi.disabled,Zr(Gn,Re.bz.transparent,po),xi,fo,Io,is,null,null,null,[Xn._globeTileDebugTextBuffer])}function Zs(Re,Le,Oe,Ue){Ws(Re,0,Le+Oe/2,Re.transform.width,Oe,Ue)}function Hs(Re,Le,Oe,Ue){Ws(Re,Le-Oe/2,0,Oe,Re.transform.height,Ue)}function Ws(Le,Oe,Ue,qe,Ct,Ot){const Jt=Le.context,Hr=Jt.gl;Hr.enable(Hr.SCISSOR_TEST),Hr.scissor(Oe*Re.q.devicePixelRatio,Ue*Re.q.devicePixelRatio,qe*Re.q.devicePixelRatio,Ct*Re.q.devicePixelRatio),Jt.clear({color:Ot}),Hr.disable(Hr.SCISSOR_TEST)}const Bd=Re.d5([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Ud}=Bd;function Ys(Re,Le,Oe,Ue){Re.emplaceBack(Le,Oe,Ue)}class Ks{constructor(Le){this.vertexArray=new Re.d9,this.indices=new Re.aO,Ys(this.vertexArray,-1,-1,1),Ys(this.vertexArray,1,-1,1),Ys(this.vertexArray,-1,1,1),Ys(this.vertexArray,1,1,1),Ys(this.vertexArray,-1,-1,-1),Ys(this.vertexArray,1,-1,-1),Ys(this.vertexArray,-1,1,-1),Ys(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=Le.createVertexBuffer(this.vertexArray,Ud),this.indexBuffer=Le.createIndexBuffer(this.indices),this.segment=Re.b1.simpleSegment(0,0,36,12)}}function Js(Le,Oe,Ue,qe,Ct,Ot){const Jt=Le.context.gl,Hr=Oe.paint.get("sky-atmosphere-color"),Jr=Oe.paint.get("sky-atmosphere-halo-color"),Ln=Oe.paint.get("sky-atmosphere-sun-intensity"),Nn=((Re,Le,Oe,Ue,qe)=>({u_matrix_3f:Re,u_sun_direction:Le,u_sun_intensity:Oe,u_color_tint_r:[Ue.r,Ue.g,Ue.b,Ue.a],u_color_tint_m:[qe.r,qe.g,qe.b,qe.a],u_luminance:5e-5}))(Re.a6.mat3.fromMat4(Re.a6.mat3.create(),qe),Ct,Ln,Hr,Jr);Jt.framebufferTexture2D(Jt.FRAMEBUFFER,Jt.COLOR_ATTACHMENT0,Jt.TEXTURE_CUBE_MAP_POSITIVE_X+Ot,Oe.skyboxTexture,0),Ue.draw(Le,Jt.TRIANGLES,Li.disabled,Mi.disabled,Ai.unblended,Fi.frontCW,Nn,"skyboxCapture",Oe.skyboxGeometry.vertexBuffer,Oe.skyboxGeometry.indexBuffer,Oe.skyboxGeometry.segment)}const Hd=Re.d5([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class ea{constructor(Le){const Oe=new Re.da;Oe.emplaceBack(-1,1,1,0,0),Oe.emplaceBack(1,1,1,1,0),Oe.emplaceBack(1,-1,1,1,1),Oe.emplaceBack(-1,-1,1,0,1);const Ue=new Re.aO;Ue.emplaceBack(0,1,2),Ue.emplaceBack(2,3,0),this.vertexBuffer=Le.createVertexBuffer(Oe,Hd.members),this.indexBuffer=Le.createIndexBuffer(Ue),this.segments=Re.b1.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Wd=Re.d5([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class ia{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class oa{constructor(Le){this.colorModeAlphaBlendedWriteRGB=new Ai([1,Kc,1,Kc],Re.bz.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new Ai([1,0,1,0],Re.bz.transparent,[!1,!1,!1,!0]),this.params=new ia,this.updateNeeded=!0,Le.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},(()=>{this.updateNeeded=!0})),Le.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),Le.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},(()=>{this.updateNeeded=!0})),Le.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},(()=>{this.updateNeeded=!0}))}update(Le){const Oe=Le.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new ea(Oe);const Le=this.params.sizeRange,Ue=this.params.intensityRange,qe=function(Le){const Oe=Re.dd(30),Ue=[];for(let qe=0;qe<Le;++qe){const Le=2*Math.PI*Oe(),qe=Math.acos(1-2*Oe())-.5*Math.PI;Ue.push(Re.a6.vec3.fromValues(Math.cos(qe)*Math.cos(Le),Math.cos(qe)*Math.sin(Le),Math.sin(qe)))}return Ue}(this.params.starsCount),Ct=Re.dd(300),Ot=new Re.db,Jt=new Re.aO;let Hr=0;for(let Oe=0;Oe<qe.length;++Oe){const Jr=Re.a6.vec3.scale([],qe[Oe],200),Ln=Math.max(0,1+.01*Le*(1*Ct()-.5)),Nn=Math.max(0,1+.01*Ue*(1*Ct()-.5));Ot.emplaceBack(Jr[0],Jr[1],Jr[2],-1,-1,Ln,Nn),Ot.emplaceBack(Jr[0],Jr[1],Jr[2],1,-1,Ln,Nn),Ot.emplaceBack(Jr[0],Jr[1],Jr[2],1,1,Ln,Nn),Ot.emplaceBack(Jr[0],Jr[1],Jr[2],-1,1,Ln,Nn),Jt.emplaceBack(Hr+0,Hr+1,Hr+2),Jt.emplaceBack(Hr+0,Hr+2,Hr+3),Hr+=4}this.starsVx=Oe.createVertexBuffer(Ot,Wd.members),this.starsIdx=Oe.createIndexBuffer(Jt),this.starsSegments=Re.b1.simpleSegment(0,0,Ot.length,Jt.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(Le,Oe){const Ue=Le.context,qe=Ue.gl,Ct=Le.transform,Ot=new Li(qe.LEQUAL,Li.ReadOnly,[0,1]),Jt=Re.a9(Ct.zoom),Hr=Le.style.getLut(Oe.scope),Jr=Oe.properties.get("color").toRenderColor(Hr).toArray01(),Ln=Oe.properties.get("high-color").toRenderColor(Hr).toArray01(),Nn=Oe.properties.get("space-color").toRenderColor(Hr).toArray01PremultipliedAlpha(),$n=5e-4,Gn=Re.dc(Oe.properties.get("horizon-blend"),0,1,$n,.25),qn=Re.cx(Le,Ue,Ct)&&Gn===$n?Ct.worldSize/(2*Math.PI*1.025)-1:Ct.globeRadius,Zn=Le.frameCounter/1e3%1,Xn=Re.a6.vec3.length(Ct.globeCenterInViewSpace),Yn=Math.sqrt(Math.pow(Xn,2)-Math.pow(qn,2)),_i=Math.acos(Yn/Xn),x=Re=>{const Oe="globe"===Ct.projection.name?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];Re&&Oe.push("ALPHA_PASS");const Hr=Le.getOrCreateProgram("globeAtmosphere",{defines:Oe}),$n=((Re,Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr,Ln,Nn)=>({u_frustum_tl:Re,u_frustum_tr:Le,u_frustum_br:Oe,u_frustum_bl:Ue,u_horizon:qe,u_transition:Ct,u_fadeout_range:Ot,u_color:Jt,u_high_color:Hr,u_space_color:Jr,u_temporal_offset:Ln,u_horizon_angle:Nn}))(Ct.frustumCorners.TL,Ct.frustumCorners.TR,Ct.frustumCorners.BR,Ct.frustumCorners.BL,Ct.frustumCorners.horizon,Jt,Gn,Jr,Ln,Nn,Zn,_i);Le.uploadCommonUniforms(Ue,Hr);const qn=this.atmosphereBuffer;qn&&Hr.draw(Le,qe.TRIANGLES,Ot,Mi.disabled,Re?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,Fi.backCW,$n,Re?"atmosphere_glow_alpha":"atmosphere_glow",qn.vertexBuffer,qn.indexBuffer,qn.segments)};x(!1),x(!0)}drawStars(Le,Oe){const Ue=Re.ap(Oe.properties.get("star-intensity"),0,1);if(0===Ue)return;const qe=Le.context,Ct=qe.gl,Ot=Le.transform,Jt=Le.getOrCreateProgram("stars"),Hr=Re.a6.quat.identity([]);Re.a6.quat.rotateX(Hr,Hr,-Ot._pitch),Re.a6.quat.rotateZ(Hr,Hr,-Ot.angle),Re.a6.quat.rotateX(Hr,Hr,Re.bB(Ot._center.lat)),Re.a6.quat.rotateY(Hr,Hr,-Re.bB(Ot._center.lng));const Jr=Re.a6.mat4.fromQuat(new Float32Array(16),Hr),Ln=Re.a6.mat4.multiply([],Ot.starsProjMatrix,Jr),Nn=Re.a6.mat3.fromMat4([],Jr),$n=Re.a6.mat3.invert([],Nn),Gn=[0,1,0];Re.a6.vec3.transformMat3(Gn,Gn,$n),Re.a6.vec3.scale(Gn,Gn,this.params.sizeMultiplier);const qn=[1,0,0];Re.a6.vec3.transformMat3(qn,qn,$n),Re.a6.vec3.scale(qn,qn,this.params.sizeMultiplier);const Zn=(Xn=Gn,Yn=qn,_i=Ue,{u_matrix:Float32Array.from(Ln),u_up:Xn,u_right:Yn,u_intensity_multiplier:_i});var Xn,Yn,_i;Le.uploadCommonUniforms(qe,Jt),this.starsVx&&this.starsIdx&&Jt.draw(Le,Ct.TRIANGLES,Li.disabled,Mi.disabled,this.colorModeAlphaBlendedWriteRGB,Fi.disabled,Zn,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function ra(Le,Oe){const Ue=[...Le],qe=Oe.cameraWorldSizeForFog/Oe.worldSize,Ct=Re.a6.mat4.identity([]);return Re.a6.mat4.scale(Ct,Ct,[qe,qe,1]),Re.a6.mat4.multiply(Ue,Ct,Ue),Re.a6.mat4.multiply(Ue,Oe.worldToFogMatrix,Ue),Ue}function sa(Le,Oe,Ue,qe,Ct){const Ot=Ue.material,Jt=qe.context,{baseColorTexture:Hr,metallicRoughnessTexture:Jr}=Ot.pbrMetallicRoughness,{normalTexture:Ln,occlusionTexture:Nn,emissionTexture:$n}=Ot;function _(Re,Oe,Ue){if(Re&&(Le.push(Oe),Jt.activeTexture.set(Jt.gl.TEXTURE0+Ue),Re.gfxTexture)){const{minFilter:Le,magFilter:Oe,wrapS:Ue,wrapT:qe}=Re.sampler;Re.gfxTexture.bindExtraParam(Le,Oe,Ue,qe)}}_(Hr,"HAS_TEXTURE_u_baseColorTexture",ou.BaseColor),_(Jr,"HAS_TEXTURE_u_metallicRoughnessTexture",ou.MetallicRoughness),_(Ln,"HAS_TEXTURE_u_normalTexture",ou.Normal),_(Nn,"HAS_TEXTURE_u_occlusionTexture",ou.Occlusion),_($n,"HAS_TEXTURE_u_emissionTexture",ou.Emission),Ct&&(Ct.texture||(Ct.texture=new Re.df(qe.context,Ct.image,[Ct.image.height,Ct.image.height,Ct.image.height],Jt.gl.RGBA8)),Jt.activeTexture.set(Jt.gl.TEXTURE0+ou.LUT),Ct.texture&&Ct.texture.bind(Jt.gl.LINEAR,Jt.gl.CLAMP_TO_EDGE),Le.push("APPLY_LUT_ON_GPU")),Ue.texcoordBuffer&&(Le.push("HAS_ATTRIBUTE_a_uv_2f"),Oe.push(Ue.texcoordBuffer)),Ue.colorBuffer&&(Le.push(12===Ue.colorBuffer.itemSize?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),Oe.push(Ue.colorBuffer)),Ue.normalBuffer&&(Le.push("HAS_ATTRIBUTE_a_normal_3f"),Oe.push(Ue.normalBuffer)),Ue.pbrBuffer&&(Le.push("HAS_ATTRIBUTE_a_pbr"),Le.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),Oe.push(Ue.pbrBuffer)),"OPAQUE"!==Ot.alphaMode&&"MASK"!==Ot.alphaMode||Le.push("UNPREMULT_TEXTURE_IN_SHADER"),Ot.defined||Le.push("DIFFUSE_SHADED"),Le.push("USE_STANDARD_DERIVATIVES")}function aa(Le,Oe,Ue,qe,Ct,Ot){const Jt=Ue.paint.get("model-opacity"),Hr=Oe.context,Jr=new Li(Oe.context.gl.LEQUAL,Li.ReadWrite,Oe.depthRangeFor3D),Ln=Oe.transform,Nn=Le.mesh,$n=Nn.material,Gn=$n.pbrMetallicRoughness,qn=Oe.style.fog;let Zn;Zn="pixels"===Oe.transform.projection.zAxisUnit?[...Le.nodeModelMatrix]:Re.a6.mat4.multiply([],qe.zScaleMatrix,Le.nodeModelMatrix),Re.a6.mat4.multiply(Zn,qe.negCameraPosMatrix,Zn);const Xn=Re.a6.mat4.invert([],Zn);Re.a6.mat4.transpose(Xn,Xn);const Yn=Ue.paint.get("model-emissive-strength").constantOr(0),_i=ns(new Float32Array(Le.worldViewProjection),new Float32Array(Zn),new Float32Array(Xn),null,Oe,Jt,Gn.baseColorFactor.toRenderColor(null),$n.emissiveFactor,Gn.metallicFactor,Gn.roughnessFactor,$n,Yn,Ue),vi={defines:[]},xi=[];sa(vi.defines,xi,Nn,Oe,Ue.lut);const bi=Oe.shadowRenderer;bi&&(bi.useNormalOffset=!1);let Pi=null;if(qn){const Re=ra(Le.nodeModelMatrix,Oe.transform);if(Pi=new Float32Array(Re),"globe"!==Ln.projection.name){const Le=Nn.aabb.min,Oe=Nn.aabb.max,[Ue,qe]=qn.getOpacityForBounds(Re,Le[0],Le[1],Oe[0],Oe[1]);vi.overrideFog=Ue>=ta||qe>=ta}}const lo=Wi(Oe,Ue.paint.get("model-cutoff-fade-range"));lo.shouldRenderCutoff&&vi.defines.push("RENDER_CUTOFF");const uo=Oe.getOrCreateProgram("model",vi);Oe.uploadCommonUniforms(Hr,uo,null,Pi,lo),"shadow"!==Oe.renderPass&&bi&&bi.setupShadowsFromMatrix(Le.nodeModelMatrix,uo),uo.draw(Oe,Hr.gl.TRIANGLES,Jr,Ct,Ot,Nn.material.doubleSided?Fi.disabled:Fi.backCCW,_i,Ue.id,Nn.vertexBuffer,Nn.indexBuffer,Nn.segments,Ue.paint,Oe.transform.zoom,void 0,xi)}function na(Le,Oe,Ue,qe,Ct,Ot,Jt){let Hr;Hr="globe"===Le.projection.name?Re.dg(Ue,Le):[...Ue],Re.a6.mat4.multiply(Hr,Hr,Oe.matrix);const Jr=Re.a6.mat4.multiply([],qe,Hr);if(Oe.meshes)for(const Le of Oe.meshes){if("BLEND"!==Le.material.alphaMode){Jt.push({mesh:Le,depth:0,modelIndex:Ct,worldViewProjection:Jr,nodeModelMatrix:Hr});continue}const Oe=Re.a6.vec3.transformMat4([],Le.centroid,Jr);Oe[2]>0&&Ot.push({mesh:Le,depth:Oe[2],modelIndex:Ct,worldViewProjection:Jr,nodeModelMatrix:Hr})}if(Oe.children)for(const Re of Oe.children)na(Le,Re,Ue,qe,Ct,Ot,Jt)}function la(Re,Le,Oe,Ue){const qe=Oe.shadowRenderer;if(!qe)return;const Ct=qe.getShadowPassDepthMode(),Ot=qe.getShadowPassColorMode(),Jt=qe.calculateShadowPassMatrixFromMatrix(Le),Hr=ls(Jt);Oe.getOrCreateProgram("modelDepth",{defines:Oe._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(Oe,Oe.context.gl.TRIANGLES,Ct,Mi.disabled,Ot,Fi.backCCW,Hr,Ue.id,Re.vertexBuffer,Re.indexBuffer,Re.segments,Ue.paint,Oe.transform.zoom,void 0,void 0)}function ca(Le,Oe,Ue){const qe=Oe.updateZoomBasedPaintProperties(),Ct=function(Le,Oe,Ue){let qe,Ct,Ot,Jt=Le.terrain?Le.terrain.exaggeration():0;if(Le.terrain&&Jt>0){const Oe=Le.terrain,Ct=Oe.findDEMTileFor(Ue);Ct&&Ct.dem?qe=Re.di.create(Oe,Ue,Ct):Jt=0}if(0===Jt&&(Oe.terrainElevationMin=0,Oe.terrainElevationMax=0),Jt===Oe.validForExaggeration&&(0===Jt||qe&&qe._demTile&&qe._demTile.tileID===Oe.validForDEMTile.id&&qe._dem._timestamp===Oe.validForDEMTile.timestamp))return!1;for(const Re in Oe.instancesPerModel){const Le=Oe.instancesPerModel[Re];for(let Re=0;Re<Le.instancedDataArray.length;++Re){const Ue=(qe?Jt*qe.getElevationAt(0|Le.instancedDataArray.float32[16*Re],0|Le.instancedDataArray.float32[16*Re+1],!0,!0):0)+Le.instancesEvaluatedElevation[Re];Le.instancedDataArray.float32[16*Re+6]=Ue,Ct=Ct?Math.min(Oe.terrainElevationMin,Ue):Ue,Ot=Ot?Math.max(Oe.terrainElevationMax,Ue):Ue}}return Oe.terrainElevationMin=Ct||0,Oe.terrainElevationMax=Ot||0,Oe.validForExaggeration=Jt,Oe.validForDEMTile=qe&&qe._demTile?{id:qe._demTile.tileID,timestamp:qe._dem._timestamp}:{id:void 0,timestamp:0},!0}(Le,Oe,Ue);(qe||Ct)&&(Oe.uploaded=!1,Oe.upload(Le.context))}const Kd={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new Re.c9([0,0,0],[Re.ab,Re.ab,0])};function ua(Le,Oe){const Ue=1<<Le.canonical.z,qe=Oe.getFreeCameraOptions().position,Ct=Oe.elevation,Ot=Le.canonical.x/Ue,Jt=(Le.canonical.x+1)/Ue,Hr=Le.canonical.y/Ue,Jr=(Le.canonical.y+1)/Ue;let Ln=Oe._centerAltitude;if(Ct){const Re=Ct.getMinMaxForTile(Le);Re&&Re.max>Ln&&(Ln=Re.max)}const Nn=Re.ap(qe.x,Ot,Jt)-qe.x,$n=Re.ap(qe.y,Hr,Jr)-qe.y,Gn=Re.bD(Ln,Oe.center.lat)-qe.z;return Oe._zoomFromMercatorZ(Math.sqrt(Nn*Nn+$n*$n+Gn*Gn))}function da(Re,Le,Oe,Ue,qe,Ct,Ot){const Jt=Re.context,Hr="shadow"===Re.renderPass,Jr=Re.shadowRenderer,Ln=Hr&&Jr?Jr.getShadowPassDepthMode():new Li(Jt.gl.LEQUAL,Li.ReadWrite,Re.depthRangeFor3D),Nn=Re.isTileAffectedByFog(Ct);if(Oe.meshes)for(const $n of Oe.meshes){const Gn=["MODEL_POSITION_ON_GPU"],qn=[];let Zn,Xn,Yn;Ue.instancedDataArray.length>20&&Gn.push("INSTANCED_ARRAYS");const _i=Wi(Re,Le.paint.get("model-cutoff-fade-range"));if(_i.shouldRenderCutoff&&Gn.push("RENDER_CUTOFF"),Hr&&Jr)Zn=Re.getOrCreateProgram("modelDepth",{defines:Gn}),Xn=ls(Ot.shadowTileMatrix,Ot.shadowTileMatrix,Float32Array.from(Oe.matrix)),Yn=Jr.getShadowPassColorMode();else{sa(Gn,qn,$n,Re,Le.lut),Zn=Re.getOrCreateProgram("model",{defines:Gn,overrideFog:Nn});const Ue=$n.material,Hr=Ue.pbrMetallicRoughness,Ln=Le.paint.get("model-opacity"),vi=Le.paint.get("model-emissive-strength").constantOr(0);Xn=ns(Ct.expandedProjMatrix,Float32Array.from(Oe.matrix),new Float32Array(16),null,Re,Ln,Hr.baseColorFactor.toRenderColor(null),Ue.emissiveFactor,Hr.metallicFactor,Hr.roughnessFactor,Ue,vi,Le,qe),Jr&&(Ot.shadowUniformsInitialized?Zn.setShadowUniformValues(Jt,Jr.getShadowUniformValues()):(Jr.setupShadows(Ct.toUnwrapped(),Zn,"model-tile",Ct.overscaledZ),Ot.shadowUniformsInitialized=!0)),Yn=_i.shouldRenderCutoff||Ln<1||"OPAQUE"!==Ue.alphaMode?Ai.alphaBlended:Ai.unblended}Re.uploadCommonUniforms(Jt,Zn,Ct.toUnwrapped(),null,_i);const vi=$n.material.doubleSided?Fi.disabled:Fi.backCCW;if(Ue.instancedDataArray.length>20)qn.push(Ue.instancedDataBuffer),Zn.draw(Re,Jt.gl.TRIANGLES,Ln,Mi.disabled,Yn,vi,Xn,Le.id,$n.vertexBuffer,$n.indexBuffer,$n.segments,Le.paint,Re.transform.zoom,void 0,qn,Ue.instancedDataArray.length);else{const Oe=Hr?"u_instance":"u_normal_matrix";for(let qe=0;qe<Ue.instancedDataArray.length;++qe)Xn[Oe]=new Float32Array(Ue.instancedDataArray.arrayBuffer,64*qe,16),Zn.draw(Re,Jt.gl.TRIANGLES,Ln,Mi.disabled,Yn,vi,Xn,Le.id,$n.vertexBuffer,$n.indexBuffer,$n.segments,Le.paint,Re.transform.zoom,void 0,qn)}}if(Oe.children)for(const Jt of Oe.children)da(Re,Le,Jt,Ue,qe,Ct,Ot)}const sp=[1,-1,1];function pa(Le,Oe,Ue,qe){if(!Ue.modelManager)return!0;const Ct=Ue.modelManager;if(!Ue.shadowRenderer)return!0;const Ot=Ue.shadowRenderer,Jt=Oe.aabb;let Hr=!0,Jr=Le.maxHeight;if(0===Jr){let Re=0;for(const Oe in Le.instancesPerModel){const Le=Ct.getModel(Oe,qe);Le?Re=Math.max(Re,Math.max(Math.max(Le.aabb.max[0],Le.aabb.max[1]),Le.aabb.max[2])):Hr=!1}Jr=Le.maxScale*Re*1.41+Le.maxVerticalOffset,Hr&&(Le.maxHeight=Jr)}Jt.max[2]=Jr,Jt.min[2]+=Le.terrainElevationMin,Jt.max[2]+=Le.terrainElevationMax,Re.a6.vec3.transformMat4(Jt.min,Jt.min,Oe.tileMatrix),Re.a6.vec3.transformMat4(Jt.max,Jt.max,Oe.tileMatrix);const Ln=Jt.intersects(Ot.getCurrentCascadeFrustum());return 0===Ue.currentShadowCascade&&(Le.isInsideFirstShadowMapFrustum=2===Ln),0===Ln}function ma(Le,Oe){const Ue=Le.uniformValues.u_cutoff_params[0],qe=Le.uniformValues.u_cutoff_params[1],Ct=Le.uniformValues.u_cutoff_params[2],Ot=Le.uniformValues.u_cutoff_params[3];return qe===Ue||Ot===Ct?1:Re.ap(((Oe-Ue)/(qe-Ue)-Ct)/(Ot-Ct),0,1)}function fa(Le,Oe,Ue,qe){if(Oe.pitch<20)return 1;const Ct=Oe.getWorldToCameraMatrix();Re.a6.mat4.multiply(Ct,Ct,Le);const Ot=Re.a6.vec4.fromValues(Ue.min[0],Ue.min[1],Ue.min[2],1);let Jt=Re.a6.vec4.transformMat4(Re.a6.vec4.create(),Ot,Ct),Hr=Jt,Jr=Jt;Ot[1]=Ue.max[1],Jt=Re.a6.vec4.transformMat4(Re.a6.vec4.create(),Ot,Ct),Hr=Jt[1]<Hr[1]?Jt:Hr,Jr=Jt[1]>Jr[1]?Jt:Jr,Ot[0]=Ue.max[0],Jt=Re.a6.vec4.transformMat4(Re.a6.vec4.create(),Ot,Ct),Hr=Jt[1]<Hr[1]?Jt:Hr,Jr=Jt[1]>Jr[1]?Jt:Jr,Ot[1]=Ue.min[1],Jt=Re.a6.vec4.transformMat4(Re.a6.vec4.create(),Ot,Ct),Hr=Jt[1]<Hr[1]?Jt:Hr,Jr=Jt[1]>Jr[1]?Jt:Jr;const Ln=Re.ap(qe[0],0,1),Nn=100*Oe.pixelsPerMeter*Re.ap(qe[1],0,1),$n=Re.ap(qe[2],0,1),Gn=Re.a6.vec4.lerp(Re.a6.vec4.create(),Hr,Jr,Ln),qn=Math.tan(.5*Oe.fovX),Zn=-Gn[2]*qn;if(0===Nn)return Gn[1]<-Math.abs(Zn)?$n:1;const Xn=(-Math.abs(Zn)-Gn[1])/Nn,g=(Re,Le,Oe)=>(1-Oe)*Re+Oe*Le,Yn=Re.ap(g(1,$n,Xn),$n,1);return g(1,Yn,Re.ap((Oe.pitch-20)/20,0,1))}class ga{}class va{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(Le,Oe,Ue){{const Re=this._storage.get(Oe.id);if(Re)return Re.lastUsedFrameIdx=Le,Re.buf}const qe=Ue.gl,Ct=qe.getBufferParameter(qe.ELEMENT_ARRAY_BUFFER,qe.BUFFER_SIZE),Ot=new ArrayBuffer(Ct),Jt=new Int16Array(Ot);qe.getBufferSubData(qe.ELEMENT_ARRAY_BUFFER,0,new Int16Array(Ot));const Hr=new Re.dk;for(let Re=0;Re<Ct/2;Re+=3){const Le=Jt[Re],Oe=Jt[Re+1],Ue=Jt[Re+2];Hr.emplaceBack(Le,Oe),Hr.emplaceBack(Oe,Ue),Hr.emplaceBack(Ue,Le)}const Jr=Ue.bindVertexArrayOES.current,Ln=new ga;return Ln.buf=new hs(Ue,Hr),Ln.lastUsedFrameIdx=Le,this._storage.set(Oe.id,Ln),Ue.bindVertexArrayOES.set(Jr),Ln.buf}update(Re){for(const[Le,Oe]of this._storage)Re-Oe.lastUsedFrameIdx>30&&(Oe.buf.destroy(),this._storage.delete(Le))}destroy(){for(const[Re,Le]of this._storage)Le.buf.destroy(),this._storage.delete(Re)}}class xa{constructor(Re){this.occluderSize=30,this.depthOffset=-1e-4,Re.registerParameter(this,["Occlusion"],"occluderSize",{min:1,max:100,step:1}),Re.registerParameter(this,["Occlusion"],"depthOffset",{min:-.05,max:0,step:1e-5})}}const ap={symbol:function(Le,Oe,Ue,qe,Ct){if("translucent"!==Le.renderPass)return;const Ot=Mi.disabled,Jt=Le.colorModeForRenderPass();Ue.layout.get("text-variable-anchor")&&function(Le,Oe,Ue,qe,Ct,Ot,Jt){const Hr=Oe.transform,Jr="map"===Ct,Ln="map"===Ot;for(const Oe of Le){const Le=qe.getTile(Oe),Ct=Le.getBucket(Ue);if(!Ct||!Ct.text||!Ct.text.segments.get().length)continue;const Ot=Re.bj(Ct.textSizeData,Hr.zoom),Nn=ii(Oe,Ct.getProjection(),Hr),$n=Hr.calculatePixelsToTileUnitsMatrix(Le),Gn=kt(Nn,Le.tileID.canonical,Ln,Jr,Hr,Ct.getProjection(),$n),qn=Ct.hasIconTextFit()&&Ct.hasIconData();if(Ot){const Ue=Math.pow(2,Hr.zoom-Le.tileID.overscaledZ);ys(Ct,Jr,Ln,Jt,Re.cS,Hr,Gn,Oe,Ue,Ot,qn)}}}(qe,Le,Ue,Oe,Ue.layout.get("text-rotation-alignment"),Ue.layout.get("text-pitch-alignment"),Ct);const Hr=0!==Ue.paint.get("icon-opacity").constantOr(1),Jr=0!==Ue.paint.get("text-opacity").constantOr(1);void 0!==Ue.layout.get("symbol-sort-key").constantOr(1)&&(Hr||Jr)?bs(Le,Oe,Ue,qe,Ot,Jt):(Hr&&bs(Le,Oe,Ue,qe,Ot,Jt,{onlyIcons:!0}),Jr&&bs(Le,Oe,Ue,qe,Ot,Jt,{onlyText:!0})),Oe.map.showCollisionBoxes&&(fs(Le,Oe,Ue,qe,Ue.paint.get("text-translate"),Ue.paint.get("text-translate-anchor"),!0),fs(Le,Oe,Ue,qe,Ue.paint.get("icon-translate"),Ue.paint.get("icon-translate-anchor"),!1))},circle:function(Le,Oe,Ue,qe){if("translucent"!==Le.renderPass)return;const Ct=Ue.paint.get("circle-opacity"),Ot=Ue.paint.get("circle-stroke-width"),Jt=Ue.paint.get("circle-stroke-opacity"),Hr=void 0!==Ue.layout.get("circle-sort-key").constantOr(1),Jr=Ue.paint.get("circle-emissive-strength");if(0===Ct.constantOr(1)&&(0===Ot.constantOr(1)||0===Jt.constantOr(1)))return;const Ln=Le.context,Nn=Ln.gl,$n=Le.transform,Gn=Le.depthModeForSublayer(0,Li.ReadOnly),qn=Mi.disabled,Zn=Le.colorModeForDrapableLayerRenderPass(Jr),Xn="globe"===$n.projection.name,Yn=[Re.am($n.center.lng),Re.at($n.center.lat)],_i=[];for(let Ct=0;Ct<qe.length;Ct++){const Ot=qe[Ct],Jt=Oe.getTile(Ot),Jr=Jt.getBucket(Ue);if(!Jr||Jr.projection.name!==$n.projection.name)continue;const Ln=Jr.programConfigurations.get(Ue.id),Nn=Re.cT(Ue),Gn=Le.isTileAffectedByFog(Ot);Xn&&Nn.push("PROJECTION_GLOBE_VIEW"),Nn.push("DEPTH_D24"),Le.terrain&&$n.depthOcclusionForSymbolsAndCircles&&Nn.push("DEPTH_OCCLUSION");const qn=Le.getOrCreateProgram("circle",{config:Ln,defines:Nn,overrideFog:Gn}),Zn=Jr.layoutVertexBuffer,vi=Jr.globeExtVertexBuffer,xi=Jr.indexBuffer,bi=$n.projection.createInversionMatrix($n,Ot.canonical),Pi={programConfiguration:Ln,program:qn,layoutVertexBuffer:Zn,globeExtVertexBuffer:vi,indexBuffer:xi,uniformValues:Re.cU(Le,Ot,Jt,bi,Yn,Ue),tile:Jt};if(Hr){const Le=Jr.segments.get();for(const Oe of Le)_i.push({segments:new Re.b1([Oe]),sortKey:Oe.sortKey,state:Pi})}else _i.push({segments:Jr.segments,sortKey:0,state:Pi})}Hr&&_i.sort(((Re,Le)=>Re.sortKey-Le.sortKey));const vi={useDepthForOcclusion:$n.depthOcclusionForSymbolsAndCircles};for(const Re of _i){const{programConfiguration:Oe,program:qe,layoutVertexBuffer:Ct,globeExtVertexBuffer:Ot,indexBuffer:Jt,uniformValues:Hr,tile:Jr}=Re.state,Xn=Re.segments;Le.terrain&&Le.terrain.setupElevationDraw(Jr,qe,vi),Le.uploadCommonUniforms(Ln,qe,Jr.tileID.toUnwrapped()),qe.draw(Le,Nn.TRIANGLES,Gn,qn,Zn,Fi.disabled,Hr,Ue.id,Ct,Jt,Xn,Ue.paint,$n.zoom,Oe,[Ot])}},heatmap:function(Le,Oe,Ue,qe){if(0!==Ue.paint.get("heatmap-opacity"))if("offscreen"===Le.renderPass){const Ct=Le.context,Ot=Ct.gl,Jt=Mi.disabled,Hr=new Ai([Ot.ONE,Ot.ONE,Ot.ONE,Ot.ONE],Re.bz.transparent,[!0,!0,!0,!0]);!function(Re,Le,Oe,Ue){const qe=Re.gl,Ct=Le.width*Ue,Ot=Le.height*Ue;Re.activeTexture.set(qe.TEXTURE1),Re.viewport.set([0,0,Ct,Ot]);let Jt=Oe.heatmapFbo;if(!Jt||Jt&&(Jt.width!==Ct||Jt.height!==Ot)){Jt&&Jt.destroy();const Le=qe.createTexture();qe.bindTexture(qe.TEXTURE_2D,Le),qe.texParameteri(qe.TEXTURE_2D,qe.TEXTURE_WRAP_S,qe.CLAMP_TO_EDGE),qe.texParameteri(qe.TEXTURE_2D,qe.TEXTURE_WRAP_T,qe.CLAMP_TO_EDGE),qe.texParameteri(qe.TEXTURE_2D,qe.TEXTURE_MIN_FILTER,qe.LINEAR),qe.texParameteri(qe.TEXTURE_2D,qe.TEXTURE_MAG_FILTER,qe.LINEAR),Jt=Oe.heatmapFbo=Re.createFramebuffer(Ct,Ot,!0,null),function(Re,Le,Oe,Ue,qe,Ct){const Ot=Re.gl;Ot.texImage2D(Ot.TEXTURE_2D,0,Re.extRenderToTextureHalfFloat?Ot.RGBA16F:Ot.RGBA,qe,Ct,0,Ot.RGBA,Re.extRenderToTextureHalfFloat?Ot.HALF_FLOAT:Ot.UNSIGNED_BYTE,null),Ue.colorAttachment.set(Oe)}(Re,0,Le,Jt,Ct,Ot)}else qe.bindTexture(qe.TEXTURE_2D,Jt.colorAttachment.get()),Re.bindFramebuffer.set(Jt.framebuffer)}(Ct,Le,Ue,"globe"===Le.transform.projection.name?.5:.25),Ct.clear({color:Re.bz.transparent});const Jr=Le.transform,Ln="globe"===Jr.projection.name,Nn=Ln?["PROJECTION_GLOBE_VIEW"]:[],$n=Ln?Fi.frontCCW:Fi.disabled,Gn=[Re.am(Jr.center.lng),Re.at(Jr.center.lat)];for(let Re=0;Re<qe.length;Re++){const qn=qe[Re];if(Oe.hasRenderableParent(qn))continue;const Zn=Oe.getTile(qn),Xn=Zn.getBucket(Ue);if(!Xn||Xn.projection.name!==Jr.projection.name)continue;const Yn=Le.isTileAffectedByFog(qn),_i=Xn.programConfigurations.get(Ue.id),vi=Le.getOrCreateProgram("heatmap",{config:_i,defines:Nn,overrideFog:Yn}),{zoom:xi}=Le.transform;Le.terrain&&Le.terrain.setupElevationDraw(Zn,vi),Le.uploadCommonUniforms(Ct,vi,qn.toUnwrapped());const bi=Jr.projection.createInversionMatrix(Jr,qn.canonical);vi.draw(Le,Ot.TRIANGLES,Li.disabled,Jt,Hr,$n,Wr(Le,qn,Zn,bi,Gn,xi,Ue.paint.get("heatmap-intensity")),Ue.id,Xn.layoutVertexBuffer,Xn.indexBuffer,Xn.segments,Ue.paint,Le.transform.zoom,_i,Ln?[Xn.globeExtVertexBuffer]:null)}Ct.viewport.set([0,0,Le.width,Le.height])}else"translucent"===Le.renderPass&&(Le.context.setColorMode(Le.colorModeForRenderPass()),function(Le,Oe){const Ue=Le.context,qe=Ue.gl,Ct=Oe.heatmapFbo;if(!Ct)return;Ue.activeTexture.set(qe.TEXTURE0),qe.bindTexture(qe.TEXTURE_2D,Ct.colorAttachment.get()),Ue.activeTexture.set(qe.TEXTURE1);let Ot=Oe.colorRampTexture;Ot||(Ot=Oe.colorRampTexture=new Re.T(Ue,Oe.colorRamp,qe.RGBA8)),Ot.bind(qe.LINEAR,qe.CLAMP_TO_EDGE),Le.getOrCreateProgram("heatmapTexture").draw(Le,qe.TRIANGLES,Li.disabled,Mi.disabled,Le.colorModeForRenderPass(),Fi.disabled,((Re,Le)=>({u_image:0,u_color_ramp:1,u_opacity:Le.paint.get("heatmap-opacity")}))(0,Oe),Oe.id,Le.viewportBuffer,Le.quadTriangleIndexBuffer,Le.viewportSegments,Oe.paint,Le.transform.zoom)}(Le,Ue))},line:function(Le,Oe,Ue,qe){if("translucent"!==Le.renderPass)return;const Ct=Ue.paint.get("line-opacity"),Ot=Ue.paint.get("line-width");if(0===Ct.constantOr(1)||0===Ot.constantOr(1))return;const Jt=Ue.paint.get("line-emissive-strength"),Hr=Ue.paint.get("line-occlusion-opacity"),Jr=Le.context,Ln=Jr.gl,Nn=Ue.layout.get("line-z-offset"),$n=!Nn.isConstant()||!!Nn.constantOr(0),Gn=$n?new Li(Le.depthOcclusion?Ln.GREATER:Ln.LEQUAL,Li.ReadOnly,Le.depthRangeFor3D):Le.depthModeForSublayer(0,Li.ReadOnly),qn=Le.colorModeForDrapableLayerRenderPass(Jt),Zn=Le.terrain&&Le.terrain.renderingToTexture,Xn=Zn?1:Re.q.devicePixelRatio,Yn=Ue.paint.get("line-dasharray"),_i=Yn.constantOr(1),vi=Ue.layout.get("line-cap"),xi=Yn.constantOr(null),bi=vi.constantOr(null),Pi=Ue.paint.get("line-pattern"),lo=Pi.constantOr(1),uo=Pi.constantOr(null),po=Ue.paint.get("line-opacity").constantOr(1);let fo=!lo&&1!==po||Le.depthOcclusion&&Hr>0&&Hr<1;const Io=Ue.paint.get("line-gradient"),is=lo?"linePattern":"line",as=Re.cV(Ue);let Is;if(Zn&&Le.terrain&&Le.terrain.clipOrMaskOverlapStencilType()&&(fo=!1),0!==Hr&&Le.depthOcclusion){const Le=Ue.paint._values["line-opacity"];Le&&Le.value&&"constant"===Le.value.kind?Is=Le.value:Re.w(`Occlusion opacity for layer ${Ue.id} is supported only when line-opacity isn't data-driven.`)}if($n&&(Le.forceTerrainMode=!0),!$n&&0!==Hr&&Le.terrain&&!Zn)return void Re.w(`Occlusion opacity for layer ${Ue.id} is supported on terrain only if the layer has non-zero line-z-offset.`);const Xs=fo&&$n?Le.stencilModeFor3D():Mi.disabled;for(const Ct of qe){const qe=Oe.getTile(Ct);if(lo&&!qe.patternsLoaded())continue;const Ot=qe.getBucket(Ue);if(!Ot)continue;Le.prepareDrawTile();const Jt=Ot.programConfigurations.get(Ue.id),Nn=Le.isTileAffectedByFog(Ct),Yn=Le.getOrCreateProgram(is,{config:Jt,defines:$n?[...as,"ELEVATED"]:as,overrideFog:Nn});if(uo&&qe.imageAtlas){const Re=qe.imageAtlas.patternPositions[uo.toString()];Re&&Jt.setConstantPatternPositions(Re)}if(!lo&&xi&&bi&&qe.lineAtlas){const Re=qe.lineAtlas.getDash(xi,bi);Re&&Jt.setConstantPatternPositions(Re)}let[vi,Pi]=Ue.paint.get("line-trim-offset");if("round"===bi||"square"===bi){const Re=1;vi!==Pi&&(0===vi&&(vi-=Re),1===Pi&&(Pi+=Re))}const ta=Zn?Ct.projMatrix:null,ha=lo?Re.cW(Le,qe,Ue,ta,Xn,[vi,Pi]):Re.cX(Le,qe,Ue,ta,Ot.lineClipsArray.length,Xn,[vi,Pi]);if(Io){const qe=Ot.gradients[Ue.id];let Jt=qe.texture;if(Ue.gradientVersion!==qe.version){let Hr=256;if(Ue.stepInterpolant){const Ue=Oe.getSource().maxzoom,qe=Ct.canonical.z===Ue?Math.ceil(1<<Le.transform.maxZoom-Ct.canonical.z):1;Hr=Re.ap(Re.cY(Ot.maxLineLength/Re.ab*1024*qe),256,Jr.maxTextureSize)}qe.gradient=Re.cZ({expression:Ue.gradientExpression(),evaluationKey:"lineProgress",resolution:Hr,image:qe.gradient||void 0,clips:Ot.lineClipsArray}),qe.texture?qe.texture.update(qe.gradient):qe.texture=new Re.T(Jr,qe.gradient,Ln.RGBA8),qe.version=Ue.gradientVersion,Jt=qe.texture}Jr.activeTexture.set(Ln.TEXTURE1),Jt.bind(Ue.stepInterpolant?Ln.NEAREST:Ln.LINEAR,Ln.CLAMP_TO_EDGE)}_i&&(Jr.activeTexture.set(Ln.TEXTURE0),qe.lineAtlasTexture&&qe.lineAtlasTexture.bind(Ln.LINEAR,Ln.REPEAT),Jt.updatePaintBuffers()),lo&&(Jr.activeTexture.set(Ln.TEXTURE0),qe.imageAtlasTexture&&qe.imageAtlasTexture.bind(Ln.LINEAR,Ln.CLAMP_TO_EDGE),Jt.updatePaintBuffers()),$n&&Le.terrain.setupElevationDraw(qe,Yn),Le.uploadCommonUniforms(Jr,Yn,Ct.toUnwrapped());const z=Re=>{null!=Is&&(Is.value=po*Hr),Yn.draw(Le,Ln.TRIANGLES,Gn,Re,qn,Fi.disabled,ha,Ue.id,Ot.layoutVertexBuffer,Ot.indexBuffer,Ot.segments,Ue.paint,Le.transform.zoom,Jt,[Ot.layoutVertexBuffer2,Ot.patternVertexBuffer,Ot.zOffsetVertexBuffer]),null!=Is&&(Is.value=po)};if(fo&&!$n){const Re=Le.stencilModeForClipping(Ct).ref;0===Re&&Zn&&Jr.clear({stencil:0});const Oe={func:Ln.EQUAL,mask:255};ha.u_alpha_discard_threshold=.8,z(new Mi(Oe,Re,255,Ln.KEEP,Ln.KEEP,Ln.INVERT)),ha.u_alpha_discard_threshold=0,z(new Mi(Oe,Re,255,Ln.KEEP,Ln.KEEP,Ln.KEEP))}else fo&&$n&&(ha.u_alpha_discard_threshold=.001),z($n?Xs:Le.stencilModeForClipping(Ct))}fo&&(Le.resetStencilClippingMasks(),Zn&&Jr.clear({stencil:0})),0===Hr||Le.depthOcclusion||Zn||Le.layersWithOcclusionOpacity.push(Le.currentLayer),$n&&(Le.forceTerrainMode=!1)},fill:function(Le,Oe,Ue,qe){const Ct=Ue.paint.get("fill-color"),Ot=Ue.paint.get("fill-opacity"),Jt=Ue.is3D(),Hr=new Li(Le.context.gl.LEQUAL,Li.ReadWrite,Le.depthRangeFor3D);if(0===Ot.constantOr(1))return;const Jr=Ue.paint.get("fill-emissive-strength"),Ln=Le.colorModeForDrapableLayerRenderPass(Jr),Nn=Ue.paint.get("fill-pattern"),$n=Le.opaquePassEnabledForLayer()&&!Nn.constantOr(1)&&1===Ct.constantOr(Re.bz.transparent).a&&1===Ot.constantOr(0)?"opaque":"translucent";if(Le.renderPass===$n){const Re=Jt?Hr:Le.depthModeForSublayer(1,"opaque"===Le.renderPass?Li.ReadWrite:Li.ReadOnly);Ts(Le,Oe,Ue,qe,Re,Ln,!1)}if(!Jt&&"translucent"===Le.renderPass&&Ue.paint.get("fill-antialias")){const Re=Jt?Hr:Le.depthModeForSublayer(Ue.getPaintProperty("fill-outline-color")?2:0,Li.ReadOnly);Ts(Le,Oe,Ue,qe,Re,Ln,!0)}},"fill-extrusion":function(Le,Oe,Ue,qe){const Ct=Ue.paint.get("fill-extrusion-opacity"),Ot=Le.context,Jt=Ot.gl,Hr=Le.terrain,Jr=Hr&&Hr.renderingToTexture;if(0===Ct)return;const Ln=Le.conflationActive&&Le.style.isLayerClipped(Ue,Oe.getSource()),Nn=Le.style.order.indexOf(Ue.fqid);if(Ln&&function(Re,Le,Oe,Ue,qe){for(const Ct of Ue){const Ue=Le.getTile(Ct).getBucket(Oe);Ue&&(Ue.updateReplacement(Ct,Re.replacementSource,qe),Ue.uploadCentroid(Re.context))}}(Le,Oe,Ue,qe,Nn),Hr||Ln)for(const Re of qe){const qe=Oe.getTile(Re).getBucket(Ue);qe&&Ss(Le.context,Oe,Re,qe,Ue,Hr,Ln)}if("shadow"===Le.renderPass&&Le.shadowRenderer){const Ot=Le.shadowRenderer;if(Hr&&Ct<.65&&Ue._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof Re.a4)return;const Jt=Ot.getShadowPassDepthMode(),Jr=Ot.getShadowPassColorMode();Es(Le,Oe,Ue,qe,Jt,Mi.disabled,Jr,Ln)}else if("translucent"===Le.renderPass){const Nn=!Ue.paint.get("fill-extrusion-pattern").constantOr(1),$n=Ue.paint.get("fill-extrusion-color").constantOr(Re.bz.white);if(!Jr&&0!==$n.a){const Re=new Li(Le.context.gl.LEQUAL,Li.ReadWrite,Le.depthRangeFor3D);1===Ct&&Nn?Es(Le,Oe,Ue,qe,Re,Mi.disabled,Ai.unblended,Ln):(Es(Le,Oe,Ue,qe,Re,Mi.disabled,Ai.disabled,Ln),Es(Le,Oe,Ue,qe,Re,Le.stencilModeFor3D(),Le.colorModeForRenderPass(),Ln),Le.resetStencilClippingMasks())}if(Le.style.enable3dLights()&&Nn&&(!Hr&&"globe"!==Le.transform.projection.name||Jr)){const Ct=Ue.paint.get("fill-extrusion-opacity"),Nn=Ue.paint.get("fill-extrusion-ambient-occlusion-intensity"),$n=Ue.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),Gn=Ue.paint.get("fill-extrusion-flood-light-intensity"),qn=Ue.paint.get("fill-extrusion-flood-light-color").toRenderColor(Ue.lut).toArray01().slice(0,3),Zn=Nn>0&&$n>0,Xn=Gn>0,g=(Re,Le,Oe)=>(1-Oe)*Re+Oe*Le,v=Ot=>{const Hr=Le.depthModeForSublayer(1,Li.ReadOnly,Jt.LEQUAL,!0),Jr=Ue.paint.get(Ot?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),Zn=g(.1,3,Jr),Xn=Le._showOverdrawInspector;if(!Xn){const Jr=new Mi({func:Jt.ALWAYS,mask:255},255,255,Jt.KEEP,Jt.KEEP,Jt.REPLACE),Xn=new Ai([Jt.ONE,Jt.ONE,Jt.ONE,Jt.ONE],Re.bz.transparent,[!1,!1,!1,!0],Jt.MIN);Cs(Le,Oe,Ue,qe,Hr,Jr,Xn,Fi.disabled,Ot,"sdf",Ct,Nn,$n,Gn,qn,Zn,Ln,!1)}{const Jr=Xn?Mi.disabled:new Mi({func:Jt.EQUAL,mask:255},255,255,Jt.KEEP,Jt.DECR,Jt.DECR),Yn=Xn?Le.colorModeForRenderPass():new Ai([Jt.ONE_MINUS_DST_ALPHA,Jt.DST_ALPHA,Jt.ONE,Jt.ONE],Re.bz.transparent,[!0,!0,!0,!0]);Cs(Le,Oe,Ue,qe,Hr,Jr,Yn,Fi.disabled,Ot,"color",Ct,Nn,$n,Gn,qn,Zn,Ln,!1)}};if(Jr){const c=(Ot,Hr,Jr)=>{const Zn=Le.depthModeForSublayer(1,Li.ReadOnly,Jt.LEQUAL,!1),Xn=Ue.paint.get(Ot?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),Yn=g(.1,3,Xn);{const Jr=new Ai([Jt.ONE,Jt.ONE,Jt.ONE,Jt.ONE],Re.bz.transparent,[!1,!1,!1,!0]);Cs(Le,Oe,Ue,qe,Zn,Mi.disabled,Jr,Fi.disabled,Ot,"clear",Ct,Nn,$n,Gn,qn,Yn,Ln,Hr)}{const Jr=new Mi({func:Jt.ALWAYS,mask:255},255,255,Jt.KEEP,Jt.KEEP,Jt.REPLACE),Xn=new Ai([Jt.ONE,Jt.ONE,Jt.ONE,Jt.ONE],Re.bz.transparent,[!1,!1,!1,!0],Jt.MIN);Cs(Le,Oe,Ue,qe,Zn,Jr,Xn,Fi.disabled,Ot,"sdf",Ct,Nn,$n,Gn,qn,Yn,Ln,Hr)}{const Jr=Ot?Jt.ZERO:Jt.ONE_MINUS_DST_ALPHA,Xn=new Mi({func:Jt.EQUAL,mask:255},255,255,Jt.KEEP,Jt.DECR,Jt.DECR),_i=new Ai([Jr,Jt.DST_ALPHA,Jt.ONE_MINUS_DST_ALPHA,Jt.ZERO],Re.bz.transparent,[!0,!0,!0,!0]);Cs(Le,Oe,Ue,qe,Zn,Xn,_i,Fi.disabled,Ot,"color",Ct,Nn,$n,Gn,qn,Yn,Ln,Hr)}{const Xn=new Ai([Jt.ONE,Jt.ONE,Jt.ONE,Ot?Jt.ZERO:Jt.ONE],Re.bz.transparent,[!1,!1,!1,!0],Ot?Jt.FUNC_ADD:Jt.MAX);Cs(Le,Oe,Ue,qe,Zn,Mi.disabled,Xn,Fi.disabled,Ot,"clear",Ct,Nn,$n,Gn,qn,Yn,Ln,Hr,Jr)}};if(Zn||Xn){let Oe;if(Le.prepareDrawTile(),Hr){const Le=Hr.drapeBufferSize[0],Ue=Hr.drapeBufferSize[1];Oe=Hr.framebufferCopyTexture,Oe&&(!Oe||Oe.size[0]===Le&&Oe.size[1]===Ue)||(Oe&&Oe.destroy(),Oe=Hr.framebufferCopyTexture=new Re.T(Ot,new Re.r({width:Le,height:Ue}),Jt.RGBA8)),Oe.bind(Jt.LINEAR,Jt.CLAMP_TO_EDGE),Jt.copyTexImage2D(Jt.TEXTURE_2D,0,Jt.RGBA,0,0,Le,Ue,0)}Zn&&c(!0,!1,Oe),Xn&&c(!1,!0,Oe)}}else Zn&&v(!0),Xn&&v(!1),(Zn||Xn)&&Le.resetStencilClippingMasks()}}},hillshade:function(Re,Le,Oe,Ue){if("offscreen"!==Re.renderPass&&"translucent"!==Re.renderPass)return;if(Re.style.disableElevatedTerrain)return;const qe=Re.context,Ct=Re.terrain&&Re.terrain.renderingToTexture,[Ot,Jt]="translucent"!==Re.renderPass||Ct?[{},Ue]:Re.stencilConfigForOverlap(Ue);for(const Ue of Jt){const qe=Le.getTile(Ue);if(qe.needsHillshadePrepare&&"offscreen"===Re.renderPass)zo(Re,qe,Oe);else if("translucent"===Re.renderPass){const Le=Re.depthModeForSublayer(0,Li.ReadOnly),Jt=Oe.paint.get("hillshade-emissive-strength"),Hr=Re.colorModeForDrapableLayerRenderPass(Jt),Jr=Ct&&Re.terrain?Re.terrain.stencilModeForRTTOverlap(Ue):Ot[Ue.overscaledZ];Po(Re,Ue,qe,Oe,Le,Jr,Hr)}}qe.viewport.set([0,0,Re.width,Re.height]),Re.resetStencilClippingMasks()},raster:function(Le,Oe,Ue,qe,Ct,Ot){if("translucent"!==Le.renderPass)return;if(0===Ue.paint.get("raster-opacity"))return;const Jt="globe"===Le.transform.projection.name,Hr=0!==Ue.paint.get("raster-elevation"),Jr=Hr&&Jt;if(Le.renderElevatedRasterBackface&&!Jr)return;const Ln=Le.context,Nn=Ln.gl,$n=Oe.getSource(),Gn=function(Le,Oe,Ue,qe){const Ct=Oe.paint.get("raster-color"),Ot="raster-array"===Le.type,Jt=[],Hr=Oe.paint.get("raster-resampling"),Jr=Oe.paint.get("raster-color-mix");let Ln=Oe.paint.get("raster-color-range");const Nn=[Jr[0],Jr[1],Jr[2],0],$n=Jr[3];let Gn="nearest"===Hr?qe.NEAREST:qe.LINEAR;if(Ot&&(Jt.push("RASTER_ARRAY"),Ct||Jt.push("RASTER_COLOR"),"linear"===Hr&&Jt.push("RASTER_ARRAY_LINEAR"),Gn=qe.NEAREST,!Ln&&Le.rasterLayers)){const Re=Le.rasterLayers.find((({id:Re})=>Re===Oe.sourceLayer));Re&&Re.fields&&Re.fields.range&&(Ln=Re.fields.range)}if(Ln=Ln||[0,1],Ct){Jt.push("RASTER_COLOR"),Ue.activeTexture.set(qe.TEXTURE2),Oe.updateColorRamp(Ln);let Le=Oe.colorRampTexture;Le||(Le=Oe.colorRampTexture=new Re.T(Ue,Oe.colorRamp,qe.RGBA8)),Le.bind(qe.LINEAR,qe.CLAMP_TO_EDGE)}return{mix:Nn,range:Ln,offset:$n,defines:Jt,resampling:Gn}}($n,Ue,Ln,Nn);if($n instanceof Re.aD&&!qe.length&&!Jt)return;const qn=Ue.paint.get("raster-emissive-strength"),Zn=Le.colorModeForDrapableLayerRenderPass(qn),Xn=Le.terrain&&Le.terrain.renderingToTexture,Yn=!Le.options.moving,_i="nearest"===Ue.paint.get("raster-resampling")?Nn.NEAREST:Nn.LINEAR;if($n instanceof Re.aD&&!qe.length&&($n.onNorthPole||$n.onSouthPole)){const Re=Hr?Le.stencilModeFor3D():Mi.disabled;return void Ps(!!$n.onNorthPole,null,Le,Oe,Ue,qn,Gn,Fi.disabled,Re)}if(!qe.length)return;const[vi,xi]=$n instanceof Re.aD||Xn?[{},qe]:Le.stencilConfigForOverlap(qe),bi=xi[xi.length-1].overscaledZ;Jr&&Gn.defines.push("PROJECTION_GLOBE_VIEW"),Hr&&Gn.defines.push("RENDER_CUTOFF");const w=(qe,Ct,xi)=>{for(const Pi of qe){const qe=Pi.toUnwrapped(),lo=Oe.getTile(Pi);if(Xn&&(!lo||!lo.hasData()))continue;Ln.activeTexture.set(Nn.TEXTURE0);const uo=zs(lo,$n,Ue,Gn);if(!uo||!uo.texture)continue;const{texture:po,mix:fo,offset:Io,tileSize:is,buffer:as}=uo;let Is,Xs;Xn?(Is=Li.disabled,Xs=Pi.projMatrix):Hr?(Is=new Li(Nn.LEQUAL,Li.ReadWrite,Le.depthRangeFor3D),Xs=Jt?Float32Array.from(Le.transform.expandedFarZProjMatrix):Le.transform.calculateProjMatrix(qe,Yn)):(Is=Le.depthModeForSublayer(Pi.overscaledZ-bi,1===Ue.paint.get("raster-opacity")?Li.ReadWrite:Li.ReadOnly,Nn.LESS),Xs=Le.transform.calculateProjMatrix(qe,Yn));const ta=Le.terrain&&Xn?Le.terrain.stencilModeForRTTOverlap(Pi):vi[Pi.overscaledZ],ha=Ot?0:Ue.paint.get("raster-fade-duration");lo.registerFadeDuration(ha);const el=Oe.findLoadedParent(Pi,0),tl=Sr(lo,el,Oe,Le.transform,ha);let il,sl;Le.terrain&&Le.terrain.prepareDrawTile(),Ln.activeTexture.set(Nn.TEXTURE0),po.bind(_i,Nn.CLAMP_TO_EDGE),Ln.activeTexture.set(Nn.TEXTURE1),el?(el.texture&&el.texture.bind(_i,Nn.CLAMP_TO_EDGE),il=Math.pow(2,el.tileID.overscaledZ-lo.tileID.overscaledZ),sl=[lo.tileID.canonical.x*il%1,lo.tileID.canonical.y*il%1]):po.bind(_i,Nn.CLAMP_TO_EDGE),po.useMipmap&&Ln.extTextureFilterAnisotropic&&Le.transform.pitch>20&&Nn.texParameterf(Nn.TEXTURE_2D,Ln.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Ln.extTextureFilterAnisotropicMax);const fl=Le.transform;let Al;const Ml=Hr?Ms(fl):[0,0,0,0];let Hl,Wl,Kl,Jl,Ql,oc=0;if(Jr&&$n instanceof Re.aD&&$n.coordinates.length>3)Hl=Float32Array.from(Re.b5(Re.cC(new Re.bP(0,0,0)))),Wl=Float32Array.from(fl.globeMatrix),Kl=Float32Array.from(Re.cy(fl)),Jl=[Re.am(fl.center.lng),Re.at(fl.center.lat)],Al=$n.elevatedGlobePerspectiveTransform,Ql=$n.elevatedGlobeGridMatrix||new Float32Array(9);else if(Jr){const Le=Re.cz(Pi.canonical);oc=Re.cA(Le.getCenter().lat),Hl=Float32Array.from(Re.b5(Re.cC(Pi.canonical))),Wl=Float32Array.from(fl.globeMatrix),Kl=Float32Array.from(Re.cy(fl)),Jl=[Re.am(fl.center.lng),Re.at(fl.center.lat)],Al=[0,0],Ql=Float32Array.from(Re.cB(Pi.canonical,Le,oc,fl.worldSize/fl._pixelsPerMercatorPixel))}else Al=$n instanceof Re.aD?$n.perspectiveTransform:[0,0],Hl=new Float32Array(16),Wl=new Float32Array(9),Kl=new Float32Array(16),Jl=[0,0],Ql=new Float32Array(9);const lc=Yr(Xs,Hl,Wl,Kl,Ql,sl||[0,0],Re.a9(Le.transform.zoom),Jl,Ml,il||1,tl,Ue,Al,Hr?Ue.paint.get("raster-elevation"):0,2,fo,Io,Gn.range,is,as,qn),Oc=Le.isTileAffectedByFog(Pi),Nc=Le.getOrCreateProgram("raster",{defines:Gn.defines,overrideFog:Oc});if(Le.uploadCommonUniforms(Ln,Nc,qe),$n instanceof Re.aD){const Oe=$n.elevatedGlobeVertexBuffer,qe=$n.elevatedGlobeIndexBuffer;if(Xn||!Jt)$n.boundsBuffer&&$n.boundsSegments&&Nc.draw(Le,Nn.TRIANGLES,Is,Mi.disabled,Zn,Fi.disabled,lc,Ue.id,$n.boundsBuffer,Le.quadTriangleIndexBuffer,$n.boundsSegments);else if(Oe&&qe){const Ot=fl.zoom<=Re.c2?$n.elevatedGlobeSegments:$n.getSegmentsForLongitude(fl.center.lng);Ot&&Nc.draw(Le,Nn.TRIANGLES,Is,Mi.disabled,Zn,Ct,lc,Ue.id,Oe,qe,Ot)}}else if(Jr){Is=new Li(Nn.LEQUAL,Li.ReadOnly,Le.depthRangeFor3D);const Re=Le.globeSharedBuffers;if(Re){const[Oe,qe,Ot]=Re.getGridBuffers(oc,!1);Nc.draw(Le,Nn.TRIANGLES,Is,xi||ta,Le.colorModeForRenderPass(),Ct,lc,Ue.id,Oe,qe,Ot)}}else{const{tileBoundsBuffer:Re,tileBoundsIndexBuffer:Oe,tileBoundsSegments:qe}=Le.getTileBoundsBuffers(lo);Nc.draw(Le,Nn.TRIANGLES,Is,ta,Zn,Fi.disabled,lc,Ue.id,Re,Oe,qe)}}if(!($n instanceof Re.aD)&&Jr)for(const Re of qe){const qe=Re.canonical.y===(1<<Re.canonical.z)-1;0===Re.canonical.y&&Ps(!0,Re,Le,Oe,Ue,qn,Gn,Ct,xi||Mi.disabled),qe&&Ps(!1,Re,Le,Oe,Ue,qn,Gn,Ct===Fi.frontCW?Fi.backCW:Fi.frontCW,xi||Mi.disabled)}};Jr?w(xi,Le.renderElevatedRasterBackface?Fi.backCW:Fi.frontCW,Le.stencilModeFor3D()):w(xi,Fi.disabled,void 0),Le.resetStencilClippingMasks()},"raster-particle":function(Le,Oe,Ue,qe,Ct,Ot){"offscreen"===Le.renderPass&&function(Le,Oe,Ue,qe){if(!qe.length)return;const Ct=Le.context,Ot=Ct.gl,Jt=Oe.getSource();if(!(Jt instanceof Qe))return;const Hr=Math.ceil(Math.sqrt(Ue.paint.get("raster-particle-count")));let Jr=Ue.particlePositionRGBAImage;if(!Jr||Jr.width!==Hr){const Le=function(Re){const Le=Re*Re,Oe=new Uint8Array(4*Le),o=function(Re){return Re|=0,Re=Math.imul(2747636419^Re,2654435769),Re=Math.imul(Re^Re>>>16,2654435769),((Re=Math.imul(Re^Re>>>16,2654435769))>>>0)/4294967296},Ue=1/1.1;for(let Re=0;Re<Le;Re++){const Le=Ue*(o(2*Re+0)+Bh),qe=Ue*(o(2*Re+1)+Bh),Ct=255*Le%1,Ot=255*qe%1,Jt=Ct,Hr=qe-Ot/255,Jr=Ot;Oe[4*Re+0]=255*(Le-Ct/255),Oe[4*Re+1]=255*Jt,Oe[4*Re+2]=255*Hr,Oe[4*Re+3]=255*Jr}return Oe}(Hr);Jr=Ue.particlePositionRGBAImage=new Re.r({width:Hr,height:Hr},Le)}let Ln=Ue.particleFramebuffer;Ln?Ln.width!==Hr&&(Ln.destroy(),Ln=Ue.particleFramebuffer=Ct.createFramebuffer(Hr,Hr,!0,null)):Ln=Ue.particleFramebuffer=Ct.createFramebuffer(Hr,Hr,!0,null);const Nn=[];for(const Re of qe){const Le=Oe.getTile(Re);if(!(Le instanceof mt))continue;const qe=ks(Le,Jt,Ue);if(!qe)continue;const Ot=[Le.tileSize,Le.tileSize];let Ln=Ue.tileFramebuffer;Ln||(Ln=Ue.tileFramebuffer=Ct.createFramebuffer(Ot[0],Ot[1],!0,null));let $n=Le.rasterParticleState;$n||($n=Le.rasterParticleState=new Fs(Ct,Re,Ot,Jr));const Gn=$n.update(Ue.lastInvalidatedAt);$n.particleTextureDimension!==Hr&&$n.updateParticleTexture(Re,Jr);const qn=$n.targetColorTexture;$n.targetColorTexture=$n.backgroundColorTexture,$n.backgroundColorTexture=qn;const Zn=$n.particleTexture0;$n.particleTexture0=$n.particleTexture1,$n.particleTexture1=Zn,Nn.push([Re,qe,$n,Gn])}if(0===Nn.length)return;const $n=Re.q.now(),Gn=Ue.previousDrawTimestamp?.001*($n-Ue.previousDrawTimestamp):.0167;if(Ue.previousDrawTimestamp=$n,Ue.hasColorMap()){Ct.activeTexture.set(Ot.TEXTURE0+2);let Le=Ue.colorRampTexture;Le||(Le=Ue.colorRampTexture=new Re.T(Ct,Ue.colorRamp,Ot.RGBA8)),Le.bind(Ot.LINEAR,Ot.CLAMP_TO_EDGE)}Ct.bindFramebuffer.set(Ue.tileFramebuffer.framebuffer),function(Le,Oe,Ue){const qe=Le.context,Ct=qe.gl,Ot=Oe.tileFramebuffer;qe.activeTexture.set(Ct.TEXTURE0);const Jt={u_texture:0,u_opacity:1.05*(Jr=Oe.paint.get("raster-particle-fade-opacity-factor"))/(Jr+.05)},Hr=Le.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var Jr;for(const Jr of Ue){const[,,Ue,Ln]=Jr;Ot.colorAttachment.set(Ue.targetColorTexture.texture),qe.viewport.set([0,0,Ot.width,Ot.height]),qe.clear({color:Re.bz.transparent}),Ln&&(Ue.backgroundColorTexture.bind(Ct.NEAREST,Ct.CLAMP_TO_EDGE),Hr.draw(Le,Ct.TRIANGLES,Li.disabled,Mi.disabled,Ai.alphaBlended,Fi.disabled,Jt,Oe.id,Le.viewportBuffer,Le.quadTriangleIndexBuffer,Le.viewportSegments))}}(Le,Ue,Nn),function(Le,Oe,Ue,qe){const Ct=Le.context,Ot=Ct.gl,Jt=Ue.tileFramebuffer,Hr="globe"===Le.transform.projection.name,Jr=Ue.paint.get("raster-particle-max-speed");for(const Ln of qe){const[qe,Nn,$n]=Ln;Ct.activeTexture.set(Ot.TEXTURE0+0),Nn.texture.bind(Ot.LINEAR,Ot.CLAMP_TO_EDGE),Jt.colorAttachment.set($n.targetColorTexture.texture);const Gn=Le.getOrCreateProgram("rasterParticleDraw",{defines:Nn.defines,overrideFog:!1});Ct.activeTexture.set(Ot.TEXTURE0+1);const qn=Nn.scalarData?[]:[0,1,2,3].map((Le=>Re.c$[Le](qe)));qn.push(qe);const Zn=qe.canonical.x,Xn=qe.canonical.y;for(const Re of qn){const Ct=Oe.getTile(Hr?Re.wrapped():Re);if(!Ct)continue;const Jt=Ct.rasterParticleState;if(!Jt)continue;const Ln=Re.canonical.x+(1<<Re.canonical.z)*(Re.wrap-qe.wrap),$n=Re.canonical.y;Jt.particleTexture0.bind(Ot.NEAREST,Ot.CLAMP_TO_EDGE);const qn=es(1,Jt.particleTexture0.size[0],[Ln-Zn,$n-Xn],0,Nn.texture.size,2,Jr,Nn.textureOffset,Nn.scale,Nn.offset);Gn.draw(Le,Ot.POINTS,Li.disabled,Mi.disabled,Ai.alphaBlended,Fi.disabled,qn,Ue.id,Jt.particleIndexBuffer,void 0,Jt.particleSegment)}}}(Le,Oe,Ue,Nn),Ct.bindFramebuffer.set(Ue.particleFramebuffer.framebuffer),function(Le,Oe,Ue,qe){const Ct=Le.context,Ot=Ct.gl,Jt=Oe.paint.get("raster-particle-max-speed"),Hr=qe*Oe.paint.get("raster-particle-speed-factor")*.15,Jr=function(Re){return Math.pow(Re,6)}(.01+1*Oe.paint.get("raster-particle-reset-rate-factor")),Ln=Oe.particleFramebuffer;Ct.viewport.set([0,0,Ln.width,Ln.height]);for(const qe of Ue){const[,Ue,Nn]=qe;Ct.activeTexture.set(Ot.TEXTURE0+0),Ue.texture.bind(Ot.LINEAR,Ot.CLAMP_TO_EDGE),Ct.activeTexture.set(Ot.TEXTURE0+1);const $n=Nn.particleTexture0;$n.bind(Ot.NEAREST,Ot.CLAMP_TO_EDGE);const Gn=ts(1,$n.size[0],0,Ue.texture.size,Jt,Hr,Jr,Ue.textureOffset,Ue.scale,Ue.offset);Ln.colorAttachment.set(Nn.particleTexture1.texture),Ct.clear({color:Re.bz.transparent}),Le.getOrCreateProgram("rasterParticleUpdate",{defines:Ue.defines}).draw(Le,Ot.TRIANGLES,Li.disabled,Mi.disabled,Ai.unblended,Fi.disabled,Gn,Oe.id,Le.viewportBuffer,Le.quadTriangleIndexBuffer,Le.viewportSegments)}}(Le,Ue,Nn,Gn)}(Le,Oe,Ue,qe),"translucent"===Le.renderPass&&(function(Le,Oe,Ue,qe){const Ct=Le.context,Ot=Ct.gl,Jt=Oe.getSource().tileSize,Hr=5*(1-Re.a7(Re.bU,Re.bU+1,Le.transform.zoom))*Jt+Ue.paint.get("raster-particle-elevation"),Jr=!Le.options.moving,Ln="globe"===Le.transform.projection.name;if(!qe.length)return;const[Nn,$n]=Le.stencilConfigForOverlap(qe),Gn=[];Ln&&Gn.push("PROJECTION_GLOBE_VIEW");const qn=Le.stencilModeFor3D();for(const qe of $n){const Jt=qe.toUnwrapped(),$n=Oe.getTile(qe);if(!$n.rasterParticleState)continue;const Zn=$n.rasterParticleState,Xn=100;$n.registerFadeDuration(Xn);const Yn=Oe.findLoadedParent(qe,0),_i=Sr($n,Yn,Oe,Le.transform,Xn);let vi,xi;Le.terrain&&Le.terrain.prepareDrawTile(),Ct.activeTexture.set(Ot.TEXTURE0),Zn.targetColorTexture.bind(Ot.LINEAR,Ot.CLAMP_TO_EDGE),Ct.activeTexture.set(Ot.TEXTURE1),Yn&&Yn.rasterParticleState?(Yn.rasterParticleState.targetColorTexture.bind(Ot.LINEAR,Ot.CLAMP_TO_EDGE),vi=Math.pow(2,Yn.tileID.overscaledZ-$n.tileID.overscaledZ),xi=[$n.tileID.canonical.x*vi%1,$n.tileID.canonical.y*vi%1]):Zn.targetColorTexture.bind(Ot.LINEAR,Ot.CLAMP_TO_EDGE);const bi=Ln?Float32Array.from(Le.transform.expandedFarZProjMatrix):Le.transform.calculateProjMatrix(Jt,Jr),Pi=Le.transform,lo=Bs(Pi),uo=Re.cz(qe.canonical),po=Re.cA(uo.getCenter().lat);let fo,Io,is,as,Is;Ln?(fo=Float32Array.from(Re.b5(Re.cC(qe.canonical))),Io=Float32Array.from(Pi.globeMatrix),is=Float32Array.from(Re.cy(Pi)),as=[Re.am(Pi.center.lng),Re.at(Pi.center.lat)],Is=Float32Array.from(Re.cB(qe.canonical,uo,po,Pi.worldSize/Pi._pixelsPerMercatorPixel))):(fo=new Float32Array(16),Io=new Float32Array(9),is=new Float32Array(16),as=[0,0],Is=new Float32Array(9));const Xs=Qr(bi,fo,Io,is,Is,xi||[0,0],Re.a9(Le.transform.zoom),as,lo,vi||1,_i,Hr),ta=Le.isTileAffectedByFog(qe),ha=Le.getOrCreateProgram("rasterParticle",{defines:Gn,overrideFog:ta});if(Le.uploadCommonUniforms(Ct,ha,Jt),Ln){const Re=new Li(Ot.LEQUAL,Li.ReadOnly,Le.depthRangeFor3D),Oe=0,qe=Le.globeSharedBuffers;if(qe){const[Ct,Jt,Hr]=qe.getGridBuffers(po,0!==Oe);ha.draw(Le,Ot.TRIANGLES,Re,qn,Ai.alphaBlended,Le.renderElevatedRasterBackface?Fi.frontCCW:Fi.backCCW,Xs,Ue.id,Ct,Jt,Hr)}}else{const Re=Le.depthModeForSublayer(0,Li.ReadOnly),Oe=Nn[qe.overscaledZ],{tileBoundsBuffer:Ct,tileBoundsIndexBuffer:Jt,tileBoundsSegments:Hr}=Le.getTileBoundsBuffers($n);ha.draw(Le,Ot.TRIANGLES,Re,Oe,Ai.alphaBlended,Fi.disabled,Xs,Ue.id,Ct,Jt,Hr)}}Le.resetStencilClippingMasks()}(Le,Oe,Ue,qe),Le.style.map.triggerRepaint())},background:function(Le,Oe,Ue,qe){const Ct=Ue.paint.get("background-color"),Ot=Ue.paint.get("background-opacity"),Jt=Ue.paint.get("background-emissive-strength"),Hr="viewport"===Ue.paint.get("background-pitch-alignment");if(0===Ot)return;const Jr=Le.context,Ln=Jr.gl,Nn=Le.transform,$n=Nn.tileSize,Gn=Ue.paint.get("background-pattern");let qn;if(void 0!==Gn){if(null===Gn)return;if(qn=Le.imageManager.getPattern(Gn.toString(),Ue.scope,Le.style.getLut(Ue.scope)),!qn)return}const Zn=!Gn&&1===Ct.a&&1===Ot&&Le.opaquePassEnabledForLayer()?"opaque":"translucent";if(Le.renderPass!==Zn)return;const Xn=Mi.disabled,Yn=Le.depthModeForSublayer(0,"opaque"===Zn?Li.ReadWrite:Li.ReadOnly),_i=Le.colorModeForDrapableLayerRenderPass(Jt),vi=Gn?"backgroundPattern":"background";let xi,bi=qe;if(bi||(xi=Le.getBackgroundTiles(),bi=Object.values(xi).map((Re=>Re.tileID))),Gn&&(Jr.activeTexture.set(Ln.TEXTURE0),Le.imageManager.bind(Le.context,Ue.scope)),Hr){const Oe=Le.getOrCreateProgram(vi,{overrideFog:!1,overrideRtt:!0}),qe=new Float32Array(Re.a6.mat4.identity([])),Jr=new Re.aA(0,0,0,0,0),Nn=Gn?ss(qe,Jt,Ot,Le,0,Ue.scope,qn,Hr,{tileID:Jr,tileSize:$n}):rs(qe,Jt,Ot,Ct.toRenderColor(Ue.lut));Oe.draw(Le,Ln.TRIANGLES,Yn,Xn,_i,Fi.disabled,Nn,Ue.id,Le.viewportBuffer,Le.quadTriangleIndexBuffer,Le.viewportSegments)}else for(const Re of bi){const Zn=Le.isTileAffectedByFog(Re),bi=Le.getOrCreateProgram(vi,{overrideFog:Zn}),Pi=Re.toUnwrapped(),lo=qe?Re.projMatrix:Le.transform.calculateProjMatrix(Pi);Le.prepareDrawTile();const uo=Oe?Oe.getTile(Re):xi?xi[Re.key]:new pt(Re,$n,Nn.zoom,Le),po=Gn?ss(lo,Jt,Ot,Le,0,Ue.scope,qn,Hr,{tileID:Re,tileSize:$n}):rs(lo,Jt,Ot,Ct.toRenderColor(Ue.lut));Le.uploadCommonUniforms(Jr,bi,Pi);const{tileBoundsBuffer:fo,tileBoundsIndexBuffer:Io,tileBoundsSegments:is}=Le.getTileBoundsBuffers(uo);bi.draw(Le,Ln.TRIANGLES,Yn,Xn,_i,Fi.disabled,po,Ue.id,fo,Io,is)}},sky:function(Le,Oe,Ue){const qe=Le._atmosphere?Re.a9(Le.transform.zoom):1,Ct=Ue.paint.get("sky-opacity")*qe;if(0===Ct)return;const Ot=Le.context,Jt=Ue.paint.get("sky-type"),Hr=new Li(Ot.gl.LEQUAL,Li.ReadOnly,[0,1]),Jr=Le.frameCounter/1e3%1;"atmosphere"===Jt?"offscreen"===Le.renderPass?Ue.needsSkyboxCapture(Le)&&(function(Le,Oe){const Ue=Le.context,qe=Ue.gl;let Ct=Oe.skyboxFbo;if(!Ct){Ct=Oe.skyboxFbo=Ue.createFramebuffer(32,32,!0,null),Oe.skyboxGeometry=new Ks(Ue),Oe.skyboxTexture=Ue.gl.createTexture(),qe.bindTexture(qe.TEXTURE_CUBE_MAP,Oe.skyboxTexture),qe.texParameteri(qe.TEXTURE_CUBE_MAP,qe.TEXTURE_WRAP_S,qe.CLAMP_TO_EDGE),qe.texParameteri(qe.TEXTURE_CUBE_MAP,qe.TEXTURE_WRAP_T,qe.CLAMP_TO_EDGE),qe.texParameteri(qe.TEXTURE_CUBE_MAP,qe.TEXTURE_MIN_FILTER,qe.LINEAR),qe.texParameteri(qe.TEXTURE_CUBE_MAP,qe.TEXTURE_MAG_FILTER,qe.LINEAR);for(let Re=0;Re<6;++Re)qe.texImage2D(qe.TEXTURE_CUBE_MAP_POSITIVE_X+Re,0,qe.RGBA,32,32,0,qe.RGBA,qe.UNSIGNED_BYTE,null)}Ue.bindFramebuffer.set(Ct.framebuffer),Ue.viewport.set([0,0,32,32]);const Ot=Oe.getCenter(Le,!0),Jt=Le.getOrCreateProgram("skyboxCapture"),Hr=new Float64Array(16);Re.a6.mat4.identity(Hr),Re.a6.mat4.rotateY(Hr,Hr,.5*-Math.PI),Js(Le,Oe,Jt,Hr,Ot,0),Re.a6.mat4.identity(Hr),Re.a6.mat4.rotateY(Hr,Hr,.5*Math.PI),Js(Le,Oe,Jt,Hr,Ot,1),Re.a6.mat4.identity(Hr),Re.a6.mat4.rotateX(Hr,Hr,.5*-Math.PI),Js(Le,Oe,Jt,Hr,Ot,2),Re.a6.mat4.identity(Hr),Re.a6.mat4.rotateX(Hr,Hr,.5*Math.PI),Js(Le,Oe,Jt,Hr,Ot,3),Re.a6.mat4.identity(Hr),Js(Le,Oe,Jt,Hr,Ot,4),Re.a6.mat4.identity(Hr),Re.a6.mat4.rotateY(Hr,Hr,Math.PI),Js(Le,Oe,Jt,Hr,Ot,5),Ue.viewport.set([0,0,Le.width,Le.height])}(Le,Ue),Ue.markSkyboxValid(Le)):"sky"===Le.renderPass&&function(Re,Le,Oe,Ue,qe){const Ct=Re.context,Ot=Ct.gl,Jt=Re.transform,Hr=Re.getOrCreateProgram("skybox");Ct.activeTexture.set(Ot.TEXTURE0),Ot.bindTexture(Ot.TEXTURE_CUBE_MAP,Le.skyboxTexture);const Jr=((Re,Le,Oe,Ue,qe)=>({u_matrix:Re,u_sun_direction:Le,u_cubemap:0,u_opacity:Ue,u_temporal_offset:qe}))(Jt.skyboxMatrix,Le.getCenter(Re,!1),0,Ue,qe);Re.uploadCommonUniforms(Ct,Hr),Hr.draw(Re,Ot.TRIANGLES,Oe,Mi.disabled,Re.colorModeForRenderPass(),Fi.backCW,Jr,"skybox",Le.skyboxGeometry.vertexBuffer,Le.skyboxGeometry.indexBuffer,Le.skyboxGeometry.segment)}(Le,Ue,Hr,Ct,Jr):"gradient"===Jt&&"sky"===Le.renderPass&&function(Le,Oe,Ue,qe,Ct){const Ot=Le.context,Jt=Ot.gl,Hr=Le.transform,Jr=Le.getOrCreateProgram("skyboxGradient");Oe.skyboxGeometry||(Oe.skyboxGeometry=new Ks(Ot)),Ot.activeTexture.set(Jt.TEXTURE0);let Ln=Oe.colorRampTexture;Ln||(Ln=Oe.colorRampTexture=new Re.T(Ot,Oe.colorRamp,Jt.RGBA8)),Ln.bind(Jt.LINEAR,Jt.CLAMP_TO_EDGE);const Nn=((Le,Oe,Ue,qe,Ct)=>({u_matrix:Le,u_color_ramp:0,u_center_direction:Oe,u_radius:Re.bB(Ue),u_opacity:qe,u_temporal_offset:Ct}))(Hr.skyboxMatrix,Oe.getCenter(Le,!1),Oe.paint.get("sky-gradient-radius"),qe,Ct);Le.uploadCommonUniforms(Ot,Jr),Jr.draw(Le,Jt.TRIANGLES,Ue,Mi.disabled,Le.colorModeForRenderPass(),Fi.backCW,Nn,"skyboxGradient",Oe.skyboxGeometry.vertexBuffer,Oe.skyboxGeometry.indexBuffer,Oe.skyboxGeometry.segment)}(Le,Ue,Hr,Ct,Jr)},debug:function(Le,Oe,Ue,qe,Ct,Ot){for(let Jt=0;Jt<Ue.length;Jt++)if(Ct){const Ct=1,Hr=.8,Jr=new Re.bz(qe.r*Hr,qe.g*Hr,qe.b*Hr,1);qs(Le,Oe,Ue[Jt],qe,-Ct,-Ct,Ot),qs(Le,Oe,Ue[Jt],qe,-Ct,Ct,Ot),qs(Le,Oe,Ue[Jt],qe,Ct,Ct,Ot),qs(Le,Oe,Ue[Jt],qe,Ct,-Ct,Ot),qs(Le,Oe,Ue[Jt],Jr,0,0,Ot)}else qs(Le,Oe,Ue[Jt],qe,0,0,Ot)},custom:function(Le,Oe,Ue,qe){const Ct=Le.context,Ot=Ue.implementation;if(!Le.transform.projection.unsupportedLayers||!Le.transform.projection.unsupportedLayers.includes("custom")||Le.terrain&&(Le.terrain.renderingToTexture||"offscreen"===Le.renderPass)&&Ue.isDraped(Oe)){if("offscreen"===Le.renderPass){const Oe=Ot.prerender;if(Oe){if(Le.setCustomLayerDefaults(),Ct.setColorMode(Le.colorModeForRenderPass()),"globe"===Le.transform.projection.name){const Ue=Le.transform.pointMerc;Oe.call(Ot,Ct.gl,Le.transform.customLayerMatrix(),Le.transform.getProjection(),Le.transform.globeToMercatorMatrix(),Re.a9(Le.transform.zoom),[Ue.x,Ue.y],Le.transform.pixelsPerMeterRatio)}else Oe.call(Ot,Ct.gl,Le.transform.customLayerMatrix());Ct.setDirty(),Le.setBaseState()}}else if("translucent"===Le.renderPass){if(Le.terrain&&Le.terrain.renderingToTexture){const Oe=Ot.renderToTile;if(Oe){const Ue=qe[0].canonical,Jt=new Re.a5(Ue.x+qe[0].wrap*(1<<Ue.z),Ue.y,Ue.z);Ct.setDepthMode(Li.disabled),Ct.setStencilMode(Mi.disabled),Ct.setColorMode(Le.colorModeForRenderPass()),Le.setCustomLayerDefaults(),Oe.call(Ot,Ct.gl,Jt),Ct.setDirty(),Le.setBaseState()}return}Le.setCustomLayerDefaults(),Ct.setColorMode(Le.colorModeForRenderPass()),Ct.setStencilMode(Mi.disabled);const Oe="3d"===Ot.renderingMode?new Li(Le.context.gl.LEQUAL,Li.ReadWrite,Le.depthRangeFor3D):Le.depthModeForSublayer(0,Li.ReadOnly);if(Ct.setDepthMode(Oe),"globe"===Le.transform.projection.name){const Oe=Le.transform.pointMerc;Ot.render(Ct.gl,Le.transform.customLayerMatrix(),Le.transform.getProjection(),Le.transform.globeToMercatorMatrix(),Re.a9(Le.transform.zoom),[Oe.x,Oe.y],Le.transform.pixelsPerMeterRatio)}else Ot.render(Ct.gl,Le.transform.customLayerMatrix());Ct.setDirty(),Le.setBaseState(),Ct.bindFramebuffer.set(null)}}else Re.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(Le,Oe,Ue,qe){if("opaque"===Le.renderPass)return;const Ct=Ue.paint.get("model-opacity");if(0===Ct)return;const Ot=Ue.paint.get("model-cast-shadows");if("shadow"===Le.renderPass){if(!Ot)return;if(Le.terrain&&Ct<.65&&Ue._transitionablePaint._values["model-opacity"].value.expression instanceof Re.a4)return}const Jt=Le.shadowRenderer,Hr=Ue.paint.get("model-receive-shadows");Jt&&(Jt.useNormalOffset=!0,Hr||(Jt.enabled=!1));const c=()=>{Jt&&(Jt.useNormalOffset=!0,Hr||(Jt.enabled=!0))},Jr=Oe.getSource();if("light-beam"===Le.renderPass&&"batched-model"!==Jr.type)return;if("vector"===Jr.type||"geojson"===Jr.type)return function(Le,Oe,Ue,qe,Ct){const Ot=Le.transform;if("mercator"!==Ot.projection.name)return void Re.w(`Drawing 3D models for ${Ot.projection.name} projection is not yet implemented`);const Jt=Ot.getFreeCameraOptions().position;if(!Le.modelManager)return;const Hr=Le.modelManager;Ue.modelManager=Hr;const Jr=Le.shadowRenderer;if(!Ue._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const Ln=Ue._unevaluatedLayout._values["model-id"],Nn={...Ue.layout.get("model-id").parameters},$n=Le.style.order.indexOf(Ue.fqid);for(const Gn of qe){const qe=Oe.getTile(Gn).getBucket(Ue);if(!qe||qe.projection.name!==Ot.projection.name)continue;const qn=qe.getModelUris();qn&&!qe.modelsRequested&&(Hr.addModelsFromBucket(qn,Ct),qe.modelsRequested=!0);const Zn=ua(Gn,Ot);Nn.zoom=Zn;const Xn=Ln.possiblyEvaluate(Nn);if(ca(Le,qe,Gn),Kd.shadowUniformsInitialized=!1,Kd.useSingleShadowCascade=!!Jr&&0===Jr.getMaxCascadeForTile(Gn.toUnwrapped()),"shadow"===Le.renderPass&&Jr){if(1===Le.currentShadowCascade&&qe.isInsideFirstShadowMapFrustum)continue;const Oe=Ot.calculatePosMatrix(Gn.toUnwrapped(),Ot.worldSize);if(Kd.tileMatrix.set(Oe),Kd.shadowTileMatrix=Float32Array.from(Jr.calculateShadowPassMatrixFromMatrix(Oe)),Kd.aabb.min.fill(0),Kd.aabb.max[0]=Kd.aabb.max[1]=Re.ab,Kd.aabb.max[2]=0,pa(qe,Kd,Le,Ue.scope))continue}const Yn=1<<Gn.canonical.z,_i=[((Jt.x-Gn.wrap)*Yn-Gn.canonical.x)*Re.ab,(Jt.y*Yn-Gn.canonical.y)*Re.ab,Jt.z*Yn*Re.ab];Le.conflationActive&&Object.keys(qe.instancesPerModel).length>0&&Le.style.isLayerClipped(Ue,Oe.getSource())&&qe.updateReplacement(Gn,Le.replacementSource,$n,Ct)&&(qe.uploaded=!1,qe.upload(Le.context));for(let Re in qe.instancesPerModel){const Oe=qe.instancesPerModel[Re];Oe.features.length>0&&(Re=Xn.evaluate(Oe.features[0].feature,{}));const Ot=Hr.getModel(Re,Ct);if(Ot&&Ot.uploaded)for(const Re of Ot.nodes)da(Le,Ue,Re,Oe,_i,Gn,Kd)}}}(Le,Oe,Ue,qe,"vector"===Jr.type?Ue.scope:""),void c();if(!Jr.loaded())return;if("batched-model"===Jr.type)return function(Le,Oe,Ue,qe){Ue.resetLayerRenderingStats(Le);const Ct=Le.context,Ot=Le.transform,Jt=Le.style.fog,Hr=Le.shadowRenderer;if("mercator"!==Ot.projection.name)return void Re.w(`Drawing 3D landmark models for ${Ot.projection.name} projection is not yet implemented`);const Jr=Le.transform.getFreeCameraOptions().position,Ln=Re.a6.vec3.scale([],[Jr.x,Jr.y,Jr.z],Le.transform.worldSize),Nn=Re.a6.vec3.negate([],Ln),$n=Re.a6.mat4.identity([]),Gn=Re.de(Ot.center.lat,Ot.zoom),qn=Re.a6.mat4.fromScaling([],[1,1,1/Gn]);Re.a6.mat4.translate($n,$n,Nn);const Zn=Ue.paint.get("model-opacity"),Xn=new Li(Ct.gl.LEQUAL,Li.ReadWrite,Le.depthRangeFor3D),Yn=new Li(Ct.gl.LEQUAL,Li.ReadOnly,Le.depthRangeFor3D),_i=new Re.c9([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),vi="shadow"===Le.renderPass,xi=vi&&Hr?Hr.getCurrentCascadeFrustum():Ot.getFrustum(Ot.scaleZoom(Ot.worldSize)),bi=Ue.paint.get("model-front-cutoff"),Pi=bi[2]<1,lo=Wi(Le,Ue.paint.get("model-cutoff-fade-range")),uo=Ue.getLayerRenderingStats();(function(Re,Le,Oe,Ue){const qe=Re.terrain?Re.terrain.exaggeration():0,Ct=Re.transform.zoom;for(const Ot of Ue){const Ue=Le.getTile(Ot).getBucket(Oe);Ue&&(Re.conflationActive&&Ue.updateReplacement(Ot,Re.replacementSource),Ue.evaluateScale(Re,Oe),Re.terrain&&qe>0&&Ue.elevationUpdate(Re.terrain,qe,Ot,Oe.source),Ue.needsReEvaluation(Re,Ct,Oe)&&Ue.evaluate(Oe))}})(Le,Oe,Ue,qe),function(){let Jr,Nn,po;Pi?(Jr=qe.length-1,Nn=-1,po=-1):(Jr=0,Nn=qe.length,po=1);const fo=new Float64Array(16),Io=Re.a6.vec3.create(),is=new Re.P(0,0);for(let as=Jr;as!==Nn;as+=po){const Jr=qe[as],Nn=Oe.getTile(Jr).getBucket(Ue);if(!Nn||!Nn.uploaded)continue;let po=!1;Hr&&(po=0===Hr.getMaxCascadeForTile(Jr.toUnwrapped()));const Is=Ot.calculatePosMatrix(Jr.toUnwrapped(),Ot.worldSize),Xs=Nn.modelTraits;!vi&&Pi&&(Re.a6.mat4.invert(fo,Is),Re.a6.vec3.transformMat4(Io,Ln,fo),is.x=Io[0],is.y=Io[1]);const ha=[];for(const Oe of Nn.getNodesInfo()){if(Oe.hiddenByReplacement)continue;if(!Oe.node.meshes)continue;const Ue=Oe.node;let qe=0;Le.terrain&&Ue.elevation&&(qe=Ue.elevation*Le.terrain.exaggeration());const Ct=(()=>{const Le=Oe.aabb;return _i.min=[...Le.min],_i.max=[...Le.max],_i.min[2]+=qe,_i.max[2]+=qe,Re.a6.vec3.transformMat4(_i.min,_i.min,Is),Re.a6.vec3.transformMat4(_i.max,_i.max,Is),_i})(),Jt=Oe.evaluatedScale;if(Jt[0]<=1&&Jt[1]<=1&&Jt[2]<=1&&0===Ct.intersects(xi))continue;if(!vi&&Pi){const Le=1/6;Oe.cameraCollisionOpacity=Ln[0]>Ct.min[0]&&Ln[0]<Ct.max[0]&&Ln[1]>Ct.min[1]&&Ln[1]<Ct.max[1]&&Ln[2]*Gn<Ct.max[2]&&Ue.footprint&&Re.bu(is,Ue.footprint)?Math.max(Oe.cameraCollisionOpacity-Le,0):Math.min(1,Oe.cameraCollisionOpacity+Le)}const Hr=[...Is],Jr=Ue.anchor?Ue.anchor[0]:0,Nn=Ue.anchor?Ue.anchor[1]:0;Re.a6.mat4.translate(Hr,Hr,[Jr*(Jt[0]-1),Nn*(Jt[1]-1),qe]),Re.a6.vec3.exactEquals(Jt,Re.dh)||Re.a6.mat4.scale(Hr,Hr,Jt);const $n=Re.a6.mat4.multiply([],Hr,Ue.matrix),qn=Re.a6.mat4.multiply([],Ot.expandedFarZProjMatrix,$n),Xn=Re.a6.mat4.multiply([],Ot.expandedFarZProjMatrix,Hr),Yn=Re.a6.vec4.transformMat4([],[Jr,Nn,qe,1],qn)[2];Ue.hidden=!1;let uo=Zn;vi||(Pi&&(uo*=Oe.cameraCollisionOpacity,uo*=fa(Hr,Ot,Oe.aabb,bi)),uo*=ma(lo,Yn)),0!==uo?ha.push({nodeInfo:Oe,depth:Yn,opacity:uo,wvpForNode:qn,wvpForTile:Xn,nodeModelMatrix:$n,tileModelMatrix:Hr}):Ue.hidden=!0}vi||ha.sort(((Re,Le)=>!Pi||1===Re.opacity&&1===Le.opacity?Re.depth<Le.depth?-1:1:1===Re.opacity?-1:1===Le.opacity?1:Re.depth>Le.depth?-1:1));for(const Oe of ha){const qe=Oe.nodeInfo,Jr=qe.node;let Ln=Re.a6.mat4.multiply([],qn,Oe.tileModelMatrix);Re.a6.mat4.multiply(Ln,$n,Ln);const Nn=Re.a6.mat4.invert([],Ln);Re.a6.mat4.transpose(Nn,Nn),Re.a6.mat4.scale(Nn,Nn,sp),Ln=Re.a6.mat4.multiply(Ln,Ln,Jr.matrix);const Gn="light-beam"===Le.renderPass,Zn=Xs&Re.dj.HasMapboxMeshFeatures,_i=Zn?0:qe.evaluatedRMEA[0][2];for(let Re=0;Re<Jr.meshes.length;++Re){const $n=Jr.meshes[Re],qn=Re===Jr.lightMeshIndex;let xi=Oe.wvpForNode;if(qn){if(!Gn&&!Le.terrain&&Le.shadowRenderer){Le.currentLayer<Le.firstLightBeamLayer&&(Le.firstLightBeamLayer=Le.currentLayer);continue}xi=Oe.wvpForTile}else if(Gn)continue;const bi={defines:[]},Pi=[];if(sa(bi.defines,Pi,$n,Le,Ue.lut),Zn||bi.defines.push("DIFFUSE_SHADED"),po&&bi.defines.push("SHADOWS_SINGLE_CASCADE"),uo&&(vi?uo.numRenderedVerticesInShadowPass+=$n.vertexArray.length:uo.numRenderedVerticesInTransparentPass+=$n.vertexArray.length),vi){la($n,Oe.nodeModelMatrix,Le,Ue);continue}let lo=null;if(Jt){const Re=ra(Oe.nodeModelMatrix,Le.transform);if(lo=new Float32Array(Re),"globe"!==Ot.projection.name){const Le=$n.aabb.min,Oe=$n.aabb.max,[Ue,qe]=Jt.getOpacityForBounds(Re,Le[0],Le[1],Oe[0],Oe[1]);bi.overrideFog=Ue>=ta||qe>=ta}}const fo=$n.material;let Io;fo.occlusionTexture&&fo.occlusionTexture.offsetScale&&(Io=fo.occlusionTexture.offsetScale,bi.defines.push("OCCLUSION_TEXTURE_TRANSFORM")),!vi&&Hr&&(Hr.useNormalOffset=!!$n.normalBuffer);const is=Le.getOrCreateProgram("model",bi);!vi&&Hr&&Hr.setupShadowsFromMatrix(Oe.tileModelMatrix,is,Hr.useNormalOffset),Le.uploadCommonUniforms(Ct,is,null,lo);const as=fo.pbrMetallicRoughness;as.metallicFactor=.9,as.roughnessFactor=.5;const Is=ns(new Float32Array(xi),new Float32Array(Ln),new Float32Array(Nn),new Float32Array(Jr.matrix),Le,Oe.opacity,as.baseColorFactor.toRenderColor(null),fo.emissiveFactor,as.metallicFactor,as.roughnessFactor,fo,_i,Ue,[0,0,0],Io);!qn&&(qe.hasTranslucentParts||Oe.opacity<1)&&is.draw(Le,Ct.gl.TRIANGLES,Xn,Mi.disabled,Ai.disabled,Fi.backCCW,Is,Ue.id,$n.vertexBuffer,$n.indexBuffer,$n.segments,Ue.paint,Le.transform.zoom,void 0,Pi),is.draw(Le,Ct.gl.TRIANGLES,qn?Yn:Xn,Mi.disabled,qn||Oe.opacity<1||qe.hasTranslucentParts?Ai.alphaBlended:Ai.unblended,Fi.backCCW,Is,Ue.id,$n.vertexBuffer,$n.indexBuffer,$n.segments,Ue.paint,Le.transform.zoom,void 0,Pi)}}}}()}(Le,Oe,Ue,qe),void c();if("model"!==Jr.type)return;const Ln=Jr.getModels(),Nn=[],$n=Le.transform.getFreeCameraOptions().position,Gn=Re.a6.vec3.scale([],[$n.x,$n.y,$n.z],Le.transform.worldSize);Re.a6.vec3.negate(Gn,Gn);const qn=[],Zn=[];let Xn=0;for(const Oe of Ln){const qe=Ue.paint.get("model-rotation").constantOr(null),Ct=Ue.paint.get("model-scale").constantOr(null),Ot=Ue.paint.get("model-translation").constantOr(null);Oe.computeModelMatrix(Le,qe,Ct,Ot,!0,!0,!1);const Jt=Re.a6.mat4.identity([]),Hr=Re.de(Oe.position.lat,Le.transform.zoom),Jr=Re.a6.mat4.fromScaling([],[1,1,1/Hr]);Re.a6.mat4.translate(Jt,Jt,Gn),Nn.push({zScaleMatrix:Jr,negCameraPosMatrix:Jt});for(const Re of Oe.nodes)na(Le.transform,Re,Oe.matrix,Le.transform.expandedFarZProjMatrix,Xn,qn,Zn);Xn++}if(qn.sort(((Re,Le)=>Le.depth-Re.depth)),"shadow"!==Le.renderPass){if(1===Ct)for(const Re of Zn)aa(Re,Le,Ue,Nn[Re.modelIndex],Mi.disabled,Le.colorModeForRenderPass());else{for(const Re of Zn)aa(Re,Le,Ue,Nn[Re.modelIndex],Mi.disabled,Ai.disabled);for(const Re of Zn)aa(Re,Le,Ue,Nn[Re.modelIndex],Le.stencilModeFor3D(),Le.colorModeForRenderPass());Le.resetStencilClippingMasks()}for(const Re of qn)aa(Re,Le,Ue,Nn[Re.modelIndex],Mi.disabled,Le.colorModeForRenderPass());c()}else{for(const Re of Zn)la(Re.mesh,Re.nodeModelMatrix,Le,Ue);for(const Re of qn)la(Re.mesh,Re.nodeModelMatrix,Le,Ue);c()}}},cp={model:function(Re,Le,Oe){const Ue=Le.getSource();if(!Ue.loaded())return;if("vector"===Ue.type||"geojson"===Ue.type)return void(Oe.modelManager&&Oe.modelManager.upload(Oe,"vector"===Ue.type?Re.scope:""));if("batched-model"===Ue.type)return;if("model"!==Ue.type)return;const qe=Ue.getModels();for(const Re of qe)Re.upload(Oe.context)},raster:function(Re,Le,Oe){const Ue=Le.getSource();if(!(Ue instanceof Qe&&Ue.loaded()))return;const qe=Re.sourceLayer||Ue.rasterLayerIds&&Ue.rasterLayerIds[0];if(!qe)return;const Ct=Re.paint.get("raster-array-band")||Ue.getInitialBand(qe);if(null==Ct)return;const Ot=Le.getIds().map((Re=>Le.getTileByID(Re)));for(const Re of Ot)Re.updateNeeded(qe,Ct)&&Ue.prepareTile(Re,qe,Ct)},"raster-particle":function(Re,Le,Oe){const Ue=Le.getSource();if(!(Ue instanceof Qe&&Ue.loaded()))return;const qe=Re.sourceLayer||Ue.rasterLayerIds&&Ue.rasterLayerIds[0];if(!qe)return;const Ct=Re.paint.get("raster-particle-array-band")||Ue.getInitialBand(qe);if(null==Ct)return;const Ot=Le.getIds().map((Re=>Le.getTileByID(Re)));for(const Re of Ot)Re.updateNeeded(qe,Ct)&&Ue.prepareTile(Re,qe,Ct)}};class wa{constructor(Le,Oe,Ue,qe){this.context=new ps(Le,Oe),this.transform=Ue,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=qe,this._timeStamp=Re.q.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const Ct=["fill","line","symbol","circle","heatmap","fill-extrusion","raster","raster-particle","hillshade","model","background","sky"];for(const Re of Ct)this._debugParams.enabledLayers[Re]=!0;qe.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},(()=>{this.style.map.triggerRepaint()})),qe.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),qe.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),qe.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),qe.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const Re of Ct)qe.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],Re);this.occlusionParams=new xa(qe),this.setup(),this.numSublayers=vt.maxUnderzooming+vt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new Re.dl,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new Ki(this),this._wireframeDebugCache=new va,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[];const Ot=new Re.r({width:1,height:1},Uint8Array.of(0,0,0,0));this.emptyDepthTexture=new Re.T(this.context,Ot,Le.RGBA8),this._clippingActiveLastFrame=!1}updateTerrain(Re,Le){const Oe=!!Re&&!!Re.terrain&&this.transform.projection.supportsTerrain;if(!(Oe||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Ar(this,Re));const Ue=this._terrain;this.transform.elevation=Oe?Ue:null,Ue.update(Re,this.transform,Le),this.transform.elevation&&!Ue.enabled&&(this.transform.elevation=null)}_updateFog(Re){const Le=Re.fog;if(!Le||"globe"===this.transform.projection.name||Le.getOpacity(this.transform.pitch)<1||Le.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[Oe,Ue]=Le.getFovAdjustedRange(this.transform._fov);if(Oe>Ue)return void(this.transform.fogCullDistSq=null);const qe=Oe+.78*(Ue-Oe);this.transform.fogCullDistSq=qe*qe}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(Re){Re&&!this._terrain&&(this._terrain=new Ar(this,this.style)),this._forceTerrainMode=Re}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(Le,Oe){if(this.width=Le*Re.q.devicePixelRatio,this.height=Oe*Re.q.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const Re of this.style.order)this.style._mergedLayers[Re].resize()}setup(){const Le=this.context,Oe=new Re.a_;Oe.emplaceBack(0,0),Oe.emplaceBack(Re.ab,0),Oe.emplaceBack(0,Re.ab),Oe.emplaceBack(Re.ab,Re.ab),this.tileExtentBuffer=Le.createVertexBuffer(Oe,Re.b0.members),this.tileExtentSegments=Re.b1.simpleSegment(0,0,4,2);const Ue=new Re.a_;Ue.emplaceBack(0,0),Ue.emplaceBack(Re.ab,0),Ue.emplaceBack(0,Re.ab),Ue.emplaceBack(Re.ab,Re.ab),this.debugBuffer=Le.createVertexBuffer(Ue,Re.b0.members),this.debugSegments=Re.b1.simpleSegment(0,0,4,5);const qe=new Re.a_;qe.emplaceBack(-1,-1),qe.emplaceBack(1,-1),qe.emplaceBack(-1,1),qe.emplaceBack(1,1),this.viewportBuffer=Le.createVertexBuffer(qe,Re.b0.members),this.viewportSegments=Re.b1.simpleSegment(0,0,4,2);const Ct=new Re.aN;Ct.emplaceBack(0,0,0,0),Ct.emplaceBack(Re.ab,0,Re.ab,0),Ct.emplaceBack(0,Re.ab,0,Re.ab),Ct.emplaceBack(Re.ab,Re.ab,Re.ab,Re.ab),this.mercatorBoundsBuffer=Le.createVertexBuffer(Ct,Re.b3.members),this.mercatorBoundsSegments=Re.b1.simpleSegment(0,0,4,2);const Ot=new Re.aO;Ot.emplaceBack(0,1,2),Ot.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=Le.createIndexBuffer(Ot);const Jt=new Re.a$;for(const Re of[0,1,3,2,0])Jt.emplaceBack(Re);this.debugIndexBuffer=Le.createIndexBuffer(Jt),this.emptyTexture=new Re.T(Le,new Re.r({width:1,height:1},Uint8Array.of(0,0,0,0)),Le.gl.RGBA8),this.identityMat=Re.a6.mat4.create();const Hr=this.context.gl;this.stencilClearMode=new Mi({func:Hr.ALWAYS,mask:0},0,255,Hr.ZERO,Hr.ZERO,Hr.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(Re){return Re._makeTileBoundsBuffers(this.context,this.transform.projection),Re._tileBoundsBuffer?{tileBoundsBuffer:Re._tileBoundsBuffer,tileBoundsIndexBuffer:Re._tileBoundsIndexBuffer,tileBoundsSegments:Re._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const Re=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,Re.TRIANGLES,Li.disabled,this.stencilClearMode,Ai.disabled,Fi.disabled,Cr(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(Re,Le,Oe){if(!Le||this.currentStencilSource===Le.id||!Re.isTileClipped()||!Oe||0===Oe.length)return;if(this._tileClippingMaskIDs&&!this.terrain){let Re=!1;for(const Le of Oe)if(void 0===this._tileClippingMaskIDs[Le.key]){Re=!0;break}if(!Re)return}this.currentStencilSource=Le.id;const Ue=this.context,qe=Ue.gl;this.nextStencilID+Oe.length>256&&this.clearStencil(),Ue.setColorMode(Ai.disabled),Ue.setDepthMode(Li.disabled);const Ct=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const Re of Oe){const Oe=Le.getTile(Re),Ue=this._tileClippingMaskIDs[Re.key]=this.nextStencilID++,{tileBoundsBuffer:Ot,tileBoundsIndexBuffer:Jt,tileBoundsSegments:Hr}=this.getTileBoundsBuffers(Oe);Ct.draw(this,qe.TRIANGLES,Li.disabled,new Mi({func:qe.ALWAYS,mask:0},Ue,255,qe.KEEP,qe.KEEP,qe.REPLACE),Ai.disabled,Fi.disabled,Cr(Re.projMatrix),"$clipping",Ot,Jt,Hr)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const Re=this.nextStencilID++,Le=this.context.gl;return new Mi({func:Le.NOTEQUAL,mask:255},Re,255,Le.KEEP,Le.KEEP,Le.REPLACE)}stencilModeForClipping(Re){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(Re);const Le=this.context.gl;return new Mi({func:Le.EQUAL,mask:255},this._tileClippingMaskIDs[Re.key],0,Le.KEEP,Le.KEEP,Le.REPLACE)}stencilConfigForOverlap(Re){const Le=this.context.gl,Oe=Re.sort(((Re,Le)=>Le.overscaledZ-Re.overscaledZ)),Ue=Oe[Oe.length-1].overscaledZ,qe=Oe[0].overscaledZ-Ue+1;if(qe>1){this.currentStencilSource=void 0,this.nextStencilID+qe>256&&this.clearStencil();const Re={};for(let Oe=0;Oe<qe;Oe++)Re[Oe+Ue]=new Mi({func:Le.GEQUAL,mask:255},Oe+this.nextStencilID,255,Le.KEEP,Le.KEEP,Le.REPLACE);return this.nextStencilID+=qe,[Re,Oe]}return[{[Ue]:Mi.disabled},Oe]}colorModeForRenderPass(){const Le=this.context.gl;if(this._showOverdrawInspector){const Oe=1/8;return new Ai([Le.CONSTANT_COLOR,Le.ONE,Le.CONSTANT_COLOR,Le.ONE],new Re.bz(Oe,Oe,Oe,0),[!0,!0,!0,!0])}return"opaque"===this.renderPass?Ai.unblended:Ai.alphaBlended}colorModeForDrapableLayerRenderPass(Le){const Oe=this.context.gl;return(()=>this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture)()&&"translucent"===this.renderPass?new Ai([Oe.ONE,Oe.ONE_MINUS_SRC_ALPHA,Oe.CONSTANT_ALPHA,Oe.ONE_MINUS_SRC_ALPHA],new Re.bz(0,0,0,void 0===Le?0:Le),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(Re,Le,Oe,Ue=!1){if(this.depthOcclusion)return new Li(this.context.gl.GREATER,Li.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!Ue)return Li.disabled;const qe=1-((1+this.currentLayer)*this.numSublayers+Re)*this.depthEpsilon;return new Li(Oe||this.context.gl.LEQUAL,Le,[qe,qe])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}blitDepth(){const Le=this.context.gl,Oe=Math.ceil(this.width),Ue=Math.ceil(this.height),qe=this.context.bindFramebuffer.get(),Ct=Le.getParameter(Le.TEXTURE_BINDING_2D);this.depthFBO&&this.depthFBO.width===Oe&&this.depthFBO.height===Ue||(this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),0!==Oe&&0!==Ue&&(this.depthFBO=new _s(this.context,Oe,Ue,!1,"texture"),this.depthTexture=new Re.T(this.context,{width:Oe,height:Ue,data:null},Le.DEPTH24_STENCIL8),this.depthFBO.depthAttachment.set(this.depthTexture.texture))),this.context.bindFramebuffer.set(qe),Le.bindTexture(Le.TEXTURE_2D,Ct),this.depthFBO&&(Le.bindFramebuffer(Le.READ_FRAMEBUFFER,null),Le.bindFramebuffer(Le.DRAW_FRAMEBUFFER,this.depthFBO.framebuffer),Le.blitFramebuffer(0,0,Oe,Ue,0,0,Oe,Ue,Le.DEPTH_BUFFER_BIT,Le.NEAREST),Le.bindFramebuffer(Le.FRAMEBUFFER,this.context.bindFramebuffer.current))}updateAverageFPS(){this._fpsHistory.push(0===this._dt?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce(((Re,Le)=>Re+Le/this._fpsHistory.length),0))}render(Le,Oe){const Ue=Re.q.now();this._dt=Ue-this._timeStamp,this._timeStamp=Ue,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=Le.map.repaint,this.style=Le,this.options=Oe;const qe=this.style._mergedLayers,Ct=this.style.order.filter((Re=>{const Le=qe[Re];return!(Le.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[Le.type]}));let Ot=!1,Jt=!1;for(const Re of Ct){const Le=qe[Re];"circle"===Le.type&&(Ot=!0),"symbol"===Le.type&&(Le.hasInitialOcclusionOpacityProperties?Jt=!0:Ot=!0)}const Hr=Ct.map((Re=>qe[Re])),Jr=this.style._mergedSourceCaches;this.imageManager=Le.imageManager,this.modelManager=Le.modelManager,this.symbolFadeChange=Le.placement.symbolFadeChange(Re.q.now()),this.imageManager.beginFrame();let Ln=0,Nn=!1;for(const Re in Jr){const Le=Jr[Re];Le.used&&(Le.prepare(this.context),Le.getSource().usedInConflation&&++Ln)}let $n=!1;for(const Re of Hr)Re.isHidden(this.transform.zoom)||("clip"===Re.type&&($n=!0),this.prepareLayer(Re));const Gn={},qn={},Zn={},Xn={},Yn={};for(const Re in Jr){const Le=Jr[Re];Gn[Re]=Le.getVisibleCoordinates(),qn[Re]=Gn[Re].slice().reverse(),Zn[Re]=Le.getVisibleCoordinates(!0).reverse(),Xn[Re]=Le.getShadowCasterCoordinates(),Yn[Re]=Le.sortCoordinatesByDistance(Gn[Re])}const v=Re=>{const Le=this.style.getLayerSourceCache(Re);return Le&&Le.used?Le.getSource():null};if(Ln||$n||this._clippingActiveLastFrame){const Le=[],Oe=[];let Ue=0;for(const Re of Hr)this.isSourceForClippingOrConflation(Re,v(Re))&&(Le.push(Re),Oe.push(Ue)),Ue++;if(Le&&($n||Le.length>1)||this._clippingActiveLastFrame){$n=!1;const Ue=[];for(let qe=0;qe<Le.length;qe++){const Ct=Le[qe],Ot=Oe[qe],Jt=this.style.getLayerSourceCache(Ct);if(!Jt||!Jt.used||!Jt.getSource().usedInConflation&&"clip"!==Ct.type)continue;let Hr=Re.dn,Jr=Re.bs.None;const Ln=[];let Nn=!0;if("clip"===Ct.type){Hr=Ot;for(const Le of Ct.layout.get("clip-layer-types"))Jr|="model"===Le?Re.bs.Model:"symbol"===Le?Re.bs.Symbol:Re.bs.FillExtrusion;for(const Re of Ct.layout.get("clip-layer-scope"))Ln.push(Re);Ct.isHidden(this.transform.zoom)?Nn=!1:$n=!0}Nn&&Ue.push({layer:Ct.fqid,cache:Jt,order:Hr,clipMask:Jr,clipScope:Ln})}this.replacementSource.setSources(Ue),Nn=!0}}this._clippingActiveLastFrame=$n,Nn||this.replacementSource.clear(),this.conflationActive=Nn,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let Re=0;Re<Hr.length;Re++){const Le=Hr[Re],Oe=Le.cutoffRange();if(this.longestCutoffRange=Math.max(Oe,this.longestCutoffRange),Oe>0){const Re=v(Le);Re&&(this.minCutoffZoom=Math.max(Re.minzoom,this.minCutoffZoom)),Le.minzoom&&(this.minCutoffZoom=Math.max(Le.minzoom,this.minCutoffZoom))}Le.is3D()&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=Re),this._lastOcclusionLayer=Re)}const _i=this.style&&this.style.fog;_i?(this._fogVisible=0!==_i.getOpacity(this.transform.pitch),this._fogVisible&&"globe"!==this.transform.projection.name&&(this._fogVisible=_i.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(Zn),this.opaquePassCutoff=0);const vi=this._shadowRenderer;if(vi){vi.updateShadowParameters(this.transform,this.style.directionalLight);for(const Re in Jr)for(const Le of Gn[Re]){let Re={min:0,max:0};this.terrain&&(Re=this.terrain.getMinMaxForTile(Le)||Re),vi.addShadowReceiver(Le.toUnwrapped(),Re.min,Re.max)}}if("globe"!==this.transform.projection.name||this.globeSharedBuffers||(this.globeSharedBuffers=new Re.dm(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new oa(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),!uo.has(this.context.gl))return;this.renderPass="offscreen";for(const Re of Hr){const Oe=Le.getLayerSourceCache(Re);if(!Re.hasOffscreenPass()||Re.isHidden(this.transform.zoom))continue;const Ue=Oe?qn[Oe.id]:void 0;("custom"===Re.type||"raster"===Re.type||"raster-particle"===Re.type||Re.isSky()||Ue&&Ue.length)&&this.renderLayer(this,Oe,Re,Ue)}this.depthRangeFor3D=[0,1-(Hr.length+2)*this.numSublayers*this.depthEpsilon],this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,Xn)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const xi="globe"===this.transform.projection.name||this.transform.isHorizonVisible(),bi=(()=>{if(Oe.showOverdrawInspector)return Re.bz.black;const Le=this.style.fog;if(Le&&this.transform.projection.supportsFog){const Oe=this.style.getLut(Le.scope);if(!xi){const Ue=Le.properties.get("color").toRenderColor(Oe).toArray01();return new Re.bz(...Ue)}if(xi){const Ue=Le.properties.get("space-color").toRenderColor(Oe).toArray01();return new Re.bz(...Ue)}}return Re.bz.transparent})();if(this.context.clear({color:bi,depth:1}),this.clearStencil(),this._showOverdrawInspector=Oe.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&xi&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=Ct.length-1;this.currentLayer>=0;this.currentLayer--){const Re=Hr[this.currentLayer],Oe=Le.getLayerSourceCache(Re);if(Re.isSky())continue;const Ue=Oe?(Re.is3D()?Yn:qn)[Oe.id]:void 0;this._renderTileClippingMasks(Re,Oe,Ue),this.renderLayer(this,Oe,Re,Ue)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&xi&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||Re.a9(this.transform.zoom)>0)&&("globe"===this.transform.projection.name||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<Ct.length;this.currentLayer++){const Re=Hr[this.currentLayer],Oe=Le.getLayerSourceCache(Re);Re.isSky()&&this.renderLayer(this,Oe,Re,Oe?qn[Oe.id]:void 0)}function T(Re,Le){let Oe;return Le&&(Oe=("symbol"===Re.type?Zn:Re.is3D()?Yn:qn)[Le.id]),Oe}if(this.renderPass="translucent","globe"===this.transform.projection.name){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<Ct.length;){const Re=Hr[this.currentLayer];if("raster"===Re.type||"raster-particle"===Re.type){const Oe=Le.getLayerSourceCache(Re);this.renderLayer(this,Oe,Re,T(Re,Oe))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let Pi=0;vi&&(Pi=vi.getShadowCastingLayerCount());let lo=!1,po=-1;for(let Re=0;Re<Ct.length;++Re){const Le=Hr[Re];Le.isHidden(this.transform.zoom)||Le.is3D()&&(po=Re)}for(Jt&&-1===po&&(Ot=!0);this.currentLayer<Ct.length;){const Re=Hr[this.currentLayer],Oe=Le.getLayerSourceCache(Re);if(Re.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(Re)){if(Re.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(Ot&&!lo&&this.terrain&&!this.transform.isOrthographic&&(lo=!0,this.blitDepth()),Jt&&-1!==po&&this.currentLayer===po+1&&!this.transform.isOrthographic&&this.blitDepth(),Re.is3D()||this.terrain||this._renderTileClippingMasks(Re,Oe,Oe?Gn[Oe.id]:void 0),this.renderLayer(this,Oe,Re,T(Re,Oe)),!this.terrain&&vi&&Pi>0&&Re.hasShadowPass()&&0==--Pi&&(vi.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const Re=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=Re;this.currentLayer++){const Re=Hr[this.currentLayer];if(!Re.hasLightBeamPass())continue;const Oe=Le.getLayerSourceCache(Re);this.renderLayer(this,Oe,Re,Oe?qn[Oe.id]:void 0)}this.currentLayer=Re,this.renderPass="translucent"}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const Re=this.currentLayer;this.depthOcclusion=!0;for(const Re of this.layersWithOcclusionOpacity){this.currentLayer=Re;const Oe=Hr[this.currentLayer],Ue=Le.getLayerSourceCache(Oe),qe=Ue?qn[Ue.id]:void 0;Oe.is3D()||this.terrain||this._renderTileClippingMasks(Oe,Ue,Ue?Gn[Ue.id]:void 0),this.renderLayer(this,Ue,Oe,qe)}this.depthOcclusion=!1,this.currentLayer=Re,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let Oe=null;Hr.forEach((Re=>{const Ue=Le.getLayerSourceCache(Re);Ue&&!Re.isHidden(this.transform.zoom)&&Ue.getVisibleCoordinates().length&&(!Oe||Oe.getSource().maxzoom<Ue.getSource().maxzoom)&&(Oe=Ue)})),Oe&&this.options.showTileBoundaries&&ap.debug(this,Oe,Oe.getVisibleCoordinates(),Re.bz.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&ap.debug(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new Re.bz(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(Re){const Le=Re.transform.padding;Zs(Re,Re.transform.height-(Le.top||0),3,Cd),Zs(Re,Le.bottom||0,3,Ad),Hs(Re,Le.left||0,3,Md),Hs(Re,Re.transform.width-(Le.right||0),3,Od);const Oe=Re.transform.centerPoint;!function(Re,Le,Oe,Ue){Ws(Re,Le-1,Oe-10,2,20,Ue),Ws(Re,Le-10,Oe-1,20,2,Ue)}(Re,Oe.x,Re.transform.height-Oe.y,zd)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),Nn||(this.conflationActive=!1)}prepareLayer(Re){this.gpuTimingStart(Re);const{unsupportedLayers:Le}=this.transform.projection,Oe=!Le||!Le.includes(Re.type);if(cp[Re.type]&&(Oe||this.terrain&&"custom"===Re.type)){const Le=this.style.getLayerSourceCache(Re);cp[Re.type](Re,Le,this)}this.gpuTimingEnd()}renderLayer(Re,Le,Oe,Ue){Oe.isHidden(this.transform.zoom)||("background"===Oe.type||"sky"===Oe.type||"custom"===Oe.type||"model"===Oe.type||"raster"===Oe.type||"raster-particle"===Oe.type||Ue&&Ue.length)&&(this.id=Oe.id,this.gpuTimingStart(Oe),Re.transform.projection.unsupportedLayers&&Re.transform.projection.unsupportedLayers.includes(Oe.type)&&(!Re.terrain||"custom"!==Oe.type)||"clip"===Oe.type||ap[Oe.type](Re,Le,Oe,Ue,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(Re){if(!this.options.gpuTiming)return;const Le=this.context.extTimerQuery,Oe=this.context.gl;let Ue=this.gpuTimers[Re.id];Ue||(Ue=this.gpuTimers[Re.id]={calls:0,cpuTime:0,query:Oe.createQuery()}),Ue.calls++,Oe.beginQuery(Le.TIME_ELAPSED_EXT,Ue.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const Re=this.context.extTimerQuery,Le=this.context.gl,Oe=Le.createQuery();this.deferredRenderGpuTimeQueries.push(Oe),Le.beginQuery(Re.TIME_ELAPSED_EXT,Oe)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const Re=this.gpuTimers;return this.gpuTimers={},Re}collectDeferredRenderGpuQueries(){const Re=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],Re}queryGpuTimers(Re){const Le={};for(const Oe in Re){const Ue=Re[Oe],qe=this.context.extTimerQuery,Ct=qe.getQueryParameter(Ue.query,this.context.gl.QUERY_RESULT)/1e6;qe.deleteQueryEXT(Ue.query),Le[Oe]=Ct}return Le}queryGpuTimeDeferredRender(Re){if(!this.options.gpuTimingDeferredRender)return 0;const Le=this.context.extTimerQuery,Oe=this.context.gl;let Ue=0;for(const qe of Re)Ue+=Le.getQueryParameter(qe,Oe.QUERY_RESULT)/1e6,Le.deleteQueryEXT(qe);return Ue}translatePosMatrix(Le,Oe,Ue,qe,Ct){if(!Ue[0]&&!Ue[1])return Le;const Ot=Ct?"map"===qe?this.transform.angle:0:"viewport"===qe?-this.transform.angle:0;if(Ot){const Re=Math.sin(Ot),Le=Math.cos(Ot);Ue=[Ue[0]*Le-Ue[1]*Re,Ue[0]*Re+Ue[1]*Le]}const Jt=[Ct?Ue[0]:Re.ak(Oe,Ue[0],this.transform.zoom),Ct?Ue[1]:Re.ak(Oe,Ue[1],this.transform.zoom),0],Hr=new Float32Array(16);return Re.a6.mat4.translate(Hr,Le,Jt),Hr}saveTileTexture(Re){const Le=Re.size[0],Oe=this._tileTextures[Le];Oe?Oe.push(Re):this._tileTextures[Le]=[Re]}getTileTexture(Re){const Le=this._tileTextures[Re];return Le&&Le.length>0?Le.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return null!=this.context.extTextureFloatLinear}currentGlobalDefines(Re,Le,Oe){const Ue=void 0===Oe?this.terrain&&this.terrain.renderingToTexture:Oe,qe=[];return this.style&&this.style.enable3dLights()&&("globeRaster"===Re||"terrainRaster"===Re?(qe.push("LIGHTING_3D_MODE"),qe.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):Ue||qe.push("LIGHTING_3D_MODE")),"shadow"===this.renderPass?this._shadowMapDebug||qe.push("DEPTH_TEXTURE"):this.shadowRenderer&&(this.shadowRenderer.useNormalOffset?qe.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"):qe.push("RENDER_SHADOWS","DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(qe.push("TERRAIN"),this.linearFloatFilteringSupported()&&qe.push("TERRAIN_DEM_FLOAT_FORMAT")),"globe"===this.transform.projection.name&&qe.push("GLOBE"),!this._fogVisible||Ue||void 0!==Le&&!Le||qe.push("FOG","FOG_DITHERING"),Ue&&qe.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&qe.push("OVERDRAW_INSPECTOR"),qe}getOrCreateProgram(Re,Le){this.cache=this.cache||{};const Oe=Le&&Le.defines||[],Ue=Le&&Le.config,qe=this.currentGlobalDefines(Re,Le&&Le.overrideFog,Le&&Le.overrideRtt).concat(Oe),Ct=zr.cacheKey(ch[Re],Re,qe,Ue);return this.cache[Ct]||(this.cache[Ct]=new zr(this.context,Re,ch[Re],Ue,nd[Re],qe)),this.cache[Ct]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const Re=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(Re.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new Re.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA8))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy(),this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),this.emptyDepthTexture&&this.emptyDepthTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(Le,Oe){if(this.style.enable3dLights()){const Ue=this.style.directionalLight,qe=this.style.ambientLight;if(Ue&&qe){const Ct=((Le,Oe,Ue)=>{const qe=Le.properties.get("direction"),Ct=Le.properties.get("color").toRenderColor(Ue.getLut(Le.scope)).toArray01(),Ot=Le.properties.get("intensity"),Jt=Oe.properties.get("color").toRenderColor(Ue.getLut(Oe.scope)).toArray01(),Hr=Oe.properties.get("intensity"),Jr=[qe.x,qe.y,qe.z],Ln=Re.cH(Jt,Hr),Nn=Re.cH(Ct,Ot);return{u_lighting_ambient_color:Ln,u_lighting_directional_dir:Jr,u_lighting_directional_color:Nn,u_ground_radiance:Lr(Jr,Nn,Ln)}})(Ue,qe,this.style);Oe.setLightsUniformValues(Le,Ct)}}}uploadCommonUniforms(Le,Oe,Ue,qe,Ct){if(this.uploadCommonLightUniforms(Le,Oe),this.terrain&&this.terrain.renderingToTexture)return;const Ot=this.style.fog;if(Ot){const Ct=Ot.getOpacity(this.transform.pitch),Jt=((Le,Oe,Ue,qe,Ct,Ot,Jt,Hr,Jr,Ln,Nn,$n)=>{const Gn=Le.transform,qn=Oe.properties.get("color").toRenderColor(Le.style.getLut(Oe.scope)).toArray01();qn[3]=qe;const Zn=Le.frameCounter/1e3%1,[Xn,Yn]=Oe.properties.get("vertical-range");return{u_fog_matrix:Ue?Gn.calculateFogTileMatrix(Ue):$n||Le.identityMat,u_fog_range:Oe.getFovAdjustedRange(Gn._fov),u_fog_color:qn,u_fog_horizon_blend:Oe.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(Xn,Yn),Yn],u_fog_temporal_offset:Zn,u_frustum_tl:Ct,u_frustum_tr:Ot,u_frustum_br:Jt,u_frustum_bl:Hr,u_globe_pos:Jr,u_globe_radius:Ln,u_viewport:Nn,u_globe_transition:Re.a9(Gn.zoom),u_is_globe:+("globe"===Gn.projection.name)}})(this,Ot,Ue,Ct,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*Re.q.devicePixelRatio,this.transform.height*Re.q.devicePixelRatio],qe);Oe.setFogUniformValues(Le,Jt)}Ct&&Oe.setCutoffUniformValues(Le,Ct.uniformValues)}setTileLoadedFlag(Re){this.tileLoaded=Re}saveCanvasCopy(){const Re=this.canvasCopy();Re&&(this.frameCopies.push(Re),this.tileLoaded=!1)}canvasCopy(){const Re=this.context.gl,Le=Re.createTexture();return Re.bindTexture(Re.TEXTURE_2D,Le),Re.copyTexImage2D(Re.TEXTURE_2D,0,Re.RGBA,0,0,Re.drawingBufferWidth,Re.drawingBufferHeight,0),Le}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const Re=this.style&&this.style.fog;return!!Re&&0!==Re.getOpacity(this.transform.pitch)}getBackgroundTiles(){const Re=this._backgroundTiles,Le=this._backgroundTiles={},Oe=this.transform.coveringTiles({tileSize:512});for(const Ue of Oe)Le[Ue.key]=Re[Ue.key]||new pt(Ue,512,this.transform.tileZoom,this);return Le}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(Re,Le){return!(!Re.is3D()||"clip"!==Re.type&&(Re.minzoom&&Re.minzoom>this.transform.zoom||(this.style._clipLayerPresent||"building"!==Re.sourceLayer)&&(!Le||"batched-model"!==Le.type)))}isTileAffectedByFog(Re){if(!this.style||!this.style.fog)return!1;if("globe"===this.transform.projection.name)return!0;let Le=this._cachedTileFogOpacities[Re.key];return Le||(this._cachedTileFogOpacities[Re.key]=Le=this.style.fog.getOpacityForTile(Re)),Le[0]>=ta||Le[1]>=ta}setupDepthForOcclusion(Re,Le,Oe){const Ue=this.context,qe=Ue.gl,Ct=!!Oe;var Ot;Oe||(Oe={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0}),Ue.activeTexture.set(qe.TEXTURE3),Re&&this.depthFBO&&this.depthTexture?(this.depthTexture.bind(qe.NEAREST,qe.CLAMP_TO_EDGE),Oe.u_depth_size_inv=[1/this.depthFBO.width,1/this.depthFBO.height],Oe.u_depth_range_unpack=[2/((Ot=this.depthRangeFor3D)[1]-Ot[0]),-1-2*Ot[0]/(Ot[1]-Ot[0])],Oe.u_occluder_half_size=.5*this.occlusionParams.occluderSize,Oe.u_occlusion_depth_offset=this.occlusionParams.depthOffset):this.emptyDepthTexture.bind(qe.NEAREST,qe.CLAMP_TO_EDGE),Ue.activeTexture.set(qe.TEXTURE0),Ct||Le.setTerrainUniformValues(Ue,Oe)}}function Ta(Re,Le){let Oe=!1,Ue=null;const r=()=>{Ue=null,Oe&&(Re(),Ue=setTimeout(r,Le),Oe=!1)};return()=>(Oe=!0,Ue||r(),Ue)}class Ea{constructor(Le){this._hashName=Le&&encodeURIComponent(Le),Re.aJ(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Ta(this._updateHashUnthrottled.bind(this),300)}addTo(Re){return this._map=Re,window.addEventListener("hashchange",this._onHashChange,!1),Re.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const Re=this._map;if(!Re)return"";const Le=Ca(Re);if(this._hashName){const Re=this._hashName;let Oe=!1;const Ue=location.hash.slice(1).split("&").map((Ue=>{const qe=Ue.split("=")[0];return qe===Re?(Oe=!0,`${qe}=${Le}`):Ue})).filter((Re=>Re));return Oe||Ue.push(`${Re}=${Le}`),`#${Ue.join("&")}`}return`#${Le}`}_getCurrentHash(){const Re=location.hash.replace("#","");if(this._hashName){let Le;return Re.split("&").map((Re=>Re.split("="))).forEach((Re=>{Re[0]===this._hashName&&(Le=Re)})),(Le&&Le[1]||"").split("/")}return Re.split("/")}_onHashChange(){const Re=this._map;if(!Re)return!1;const Le=this._getCurrentHash();if(Le.length>=3&&!Le.some((Re=>isNaN(Re)))){const Oe=Re.dragRotate.isEnabled()&&Re.touchZoomRotate.isEnabled()?+(Le[3]||0):Re.getBearing();return Re.jumpTo({center:[+Le[2],+Le[1]],zoom:+Le[0],bearing:Oe,pitch:+(Le[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function Ca(Re,Le){const Oe=Re.getCenter(),Ue=Math.round(100*Re.getZoom())/100,qe=Math.ceil((Ue*Math.LN2+Math.log(512/360/.5))/Math.LN10),Ct=Math.pow(10,qe),Ot=Math.round(Oe.lng*Ct)/Ct,Jt=Math.round(Oe.lat*Ct)/Ct,Hr=Re.getBearing(),Jr=Re.getPitch();let Ln=Le?`/${Ot}/${Jt}/${Ue}`:`${Ue}/${Jt}/${Ot}`;return(Hr||Jr)&&(Ln+="/"+Math.round(10*Hr)/10),Jr&&(Ln+=`/${Math.round(Jr)}`),Ln}const hp={linearity:.3,easing:Re.dp(0,0,.3,1)},dp=Re.l({deceleration:2500,maxSpeed:1400},hp),pp=Re.l({deceleration:20,maxSpeed:1400},hp),fp=Re.l({deceleration:1e3,maxSpeed:360},hp),mp=Re.l({deceleration:1e3,maxSpeed:90},hp);class La{constructor(Re){this._map=Re,this.clear()}clear(){this._inertiaBuffer=[]}record(Le){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:Re.q.now(),settings:Le})}_drainInertiaBuffer(){const Le=this._inertiaBuffer,Oe=Re.q.now();for(;Le.length>0&&Oe-Le[0].time>160;)Le.shift()}_onMoveEnd(Le){if(this._map._prefersReducedMotion())return;if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const Oe={zoom:0,bearing:0,pitch:0,pan:new Re.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:Re}of this._inertiaBuffer)Oe.zoom+=Re.zoomDelta||0,Oe.bearing+=Re.bearingDelta||0,Oe.pitch+=Re.pitchDelta||0,Re.panDelta&&Oe.pan._add(Re.panDelta),Re.around&&(Oe.around=Re.around),Re.pinchAround&&(Oe.pinchAround=Re.pinchAround);const Ue=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,qe={};if(Oe.pan.mag()){const Ct=Ma(Oe.pan.mag(),Ue,Re.l({},dp,Le||{}));qe.offset=Oe.pan.mult(Ct.amount/Oe.pan.mag()),qe.center=this._map.transform.center,Pa(qe,Ct)}if(Oe.zoom){const Re=Ma(Oe.zoom,Ue,pp);qe.zoom=this._map.transform.zoom+Re.amount,Pa(qe,Re)}if(Oe.bearing){const Le=Ma(Oe.bearing,Ue,fp);qe.bearing=this._map.transform.bearing+Re.ap(Le.amount,-179,179),Pa(qe,Le)}if(Oe.pitch){const Re=Ma(Oe.pitch,Ue,mp);qe.pitch=this._map.transform.pitch+Re.amount,Pa(qe,Re)}if(qe.zoom||qe.bearing){const Re=void 0===Oe.pinchAround?Oe.around:Oe.pinchAround;qe.around=Re?this._map.unproject(Re):this._map.getCenter()}return this.clear(),qe.noMoveStart=!0,qe}}function Pa(Re,Le){(!Re.duration||Re.duration<Le.duration)&&(Re.duration=Le.duration,Re.easing=Le.easing)}function Ma(Le,Oe,Ue){const{maxSpeed:qe,linearity:Ct,deceleration:Ot}=Ue,Jt=Re.ap(Le*Ct/(Oe/1e3),-qe,qe),Hr=Math.abs(Jt)/(Ot*Ct);return{easing:Ue.easing,duration:1e3*Hr,amount:Jt*(Hr/2)}}class za extends Re.x{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(Le,Oe,Ue,qe={}){const Ct=g(Oe.getCanvasContainer(),Ue),Ot=Oe.unproject(Ct);super(Le,Re.l({point:Ct,lngLat:Ot,originalEvent:Ue},qe)),this._defaultPrevented=!1,this.target=Oe}}class Oa extends Re.x{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(Le,Oe,Ue){const qe="touchend"===Le?Ue.changedTouches:Ue.touches,Ct=v(Oe.getCanvasContainer(),qe),Ot=Ct.map((Re=>Oe.unproject(Re))),Jt=Ct.reduce(((Re,Le,Oe,Ue)=>Re.add(Le.div(Ue.length))),new Re.P(0,0));super(Le,{points:Ct,point:Jt,lngLats:Ot,lngLat:Oe.unproject(Jt),originalEvent:Ue}),this._defaultPrevented=!1}}class Fa extends Re.x{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(Re,Le){super("wheel",{originalEvent:Le}),this._defaultPrevented=!1}}class ka{constructor(Re,Le){this._map=Re,this._clickTolerance=Le.clickTolerance}reset(){this._mousedownPos=void 0}wheel(Re){return this._firePreventable(new Fa(this._map,Re))}mousedown(Re,Le){return this._mousedownPos=Le,this._firePreventable(new za(Re.type,this._map,Re))}mouseup(Re){this._map.fire(new za(Re.type,this._map,Re))}preclick(Le){const Oe=Re.l({},Le);Oe.type="preclick",this._map.fire(new za(Oe.type,this._map,Oe))}click(Re,Le){this._mousedownPos&&this._mousedownPos.dist(Le)>=this._clickTolerance||(this.preclick(Re),this._map.fire(new za(Re.type,this._map,Re)))}dblclick(Re){return this._firePreventable(new za(Re.type,this._map,Re))}mouseover(Re){this._map.fire(new za(Re.type,this._map,Re))}mouseout(Re){this._map.fire(new za(Re.type,this._map,Re))}touchstart(Re){return this._firePreventable(new Oa(Re.type,this._map,Re))}touchmove(Re){this._map.fire(new Oa(Re.type,this._map,Re))}touchend(Re){this._map.fire(new Oa(Re.type,this._map,Re))}touchcancel(Re){this._map.fire(new Oa(Re.type,this._map,Re))}_firePreventable(Re){if(this._map.fire(Re),Re.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ba{constructor(Re){this._map=Re}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(Re){this._map.fire(new za(Re.type,this._map,Re))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new za("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(Re){this._delayContextMenu?this._contextMenuEvent=Re:this._map.fire(new za(Re.type,this._map,Re)),this._map.listens("contextmenu")&&Re.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Na{constructor(Re,Le){this._map=Re,this._el=Re.getCanvasContainer(),this._container=Re.getContainer(),this._clickTolerance=Le.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(Re,Le){this.isEnabled()&&Re.shiftKey&&0===Re.button&&(_(),this._startPos=this._lastPos=Le,this._active=!0)}mousemoveWindow(Re,Le){if(!this._active)return;const Oe=Le,Ue=this._startPos,qe=this._lastPos;if(!Ue||!qe||qe.equals(Oe)||!this._box&&Oe.dist(Ue)<this._clickTolerance)return;this._lastPos=Oe,this._box||(this._box=l("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",Re));const Ct=Math.min(Ue.x,Oe.x),Ot=Math.max(Ue.x,Oe.x),Jt=Math.min(Ue.y,Oe.y),Hr=Math.max(Ue.y,Oe.y);this._map._requestDomTask((()=>{this._box&&(this._box.style.transform=`translate(${Ct}px,${Jt}px)`,this._box.style.width=Ot-Ct+"px",this._box.style.height=Hr-Jt+"px")}))}mouseupWindow(Le,Oe){if(!this._active)return;const Ue=this._startPos,qe=Oe;if(Ue&&0===Le.button){if(this.reset(),f(),Ue.x!==qe.x||Ue.y!==qe.y)return this._map.fire(new Re.x("boxzoomend",{originalEvent:Le})),{cameraAnimation:Re=>Re.fitScreenCoordinates(Ue,qe,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",Le)}}keydown(Re){this._active&&27===Re.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",Re))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),p(),delete this._startPos,delete this._lastPos}_fireEvent(Le,Oe){return this._map.fire(new Re.x(Le,{originalEvent:Oe}))}}function Ua(Re,Le){const Oe={};for(let Ue=0;Ue<Re.length;Ue++)Oe[Re[Ue].identifier]=Le[Ue];return Oe}class Ga{constructor(Re){this.reset(),this.numTouches=Re.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(Le,Oe,Ue){(this.centroid||Ue.length>this.numTouches)&&(this.aborted=!0),this.aborted||(0===this.startTime&&(this.startTime=Le.timeStamp),Ue.length===this.numTouches&&(this.centroid=function(Le){const Oe=new Re.P(0,0);for(const Re of Le)Oe._add(Re);return Oe.div(Le.length)}(Oe),this.touches=Ua(Ue,Oe)))}touchmove(Re,Le,Oe){if(this.aborted||!this.centroid)return;const Ue=Ua(Oe,Le);for(const Re in this.touches){const Le=Ue[Re];(!Le||Le.dist(this.touches[Re])>30)&&(this.aborted=!0)}}touchend(Re,Le,Oe){if((!this.centroid||Re.timeStamp-this.startTime>500)&&(this.aborted=!0),0===Oe.length){const Re=!this.aborted&&this.centroid;if(this.reset(),Re)return Re}}}class ja{constructor(Re){this.singleTap=new Ga(Re),this.numTaps=Re.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(Re,Le,Oe){this.singleTap.touchstart(Re,Le,Oe)}touchmove(Re,Le,Oe){this.singleTap.touchmove(Re,Le,Oe)}touchend(Re,Le,Oe){const Ue=this.singleTap.touchend(Re,Le,Oe);if(Ue){const Le=Re.timeStamp-this.lastTime<500,Oe=!this.lastTap||this.lastTap.dist(Ue)<30;if(Le&&Oe||this.reset(),this.count++,this.lastTime=Re.timeStamp,this.lastTap=Ue,this.count===this.numTaps)return this.reset(),Ue}}}class Va{constructor(){this._zoomIn=new ja({numTouches:1,numTaps:2}),this._zoomOut=new ja({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(Re,Le,Oe){this._zoomIn.touchstart(Re,Le,Oe),this._zoomOut.touchstart(Re,Le,Oe)}touchmove(Re,Le,Oe){this._zoomIn.touchmove(Re,Le,Oe),this._zoomOut.touchmove(Re,Le,Oe)}touchend(Re,Le,Oe){const Ue=this._zoomIn.touchend(Re,Le,Oe),qe=this._zoomOut.touchend(Re,Le,Oe);return Ue?(this._active=!0,Re.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:Le=>Le.easeTo({duration:300,zoom:Le.getZoom()+1,around:Le.unproject(Ue)},{originalEvent:Re})}):qe?(this._active=!0,Re.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:Le=>Le.easeTo({duration:300,zoom:Le.getZoom()-1,around:Le.unproject(qe)},{originalEvent:Re})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const yp={0:1,2:2};class Za{constructor(Re){this.reset(),this._clickTolerance=Re.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(Re,Le){return!1}_move(Re,Le){return{}}mousedown(Re,Le){if(this._lastPoint)return;const Oe=x(Re);this._correctButton(Re,Oe)&&(this._lastPoint=Le,this._eventButton=Oe)}mousemoveWindow(Re,Le){const Oe=this._lastPoint;if(Oe)if(Re.preventDefault(),null!=this._eventButton&&function(Re,Le){const Oe=yp[Le];return void 0===Re.buttons||(Re.buttons&Oe)!==Oe}(Re,this._eventButton))this.reset();else if(this._moved||!(Le.dist(Oe)<this._clickTolerance))return this._moved=!0,this._lastPoint=Le,this._move(Oe,Le)}mouseupWindow(Re){this._lastPoint&&x(Re)===this._eventButton&&(this._moved&&f(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ha extends Za{mousedown(Re,Le){super.mousedown(Re,Le),this._lastPoint&&(this._active=!0)}_correctButton(Re,Le){return 0===Le&&!Re.ctrlKey}_move(Re,Le){return{around:Le,panDelta:Le.sub(Re)}}}class Wa extends Za{_correctButton(Re,Le){return 0===Le&&Re.ctrlKey||2===Le}_move(Re,Le){const Oe=.8*(Le.x-Re.x);if(Oe)return this._active=!0,{bearingDelta:Oe}}contextmenu(Re){Re.preventDefault()}}class $a extends Za{_correctButton(Re,Le){return 0===Le&&Re.ctrlKey||2===Le}_move(Re,Le){const Oe=-.5*(Le.y-Re.y);if(Oe)return this._active=!0,{pitchDelta:Oe}}contextmenu(Re){Re.preventDefault()}}class Xa{constructor(Le,Oe){this._map=Le,this._el=Le.getCanvasContainer(),this._minTouches=1,this._clickTolerance=Oe.clickTolerance||1,this.reset(),Re.aJ(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new Re.P(0,0)}touchstart(Re,Le,Oe){return this._calculateTransform(Re,Le,Oe)}touchmove(Le,Oe,Ue){if(this._active&&!(Ue.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(1===Ue.length&&!Re.dq())return void this._showTouchPanBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return Le.cancelable&&Le.preventDefault(),this._calculateTransform(Le,Oe,Ue)}}touchend(Re,Le,Oe){this._calculateTransform(Re,Le,Oe),this._active&&Oe.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(Le,Oe,Ue){Ue.length>0&&(this._active=!0);const qe=Ua(Ue,Oe),Ct=new Re.P(0,0),Ot=new Re.P(0,0);let Jt=0;for(const Re in qe){const Le=qe[Re],Oe=this._touches[Re];Oe&&(Ct._add(Le),Ot._add(Le.sub(Oe)),Jt++,qe[Re]=Le)}if(this._touches=qe,Jt<this._minTouches||!Ot.mag())return;const Hr=Ot.div(Jt);return this._sum._add(Hr),this._sum.mag()<this._clickTolerance?void 0:{around:Ct.div(Jt),panDelta:Hr}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=l("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout((()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")}),500)}}class Ya{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(Re){}_move(Re,Le,Oe){return{}}touchstart(Re,Le,Oe){this._firstTwoTouches||Oe.length<2||(this._firstTwoTouches=[Oe[0].identifier,Oe[1].identifier],this._start([Le[0],Le[1]]))}touchmove(Re,Le,Oe){const Ue=this._firstTwoTouches;if(!Ue)return;Re.preventDefault();const[qe,Ct]=Ue,Ot=Ka(Oe,Le,qe),Jt=Ka(Oe,Le,Ct);if(!Ot||!Jt)return;const Hr=this._aroundCenter?null:Ot.add(Jt).div(2);return this._move([Ot,Jt],Hr,Re)}touchend(Re,Le,Oe){if(!this._firstTwoTouches)return;const[Ue,qe]=this._firstTwoTouches,Ct=Ka(Oe,Le,Ue),Ot=Ka(Oe,Le,qe);Ct&&Ot||(this._active&&f(),this.reset())}touchcancel(){this.reset()}enable(Re){this._enabled=!0,this._aroundCenter=!!Re&&"center"===Re.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Ka(Re,Le,Oe){for(let Ue=0;Ue<Re.length;Ue++)if(Re[Ue].identifier===Oe)return Le[Ue]}function Ja(Re,Le){return Math.log(Re/Le)/Math.LN2}class Qa extends Ya{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(Re){this._startDistance=this._distance=Re[0].dist(Re[1])}_move(Re,Le){const Oe=this._distance;if(this._distance=Re[0].dist(Re[1]),this._active||!(Math.abs(Ja(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Ja(this._distance,Oe),pinchAround:Le}}}function en(Re,Le){return 180*Re.angleWith(Le)/Math.PI}class tn extends Ya{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(Re){this._startVector=this._vector=Re[0].sub(Re[1]),this._minDiameter=Re[0].dist(Re[1])}_move(Re,Le){const Oe=this._vector;if(this._vector=Re[0].sub(Re[1]),Oe&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:en(this._vector,Oe),pinchAround:Le}}_isBelowThreshold(Re){this._minDiameter=Math.min(this._minDiameter,Re.mag());const Le=25/(Math.PI*this._minDiameter)*360,Oe=this._startVector;if(!Oe)return!1;const Ue=en(Re,Oe);return Math.abs(Ue)<Le}}function on(Re){return Math.abs(Re.y)>Math.abs(Re.x)}class rn extends Ya{constructor(Re){super(),this._map=Re}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(Re){this._lastPoints=Re,on(Re[0].sub(Re[1]))&&(this._valid=!1)}_move(Le,Oe,Ue){const qe=this._lastPoints;if(!qe)return;const Ct=Le[0].sub(qe[0]),Ot=Le[1].sub(qe[1]);return this._map._cooperativeGestures&&!Re.dq()&&Ue.touches.length<3||(this._valid=this.gestureBeginsVertically(Ct,Ot,Ue.timeStamp),!this._valid)?void 0:(this._lastPoints=Le,this._active=!0,{pitchDelta:(Ct.y+Ot.y)/2*-.5})}gestureBeginsVertically(Re,Le,Oe){if(void 0!==this._valid)return this._valid;const Ue=Re.mag()>=2,qe=Le.mag()>=2;if(!Ue&&!qe)return;if(!Ue||!qe)return null==this._firstMove&&(this._firstMove=Oe),Oe-this._firstMove<100&&void 0;const Ct=Re.y>0==Le.y>0;return on(Re)&&on(Le)&&Ct}}const vp={panStep:100,bearingStep:15,pitchStep:10};class an{constructor(){const Re=vp;this._panStep=Re.panStep,this._bearingStep=Re.bearingStep,this._pitchStep=Re.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(Re){if(Re.altKey||Re.ctrlKey||Re.metaKey)return;let Le=0,Oe=0,Ue=0,qe=0,Ct=0;switch(Re.keyCode){case 61:case 107:case 171:case 187:Le=1;break;case 189:case 109:case 173:Le=-1;break;case 37:Re.shiftKey?Oe=-1:(Re.preventDefault(),qe=-1);break;case 39:Re.shiftKey?Oe=1:(Re.preventDefault(),qe=1);break;case 38:Re.shiftKey?Ue=1:(Re.preventDefault(),Ct=-1);break;case 40:Re.shiftKey?Ue=-1:(Re.preventDefault(),Ct=1);break;default:return}return this._rotationDisabled&&(Oe=0,Ue=0),{cameraAnimation:Ot=>{const Jt=Ot.getZoom();Ot.easeTo({duration:300,easeId:"keyboardHandler",easing:nn,zoom:Le?Math.round(Jt)+Le*(Re.shiftKey?2:1):Jt,bearing:Ot.getBearing()+Oe*this._bearingStep,pitch:Ot.getPitch()+Ue*this._pitchStep,offset:[-qe*this._panStep,-Ct*this._panStep],center:Ot.getCenter()},{originalEvent:Re})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function nn(Re){return Re*(2-Re)}const xp=4.000244140625,bp=1/450;class hn{constructor(Le,Oe){this._map=Le,this._el=Le.getCanvasContainer(),this._handler=Oe,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=bp,Re.aJ(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(Re){this._defaultZoomRate=Re}setWheelZoomRate(Re){this._wheelZoomRate=Re}isEnabled(){return!!this._enabled}isActive(){return this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(Re){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!Re&&"center"===Re.around,this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(Le){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(Le.ctrlKey||Le.metaKey||this.isZooming()||Re.dq()))return void this._showBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let Oe=Le.deltaMode===WheelEvent.DOM_DELTA_LINE?40*Le.deltaY:Le.deltaY;const Ue=Re.q.now(),qe=Ue-(this._lastWheelEventTime||0);this._lastWheelEventTime=Ue,0!==Oe&&Oe%xp==0?this._type="wheel":0!==Oe&&Math.abs(Oe)<4?this._type="trackpad":qe>400?(this._type=null,this._lastValue=Oe,this._timeout=window.setTimeout(this._onTimeout,40,Le)):this._type||(this._type=Math.abs(qe*Oe)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,Oe+=this._lastValue)),Le.shiftKey&&Oe&&(Oe/=4),this._type&&(this._lastWheelEvent=Le,this._delta-=Oe,this._active||this._start(Le)),Le.preventDefault()}_onTimeout(Re){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(Re)}_start(Re){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const Le=g(this._el,Re);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:Le,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId)return;if(this._frameId=null,!this.isActive())return;const Le=this._map.transform;"wheel"===this._type&&Le.projection.wrap&&(Le._center.lng>=180||Le._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const i=()=>Le._terrainEnabled()&&this._aroundCoord?Le.computeZoomRelativeTo(this._aroundCoord):Le.zoom;if(0!==this._delta){const Re="wheel"===this._type&&Math.abs(this._delta)>xp?this._wheelZoomRate:this._defaultZoomRate;let Oe=2/(1+Math.exp(-Math.abs(this._delta*Re)));this._delta<0&&0!==Oe&&(Oe=1/Oe);const Ue=i(),qe=Math.pow(2,Ue),Ct="number"==typeof this._targetZoom?Le.zoomScale(this._targetZoom):qe;this._targetZoom=Math.min(Le.maxZoom,Math.max(Le.minZoom,Le.scaleZoom(Ct*Oe))),"wheel"===this._type&&(this._startZoom=Ue,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const Oe="number"==typeof this._targetZoom?this._targetZoom:i(),Ue=this._startZoom,qe=this._easing;let Ct,Ot=!1;if("wheel"===this._type&&Ue&&qe){const Le=Math.min((Re.q.now()-this._lastWheelEventTime)/200,1),Jt=qe(Le);Ct=Re.aa(Ue,Oe,Jt),Le<1?this._frameId||(this._frameId=!0):Ot=!0}else Ct=Oe,Ot=!0;this._active=!0,Ot&&(this._active=!1,this._finishTimeout=window.setTimeout((()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout}),200));let Jt=Ct-i();return Jt*this._lastDelta<0&&(Jt=0),{noInertia:!0,needsRenderFrame:!Ot,zoomDelta:Jt,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(Le){let Oe=Re.dr;if(this._prevEase){const Le=this._prevEase,Ue=(Re.q.now()-Le.start)/Le.duration,qe=Le.easing(Ue+.01)-Le.easing(Ue),Ct=.27/Math.sqrt(qe*qe+1e-4)*.01,Ot=Math.sqrt(.0729-Ct*Ct);Oe=Re.dp(Ct,Ot,.25,1)}return this._prevEase={start:Re.q.now(),duration:Le,easing:Oe},Oe}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=l("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout((()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")}),200)}}class un{constructor(Re,Le){this._clickZoom=Re,this._tapZoom=Le}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class dn{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(Re,Le){return Re.preventDefault(),{cameraAnimation:Oe=>{Oe.easeTo({duration:300,zoom:Oe.getZoom()+(Re.shiftKey?-1:1),around:Oe.unproject(Le)},{originalEvent:Re})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class _n{constructor(){this._tap=new ja({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(Re,Le,Oe){this._swipePoint||(this._tapTime&&Re.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?Oe.length>0&&(this._swipePoint=Le[0],this._swipeTouch=Oe[0].identifier):this._tap.touchstart(Re,Le,Oe))}touchmove(Re,Le,Oe){if(this._tapTime){if(this._swipePoint){if(Oe[0].identifier!==this._swipeTouch)return;const Ue=Le[0],qe=Ue.y-this._swipePoint.y;return this._swipePoint=Ue,Re.preventDefault(),this._active=!0,{zoomDelta:qe/128}}}else this._tap.touchmove(Re,Le,Oe)}touchend(Re,Le,Oe){this._tapTime?this._swipePoint&&0===Oe.length&&this.reset():this._tap.touchend(Re,Le,Oe)&&(this._tapTime=Re.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class pn{constructor(Re,Le,Oe){this._el=Re,this._mousePan=Le,this._touchPan=Oe}enable(Re){this._inertiaOptions=Re||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class mn{constructor(Re,Le,Oe){this._pitchWithRotate=Re.pitchWithRotate,this._mouseRotate=Le,this._mousePitch=Oe}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class fn{constructor(Re,Le,Oe,Ue){this._el=Re,this._touchZoom=Le,this._touchRotate=Oe,this._tapDragZoom=Ue,this._rotationDisabled=!1,this._enabled=!0}enable(Re){this._touchZoom.enable(Re),this._rotationDisabled||this._touchRotate.enable(Re),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const gn=Re=>Re.zoom||Re.drag||Re.pitch||Re.rotate;class vn extends Re.x{}class xn{constructor(){this.constants=[1,1,.01],this.radius=0}setup(Le,Oe){const Ue=Re.a6.vec3.sub([],Oe,Le);this.radius=Re.a6.vec3.length(Ue[2]<0?Re.a6.vec3.div([],Ue,this.constants):[Ue[0],Ue[1],0])}projectRay(Le){Re.a6.vec3.div(Le,Le,this.constants),Re.a6.vec3.normalize(Le,Le),Re.a6.vec3.mul(Le,Le,this.constants);const Oe=Re.a6.vec3.scale([],Le,this.radius);if(Oe[2]>0){const Le=Re.a6.vec3.scale([],[0,0,1],Re.a6.vec3.dot(Oe,[0,0,1])),Ue=Re.a6.vec3.scale([],Re.a6.vec3.normalize([],[Oe[0],Oe[1],0]),this.radius),qe=Re.a6.vec3.add([],Oe,Re.a6.vec3.scale([],Re.a6.vec3.sub([],Re.a6.vec3.add([],Ue,Le),Oe),2));Oe[0]=qe[0],Oe[1]=qe[1]}return Oe}}function yn(Re){return Re.panDelta&&Re.panDelta.mag()||Re.zoomDelta||Re.bearingDelta||Re.pitchDelta}class bn{constructor(Le,Oe){this._map=Le,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new La(Le),this._bearingSnap=Oe.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new xn,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(Oe),Re.aJ(["handleEvent","handleWindowEvent"],this);const Ue=this._el;this._listeners=[[Ue,"touchstart",{passive:!0}],[Ue,"touchmove",{passive:!1}],[Ue,"touchend",void 0],[Ue,"touchcancel",void 0],[Ue,"mousedown",void 0],[Ue,"mousemove",void 0],[Ue,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[Ue,"mouseover",void 0],[Ue,"mouseout",void 0],[Ue,"dblclick",void 0],[Ue,"click",void 0],[Ue,"keydown",{capture:!1}],[Ue,"keyup",void 0],[Ue,"wheel",{passive:!1}],[Ue,"contextmenu",void 0],[window,"blur",void 0]];for(const[Re,Le,Oe]of this._listeners){const Ue=Re===document?this.handleWindowEvent:this.handleEvent;Re.addEventListener(Le,Ue,Oe)}}destroy(){for(const[Re,Le,Oe]of this._listeners){const Ue=Re===document?this.handleWindowEvent:this.handleEvent;Re.removeEventListener(Le,Ue,Oe)}}_addDefaultHandlers(Re){const Le=this._map,Oe=Le.getCanvasContainer();this._add("mapEvent",new ka(Le,Re));const Ue=Le.boxZoom=new Na(Le,Re);this._add("boxZoom",Ue);const qe=new Va,Ct=new dn;Le.doubleClickZoom=new un(Ct,qe),this._add("tapZoom",qe),this._add("clickZoom",Ct);const Ot=new _n;this._add("tapDragZoom",Ot);const Jt=Le.touchPitch=new rn(Le);this._add("touchPitch",Jt);const Hr=new Wa(Re),Jr=new $a(Re);Le.dragRotate=new mn(Re,Hr,Jr),this._add("mouseRotate",Hr,["mousePitch"]),this._add("mousePitch",Jr,["mouseRotate"]);const Ln=new Ha(Re),Nn=new Xa(Le,Re);Le.dragPan=new pn(Oe,Ln,Nn),this._add("mousePan",Ln),this._add("touchPan",Nn,["touchZoom","touchRotate"]);const $n=new tn,Gn=new Qa;Le.touchZoomRotate=new fn(Oe,Gn,$n,Ot),this._add("touchRotate",$n,["touchPan","touchZoom"]),this._add("touchZoom",Gn,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Ba(Le));const qn=Le.scrollZoom=new hn(Le,this);this._add("scrollZoom",qn,["mousePan"]);const Zn=Le.keyboard=new an;this._add("keyboard",Zn);for(const Oe of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])Re.interactive&&Re[Oe]&&Le[Oe].enable(Re[Oe])}_add(Re,Le,Oe){this._handlers.push({handlerName:Re,handler:Le,allowed:Oe}),this._handlersById[Re]=Le}stop(Re){if(!this._updatingCamera){for(const{handler:Re}of this._handlers)Re.reset();this._inertia.clear(),this._fireEvents({},{},Re),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:Re}of this._handlers)if(Re.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!gn(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(Re,Le,Oe){for(const Ue in Re)if(Ue!==Oe&&(!Le||Le.indexOf(Ue)<0))return!0;return!1}handleWindowEvent(Re){this.handleEvent(Re,`${Re.type}Window`)}_getMapTouches(Re){const Le=[];for(const Oe of Re)this._el.contains(Oe.target)&&Le.push(Oe);return Le}handleEvent(Re,Le){this._updatingCamera=!0;const Oe="renderFrame"===Re.type,Ue=Oe?void 0:Re,qe={needsRenderFrame:!1},Ct={},Ot={},Jt=Re.touches?this._getMapTouches(Re.touches):void 0,Hr=Jt?v(this._el,Jt):Oe?void 0:g(this._el,Re);for(const{handlerName:Oe,handler:Jr,allowed:Ln}of this._handlers){if(!Jr.isEnabled())continue;let Nn;this._blockedByActive(Ot,Ln,Oe)?Jr.reset():Jr[Le||Re.type]&&(Nn=Jr[Le||Re.type](Re,Hr,Jt),this.mergeHandlerResult(qe,Ct,Nn,Oe,Ue),Nn&&Nn.needsRenderFrame&&this._triggerRenderFrame()),(Nn||Jr.isActive())&&(Ot[Oe]=Jr)}const Jr={};for(const Re in this._previousActiveHandlers)Ot[Re]||(Jr[Re]=Ue);this._previousActiveHandlers=Ot,(Object.keys(Jr).length||yn(qe))&&(this._changes.push([qe,Ct,Jr]),this._triggerRenderFrame()),(Object.keys(Ot).length||yn(qe))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Ln}=qe;Ln&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Ln(this._map))}mergeHandlerResult(Le,Oe,Ue,qe,Ct){if(!Ue)return;Re.l(Le,Ue);const Ot={handlerName:qe,originalEvent:Ue.originalEvent||Ct};void 0!==Ue.zoomDelta&&(Oe.zoom=Ot),void 0!==Ue.panDelta&&(Oe.drag=Ot),void 0!==Ue.pitchDelta&&(Oe.pitch=Ot),void 0!==Ue.bearingDelta&&(Oe.rotate=Ot)}_applyChanges(){const Le={},Oe={},Ue={};for(const[qe,Ct,Ot]of this._changes)qe.panDelta&&(Le.panDelta=(Le.panDelta||new Re.P(0,0))._add(qe.panDelta)),qe.zoomDelta&&(Le.zoomDelta=(Le.zoomDelta||0)+qe.zoomDelta),qe.bearingDelta&&(Le.bearingDelta=(Le.bearingDelta||0)+qe.bearingDelta),qe.pitchDelta&&(Le.pitchDelta=(Le.pitchDelta||0)+qe.pitchDelta),void 0!==qe.around&&(Le.around=qe.around),void 0!==qe.aroundCoord&&(Le.aroundCoord=qe.aroundCoord),void 0!==qe.pinchAround&&(Le.pinchAround=qe.pinchAround),qe.noInertia&&(Le.noInertia=qe.noInertia),Re.l(Oe,Ct),Re.l(Ue,Ot);this._updateMapTransform(Le,Oe,Ue),this._changes=[]}_updateMapTransform(Le,Oe,Ue){const qe=this._map,Ct=qe.transform,a=Re=>[Re.x,Re.y,Re.z];if((()=>{const Re=this._eventsInProgress.drag;return Re&&!this._handlersById[Re.handlerName].isActive()})()&&!yn(Le)){const Re=Ct.zoom;Ct.cameraElevationReference="sea",null!=this._originalZoom&&Ct._orthographicProjectionAtLowPitch&&"globe"!==Ct.projection.name&&0===Ct.pitch?(Ct.cameraElevationReference="ground",Ct.zoom=this._originalZoom):(Ct.recenterOnTerrain(),Ct.cameraElevationReference="ground"),Re!==Ct.zoom&&this._map._update(!0)}if(Ct._isCameraConstrained&&qe._stop(!0),!yn(Le))return void this._fireEvents(Oe,Ue,!0);let{panDelta:Ot,zoomDelta:Jt,bearingDelta:Hr,pitchDelta:Jr,around:Ln,aroundCoord:Nn,pinchAround:$n}=Le;Ct._isCameraConstrained&&(Jt>0&&(Jt=0),Ct._isCameraConstrained=!1),void 0!==$n&&(Ln=$n),(Jt||(Re=>Oe[Re]&&!this._eventsInProgress[Re])("drag"))&&Ln&&(this._dragOrigin=a(Ct.pointCoordinate3D(Ln)),this._originalZoom=Ct.zoom,this._trackingEllipsoid.setup(Ct._camera.position,this._dragOrigin)),Ct.cameraElevationReference="sea",qe._stop(!0),Ln=Ln||qe.transform.centerPoint,Hr&&(Ct.bearing+=Hr),Jr&&(Ct.pitch+=Jr),Ct._updateCameraState();const Gn=[0,0,0];if(Ot)if("mercator"===Ct.projection.name){const Re=this._trackingEllipsoid.projectRay(Ct.screenPointToMercatorRay(Ln).dir),Le=this._trackingEllipsoid.projectRay(Ct.screenPointToMercatorRay(Ln.sub(Ot)).dir);Gn[0]=Le[0]-Re[0],Gn[1]=Le[1]-Re[1]}else{const Le=Ct.pointCoordinate(Ln);if("globe"===Ct.projection.name){Ot=Ot.rotate(-Ct.angle);const Oe=Ct._pixelsPerMercatorPixel/Ct.worldSize;Gn[0]=-Ot.x*Re.ds(Re.aM(Le.y))*Oe,Gn[1]=-Ot.y*Re.ds(Ct.center.lat)*Oe}else{const Re=Ct.pointCoordinate(Ln.sub(Ot));Le&&Re&&(Gn[0]=Re.x-Le.x,Gn[1]=Re.y-Le.y)}}const qn=Ct.zoom,Zn=[0,0,0];if(Jt){const Le=a(Nn||Ct.pointCoordinate3D(Ln)),Oe={dir:Re.a6.vec3.normalize([],Re.a6.vec3.sub([],Le,Ct._camera.position))};if(Oe.dir[2]<0){const Ue=Ct.zoomDeltaToMovement(Le,Jt);Re.a6.vec3.scale(Zn,Oe.dir,Ue)}}const Xn=Re.a6.vec3.add(Gn,Gn,Zn);Ct._translateCameraConstrained(Xn),Jt&&Math.abs(Ct.zoom-qn)>1e-4&&Ct.recenterOnTerrain(),Ct.cameraElevationReference="ground",this._map._update(),Le.noInertia||this._inertia.record(Le),this._fireEvents(Oe,Ue,!0)}_fireEvents(Le,Oe,Ue){const qe=gn(this._eventsInProgress),Ct=gn(Le),Ot={};for(const Re in Le){const{originalEvent:Oe}=Le[Re];this._eventsInProgress[Re]||(Ot[`${Re}start`]=Oe),this._eventsInProgress[Re]=Le[Re]}!qe&&Ct&&this._fireEvent("movestart",Ct.originalEvent);for(const Re in Ot)this._fireEvent(Re,Ot[Re]);Ct&&this._fireEvent("move",Ct.originalEvent);for(const Re in Le){const{originalEvent:Oe}=Le[Re];this._fireEvent(Re,Oe)}const Jt={};let Hr;for(const Re in this._eventsInProgress){const{handlerName:Le,originalEvent:Ue}=this._eventsInProgress[Re];this._handlersById[Le].isActive()||(delete this._eventsInProgress[Re],Hr=Oe[Le]||Ue,Jt[`${Re}end`]=Hr)}for(const Re in Jt)this._fireEvent(Re,Jt[Re]);const Jr=gn(this._eventsInProgress);if(Ue&&(qe||Ct)&&!Jr){this._updatingCamera=!0;const Le=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),i=Re=>0!==Re&&-this._bearingSnap<Re&&Re<this._bearingSnap;Le?(i(Le.bearing||this._map.getBearing())&&(Le.bearing=0),this._map.easeTo(Le,{originalEvent:Hr})):(this._map.fire(new Re.x("moveend",{originalEvent:Hr})),i(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(Le,Oe){this._map.fire(new Re.x(Le,Oe?{originalEvent:Oe}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((Re=>{this._frameId=void 0,this.handleEvent(new vn("renderFrame",{timeStamp:Re})),this._applyChanges()}))}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const Tp="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Tn extends Re.E{constructor(Le,Oe){super(),this._moving=!1,this._zooming=!1,this.transform=Le,this._bearingSnap=Oe.bearingSnap,this._respectPrefersReducedMotion=!1!==Oe.respectPrefersReducedMotion,Re.aJ(["_renderFrameCallback"],this)}getCenter(){return new Re.bK(this.transform.center.lng,this.transform.center.lat)}setCenter(Re,Le){return this.jumpTo({center:Re},Le)}panBy(Le,Oe,Ue){return Le=Re.P.convert(Le).mult(-1),this.panTo(this.transform.center,Re.l({offset:Le},Oe),Ue)}panTo(Le,Oe,Ue){return this.easeTo(Re.l({center:Le},Oe),Ue)}getZoom(){return this.transform.zoom}setZoom(Re,Le){return this.jumpTo({zoom:Re},Le),this}zoomTo(Le,Oe,Ue){return this.easeTo(Re.l({zoom:Le},Oe),Ue)}zoomIn(Re,Le){return this.zoomTo(this.getZoom()+1,Re,Le),this}zoomOut(Re,Le){return this.zoomTo(this.getZoom()-1,Re,Le),this}getBearing(){return this.transform.bearing}setBearing(Re,Le){return this.jumpTo({bearing:Re},Le),this}getPadding(){return this.transform.padding}setPadding(Re,Le){return this.jumpTo({padding:Re},Le),this}rotateTo(Le,Oe,Ue){return this.easeTo(Re.l({bearing:Le},Oe),Ue)}resetNorth(Le,Oe){return this.rotateTo(0,Re.l({duration:1e3},Le),Oe),this}resetNorthPitch(Le,Oe){return this.easeTo(Re.l({bearing:0,pitch:0,duration:1e3},Le),Oe),this}snapToNorth(Re,Le){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(Re,Le):this}getPitch(){return this.transform.pitch}setPitch(Re,Le){return this.jumpTo({pitch:Re},Le),this}cameraForBounds(Le,Oe){Le=Re.as.convert(Le);const Ue=Oe&&Oe.bearing||0,qe=Oe&&Oe.pitch||0,Ct=Le.getNorthWest(),Ot=Le.getSouthEast();return this._cameraForBounds(this.transform,Ct,Ot,Ue,qe,Oe)}_extendPadding(Le){const Oe={top:0,right:0,bottom:0,left:0};return null==Le?Re.l({},Oe,this.transform.padding):"number"==typeof Le?{top:Le,bottom:Le,right:Le,left:Le}:Re.l({},Oe,Le)}_extendCameraOptions(Le){return(Le=Re.l({offset:[0,0],maxZoom:this.transform.maxZoom},Le)).padding=this._extendPadding(Le.padding),Le}_minimumAABBFrustumDistance(Re,Le){const Oe=Le.max[0]-Le.min[0],Ue=Le.max[1]-Le.min[1];return Oe/Ue>Re.aspect?Oe/(2*Math.tan(.5*Re.fovX)*Re.aspect):Ue/(2*Math.tan(.5*Re.fovY)*Re.aspect)}_cameraForBoundsOnGlobe(Le,Oe,Ue,qe,Ct,Ot){const Jt=Le.clone(),Hr=this._extendCameraOptions(Ot);Jt.bearing=qe,Jt.pitch=Ct;const Jr=Re.bK.convert(Oe),Ln=Re.bK.convert(Ue),Nn=.5*(Jr.lat+Ln.lat),$n=.5*(Jr.lng+Ln.lng),Gn=Re.dt(Nn,$n),qn=Re.a6.vec3.normalize([],Gn),Zn=Re.a6.vec3.normalize([],Re.a6.vec3.cross([],qn,[0,1,0])),Xn=Re.a6.vec3.cross([],Zn,qn),Yn=[Zn[0],Zn[1],Zn[2],0,Xn[0],Xn[1],Xn[2],0,qn[0],qn[1],qn[2],0,0,0,0,1],_i=[Gn,Re.dt(Jr.lat,Jr.lng),Re.dt(Ln.lat,Jr.lng),Re.dt(Ln.lat,Ln.lng),Re.dt(Jr.lat,Ln.lng),Re.dt(Nn,Jr.lng),Re.dt(Nn,Ln.lng),Re.dt(Jr.lat,$n),Re.dt(Ln.lat,$n)];let vi=Re.c9.fromPoints(_i.map((Le=>[Re.a6.vec3.dot(Zn,Le),Re.a6.vec3.dot(Xn,Le),Re.a6.vec3.dot(qn,Le)])));const xi=Re.a6.vec3.transformMat4([],vi.center,Yn);0===Re.a6.vec3.squaredLength(xi)&&Re.a6.vec3.set(xi,0,0,1),Re.a6.vec3.normalize(xi,xi),Re.a6.vec3.scale(xi,xi,Re.aq),Jt.center=Re.du(xi);const bi=Jt.getWorldToCameraMatrix(),Pi=Re.a6.mat4.invert(new Float64Array(16),bi);vi=Re.c9.applyTransform(vi,Re.a6.mat4.multiply([],bi,Yn));const lo=this._extendAABB(vi,Jt,Hr,qe);if(!lo)return void Re.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");vi=lo,Re.a6.vec3.transformMat4(xi,xi,bi);const uo=.5*(vi.max[2]-vi.min[2]),po=this._minimumAABBFrustumDistance(Jt,vi),fo=Re.a6.vec3.scale([],[0,0,1],uo),Io=Re.a6.vec3.add(fo,xi,fo),is=po+(0===Jt.pitch?0:Re.a6.vec3.distance(xi,Io)),as=Jt.globeCenterInViewSpace,Is=Re.a6.vec3.sub([],xi,[as[0],as[1],as[2]]);Re.a6.vec3.normalize(Is,Is),Re.a6.vec3.scale(Is,Is,is);const Xs=Re.a6.vec3.add([],xi,Is);Re.a6.vec3.transformMat4(Xs,Xs,Pi);const ta=Re.dw/Re.aq,ha=Re.a6.vec3.length(Xs),el=Re.bD(Math.max(ha*ta-Re.dw,Number.EPSILON),0),tl=Math.min(Jt.zoomFromMercatorZAdjusted(el),Hr.maxZoom);return tl>.5*(Re.c2+Re.bU)?(Jt.setProjection({name:"mercator"}),Jt.zoom=tl,this._cameraForBounds(Jt,Oe,Ue,qe,Ct,Ot)):{center:Jt.center,zoom:tl,bearing:qe,pitch:Ct}}_extendAABB(Le,Oe,Ue,qe){const Ct=.5*((Ue.padding.left||0)+(Ue.padding.right||0)),Ot=.5*((Ue.padding.top||0)+(Ue.padding.bottom||0)),Jt=Ot,Hr=Ct,Jr=Ct,Ln=Ot,Nn=Oe.width-(Hr+Jr),$n=Oe.height-(Jt+Ln),Gn=Re.a6.vec3.sub([],Le.max,Le.min),qn=Math.min(Nn/Gn[0],$n/Gn[1]),Zn=Math.min(Oe.scaleZoom(Oe.scale*qn),Ue.maxZoom);if(isNaN(Zn))return null;const Xn=Oe.scale/Oe.zoomScale(Zn),Yn=new Re.c9([Le.min[0]-Hr*Xn,Le.min[1]-Ln*Xn,Le.min[2]],[Le.max[0]+Jr*Xn,Le.max[1]+Jt*Xn,Le.max[2]]),_i=("number"==typeof Ue.offset.x&&"number"==typeof Ue.offset.y?new Re.P(Ue.offset.x,Ue.offset.y):Re.P.convert(Ue.offset)).rotate(-Re.bB(qe));return Yn.center[0]-=_i.x*Xn,Yn.center[1]+=_i.y*Xn,Yn}queryTerrainElevation(Le,Oe){const Ue=this.transform.elevation;return Ue?(Oe=Re.l({},{exaggerated:!0},Oe),Ue.getAtPoint(Re.a5.fromLngLat(Le),null,Oe.exaggerated)):null}_cameraForBounds(Le,Oe,Ue,qe,Ct,Ot){if("globe"===Le.projection.name)return this._cameraForBoundsOnGlobe(Le,Oe,Ue,qe,Ct,Ot);const Jt=Le.clone(),Hr=this._extendCameraOptions(Ot);Jt.bearing=qe,Jt.pitch=Ct;const Jr=Re.bK.convert(Oe),Ln=Re.bK.convert(Ue),Nn=new Re.bK(Jr.lng,Ln.lat),$n=new Re.bK(Ln.lng,Jr.lat),Gn=Jt.project(Jr),qn=Jt.project(Ln),Zn=this.queryTerrainElevation(Jr),Xn=this.queryTerrainElevation(Ln),Yn=this.queryTerrainElevation(Nn),_i=this.queryTerrainElevation($n),vi=[[Gn.x,Gn.y,Math.min(Zn||0,Xn||0,Yn||0,_i||0)],[qn.x,qn.y,Math.max(Zn||0,Xn||0,Yn||0,_i||0)]];let xi=Re.c9.fromPoints(vi);const bi=Jt.getWorldToCameraMatrix(),Pi=Re.a6.mat4.invert(new Float64Array(16),bi);xi=Re.c9.applyTransform(xi,bi);const lo=this._extendAABB(xi,Jt,Hr,qe);if(!lo)return void Re.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");xi=lo;const uo=.5*Re.a6.vec3.sub([],xi.max,xi.min)[2],po=this._minimumAABBFrustumDistance(Jt,xi),fo=[0,0,1,0];Re.a6.vec4.transformMat4(fo,fo,bi),Re.a6.vec4.normalize(fo,fo);const Io=Re.a6.vec3.scale([],fo,po+uo),is=Re.a6.vec3.add([],xi.center,Io);Re.a6.vec3.transformMat4(xi.center,xi.center,Pi),Re.a6.vec3.transformMat4(is,is,Pi);const as=Jt.unproject(new Re.P(xi.center[0],xi.center[1])),Is=Re.dv(Jt.projection,as),Xs=Math.pow(2,Is),ta=Math.min(Jt._zoomFromMercatorZ(is[2]*Jt.pixelsPerMeter*Xs/Jt.worldSize),Hr.maxZoom);return Jt.mercatorFromTransition&&ta<.5*(Re.c2+Re.bU)?(Jt.setProjection({name:"globe"}),Jt.zoom=ta,this._cameraForBounds(Jt,Oe,Ue,qe,Ct,Ot)):{center:as,zoom:ta,bearing:qe,pitch:Ct}}fitBounds(Re,Le,Oe){const Ue=this.cameraForBounds(Re,Le);return this._fitInternal(Ue,Le,Oe)}fitScreenCoordinates(Le,Oe,Ue,qe,Ct){const Ot=Re.P.convert(Le),Jt=Re.P.convert(Oe),Hr=new Re.P(Math.min(Ot.x,Jt.x),Math.min(Ot.y,Jt.y)),Jr=new Re.P(Math.max(Ot.x,Jt.x),Math.max(Ot.y,Jt.y));if("mercator"===this.transform.projection.name&&this.transform.anyCornerOffEdge(Ot,Jt))return this;const Ln=this.transform.pointLocation3D(Hr),Nn=this.transform.pointLocation3D(Jr),$n=this.transform.pointLocation3D(new Re.P(Hr.x,Jr.y)),Gn=this.transform.pointLocation3D(new Re.P(Jr.x,Hr.y)),qn=[Math.min(Ln.lng,Nn.lng,$n.lng,Gn.lng),Math.min(Ln.lat,Nn.lat,$n.lat,Gn.lat)],Zn=[Math.max(Ln.lng,Nn.lng,$n.lng,Gn.lng),Math.max(Ln.lat,Nn.lat,$n.lat,Gn.lat)],Xn=qe&&qe.pitch?qe.pitch:this.getPitch(),Yn=this._cameraForBounds(this.transform,qn,Zn,Ue,Xn,qe);return this._fitInternal(Yn,qe,Ct)}_fitInternal(Le,Oe,Ue){return Le?(Oe=Re.l(Le,Oe)).linear?this.easeTo(Oe,Ue):this.flyTo(Oe,Ue):this}jumpTo(Le,Oe){this.stop();const Ue=Le.preloadOnly?this.transform.clone():this.transform;let qe=!1,Ct=!1,Ot=!1;"zoom"in Le&&Ue.zoom!==+Le.zoom&&(qe=!0,Ue.zoom=+Le.zoom),void 0!==Le.center&&(Ue.center=Re.bK.convert(Le.center)),"bearing"in Le&&Ue.bearing!==+Le.bearing&&(Ct=!0,Ue.bearing=+Le.bearing),"pitch"in Le&&Ue.pitch!==+Le.pitch&&(Ot=!0,Ue.pitch=+Le.pitch);const Jt="number"==typeof Le.padding?this._extendPadding(Le.padding):Le.padding;if(null!=Le.padding&&!Ue.isPaddingEqual(Jt))if(!1===Le.retainPadding){const Re=Ue.clone();Re.padding=Jt,Ue.setLocationAtPoint(Ue.center,Re.centerPoint)}else Ue.padding=Jt;return Le.preloadOnly?(this._preloadTiles(Ue),this):(this.fire(new Re.x("movestart",Oe)).fire(new Re.x("move",Oe)),qe&&this.fire(new Re.x("zoomstart",Oe)).fire(new Re.x("zoom",Oe)).fire(new Re.x("zoomend",Oe)),Ct&&this.fire(new Re.x("rotatestart",Oe)).fire(new Re.x("rotate",Oe)).fire(new Re.x("rotateend",Oe)),Ot&&this.fire(new Re.x("pitchstart",Oe)).fire(new Re.x("pitch",Oe)).fire(new Re.x("pitchend",Oe)),this.fire(new Re.x("moveend",Oe)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||Re.w(Tp),this.transform.getFreeCameraOptions()}setFreeCameraOptions(Le,Oe){const Ue=this.transform;if(!Ue.projection.supportsFreeCamera)return Re.w(Tp),this;this.stop();const qe=Ue.zoom,Ct=Ue.pitch,Ot=Ue.bearing;Ue.setFreeCameraOptions(Le);const Jt=qe!==Ue.zoom,Hr=Ct!==Ue.pitch,Jr=Ot!==Ue.bearing;return this.fire(new Re.x("movestart",Oe)).fire(new Re.x("move",Oe)),Jt&&this.fire(new Re.x("zoomstart",Oe)).fire(new Re.x("zoom",Oe)).fire(new Re.x("zoomend",Oe)),Jr&&this.fire(new Re.x("rotatestart",Oe)).fire(new Re.x("rotate",Oe)).fire(new Re.x("rotateend",Oe)),Hr&&this.fire(new Re.x("pitchstart",Oe)).fire(new Re.x("pitch",Oe)).fire(new Re.x("pitchend",Oe)),this.fire(new Re.x("moveend",Oe)),this}easeTo(Le,Oe){this._stop(!1,Le.easeId),(!1===(Le=Re.l({offset:[0,0],duration:500,easing:Re.dr},Le)).animate||this._prefersReducedMotion(Le))&&(Le.duration=0);const Ue=this.transform,qe=this.getZoom(),Ct=this.getBearing(),Ot=this.getPitch(),Jt=this.getPadding(),Hr="zoom"in Le?+Le.zoom:qe,Jr="bearing"in Le?this._normalizeBearing(Le.bearing,Ct):Ct,Ln="pitch"in Le?+Le.pitch:Ot,Nn=this._extendPadding(Le.padding),$n=Re.P.convert(Le.offset);let Gn,qn,Zn;if("globe"===Ue.projection.name){const Oe=Re.a5.fromLngLat(Ue.center),qe=$n.rotate(-Ue.angle);Oe.x+=qe.x/Ue.worldSize,Oe.y+=qe.y/Ue.worldSize;const Ct=Oe.toLngLat(),Ot=Re.bK.convert(Le.center||Ct);this._normalizeCenter(Ot),Gn=Ue.centerPoint.add(qe),qn=new Re.P(Oe.x,Oe.y).mult(Ue.worldSize),Zn=new Re.P(Re.am(Ot.lng),Re.at(Ot.lat)).mult(Ue.worldSize).sub(qn)}else{Gn=Ue.centerPoint.add($n);const Oe=Ue.pointLocation(Gn),qe=Re.bK.convert(Le.center||Oe);this._normalizeCenter(qe),qn=Ue.project(Oe),Zn=Ue.project(qe).sub(qn)}const Xn=Ue.zoomScale(Hr-qe);let Yn,_i;Le.around&&(Yn=Re.bK.convert(Le.around),_i=Ue.locationPoint(Yn));const vi=this._zooming||Hr!==qe,xi=this._rotating||Ct!==Jr,bi=this._pitching||Ln!==Ot,Pi=!Ue.isPaddingEqual(Nn),lo=!1===Le.retainPadding?Ue.clone():Ue,E=Ue=>uo=>{if(vi&&(Ue.zoom=Re.aa(qe,Hr,uo)),xi&&(Ue.bearing=Re.aa(Ct,Jr,uo)),bi&&(Ue.pitch=Re.aa(Ot,Ln,uo)),Pi&&(lo.interpolatePadding(Jt,Nn,uo),Gn=lo.centerPoint.add($n)),Yn)Ue.setLocationAtPoint(Yn,_i);else{const Re=Ue.zoomScale(Ue.zoom-qe),Le=Hr>qe?Math.min(2,Xn):Math.max(.5,Xn),Oe=Math.pow(Le,1-uo),Ct=Ue.unproject(qn.add(Zn.mult(uo*Oe)).mult(Re));Ue.setLocationAtPoint(Ue.renderWorldCopies?Ct.wrap():Ct,Gn)}return Le.preloadOnly||this._fireMoveEvents(Oe),Ue};if(Le.preloadOnly){const Re=this._emulate(E,Le.duration,Ue);return this._preloadTiles(Re),this}const uo={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=vi,this._rotating=xi,this._pitching=bi,this._padding=Pi,this._easeId=Le.easeId,this._prepareEase(Oe,Le.noMoveStart,uo),this._ease(E(Ue),(Re=>{"sea"===Ue.cameraElevationReference&&Ue.recenterOnTerrain(),this._afterEase(Oe,Re)}),Le),this}_prepareEase(Le,Oe,Ue={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&0===this.transform.pitch&&"globe"!==this.transform.projection.name&&(this.transform.cameraElevationReference="ground"),Oe||Ue.moving||this.fire(new Re.x("movestart",Le)),this._zooming&&!Ue.zooming&&this.fire(new Re.x("zoomstart",Le)),this._rotating&&!Ue.rotating&&this.fire(new Re.x("rotatestart",Le)),this._pitching&&!Ue.pitching&&this.fire(new Re.x("pitchstart",Le))}_fireMoveEvents(Le){this.fire(new Re.x("move",Le)),this._zooming&&this.fire(new Re.x("zoom",Le)),this._rotating&&this.fire(new Re.x("rotate",Le)),this._pitching&&this.fire(new Re.x("pitch",Le))}_afterEase(Le,Oe){if(this._easeId&&Oe&&this._easeId===Oe)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const Ue=this._zooming,qe=this._rotating,Ct=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,Ue&&this.fire(new Re.x("zoomend",Le)),qe&&this.fire(new Re.x("rotateend",Le)),Ct&&this.fire(new Re.x("pitchend",Le)),this.fire(new Re.x("moveend",Le))}flyTo(Le,Oe){if(this._prefersReducedMotion(Le)){const Ue=Re.ar(Le,["center","zoom","bearing","pitch","around","padding","retainPadding"]);return this.jumpTo(Ue,Oe)}this.stop(),Le=Re.l({offset:[0,0],speed:1.2,curve:1.42,easing:Re.dr},Le);const Ue=this.transform,qe=this.getZoom(),Ct=this.getBearing(),Ot=this.getPitch(),Jt=this.getPadding(),Hr="zoom"in Le?Re.ap(+Le.zoom,Ue.minZoom,Ue.maxZoom):qe,Jr="bearing"in Le?this._normalizeBearing(Le.bearing,Ct):Ct,Ln="pitch"in Le?+Le.pitch:Ot,Nn=this._extendPadding(Le.padding),$n=Ue.zoomScale(Hr-qe),Gn=Re.P.convert(Le.offset);let qn=Ue.centerPoint.add(Gn);const Zn=Ue.pointLocation(qn),Xn=Re.bK.convert(Le.center||Zn);this._normalizeCenter(Xn);const Yn=Ue.project(Zn),_i=Ue.project(Xn).sub(Yn);let vi=Le.curve;const xi=Math.max(Ue.width,Ue.height),bi=xi/$n,Pi=_i.mag();if("minZoom"in Le){const Oe=Re.ap(Math.min(Le.minZoom,qe,Hr),Ue.minZoom,Ue.maxZoom),Ct=xi/Ue.zoomScale(Oe-qe);vi=Math.sqrt(Ct/Pi*2)}const lo=vi*vi;function E(Re){const Le=(bi*bi-xi*xi+(Re?-1:1)*lo*lo*Pi*Pi)/(2*(Re?bi:xi)*lo*Pi);return Math.log(Math.sqrt(Le*Le+1)-Le)}function C(Re){return(Math.exp(Re)-Math.exp(-Re))/2}function S(Re){return(Math.exp(Re)+Math.exp(-Re))/2}const uo=E(0);let D=function(Re){return S(uo)/S(uo+vi*Re)},R=function(Re){return xi*((S(uo)*(C(Le=uo+vi*Re)/S(Le))-C(uo))/lo)/Pi;var Le},po=(E(1)-uo)/vi;if(Math.abs(Pi)<1e-6||!isFinite(po)){if(Math.abs(xi-bi)<1e-6)return this.easeTo(Le,Oe);const Re=bi<xi?-1:1;po=Math.abs(Math.log(bi/xi))/vi,R=function(){return 0},D=function(Le){return Math.exp(Re*vi*Le)}}Le.duration="duration"in Le?+Le.duration:1e3*po/("screenSpeed"in Le?+Le.screenSpeed/vi:+Le.speed),Le.maxDuration&&Le.duration>Le.maxDuration&&(Le.duration=0);const fo=Ct!==Jr,Io=Ln!==Ot,is=!Ue.isPaddingEqual(Nn),as=!1===Le.retainPadding?Ue.clone():Ue,O=Ue=>$n=>{const Zn=$n*po,vi=1/D(Zn);Ue.zoom=1===$n?Hr:qe+Ue.scaleZoom(vi),fo&&(Ue.bearing=Re.aa(Ct,Jr,$n)),Io&&(Ue.pitch=Re.aa(Ot,Ln,$n)),is&&(as.interpolatePadding(Jt,Nn,$n),qn=as.centerPoint.add(Gn));const xi=1===$n?Xn:Ue.unproject(Yn.add(_i.mult(R(Zn))).mult(vi));return Ue.setLocationAtPoint(Ue.renderWorldCopies?xi.wrap():xi,qn),Ue._updateCameraOnTerrain(),Le.preloadOnly||this._fireMoveEvents(Oe),Ue};if(Le.preloadOnly){const Re=this._emulate(O,Le.duration,Ue);return this._preloadTiles(Re),this}return this._zooming=!0,this._rotating=fo,this._pitching=Io,this._padding=is,this._prepareEase(Oe,!1),this._ease(O(Ue),(()=>this._afterEase(Oe)),Le),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(Re){}_cancelRenderFrame(Re){}_stop(Re,Le){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const Re=this._onEaseEnd;this._onEaseEnd=void 0,Re.call(this,Le)}if(!Re){const Re=this.handlers;Re&&Re.stop(!1)}return this}_ease(Le,Oe,Ue){!1===Ue.animate||0===Ue.duration?(Le(1),Oe()):(this._easeStart=Re.q.now(),this._easeOptions=Ue,this._onEaseFrame=Le,this._onEaseEnd=Oe,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const Le=Math.min((Re.q.now()-this._easeStart)/this._easeOptions.duration,1),Oe=this._onEaseFrame;Oe&&Oe(this._easeOptions.easing(Le)),Le<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(Le,Oe){Le=Re.bA(Le,-180,180);const Ue=Math.abs(Le-Oe);return Math.abs(Le-360-Oe)<Ue&&(Le-=360),Math.abs(Le+360-Oe)<Ue&&(Le+=360),Le}_normalizeCenter(Re){const Le=this.transform;if(Le.maxBounds)return;if("globe"!==Le.projection.name&&!Le.renderWorldCopies)return;const Oe=Re.lng-Le.center.lng;Re.lng+=Oe>180?-360:Oe<-180?360:0}_prefersReducedMotion(Le){return this._respectPrefersReducedMotion&&Re.q.prefersReducedMotion&&!(Le&&Le.essential)}_emulate(Re,Le,Oe){const Ue=Math.ceil(15*Le/1e3),qe=[],Ct=Re(Oe.clone());for(let Re=0;Re<=Ue;Re++){const Le=Ct(Re/Ue);qe.push(Le.clone())}return qe}_preloadTiles(Re,Le){}}class En{constructor(Le={}){this.options=Le,Re.aJ(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(Re){const Le=this.options&&this.options.compact,Oe=Re._getUIString("AttributionControl.ToggleAttribution");this._map=Re,this._container=l("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=l("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.setAttribute("aria-label",Oe);const Ue=l("span","mapboxgl-ctrl-icon",this._compactButton);return Ue.setAttribute("aria-hidden","true"),Ue.setAttribute("title",Oe),this._innerContainer=l("div","mapboxgl-ctrl-attrib-inner",this._container),Le&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===Le&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let Le=this._editLink;Le||(Le=this._editLink=this._container.querySelector(".mapbox-improve-map"));const Oe=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||Re.e.ACCESS_TOKEN}];if(Le){const Ue=Oe.reduce(((Re,Le,Ue)=>(Le.value&&(Re+=`${Le.key}=${Le.value}${Ue<Oe.length-1?"&":""}`),Re)),"?");Le.href=`${Re.e.FEEDBACK_URL}/${Ue}#${Ca(this._map,!0)}`,Le.rel="noopener nofollow"}}_updateData(Re){!Re||"metadata"!==Re.sourceDataType&&"visibility"!==Re.sourceDataType&&"style"!==Re.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let Re=[];if(this._map.style.stylesheet){const Re=this._map.style.stylesheet;this.styleOwner=Re.owner,this.styleId=Re.id}const Le=this._map.style._mergedSourceCaches;for(const Oe in Le){const Ue=Le[Oe];if(Ue.used){const Le=Ue.getSource();Le.attribution&&Re.indexOf(Le.attribution)<0&&Re.push(Le.attribution)}}Re.sort(((Re,Le)=>Re.length-Le.length)),Re=Re.filter(((Le,Oe)=>{for(let Ue=Oe+1;Ue<Re.length;Ue++)if(Re[Ue].indexOf(Le)>=0)return!1;return!0})),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?Re=[...this.options.customAttribution,...Re]:Re.unshift(this.options.customAttribution));const Oe=Re.join(" | ");Oe!==this._attribHTML&&(this._attribHTML=Oe,Re.length?(this._innerContainer.innerHTML=Oe,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Cn{constructor(){Re.aJ(["_updateLogo","_updateCompact"],this)}onAdd(Re){this._map=Re,this._container=l("div","mapboxgl-ctrl");const Le=l("a","mapboxgl-ctrl-logo");return Le.target="_blank",Le.rel="noopener nofollow",Le.href="https://www.mapbox.com/",Le.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),Le.setAttribute("rel","noopener nofollow"),this._container.appendChild(Le),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(Re){Re&&"metadata"!==Re.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const Re=this._map.style._sourceCaches;if(0===Object.entries(Re).length)return!0;for(const Le in Re){const Oe=Re[Le].getSource();if(Oe.hasOwnProperty("mapbox_logo")&&!Oe.mapbox_logo)return!1}return!0}_updateCompact(){const Re=this._container.children;if(Re.length){const Le=Re[0];this._map.getCanvasContainer().offsetWidth<250?Le.classList.add("mapboxgl-compact"):Le.classList.remove("mapboxgl-compact")}}}class Sn{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(Re){const Le=++this._id;return this._queue.push({callback:Re,id:Le,cancelled:!1}),Le}remove(Re){const Le=this._currentlyRunning,Oe=Le?this._queue.concat(Le):this._queue;for(const Le of Oe)if(Le.id===Re)return void(Le.cancelled=!0)}run(Re=0){const Le=this._currentlyRunning=this._queue;this._queue=[];for(const Oe of Le)if(!Oe.cancelled&&(Oe.callback(Re),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}class In{constructor(Re){this.jumpTo(Re)}getValue(Le){if(Le<=this._startTime)return this._start;if(Le>=this._endTime)return this._end;const Oe=Re.cw((Le-this._startTime)/(this._endTime-this._startTime));return this._start*(1-Oe)+this._end*Oe}isEasing(Re){return Re>=this._startTime&&Re<=this._endTime}jumpTo(Re){this._startTime=-1/0,this._endTime=-1/0,this._start=Re,this._end=Re}easeTo(Re,Le,Oe){this._start=this.getValue(Le),this._end=Re,this._startTime=Le,this._endTime=Le+Oe}}const Ap={"AttributionControl.ToggleAttribution":"Toggle attribution","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox homepage","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use ⌘ + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"};class Rn{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}class An{constructor(Re){this.map=Re,this.interactionsByType=new Map,this.typeById=new Map,this.filters=new Map,this.handleType=this.handleType.bind(this)}add(Le,Oe){if(this.typeById.has(Le))throw new Error(`Interaction id "${Le}" already exists.`);const{type:Ue,filter:qe}=Oe;if(qe){const Oe=Re.M(qe,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===Oe.result)throw new Error(Oe.value.map((Re=>`${Re.key}: ${Re.message}`)).join(", "));this.filters.set(Le,Oe.value)}const Ct=this.interactionsByType.get(Ue)||new Map;0===Ct.size&&(this.map.on(Ue,this.handleType),this.interactionsByType.set(Ue,Ct)),Ct.set(Le,Oe),this.typeById.set(Le,Ue)}remove(Re){const Le=this.typeById.get(Re);if(!Le)return;this.typeById.delete(Re),this.filters.delete(Re);const Oe=this.interactionsByType.get(Le);Oe&&(Oe.delete(Re),0===Oe.size&&this.map.off(Le,this.handleType))}handleType(Re){const Le=Re.features||this.map.queryRenderedFeatures(Re.point);if(!Le)return;const Oe=this.interactionsByType.get(Re.type),Ue={zoom:0};for(const[Re,qe]of Oe){const Oe=this.filters.get(Re),{handler:Ct,layers:Ot}=qe;for(const Jt of Le)if((!Ot||Ot.includes(Jt.layer.id))&&(!Oe||Oe.evaluate(Ue,Jt))&&!1!==Ct({id:Re,feature:Jt,interaction:qe}))break}}}const Mp={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1,precompilePrograms:!0},Rp={showCompass:!0,showZoom:!0,visualizePitch:!1};class Mn{constructor(Le,Oe,Ue=!1){this._clickTolerance=10,this.element=Oe,this.mouseRotate=new Wa({clickTolerance:Le.dragRotate._mouseRotate._clickTolerance}),this.map=Le,Ue&&(this.mousePitch=new $a({clickTolerance:Le.dragRotate._mousePitch._clickTolerance})),Re.aJ(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),Oe.addEventListener("mousedown",this.mousedown),Oe.addEventListener("touchstart",this.touchstart,{passive:!1}),Oe.addEventListener("touchmove",this.touchmove),Oe.addEventListener("touchend",this.touchend),Oe.addEventListener("touchcancel",this.reset)}down(Re,Le){this.mouseRotate.mousedown(Re,Le),this.mousePitch&&this.mousePitch.mousedown(Re,Le),_()}move(Re,Le){const Oe=this.map,Ue=this.mouseRotate.mousemoveWindow(Re,Le),qe=Ue&&Ue.bearingDelta;if(qe&&Oe.setBearing(Oe.getBearing()+qe),this.mousePitch){const Ue=this.mousePitch.mousemoveWindow(Re,Le),qe=Ue&&Ue.pitchDelta;qe&&Oe.setPitch(Oe.getPitch()+qe)}}off(){const Re=this.element;Re.removeEventListener("mousedown",this.mousedown),Re.removeEventListener("touchstart",this.touchstart,{passive:!1}),Re.removeEventListener("touchmove",this.touchmove),Re.removeEventListener("touchend",this.touchend),Re.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){p(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(Le){this.down(Re.l({},Le,{ctrlKey:!0,preventDefault:()=>Le.preventDefault()}),g(this.element,Le)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(Re){this.move(Re,g(this.element,Re))}mouseup(Re){this.mouseRotate.mouseupWindow(Re),this.mousePitch&&this.mousePitch.mouseupWindow(Re),this.offTemp()}touchstart(Re){1!==Re.targetTouches.length?this.reset():(this._startPos=this._lastPos=v(this.element,Re.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>Re.preventDefault()},this._startPos))}touchmove(Re){1!==Re.targetTouches.length?this.reset():(this._lastPos=v(this.element,Re.targetTouches)[0],this.move({preventDefault:()=>Re.preventDefault()},this._lastPos))}touchend(Re){0===Re.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function zn(Le,Oe,Ue){if(Le=new Re.bK(Le.lng,Le.lat),Oe){const qe=new Re.bK(Le.lng-360,Le.lat),Ct=new Re.bK(Le.lng+360,Le.lat),Ot=360*Math.ceil(Math.abs(Le.lng-Ue.center.lng)/360),Jt=Ue.locationPoint(Le).distSqr(Oe),Hr=Oe.x<0||Oe.y<0||Oe.x>Ue.width||Oe.y>Ue.height;Ue.locationPoint(qe).distSqr(Oe)<Jt&&(Hr||Math.abs(qe.lng-Ue.center.lng)<Ot)?Le=qe:Ue.locationPoint(Ct).distSqr(Oe)<Jt&&(Hr||Math.abs(Ct.lng-Ue.center.lng)<Ot)&&(Le=Ct)}for(;Math.abs(Le.lng-Ue.center.lng)>180;){const Re=Ue.locationPoint(Le);if(Re.x>=0&&Re.y>=0&&Re.x<=Ue.width&&Re.y<=Ue.height)break;Le.lng>Ue.center.lng?Le.lng-=360:Le.lng+=360}return Le}const Lp={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Fn extends Re.E{constructor(Le,Oe){if(super(),(Le instanceof HTMLElement||Oe)&&(Le=Re.l({element:Le},Oe)),Re.aJ(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=Le&&Le.anchor||"center",this._color=Le&&Le.color||"#3FB1CE",this._scale=Le&&Le.scale||1,this._draggable=Le&&Le.draggable||!1,this._clickTolerance=Le&&Le.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=Le&&Le.rotation||0,this._rotationAlignment=Le&&Le.rotationAlignment||"auto",this._pitchAlignment=Le&&Le.pitchAlignment&&Le.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=Le&&Le.occludedOpacity||.2,Le&&Le.element)this._element=Le.element,this._offset=Re.P.convert(Le&&Le.offset||[0,0]);else{this._defaultMarker=!0,this._element=l("div");const Oe=41,Ue=27,qe=c("svg",{display:"block",height:Oe*this._scale+"px",width:Ue*this._scale+"px",viewBox:`0 0 ${Ue} ${Oe}`},this._element),Ct=c("radialGradient",{id:"shadowGradient"},c("defs",{},qe));c("stop",{offset:"10%","stop-opacity":.4},Ct),c("stop",{offset:"100%","stop-opacity":.05},Ct),c("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},qe),c("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},qe),c("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},qe),c("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},qe),this._offset=Re.P.convert(Le&&Le.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",(Re=>{Re.preventDefault()})),this._element.addEventListener("mousedown",(Re=>{Re.preventDefault()}));const Ue=this._element.classList;for(const Re in Lp)Ue.remove(`mapboxgl-marker-anchor-${Re}`);Ue.add(`mapboxgl-marker-anchor-${this._anchor}`);const qe=Le&&Le.className?Le.className.trim().split(/\s+/):[];Ue.add(...qe),this._popup=null}addTo(Re){return Re===this._map||(this.remove(),this._map=Re,Re.getCanvasContainer().appendChild(this._element),Re.on("move",this._updateMoving),Re.on("moveend",this._update),Re.on("remove",this._clearFadeTimer),Re._addMarker(this),this.setDraggable(this._draggable),this._update(),Re.on("click",this._onMapClick)),this}remove(){const Re=this._map;return Re&&(Re.off("click",this._onMapClick),Re.off("move",this._updateMoving),Re.off("moveend",this._update),Re.off("mousedown",this._addDragHandler),Re.off("touchstart",this._addDragHandler),Re.off("mouseup",this._onUp),Re.off("touchend",this._onUp),Re.off("mousemove",this._onMove),Re.off("touchmove",this._onMove),Re.off("remove",this._clearFadeTimer),Re._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(Le){return this._lngLat=Re.bK.convert(Le),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(Re){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),Re){if(!("offset"in Re.options)){const Le=38.1,Oe=13.5,Ue=Math.sqrt(Math.pow(Oe,2)/2);Re.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-Le],"bottom-left":[Ue,-1*(Le-Oe+Ue)],"bottom-right":[-Ue,-1*(Le-Oe+Ue)],left:[Oe,-1*(Le-Oe)],right:[-Oe,-1*(Le-Oe)]}:this._offset}this._popup=Re,Re._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(Re){const Le=Re.code,Oe=Re.charCode||Re.keyCode;"Space"!==Le&&"Enter"!==Le&&32!==Oe&&13!==Oe||this.togglePopup()}_onMapClick(Re){const Le=Re.originalEvent.target,Oe=this._element;this._popup&&(Le===Oe||Oe.contains(Le))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const Re=this._popup;return Re?(Re.isOpen()?(Re.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(Re.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const Re=this._map,Le=this._pos;if(!Re||!Le)return!1;const Oe=Re.unproject(Le),Ue=Re.getFreeCameraOptions();if(!Ue.position)return!1;const qe=Ue.position.toLngLat();return qe.distanceTo(Oe)<.9*qe.distanceTo(this._lngLat)}_evaluateOpacity(){const Le=this._map;if(!Le)return;const Oe=this._pos;if(!Oe||Oe.x<0||Oe.x>Le.transform.width||Oe.y<0||Oe.y>Le.transform.height)return void this._clearFadeTimer();const Ue=Le.unproject(Oe);let qe;Le._showingGlobe()&&Re.dz(Le.transform,this._lngLat)?qe=0:(qe=1-Le._queryFogOpacity(Ue),Le.transform._terrainEnabled()&&Le.getTerrain()&&this._behindTerrain()&&(qe*=this._occludedOpacity)),this._element.style.opacity=`${qe}`,this._element.style.pointerEvents=qe>0?"auto":"none",this._popup&&this._popup._setOpacity(qe),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const Re=this._pos;if(!Re||!this._map)return;const Le=this._offset.mult(this._scale);this._element.style.transform=`\n            translate(${Re.x}px,${Re.y}px)\n            ${Lp[this._anchor]}\n            ${this._calculateXYTransform()} ${this._calculateZTransform()}\n            translate(${Le.x}px,${Le.y}px)\n        `}_calculateXYTransform(){const Le=this._pos,Oe=this._map,Ue=this.getPitchAlignment();if(!Oe||!Le||"map"!==Ue)return"";if(!Oe._showingGlobe()){const Re=Oe.getPitch();return Re?`rotateX(${Re}deg)`:""}const qe=Re.c0(Re.dA(Oe.transform,this._lngLat)),Ct=Le.sub(Re.dB(Oe.transform)),Ot=Math.abs(Ct.x)+Math.abs(Ct.y);if(0===Ot)return"";const Jt=qe/Ot;return`rotateX(${-Ct.y*Jt}deg) rotateY(${Ct.x*Jt}deg)`}_calculateZTransform(){const Le=this._pos,Oe=this._map;if(!Oe||!Le)return"";let Ue=0;const qe=this.getRotationAlignment();if("map"===qe)if(Oe._showingGlobe()){const Le=Oe.project(new Re.bK(this._lngLat.lng,this._lngLat.lat+.001)),qe=Oe.project(new Re.bK(this._lngLat.lng,this._lngLat.lat-.001)).sub(Le);Ue=Re.c0(Math.atan2(qe.y,qe.x))-90}else Ue=-Oe.getBearing();else if("horizon"===qe){const qe=Re.a7(4,6,Oe.getZoom()),Ct=Re.dB(Oe.transform);Ct.y+=qe*Oe.transform.height;const Ot=Le.sub(Ct),Jt=Re.c0(Math.atan2(Ot.y,Ot.x));Ue=(Jt>90?Jt-270:Jt+90)*(1-qe)}return Ue+=this._rotation,Ue?`rotateZ(${Ue}deg)`:""}_update(Re){cancelAnimationFrame(this._updateFrameId);const Le=this._map;Le&&(Le.transform.renderWorldCopies&&(this._lngLat=zn(this._lngLat,this._pos,Le.transform)),this._pos=Le.project(this._lngLat),!0===Re?this._updateFrameId=requestAnimationFrame((()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())})):this._pos=this._pos.round(),Le._requestDomTask((()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(Le._showingGlobe()||Le.getTerrain()||Le.getFog())&&!this._fadeTimer&&(this._fadeTimer=window.setTimeout(this._evaluateOpacity.bind(this),60)))})))}getOffset(){return this._offset}setOffset(Le){return this._offset=Re.P.convert(Le),this._update(),this}addClassName(Re){return this._element.classList.add(Re),this}removeClassName(Re){return this._element.classList.remove(Re),this}toggleClassName(Re){return this._element.classList.toggle(Re)}_onMove(Le){const Oe=this._map;if(!Oe)return;const Ue=this._pointerdownPos,qe=this._positionDelta;if(Ue&&qe){if(!this._isDragging){const Re=this._clickTolerance||Oe._clickTolerance;if(Le.point.dist(Ue)<Re)return;this._isDragging=!0}this._pos=Le.point.sub(qe),this._lngLat=Oe.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new Re.x("dragstart"))),this.fire(new Re.x("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const Le=this._map;Le&&(Le.off("mousemove",this._onMove),Le.off("touchmove",this._onMove)),"active"===this._state&&this.fire(new Re.x("dragend")),this._state="inactive"}_addDragHandler(Re){const Le=this._map,Oe=this._pos;Le&&Oe&&this._element.contains(Re.originalEvent.target)&&(Re.preventDefault(),this._positionDelta=Re.point.sub(Oe),this._pointerdownPos=Re.point,this._state="pending",Le.on("mousemove",this._onMove),Le.on("touchmove",this._onMove),Le.once("mouseup",this._onUp),Le.once("touchend",this._onUp))}setDraggable(Re){this._draggable=!!Re;const Le=this._map;return Le&&(Re?(Le.on("mousedown",this._addDragHandler),Le.on("touchstart",this._addDragHandler)):(Le.off("mousedown",this._addDragHandler),Le.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(Re){return this._rotation=Re||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(Re){return this._rotationAlignment=Re||"auto",this._update(),this}getRotationAlignment(){return"auto"===this._rotationAlignment||"horizon"===this._rotationAlignment&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(Re){return this._pitchAlignment=Re||"auto",this._update(),this}getPitchAlignment(){return"auto"===this._pitchAlignment?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(Re){return this._occludedOpacity=Re||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Op={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Dp={maxWidth:100,unit:"metric"},Fp={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},Np={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},jp=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function jn(Le=new Re.P(0,0),Oe="bottom"){if("number"==typeof Le){const Ue=Math.round(Math.sqrt(.5*Math.pow(Le,2)));switch(Oe){case"top":return new Re.P(0,Le);case"top-left":return new Re.P(Ue,Ue);case"top-right":return new Re.P(-Ue,Ue);case"bottom":return new Re.P(0,-Le);case"bottom-left":return new Re.P(Ue,-Ue);case"bottom-right":return new Re.P(-Ue,-Ue);case"left":return new Re.P(Le,0);case"right":return new Re.P(-Le,0)}return new Re.P(0,0)}return Le instanceof Re.P||Array.isArray(Le)?Re.P.convert(Le):Re.P.convert(Le[Oe]||[0,0])}return{version:Le,supported:Ot.supported,setRTLTextPlugin:Re.dC,getRTLTextPluginStatus:Re.dD,Map:class extends Tn{constructor(Le){Ue.mark(Oe.create);const qe=Le;if(null!=(Le=Re.l({},Mp,Le)).minZoom&&null!=Le.maxZoom&&Le.minZoom>Le.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=Le.minPitch&&null!=Le.maxPitch&&Le.minPitch>Le.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=Le.minPitch&&Le.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=Le.maxPitch&&Le.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(Le.antialias&&Re.dx(window)&&(Le.antialias=!1,Re.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Hi(Le.minZoom,Le.maxZoom,Le.minPitch,Le.maxPitch,Le.renderWorldCopies),Le),this._repaint=!!Le.repaint,this._interactive=Le.interactive,this._minTileCacheSize=Le.minTileCacheSize,this._maxTileCacheSize=Le.maxTileCacheSize,this._failIfMajorPerformanceCaveat=Le.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=Le.preserveDrawingBuffer,this._antialias=Le.antialias,this._trackResize=Le.trackResize,this._bearingSnap=Le.bearingSnap,this._refreshExpiredTiles=Le.refreshExpiredTiles,this._fadeDuration=Le.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=Le.crossSourceCollisions,this._collectResourceTiming=Le.collectResourceTiming,this._language=this._parseLanguage(Le.language),this._worldview=Le.worldview,this._renderTaskQueue=new Sn,this._domRenderTaskQueue=new Sn,this._controls=[],this._markers=[],this._popups=[],this._mapId=Re.aP(),this._locale=Re.l({},Ap,Le.locale),this._clickTolerance=Le.clickTolerance,this._cooperativeGestures=Le.cooperativeGestures,this._performanceMetricsCollection=Le.performanceMetricsCollection,this._tessellationStep=Le.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._precompilePrograms=Le.precompilePrograms,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new In(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._requestManager=new T(Le.transformRequest,Le.accessToken,Le.testMode),this._silenceAuthErrors=!!Le.testMode,this._contextCreateOptions=Le.contextCreateOptions?{...Le.contextCreateOptions}:{},"string"==typeof Le.container){const Re=document.getElementById(Le.container);if(!Re)throw new Error(`Container '${Le.container.toString()}' not found.`);this._container=Re}else{if(!(Le.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=Le.container}if(this._container.childNodes.length>0&&Re.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),Le.maxBounds&&this.setMaxBounds(Le.maxBounds),Re.aJ(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new Rn),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},(()=>{this._update()})),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");if(this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new bn(this,Le),this._localFontFamily=Le.localFontFamily,this._localIdeographFontFamily=Le.localIdeographFontFamily,(Le.style||!Le.testMode)&&this.setStyle(Le.style||Re.e.DEFAULT_STYLE,{config:Le.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),Le.projection&&this.setProjection(Le.projection),Le.hash&&(this._hash=new Ea("string"==typeof Le.hash&&Le.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){null==qe.center&&null==qe.zoom||(this.transform._unmodified=!1),this.jumpTo({center:Le.center,zoom:Le.zoom,bearing:Le.bearing,pitch:Le.pitch});const Oe=Le.bounds;Oe&&(this.resize(),this.fitBounds(Oe,Re.l({},Le.fitBoundsOptions,{duration:0})))}this.resize(),Le.attributionControl&&this.addControl(new En({customAttribution:Le.customAttribution})),this._logoControl=new Cn,this.addControl(this._logoControl,Le.logoPosition),this.on("style.load",(()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()})),this.on("data",(Le=>{this._update("style"===Le.dataType),this.fire(new Re.x(`${Le.dataType}data`,Le))})),this.on("dataloading",(Le=>{this.fire(new Re.x(`${Le.dataType}dataloading`,Le))})),this._interactions=new An(this)}_getMapId(){return this._mapId}addControl(Le,Oe){if(void 0===Oe&&(Oe=Le.getDefaultPosition?Le.getDefaultPosition():"top-right"),!Le||!Le.onAdd)return this.fire(new Re.t(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const Ue=Le.onAdd(this);this._controls.push(Le);const qe=this._controlPositions[Oe];return-1!==Oe.indexOf("bottom")?qe.insertBefore(Ue,qe.firstChild):qe.appendChild(Ue),this}removeControl(Le){if(!Le||!Le.onRemove)return this.fire(new Re.t(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const Oe=this._controls.indexOf(Le);return Oe>-1&&this._controls.splice(Oe,1),Le.onRemove(this),this}hasControl(Re){return this._controls.indexOf(Re)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(Le){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const Oe=!this._moving;return Oe&&this.fire(new Re.x("movestart",Le)).fire(new Re.x("move",Le)),this.fire(new Re.x("resize",Le)),Oe&&this.fire(new Re.x("moveend",Le)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(Le){return this.transform.setMaxBounds(Re.as.convert(Le)),this._update()}setMinZoom(Le){if((Le=Le??-2)>=-2&&Le<=this.transform.maxZoom)return this.transform.minZoom=Le,this._update(),this.getZoom()<Le?this.setZoom(Le):this.fire(new Re.x("zoomstart")).fire(new Re.x("zoom")).fire(new Re.x("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(Le){if((Le=Le??22)>=this.transform.minZoom)return this.transform.maxZoom=Le,this._update(),this.getZoom()>Le?this.setZoom(Le):this.fire(new Re.x("zoomstart")).fire(new Re.x("zoom")).fire(new Re.x("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(Le){if((Le=Le??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(Le>=0&&Le<=this.transform.maxPitch)return this.transform.minPitch=Le,this._update(),this.getPitch()<Le?this.setPitch(Le):this.fire(new Re.x("pitchstart")).fire(new Re.x("pitch")).fire(new Re.x("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(Le){if((Le=Le??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(Le>=this.transform.minPitch)return this.transform.maxPitch=Le,this._update(),this.getPitch()>Le?this.setPitch(Le):this.fire(new Re.x("pitchstart")).fire(new Re.x("pitch")).fire(new Re.x("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(Re){return this.transform.renderWorldCopies=Re,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(Re){return"auto"===Re?navigator.language:Array.isArray(Re)?0===Re.length?void 0:Re.map((Re=>"auto"===Re?navigator.language:Re)):Re}setLanguage(Re){const Le=this._parseLanguage(Re);if(!this.style||Le===this._language)return this;this._language=Le,this.style.reloadSources();for(const Re of this._controls)Re._setLanguage&&Re._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(Re){return this.style&&Re!==this._worldview?(this._worldview=Re,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return"globe"===this.transform.projection.name}setProjection(Re){return this._lazyInitEmptyStyle(),Re?"string"==typeof Re&&(Re={name:Re}):Re=null,this._useExplicitProjection=!!Re,this._prioritizeAndUpdateProjection(Re,this.style.projection)}_updateProjectionTransition(){if("globe"!==this.getProjection().name)return;const Le=this.transform,Oe=Le.projection.name;let Ue;"globe"===Oe&&Le.zoom>=Re.bU?(Le.setMercatorFromTransition(),Ue=!0):"mercator"===Oe&&Le.zoom<Re.bU&&(Le.setProjection({name:"globe"}),Ue=!0),Ue&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(Re,Le){return this._updateProjection(Re||Le||{name:"mercator"})}_updateProjection(Le){let Oe;return Oe="globe"===Le.name&&this.transform.zoom>=Re.bU?this.transform.setMercatorFromTransition():this.transform.setProjection(Le),this.style.applyProjectionUpdate(),Oe&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(Le){return this.transform.locationPoint3D(Re.bK.convert(Le))}unproject(Le){return this.transform.pointLocation3D(Re.P.convert(Le))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(Re,Le,Oe){if("mouseenter"===Re||"mouseover"===Re){let Ue=!1;const r=qe=>{const Ct=Le.filter((Re=>this.getLayer(Re))),Ot=Ct.length?this.queryRenderedFeatures(qe.point,{layers:Ct}):[];Ot.length?Ue||(Ue=!0,Oe.call(this,new za(Re,this,qe.originalEvent,{features:Ot}))):Ue=!1},s=()=>{Ue=!1};return{layers:new Set(Le),listener:Oe,delegates:{mousemove:r,mouseout:s}}}if("mouseleave"===Re||"mouseout"===Re){let Ue=!1;const r=qe=>{const Ct=Le.filter((Re=>this.getLayer(Re)));(Ct.length?this.queryRenderedFeatures(qe.point,{layers:Ct}):[]).length?Ue=!0:Ue&&(Ue=!1,Oe.call(this,new za(Re,this,qe.originalEvent)))},s=Le=>{Ue&&(Ue=!1,Oe.call(this,new za(Re,this,Le.originalEvent)))};return{layers:new Set(Le),listener:Oe,delegates:{mousemove:r,mouseout:s}}}{const o=Re=>{const Ue=Le.filter((Re=>this.getLayer(Re))),qe=Ue.length?this.queryRenderedFeatures(Re.point,{layers:Ue}):[];qe.length&&(Re.features=qe,Oe.call(this,Re),delete Re.features)};return{layers:new Set(Le),listener:Oe,delegates:{[Re]:o}}}}on(Re,Le,Oe){if("function"==typeof Le||void 0===Oe)return super.on(Re,Le);if(Array.isArray(Le)||(Le=[Le]),Le)for(const Re of Le)if(!this._isValidId(Re))return this;const Ue=this._createDelegatedListener(Re,Le,Oe);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[Re]=this._delegatedListeners[Re]||[],this._delegatedListeners[Re].push(Ue);for(const Re in Ue.delegates)this.on(Re,Ue.delegates[Re]);return this}once(Re,Le,Oe){if("function"==typeof Le||void 0===Oe)return super.once(Re,Le);if(Array.isArray(Le)||(Le=[Le]),Le)for(const Re of Le)if(!this._isValidId(Re))return this;const Ue=this._createDelegatedListener(Re,Le,Oe);for(const Re in Ue.delegates)this.once(Re,Ue.delegates[Re]);return this}off(Re,Le,Oe){if("function"==typeof Le||void 0===Oe)return super.off(Re,Le);const Ue=new Set(Array.isArray(Le)?Le:[Le]);for(const Re of Ue)if(!this._isValidId(Re))return this;const r=(Re,Le)=>{if(Re.size!==Le.size)return!1;for(const Oe of Re)if(!Le.has(Oe))return!1;return!0},qe=this._delegatedListeners?this._delegatedListeners[Re]:void 0;return qe&&(Re=>{for(let Le=0;Le<Re.length;Le++){const qe=Re[Le];if(qe.listener===Oe&&r(qe.layers,Ue)){for(const Re in qe.delegates)this.off(Re,qe.delegates[Re]);return Re.splice(Le,1),this}}})(qe),this}queryRenderedFeatures(Le,Oe){if(!this.style)return[];if(void 0!==Oe||void 0===Le||Le instanceof Re.P||Array.isArray(Le)||(Oe=Le,Le=void 0),Le=Le||[[0,0],[this.transform.width,this.transform.height]],(Oe=Oe||{}).layers&&Array.isArray(Oe.layers))for(const Re of Oe.layers)if(!this._isValidId(Re))return[];return this.style.queryRenderedFeatures(Le,Oe,this.transform)}querySourceFeatures(Re,Le){return this._isValidId(Re)?this.style.querySourceFeatures(Re,Le):[]}isPointOnSurface(Le){const{name:Oe}=this.transform.projection;return"globe"!==Oe&&"mercator"!==Oe&&Re.w(`${Oe} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(Re.P.convert(Le))}addInteraction(Re,Le){return this._interactions.add(Re,Le),this}removeInteraction(Re){return this._interactions.remove(Re),this}setStyle(Le,Oe){return Oe=Re.l({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},Oe),this.style&&Le&&!1!==Oe.diff&&Oe.localFontFamily===this._localFontFamily&&Oe.localIdeographFontFamily===this._localIdeographFontFamily&&!Oe.config?(this.style._diffStyle(Le,((Ue,qe)=>{Ue?(Re.w(`Unable to perform style diff: ${String(Ue.message||Ue.error||Ue)}. Rebuilding the style from scratch.`),this._updateStyle(Le,Oe)):qe&&this._update(!0)}),(()=>{this._postStyleLoadEvent()})),this):(this._localIdeographFontFamily=Oe.localIdeographFontFamily,this._localFontFamily=Oe.localFontFamily,this._updateStyle(Le,Oe))}_getUIString(Re){const Le=this._locale[Re];if(null==Le)throw new Error(`Missing UI string '${Re}'`);return Le}_updateStyle(Le,Oe){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),Le){const Ue=Re.l({},Oe);Oe&&Oe.config&&(Ue.initialConfig=Oe.config,delete Ue.config),this.style=new co(this,Ue).load(Le),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new co(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(Re.w("There is no style added to the map."),!1)}_isValidId(Le){return null==Le?(this.fire(new Re.t(new Error("IDs can't be empty."))),!1):!Re.cn(Le)||(this.fire(new Re.t(new Error(`IDs can't contain special symbols: "${Le}".`))),!1)}addSource(Re,Le){return this._isValidId(Re)?(this._lazyInitEmptyStyle(),this.style.addSource(Re,Le),this._update(!0)):this}isSourceLoaded(Re){return!!this._isValidId(Re)&&!!this.style&&this.style._isSourceCacheLoaded(Re)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(Re,Le,Oe){this._lazyInitEmptyStyle(),this.style.addSourceType(Re,Le,Oe)}removeSource(Re){return this._isValidId(Re)?(this.style.removeSource(Re),this._updateTerrain(),this._update(!0)):this}getSource(Re){return this._isValidId(Re)?this.style.getOwnSource(Re):null}addImage(Le,Oe,{pixelRatio:Ue=1,sdf:qe=!1,stretchX:Ct,stretchY:Ot,content:Jt}={}){if(this._lazyInitEmptyStyle(),Oe instanceof HTMLImageElement||ImageBitmap&&Oe instanceof ImageBitmap){const{width:Hr,height:Jr,data:Ln}=Re.q.getImageData(Oe);this.style.addImage(Le,{data:new Re.r({width:Hr,height:Jr},Ln),pixelRatio:Ue,stretchX:Ct,stretchY:Ot,content:Jt,sdf:qe,version:0})}else if(void 0===Oe.width||void 0===Oe.height)this.fire(new Re.t(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:Hr,height:Jr}=Oe,Ln=Oe;this.style.addImage(Le,{data:new Re.r({width:Hr,height:Jr},new Uint8Array(Ln.data)),pixelRatio:Ue,stretchX:Ct,stretchY:Ot,content:Jt,sdf:qe,version:0,userImage:Ln}),Ln.onAdd&&Ln.onAdd(this,Le)}}updateImage(Le,Oe){this._lazyInitEmptyStyle();const Ue=this.style.getImage(Le);if(!Ue)return void this.fire(new Re.t(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const qe=Oe instanceof HTMLImageElement||ImageBitmap&&Oe instanceof ImageBitmap?Re.q.getImageData(Oe):Oe,{width:Ct,height:Ot,data:Jt}=qe;if(void 0===Ct||void 0===Ot)return void this.fire(new Re.t(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(Ct!==Ue.data.width||Ot!==Ue.data.height)return void this.fire(new Re.t(new Error(`The width and height of the updated image (${Ct}, ${Ot})\n                must be that same as the previous version of the image\n                (${Ue.data.width}, ${Ue.data.height})`)));const Hr=!(Oe instanceof HTMLImageElement||ImageBitmap&&Oe instanceof ImageBitmap);Ue.data.replace(Jt,Hr),this.style.updateImage(Le,Ue)}hasImage(Le){return Le?!!this.style&&!!this.style.getImage(Le):(this.fire(new Re.t(new Error("Missing required image id"))),!1)}removeImage(Re){this.style.removeImage(Re)}loadImage(Le,Oe){Re.o(this._requestManager.transformRequest(Le,Re.R.Image),((Le,Ue)=>{Oe(Le,Ue instanceof HTMLImageElement?Re.q.getImageData(Ue):Ue)}))}listImages(){return this.style.listImages()}addModel(Re,Le){this._lazyInitEmptyStyle(),this.style.addModel(Re,Le)}hasModel(Le){return Le?this.style.hasModel(Le):(this.fire(new Re.t(new Error("Missing required model id"))),!1)}removeModel(Re){this.style.removeModel(Re)}listModels(){return this.style.listModels()}addLayer(Re,Le){return this._isValidId(Re.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(Re,Le),this._update(!0)):this}getSlot(Re){const Le=this.getLayer(Re);return Le&&Le.slot||null}setSlot(Re,Le){return this.style.setSlot(Re,Le),this.style.mergeLayers(),this._update(!0)}addImport(Re,Le){return this.style.addImport(Re,Le),this}updateImport(Re,Le){return"string"!=typeof Le&&Le.id!==Re?(this.removeImport(Re),this.addImport(Le)):(this.style.updateImport(Re,Le),this._update(!0))}removeImport(Re){return this.style.removeImport(Re),this}moveImport(Re,Le){return this.style.moveImport(Re,Le),this._update(!0)}moveLayer(Re,Le){return this._isValidId(Re)?(this.style.moveLayer(Re,Le),this._update(!0)):this}removeLayer(Re){return this._isValidId(Re)?(this.style.removeLayer(Re),this._update(!0)):this}getLayer(Re){if(!this._isValidId(Re))return null;const Le=this.style.getOwnLayer(Re);return Le?"custom"===Le.type?Le.implementation:Le.serialize():void 0}getSlots(){return this.style.getSlots()}setLayerZoomRange(Re,Le,Oe){return this._isValidId(Re)?(this.style.setLayerZoomRange(Re,Le,Oe),this._update(!0)):this}setFilter(Re,Le,Oe={}){return this._isValidId(Re)?(this.style.setFilter(Re,Le,Oe),this._update(!0)):this}getFilter(Re){return this._isValidId(Re)?this.style.getFilter(Re):null}setPaintProperty(Re,Le,Oe,Ue={}){return this._isValidId(Re)?(this.style.setPaintProperty(Re,Le,Oe,Ue),this._update(!0)):this}getPaintProperty(Re,Le){return this._isValidId(Re)?this.style.getPaintProperty(Re,Le):null}setLayoutProperty(Re,Le,Oe,Ue={}){return this._isValidId(Re)?(this.style.setLayoutProperty(Re,Le,Oe,Ue),this._update(!0)):this}getLayoutProperty(Re,Le){return this._isValidId(Re)?this.style.getLayoutProperty(Re,Le):null}getSchema(Re){return this.style.getSchema(Re)}setSchema(Re,Le){return this.style.setSchema(Re,Le),this._update(!0)}getConfig(Re){return this.style.getConfig(Re)}setConfig(Re,Le){return this.style.setConfig(Re,Le),this._update(!0)}getConfigProperty(Re,Le){return this.style.getConfigProperty(Re,Le)}setConfigProperty(Re,Le,Oe){return this.style.setConfigProperty(Re,Le,Oe),this._update(!0)}setLights(Re){if(this._lazyInitEmptyStyle(),Re&&1===Re.length&&"flat"===Re[0].type){const Le=Re[0];Le.properties?this.style.setFlatLight(Le.properties,Le.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(Re),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const Re=this.style.getLights()||[];return 0===Re.length&&Re.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),Re}setLight(Re,Le={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:Re}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(Re){return this._lazyInitEmptyStyle(),!Re&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(Re),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(Re){return this._lazyInitEmptyStyle(),this.style.setFog(Re),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setColorTheme(Re){return this._lazyInitEmptyStyle(),this.style.setColorTheme(Re),this._update(!0)}setCamera(Re){return this.style.setCamera(Re),this._triggerCameraUpdate(Re)}_triggerCameraUpdate(Re){return this._update(this.transform.setOrthographicProjectionAtLowPitch("orthographic"===Re["camera-projection"]))}getCamera(){return this.style.camera}_queryFogOpacity(Le){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(Re.bK.convert(Le),this.transform):0}setFeatureState(Re,Le){return this._isValidId(Re.source)?(this.style.setFeatureState(Re,Le),this._update()):this}removeFeatureState(Re,Le){return this._isValidId(Re.source)?(this.style.removeFeatureState(Re,Le),this._update()):this}getFeatureState(Re){return this._isValidId(Re.source)?this.style.getFeatureState(Re):null}_updateContainerDimensions(){if(!this._container)return;const Re=this._container.getBoundingClientRect().width||400,Le=this._container.getBoundingClientRect().height||300;let Oe,Ue,qe,Ct=this._container;for(;Ct&&(!Ue||!qe);){const Re=window.getComputedStyle(Ct).transform;Re&&"none"!==Re&&(Oe=Re.match(/matrix.*\((.+)\)/)[1].split(", "),Oe[0]&&"0"!==Oe[0]&&"1"!==Oe[0]&&(Ue=Oe[0]),Oe[3]&&"0"!==Oe[3]&&"1"!==Oe[3]&&(qe=Oe[3])),Ct=Ct.parentElement}this._containerWidth=Ue?Math.abs(Re/Ue):Re,this._containerHeight=qe?Math.abs(Le/qe):Le}_detectMissingCSS(){"rgb(250, 128, 114)"!==window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&Re.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const Re=this._container;Re.classList.add("mapboxgl-map"),(this._missingCSSCanary=l("div","mapboxgl-canary",Re)).style.visibility="hidden",this._detectMissingCSS();const Le=this._canvasContainer=l("div","mapboxgl-canvas-container",Re);this._canvas=l("canvas","mapboxgl-canvas",Le),this._interactive&&(Le.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const Oe=this._controlContainer=l("div","mapboxgl-control-container",Re),Ue=this._controlPositions={};["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"].forEach((Re=>{Ue[Re]=l("div",`mapboxgl-ctrl-${Re}`,Oe)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(Le,Oe){const Ue=Re.q.devicePixelRatio||1;this._canvas.width=Ue*Math.ceil(Le),this._canvas.height=Ue*Math.ceil(Oe),this._canvas.style.width=`${Le}px`,this._canvas.style.height=`${Oe}px`}_addMarker(Re){this._markers.push(Re)}_removeMarker(Re){const Le=this._markers.indexOf(Re);-1!==Le&&this._markers.splice(Le,1)}_addPopup(Re){this._popups.push(Re)}_removePopup(Re){const Le=this._popups.indexOf(Re);-1!==Le&&this._popups.splice(Le,1)}_setupPainter(){const Le=Re.l({},Ot.supported.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),Oe=this._canvas.getContext("webgl2",Le);Oe?(G(Oe,!0),this.painter=new wa(Oe,this._contextCreateOptions,this.transform,this._tp),this.on("data",(Re=>{"source"===Re.dataType&&this.painter.setTileLoadedFlag(!0)})),Re.m.testSupport(Oe)):this.fire(new Re.t(new Error("Failed to initialize WebGL")))}_contextLost(Le){Le.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new Re.x("webglcontextlost",{originalEvent:Le}))}_contextRestored(Le){this._setupPainter(),this.resize(),this._update(),this.fire(new Re.x("webglcontextrestored",{originalEvent:Le}))}_onMapScroll(Re){if(Re.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}idle(){return!this.isMoving()&&this.loaded()}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty}_update(Re){return this.style?(this._styleDirty=this._styleDirty||Re,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(Re){return this._update(),this._renderTaskQueue.add(Re)}_cancelRenderFrame(Re){this._renderTaskQueue.remove(Re)}_requestDomTask(Re){!this.loaded()||this.loaded()&&!this.isMoving()?Re():this._domRenderTaskQueue.add(Re)}_render(Le){let qe;this.fire(new Re.x("renderstart")),++this._frameId;const Ct=this.painter.context.extTimerQuery,Ot=Re.q.now(),Jt=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(qe=Jt.createQuery(),Jt.beginQuery(Ct.TIME_ELAPSED_EXT,qe)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(Le),this._domRenderTaskQueue.run(Le),this._removed)return;this._updateProjectionTransition();const Hr=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const Le=this.transform.zoom,Oe=this.transform.pitch,Ue=Re.q.now(),qe=new Re.a3(Le,{now:Ue,fadeDuration:Hr,pitch:Oe,transition:this.style.transition});this.style.update(qe)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let Jr=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),Jr=this._updateAverageElevation(Ot),this.style.updateSources(this.transform),this._forceMarkerAndPopupUpdate()):Jr=this._updateAverageElevation(Ot);const Ln=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,Hr,this._crossSourceCollisions,this.painter.replacementSource);if(Ln&&(this._placementDirty=Ln.needsRerender),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:Hr,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new Re.x("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,Ue.mark(Oe.load),this.fire(new Re.x("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),qe){const Le=Re.q.now()-Ot;Jt.endQuery(Ct.TIME_ELAPSED_EXT),setTimeout((()=>{const Oe=Jt.getQueryParameter(qe,Jt.QUERY_RESULT)/1e6;Jt.deleteQuery(qe),this.fire(new Re.x("gpu-timing-frame",{cpuTime:Le,gpuTime:Oe}))}),50)}if(this.listens("gpu-timing-layer")){const Le=this.painter.collectGpuTimers();setTimeout((()=>{const Oe=this.painter.queryGpuTimers(Le);this.fire(new Re.x("gpu-timing-layer",{layerTimes:Oe}))}),50)}if(this.listens("gpu-timing-deferred-render")){const Le=this.painter.collectDeferredRenderGpuQueries();setTimeout((()=>{const Oe=this.painter.queryGpuTimeDeferredRender(Le);this.fire(new Re.x("gpu-timing-deferred-render",{gpuTime:Oe}))}),50)}const Nn=this._sourcesDirty||this._styleDirty||this._placementDirty||Jr;if(Nn||this._repaint)this.triggerRepaint();else{const Le=this.idle();if(Le&&(Jr=this._updateAverageElevation(Ot,!0)),Jr)this.triggerRepaint();else if(this._triggerFrame(!1),Le&&(this.fire(new Re.x("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const Le=this._calculateSpeedIndex();this.fire(new Re.x("speedindexcompleted",{speedIndex:Le})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||Nn||(this._fullyLoaded=!0,Ue.mark(Oe.fullLoad),this._performanceMetricsCollection&&bi(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(Re){for(const Le of this._markers)Re&&!this.getRenderWorldCopies()&&(Le._lngLat=Le._lngLat.wrap()),Le._update();for(const Le of this._popups)!Re||this.getRenderWorldCopies()||Le._trackPointer||(Le._lngLat=Le._lngLat.wrap()),Le._update()}_updateAverageElevation(Re,Le=!1){const i=Re=>(this.transform.averageElevation=Re,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&i(0);const Oe=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(Oe||(Le||Re-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(Re)){const Le=this.transform.averageElevation;let Ue=this.transform.sampleAverageElevation();null!=this.transform.elevation&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(Ue)?Ue=0:this._averageElevationLastSampledAt=Re;const qe=Math.abs(Le-Ue);if(qe>1){if(this._isInitialLoad||Oe)return this._averageElevation.jumpTo(Ue),i(Ue);this._averageElevation.easeTo(Ue,Re,300)}else if(qe>1e-4)return this._averageElevation.jumpTo(Ue),i(Ue)}return!!this._averageElevation.isEasing(Re)&&i(this._averageElevation.getValue(Re))}_authenticate(){lo(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,(Le=>{if(Le&&(Le.message===Nn||401===Le.status)){const Le=this.painter.context.gl;G(Le,!1),this._logoControl instanceof Cn&&this._logoControl._updateLogo(),Le&&Le.clear(Le.DEPTH_BUFFER_BIT|Le.COLOR_BUFFER_BIT|Le.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new Re.t(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}})),Yn(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,(()=>{}))}_postStyleLoadEvent(){this.style.globalId&&vi(this._requestManager._customAccessToken,{map:this,skuToken:this._requestManager._skuToken,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){const Re=this._isDragging();this.painter.updateTerrain(this.style,Re)}_calculateSpeedIndex(){const Re=this.painter.canvasCopy(),Le=this.painter.getCanvasCopiesAndTimestamps();Le.timeStamps.push(performance.now());const Oe=this.painter.context.gl,Ue=Oe.createFramebuffer();function r(Re){Oe.framebufferTexture2D(Oe.FRAMEBUFFER,Oe.COLOR_ATTACHMENT0,Oe.TEXTURE_2D,Re,0);const Le=new Uint8Array(Oe.drawingBufferWidth*Oe.drawingBufferHeight*4);return Oe.readPixels(0,0,Oe.drawingBufferWidth,Oe.drawingBufferHeight,Oe.RGBA,Oe.UNSIGNED_BYTE,Le),Le}return Oe.bindFramebuffer(Oe.FRAMEBUFFER,Ue),this._canvasPixelComparison(r(Re),Le.canvasCopies.map(r),Le.timeStamps)}_canvasPixelComparison(Re,Le,Oe){let Ue=Oe[1]-Oe[0];const qe=Re.length/4;for(let Ct=0;Ct<Le.length;Ct++){const Ot=Le[Ct];let Jt=0;for(let Le=0;Le<Ot.length;Le+=4)Ot[Le]===Re[Le]&&Ot[Le+1]===Re[Le+1]&&Ot[Le+2]===Re[Le+2]&&Ot[Le+3]===Re[Le+3]&&(Jt+=1);Ue+=(Oe[Ct+2]-Oe[Ct+1])*(1-Jt/qe)}return Ue}remove(){this._hash&&this._hash.remove();for(const Re of this._controls)Re.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const Le=this.painter.context.gl.getExtension("WEBGL_lose_context");Le&&Le.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),uo.delete(this.painter.context.gl),Pi.remove(),Xn.remove(),this._removed=!0,this.fire(new Re.x("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(Le){this._renderNextFrame=this._renderNextFrame||Le,this.style&&!this._frame&&(this._frame=Re.q.frame((Re=>{const Le=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,Le&&this._render(Re)})))}_preloadTiles(Le){const Oe=this.style?this.style.getSourceCaches():[];return Re.bf(Oe,((Re,Oe)=>Re._preloadTiles(Le,Oe)),(()=>{this.triggerRepaint()})),this}_onWindowOnline(){this._update()}_onWindowResize(Re){this._trackResize&&this.resize({originalEvent:Re})._update()}_onVisibilityChange(){"hidden"===document.visibilityState&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(Re){this._showTileBoundaries!==Re&&(this._showTileBoundaries=Re,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(Re){this._showParseStatus!==Re&&(this._showParseStatus=Re,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(Re){this._showTerrainWireframe!==Re&&(this._showTerrainWireframe=Re,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(Re){this._showLayers2DWireframe!==Re&&(this._showLayers2DWireframe=Re,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(Re){this._showLayers3DWireframe!==Re&&(this._showLayers3DWireframe=Re,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(Re){this._speedIndexTiming!==Re&&(this._speedIndexTiming=Re,this._update())}get showPadding(){return!!this._showPadding}set showPadding(Re){this._showPadding!==Re&&(this._showPadding=Re,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(Re){this._showCollisionBoxes!==Re&&(this._showCollisionBoxes=Re,this._tp.refreshUI(),Re?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(Re){this._showOverdrawInspector!==Re&&(this._showOverdrawInspector=Re,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(Re){this._repaint!==Re&&(this._repaint=Re,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(Re){this._vertices=Re,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(Re){this._showTileAABBs!==Re&&(this._showTileAABBs=Re,this._tp.refreshUI(),Re&&this._update())}_setCacheLimits(Le,Oe){Re.dy(Le,Oe)}get version(){return Le}},NavigationControl:class{constructor(Le={}){this.options=Re.l({},Rp,Le),this._container=l("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",(Re=>Re.preventDefault())),this.options.showZoom&&(Re.aJ(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",(Re=>{this._map&&this._map.zoomIn({},{originalEvent:Re})})),l("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",(Re=>{this._map&&this._map.zoomOut({},{originalEvent:Re})})),l("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(Re.aJ(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",(Re=>{const Le=this._map;Le&&(this.options.visualizePitch?Le.resetNorthPitch({},{originalEvent:Re}):Le.resetNorth({},{originalEvent:Re}))})),this._compassIcon=l("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const Re=this._map;if(!Re)return;const Le=Re.getZoom(),Oe=Le===Re.getMaxZoom(),Ue=Le===Re.getMinZoom();this._zoomInButton.disabled=Oe,this._zoomOutButton.disabled=Ue,this._zoomInButton.setAttribute("aria-disabled",Oe.toString()),this._zoomOutButton.setAttribute("aria-disabled",Ue.toString())}_rotateCompassArrow(){const Re=this._map;if(!Re)return;const Le=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(Re.transform.pitch*(Math.PI/180)),.5)}) rotateX(${Re.transform.pitch}deg) rotateZ(${Re.transform.angle*(180/Math.PI)}deg)`:`rotate(${Re.transform.angle*(180/Math.PI)}deg)`;Re._requestDomTask((()=>{this._compassIcon&&(this._compassIcon.style.transform=Le)}))}onAdd(Re){return this._map=Re,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),Re.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&Re.on("pitch",this._rotateCompassArrow),Re.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Mn(Re,this._compass,this.options.visualizePitch)),this._container}onRemove(){const Re=this._map;Re&&(this._container.remove(),this.options.showZoom&&Re.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&Re.off("pitch",this._rotateCompassArrow),Re.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(Re,Le){const Oe=l("button",Re,this._container);return Oe.type="button",Oe.addEventListener("click",Le),Oe}_setButtonTitle(Re,Le){if(!this._map)return;const Oe=this._map._getUIString(`NavigationControl.${Le}`);Re.setAttribute("aria-label",Oe),Re.firstElementChild&&Re.firstElementChild.setAttribute("title",Oe)}},GeolocateControl:class extends Re.E{constructor(Le={}){super();const Oe=navigator.geolocation;this.options=Re.l({geolocation:Oe},Op,Le),Re.aJ(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Ta(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(Re){return this._map=Re,this._container=l("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(Re){const t=(Le=!!this.options.geolocation)=>{this._supportsGeolocation=Le,Re(Le)};void 0!==this._supportsGeolocation?Re(this._supportsGeolocation):void 0!==navigator.permissions?navigator.permissions.query({name:"geolocation"}).then((Re=>t("denied"!==Re.state))).catch((()=>t())):t()}_isOutOfMapMaxBounds(Re){const Le=this._map.getMaxBounds(),Oe=Re.coords;return!!Le&&(Oe.longitude<Le.getWest()||Oe.longitude>Le.getEast()||Oe.latitude<Le.getSouth()||Oe.latitude>Le.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(Le){if(this._map){if(this._isOutOfMapMaxBounds(Le))return this._setErrorState(),this.fire(new Re.x("outofmaxbounds",Le)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=Le,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(Le),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(Le),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new Re.x("geolocate",Le)),this._finish()}}_updateCamera(Le){const Oe=new Re.bK(Le.coords.longitude,Le.coords.latitude),Ue=Le.coords.accuracy,qe=this._map.getBearing(),Ct=Re.l({bearing:qe},this.options.fitBoundsOptions);this._map.fitBounds(Oe.toBounds(Ue),Ct,{geolocateSource:!0})}_updateMarker(Le){if(Le){const Oe=new Re.bK(Le.coords.longitude,Le.coords.latitude);this._accuracyCircleMarker.setLngLat(Oe).addTo(this._map),this._userLocationDotMarker.setLngLat(Oe).addTo(this._map),this._accuracy=Le.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const Le=this._map.transform,Oe=Re.bD(1,Le._center.lat)*Le.worldSize,Ue=Math.ceil(2*this._accuracy*Oe);this._circleElement.style.width=`${Ue}px`,this._circleElement.style.height=`${Ue}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(Le){if(this._map){if(this.options.trackUserLocation)if(1===Le.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const Re=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",Re),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",Re),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===Le.code&&this._noTimeout)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new Re.x("error",Le)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(Le){if(void 0!==this._map){if(this._container.addEventListener("contextmenu",(Re=>Re.preventDefault())),this._geolocateButton=l("button","mapboxgl-ctrl-geolocate",this._container),l("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===Le){Re.w("Geolocation support is not available so the GeolocateControl will be disabled.");const Le=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",Le),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",Le)}else{const Re=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",Re),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",Re)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=l("div","mapboxgl-user-location"),this._dotElement.appendChild(l("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(l("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Fn({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=l("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Fn({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(Le=>{Le.geolocateSource||"ACTIVE_LOCK"!==this._watchState||Le.originalEvent&&"resize"===Le.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new Re.x("trackuserlocationend")))}))}}_onDeviceOrientation(Re){this._userLocationDotMarker&&(Re.webkitCompassHeading?this._heading=Re.webkitCompassHeading:!0===Re.absolute&&(this._heading=-1*Re.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return Re.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new Re.x("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new Re.x("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new Re.x("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let Re;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(Re={maximumAge:6e5,timeout:0},this._noTimeout=!0):(Re=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,Re),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=window.setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const e=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};"undefined"!=typeof DeviceMotionEvent&&"function"==typeof DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then((Re=>{"granted"===Re&&e()})).catch(console.error):e()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:En,ScaleControl:class{constructor(Le={}){this.options=Re.l({},Dp,Le),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch(Re){return!1}}(),Re.aJ(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const Re=this.options.maxWidth||100,Le=this._map,Oe=Le._containerHeight/2,Ue=Le._containerWidth/2-Re/2,qe=Le.unproject([Ue,Oe]),Ct=Le.unproject([Ue+Re,Oe]),Ot=qe.distanceTo(Ct);if("imperial"===this.options.unit){const Le=3.2808*Ot;Le>5280?this._setScale(Re,Le/5280,"mile"):this._setScale(Re,Le,"foot")}else"nautical"===this.options.unit?this._setScale(Re,Ot/1852,"nautical-mile"):Ot>=1e3?this._setScale(Re,Ot/1e3,"kilometer"):this._setScale(Re,Ot,"meter")}_setScale(Re,Le,Oe){this._map._requestDomTask((()=>{const Ue=function(Re){const Le=Math.pow(10,`${Math.floor(Re)}`.length-1);let Oe=Re/Le;return Oe=Oe>=10?10:Oe>=5?5:Oe>=3?3:Oe>=2?2:Oe>=1?1:function(Re){const Le=Math.pow(10,Math.ceil(-Math.log(Re)/Math.LN10));return Math.round(Re*Le)/Le}(Oe),Le*Oe}(Le),qe=Ue/Le;this._container.innerHTML=this._isNumberFormatSupported&&"nautical-mile"!==Oe?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:Oe}).format(Ue):`${Ue}&nbsp;${Fp[Oe]}`,this._container.style.width=Re*qe+"px"}))}onAdd(Re){return this._map=Re,this._language=Re.getLanguage(),this._container=l("div","mapboxgl-ctrl mapboxgl-ctrl-scale",Re.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(Re){this._language=Re,this._update()}setUnit(Re){this.options.unit=Re,this._update()}},FullscreenControl:class{constructor(Le={}){this._fullscreen=!1,Le&&Le.container&&(Le.container instanceof HTMLElement?this._container=Le.container:Re.w("Full screen control 'container' must be a DOM element.")),Re.aJ(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(Le){return this._map=Le,this._container||(this._container=this._map.getContainer()),this._controlContainer=l("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",Re.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const Re=this._fullscreenButton=l("button","mapboxgl-ctrl-fullscreen",this._controlContainer);l("span","mapboxgl-ctrl-icon",Re).setAttribute("aria-hidden","true"),Re.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const Re=this._getTitle();this._fullscreenButton.setAttribute("aria-label",Re),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",Re)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends Re.E{constructor(Le){super(),this.options=Re.l(Object.create(Np),Le),Re.aJ(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(Le&&Le.className?Le.className.trim().split(/\s+/):[])}addTo(Le){return this._map&&this.remove(),this._map=Le,this.options.closeOnClick&&Le.on("preclick",this._onClose),this.options.closeOnMove&&Le.on("move",this._onClose),Le.on("remove",this.remove),this._update(),Le._addPopup(this),this._focusFirstElement(),this._trackPointer?(Le.on("mousemove",this._onMouseEvent),Le.on("mouseup",this._onMouseEvent),Le._canvasContainer.classList.add("mapboxgl-track-pointer")):Le.on("move",this._update),this.fire(new Re.x("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const Le=this._map;return Le&&(Le.off("move",this._update),Le.off("move",this._onClose),Le.off("preclick",this._onClose),Le.off("click",this._onClose),Le.off("remove",this.remove),Le.off("mousemove",this._onMouseEvent),Le.off("mouseup",this._onMouseEvent),Le.off("drag",this._onMouseEvent),Le._canvasContainer&&Le._canvasContainer.classList.remove("mapboxgl-track-pointer"),Le._removePopup(this),this._map=void 0),this.fire(new Re.x("close")),this}getLngLat(){return this._lngLat}setLngLat(Le){this._lngLat=Re.bK.convert(Le),this._pos=null,this._trackPointer=!1,this._update();const Oe=this._map;return Oe&&(Oe.on("move",this._update),Oe.off("mousemove",this._onMouseEvent),Oe._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const Re=this._map;return Re&&(Re.off("move",this._update),Re.on("mousemove",this._onMouseEvent),Re.on("drag",this._onMouseEvent),Re._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(Re){return this.setDOMContent(document.createTextNode(Re))}setHTML(Re){const Le=document.createDocumentFragment(),Oe=document.createElement("body");let Ue;for(Oe.innerHTML=Re;Ue=Oe.firstChild,Ue;)Le.appendChild(Ue);return this.setDOMContent(Le)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(Re){return this.options.maxWidth=Re,this._update(),this}setDOMContent(Re){let Le=this._content;if(Le)for(;Le.hasChildNodes();)Le.firstChild&&Le.removeChild(Le.firstChild);else Le=this._content=l("div","mapboxgl-popup-content",this._container||void 0);if(Le.appendChild(Re),this.options.closeButton){const Re=this._closeButton=l("button","mapboxgl-popup-close-button",Le);Re.type="button",Re.setAttribute("aria-label","Close popup"),Re.setAttribute("aria-hidden","true"),Re.innerHTML="&#215;",Re.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(Re){return this._classList.add(Re),this._updateClassList(),this}removeClassName(Re){return this._classList.delete(Re),this._updateClassList(),this}setOffset(Re){return this.options.offset=Re,this._update(),this}toggleClassName(Re){let Le;return this._classList.delete(Re)?Le=!1:(this._classList.add(Re),Le=!0),this._updateClassList(),Le}_onMouseEvent(Re){this._update(Re.point)}_getAnchor(Re){if(this.options.anchor)return this.options.anchor;const Le=this._map,Oe=this._container,Ue=this._pos;if(!Le||!Oe||!Ue)return"bottom";const qe=Oe.offsetWidth,Ct=Oe.offsetHeight,Ot=Ue.x<qe/2,Jt=Ue.x>Le.transform.width-qe/2;if(Ue.y+Re<Ct)return Ot?"top-left":Jt?"top-right":"top";if(Ue.y>Le.transform.height-Ct){if(Ot)return"bottom-left";if(Jt)return"bottom-right"}return Ot?"left":Jt?"right":"bottom"}_updateClassList(){const Re=this._container;if(!Re)return;const Le=[...this._classList];Le.push("mapboxgl-popup"),this._anchor&&Le.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&Le.push("mapboxgl-popup-track-pointer"),Re.className=Le.join(" ")}_update(Le){const Oe=this._map,Ue=this._content;if(!Oe||!this._lngLat&&!this._trackPointer||!Ue)return;let qe=this._container;if(qe||(qe=this._container=l("div","mapboxgl-popup",Oe.getContainer()),this._tip=l("div","mapboxgl-popup-tip",qe),qe.appendChild(Ue)),this.options.maxWidth&&qe.style.maxWidth!==this.options.maxWidth&&(qe.style.maxWidth=this.options.maxWidth),Oe.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=zn(this._lngLat,this._pos,Oe.transform)),!this._trackPointer||Le){const Ue=this._pos=this._trackPointer&&Le instanceof Re.P?Le:Oe.project(this._lngLat),qe=jn(this.options.offset),Ct=this._anchor=this._getAnchor(qe.y),Ot=jn(this.options.offset,Ct),Jt=Ue.add(Ot).round();Oe._requestDomTask((()=>{this._container&&Ct&&(this._container.style.transform=`${Lp[Ct]} translate(${Jt.x}px,${Jt.y}px)`)}))}if(!this._marker&&Oe._showingGlobe()){const Le=Re.dz(Oe.transform,this._lngLat)?0:1;this._setOpacity(Le)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const Re=this._container.querySelector(jp);Re&&Re.focus()}_onClose(){this.remove()}_setOpacity(Re){this._container&&(this._container.style.opacity=`${Re}`),this._content&&(this._content.style.pointerEvents=Re?"auto":"none")}},Marker:Fn,Style:co,LngLat:Re.bK,LngLatBounds:Re.as,Point:Re.P,MercatorCoordinate:Re.a5,FreeCameraOptions:Ui,Evented:Re.E,config:Re.e,prewarm:Re.dE,clearPrewarmedResources:Re.dF,get accessToken(){return Re.e.ACCESS_TOKEN},set accessToken(Le){Re.e.ACCESS_TOKEN=Le},get baseApiUrl(){return Re.e.API_URL},set baseApiUrl(Le){Re.e.API_URL=Le},get workerCount(){return Re.dG.workerCount},set workerCount(Le){Re.dG.workerCount=Le},get maxParallelImageRequests(){return Re.e.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(Le){Re.e.MAX_PARALLEL_IMAGE_REQUESTS=Le},clearStorage(Le){Re.dH(Le)},get workerUrl(){return Re.dI.workerUrl},set workerUrl(Le){Re.dI.workerUrl=Le},get workerClass(){return Re.dI.workerClass},set workerClass(Le){Re.dI.workerClass=Le},get workerParams(){return Re.dI.workerParams},set workerParams(Le){Re.dI.workerParams=Le},get dracoUrl(){return Re.dJ()},set dracoUrl(Le){Re.dK(Le)},get meshoptUrl(){return Re.dL()},set meshoptUrl(Le){Re.dM(Le)},setNow:Re.q.setNow,restoreNow:Re.q.restoreNow}}));var Ue=Oe;return Ue}();const RA=getDefaultExportFromCjs(PA.exports);function useAsyncData(...Re){var Le,Oe,Ue,qe,Ct,Ot,Jt,Hr;const Jr="string"==typeof Re[Re.length-1]?Re.pop():void 0;"string"!=typeof Re[0]&&Re.unshift(Jr);let[Ln,Nn,$n={}]=Re;if("string"!=typeof Ln)throw new TypeError("[nuxt] [asyncData] key must be a string.");if("function"!=typeof Nn)throw new TypeError("[nuxt] [asyncData] handler must be a function.");const Gn=useNuxtApp(),qn=Nn;$n.server=null==(Le=$n.server)||Le,$n.default=null!=(Oe=$n.default)?Oe:()=>vS.value,$n.getCachedData=null!=(Ue=$n.getCachedData)?Ue:()=>Gn.isHydrating?Gn.payload.data[Ln]:Gn.static.data[Ln],$n.lazy=null!=(qe=$n.lazy)&&qe,$n.immediate=null==(Ct=$n.immediate)||Ct,$n.deep=null!=(Ot=$n.deep)?Ot:vS.deep,$n.dedupe=null!=(Jt=$n.dedupe)?Jt:"cancel";const Zn=$n.getCachedData(Ln,Gn),Xn=null!=Zn;if(!Gn._asyncData[Ln]||!$n.immediate){null!=(Hr=Gn.payload._errors)[Ln]||(Hr[Ln]=vS.errorValue);const Re=$n.deep?ref:shallowRef;Gn._asyncData[Ln]={data:Re(Xn?Zn:$n.default()),pending:ref(!Xn),error:toRef(Gn.payload._errors,Ln),status:ref("idle"),_default:$n.default}}const Yn={...Gn._asyncData[Ln]};delete Yn._default,Yn.refresh=Yn.execute=(Re={})=>{var Le,Oe;if(Gn._asyncDataPromises[Ln]){if("defer"===(Oe=null!=(Le=Re.dedupe)?Le:$n.dedupe)||!1===Oe)return Gn._asyncDataPromises[Ln];Gn._asyncDataPromises[Ln].cancelled=!0}if(Re._initial||Gn.isHydrating&&!1!==Re._initial){const Le=Re._initial?Zn:$n.getCachedData(Ln,Gn);if(null!=Le)return Promise.resolve(Le)}Yn.pending.value=!0,Yn.status.value="pending";const Ue=new Promise(((Re,Le)=>{try{Re(qn(Gn))}catch(Re){Le(Re)}})).then((async Re=>{if(Ue.cancelled)return Gn._asyncDataPromises[Ln];let Le=Re;$n.transform&&(Le=await $n.transform(Re)),$n.pick&&(Le=function(Re,Le){const Oe={};for(const Ue of Le)Oe[Ue]=Re[Ue];return Oe}(Le,$n.pick)),Gn.payload.data[Ln]=Le,Yn.data.value=Le,Yn.error.value=vS.errorValue,Yn.status.value="success"})).catch((Re=>{if(Ue.cancelled)return Gn._asyncDataPromises[Ln];Yn.error.value=createError(Re),Yn.data.value=unref($n.default()),Yn.status.value="error"})).finally((()=>{Ue.cancelled||(Yn.pending.value=!1,delete Gn._asyncDataPromises[Ln])}));return Gn._asyncDataPromises[Ln]=Ue,Gn._asyncDataPromises[Ln]},Yn.clear=()=>function(Re,Le){Le in Re.payload.data&&(Re.payload.data[Le]=void 0);Le in Re.payload._errors&&(Re.payload._errors[Le]=vS.errorValue);Re._asyncData[Le]&&(Re._asyncData[Le].data.value=void 0,Re._asyncData[Le].error.value=vS.errorValue,Re._asyncData[Le].pending.value=!1,Re._asyncData[Le].status.value="idle");Le in Re._asyncDataPromises&&(Re._asyncDataPromises[Le]&&(Re._asyncDataPromises[Le].cancelled=!0),Re._asyncDataPromises[Le]=void 0)}(Gn,Ln);if(!1!==$n.server&&Gn.payload.serverRendered&&$n.immediate){const Re=Yn.refresh({_initial:!0});getCurrentInstance()?vb((()=>Re)):Gn.hook("app:created",(async()=>{await Re}))}const _i=Promise.resolve(Gn._asyncDataPromises[Ln]).then((()=>Yn));return Object.assign(_i,Yn),_i}function useFetch(Re,Le,Oe){const[Ue={},qe]="string"==typeof Le?[{},Le]:[Le,Oe],Ct=computed((()=>toValue(Re))),Ot=Ue.key||hash([qe,"string"==typeof Ct.value?Ct.value:"",...generateOptionSegments(Ue)]);if(!Ot||"string"!=typeof Ot)throw new TypeError("[nuxt] [useFetch] key must be a string: "+Ot);if(!Re)throw new Error("[nuxt] [useFetch] request is missing.");const Jt=Ot===qe?"$f"+Ot:Ot;if(!Ue.baseURL&&"string"==typeof Ct.value&&"/"===Ct.value[0]&&"/"===Ct.value[1])throw new Error('[nuxt] [useFetch] the request URL must not start with "//".');const{server:Hr,lazy:Jr,default:Ln,transform:Nn,pick:$n,watch:Gn,immediate:qn,getCachedData:Zn,deep:Xn,dedupe:Yn,..._i}=Ue,vi=reactive({...xS,..._i,cache:"boolean"==typeof Ue.cache?void 0:Ue.cache});let xi;return useAsyncData(Jt,(()=>{var Re;null==(Re=null==xi?void 0:xi.abort)||Re.call(xi,"Request aborted as another request to the same endpoint was initiated."),xi="undefined"!=typeof AbortController?new AbortController:{};const Le=toValue(Ue.timeout);let Oe;Le&&(Oe=setTimeout((()=>xi.abort("Request aborted due to timeout.")),Le),xi.signal.onabort=()=>clearTimeout(Oe));let qe=Ue.$fetch||globalThis.$fetch;if(!Ue.$fetch){"string"==typeof Ct.value&&"/"===Ct.value[0]&&(!toValue(Ue.baseURL)||"/"===toValue(Ue.baseURL)[0])&&(qe=useRequestFetch())}return qe(Ct.value,{signal:xi.signal,...vi}).finally((()=>{clearTimeout(Oe)}))}),{server:Hr,lazy:Jr,default:Ln,transform:Nn,pick:$n,immediate:qn,getCachedData:Zn,deep:Xn,dedupe:Yn,watch:!1===Gn?[]:[vi,Ct,...Gn||[]]})}function generateOptionSegments(Re){var Le;const Oe=[(null==(Le=toValue(Re.method))?void 0:Le.toUpperCase())||"GET",toValue(Re.baseURL)];for(const Le of[Re.params||Re.query]){const Re=toValue(Le);if(!Re)continue;const Ue={};for(const[Le,Oe]of Object.entries(Re))Ue[toValue(Le)]=toValue(Oe);Oe.push(Ue)}return Oe}var LA=Object.defineProperty,__publicField=(Re,Le,Oe)=>((Re,Le,Oe)=>Le in Re?LA(Re,Le,{enumerable:!0,configurable:!0,writable:!0,value:Oe}):Re[Le]=Oe)(Re,"symbol"!=typeof Le?Le+"":Le,Oe);class AlphaColor{constructor(Re){__publicField(this,"color"),__publicField(this,"opacity"),this.color=Re,this.opacity=1}parseAlphaColor(){const Re=this.color.match(/rgba?\(([^)]+)\)/);if(Re){const[Le,Oe,Ue,qe]=Re[1].split(",").map(Number);this.color=`rgb(${Le}, ${Oe}, ${Ue})`,this.opacity=void 0!==qe?qe:1}return this}}const OA=defineComponent({__name:"NuxtStar",__ssrInlineRender:!0,props:{fill:{},points:{},size:{},starId:{},activeColor:{},inactiveColor:{},borderColor:{},skeletonColor:{},borderWidth:{},roundedCorners:{type:Boolean}},emits:["star-mouse-move","star-selected"],setup(Re,{emit:Le}){const Oe=Re,getColor=Re=>new AlphaColor(Re).parseAlphaColor().color,getOpacity=Re=>new AlphaColor(Re).parseAlphaColor().opacity,Ue=ref(Oe.activeColor);ref(!0);const qe=(Re=>{if("number"==typeof Re)return Re;const Le=parseFloat(Re);return isNaN(Le)?0:Le})(Oe.size),Ct=computed((()=>Oe.points.join(","))),Ot=computed((()=>`url(#${Ue.value})`)),Jt=computed((()=>qe+(Oe.roundedCorners&&Oe.borderWidth<=0?6:Oe.borderWidth))),Hr=computed((()=>`${Oe.fill}%`)),Jr=computed((()=>Oe.roundedCorners&&Oe.borderWidth<=0?Oe.inactiveColor:Oe.borderColor)),Ln=computed((()=>{const Re=Math.max(...Oe.points);return isFinite(Re)?Re:100})),Nn=computed((()=>`0 0 ${Ln.value} ${Ln.value}`)),$n=computed((()=>Oe.roundedCorners?"round":"miter"));return(Re,Le,Oe,qe)=>{Le(`<div${ssrRenderAttrs(qe)} data-v-f0c63eac><svg class="nuxt-rating-star-svg"${ssrRenderAttr("height",Jt.value)}${ssrRenderAttr("width",Jt.value)}${ssrRenderAttr("viewBox",Nn.value)} data-v-f0c63eac><linearGradient${ssrRenderAttr("id",Ue.value)} x1="0" x2="100%" y1="0" y2="0" data-v-f0c63eac><stop${ssrRenderAttr("offset",Hr.value)}${ssrRenderAttr("stop-color",getColor(Re.activeColor))}${ssrRenderAttr("stop-opacity",getOpacity(Re.activeColor))} data-v-f0c63eac></stop><stop${ssrRenderAttr("offset",Hr.value)}${ssrRenderAttr("stop-color",getColor(Re.inactiveColor))}${ssrRenderAttr("stop-opacity",getOpacity(Re.inactiveColor))} data-v-f0c63eac></stop></linearGradient><polygon${ssrRenderAttr("height",Jt.value)}${ssrRenderAttr("width",Jt.value)}${ssrRenderAttr("points",Ct.value)}${ssrRenderAttr("fill",Ot.value)}${ssrRenderAttr("stroke",Jr.value)}${ssrRenderAttr("stroke-width",Re.borderWidth)}${ssrRenderAttr("stroke-linejoin",$n.value)} data-v-f0c63eac></polygon><polygon${ssrRenderAttr("points",Ct.value)}${ssrRenderAttr("fill",Ot.value)} data-v-f0c63eac></polygon></svg></div>`)}}}),zA=OA.setup;OA.setup=(Re,Le)=>{const Oe=useSSRContext();return(Oe.modules||(Oe.modules=new Set)).add("node_modules/nuxt-rating/dist/runtime/components/NuxtStar.vue"),zA?zA(Re,Le):void 0};const DA=_export_sfc(OA,[["__scopeId","data-v-f0c63eac"]]),BA=defineComponent({__name:"NuxtRating",__ssrInlineRender:!0,props:{ratingStep:{default:.1},ratingValue:{default:4.5},roundStartRating:{type:Boolean,default:!0},activeColor:{default:"#ffa41c"},inactiveColor:{default:"#d8d8d8"},skeletonColor:{default:"#d8d8d8"},ratingCount:{default:5},ratingContent:{default:()=>[19.8,2.2,6.6,43.56,39.6,17.16,0,17.16,33,43.56]},ratingSize:{default:15},ratingSpacing:{default:2},readOnly:{type:Boolean,default:!0},inline:{type:Boolean,default:!1},borderColor:{default:"#db8403"},borderWidth:{default:0},roundedCorners:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1}},emits:["ratingSelected","ratingHovered"],setup(Re,{emit:Le}){const Oe=Re,Ue=Le,qe=ref(100*Oe.ratingStep),Ct=ref(Oe.ratingValue),Ot=ref(Oe.ratingValue),Jt=ref(!1),Hr=ref(!0),Jr=computed((()=>Jt.value||Oe.roundStartRating)),Ln=computed((()=>Array.isArray(Oe.activeColor)?padColors(Oe.activeColor,Oe.ratingCount,Oe.activeColor.slice(-1)[0]):new Array(Oe.ratingCount).fill(Oe.activeColor))),Nn=computed((()=>Ot.value>0?Ln.value[Math.ceil(Ot.value)-1]:Oe.inactiveColor)),$n=computed((()=>{const Re=1/Oe.ratingStep;return Math.min(Oe.ratingCount,Math.ceil(Ct.value*Re)/Re)})),Gn=computed((()=>{const Re=Jr.value?$n.value:Ct.value;return Array.from({length:Oe.ratingCount},((Le,Oe)=>Oe<Re?Re-Oe>1?100:100*(Re-Oe):0))}));watch((()=>Oe.ratingValue),(Re=>{Ct.value=Re,Ot.value=Re}));const setRating=(Re,Le)=>{var qe;if(!Oe.readOnly){const Hr=Number(Re.position)/100,Jr=Re.id-1+Math.ceil(Hr*(1/Oe.ratingStep))*Oe.ratingStep;Ct.value=Math.min(Jr,Oe.ratingCount);const Ln=(null==(qe=Oe.ratingStep.toString().split(".")[1])?void 0:qe.length)||0,Nn=Number(Ct.value.toFixed(Ln));Le&&(Ot.value=Oe.clearable&&Ct.value===Ot.value?0:Ct.value,Jt.value=!0,Ue("ratingSelected",Nn)),Ue("ratingHovered",Nn)}},padColors=(Re,Le,Oe)=>Re.concat(Array(Le-Re.length).fill(Oe));return(Re,Le,Ue,Ct)=>{Le(`<div${ssrRenderAttrs(mergeProps({class:["nuxt-rating-wrapper",{"nuxt-rating-inline":Oe.inline}]},Ct))} data-v-038f2b51>\x3c!--[--\x3e`),ssrRenderList(Oe.ratingCount,(Re=>{Le(`<span class="${ssrRenderClass([{"nuxt-rating-pointer":!Oe.readOnly,"skeleton-pulse":Hr.value},"nuxt-rating-star"])}" style="${ssrRenderStyle({marginRight:Re!==Oe.ratingCount?`${Oe.ratingSpacing}px`:"0"})}" data-v-038f2b51>`),Le(ssrRenderComponent(DA,{fill:Hr.value?100:Gn.value[Re-1],size:Oe.ratingSize,points:Oe.ratingContent,"star-id":Re,step:qe.value,"active-color":Hr.value?Oe.skeletonColor:Nn.value,"inactive-color":Oe.inactiveColor,"border-color":Hr.value?Oe.skeletonColor:Oe.borderColor,"border-width":Oe.borderWidth,"rounded-corners":Oe.roundedCorners,onStarSelected:Re=>setRating(Re,!0),onStarMouseMove:setRating},null,Ue)),Le("</span>")})),Le("\x3c!--]--\x3e</div>")}}}),FA=BA.setup;BA.setup=(Re,Le)=>{const Oe=useSSRContext();return(Oe.modules||(Oe.modules=new Set)).add("node_modules/nuxt-rating/dist/runtime/components/NuxtRating.vue"),FA?FA(Re,Le):void 0};const NA=_export_sfc(BA,[["__scopeId","data-v-038f2b51"]]),jA=defineComponent({__name:"RateComponent",__ssrInlineRender:!0,setup(Re){const Le=ref(0),logRating=Re=>{console.log(Re)},Oe=5*Math.random();return(Re,Ue,qe,Ct)=>{const Ot=NA;Ue(`<div${ssrRenderAttrs(mergeProps({class:"bg-white/90 p-5 sm:p-20"},Ct))}><div class="title"><p class="text-2xl sm:text-4xl font-bold">Lorem Ipum</p></div><div class="py-5">`),Ue(ssrRenderComponent(Ot,{"border-color":"#db8403","active-color":"#ffa41c","inactive-color":"#fff","rating-step":.5,"rounded-corners":!0,"border-width":5,"rating-size":15,"rating-value":Oe,onRatingSelected:logRating,onRatingHovered:Re=>Le.value=Re},null,qe)),Ue('</div><div><p class="text-sm sm:text-lg"> Lorem ipsum dolor sit, amet consectetur adipisicing elit. Quibusdam tempore nobis nesciunt cumque! Porro, exercitationem vero doloremque suscipit pariatur repudiandae, consectetur reiciendis fuga, facere minima tempore ipsa nesciunt vel quos? </p></div></div>')}}}),UA=jA.setup;jA.setup=(Re,Le)=>{const Oe=useSSRContext();return(Oe.modules||(Oe.modules=new Set)).add("components/RateComponent.vue"),UA?UA(Re,Le):void 0};const VA=""+buildAssetsURL("1.B97qKlVb.jpg"),$A=""+buildAssetsURL("2.yaISrnfe.jpg"),GA=""+buildAssetsURL("3.DFAJ96x1.jpg");RA.accessToken="pk.eyJ1IjoiYXJuYXVkc3dlZW4iLCJhIjoiY20yZWZlYmRsMWtvbDJqcXhnc2QxZzBrYyJ9.Fb5BoKHGFCI8TJlLOookNQ";const qA={props:["modelValue"],data:()=>({map:null}),watch:{modelValue(Re){const Le=this.getLocation(),Oe=this.map;Le.lng==Re.lng&&Le.lat==Re.lat||Oe.setCenter({lng:Re.lng,lat:Re.lat}),Le.pitch!=Re.pitch&&Oe.setPitch(Re.pitch),Le.bearing!=Re.bearing&&Oe.setBearing(Re.bearing),Le.zoom!=Re.zoom&&Oe.setZoom(Re.zoom)}},mounted(){const{lng:Re,lat:Le,zoom:Oe,bearing:Ue,pitch:qe}=this.modelValue,Ct=new RA.Map({container:this.$refs.mapContainer,style:"mapbox://styles/arnaudsween/clx0guytu01jh01pnalln7zok",center:[Re,Le],bearing:Ue,pitch:qe,zoom:Oe}),updateLocation=()=>this.$emit("update:modelValue",this.getLocation());Ct.on("move",updateLocation),Ct.on("zoom",updateLocation),Ct.on("rotate",updateLocation),Ct.on("pitch",updateLocation),this.map=Ct},unmounted(){this.map.remove(),this.map=null},methods:{getLocation(){return{...this.map.getCenter(),bearing:this.map.getBearing(),pitch:this.map.getPitch(),zoom:this.map.getZoom()}}}};const HA=qA.setup;qA.setup=(Re,Le)=>{const Oe=useSSRContext();return(Oe.modules||(Oe.modules=new Set)).add("components/MapComponent.vue"),HA?HA(Re,Le):void 0};const WA=_export_sfc(qA,[["ssrRender",function(Re,Le,Oe,Ue,qe,Ct,Ot,Jt){Le(`<div${ssrRenderAttrs(mergeProps({ref:"mapContainer",class:"map-container h-80"},Ue))}></div>`)}]]),ZA={components:{Swiper:kA,SwiperSlide:MA,MapComponent:WA},props:{id:{type:[String,Number],required:!0}},setup:()=>({modules:[Autoplay]}),async setup(Re){const{data:Le}=await useFetch((()=>`https://jsonplaceholder.typicode.com/posts/${Re.id}`),{lazy:!0},"$9NNVypnPIA");return{post:Le}},data:()=>({location:{lng:-71.224518,lat:42.213995,bearing:0,pitch:0,zoom:9}})},XA=Object.assign(ZA,{__name:"[id]",__ssrInlineRender:!0,async setup(Re){let Le,Oe;const Ue=useRoute(),{data:qe}=([Le,Oe]=withAsyncContext((()=>useFetch((()=>"https://jsonplaceholder.typicode.com/posts/"+Ue.params.id),{lazy:!1},"$OWEHVTtrVU"))),Le=await Le,Oe(),Le);return console.log(qe),(Re,Le,Oe,Ue)=>{const Ct=jA;Le(`<div${ssrRenderAttrs(Ue)}><div class=""><div class="flextravel-card overflow-hidden rounded-3xl bg-cover"><div class="bg-white/80 p-5 sm:p-20"><div class="title flex justify-center align-middle pb-20" data-swiper-parallax="-300"><p class="pr-2 text-6xl font-bold">Welcome to <span class="text-6xl font-bold text-green-400">${ssrInterpolate(unref(qe).title.slice(0,15))}</span></p></div><div class="h-80 w-auto bg-cover bg-center bg-no-repeat rounded-3xl" style="${ssrRenderStyle({backgroundImage:`url(../img/${unref(qe).id}.jpg)`})}"></div><div class="subtitle pt-20"><p class="text-lg sm:text-2xl font-light">${ssrInterpolate(unref(qe).body.slice(0,40))}</p></div><div class="text pt-10"><p class="text-sm sm:text-lg">${ssrInterpolate(unref(qe).body)} ${ssrInterpolate(unref(qe).body)}</p></div></div></div><div class="travel-card max-w-full sm:max-w-screen mb-20 mx-1 sm:mx-auto overflow-hidden rounded-3xl">`),Le(ssrRenderComponent(WA,{modelValue:Re.location,"onUpdate:modelValue":Le=>Re.location=Le},null,Oe)),Le(`</div><div class="flextravel-card border-colors-black border-2 flex overflow-hidden rounded-3xl bg-cover mx-2 sm:mx-0"><div class="grid grid-cols-1 sm:grid-cols-2"><div class="bg-white/80 p-5 sm:py-20 sm:px-10"><div class="title"><p class="text-2xl sm:text-4xl font-bold">${ssrInterpolate(unref(qe).title)}</p></div><div class="subtitle pt-10"><p class="text-lg sm:text-2xl font-light">${ssrInterpolate(unref(qe).body.slice(0,40))}</p></div><div class="text pt-10"><p class="text-sm sm:text-lg">${ssrInterpolate(unref(qe).body)} ${ssrInterpolate(unref(qe).body)}</p></div></div><div class="bg-white/80 p-5 sm:py-20 sm:px-10"><div class="title"><p class="text-2xl sm:text-4xl font-bold">${ssrInterpolate(unref(qe).title)}</p></div><div class="subtitle pt-10"><p class="text-lg sm:text-2xl font-light">${ssrInterpolate(unref(qe).body.slice(0,40))}</p></div><div class="text pt-10"><p class="text-sm sm:text-lg">${ssrInterpolate(unref(qe).body)} ${ssrInterpolate(unref(qe).body)}</p></div></div></div></div><div class="travel-card mt-10 overflow-hidden rounded-3xl"><div class="bg-white/80 p-5 sm:p-20">`),Le(ssrRenderComponent(unref(kA),{"space-between":30,"centered-slides":!0,autoplay:{delay:2500,disableOnInteraction:!1},pagination:{clickable:!0},class:"mySwiper rounder-3xl bg-transparent"},{default:withCtx(((Re,Le,Oe,Ue)=>{if(!Le)return[createVNode(unref(MA),null,{default:withCtx((()=>[createVNode("img",{src:VA,class:"rounded-3xl bg-transparent"})])),_:1}),createVNode(unref(MA),null,{default:withCtx((()=>[createVNode("img",{src:$A,class:"rounded-3xl bg-transparent"})])),_:1}),createVNode(unref(MA),null,{default:withCtx((()=>[createVNode("img",{src:GA,class:"rounded-3xl bg-transparent"})])),_:1})];Le(ssrRenderComponent(unref(MA),null,{default:withCtx(((Re,Le,Oe,Ue)=>{if(!Le)return[createVNode("img",{src:VA,class:"rounded-3xl bg-transparent"})];Le(`<img${ssrRenderAttr("src",VA)} class="rounded-3xl bg-transparent"${Ue}>`)})),_:1},Oe,Ue)),Le(ssrRenderComponent(unref(MA),null,{default:withCtx(((Re,Le,Oe,Ue)=>{if(!Le)return[createVNode("img",{src:$A,class:"rounded-3xl bg-transparent"})];Le(`<img${ssrRenderAttr("src",$A)} class="rounded-3xl bg-transparent"${Ue}>`)})),_:1},Oe,Ue)),Le(ssrRenderComponent(unref(MA),null,{default:withCtx(((Re,Le,Oe,Ue)=>{if(!Le)return[createVNode("img",{src:GA,class:"rounded-3xl bg-transparent"})];Le(`<img${ssrRenderAttr("src",GA)} class="rounded-3xl bg-transparent"${Ue}>`)})),_:1},Oe,Ue))})),_:1},Oe)),Le('</div></div><div class="grid grid-cols-1 sm:grid-cols-3 gap-5"><div class="flextravel-card flex overflow-hidden rounded-3xl bg-cover">'),Le(ssrRenderComponent(Ct,null,null,Oe)),Le('</div><div class="flextravel-card flex overflow-hidden rounded-3xl bg-cover">'),Le(ssrRenderComponent(Ct,null,null,Oe)),Le('</div><div class="flextravel-card flex overflow-hidden rounded-3xl bg-cover">'),Le(ssrRenderComponent(Ct,null,null,Oe)),Le("</div></div></div></div>")}}}),YA=XA.setup;XA.setup=(Re,Le)=>{const Oe=useSSRContext();return(Oe.modules||(Oe.modules=new Set)).add("pages/destinations/[id].vue"),YA?YA(Re,Le):void 0};const KA=Object.freeze(Object.defineProperty({__proto__:null,default:XA},Symbol.toStringTag,{value:"Module"}));async function preloadRouteComponents(Re,Le=useRouter()){}function defineNuxtLink(Re){function resolveTrailingSlashBehavior(Le,Oe){if(!Le||"append"!==Re.trailingSlash&&"remove"!==Re.trailingSlash)return Le;if("string"==typeof Le)return applyTrailingSlashBehavior(Le,Re.trailingSlash);const Ue="path"in Le&&void 0!==Le.path?Le.path:Oe(Le).path;return{...Le,name:void 0,path:applyTrailingSlashBehavior(Ue,Re.trailingSlash)}}function useNuxtLink(Re){var Le,Oe,Ue;const qe=useRouter(),Ct=useRuntimeConfig(),Ot=computed((()=>!!Re.target&&"_self"!==Re.target)),Jt=computed((()=>{const Le=Re.to||Re.href||"";return"string"==typeof Le&&hasProtocol(Le,{acceptRelative:!0})})),Hr=resolveComponent("RouterLink"),Jr=Hr&&"string"!=typeof Hr?Hr.useLink:void 0,Ln=computed((()=>{if(Re.external)return!0;const Le=Re.to||Re.href||"";return"object"!=typeof Le&&(""===Le||Jt.value)})),Nn=computed((()=>{const Le=Re.to||Re.href||"";return Ln.value?Le:resolveTrailingSlashBehavior(Le,qe.resolve)})),$n=Ln.value||null==Jr?void 0:Jr({...Re,to:Nn}),Gn=computed((()=>{var Re,Le;if(!Nn.value||Jt.value)return Nn.value;if(Ln.value){const Re="object"==typeof Nn.value&&"path"in Nn.value?resolveRouteObject(Nn.value):Nn.value;return resolveTrailingSlashBehavior("object"==typeof Re?qe.resolve(Re).href:Re,qe.resolve)}return"object"==typeof Nn.value?null!=(Re=null==(Le=qe.resolve(Nn.value))?void 0:Le.href)?Re:null:resolveTrailingSlashBehavior(joinURL(Ct.app.baseURL,Nn.value),qe.resolve)}));return{to:Nn,hasTarget:Ot,isAbsoluteUrl:Jt,isExternal:Ln,href:Gn,isActive:null!=(Le=null==$n?void 0:$n.isActive)?Le:computed((()=>Nn.value===qe.currentRoute.value.path)),isExactActive:null!=(Oe=null==$n?void 0:$n.isExactActive)?Oe:computed((()=>Nn.value===qe.currentRoute.value.path)),route:null!=(Ue=null==$n?void 0:$n.route)?Ue:computed((()=>qe.resolve(Nn.value))),async navigate(){await navigateTo(Gn.value,{replace:Re.replace,external:Ln.value||Ot.value})}}}return defineComponent({name:Re.componentName||"NuxtLink",props:{to:{type:[String,Object],default:void 0,required:!1},href:{type:[String,Object],default:void 0,required:!1},target:{type:String,default:void 0,required:!1},rel:{type:String,default:void 0,required:!1},noRel:{type:Boolean,default:void 0,required:!1},prefetch:{type:Boolean,default:void 0,required:!1},prefetchOn:{type:[String,Object],default:void 0,required:!1},noPrefetch:{type:Boolean,default:void 0,required:!1},activeClass:{type:String,default:void 0,required:!1},exactActiveClass:{type:String,default:void 0,required:!1},prefetchedClass:{type:String,default:void 0,required:!1},replace:{type:Boolean,default:void 0,required:!1},ariaCurrentValue:{type:String,default:void 0,required:!1},external:{type:Boolean,default:void 0,required:!1},custom:{type:Boolean,default:void 0,required:!1}},useLink:useNuxtLink,setup(Le,{slots:Oe}){const Ue=useRouter(),{to:qe,href:Ct,navigate:Ot,isExternal:Jt,hasTarget:Hr,isAbsoluteUrl:Jr}=useNuxtLink(Le),Ln=ref(!1);async function prefetch(Re=useNuxtApp()){if(Ln.value)return;Ln.value=!0;const Le="string"==typeof qe.value?qe.value:Jt.value?resolveRouteObject(qe.value):Ue.resolve(qe.value).fullPath;await Promise.all([Re.hooks.callHook("link:prefetch",Le).catch((()=>{})),!Jt.value&&!Hr.value&&preloadRouteComponents(qe.value,Ue).catch((()=>{}))])}return()=>{var Ue;if(!Jt.value&&!Hr.value){const Ue={ref:undefined,to:qe.value,activeClass:Le.activeClass||Re.activeClass,exactActiveClass:Le.exactActiveClass||Re.exactActiveClass,replace:Le.replace,ariaCurrentValue:Le.ariaCurrentValue,custom:Le.custom};return Le.custom||(function(Oe){var Ue,qe,Ct,Ot;return!Ln.value&&("string"==typeof Le.prefetchOn?Le.prefetchOn===Oe:null!=(Ue=null==(Ct=Le.prefetchOn)?void 0:Ct[Oe])?Ue:null==(Ot=Re.prefetchOn)?void 0:Ot[Oe])&&!1!==(null!=(qe=Le.prefetch)?qe:Re.prefetch)&&!0!==Le.noPrefetch&&"_blank"!==Le.target&&!0}("interaction")&&(Ue.onPointerenter=prefetch.bind(null,void 0),Ue.onFocus=prefetch.bind(null,void 0)),Ln.value&&(Ue.class=Le.prefetchedClass||Re.prefetchedClass),Ue.rel=Le.rel||void 0),h(resolveComponent("RouterLink"),Ue,Oe.default)}const Nn=Le.target||null,$n=((...Re)=>Re.find((Re=>void 0!==Re)))(Le.noRel?"":Le.rel,Re.externalRelAttribute,Jr.value||Hr.value?"noopener noreferrer":"")||null;return Le.custom?Oe.default?Oe.default({href:Ct.value,navigate:Ot,prefetch:prefetch,get route(){if(!Ct.value)return;const Re=new URL(Ct.value,"http://localhost");return{path:Re.pathname,fullPath:Re.pathname,get query(){return parseQuery(Re.search)},hash:Re.hash,params:{},name:void 0,matched:[],redirectedFrom:void 0,meta:{},href:Ct.value}},rel:$n,target:Nn,isExternal:Jt.value||Hr.value,isActive:!1,isExactActive:!1}):null:h("a",{ref:undefined,href:Ct.value||null,rel:$n,target:Nn},null==(Ue=Oe.default)?void 0:Ue.call(Oe))}}})}const JA=defineNuxtLink(yS);function applyTrailingSlashBehavior(Re,Le){const Oe="append"===Le?withTrailingSlash:withoutTrailingSlash;return hasProtocol(Re)&&!Re.startsWith("http")?Re:Oe(Re,!0)}const QA={props:{id:{type:[String,Number],required:!0}},async setup(Re){const{data:Le}=await useFetch((()=>`https://jsonplaceholder.typicode.com/posts/${Re.id}`),{lazy:!0},"$XkTrG25Ff8"),{data:Oe}=await useFetch((()=>`https://jsonplaceholder.typicode.com/photos/${Re.id}`),{lazy:!0},"$zEBahArpRh");return{post:Le,image:Oe}}};const eI=QA.setup;QA.setup=(Re,Le)=>{const Oe=useSSRContext();return(Oe.modules||(Oe.modules=new Set)).add("components/TravelCard.vue"),eI?eI(Re,Le):void 0};const tI=_export_sfc(QA,[["ssrRender",function(Re,Le,Oe,Ue,qe,Ct,Ot,Jt){Le(ssrRenderComponent(JA,mergeProps({to:`/destinations/${Ct.post.id}`},Ue),{default:withCtx(((Re,Le,Oe,Ue)=>{if(!Le)return[createVNode("div",{class:"travel-card overflow-hidden rounded-3xl bg-cover",style:{backgroundImage:`url(../img/${Ct.post.id}.jpg)`}},[createVNode("div",{class:"bg-white/50 p-5 text-left text-black transition-colors duration-500 ease-in-out hover:bg-black/30 hover:text-white sm:p-20"},[createVNode("div",{class:"grid grid-cols-2 justify-between"},[createVNode("div",{class:"title","data-swiper-parallax":"-300"},[createVNode("p",{class:"text-xl sm:text-4xl font-bold"},toDisplayString$1(Ct.post.title.charAt(0).toUpperCase()+Ct.post.title.slice(1,20)),1)]),createVNode("div",{class:"flex flex-wrap h-min justify-end"},[createVNode("div",{class:"text-xs sm:text-lg tag px-4 py-2 m-1 rounded-3xl border-2 border-orange-500 bg-orange-500 text-white"},[createVNode("span",null,"Popular destination")]),createVNode("div",{class:"text-xs sm:text-lg tag px-4 py-2 m-1 rounded-3xl border-2 border-green-500 text-white bg-green-500"},[createVNode("span",null,"Best for adventure")])])]),createVNode("div",{class:"subtitle pt-10","data-swiper-parallax":"-200"},[createVNode("p",{class:"text-md sm:text-2xl font-light"},toDisplayString$1(Ct.post.body.slice(0,25)),1)]),createVNode("div",{class:"text pt-4 sm:pt-10","data-swiper-parallax":"-100"},[createVNode("p",{class:"text-xs sm:text-lg"},toDisplayString$1(Ct.post.body.slice(0,100))+" "+toDisplayString$1(Ct.post.body.slice(0,100)),1)]),createVNode("div",{class:"mt-auto flex pl-1 pt-10"},[createVNode("div",{class:"button border-3 mb-2 me-2 rounded-lg border border-black px-5 py-2.5 text-center text-sm font-medium text-black"}," Voir les activités ")])])],4)];Le(`<div class="travel-card overflow-hidden rounded-3xl bg-cover" style="${ssrRenderStyle({backgroundImage:`url(../img/${Ct.post.id}.jpg)`})}"${Ue}><div class="bg-white/50 p-5 text-left text-black transition-colors duration-500 ease-in-out hover:bg-black/30 hover:text-white sm:p-20"${Ue}><div class="grid grid-cols-2 justify-between"${Ue}><div class="title" data-swiper-parallax="-300"${Ue}><p class="text-xl sm:text-4xl font-bold"${Ue}>${ssrInterpolate(Ct.post.title.charAt(0).toUpperCase()+Ct.post.title.slice(1,20))}</p></div><div class="flex flex-wrap h-min justify-end"${Ue}><div class="text-xs sm:text-lg tag px-4 py-2 m-1 rounded-3xl border-2 border-orange-500 bg-orange-500 text-white"${Ue}><span${Ue}>Popular destination</span></div><div class="text-xs sm:text-lg tag px-4 py-2 m-1 rounded-3xl border-2 border-green-500 text-white bg-green-500"${Ue}><span${Ue}>Best for adventure</span></div></div></div><div class="subtitle pt-10" data-swiper-parallax="-200"${Ue}><p class="text-md sm:text-2xl font-light"${Ue}>${ssrInterpolate(Ct.post.body.slice(0,25))}</p></div><div class="text pt-4 sm:pt-10" data-swiper-parallax="-100"${Ue}><p class="text-xs sm:text-lg"${Ue}>${ssrInterpolate(Ct.post.body.slice(0,100))} ${ssrInterpolate(Ct.post.body.slice(0,100))}</p></div><div class="mt-auto flex pl-1 pt-10"${Ue}><div class="button border-3 mb-2 me-2 rounded-lg border border-black px-5 py-2.5 text-center text-sm font-medium text-black"${Ue}> Voir les activités </div></div></div></div>`)})),_:1},Oe))}]]),rI={components:{TravelCard:tI}},nI=Object.assign(rI,{__name:"index",__ssrInlineRender:!0,async setup(Re){let Le,Oe;const{data:Ue}=([Le,Oe]=withAsyncContext((()=>useFetch("https://jsonplaceholder.typicode.com/posts?_limit=5","$2VseBSWVGs"))),Le=await Le,Oe(),Le);return(Re,Le,Oe,qe)=>{Le(`<div${ssrRenderAttrs(mergeProps({class:"destinations"},qe))}><main class="text-white px-2 sm:px-10 grid gap-4 grid-cols-1 sm:grid-cols-2">\x3c!--[--\x3e`),ssrRenderList(unref(Ue),(Re=>{Le('<div class="rounded-2xl">'),Le(ssrRenderComponent(tI,{id:Re.id},null,Oe)),Le("</div>")})),Le("\x3c!--]--\x3e</main></div>")}}}),iI=nI.setup;nI.setup=(Re,Le)=>{const Oe=useSSRContext();return(Oe.modules||(Oe.modules=new Set)).add("pages/destinations/index.vue"),iI?iI(Re,Le):void 0};const oI=Object.freeze(Object.defineProperty({__proto__:null,default:nI},Symbol.toStringTag,{value:"Module"}));AA.use(Autoplay);const sI={components:{Swiper:kA,SwiperSlide:MA,TravelCard:tI},setup:()=>({modules:[Parallax,Autoplay]})},aI=Object.assign(sI,{__name:"HomeCards",__ssrInlineRender:!0,async setup(Re){let Le,Oe;const{data:Ue}=([Le,Oe]=withAsyncContext((()=>useFetch("https://jsonplaceholder.typicode.com/posts?_limit=5","$UQWPkjiFTi"))),Le=await Le,Oe(),Le);return(Re,Le,Oe,qe)=>{Le(ssrRenderComponent(unref(kA),mergeProps({style:{"--swiper-navigation-color":"#fff","--swiper-pagination-color":"#fff"},speed:600,parallax:!0,lazy:!0,"space-between":20,autoplay:{delay:2500,autoplay:!0},class:"mySwiper rounded-3xl"},qe),{"container-start":withCtx(((Re,Le,Oe,Ue)=>{if(!Le)return[]})),default:withCtx(((Re,Le,Oe,qe)=>{if(!Le)return[(openBlock(!0),createBlock(Db,null,renderList(unref(Ue),(Re=>(openBlock(),createBlock(unref(MA),{key:Re.id,class:"parallax-bg","data-swiper-parallax":"-23%"},{default:withCtx((()=>[createVNode(tI,{id:Re.id},null,8,["id"])])),_:2},1024)))),128))];Le("\x3c!--[--\x3e"),ssrRenderList(unref(Ue),(Re=>{Le(ssrRenderComponent(unref(MA),{key:Re.id,class:"parallax-bg","data-swiper-parallax":"-23%"},{default:withCtx(((Le,Oe,Ue,qe)=>{if(!Oe)return[createVNode(tI,{id:Re.id},null,8,["id"])];Oe(ssrRenderComponent(tI,{id:Re.id},null,Ue,qe))})),_:2},Oe,qe))})),Le("\x3c!--]--\x3e")})),_:1},Oe))}}}),lI=aI.setup;aI.setup=(Re,Le)=>{const Oe=useSSRContext();return(Oe.modules||(Oe.modules=new Set)).add("components/HomeCards.vue"),lI?lI(Re,Le):void 0};const cI=defineComponent({__name:"index",__ssrInlineRender:!0,setup(Re){const{t:Le}=useI18n();return useHead({title:Le("pages.index.meta.title"),meta:[{name:"description",content:Le("pages.index.meta.description")}]}),useSeoMeta({title:Le("pages.index.meta.title"),description:Le("pages.index.meta.description")}),(Re,Le,Oe,Ue)=>{const qe=aI;Le(`<div${ssrRenderAttrs(mergeProps({class:"mb-10 mt-5 px-3"},Ue))}><ul class="overflow"><li><section class="pt-10 max-h-min min-w-14">`),Le(ssrRenderComponent(qe,null,null,Oe)),Le("</section></li></ul></div>")}}}),uI=cI.setup;cI.setup=(Re,Le)=>{const Oe=useSSRContext();return(Oe.modules||(Oe.modules=new Set)).add("pages/index.vue"),uI?uI(Re,Le):void 0};const hI=Object.freeze(Object.defineProperty({__proto__:null,default:cI},Symbol.toStringTag,{value:"Module"})),dI=Object.freeze({left:0,top:0,width:16,height:16}),pI=Object.freeze({rotate:0,vFlip:!1,hFlip:!1}),fI=Object.freeze({...dI,...pI});Object.freeze({...fI,body:"",hidden:!1});const mI=Object.freeze({width:null,height:null}),gI=Object.freeze({...mI,...pI});const _I=/[\s,]+/;function flipFromString(Re,Le){Le.split(_I).forEach((Le=>{switch(Le.trim()){case"horizontal":Re.hFlip=!0;break;case"vertical":Re.vFlip=!0}}))}function rotateFromString(Re,Le=0){const Oe=Re.replace(/^-?[0-9.]*/,"");function cleanup(Re){for(;Re<0;)Re+=4;return Re%4}if(""===Oe){const Le=parseInt(Re);return isNaN(Le)?0:cleanup(Le)}if(Oe!==Re){let Le=0;switch(Oe){case"%":Le=25;break;case"deg":Le=90}if(Le){let Ue=parseFloat(Re.slice(0,Re.length-Oe.length));return isNaN(Ue)?0:(Ue/=Le,Ue%1==0?cleanup(Ue):0)}}return Le}const yI=/(-?[0-9.]*[0-9]+[0-9.]*)/g,vI=/^-?[0-9.]*[0-9]+[0-9.]*$/g;function calculateSize(Re,Le,Oe){if(1===Le)return Re;if(Oe=Oe||100,"number"==typeof Re)return Math.ceil(Re*Le*Oe)/Oe;if("string"!=typeof Re)return Re;const Ue=Re.split(yI);if(null===Ue||!Ue.length)return Re;const qe=[];let Ct=Ue.shift(),Ot=vI.test(Ct);for(;;){if(Ot){const Re=parseFloat(Ct);isNaN(Re)?qe.push(Ct):qe.push(Math.ceil(Re*Le*Oe)/Oe)}else qe.push(Ct);if(Ct=Ue.shift(),void 0===Ct)return qe.join("");Ot=!Ot}}const xI=/\sid="(\S+)"/g,bI="IconifyId"+Date.now().toString(16)+(16777216*Math.random()|0).toString(16);let wI=0;const TI={...gI,inline:!1},SI={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","aria-hidden":!0,role:"img"},EI={display:"inline-block"},CI={backgroundColor:"currentColor"},AI={backgroundColor:"transparent"},II={Image:"var(--svg)",Repeat:"no-repeat",Size:"100% 100%"},kI={webkitMask:CI,mask:CI,background:AI};for(const Re in kI){const Le=kI[Re];for(const Oe in II)Le[Re+Oe]=II[Oe]}const MI={};function fixSize(Re){return Re+(Re.match(/^[-0-9.]+$/)?"px":"")}["horizontal","vertical"].forEach((Re=>{const Le=Re.slice(0,1)+"Flip";MI[Re+"-flip"]=Le,MI[Re.slice(0,1)+"-flip"]=Le,MI[Re+"Flip"]=Le}));const render=(Re,Le)=>{const Oe=function(Re,Le){const Oe={...Re};for(const Re in Le){const Ue=Le[Re],qe=typeof Ue;Re in mI?(null===Ue||Ue&&("string"===qe||"number"===qe))&&(Oe[Re]=Ue):qe===typeof Oe[Re]&&(Oe[Re]="rotate"===Re?Ue%4:Ue)}return Oe}(TI,Le),Ue={...SI},qe=Le.mode||"svg",Ct={},Ot=Le.style,Jt="object"!=typeof Ot||Ot instanceof Array?{}:Ot;for(let Re in Le){const qe=Le[Re];if(void 0!==qe)switch(Re){case"icon":case"style":case"onLoad":case"mode":break;case"inline":case"hFlip":case"vFlip":Oe[Re]=!0===qe||"true"===qe||1===qe;break;case"flip":"string"==typeof qe&&flipFromString(Oe,qe);break;case"color":Ct.color=qe;break;case"rotate":"string"==typeof qe?Oe[Re]=rotateFromString(qe):"number"==typeof qe&&(Oe[Re]=qe);break;case"ariaHidden":case"aria-hidden":!0!==qe&&"true"!==qe&&delete Ue["aria-hidden"];break;default:{const Le=MI[Re];Le?!0!==qe&&"true"!==qe&&1!==qe||(Oe[Le]=!0):void 0===TI[Re]&&(Ue[Re]=qe)}}}const Hr=function(Re,Le){const Oe={...fI,...Re},Ue={...gI,...Le},qe={left:Oe.left,top:Oe.top,width:Oe.width,height:Oe.height};let Ct=Oe.body;[Oe,Ue].forEach((Re=>{const Le=[],Oe=Re.hFlip,Ue=Re.vFlip;let Ot,Jt=Re.rotate;switch(Oe?Ue?Jt+=2:(Le.push("translate("+(qe.width+qe.left).toString()+" "+(0-qe.top).toString()+")"),Le.push("scale(-1 1)"),qe.top=qe.left=0):Ue&&(Le.push("translate("+(0-qe.left).toString()+" "+(qe.height+qe.top).toString()+")"),Le.push("scale(1 -1)"),qe.top=qe.left=0),Jt<0&&(Jt-=4*Math.floor(Jt/4)),Jt%=4,Jt){case 1:Ot=qe.height/2+qe.top,Le.unshift("rotate(90 "+Ot.toString()+" "+Ot.toString()+")");break;case 2:Le.unshift("rotate(180 "+(qe.width/2+qe.left).toString()+" "+(qe.height/2+qe.top).toString()+")");break;case 3:Ot=qe.width/2+qe.left,Le.unshift("rotate(-90 "+Ot.toString()+" "+Ot.toString()+")")}Jt%2==1&&(qe.left!==qe.top&&(Ot=qe.left,qe.left=qe.top,qe.top=Ot),qe.width!==qe.height&&(Ot=qe.width,qe.width=qe.height,qe.height=Ot)),Le.length&&(Ct=function(Re,Le,Oe){const Ue=function(Re,Le="defs"){let Oe="";const Ue=Re.indexOf("<"+Le);for(;Ue>=0;){const qe=Re.indexOf(">",Ue),Ct=Re.indexOf("</"+Le);if(-1===qe||-1===Ct)break;const Ot=Re.indexOf(">",Ct);if(-1===Ot)break;Oe+=Re.slice(qe+1,Ct).trim(),Re=Re.slice(0,Ue).trim()+Re.slice(Ot+1)}return{defs:Oe,content:Re}}(Re);return qe=Ue.defs,Ct=Le+Ue.content+Oe,qe?"<defs>"+qe+"</defs>"+Ct:Ct;var qe,Ct}(Ct,'<g transform="'+Le.join(" ")+'">',"</g>"))}));const Ot=Ue.width,Jt=Ue.height,Hr=qe.width,Jr=qe.height;let Ln,Nn;null===Ot?(Nn=null===Jt?"1em":"auto"===Jt?Jr:Jt,Ln=calculateSize(Nn,Hr/Jr)):(Ln="auto"===Ot?Hr:Ot,Nn=null===Jt?calculateSize(Ln,Jr/Hr):"auto"===Jt?Jr:Jt);const $n={},setAttr=(Re,Le)=>{(Re=>"unset"===Re||"undefined"===Re||"none"===Re)(Le)||($n[Re]=Le.toString())};setAttr("width",Ln),setAttr("height",Nn);const Gn=[qe.left,qe.top,Hr,Jr];return $n.viewBox=Gn.join(" "),{attributes:$n,viewBox:Gn,body:Ct}}(Re,Oe),Jr=Hr.attributes;if(Oe.inline&&(Ct.verticalAlign="-0.125em"),"svg"===qe){Ue.style={...Ct,...Jt},Object.assign(Ue,Jr);let Re=0,Oe=Le.id;return"string"==typeof Oe&&(Oe=Oe.replace(/-/g,"_")),Ue.innerHTML=function(Re,Le=bI){const Oe=[];let Ue;for(;Ue=xI.exec(Re);)Oe.push(Ue[1]);if(!Oe.length)return Re;const qe="suffix"+(16777216*Math.random()|Date.now()).toString(16);return Oe.forEach((Oe=>{const Ue="function"==typeof Le?Le(Oe):Le+(wI++).toString(),Ct=Oe.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");Re=Re.replace(new RegExp('([#;"])('+Ct+')([")]|\\.[a-z])',"g"),"$1"+Ue+qe+"$3")})),Re=Re.replace(new RegExp(qe,"g"),"")}(Hr.body,Oe?()=>Oe+"ID"+Re++:"iconifyVue"),h("svg",Ue)}const{body:Ln,width:Nn,height:$n}=Re,Gn="mask"===qe||"bg"!==qe&&-1!==Ln.indexOf("currentColor"),qn=function(Re,Le){let Oe=-1===Re.indexOf("xlink:")?"":' xmlns:xlink="http://www.w3.org/1999/xlink"';for(const Re in Le)Oe+=" "+Re+'="'+Le[Re]+'"';return'<svg xmlns="http://www.w3.org/2000/svg"'+Oe+">"+Re+"</svg>"}(Ln,{...Jr,width:Nn+"",height:$n+""});var Zn;return Ue.style={...Ct,"--svg":(Zn=qn,'url("'+function(Re){return"data:image/svg+xml,"+function(Re){return Re.replace(/"/g,"'").replace(/%/g,"%25").replace(/#/g,"%23").replace(/</g,"%3C").replace(/>/g,"%3E").replace(/\s+/g," ")}(Re)}(Zn)+'")'),width:fixSize(Jr.width),height:fixSize(Jr.height),...EI,...Gn?CI:AI,...Jt},h("span",Ue)},PI=Object.create(null),RI=defineComponent({inheritAttrs:!1,render(){const Re=this.$attrs,Le=Re.icon,Oe="string"==typeof Le?PI[Le]:"object"==typeof Le?Le:null;return null===Oe||"object"!=typeof Oe||"string"!=typeof Oe.body?this.$slots.default?this.$slots.default():null:render({...fI,...Oe},Re)}}),LI=/^[a-z0-9]+(-[a-z0-9]+)*$/,stringToIcon=(Re,Le,Oe,Ue="")=>{const qe=Re.split(":");if("@"===Re.slice(0,1)){if(qe.length<2||qe.length>3)return null;Ue=qe.shift().slice(1)}if(qe.length>3||!qe.length)return null;if(qe.length>1){const Re=qe.pop(),Oe=qe.pop(),Ct={provider:qe.length>0?qe[0]:Ue,prefix:Oe,name:Re};return Le&&!validateIconName(Ct)?null:Ct}const Ct=qe[0],Ot=Ct.split("-");if(Ot.length>1){const Re={provider:Ue,prefix:Ot.shift(),name:Ot.join("-")};return Le&&!validateIconName(Re)?null:Re}if(Oe&&""===Ue){const Re={provider:Ue,prefix:"",name:Ct};return Le&&!validateIconName(Re,Oe)?null:Re}return null},validateIconName=(Re,Le)=>!!Re&&!(""!==Re.provider&&!Re.provider.match(LI)||!(Le&&""===Re.prefix||Re.prefix.match(LI))||!Re.name.match(LI)),OI=Object.freeze({left:0,top:0,width:16,height:16}),zI=Object.freeze({rotate:0,vFlip:!1,hFlip:!1}),DI=Object.freeze({...OI,...zI}),BI=Object.freeze({...DI,body:"",hidden:!1});function mergeIconData(Re,Le){const Oe=function(Re,Le){const Oe={};!Re.hFlip!=!Le.hFlip&&(Oe.hFlip=!0),!Re.vFlip!=!Le.vFlip&&(Oe.vFlip=!0);const Ue=((Re.rotate||0)+(Le.rotate||0))%4;return Ue&&(Oe.rotate=Ue),Oe}(Re,Le);for(const Ue in BI)Ue in zI?Ue in Re&&!(Ue in Oe)&&(Oe[Ue]=zI[Ue]):Ue in Le?Oe[Ue]=Le[Ue]:Ue in Re&&(Oe[Ue]=Re[Ue]);return Oe}function internalGetIconData(Re,Le,Oe){const Ue=Re.icons,qe=Re.aliases||Object.create(null);let Ct={};function parse(Re){Ct=mergeIconData(Ue[Re]||qe[Re],Ct)}return parse(Le),Oe.forEach(parse),mergeIconData(Re,Ct)}function parseIconSet(Re,Le){const Oe=[];if("object"!=typeof Re||"object"!=typeof Re.icons)return Oe;Re.not_found instanceof Array&&Re.not_found.forEach((Re=>{Le(Re,null),Oe.push(Re)}));const Ue=function(Re){const Le=Re.icons,Oe=Re.aliases||Object.create(null),Ue=Object.create(null);return Object.keys(Le).concat(Object.keys(Oe)).forEach((function resolve(Re){if(Le[Re])return Ue[Re]=[];if(!(Re in Ue)){Ue[Re]=null;const Le=Oe[Re]&&Oe[Re].parent,qe=Le&&resolve(Le);qe&&(Ue[Re]=[Le].concat(qe))}return Ue[Re]})),Ue}(Re);for(const qe in Ue){const Ct=Ue[qe];Ct&&(Le(qe,internalGetIconData(Re,qe,Ct)),Oe.push(qe))}return Oe}const FI={provider:"",aliases:{},not_found:{},...OI};function checkOptionalProps(Re,Le){for(const Oe in Le)if(Oe in Re&&typeof Re[Oe]!=typeof Le[Oe])return!1;return!0}function quicklyValidateIconSet(Re){if("object"!=typeof Re||null===Re)return null;const Le=Re;if("string"!=typeof Le.prefix||!Re.icons||"object"!=typeof Re.icons)return null;if(!checkOptionalProps(Re,FI))return null;const Oe=Le.icons;for(const Re in Oe){const Le=Oe[Re];if(!Re.match(LI)||"string"!=typeof Le.body||!checkOptionalProps(Le,BI))return null}const Ue=Le.aliases||Object.create(null);for(const Re in Ue){const Le=Ue[Re],qe=Le.parent;if(!Re.match(LI)||"string"!=typeof qe||!Oe[qe]&&!Ue[qe]||!checkOptionalProps(Le,BI))return null}return Le}const NI=Object.create(null);function getStorage(Re,Le){const Oe=NI[Re]||(NI[Re]=Object.create(null));return Oe[Le]||(Oe[Le]=function(Re,Le){return{provider:Re,prefix:Le,icons:Object.create(null),missing:new Set}}(Re,Le))}function addIconSet(Re,Le){return quicklyValidateIconSet(Le)?parseIconSet(Le,((Le,Oe)=>{Oe?Re.icons[Le]=Oe:Re.missing.add(Le)})):[]}let jI=!1;function allowSimpleNames(Re){return"boolean"==typeof Re&&(jI=Re),jI}const UI=Object.freeze({width:null,height:null});Object.freeze({...UI,...zI});Date.now().toString(16),(16777216*Math.random()|0).toString(16);const VI=Object.create(null);function getAPIModule(Re){return VI[Re]||VI[""]}function createAPIConfig(Re){let Le;if("string"==typeof Re.resources)Le=[Re.resources];else if(Le=Re.resources,!(Le instanceof Array&&Le.length))return null;return{resources:Le,path:Re.path||"/",maxURL:Re.maxURL||500,rotate:Re.rotate||750,timeout:Re.timeout||5e3,random:!0===Re.random,index:Re.index||0,dataAfterTimeout:!1!==Re.dataAfterTimeout}}const $I=Object.create(null),GI=["https://api.simplesvg.com","https://api.unisvg.com"],qI=[];for(;GI.length>0;)1===GI.length||Math.random()>.5?qI.push(GI.shift()):qI.push(GI.pop());function addAPIProvider(Re,Le){const Oe=createAPIConfig(Le);return null!==Oe&&($I[Re]=Oe,!0)}function getAPIConfig(Re){return $I[Re]}$I[""]=createAPIConfig({resources:["https://api.iconify.design"].concat(qI)});let HI=(()=>{let Re;try{if(Re=fetch,"function"==typeof Re)return Re}catch(Re){}})();const WI={prepare:(Re,Le,Oe)=>{const Ue=[],qe=function(Re,Le){const Oe=getAPIConfig(Re);if(!Oe)return 0;let Ue;if(Oe.maxURL){let Re=0;Oe.resources.forEach((Le=>{const Oe=Le;Re=Math.max(Re,Oe.length)}));const qe=Le+".json?icons=";Ue=Oe.maxURL-Re-Oe.path.length-qe.length}else Ue=0;return Ue}(Re,Le),Ct="icons";let Ot={type:Ct,provider:Re,prefix:Le,icons:[]},Jt=0;return Oe.forEach(((Oe,Hr)=>{Jt+=Oe.length+1,Jt>=qe&&Hr>0&&(Ue.push(Ot),Ot={type:Ct,provider:Re,prefix:Le,icons:[]},Jt=Oe.length),Ot.icons.push(Oe)})),Ue.push(Ot),Ue},send:(Re,Le,Oe)=>{if(!HI)return void Oe("abort",424);let Ue=function(Re){if("string"==typeof Re){const Le=getAPIConfig(Re);if(Le)return Le.path}return"/"}(Le.provider);switch(Le.type){case"icons":{const Re=Le.prefix,Oe=Le.icons.join(",");Ue+=Re+".json?"+new URLSearchParams({icons:Oe}).toString();break}case"custom":{const Re=Le.uri;Ue+="/"===Re.slice(0,1)?Re.slice(1):Re;break}default:return void Oe("abort",400)}let qe=503;HI(Re+Ue).then((Re=>{const Le=Re.status;if(200===Le)return qe=501,Re.json();setTimeout((()=>{Oe(function(Re){return 404===Re}(Le)?"abort":"next",Le)}))})).then((Re=>{"object"==typeof Re&&null!==Re?setTimeout((()=>{Oe("success",Re)})):setTimeout((()=>{404===Re?Oe("abort",Re):Oe("next",qe)}))})).catch((()=>{Oe("next",qe)}))}};function removeCallback(Re,Le){Re.forEach((Re=>{const Oe=Re.loaderCallbacks;Oe&&(Re.loaderCallbacks=Oe.filter((Re=>Re.id!==Le)))}))}let ZI=0;var XI={resources:[],index:0,timeout:2e3,rotate:750,random:!1,dataAfterTimeout:!1};function sendQuery(Re,Le,Oe,Ue){const qe=Re.resources.length,Ct=Re.random?Math.floor(Math.random()*qe):Re.index;let Ot;if(Re.random){let Le=Re.resources.slice(0);for(Ot=[];Le.length>1;){const Re=Math.floor(Math.random()*Le.length);Ot.push(Le[Re]),Le=Le.slice(0,Re).concat(Le.slice(Re+1))}Ot=Ot.concat(Le)}else Ot=Re.resources.slice(Ct).concat(Re.resources.slice(0,Ct));const Jt=Date.now();let Hr,Jr="pending",Ln=0,Nn=null,$n=[],Gn=[];function resetTimer(){Nn&&(clearTimeout(Nn),Nn=null)}function abort(){"pending"===Jr&&(Jr="aborted"),resetTimer(),$n.forEach((Re=>{"pending"===Re.status&&(Re.status="aborted")})),$n=[]}function subscribe(Re,Le){Le&&(Gn=[]),"function"==typeof Re&&Gn.push(Re)}function failQuery(){Jr="failed",Gn.forEach((Re=>{Re(void 0,Hr)}))}function clearQueue(){$n.forEach((Re=>{"pending"===Re.status&&(Re.status="aborted")})),$n=[]}function execNext(){if("pending"!==Jr)return;resetTimer();const Ue=Ot.shift();if(void 0===Ue)return $n.length?void(Nn=setTimeout((()=>{resetTimer(),"pending"===Jr&&(clearQueue(),failQuery())}),Re.timeout)):void failQuery();const qe={status:"pending",resource:Ue,callback:(Le,Oe)=>{!function(Le,Oe,Ue){const qe="success"!==Oe;switch($n=$n.filter((Re=>Re!==Le)),Jr){case"pending":break;case"failed":if(qe||!Re.dataAfterTimeout)return;break;default:return}if("abort"===Oe)return Hr=Ue,void failQuery();if(qe)return Hr=Ue,void($n.length||(Ot.length?execNext():failQuery()));if(resetTimer(),clearQueue(),!Re.random){const Oe=Re.resources.indexOf(Le.resource);-1!==Oe&&Oe!==Re.index&&(Re.index=Oe)}Jr="completed",Gn.forEach((Re=>{Re(Ue)}))}(qe,Le,Oe)}};$n.push(qe),Ln++,Nn=setTimeout(execNext,Re.rotate),Oe(Ue,Le,qe.callback)}return"function"==typeof Ue&&Gn.push(Ue),setTimeout(execNext),function(){return{startTime:Jt,payload:Le,status:Jr,queriesSent:Ln,queriesPending:$n.length,subscribe:subscribe,abort:abort}}}function initRedundancy(Re){const Le={...XI,...Re};let Oe=[];function cleanup(){Oe=Oe.filter((Re=>"pending"===Re().status))}const Ue={query:function(Re,Ue,qe){const Ct=sendQuery(Le,Re,Ue,((Re,Le)=>{cleanup(),qe&&qe(Re,Le)}));return Oe.push(Ct),Ct},find:function(Re){return Oe.find((Le=>Re(Le)))||null},setIndex:Re=>{Le.index=Re},getIndex:()=>Le.index,cleanup:cleanup};return Ue}function emptyCallback$1(){}const YI=Object.create(null);function sendAPIQuery(Re,Le,Oe){let Ue,qe;if("string"==typeof Re){const Le=getAPIModule(Re);if(!Le)return Oe(void 0,424),emptyCallback$1;qe=Le.send;const Ct=function(Re){if(!YI[Re]){const Le=getAPIConfig(Re);if(!Le)return;const Oe={config:Le,redundancy:initRedundancy(Le)};YI[Re]=Oe}return YI[Re]}(Re);Ct&&(Ue=Ct.redundancy)}else{const Le=createAPIConfig(Re);if(Le){Ue=initRedundancy(Le);const Oe=getAPIModule(Re.resources?Re.resources[0]:"");Oe&&(qe=Oe.send)}}return Ue&&qe?Ue.query(Le,qe,Oe)().abort:(Oe(void 0,424),emptyCallback$1)}const KI="iconify2",JI="iconify",QI=JI+"-count",ek=JI+"-version",tk=36e5;function getStoredItem(Re,Le){try{return Re.getItem(Le)}catch(Re){}}function setStoredItem(Re,Le,Oe){try{return Re.setItem(Le,Oe),!0}catch(Re){}}function removeStoredItem(Re,Le){try{Re.removeItem(Le)}catch(Re){}}function setBrowserStorageItemsCount(Re,Le){return setStoredItem(Re,QI,Le.toString())}function getBrowserStorageItemsCount(Re){return parseInt(getStoredItem(Re,QI))||0}const rk={local:!0,session:!0},nk={local:new Set,session:new Set};let ik=!1;let ok={};function getBrowserStorage(Re){const Le=Re+"Storage";try{if(ok&&ok[Le]&&"number"==typeof ok[Le].length)return ok[Le]}catch(Re){}rk[Re]=!1}function iterateBrowserStorage(Re,Le){const Oe=getBrowserStorage(Re);if(!Oe)return;const Ue=getStoredItem(Oe,ek);if(Ue!==KI){if(Ue){const Re=getBrowserStorageItemsCount(Oe);for(let Le=0;Le<Re;Le++)removeStoredItem(Oe,JI+Le.toString())}return setStoredItem(Oe,ek,KI),void setBrowserStorageItemsCount(Oe,0)}const qe=Math.floor(Date.now()/tk)-168,parseItem=Re=>{const Ue=JI+Re.toString(),Ct=getStoredItem(Oe,Ue);if("string"==typeof Ct){try{const Oe=JSON.parse(Ct);if("object"==typeof Oe&&"number"==typeof Oe.cached&&Oe.cached>qe&&"string"==typeof Oe.provider&&"object"==typeof Oe.data&&"string"==typeof Oe.data.prefix&&Le(Oe,Re))return!0}catch(Re){}removeStoredItem(Oe,Ue)}};let Ct=getBrowserStorageItemsCount(Oe);for(let Le=Ct-1;Le>=0;Le--)parseItem(Le)||(Le===Ct-1?(Ct--,setBrowserStorageItemsCount(Oe,Ct)):nk[Re].add(Le))}function initBrowserStorage(){if(!ik){ik=!0;for(const Re in rk)iterateBrowserStorage(Re,(Re=>{const Le=Re.data,Oe=getStorage(Re.provider,Le.prefix);if(!addIconSet(Oe,Le).length)return!1;const Ue=Le.lastModified||-1;return Oe.lastModifiedCached=Oe.lastModifiedCached?Math.min(Oe.lastModifiedCached,Ue):Ue,!0}))}}function storeInBrowserStorage(Re,Le){function store(Oe){let Ue;if(!rk[Oe]||!(Ue=getBrowserStorage(Oe)))return;const qe=nk[Oe];let Ct;if(qe.size)qe.delete(Ct=Array.from(qe).shift());else if(Ct=getBrowserStorageItemsCount(Ue),Ct>=50||!setBrowserStorageItemsCount(Ue,Ct+1))return;const Ot={cached:Math.floor(Date.now()/tk),provider:Re.provider,data:Le};return setStoredItem(Ue,JI+Ct.toString(),JSON.stringify(Ot))}ik||initBrowserStorage(),Le.lastModified&&!function(Re,Le){const Oe=Re.lastModifiedCached;if(Oe&&Oe>=Le)return Oe===Le;if(Re.lastModifiedCached=Le,Oe)for(const Oe in rk)iterateBrowserStorage(Oe,(Oe=>{const Ue=Oe.data;return Oe.provider!==Re.provider||Ue.prefix!==Re.prefix||Ue.lastModified===Le}));return!0}(Re,Le.lastModified)||Object.keys(Le.icons).length&&(Le.not_found&&delete(Le=Object.assign({},Le)).not_found,store("local")||store("session"))}function emptyCallback(){}function loadedNewIcons(Re){Re.iconsLoaderFlag||(Re.iconsLoaderFlag=!0,setTimeout((()=>{Re.iconsLoaderFlag=!1,function(Re){Re.pendingCallbacksFlag||(Re.pendingCallbacksFlag=!0,setTimeout((()=>{Re.pendingCallbacksFlag=!1;const Le=Re.loaderCallbacks?Re.loaderCallbacks.slice(0):[];if(!Le.length)return;let Oe=!1;const Ue=Re.provider,qe=Re.prefix;Le.forEach((Le=>{const Ct=Le.icons,Ot=Ct.pending.length;Ct.pending=Ct.pending.filter((Le=>{if(Le.prefix!==qe)return!0;const Ot=Le.name;if(Re.icons[Ot])Ct.loaded.push({provider:Ue,prefix:qe,name:Ot});else{if(!Re.missing.has(Ot))return Oe=!0,!0;Ct.missing.push({provider:Ue,prefix:qe,name:Ot})}return!1})),Ct.pending.length!==Ot&&(Oe||removeCallback([Re],Le.id),Le.callback(Ct.loaded.slice(0),Ct.missing.slice(0),Ct.pending.slice(0),Le.abort))}))})))}(Re)})))}const loadIcons=(Re,Le)=>{const Oe=function(Re,Le=!0,Oe=!1){const Ue=[];return Re.forEach((Re=>{const qe="string"==typeof Re?stringToIcon(Re,Le,Oe):Re;qe&&Ue.push(qe)})),Ue}(Re,!0,allowSimpleNames()),Ue=function(Re){const Le={loaded:[],missing:[],pending:[]},Oe=Object.create(null);Re.sort(((Re,Le)=>Re.provider!==Le.provider?Re.provider.localeCompare(Le.provider):Re.prefix!==Le.prefix?Re.prefix.localeCompare(Le.prefix):Re.name.localeCompare(Le.name)));let Ue={provider:"",prefix:"",name:""};return Re.forEach((Re=>{if(Ue.name===Re.name&&Ue.prefix===Re.prefix&&Ue.provider===Re.provider)return;Ue=Re;const qe=Re.provider,Ct=Re.prefix,Ot=Re.name,Jt=Oe[qe]||(Oe[qe]=Object.create(null)),Hr=Jt[Ct]||(Jt[Ct]=getStorage(qe,Ct));let Jr;Jr=Ot in Hr.icons?Le.loaded:""===Ct||Hr.missing.has(Ot)?Le.missing:Le.pending;const Ln={provider:qe,prefix:Ct,name:Ot};Jr.push(Ln)})),Le}(Oe);if(!Ue.pending.length){let Re=!0;return Le&&setTimeout((()=>{Re&&Le(Ue.loaded,Ue.missing,Ue.pending,emptyCallback)})),()=>{Re=!1}}const qe=Object.create(null),Ct=[];let Ot,Jt;return Ue.pending.forEach((Re=>{const{provider:Le,prefix:Oe}=Re;if(Oe===Jt&&Le===Ot)return;Ot=Le,Jt=Oe,Ct.push(getStorage(Le,Oe));const Ue=qe[Le]||(qe[Le]=Object.create(null));Ue[Oe]||(Ue[Oe]=[])})),Ue.pending.forEach((Re=>{const{provider:Le,prefix:Oe,name:Ue}=Re,Ct=getStorage(Le,Oe),Ot=Ct.pendingIcons||(Ct.pendingIcons=new Set);Ot.has(Ue)||(Ot.add(Ue),qe[Le][Oe].push(Ue))})),Ct.forEach((Re=>{const{provider:Le,prefix:Oe}=Re;qe[Le][Oe].length&&function(Re,Le){Re.iconsToLoad?Re.iconsToLoad=Re.iconsToLoad.concat(Le).sort():Re.iconsToLoad=Le,Re.iconsQueueFlag||(Re.iconsQueueFlag=!0,setTimeout((()=>{Re.iconsQueueFlag=!1;const{provider:Le,prefix:Oe}=Re,Ue=Re.iconsToLoad;let qe;delete Re.iconsToLoad,Ue&&(qe=getAPIModule(Le))&&qe.prepare(Le,Oe,Ue).forEach((Oe=>{sendAPIQuery(Le,Oe,(Le=>{if("object"!=typeof Le)Oe.icons.forEach((Le=>{Re.missing.add(Le)}));else try{const Oe=addIconSet(Re,Le);if(!Oe.length)return;const Ue=Re.pendingIcons;Ue&&Oe.forEach((Re=>{Ue.delete(Re)})),storeInBrowserStorage(Re,Le)}catch(Re){console.error(Re)}loadedNewIcons(Re)}))}))})))}(Re,qe[Le][Oe])})),Le?function(Re,Le,Oe){const Ue=ZI++,qe=removeCallback.bind(null,Oe,Ue);if(!Le.pending.length)return qe;const Ct={id:Ue,icons:Le,callback:Re,abort:qe};return Oe.forEach((Re=>{(Re.loaderCallbacks||(Re.loaderCallbacks=[])).push(Ct)})),qe}(Le,Ue,Ct):emptyCallback},loadIcon=Re=>new Promise(((Le,Oe)=>{const Ue="string"==typeof Re?stringToIcon(Re,!0):Re;Ue?loadIcons([Ue||Re],(qe=>{if(qe.length&&Ue){const Re=function(Re){const Le="string"==typeof Re?stringToIcon(Re,!0,jI):Re;if(Le){const Re=getStorage(Le.provider,Le.prefix),Oe=Le.name;return Re.icons[Oe]||(Re.missing.has(Oe)?null:void 0)}}(Ue);if(Re)return void Le({...DI,...Re})}Oe(Re)})):Oe(Re)})),sk={backgroundColor:"currentColor"},ak={Image:"var(--svg)",Repeat:"no-repeat",Size:"100% 100%"},lk={webkitMask:sk,mask:sk,background:{backgroundColor:"transparent"}};for(const Re in lk){const Le=lk[Re];for(const Oe in ak)Le[Re+Oe]=ak[Oe]}const ck={};var uk;["horizontal","vertical"].forEach((Re=>{const Le=Re.slice(0,1)+"Flip";ck[Re+"-flip"]=Le,ck[Re.slice(0,1)+"-flip"]=Le,ck[Re+"Flip"]=Le})),allowSimpleNames(!0),uk=WI,VI[""]=uk;const hk=["fluent-emoji-high-contrast","material-symbols-light","cryptocurrency-color","icon-park-outline","icon-park-twotone","fluent-emoji-flat","emojione-monotone","streamline-emojis","heroicons-outline","simple-line-icons","material-symbols","flat-color-icons","icon-park-solid","pepicons-pencil","heroicons-solid","pepicons-print","cryptocurrency","pixelarticons","bitcoin-icons","system-uicons","devicon-plain","entypo-social","token-branded","grommet-icons","svg-spinners","pepicons-pop","fluent-color","vscode-icons","simple-icons","fluent-emoji","circle-flags","medical-icon","icomoon-free","majesticons","humbleicons","rivet-icons","radix-icons","fa6-regular","skill-icons","emojione-v1","academicons","healthicons","fluent-mdl2","lucide-lab","akar-icons","lets-icons","ant-design","gravity-ui","teenyicons","streamline","file-icons","catppuccin","fa6-brands","game-icons","foundation","fa-regular","mono-icons","mdi-light","hugeicons","iconamoon","eos-icons","gridicons","duo-icons","lineicons","zondicons","heroicons","fa6-solid","icon-park","arcticons","meteocons","dashicons","fa-brands","websymbol","fontelico","mingcute","flowbite","proicons","guidance","bytesize","marketeq","nonicons","brandico","openmoji","emojione","flagpack","fa-solid","fontisto","si-glyph","pepicons","line-md","iconoir","tdesign","formkit","clarity","octicon","pajamas","codicon","devicon","twemoji","noto-v1","fxemoji","raphael","flat-ui","topcoat","feather","tabler","mynaui","lucide","circum","carbon","lsicon","nimbus","fluent","memory","entypo","icons8","subway","vaadin","solar","basil","typcn","prime","cuida","stash","charm","quill","logos","token","covid","weui","mage","gala","maki","ooui","unjs","noto","flag","iwwa","zmdi","bpmn","mdi","uil","bxs","uim","uit","uis","jam","ion","cil","uiw","oui","cib","bxl","cbi","cif","gis","map","geo","fad","eva","wpf","whh","ic","ri","si","bx","gg","ci","fe","mi","ep","bi","ph","ei","f7","wi","la","fa","oi","et","el","ls","vs","il","ps"];function resolveIconName(Re=""){let Le,Oe="";if("@"===Re[0]&&Re.includes(":")&&(Oe=Re.split(":")[0].slice(1),Re=Re.split(":").slice(1).join(":")),Re.startsWith("i-")){Re=Re.replace(/^i-/,"");for(const Oe of hk)if(Re.startsWith(Oe)){Le=Oe,Re=Re.slice(Oe.length+1);break}}else if(Re.includes(":")){const[Oe,Ue]=Re.split(":");Le=Oe,Re=Ue}return{provider:Oe,prefix:Le||"",name:Re||""}}const dk=defineComponent({__name:"Icon",__ssrInlineRender:!0,props:{name:{type:String,required:!0},size:{type:String,default:""}},async setup(Re){let Le,Oe;const Ue=useNuxtApp(),qe=useAppConfig(),Ct=Re;watch((()=>{var Re;return null==(Re=qe.nuxtIcon)?void 0:Re.iconifyApiOptions}),(()=>{var Re,Le,Oe,Ue,Ct,Ot;if(null==(Le=null==(Re=qe.nuxtIcon)?void 0:Re.iconifyApiOptions)?void 0:Le.url){try{new URL(qe.nuxtIcon.iconifyApiOptions.url)}catch(Re){return void console.warn("Nuxt Icon: Invalid custom Iconify API URL")}(null==(Ue=null==(Oe=qe.nuxtIcon)?void 0:Oe.iconifyApiOptions)?void 0:Ue.publicApiFallback)?addAPIProvider("custom",{resources:[null==(Ct=qe.nuxtIcon)?void 0:Ct.iconifyApiOptions.url],index:0}):addAPIProvider("",{resources:[null==(Ot=qe.nuxtIcon)?void 0:Ot.iconifyApiOptions.url]})}}),{immediate:!0});const Ot=useState("icons",(()=>({}))),Jt=ref(!1),Hr=computed((()=>{var Re,Le;return(null==(Le=null==(Re=qe.nuxtIcon)?void 0:Re.aliases)?void 0:Le[Ct.name])?qe.nuxtIcon.aliases[Ct.name]:Ct.name})),Jr=computed((()=>resolveIconName(Hr.value))),Ln=computed((()=>[Jr.value.provider,Jr.value.prefix,Jr.value.name].filter(Boolean).join(":"))),Nn=computed((()=>{var Re;return null==(Re=Ot.value)?void 0:Re[Ln.value]})),$n=computed((()=>{var Re;return null==(Re=Ue.vueApp)?void 0:Re.component(Hr.value)})),Gn=computed((()=>{var Re,Le,Oe;if(!Ct.size&&"boolean"==typeof(null==(Re=qe.nuxtIcon)?void 0:Re.size)&&!(null==(Le=qe.nuxtIcon)?void 0:Le.size))return;const Ue=Ct.size||(null==(Oe=qe.nuxtIcon)?void 0:Oe.size)||"1em";return String(Number(Ue))===Ue?`${Ue}px`:Ue})),qn=computed((()=>{var Re,Le;return null!=(Re=null==(Le=null==qe?void 0:qe.nuxtIcon)?void 0:Le.class)?Re:"icon"}));async function loadIconComponent(){var Re;$n.value||(null==(Re=Ot.value)?void 0:Re[Ln.value])||(Jt.value=!0,Ot.value[Ln.value]=await loadIcon(Jr.value).catch((()=>{})),Jt.value=!1)}return watch(Hr,loadIconComponent),!$n.value&&([Le,Oe]=withAsyncContext((()=>loadIconComponent())),Le=await Le,Oe()),(Le,Oe,Ue,qe)=>{Jt.value?Oe(`<span${ssrRenderAttrs(mergeProps({class:qn.value,style:{width:Gn.value,height:Gn.value}},qe))} data-v-e8d572f6></span>`):Nn.value?Oe(ssrRenderComponent(unref(RI),mergeProps({icon:Nn.value,class:qn.value,width:Gn.value,height:Gn.value},qe),null,Ue)):$n.value?renderVNode(Oe,createVNode(resolveDynamicComponent($n.value),mergeProps({class:qn.value,width:Gn.value,height:Gn.value},qe),null),Ue):(Oe(`<span${ssrRenderAttrs(mergeProps({class:qn.value,style:{fontSize:Gn.value,lineHeight:Gn.value,width:Gn.value,height:Gn.value}},qe))} data-v-e8d572f6>`),ssrRenderSlot(Le.$slots,"default",{},(()=>{Oe(`${ssrInterpolate(Re.name)}`)}),Oe,Ue),Oe("</span>"))}}}),pk=dk.setup;dk.setup=(Re,Le)=>{const Oe=useSSRContext();return(Oe.modules||(Oe.modules=new Set)).add("node_modules/nuxt-icon/dist/runtime/Icon.vue"),pk?pk(Re,Le):void 0};const fk=_export_sfc(dk,[["__scopeId","data-v-e8d572f6"]]),mk=Object.freeze(Object.defineProperty({__proto__:null,default:fk},Symbol.toStringTag,{value:"Module"})),gk=defineComponent({__name:"IconCSS",__ssrInlineRender:!0,props:{name:{type:String,required:!0},size:{type:String,default:""}},setup(Re){const Le=useAppConfig(),Oe=Re,Ue=computed((()=>{var Re,Ue;return(null==(Ue=null==(Re=Le.nuxtIcon)?void 0:Re.aliases)?void 0:Ue[Oe.name])?Le.nuxtIcon.aliases[Oe.name]:Oe.name})),qe=computed((()=>resolveIconName(Ue.value))),Ct=computed((()=>{var Re,Oe;const Ue=null==(Oe=null==(Re=Le.nuxtIcon)?void 0:Re.iconifyApiOptions)?void 0:Oe.url;if(Ue)try{new URL(Ue)}catch(Re){return void console.warn("Nuxt IconCSS: Invalid custom Iconify API URL")}return`url('${Ue||"https://api.iconify.design"}/${qe.value.prefix}/${qe.value.name}.svg')`})),Ot=computed((()=>{var Re,Ue,qe;if(!Oe.size&&"boolean"==typeof(null==(Re=Le.nuxtIcon)?void 0:Re.size)&&!(null==(Ue=Le.nuxtIcon)?void 0:Ue.size))return;const Ct=Oe.size||(null==(qe=Le.nuxtIcon)?void 0:qe.size)||"1em";return String(Number(Ct))===Ct?`${Ct}px`:Ct}));return(Re,Le,Oe,Ue)=>{const qe={style:{"--efdb04fa":Ct.value}};Le(`<span${ssrRenderAttrs(mergeProps({style:{width:Ot.value,height:Ot.value}},Ue,qe))} data-v-41e8d397></span>`)}}}),_k=gk.setup;gk.setup=(Re,Le)=>{const Oe=useSSRContext();return(Oe.modules||(Oe.modules=new Set)).add("node_modules/nuxt-icon/dist/runtime/IconCSS.vue"),_k?_k(Re,Le):void 0};const yk=_export_sfc(gk,[["__scopeId","data-v-41e8d397"]]),vk=Object.freeze(Object.defineProperty({__proto__:null,default:yk},Symbol.toStringTag,{value:"Module"})),xk={"locale.en-US":"English","locale.fr-FR":"French","locale.dir":"ltr",site:{name:"My Travel App"},themes:{system:"System",light:"Light",dark:"Dark"},error:{return:"Go back","page-not-found":"Page not found"},pages:{index:{meta:{title:"Home",description:"Home page"},link:"Home",features:{googleFonts:"Google Fonts",eslint:"ESLint",Typescript:"Typescript",Prettier:"Prettier",imageOptim:"Image optimization",TailwindCSS:"TailwindCSS",darkMode:"Dark mode",i18n:"Localization (i18n)",postcss:"PostCSS",lightHouse:"Lighthouse 100%",deviceDetect:"Device detection",cookies:"Cookie banner",Iconify:"Iconify",Pinia:"Pinia"}},about:{meta:{title:"About",description:"About page"},link:"About",title:"About",p:"As a front-end and mobile developer, I'm passionate about creating innovative, high-performance digital experiences.With solid experience in web and mobile application development, I combine technical skills and creativity to design intuitive, user-centered interfaces. Always on the lookout for new technologies and trends, I'm ready to take on ambitious challenges and contribute to high-impact projects."},destinations:{meta:{title:"Destinations page",description:"Destinations"},link:"Destinations"}}},bk={"locale.en-US":"English","locale.fr-FR":"Français","locale.dir":"ltr",site:{name:"My Travel App"},themes:{system:"Système",light:"Clair",dark:"Sombre"},error:{return:"Retour","page-not-found":"Page non trouvée"},pages:{index:{meta:{title:"Accueil",description:"Accueil"},link:"Accueil",features:{googleFonts:"Polices Google",eslint:"ESLint",Typescript:"Typescript",Prettier:"Prettier",imageOptim:"Optimisation d'images",TailwindCSS:"TailwindCSS",darkMode:"Mode sombre",i18n:"Localisation (i18n)",postcss:"PostCSS",lightHouse:"Lighthouse 100%",deviceDetect:"Détection de périphérique",cookies:"Bannière de cookies",Iconify:"Iconify",Pinia:"Pinia"}},about:{meta:{title:"À propos",description:"À propos"},link:"À propos",title:"À propos",p:"Développeur front-end et mobile, je suis passionné par la création d’expériences numériques innovantes et performantes.Fort d’une expérience solide en développement d’applications web et mobiles, j’allie compétences techniques et créativité pour concevoir des interfaces intuitives, centrées sur l’utilisateur. Mon approche repose sur les meilleures pratiques de développement, avec un souci constant d’optimisation et de qualité.Toujours à l’écoute des nouvelles technologies et tendances, je suis prêt à relever des défis ambitieux et à contribuer à des projets à fort impact."},destinations:{meta:{title:"Page destinationse (mise en page plein écran)",description:"Page destinationse utilisant la mise en page plein écran"},link:"Destinations"}}},wk=Object.freeze(Object.defineProperty({__proto__:null,default:()=>({legacy:!1,langDir:"./locales",messages:{"en-US":xk,"fr-FR":bk},baseUrl:void 0,locales:[{code:"en",iso:"en-US",isCatchallLocale:!0},{code:"fr",iso:"fr-FR"}]})},Symbol.toStringTag,{value:"Module"}));async function imageMeta$1(Re,Le){const Oe=await async function(Re){{const Le=(await Promise.resolve().then((function(){return fP})).then((Re=>Re.imageMeta)))(await fetch(Re).then((Re=>Re.buffer())));if(!Le)throw new Error(`No metadata could be extracted from the image \`${Re}\`.`);const{width:Oe,height:Ue}=Le;return{width:Oe,height:Ue,ratio:Oe&&Ue?Oe/Ue:void 0}}}(Le).catch((Re=>(console.error("Failed to get image meta for "+Le,Re+""),{width:0,height:0,ratio:0})));return Oe}function createMapper(Re){return Le=>Le?Re[Le]||Le:Re.missingValue}function parseSize(Re=""){return"number"==typeof Re?Re:"string"==typeof Re&&Re.replace("px","").match(/^\d+$/g)?Number.parseInt(Re,10):void 0}function createImage(Re){const Le={options:Re},getImage2=(Re,Oe={})=>resolveImage(Le,Re,Oe),$img=(Re,Le={},Oe={})=>getImage2(Re,{...Oe,modifiers:Ql(Le,Oe.modifiers||{})}).url;for(const Le in Re.presets)$img[Le]=(Oe,Ue,qe)=>$img(Oe,Ue,{...Re.presets[Le],...qe});return $img.options=Re,$img.getImage=getImage2,$img.getMeta=(Re,Oe)=>async function(Re,Le,Oe){const Ue=resolveImage(Re,Le,{...Oe});return"function"==typeof Ue.getMeta?await Ue.getMeta():await imageMeta$1(0,Ue.url)}(Le,Re,Oe),$img.getSizes=(Re,Oe)=>function(Re,Le,Oe){var Ue,qe,Ct,Ot,Jt;const Hr=parseSize(null==(Ue=Oe.modifiers)?void 0:Ue.width),Jr=parseSize(null==(qe=Oe.modifiers)?void 0:qe.height),Ln=function(Re){const Le={};if("string"==typeof Re)for(const Oe of Re.split(/[\s,]+/).filter((Re=>Re))){const Re=Oe.split(":");2!==Re.length?Le["1px"]=Re[0].trim():Le[Re[0].trim()]=Re[1].trim()}else Object.assign(Le,Re);return Le}(Oe.sizes),Nn=(null==(Ct=Oe.densities)?void 0:Ct.trim())?function(Re=""){if(void 0===Re||!Re.length)return[];const Le=new Set;for(const Oe of Re.split(" ")){const Re=Number.parseInt(Oe.replace("x",""));Re&&Le.add(Re)}return Array.from(Le)}(Oe.densities.trim()):Re.options.densities;!function(Re){if(0===Re.length)throw new Error("`densities` must not be empty, configure to `1` to render regular size only (DPR 1.0)")}(Nn);const $n=Hr&&Jr?Jr/Hr:0,Gn=[],qn=[];if(Object.keys(Ln).length>=1){for(const Ue in Ln){const qe=getSizesVariant(Ue,String(Ln[Ue]),Jr,$n,Re);if(void 0!==qe){Gn.push({size:qe.size,screenMaxWidth:qe.screenMaxWidth,media:`(max-width: ${qe.screenMaxWidth}px)`});for(const Ue of Nn)qn.push({width:qe._cWidth*Ue,src:getVariantSrc(Re,Le,Oe,qe,Ue)})}}!function(Re){var Le;Re.sort(((Re,Le)=>Re.screenMaxWidth-Le.screenMaxWidth));let Oe=null;for(let Le=Re.length-1;Le>=0;Le--){const Ue=Re[Le];Ue.media===Oe&&Re.splice(Le,1),Oe=Ue.media}for(let Oe=0;Oe<Re.length;Oe++)Re[Oe].media=(null==(Le=Re[Oe+1])?void 0:Le.media)||""}(Gn)}else for(const Ue of Nn){const qe=Object.keys(Ln)[0];let Ct=getSizesVariant(qe,String(Ln[qe]),Jr,$n,Re);void 0===Ct&&(Ct={size:"",screenMaxWidth:0,_cWidth:null==(Ot=Oe.modifiers)?void 0:Ot.width,_cHeight:null==(Jt=Oe.modifiers)?void 0:Jt.height}),qn.push({width:Ue,src:getVariantSrc(Re,Le,Oe,Ct,Ue)})}!function(Re){Re.sort(((Re,Le)=>Re.width-Le.width));let Le=null;for(let Oe=Re.length-1;Oe>=0;Oe--){const Ue=Re[Oe];Ue.width===Le&&Re.splice(Oe,1),Le=Ue.width}}(qn);const Zn=qn[qn.length-1],Xn=Gn.length?Gn.map((Re=>`${Re.media?Re.media+" ":""}${Re.size}`)).join(", "):void 0,Yn=Xn?"w":"x",_i=qn.map((Re=>`${Re.src} ${Re.width}${Yn}`)).join(", ");return{sizes:Xn,srcset:_i,src:null==Zn?void 0:Zn.src}}(Le,Re,Oe),Le.$img=$img,$img}function resolveImage(Re,Le,Oe){var Ue,qe;if(Le&&"string"!=typeof Le)throw new TypeError(`input must be a string (received ${typeof Le}: ${JSON.stringify(Le)})`);if(!Le||Le.startsWith("data:"))return{url:Le};const{provider:Ct,defaults:Ot}=function(Re,Le){const Oe=Re.options.providers[Le];if(!Oe)throw new Error("Unknown provider: "+Le);return Oe}(Re,Oe.provider||Re.options.provider),Jt=function(Re,Le){if(!Le)return{};if(!Re.options.presets[Le])throw new Error("Unknown preset: "+Le);return Re.options.presets[Le]}(Re,Oe.preset);if(Le=hasProtocol(Le)?Le:withLeadingSlash(Le),!Ct.supportsAlias)for(const Oe in Re.options.alias)Le.startsWith(Oe)&&(Le=joinURL(Re.options.alias[Oe],Le.substr(Oe.length)));if(Ct.validateDomains&&hasProtocol(Le)){const Oe=parseURL(Le).host;if(!Re.options.domains.find((Re=>Re===Oe)))return{url:Le}}const Hr=Ql(Oe,Jt,Ot);Hr.modifiers={...Hr.modifiers};const Jr=Hr.modifiers.format;(null==(Ue=Hr.modifiers)?void 0:Ue.width)&&(Hr.modifiers.width=parseSize(Hr.modifiers.width)),(null==(qe=Hr.modifiers)?void 0:qe.height)&&(Hr.modifiers.height=parseSize(Hr.modifiers.height));const Ln=Ct.getImage(Le,Hr,Re);return Ln.format=Ln.format||Jr||"",Ln}function getSizesVariant(Re,Le,Oe,Ue,qe){const Ct=qe.options.screens&&qe.options.screens[Re]||Number.parseInt(Re),Ot=Le.endsWith("vw");if(!Ot&&/^\d+$/.test(Le)&&(Le+="px"),!Ot&&!Le.endsWith("px"))return;let Jt=Number.parseInt(Le);if(!Ct||!Jt)return;Ot&&(Jt=Math.round(Jt/100*Ct));return{size:Le,screenMaxWidth:Ct,_cWidth:Jt,_cHeight:Ue?Math.round(Jt*Ue):Oe}}function getVariantSrc(Re,Le,Oe,Ue,qe){return Re.$img(Le,{...Oe.modifiers,width:Ue._cWidth?Ue._cWidth*qe:void 0,height:Ue._cHeight?Ue._cHeight*qe:void 0},Oe)}const Tk=function({formatter:Re,keyMap:Le,joinWith:Oe="/",valueMap:Ue}={}){Re||(Re=(Re,Le)=>`${Re}=${Le}`),Le&&"function"!=typeof Le&&(Le=createMapper(Le));const qe=Ue||{};return Object.keys(qe).forEach((Re=>{"function"!=typeof qe[Re]&&(qe[Re]=createMapper(qe[Re]))})),(Ue={})=>Object.entries(Ue).filter((([Re,Le])=>void 0!==Le)).map((([Oe,Ct])=>{const Ot=qe[Oe];return"function"==typeof Ot&&(Ct=Ot(Ue[Oe])),Oe="function"==typeof Le?Le(Oe):Oe,Re(Oe,Ct)})).join(Oe)}({keyMap:{format:"f",fit:"fit",width:"w",height:"h",resize:"s",quality:"q",background:"b"},joinWith:"&",formatter:(Re,Le)=>encodeParam(Re)+"_"+encodeParam(Le)}),Sk=Object.freeze(Object.defineProperty({__proto__:null,getImage:(Re,{modifiers:Le={},baseURL:Oe}={},Ue)=>{Le.width&&Le.height&&(Le.resize=`${Le.width}x${Le.height}`,delete Le.width,delete Le.height);const qe=Tk(Le)||"_";return Oe||(Oe=joinURL(Ue.options.nuxt.baseURL,"/_ipx")),{url:joinURL(Oe,qe,encodePath(Re))}},supportsAlias:!0,validateDomains:!0},Symbol.toStringTag,{value:"Module"})),Ek=Object.freeze(Object.defineProperty({__proto__:null,getImage:Re=>({url:Re})},Symbol.toStringTag,{value:"Module"})),Ck={screens:{xs:320,sm:640,md:768,lg:1024,xl:1280,xxl:1536,"2xl":1536},presets:{},provider:"none",domains:[],alias:{},densities:[1,2],format:["png","jpeg","webp","webp"],quality:80};Ck.providers={ipx:{provider:Sk,defaults:{}},none:{provider:Ek,defaults:{}}};const useImage=()=>{const Re=useRuntimeConfig(),Le=useNuxtApp();return Le.$img||Le._img||(Le._img=createImage({...Ck,nuxt:{baseURL:Re.app.baseURL}}))},Ak={src:{type:String,default:void 0},format:{type:String,default:void 0},quality:{type:[Number,String],default:void 0},background:{type:String,default:void 0},fit:{type:String,default:void 0},modifiers:{type:Object,default:void 0},preset:{type:String,default:void 0},provider:{type:String,default:void 0},sizes:{type:[Object,String],default:void 0},densities:{type:String,default:void 0},preload:{type:[Boolean,Object],default:void 0},width:{type:[String,Number],default:void 0},height:{type:[String,Number],default:void 0},alt:{type:String,default:void 0},referrerpolicy:{type:String,default:void 0},usemap:{type:String,default:void 0},longdesc:{type:String,default:void 0},ismap:{type:Boolean,default:void 0},loading:{type:String,default:void 0,validator:Re=>["lazy","eager"].includes(Re)},crossorigin:{type:[Boolean,String],default:void 0,validator:Re=>["anonymous","use-credentials","",!0,!1].includes(Re)},decoding:{type:String,default:void 0,validator:Re=>["async","auto","sync"].includes(Re)},nonce:{type:[String],default:void 0}},Ik=defineComponent({name:"NuxtImg",props:{...Ak,placeholder:{type:[Boolean,String,Number,Array],default:void 0},placeholderClass:{type:String,default:void 0}},emits:["load","error"],setup:(Re,Le)=>{const Oe=useImage(),Ue=(Re=>{const Le=computed((()=>({provider:Re.provider,preset:Re.preset}))),Oe=computed((()=>({width:parseSize(Re.width),height:parseSize(Re.height),alt:Re.alt,referrerpolicy:Re.referrerpolicy,usemap:Re.usemap,longdesc:Re.longdesc,ismap:Re.ismap,crossorigin:!0===Re.crossorigin?"anonymous":Re.crossorigin||void 0,loading:Re.loading,decoding:Re.decoding,nonce:Re.nonce}))),Ue=useImage();return{options:Le,attrs:Oe,modifiers:computed((()=>({...Re.modifiers,width:parseSize(Re.width),height:parseSize(Re.height),format:Re.format,quality:Re.quality||Ue.options.quality,background:Re.background,fit:Re.fit})))}})(Re),qe=ref(!1),Ct=ref(),Ot=computed((()=>Oe.getSizes(Re.src,{...Ue.options.value,sizes:Re.sizes,densities:Re.densities,modifiers:{...Ue.modifiers.value,width:parseSize(Re.width),height:parseSize(Re.height)}}))),Jt=computed((()=>{const Le={...Ue.attrs.value,"data-nuxt-img":""};return Re.placeholder&&!qe.value||(Le.sizes=Ot.value.sizes,Le.srcset=Ot.value.srcset),Le})),Hr=computed((()=>{let Le=Re.placeholder;if(""===Le&&(Le=!0),!Le||qe.value)return!1;if("string"==typeof Le)return Le;const Ct=Array.isArray(Le)?Le:"number"==typeof Le?[Le,Le]:[10,10];return Oe(Re.src,{...Ue.modifiers.value,width:Ct[0],height:Ct[1],quality:Ct[2]||50,blur:Ct[3]||3},Ue.options.value)})),Jr=computed((()=>Re.sizes?Ot.value.src:Oe(Re.src,Ue.modifiers.value,Ue.options.value))),Ln=computed((()=>Hr.value?Hr.value:Jr.value));if(Re.preload){const Le=Object.values(Ot.value).every((Re=>Re));useHead({link:[{rel:"preload",as:"image",nonce:Re.nonce,...Le?{href:Ot.value.src,imagesizes:Ot.value.sizes,imagesrcset:Ot.value.srcset}:{href:Ln.value},..."boolean"!=typeof Re.preload&&Re.preload.fetchPriority?{fetchpriority:Re.preload.fetchPriority}:{}}]})}return useNuxtApp().isHydrating,()=>h("img",{ref:Ct,onerror:"this.setAttribute('data-error', 1)",...Jt.value,...Le.attrs,class:Re.placeholder&&!qe.value?[Re.placeholderClass]:void 0,src:Ln.value})}}),kk={};const Mk=kk.setup;kk.setup=(Re,Le)=>{const Oe=useSSRContext();return(Oe.modules||(Oe.modules=new Set)).add("components/HeaderComponent.vue"),Mk?Mk(Re,Le):void 0};const Pk=_export_sfc(kk,[["ssrRender",function(Re,Le,Oe,Ue){const qe=JA,Ct=Ik;Le(`<header${ssrRenderAttrs(mergeProps({class:"mb-5"},Ue))}><nav class="flex flex-row justify-start pb-5 pt-10">`),Le(ssrRenderComponent(qe,{to:"/","aria-label":"Home",class:"min-w-fit"},{default:withCtx(((Le,Oe,Ue,qe)=>{if(!Oe)return["/"===Re.$route.fullPath?(openBlock(),createBlock(Ct,{key:0,class:"h-6 sm:ml-3 lg:ml-0 home-logo",src:"logo/logo-white.svg",densities:"x1 x2",alt:"nuxt-logo",style:{height:"36px",width:"99px",color:"red"}})):(openBlock(),createBlock(Ct,{key:1,class:"h-6 sm:ml-3 lg:ml-0 home-logo",src:"logo/logo.svg",densities:"x1 x2",alt:"nuxt-logo",style:{height:"36px",width:"99px",color:"red"}}))];"/"===Re.$route.fullPath?Oe(ssrRenderComponent(Ct,{class:"h-6 sm:ml-3 lg:ml-0 home-logo",src:"logo/logo-white.svg",densities:"x1 x2",alt:"nuxt-logo",style:{height:"36px",width:"99px",color:"red"}},null,Ue,qe)):Oe(ssrRenderComponent(Ct,{class:"h-6 sm:ml-3 lg:ml-0 home-logo",src:"logo/logo.svg",densities:"x1 x2",alt:"nuxt-logo",style:{height:"36px",width:"99px",color:"red"}},null,Ue,qe))})),_:1},Oe)),Le('<div class="flex flex-col space-x-3 space-y-4 pr-2 sm:flex-row sm:space-x-3 sm:space-y-0 sm:pr-10 rtl:space-x-reverse"></div><ul class="flex flex-wrap items-center space-x-1 sm:justify-center sm:space-x-2 sm:space-x-reverse"><li class="h-full">'),"/"===Re.$route.fullPath?Le(ssrRenderComponent(qe,{class:"flex h-full w-full items-center justify-center rounded-lg px-4 text-white hover:cursor-pointer",to:"/"},{default:withCtx(((Le,Oe,Ue,qe)=>{if(!Oe)return[createTextVNode(toDisplayString$1(Re.$t("pages.index.link")),1)];Oe(`${ssrInterpolate(Re.$t("pages.index.link"))}`)})),_:1},Oe)):Le(ssrRenderComponent(qe,{class:"flex h-full w-full items-center justify-center rounded-lg px-4 text-black hover:cursor-pointer",to:"/"},{default:withCtx(((Le,Oe,Ue,qe)=>{if(!Oe)return[createTextVNode(toDisplayString$1(Re.$t("pages.index.link")),1)];Oe(`${ssrInterpolate(Re.$t("pages.index.link"))}`)})),_:1},Oe)),Le('</li><li class="h-full">'),"/"===Re.$route.fullPath?Le(ssrRenderComponent(qe,{class:"flex h-full w-full items-center justify-center rounded-lg px-4 text-white hover:cursor-pointer",to:"/destinations"},{default:withCtx(((Le,Oe,Ue,qe)=>{if(!Oe)return[createTextVNode(toDisplayString$1(Re.$t("pages.destinations.link")),1)];Oe(`${ssrInterpolate(Re.$t("pages.destinations.link"))}`)})),_:1},Oe)):Le(ssrRenderComponent(qe,{class:"flex h-full w-full items-center justify-center rounded-lg px-4 text-black hover:cursor-pointer",to:"/destinations"},{default:withCtx(((Le,Oe,Ue,qe)=>{if(!Oe)return[createTextVNode(toDisplayString$1(Re.$t("pages.destinations.link")),1)];Oe(`${ssrInterpolate(Re.$t("pages.destinations.link"))}`)})),_:1},Oe)),Le('</li><li class="h-full">'),"/"===Re.$route.fullPath?Le(ssrRenderComponent(qe,{class:"flex h-full w-full items-center justify-center rounded-lg px-4 text-white hover:cursor-pointer",to:"/about"},{default:withCtx(((Le,Oe,Ue,qe)=>{if(!Oe)return[createTextVNode(toDisplayString$1(Re.$t("pages.about.link")),1)];Oe(`${ssrInterpolate(Re.$t("pages.about.link"))}`)})),_:1},Oe)):Le(ssrRenderComponent(qe,{class:"flex h-full w-full items-center justify-center rounded-lg px-4 text-black hover:cursor-pointer",to:"/about"},{default:withCtx(((Le,Oe,Ue,qe)=>{if(!Oe)return[createTextVNode(toDisplayString$1(Re.$t("pages.about.link")),1)];Oe(`${ssrInterpolate(Re.$t("pages.about.link"))}`)})),_:1},Oe)),Le("</li></ul></nav></header>")}]]),Rk={};const Lk=Rk.setup;Rk.setup=(Re,Le)=>{const Oe=useSSRContext();return(Oe.modules||(Oe.modules=new Set)).add("components/HeroComponent.vue"),Lk?Lk(Re,Le):void 0};const Ok=_export_sfc(Rk,[["ssrRender",function(Re,Le,Oe,Ue){const qe=JA;Le(`<div${ssrRenderAttrs(mergeProps({class:"h-screen w-screen bg-[url('assets/img/background.jpg')] bg-cover -mt-40 pb-60 pt-60"},Ue))}><div class="container mx-auto max-h-screen max-w-screen-xl pt-30 px-8"><section class="w-full"><div class="flex justify-start"><h1 class="title font-sans text-5xl sm:text-7xl font-bold text-white pr-2">My</h1><h1 class="title font-sans text-5xl sm:text-7xl font-bold text-green-400"> Travel App </h1></div><p class="max-w-lg pt-10 font-sans text-xl text-white"> Lorem ipsum dolor sit amet consectetur adipisicing elit. Fuga labore fugit et voluptatem natus, corrupti delectus consequatur atque facilis nisi quidem veniam? Aperiam amet tempora ea quod. Odio, facere! Sunt. </p><div class="button pt-10 pl-1">`),Le(ssrRenderComponent(qe,{class:"mb-2 me-2 rounded-lg bg-gradient-to-r from-green-400 via-green-500 to-green-600 px-5 py-2.5 text-center font-medium text-white text-sm shadow-lg shadow-green-500/50 hover:bg-gradient-to-br focus:outline-none focus:ring-4 focus:ring-green-300 dark:shadow-lg dark:shadow-green-800/80 dark:focus:ring-green-800",to:"/destinations"},{default:withCtx(((Re,Le,Oe,Ue)=>{if(!Le)return[createTextVNode("Toutes les destinations ")];Le("Toutes les destinations ")})),_:1},Oe)),Le("</div></section></div></div>")}]]),zk={};const Dk=zk.setup;zk.setup=(Re,Le)=>{const Oe=useSSRContext();return(Oe.modules||(Oe.modules=new Set)).add("components/FooterComponent.vue"),Dk?Dk(Re,Le):void 0};const Bk=_export_sfc(zk,[["ssrRender",function(Re,Le,Oe,Ue){const qe=JA;Le(`<div${ssrRenderAttrs(mergeProps({class:"h-full w-screen bg-orange-500 bg-cover pb-40 pt-40"},Ue))}><div class="container mx-auto max-h-screen max-w-screen-xl px-8"><section class="w-full"><div class="flex justify-start"><h1 class="title pr-2 font-sans text-5xl font-thin text-white sm:text-7xl"> Footer </h1></div><p class="max-w-lg pt-10 font-sans text-xl text-white"> Lorem ipsum dolor sit amet consectetur adipisicing elit. Fuga labore fugit et voluptatem natus, corrupti delectus consequatur atque facilis nisi quidem veniam? </p><div class="flex flex-wrap md:flex-row"><div class="button pl-1 pt-10">`),Le(ssrRenderComponent(qe,{class:"button border-3 mb-2 me-2 rounded-lg border border-white px-5 py-2.5 text-center text-sm font-medium text-white hover:border-white hover:text-black hover:bg-white transition-colors duration-150 ease-in-out",to:"/"},{default:withCtx(((Le,Oe,Ue,qe)=>{if(!Oe)return[createTextVNode(toDisplayString$1(Re.$t("pages.index.link")),1)];Oe(`${ssrInterpolate(Re.$t("pages.index.link"))}`)})),_:1},Oe)),Le('</div><div class="button pl-1 pt-10">'),Le(ssrRenderComponent(qe,{class:"button border-3 mb-2 me-2 rounded-lg border border-white px-5 py-2.5 text-center text-sm font-medium text-white hover:border-white hover:text-black hover:bg-white transition-colors duration-150 ease-in-out",to:"/destinations"},{default:withCtx(((Le,Oe,Ue,qe)=>{if(!Oe)return[createTextVNode(toDisplayString$1(Re.$t("pages.destinations.link")),1)];Oe(`${ssrInterpolate(Re.$t("pages.destinations.link"))}`)})),_:1},Oe)),Le('</div><div class="button pl-1 pt-10">'),Le(ssrRenderComponent(qe,{class:"button border-3 mb-2 me-2 rounded-lg border border-white px-5 py-2.5 text-center text-sm font-medium text-white hover:border-white hover:text-black hover:bg-white transition-colors duration-150 ease-in-out",to:"/about"},{default:withCtx(((Le,Oe,Ue,qe)=>{if(!Oe)return[createTextVNode(toDisplayString$1(Re.$t("pages.about.link")),1)];Oe(`${ssrInterpolate(Re.$t("pages.about.link"))}`)})),_:1},Oe)),Le("</div></div></section></div></div>")}]]),Fk=defineComponent({__name:"default",__ssrInlineRender:!0,setup:Re=>(useLocaleHead({addDirAttribute:!0,identifierAttribute:"id",addSeoAttributes:!0}),(Re,Le,Oe,Ue)=>{const qe=Pk,Ct=Ok,Ot=Bk;Le(`<div${ssrRenderAttrs(mergeProps({class:"min-h-screen bg-white"},Ue))}><div class="container mx-auto max-h-screen max-w-screen-xl px-8">`),Le(ssrRenderComponent(qe,null,null,Oe)),Le("</div>"),"/"===Re.$route.fullPath?(Le("<div>"),Le(ssrRenderComponent(Ct,null,null,Oe)),Le("</div>")):Le("\x3c!----\x3e"),Le('<div class="align-center justify-middle container mx-0 sm:mx-auto sm:max-w-screen-xl px-1 sm:px-8"><div class="pb-24 pt-12">'),ssrRenderSlot(Re.$slots,"default",{},null,Le,Oe),Le("</div></div><div>"),Le(ssrRenderComponent(Ot,null,null,Oe)),Le("</div></div>")})}),Nk=Fk.setup;Fk.setup=(Re,Le)=>{const Oe=useSSRContext();return(Oe.modules||(Oe.modules=new Set)).add("layouts/default.vue"),Nk?Nk(Re,Le):void 0};const jk=Object.freeze(Object.defineProperty({__proto__:null,default:Fk},Symbol.toStringTag,{value:"Module"})),Uk=defineComponent({__name:"fullscreen",__ssrInlineRender:!0,setup:Re=>(useRouter(),useLocaleHead({addDirAttribute:!0,identifierAttribute:"id",addSeoAttributes:!0}),(Re,Le,Oe,Ue)=>{Le(`<div${ssrRenderAttrs(mergeProps({class:"min-h-screen bg-[url('assets/img/background.jpg')] bg-cover text-black"},Ue))}><div class="rounded-2xl bg-white p-6 shadow-xl dark:bg-slate-800"><button class="m-2 rounded-lg border border-slate-200 bg-gray-50 p-4 py-3 text-gray-700 hover:cursor-pointer hover:border-slate-200 hover:bg-slate-200 dark:border-gray-700 dark:bg-slate-800 dark:text-white dark:hover:bg-slate-700"> ← </button>`),ssrRenderSlot(Re.$slots,"default",{},null,Le,Oe),Le("</div></div>")})}),Vk=Uk.setup;Uk.setup=(Re,Le)=>{const Oe=useSSRContext();return(Oe.modules||(Oe.modules=new Set)).add("layouts/fullscreen.vue"),Vk?Vk(Re,Le):void 0};const $k=Object.freeze(Object.defineProperty({__proto__:null,default:Uk},Symbol.toStringTag,{value:"Module"})),Gk=".page-enter-active,.page-leave-active{transition:all .4s}.page-enter-from,.page-leave-to{filter:blur(1rem);opacity:0}",qk=['@font-face{font-family:Merriweather;src:local("Merriweather Regular Italic"),local("Merriweather Italic"),url('+publicAssetsURL("/_fonts/u-4m0qyriQwlOrhSvowK_l5-eRZDf-LVrPHpBXw-tMJiRPEex7.woff2")+') format(woff2);font-display:swap;unicode-range:U+0460-052F,U+1C80-1C8A,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-weight:400;font-style:italic}\n@font-face{font-family:"Merriweather Fallback: Arial";src:local("Arial");size-adjust:111.2605%;ascent-override:88.4411%;descent-override:24.537%;line-gap-override:0%}\n@font-face{font-family:Merriweather;src:local("Merriweather Regular Italic"),local("Merriweather Italic"),url('+publicAssetsURL("/_fonts/u-4m0qyriQwlOrhSvowK_l5-eRZKf-LVrPHpBXw-oJOQsb6hJc.woff2")+') format(woff2);font-display:swap;unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-weight:400;font-style:italic}\n@font-face{font-family:Merriweather;src:local("Merriweather Regular Italic"),local("Merriweather Italic"),url('+publicAssetsURL("/_fonts/u-4m0qyriQwlOrhSvowK_l5-eRZBf-LVrPHpBXw-Jh5iVeMxmk.woff2")+') format(woff2);font-display:swap;unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-weight:400;font-style:italic}\n@font-face{font-family:Merriweather;src:local("Merriweather Regular Italic"),local("Merriweather Italic"),url('+publicAssetsURL("/_fonts/u-4m0qyriQwlOrhSvowK_l5-eRZAf-LVrPHpBXw-niRKushARY.woff2")+') format(woff2);font-display:swap;unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF;font-weight:400;font-style:italic}\n@font-face{font-family:Merriweather;src:local("Merriweather Regular Italic"),local("Merriweather Italic"),url('+publicAssetsURL("/_fonts/u-4m0qyriQwlOrhSvowK_l5-eRZOf-LVrPHp-vGDj3ob5B1.woff2")+') format(woff2);font-display:swap;unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-weight:400;font-style:italic}\n@font-face{font-family:Merriweather;src:local("Merriweather Regular"),local("Merriweather"),url('+publicAssetsURL("/_fonts/u-440qyriQwlOrhSvowK_l5-cSZMdeX3rsHo-MoPzvW9Z9m.woff2")+') format(woff2);font-display:swap;unicode-range:U+0460-052F,U+1C80-1C8A,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-weight:400;font-style:normal}\n@font-face{font-family:Merriweather;src:local("Merriweather Regular"),local("Merriweather"),url('+publicAssetsURL("/_fonts/u-440qyriQwlOrhSvowK_l5-eCZMdeX3rsHo-YKsYFaEkoH.woff2")+') format(woff2);font-display:swap;unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-weight:400;font-style:normal}\n@font-face{font-family:Merriweather;src:local("Merriweather Regular"),local("Merriweather"),url('+publicAssetsURL("/_fonts/u-440qyriQwlOrhSvowK_l5-cyZMdeX3rsHo-ggB82F5TIH.woff2")+') format(woff2);font-display:swap;unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-weight:400;font-style:normal}\n@font-face{font-family:Merriweather;src:local("Merriweather Regular"),local("Merriweather"),url('+publicAssetsURL("/_fonts/u-440qyriQwlOrhSvowK_l5-ciZMdeX3rsHo-nFgSm2tYgG.woff2")+') format(woff2);font-display:swap;unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF;font-weight:400;font-style:normal}\n@font-face{font-family:Merriweather;src:local("Merriweather Regular"),local("Merriweather"),url('+publicAssetsURL("/_fonts/u-440qyriQwlOrhSvowK_l5-fCZMdeX3rg-yeseaOACuL.woff2")+') format(woff2);font-display:swap;unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-weight:400;font-style:normal}\n@font-face{font-family:Merriweather;src:local("Merriweather Regular Italic"),local("Merriweather Italic"),url('+publicAssetsURL("/_fonts/u-4m0qyriQwlOrhSvowK_l5-eSZK-10rxW7UYwV.woff")+') format(woff);font-display:swap;font-weight:400;font-style:italic}\n@font-face{font-family:Merriweather;src:local("Merriweather Regular"),local("Merriweather"),url('+publicAssetsURL("/_fonts/u-440qyriQwlOrhSvowK_l5OeA-oKu1SxIabN.woff")+") format(woff);font-display:swap;font-weight:400;font-style:normal}\n*,:after,:before{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }/*! tailwindcss v3.4.13 | MIT License | https://tailwindcss.com*/*,:after,:before{border:0 solid #e5e7eb;box-sizing:border-box}:after,:before{--tw-content:\"\"}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;font-family:ui-sans-serif,system-ui,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;font-feature-settings:normal;font-variation-settings:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-tap-highlight-color:transparent}body{line-height:inherit;margin:0}hr{border-top-width:1px;color:inherit;height:0}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-feature-settings:normal;font-size:1em;font-variation-settings:normal}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{border-collapse:collapse;border-color:inherit;text-indent:0}button,input,optgroup,select,textarea{color:inherit;font-family:inherit;font-feature-settings:inherit;font-size:100%;font-variation-settings:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0}fieldset,legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{color:#9ca3af;opacity:1}input::placeholder,textarea::placeholder{color:#9ca3af;opacity:1}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{height:auto;max-width:100%}[hidden]{display:none}select{-webkit-appearance:none;-moz-appearance:none;appearance:none;padding-left:5px;padding-right:5px}.container{width:100%}@media (min-width:640px){.container{max-width:640px}}@media (min-width:768px){.container{max-width:768px}}@media (min-width:1024px){.container{max-width:1024px}}@media (min-width:1280px){.container{max-width:1280px}}@media (min-width:1536px){.container{max-width:1536px}}.relative{position:relative}.m-1{margin:.25rem}.m-2{margin:.5rem}.mx-0{margin-left:0;margin-right:0}.mx-1{margin-left:.25rem;margin-right:.25rem}.mx-2{margin-left:.5rem;margin-right:.5rem}.mx-auto{margin-left:auto;margin-right:auto}.-mt-40{margin-top:-10rem}.mb-10{margin-bottom:2.5rem}.mb-2{margin-bottom:.5rem}.mb-20{margin-bottom:5rem}.mb-5{margin-bottom:1.25rem}.mb-\\[-1em\\]{margin-bottom:-1em}.me-2{margin-inline-end:.5rem}.mt-10{margin-top:2.5rem}.mt-3{margin-top:.75rem}.mt-4{margin-top:1rem}.mt-5{margin-top:1.25rem}.mt-auto{margin-top:auto}.flex{display:flex}.grid{display:grid}.h-6{height:1.5rem}.h-80{height:20rem}.h-full{height:100%}.h-min{height:-moz-min-content;height:min-content}.h-screen{height:100vh}.max-h-min{max-height:-moz-min-content;max-height:min-content}.max-h-screen{max-height:100vh}.min-h-screen{min-height:100vh}.w-\\[10rem\\]{width:10rem}.w-auto{width:auto}.w-full{width:100%}.w-screen{width:100vw}.min-w-14{min-width:3.5rem}.min-w-fit{min-width:-moz-fit-content;min-width:fit-content}.max-w-full{max-width:100%}.max-w-lg{max-width:32rem}.max-w-md{max-width:28rem}.max-w-screen-xl{max-width:1280px}.grid-cols-1{grid-template-columns:repeat(1,minmax(0,1fr))}.grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.flex-row{flex-direction:row}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.items-center{align-items:center}.justify-start{justify-content:flex-start}.justify-end{justify-content:flex-end}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.gap-4{gap:1rem}.gap-5{gap:1.25rem}.gap-y-4{row-gap:1rem}.space-x-1>:not([hidden])~:not([hidden]){--tw-space-x-reverse:0;margin-left:calc(.25rem*(1 - var(--tw-space-x-reverse)));margin-right:calc(.25rem*var(--tw-space-x-reverse))}.space-x-3>:not([hidden])~:not([hidden]){--tw-space-x-reverse:0;margin-left:calc(.75rem*(1 - var(--tw-space-x-reverse)));margin-right:calc(.75rem*var(--tw-space-x-reverse))}.space-y-4>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-bottom:calc(1rem*var(--tw-space-y-reverse));margin-top:calc(1rem*(1 - var(--tw-space-y-reverse)))}.overflow-hidden{overflow:hidden}.rounded-2xl{border-radius:1rem}.rounded-3xl{border-radius:1.5rem}.rounded-lg{border-radius:.5rem}.border{border-width:1px}.border-2{border-width:2px}.border-black{--tw-border-opacity:1;border-color:rgb(0 0 0/var(--tw-border-opacity))}.border-gray-500\\/30{border-color:hsla(220,9%,46%,.3)}.border-green-500{--tw-border-opacity:1;border-color:rgb(34 197 94/var(--tw-border-opacity))}.border-orange-500{--tw-border-opacity:1;border-color:rgb(249 115 22/var(--tw-border-opacity))}.border-slate-200{--tw-border-opacity:1;border-color:rgb(226 232 240/var(--tw-border-opacity))}.border-white{--tw-border-opacity:1;border-color:rgb(255 255 255/var(--tw-border-opacity))}.bg-gray-50{--tw-bg-opacity:1;background-color:rgb(249 250 251/var(--tw-bg-opacity))}.bg-gray-500\\/30{background-color:hsla(220,9%,46%,.3)}.bg-green-500{--tw-bg-opacity:1;background-color:rgb(34 197 94/var(--tw-bg-opacity))}.bg-orange-500{--tw-bg-opacity:1;background-color:rgb(249 115 22/var(--tw-bg-opacity))}.bg-slate-100{--tw-bg-opacity:1;background-color:rgb(241 245 249/var(--tw-bg-opacity))}.bg-transparent{background-color:transparent}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255/var(--tw-bg-opacity))}.bg-white\\/50{background-color:hsla(0,0%,100%,.5)}.bg-white\\/80{background-color:hsla(0,0%,100%,.8)}.bg-white\\/90{background-color:hsla(0,0%,100%,.9)}.bg-\\[url\\(\\'assets\\/img\\/background\\.jpg\\'\\)\\]{background-image:url("+buildAssetsURL("background.By7YOMJB.jpg")+')}.bg-gradient-to-r{background-image:linear-gradient(to right,var(--tw-gradient-stops))}.from-green-400{--tw-gradient-from:#4ade80 var(--tw-gradient-from-position);--tw-gradient-to:rgba(74,222,128,0) var(--tw-gradient-to-position);--tw-gradient-stops:var(--tw-gradient-from),var(--tw-gradient-to)}.via-green-500{--tw-gradient-to:rgba(34,197,94,0) var(--tw-gradient-to-position);--tw-gradient-stops:var(--tw-gradient-from),#22c55e var(--tw-gradient-via-position),var(--tw-gradient-to)}.to-green-600{--tw-gradient-to:#16a34a var(--tw-gradient-to-position)}.bg-cover{background-size:cover}.bg-center{background-position:50%}.bg-no-repeat{background-repeat:no-repeat}.p-20{padding:5rem}.p-4{padding:1rem}.p-5{padding:1.25rem}.p-6{padding:1.5rem}.px-1{padding-left:.25rem;padding-right:.25rem}.px-2{padding-left:.5rem;padding-right:.5rem}.px-3{padding-left:.75rem;padding-right:.75rem}.px-4{padding-left:1rem;padding-right:1rem}.px-5{padding-left:1.25rem;padding-right:1.25rem}.px-8{padding-left:2rem;padding-right:2rem}.py-2{padding-bottom:.5rem;padding-top:.5rem}.py-2\\.5{padding-bottom:.625rem;padding-top:.625rem}.py-3{padding-bottom:.75rem;padding-top:.75rem}.py-5{padding-bottom:1.25rem;padding-top:1.25rem}.pb-20{padding-bottom:5rem}.pb-24{padding-bottom:6rem}.pb-40{padding-bottom:10rem}.pb-5{padding-bottom:1.25rem}.pb-60{padding-bottom:15rem}.pl-1{padding-left:.25rem}.pr-2{padding-right:.5rem}.pt-10{padding-top:2.5rem}.pt-12{padding-top:3rem}.pt-20{padding-top:5rem}.pt-4{padding-top:1rem}.pt-40{padding-top:10rem}.pt-60{padding-top:15rem}.text-left{text-align:left}.text-center{text-align:center}.align-middle{vertical-align:middle}.font-sans{font-family:ui-sans-serif,system-ui,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji}.text-2xl{font-size:1.5rem;line-height:2rem}.text-4xl{font-size:2.25rem;line-height:2.5rem}.text-5xl{font-size:3rem;line-height:1}.text-6xl{font-size:3.75rem;line-height:1}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.text-xs{font-size:.75rem;line-height:1rem}.font-bold{font-weight:700}.font-light{font-weight:300}.font-medium{font-weight:500}.font-semibold{font-weight:600}.font-thin{font-weight:100}.text-black{--tw-text-opacity:1;color:rgb(0 0 0/var(--tw-text-opacity))}.text-gray-700{--tw-text-opacity:1;color:rgb(55 65 81/var(--tw-text-opacity))}.text-green-400{--tw-text-opacity:1;color:rgb(74 222 128/var(--tw-text-opacity))}.text-slate-500{--tw-text-opacity:1;color:rgb(100 116 139/var(--tw-text-opacity))}.text-slate-900{--tw-text-opacity:1;color:rgb(15 23 42/var(--tw-text-opacity))}.text-white{--tw-text-opacity:1;color:rgb(255 255 255/var(--tw-text-opacity))}.shadow-lg{--tw-shadow:0 10px 15px -3px rgba(0,0,0,.1),0 4px 6px -4px rgba(0,0,0,.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color),0 4px 6px -4px var(--tw-shadow-color)}.shadow-lg,.shadow-xl{box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.shadow-xl{--tw-shadow:0 20px 25px -5px rgba(0,0,0,.1),0 8px 10px -6px rgba(0,0,0,.1);--tw-shadow-colored:0 20px 25px -5px var(--tw-shadow-color),0 8px 10px -6px var(--tw-shadow-color)}.shadow-green-500\\/50{--tw-shadow-color:rgba(34,197,94,.5);--tw-shadow:var(--tw-shadow-colored)}.blur{--tw-blur:blur(8px)}.blur,.filter{filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.transition{transition-duration:.15s;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1)}.transition-colors{transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1)}.duration-150,.transition-colors{transition-duration:.15s}.duration-500{transition-duration:.5s}.ease-in-out{transition-timing-function:cubic-bezier(.4,0,.2,1)}.swiper{background:transparent}.swiper-slide{box-sizing:border-box;color:#fff}.parallax-bg{background-position:50%;background-size:cover;height:100%;left:0;position:absolute;top:0;width:130%}.swiper-slide .title{font-size:41px;font-weight:300}.swiper-slide .subtitle{font-size:21px}.swiper-slide .text{font-size:14px;line-height:1.3;max-width:800px}.swiper{height:100%;width:100%}.swiper-slide{align-items:center;background:transparent;display:flex;font-size:18px;justify-content:center;text-align:center}.swiper-slide img{display:block;height:100%;-o-object-fit:cover;object-fit:cover;width:100%}html{background-color:rgb(241 245 249/var(--tw-bg-opacity))}html,html.dark{--tw-bg-opacity:1}html.dark{background-color:rgb(15 23 42/var(--tw-bg-opacity))}.title{font-family:Merriweather, "Merriweather Fallback: Arial",sans-serif}.hover\\:cursor-pointer:hover{cursor:pointer}.hover\\:border-gray-500\\/30:hover{border-color:hsla(220,9%,46%,.3)}.hover\\:border-slate-200:hover{--tw-border-opacity:1;border-color:rgb(226 232 240/var(--tw-border-opacity))}.hover\\:border-white:hover{--tw-border-opacity:1;border-color:rgb(255 255 255/var(--tw-border-opacity))}.hover\\:bg-black\\/30:hover{background-color:rgba(0,0,0,.3)}.hover\\:bg-slate-100:hover{--tw-bg-opacity:1;background-color:rgb(241 245 249/var(--tw-bg-opacity))}.hover\\:bg-slate-200:hover{--tw-bg-opacity:1;background-color:rgb(226 232 240/var(--tw-bg-opacity))}.hover\\:bg-white:hover{--tw-bg-opacity:1;background-color:rgb(255 255 255/var(--tw-bg-opacity))}.hover\\:bg-gradient-to-br:hover{background-image:linear-gradient(to bottom right,var(--tw-gradient-stops))}.hover\\:text-black:hover{--tw-text-opacity:1;color:rgb(0 0 0/var(--tw-text-opacity))}.hover\\:text-white:hover{--tw-text-opacity:1;color:rgb(255 255 255/var(--tw-text-opacity))}.focus\\:outline-none:focus{outline:2px solid transparent;outline-offset:2px}.focus\\:ring-4:focus{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(4px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow,0 0 #0000)}.focus\\:ring-green-300:focus{--tw-ring-opacity:1;--tw-ring-color:rgb(134 239 172/var(--tw-ring-opacity))}@media (min-width:640px){.sm\\:mx-0{margin-left:0;margin-right:0}.sm\\:mx-auto{margin-left:auto;margin-right:auto}.sm\\:ml-3{margin-left:.75rem}.sm\\:h-40{height:10rem}.sm\\:max-w-screen-xl{max-width:1280px}.sm\\:grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.sm\\:grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}.sm\\:flex-row{flex-direction:row}.sm\\:justify-center{justify-content:center}.sm\\:gap-y-5{row-gap:1.25rem}.sm\\:space-x-2>:not([hidden])~:not([hidden]){--tw-space-x-reverse:0;margin-left:calc(.5rem*(1 - var(--tw-space-x-reverse)));margin-right:calc(.5rem*var(--tw-space-x-reverse))}.sm\\:space-x-3>:not([hidden])~:not([hidden]){--tw-space-x-reverse:0;margin-left:calc(.75rem*(1 - var(--tw-space-x-reverse)));margin-right:calc(.75rem*var(--tw-space-x-reverse))}.sm\\:space-y-0>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-bottom:calc(0px*var(--tw-space-y-reverse));margin-top:calc(0px*(1 - var(--tw-space-y-reverse)))}.sm\\:space-x-reverse>:not([hidden])~:not([hidden]){--tw-space-x-reverse:1}.sm\\:p-20{padding:5rem}.sm\\:px-10{padding-left:2.5rem;padding-right:2.5rem}.sm\\:px-8{padding-left:2rem;padding-right:2rem}.sm\\:py-20{padding-bottom:5rem;padding-top:5rem}.sm\\:pr-10{padding-right:2.5rem}.sm\\:pt-10{padding-top:2.5rem}.sm\\:text-2xl{font-size:1.5rem;line-height:2rem}.sm\\:text-4xl{font-size:2.25rem;line-height:2.5rem}.sm\\:text-7xl{font-size:4.5rem;line-height:1}.sm\\:text-lg{font-size:1.125rem;line-height:1.75rem}}@media (min-width:768px){.md\\:flex-row{flex-direction:row}}@media (min-width:1024px){.lg\\:ml-0{margin-left:0}}.rtl\\:space-x-reverse:where([dir=rtl],[dir=rtl] *)>:not([hidden])~:not([hidden]){--tw-space-x-reverse:1}.dark\\:border-gray-700:where([class~=dark],[class~=dark] *){--tw-border-opacity:1;border-color:rgb(55 65 81/var(--tw-border-opacity))}.dark\\:bg-slate-800:where([class~=dark],[class~=dark] *){--tw-bg-opacity:1;background-color:rgb(30 41 59/var(--tw-bg-opacity))}.dark\\:bg-slate-900:where([class~=dark],[class~=dark] *){--tw-bg-opacity:1;background-color:rgb(15 23 42/var(--tw-bg-opacity))}.dark\\:text-slate-400:where([class~=dark],[class~=dark] *){--tw-text-opacity:1;color:rgb(148 163 184/var(--tw-text-opacity))}.dark\\:text-white:where([class~=dark],[class~=dark] *){--tw-text-opacity:1;color:rgb(255 255 255/var(--tw-text-opacity))}.dark\\:shadow-lg:where([class~=dark],[class~=dark] *){--tw-shadow:0 10px 15px -3px rgba(0,0,0,.1),0 4px 6px -4px rgba(0,0,0,.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color),0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.dark\\:shadow-green-800\\/80:where([class~=dark],[class~=dark] *){--tw-shadow-color:rgba(22,101,52,.8);--tw-shadow:var(--tw-shadow-colored)}.dark\\:hover\\:bg-slate-700:hover:where([class~=dark],[class~=dark] *){--tw-bg-opacity:1;background-color:rgb(51 65 85/var(--tw-bg-opacity))}.dark\\:focus\\:ring-green-800:focus:where([class~=dark],[class~=dark] *){--tw-ring-opacity:1;--tw-ring-color:rgb(22 101 52/var(--tw-ring-opacity))}.\\[\\&\\>\\*\\]\\:mb-4>*{margin-bottom:1rem}',"@font-face{font-display:swap;font-family:Inter;font-style:normal;font-weight:400;src:url("+buildAssetsURL("Inter-400-1.Dc4VJyIJ.woff2")+') format("woff2");unicode-range:u+0460-052f,u+1c80-1c88,u+20b4,u+2de0-2dff,u+a640-a69f,u+fe2e-fe2f}@font-face{font-display:swap;font-family:Inter;font-style:normal;font-weight:400;src:url('+buildAssetsURL("Inter-400-2.BLGc9T1a.woff2")+') format("woff2");unicode-range:u+0301,u+0400-045f,u+0490-0491,u+04b0-04b1,u+2116}@font-face{font-display:swap;font-family:Inter;font-style:normal;font-weight:400;src:url('+buildAssetsURL("Inter-400-3.Bput3-QP.woff2")+') format("woff2");unicode-range:u+1f??}@font-face{font-display:swap;font-family:Inter;font-style:normal;font-weight:400;src:url('+buildAssetsURL("Inter-400-4.DxZsaF_h.woff2")+') format("woff2");unicode-range:u+0370-0377,u+037a-037f,u+0384-038a,u+038c,u+038e-03a1,u+03a3-03ff}@font-face{font-display:swap;font-family:Inter;font-style:normal;font-weight:400;src:url('+buildAssetsURL("Inter-400-5.DMkecbls.woff2")+') format("woff2");unicode-range:u+0102-0103,u+0110-0111,u+0128-0129,u+0168-0169,u+01a0-01a1,u+01af-01b0,u+0300-0301,u+0303-0304,u+0308-0309,u+0323,u+0329,u+1ea0-1ef9,u+20ab}@font-face{font-display:swap;font-family:Inter;font-style:normal;font-weight:400;src:url('+buildAssetsURL("Inter-400-6.hnt3BR84.woff2")+') format("woff2");unicode-range:u+0100-02af,u+0304,u+0308,u+0329,u+1e00-1e9f,u+1ef2-1eff,u+2020,u+20a0-20ab,u+20ad-20c0,u+2113,u+2c60-2c7f,u+a720-a7ff}@font-face{font-display:swap;font-family:Inter;font-style:normal;font-weight:400;src:url('+buildAssetsURL("Inter-400-7.BOOGhInR.woff2")+') format("woff2");unicode-range:u+00??,u+0131,u+0152-0153,u+02bb-02bc,u+02c6,u+02da,u+02dc,u+0304,u+0308,u+0329,u+2000-206f,u+2074,u+20ac,u+2122,u+2191,u+2193,u+2212,u+2215,u+feff,u+fffd}','.cookieControl__Modal-enter-active,.cookieControl__Modal-leave-active{transition:opacity .25s}.cookieControl__Modal-enter,.cookieControl__Modal-leave-to{opacity:0}.cookieControl__Bar--center{left:50%;top:50%;transform:translate(-50%,-50%)}.cookieControl__Bar--bottom-full-enter-active,.cookieControl__Bar--bottom-full-leave-active,.cookieControl__Bar--bottom-left-enter-active,.cookieControl__Bar--bottom-left-leave-active,.cookieControl__Bar--bottom-right-enter-active,.cookieControl__Bar--bottom-right-leave-active,.cookieControl__Bar--center-enter-active,.cookieControl__Bar--center-leave-active,.cookieControl__Bar--top-full-enter-active,.cookieControl__Bar--top-full-leave-active,.cookieControl__Bar--top-left-enter-active,.cookieControl__Bar--top-left-leave-active,.cookieControl__Bar--top-right-enter-active,.cookieControl__Bar--top-right-leave-active{transition:transform .25s}.cookieControl__Bar--top-full-enter,.cookieControl__Bar--top-full-leave-to,.cookieControl__Bar--top-left-enter,.cookieControl__Bar--top-left-leave-to,.cookieControl__Bar--top-right-enter,.cookieControl__Bar--top-right-leave-to{transform:translateY(-100%)}.cookieControl__Bar--bottom-full-enter,.cookieControl__Bar--bottom-full-leave-to,.cookieControl__Bar--bottom-left-enter,.cookieControl__Bar--bottom-left-leave-to,.cookieControl__Bar--bottom-right-enter,.cookieControl__Bar--bottom-right-leave-to{transform:translateY(100%)}.cookieControl__Bar--center-enter,.cookieControl__Bar--center-leave-to{transform:translate(-50%,-50%) scale(.95)}.cookieControl{position:relative;z-index:100000}.cookieControl button{backface-visibility:hidden;border:0;cursor:pointer;font-size:16px;outline:0;padding:12px 20px;transition:background-color .2s,color .2s}.cookieControl__Bar{background-color:var(--cookie-control-barBackground);font-family:Arial,Helvetica Neue,Helvetica,sans-serif;position:fixed}.cookieControl__Bar h2,.cookieControl__Bar p{color:var(--cookie-control-barTextColor);max-width:900px}.cookieControl__Bar h2{font-size:20px;margin:0}.cookieControl__Bar p{font-size:16px;margin:5px 0 0}.cookieControl__Bar button{background-color:var(--cookie-control-barButtonBackground);color:var(--cookie-control-barButtonColor)}.cookieControl__Bar button:hover{background-color:var(--cookie-control-barButtonHoverBackground);color:var(--cookie-control-barButtonHoverColor)}.cookieControl__Bar button:focus{box-shadow:0 0 0 3px var(--cookie-control-focusRingColor)}.cookieControl__Bar button+button{margin-left:10px}.cookieControl__BarContainer{align-items:flex-end;display:flex;justify-content:space-between;padding:20px}.cookieControl__Bar--bottom-full,.cookieControl__Bar--top-full{left:0;right:0}.cookieControl__Bar--top-full{top:0}.cookieControl__Bar--bottom-full{bottom:0}.cookieControl__Bar--bottom-left p,.cookieControl__Bar--bottom-right p,.cookieControl__Bar--center p,.cookieControl__Bar--top-left p,.cookieControl__Bar--top-right p{max-width:400px}.cookieControl__Bar--bottom-left .cookieControl__BarContainer,.cookieControl__Bar--bottom-right .cookieControl__BarContainer,.cookieControl__Bar--center .cookieControl__BarContainer,.cookieControl__Bar--top-left .cookieControl__BarContainer,.cookieControl__Bar--top-right .cookieControl__BarContainer{flex-direction:column}.cookieControl__Bar--bottom-left .cookieControl__BarButtons,.cookieControl__Bar--bottom-right .cookieControl__BarButtons,.cookieControl__Bar--center .cookieControl__BarButtons,.cookieControl__Bar--top-left .cookieControl__BarButtons,.cookieControl__Bar--top-right .cookieControl__BarButtons{margin-top:20px}.cookieControl__Bar--top-left,.cookieControl__Bar--top-right{top:20px}.cookieControl__Bar--bottom-left,.cookieControl__Bar--bottom-right{bottom:20px}.cookieControl__Bar--bottom-left,.cookieControl__Bar--top-left{left:20px}.cookieControl__Bar--bottom-right,.cookieControl__Bar--top-right{right:20px}.cookieControl__BarButtons{display:flex}.cookieControl__Modal{bottom:0;font-size:0;left:0;position:fixed;right:0;text-align:center;top:0;z-index:1}.cookieControl__Modal:before{content:"";display:inline-block;min-height:100vh;vertical-align:middle}.cookieControl__Modal:after{background-color:var(--cookie-control-modalOverlay);bottom:0;content:"";left:0;opacity:var(--cookie-control-modalOverlayOpacity);position:absolute;right:0;top:0;z-index:-1}.cookieControl__Modal>div{font-size:medium}.cookieControl__Modal button{background-color:var(--cookie-control-modalButtonBackground);color:var(--cookie-control-modalButtonColor)}.cookieControl__Modal button:hover{background-color:var(--cookie-control-modalButtonHoverBackground);color:var(--cookie-control-modalButtonHoverColor)}.cookieControl__Modal button:focus{box-shadow:0 0 0 3px var(--cookie-control-focusRingColor)}.cookieControl__ModalContent{background-color:var(--cookie-control-modalBackground);display:inline-block;max-height:80vh;max-width:550px;overflow-y:scroll;position:relative;text-align:left;vertical-align:middle;width:100%}.cookieControl__ModalContent,.cookieControl__ModalContent :not(button){color:var(--cookie-control-modalTextColor)}.cookieControl__ModalContent h2{font-size:24px;margin:15px 0}.cookieControl__ModalContent h2:first-of-type{margin-top:0}.cookieControl__ModalContent ul{font-size:16px;list-style-type:none;padding:0}.cookieControl__ModalContent ul ul{padding:5px 56px 0}.cookieControl__ModalContent ul ul li+li{margin-top:5px}.cookieControl__ModalContent li{align-items:center}.cookieControl__ModalContent li+li{margin-top:20px}.cookieControl__ModalContent input{display:none}.cookieControl__ModalContent input:checked+button{background-color:var(--cookie-control-checkboxActiveBackground)}.cookieControl__ModalContent input:checked+button:before{background-color:var(--cookie-control-checkboxActiveCircleBackground);transform:translate3d(100%,-50%,0)}.cookieControl__ModalContent input:checked:disabled+button{background-color:var(--cookie-control-checkboxDisabledBackground)}.cookieControl__ModalContent input:checked:disabled+button:before{background-color:var(--cookie-control-checkboxDisabledCircleBackground)}.cookieControl__ModalContent input+button{backface-visibility:hidden;background-color:var(--cookie-control-checkboxInactiveBackground);border-radius:20px;display:block;font-size:0;margin-right:20px;min-height:20px;min-width:36px;position:relative;transition:background-color .2s}.cookieControl__ModalContent input+button:before{background-color:var(--cookie-control-checkboxInactiveCircleBackground);border-radius:50%;content:"";height:15px;left:3px;position:absolute;top:50%;transform:translate3d(0,-50%,0);transition:transform .2s;width:15px}.cookieControl__ModalContentInner{display:flex;flex-direction:column;gap:10px;padding:40px}.cookieControl__ModalInputWrapper{align-items:flex-start;display:flex}.cookieControl__ModalCookieName{font-weight:700;text-transform:uppercase}.cookieControl__ModalCookieName span{font-weight:400;text-transform:none}.cookieControl__ModalClose{align-self:flex-end;right:20px;top:20px}.cookieControl__ModalButtons{align-items:stretch;display:flex;gap:20px;margin-top:40px}.cookieControl__ModalUnsaved{bottom:40px;color:var(--cookie-control-modalUnsavedColor);font-size:14px;left:50%;margin:0;position:absolute;transform:translateX(-50%)}.cookieControl__BlockedIframe{border:2px solid #ddd;padding:20px}.cookieControl__BlockedIframe a,.cookieControl__BlockedIframe p{font-family:Arial,Helvetica Neue,Helvetica,sans-serif}@media screen and (max-width:768px){.cookieControl__Bar{flex-direction:column;left:0;right:0}.cookieControl__Bar h2,.cookieControl__Bar p{max-width:100%}.cookieControl__Bar--top-full,.cookieControl__Bar--top-left,.cookieControl__Bar--top-right{top:0}.cookieControl__Bar--bottom-full,.cookieControl__Bar--bottom-left,.cookieControl__Bar--bottom-right{bottom:0}.cookieControl__ModalContent{bottom:0;left:0;max-height:100%;max-width:none;position:absolute;right:0;top:0}.cookieControl__ModalContentInner{padding:20px}.cookieControl__BarButtons{flex-direction:column;justify-content:center;margin-top:20px;width:100%}.cookieControl__BarButtons button{width:100%}.cookieControl__BarButtons button+button{margin:10px 0 0}.cookieControl__BarContainer,.cookieControl__ModalButtons{flex-direction:column;gap:10px}.cookieControl__ModalButtons button{width:100%}}.cookieControl__ControlButton{backface-visibility:hidden;background:var(--cookie-control-controlButtonBackground);border:0;border-radius:50%;bottom:20px;box-shadow:0 0 10px rgba(0,0,0,.3);cursor:pointer;height:40px;min-height:40px;min-width:40px;outline:0;position:fixed;right:20px;transition:background-color .2s;width:40px}.cookieControl__ControlButton svg{backface-visibility:hidden;color:var(--cookie-control-controlButtonIconColor);left:50%;max-height:24px;max-width:24px;min-height:24px;min-width:24px;position:absolute;top:50%;transform:translate(-50%,-50%);transition:color .2s}.cookieControl__ControlButton:hover{background-color:var(--cookie-control-controlButtonHoverBackground)}.cookieControl__ControlButton:hover svg{color:var(--cookie-control-controlButtonIconHoverColor)}',"",Gk],Hk=Object.freeze(Object.defineProperty({__proto__:null,default:qk},Symbol.toStringTag,{value:"Module"})),Wk=[Gk,Gk],Zk=Object.freeze(Object.defineProperty({__proto__:null,default:Wk},Symbol.toStringTag,{value:"Module"})),Xk=[Gk],Yk=Object.freeze(Object.defineProperty({__proto__:null,default:Xk},Symbol.toStringTag,{value:"Module"})),Kk=".travel-card:hover .button{--tw-border-opacity:1;border-color:rgb(255 255 255/var(--tw-border-opacity));--tw-bg-opacity:1;background-color:rgb(255 255 255/var(--tw-bg-opacity));--tw-text-opacity:1;color:rgb(0 0 0/var(--tw-text-opacity));transition-duration:.15s;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1)}",Jk=[Kk,Kk],Qk=Object.freeze(Object.defineProperty({__proto__:null,default:Jk},Symbol.toStringTag,{value:"Module"})),eM=[Kk],tM=Object.freeze(Object.defineProperty({__proto__:null,default:eM},Symbol.toStringTag,{value:"Module"})),rM="span[data-v-41e8d397]{background-color:currentColor;display:inline-block;-webkit-mask-image:var(--efdb04fa);mask-image:var(--efdb04fa);-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:100% 100%;mask-size:100% 100%;vertical-align:middle}",nM=[rM,rM],iM=Object.freeze(Object.defineProperty({__proto__:null,default:nM},Symbol.toStringTag,{value:"Module"})),oM=[rM],sM=Object.freeze(Object.defineProperty({__proto__:null,default:oM},Symbol.toStringTag,{value:"Module"})),aM=".icon[data-v-e8d572f6]{display:inline-block;vertical-align:middle}",lM=[aM,aM],cM=Object.freeze(Object.defineProperty({__proto__:null,default:lM},Symbol.toStringTag,{value:"Module"})),uM=[aM],hM=Object.freeze(Object.defineProperty({__proto__:null,default:uM},Symbol.toStringTag,{value:"Module"})),dM=".map-container{flex:1}",pM=[dM,dM],fM=Object.freeze(Object.defineProperty({__proto__:null,default:pM},Symbol.toStringTag,{value:"Module"})),mM=[dM],gM=Object.freeze(Object.defineProperty({__proto__:null,default:mM},Symbol.toStringTag,{value:"Module"})),_M=".nuxt-rating-star[data-v-038f2b51]{display:inline-block;-webkit-tap-highlight-color:transparent}.nuxt-rating-pointer[data-v-038f2b51]{cursor:pointer}.nuxt-rating[data-v-038f2b51]{align-items:center;display:flex}.nuxt-rating-inline[data-v-038f2b51]{display:inline-flex}.skeleton-wrapper[data-v-038f2b51]{align-items:center;display:flex}.skeleton-pulse[data-v-038f2b51]{animation:pulse-038f2b51 1.5s ease-in-out infinite}@keyframes pulse-038f2b51{0%{opacity:.4}50%{opacity:1}to{opacity:.4}}",yM=[_M,_M],vM=Object.freeze(Object.defineProperty({__proto__:null,default:yM},Symbol.toStringTag,{value:"Module"})),xM=[_M],bM=Object.freeze(Object.defineProperty({__proto__:null,default:xM},Symbol.toStringTag,{value:"Module"})),wM="ul .router-link-exact-active{--tw-text-opacity:1;color:rgb(255 255 255/var(--tw-text-opacity))}ul .router-link-exact-active,ul .router-link-exact-active:hover{background-color:hsla(220,9%,46%,.3);border-color:hsla(220,9%,46%,.3)}",TM=[wM,wM],SM=Object.freeze(Object.defineProperty({__proto__:null,default:TM},Symbol.toStringTag,{value:"Module"})),EM=[wM],CM=Object.freeze(Object.defineProperty({__proto__:null,default:EM},Symbol.toStringTag,{value:"Module"})),AM=".nuxt-rating-star-svg[data-v-f0c63eac]{overflow:visible!important}",IM=[AM,AM],kM=Object.freeze(Object.defineProperty({__proto__:null,default:IM},Symbol.toStringTag,{value:"Module"})),MM=[AM],PM=Object.freeze(Object.defineProperty({__proto__:null,default:MM},Symbol.toStringTag,{value:"Module"})),RM=new TextDecoder,toUTF8String=(Re,Le=0,Oe=Re.length)=>RM.decode(Re.slice(Le,Oe)),toHexString=(Re,Le=0,Oe=Re.length)=>Re.slice(Le,Oe).reduce(((Re,Le)=>Re+("0"+Le.toString(16)).slice(-2)),""),readInt16LE=(Re,Le=0)=>{const Oe=Re[Le]+256*Re[Le+1];return Oe|131070*(32768&Oe)},readUInt16BE=(Re,Le=0)=>256*Re[Le]+Re[Le+1],readUInt16LE=(Re,Le=0)=>Re[Le]+256*Re[Le+1],readUInt24LE=(Re,Le=0)=>Re[Le]+256*Re[Le+1]+65536*Re[Le+2],readInt32LE=(Re,Le=0)=>Re[Le]+256*Re[Le+1]+65536*Re[Le+2]+(Re[Le+3]<<24),readUInt32BE=(Re,Le=0)=>Re[Le]*2**24+65536*Re[Le+1]+256*Re[Le+2]+Re[Le+3],readUInt32LE=(Re,Le=0)=>Re[Le]+256*Re[Le+1]+65536*Re[Le+2]+Re[Le+3]*2**24,LM={readUInt16BE:readUInt16BE,readUInt16LE:readUInt16LE,readUInt32BE:readUInt32BE,readUInt32LE:readUInt32LE};function readUInt(Re,Le,Oe,Ue){Oe=Oe||0;return LM["readUInt"+Le+(Ue?"BE":"LE")](Re,Oe)}const OM={validate:Re=>"BM"===toUTF8String(Re,0,2),calculate:Re=>({height:Math.abs(readInt32LE(Re,22)),width:readUInt32LE(Re,18)})};function getSizeFromOffset(Re,Le){const Oe=Re[Le];return 0===Oe?256:Oe}function getImageSize$1(Re,Le){const Oe=6+16*Le;return{height:getSizeFromOffset(Re,Oe+1),width:getSizeFromOffset(Re,Oe)}}const zM={validate(Re){const Le=readUInt16LE(Re,0),Oe=readUInt16LE(Re,4);if(0!==Le||0===Oe)return!1;return 1===readUInt16LE(Re,2)},calculate(Re){const Le=readUInt16LE(Re,4),Oe=getImageSize$1(Re,0);if(1===Le)return Oe;const Ue=[Oe];for(let Oe=1;Oe<Le;Oe+=1)Ue.push(getImageSize$1(Re,Oe));return{height:Oe.height,images:Ue,width:Oe.width}}},DM={validate(Re){const Le=readUInt16LE(Re,0),Oe=readUInt16LE(Re,4);if(0!==Le||0===Oe)return!1;return 2===readUInt16LE(Re,2)},calculate:Re=>zM.calculate(Re)},BM={validate:Re=>542327876===readUInt32LE(Re,0),calculate:Re=>({height:readUInt32LE(Re,12),width:readUInt32LE(Re,16)})},FM=/^GIF8[79]a/,NM={validate:Re=>FM.test(toUTF8String(Re,0,6)),calculate:Re=>({height:readUInt16LE(Re,8),width:readUInt16LE(Re,6)})},jM={ICON:32,"ICN#":32,"icm#":16,icm4:16,icm8:16,"ics#":16,ics4:16,ics8:16,is32:16,s8mk:16,icp4:16,icl4:32,icl8:32,il32:32,l8mk:32,icp5:32,ic11:32,ich4:48,ich8:48,ih32:48,h8mk:48,icp6:64,ic12:32,it32:128,t8mk:128,ic07:128,ic08:256,ic13:256,ic09:512,ic14:512,ic10:1024};function readImageHeader(Re,Le){const Oe=Le+4;return[toUTF8String(Re,Le,Oe),readUInt32BE(Re,Oe)]}function getImageSize(Re){const Le=jM[Re];return{width:Le,height:Le,type:Re}}const UM={validate:Re=>"icns"===toUTF8String(Re,0,4),calculate(Re){const Le=Re.length,Oe=readUInt32BE(Re,4);let Ue=8,qe=readImageHeader(Re,Ue),Ct=getImageSize(qe[0]);if(Ue+=qe[1],Ue===Oe)return Ct;const Ot={height:Ct.height,images:[Ct],width:Ct.width};for(;Ue<Oe&&Ue<Le;)qe=readImageHeader(Re,Ue),Ct=getImageSize(qe[0]),Ue+=qe[1],Ot.images.push(Ct);return Ot}},VM={validate:Re=>"ff4fff51"===toHexString(Re,0,4),calculate:Re=>({height:readUInt32BE(Re,12),width:readUInt32BE(Re,8)})},$M="66747970",GM="6a703268",qM="6a502020",HM="72726571",parseIHDR=Re=>({height:readUInt32BE(Re,4),width:readUInt32BE(Re,8)}),WM={validate(Re){const Le=toHexString(Re,4,8),Oe=readUInt32BE(Re,0);if(Le!==qM||Oe<1)return!1;const Ue=Oe+4,qe=readUInt32BE(Re,Oe),Ct=Re.slice(Ue,Ue+qe);return toHexString(Ct,0,4)===$M},calculate(Re){const Le=readUInt32BE(Re,0);let Oe=Le+4+readUInt16BE(Re,Le+2);switch(toHexString(Re,Oe,Oe+4)){case HM:return Oe=Oe+4+4+(Re=>{const Le=Re[0];let Oe=1+2*Le;return Oe=Oe+2+readUInt16BE(Re,Oe)*(2+Le),Oe+2+readUInt16BE(Re,Oe)*(16+Le)})(Re.slice(Oe+4)),parseIHDR(Re.slice(Oe+8,Oe+24));case GM:return parseIHDR(Re.slice(Oe+8,Oe+24));default:throw new TypeError("Unsupported header found: "+toUTF8String(Re,Oe,Oe+4))}}};function isEXIF(Re){return"45786966"===toHexString(Re,2,6)}function extractSize(Re,Le){return{height:readUInt16BE(Re,Le),width:readUInt16BE(Re,Le+2)}}function validateExifBlock(Re,Le){const Oe=Re.slice(2,Le),Ue=toHexString(Oe,6,8),qe="4d4d"===Ue;if(qe||"4949"===Ue)return function(Re,Le){const Oe=readUInt(Re,16,14,Le);for(let Ue=0;Ue<Oe;Ue++){const Oe=16+12*Ue,qe=Oe+12;if(Oe>Re.length)return;const Ct=Re.slice(Oe,qe);if(274===readUInt(Ct,16,0,Le)){if(3!==readUInt(Ct,16,2,Le))return;if(1!==readUInt(Ct,32,4,Le))return;return readUInt(Ct,16,8,Le)}}}(Oe,qe)}function validateInput(Re,Le){if(Le>Re.length)throw new TypeError("Corrupt JPG, exceeded buffer limits");if(255!==Re[Le])throw new TypeError("Invalid JPG, marker table corrupted")}const ZM={validate:Re=>"ffd8"===toHexString(Re,0,2),calculate(Re){let Le,Oe;for(Re=Re.slice(4);Re.length>0;){const Ue=readUInt16BE(Re,0);if(isEXIF(Re)&&(Le=validateExifBlock(Re,Ue)),validateInput(Re,Ue),Oe=Re[Ue+1],192===Oe||193===Oe||194===Oe){const Oe=extractSize(Re,Ue+5);return Le?{height:Oe.height,orientation:Le,width:Oe.width}:Oe}Re=Re.slice(Ue+2)}throw new TypeError("Invalid JPG, no size found")}},XM={validate:Re=>"KTX 11"===toUTF8String(Re,1,7),calculate:Re=>({height:readUInt32LE(Re,40),width:readUInt32LE(Re,36)})},YM="CgBI",KM={validate(Re){if("PNG\r\n\n"===toUTF8String(Re,1,8)){let Le=toUTF8String(Re,12,16);if(Le===YM&&(Le=toUTF8String(Re,28,32)),"IHDR"!==Le)throw new TypeError("Invalid PNG");return!0}return!1},calculate:Re=>toUTF8String(Re,12,16)===YM?{height:readUInt32BE(Re,36),width:readUInt32BE(Re,32)}:{height:readUInt32BE(Re,20),width:readUInt32BE(Re,16)}},JM={P1:"pbm/ascii",P2:"pgm/ascii",P3:"ppm/ascii",P4:"pbm",P5:"pgm",P6:"ppm",P7:"pam",PF:"pfm"},QM={default:Re=>{let Le=[];for(;Re.length>0;){const Oe=Re.shift();if("#"!==Oe[0]){Le=Oe.split(" ");break}}if(2===Le.length)return{height:Number.parseInt(Le[1],10),width:Number.parseInt(Le[0],10)};throw new TypeError("Invalid PNM")},pam:Re=>{const Le={};for(;Re.length>0;){const Oe=Re.shift();if(Oe.length>16||(Oe.codePointAt(0)||0)>128)continue;const[Ue,qe]=Oe.split(" ");if(Ue&&qe&&(Le[Ue.toLowerCase()]=Number.parseInt(qe,10)),Le.height&&Le.width)break}if(Le.height&&Le.width)return{height:Le.height,width:Le.width};throw new TypeError("Invalid PAM")}},eP={validate:Re=>toUTF8String(Re,0,2)in JM,calculate(Re){const Le=toUTF8String(Re,0,2),Oe=JM[Le],Ue=toUTF8String(Re,3).split(/[\n\r]+/);return(QM[Oe]||QM.default)(Ue)}},tP={validate:Re=>"8BPS"===toUTF8String(Re,0,4),calculate:Re=>({height:readUInt32BE(Re,14),width:readUInt32BE(Re,18)})},rP=/<svg\s([^"'>]|"[^"]*"|'[^']*')*>/,nP={height:/\sheight=(["'])([^%]+?)\1/,root:rP,viewbox:/\sviewbox=(["'])(.+?)\1/i,width:/\swidth=(["'])([^%]+?)\1/},iP=2.54,oP={in:96,cm:96/iP,em:16,ex:8,m:96/iP*100,mm:96/iP/10,pc:96/72/12,pt:96/72,px:1},sP=new RegExp(`^([0-9.]+(?:e\\d+)?)(${Object.keys(oP).join("|")})?$`);function parseLength(Re){const Le=sP.exec(Re);if(Le)return Math.round(Number(Le[1])*(oP[Le[2]]||1))}function parseViewbox(Re){const Le=Re.split(" ");return{height:parseLength(Le[3]),width:parseLength(Le[2])}}const aP={validate:Re=>rP.test(toUTF8String(Re,0,1e3)),calculate(Re){const Le=toUTF8String(Re).match(nP.root);if(Le){const Re=function(Re){const Le=Re.match(nP.width),Oe=Re.match(nP.height),Ue=Re.match(nP.viewbox);return{height:Oe&&parseLength(Oe[2]),viewbox:Ue&&parseViewbox(Ue[2]),width:Le&&parseLength(Le[2])}}(Le[0]);if(Re.width&&Re.height)return function(Re){return{height:Re.height,width:Re.width}}(Re);if(Re.viewbox)return function(Re,Le){const Oe=Le.width/Le.height;return Re.width?{height:Math.floor(Re.width/Oe),width:Re.width}:Re.height?{height:Re.height,width:Math.floor(Re.height*Oe)}:{height:Le.height,width:Le.width}}(Re,Re.viewbox)}throw new TypeError("Invalid SVG")}},lP={validate:Re=>0===readUInt16LE(Re,0)&&0===readUInt16LE(Re,4),calculate:Re=>({height:readUInt16LE(Re,14),width:readUInt16LE(Re,12)})};function readValue(Re,Le){const Oe=readUInt(Re,16,8,Le);return(readUInt(Re,16,10,Le)<<16)+Oe}function nextTag(Re){if(Re.length>24)return Re.slice(12)}const cP=new Set(["49492a00","4d4d002a"]),uP={validate:Re=>cP.has(toHexString(Re,0,4)),calculate(Re){const Le="BE"===function(Re){const Le=toUTF8String(Re,0,2);return"II"===Le?"LE":"MM"===Le?"BE":void 0}(Re),Oe=function(Re,Le){const Oe=readUInt(Re,32,4,Le);let Ue=1024;const qe=Re.length;return Oe+Ue>qe&&(Ue=qe-Oe-10),Re.slice(Oe+2,Oe+2+Ue)}(Re,Le),Ue=function(Re,Le){const Oe={};let Ue=Re;for(;Ue&&Ue.length>0;){const Re=readUInt(Ue,16,0,Le),qe=readUInt(Ue,16,2,Le),Ct=readUInt(Ue,32,4,Le);if(0===Re)break;1!==Ct||3!==qe&&4!==qe||(Oe[Re]=readValue(Ue,Le)),Ue=nextTag(Ue)}return Oe}(Oe,Le),qe=Ue[256],Ct=Ue[257];if(!qe||!Ct)throw new TypeError("Invalid Tiff. Missing tags");return{height:Ct,width:qe}}};function findBox(Re,Le,Oe=0,Ue=Re.length){for(let qe=Oe;qe<Ue;){const Oe=readUInt32BE(Re,qe);if(toUTF8String(Re,qe+4,qe+8)===Le)return{offset:qe,size:Oe};if(Oe<=0||qe+Oe>Ue)break;qe+=Oe}throw new Error(`${Le} box not found`)}const hP={bmp:OM,cur:DM,dds:BM,gif:NM,icns:UM,ico:zM,j2c:VM,jp2:WM,jpg:ZM,ktx:XM,png:KM,pnm:eP,psd:tP,svg:aP,tga:lP,tiff:uP,webp:{validate(Re){const Le="RIFF"===toUTF8String(Re,0,4),Oe="WEBP"===toUTF8String(Re,8,12),Ue="VP8"===toUTF8String(Re,12,15);return Le&&Oe&&Ue},calculate(Re){const Le=toUTF8String(Re,12,16);if(Re=Re.slice(20,30),"VP8X"===Le){const Le=Re[0];if(!(192&Le)&&!(1&Le))return function(Re){return{height:1+readUInt24LE(Re,7),width:1+readUInt24LE(Re,4)}}(Re);throw new TypeError("Invalid WebP")}if("VP8 "===Le&&47!==Re[0])return function(Re){return{height:16383&readInt16LE(Re,8),width:16383&readInt16LE(Re,6)}}(Re);const Oe=toHexString(Re,3,6);if("VP8L"===Le&&"9d012a"!==Oe)return function(Re){return{height:1+((15&Re[4])<<10|Re[3]<<2|(192&Re[2])>>6),width:1+((63&Re[2])<<8|Re[1])}}(Re);throw new TypeError("Invalid WebP")}},avif:{validate:Re=>"avif"===toUTF8String(Re,8,12),calculate:Re=>{const Le=findBox(Re,"meta"),Oe=findBox(Re,"iprp",Le.offset+12,Le.offset+Le.size),Ue=findBox(Re,"ipco",Oe.offset+8,Oe.offset+Oe.size),qe=findBox(Re,"ispe",Ue.offset+8,Ue.offset+Ue.size);return{width:readUInt32BE(Re,qe.offset+12),height:readUInt32BE(Re,qe.offset+16)}}}},dP=Object.keys(hP),pP={56:"psd",66:"bmp",68:"dds",71:"gif",73:"tiff",77:"tiff",82:"webp",105:"icns",137:"png",255:"jpg"};const fP=Object.freeze(Object.defineProperty({__proto__:null,imageMeta:function(Re){if(!(Re instanceof Uint8Array))throw new TypeError("Input should be a Uint8Array");const Le=function(Re){const Le=Re[0];if(Le in pP){const Oe=pP[Le];if(Oe&&hP[Oe].validate(Re))return Oe}return dP.find((Le=>hP[Le].validate(Re)))}(Re);if(void 0!==Le&&Le in hP){const Oe=hP[Le].calculate(Re);if(void 0!==Oe)return Oe.type=Le,Oe}throw new TypeError(`Unsupported file type: ${Le}`)}},Symbol.toStringTag,{value:"Module"}));export{handleEvent as default};
//# sourceMappingURL=index.mjs.map
